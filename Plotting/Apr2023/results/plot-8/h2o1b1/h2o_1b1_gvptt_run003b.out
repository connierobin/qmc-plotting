--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            n0268.savio3
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4123

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
Rank =    0  Free Memory = 82347 MB
Rank =    1  Free Memory = 82345 MB
Rank =    2  Free Memory = 82344 MB
Rank =    3  Free Memory = 82344 MB
Rank =    4  Free Memory = 82344 MB
Rank =    5  Free Memory = 82344 MB
Rank =    6  Free Memory = 82343 MB
Rank =    7  Free Memory = 82342 MB
Rank =    8  Free Memory = 82342 MB
Rank =    9  Free Memory = 82341 MB
Rank =   10  Free Memory = 82341 MB
Rank =   11  Free Memory = 82341 MB
Rank =   12  Free Memory = 82341 MB
Rank =   13  Free Memory = 82341 MB
Rank =   14  Free Memory = 82341 MB
Rank =   15  Free Memory = 82341 MB
Rank =   16  Free Memory = 82341 MB
Rank =   17  Free Memory = 82341 MB
Rank =   18  Free Memory = 82341 MB
Rank =   19  Free Memory = 82340 MB
Rank =   20  Free Memory = 82340 MB
Rank =   21  Free Memory = 82340 MB
Rank =   22  Free Memory = 82340 MB
Rank =   23  Free Memory = 82340 MB
Rank =   24  Free Memory = 82340 MB
Rank =   25  Free Memory = 82340 MB
Rank =   26  Free Memory = 82340 MB
Rank =   27  Free Memory = 82340 MB
Rank =   28  Free Memory = 82340 MB
Rank =   29  Free Memory = 82340 MB
Rank =   30  Free Memory = 82340 MB
Rank =   31  Free Memory = 82340 MB
Rank =   32  Free Memory = 82340 MB
Rank =   33  Free Memory = 82340 MB
Rank =   34  Free Memory = 82340 MB
Rank =   35  Free Memory = 82339 MB
Rank =   36  Free Memory = 82339 MB
Rank =   37  Free Memory = 82339 MB
Rank =   38  Free Memory = 82339 MB
Rank =   39  Free Memory = 82339 MB
Rank =   40  Free Memory = 88089 MB
Rank =   41  Free Memory = 88089 MB
Rank =   42  Free Memory = 88089 MB
Rank =   43  Free Memory = 88089 MB
Rank =   44  Free Memory = 88089 MB
Rank =   45  Free Memory = 88089 MB
Rank =   46  Free Memory = 88089 MB
Rank =   47  Free Memory = 88089 MB
Rank =   48  Free Memory = 88089 MB
Rank =   49  Free Memory = 88089 MB
Rank =   50  Free Memory = 88089 MB
Rank =   51  Free Memory = 88089 MB
Rank =   52  Free Memory = 88089 MB
Rank =   53  Free Memory = 88089 MB
Rank =   54  Free Memory = 88089 MB
Rank =   55  Free Memory = 88089 MB
Rank =   56  Free Memory = 88089 MB
Rank =   57  Free Memory = 88089 MB
Rank =   58  Free Memory = 88089 MB
Rank =   59  Free Memory = 88089 MB
Rank =   60  Free Memory = 88089 MB
Rank =   61  Free Memory = 88089 MB
Rank =   62  Free Memory = 88088 MB
Rank =   63  Free Memory = 88088 MB
Rank =   64  Free Memory = 88088 MB
Rank =   65  Free Memory = 88088 MB
Rank =   66  Free Memory = 88088 MB
Rank =   67  Free Memory = 88088 MB
Rank =   68  Free Memory = 88088 MB
Rank =   69  Free Memory = 88088 MB
Rank =   70  Free Memory = 88088 MB
Rank =   71  Free Memory = 88088 MB
Rank =   72  Free Memory = 88088 MB
Rank =   73  Free Memory = 88088 MB
Rank =   74  Free Memory = 88088 MB
Rank =   75  Free Memory = 88088 MB
Rank =   76  Free Memory = 88088 MB
Rank =   77  Free Memory = 88088 MB
Rank =   78  Free Memory = 88088 MB
Rank =   79  Free Memory = 88088 MB
Rank =   80  Free Memory = 85378 MB
Rank =   81  Free Memory = 85378 MB
Rank =   82  Free Memory = 85378 MB
Rank =   83  Free Memory = 85378 MB
Rank =   84  Free Memory = 85378 MB
Rank =   85  Free Memory = 85378 MB
Rank =   86  Free Memory = 85378 MB
Rank =   87  Free Memory = 85378 MB
Rank =   88  Free Memory = 85378 MB
Rank =   89  Free Memory = 85378 MB
Rank =   90  Free Memory = 85378 MB
Rank =   91  Free Memory = 85378 MB
Rank =   92  Free Memory = 85378 MB
Rank =   93  Free Memory = 85378 MB
Rank =   94  Free Memory = 85378 MB
Rank =   95  Free Memory = 85378 MB
Rank =   96  Free Memory = 85378 MB
Rank =   97  Free Memory = 85378 MB
Rank =   98  Free Memory = 85378 MB
Rank =   99  Free Memory = 85377 MB
Rank =  100  Free Memory = 85377 MB
Rank =  101  Free Memory = 85377 MB
Rank =  102  Free Memory = 85377 MB
Rank =  103  Free Memory = 85377 MB
Rank =  104  Free Memory = 85377 MB
Rank =  105  Free Memory = 85377 MB
Rank =  106  Free Memory = 85377 MB
Rank =  107  Free Memory = 85377 MB
Rank =  108  Free Memory = 85377 MB
Rank =  109  Free Memory = 85377 MB
Rank =  110  Free Memory = 85377 MB
Rank =  111  Free Memory = 85377 MB
Rank =  112  Free Memory = 85377 MB
Rank =  113  Free Memory = 85377 MB
Rank =  114  Free Memory = 85377 MB
Rank =  115  Free Memory = 85376 MB
Rank =  116  Free Memory = 85376 MB
Rank =  117  Free Memory = 85376 MB
Rank =  118  Free Memory = 85376 MB
Rank =  119  Free Memory = 85376 MB
Rank =  120  Free Memory = 89101 MB
Rank =  121  Free Memory = 89101 MB
Rank =  122  Free Memory = 89101 MB
  Input file(s): opt_h2o_1b1_gvptt_run003b.xml 
Rank =  123  Free Memory = 89101 MB
Rank =  124  Free Memory = 89101 MB
Rank =  125  Free Memory = 89101 MB
Rank =  126  Free Memory = 89101 MB
Rank =  127  Free Memory = 89101 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 40
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run003b.xml

  Project = H2O
  date    = 2023-04-01 14:41:33 PDT
  host    = n0265.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 269

  Range of prime numbers to use as seeds over processors and threads = 1741-2731


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.027108e-01    1         1  ON     0
     uu_1                 1.395499e-01    1         1  ON     1
     uu_2                 4.158458e-02    1         1  ON     2
     uu_3                -1.946409e-02    1         1  ON     3
     uu_4                -6.333239e-02    1         1  ON     4
     uu_5                -9.587524e-02    1         1  ON     5
     uu_6                -1.205706e-01    1         1  ON     6
     uu_7                -1.310580e-01    1         1  ON     7
     uu_8                -1.203232e-01    1         1  ON     8
     uu_9                -9.277332e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.114416e-01    1         1  ON     0
     ud_1                 1.583401e-01    1         1  ON     1
     ud_2                 6.092685e-02    1         1  ON     2
     ud_3                 2.699750e-03    1         1  ON     3
     ud_4                -5.713986e-02    1         1  ON     4
     ud_5                -1.014997e-01    1         1  ON     5
     ud_6                -1.286687e-01    1         1  ON     6
     ud_7                -1.435029e-01    1         1  ON     7
     ud_8                -1.424319e-01    1         1  ON     8
     ud_9                -1.344547e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.043100e-01    1         1  ON     0
     eO_1                -4.137154e-01    1         1  ON     1
     eO_2                -3.185752e-02    1         1  ON     2
     eO_3                 2.692030e-01    1         1  ON     3
     eO_4                 4.916456e-01    1         1  ON     4
     eO_5                 4.596091e-01    1         1  ON     5
     eO_6                 2.360353e-01    1         1  ON     6
     eO_7                -5.591968e-02    1         1  ON     7
     eO_8                -1.959242e-01    1         1  ON     8
     eO_9                -5.768884e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.099404e-01    1         1  ON     0
     eH1_1                -1.274877e-01    1         1  ON     1
     eH1_2                -8.838243e-02    1         1  ON     2
     eH1_3                -3.738645e-02    1         1  ON     3
     eH1_4                 1.159942e-02    1         1  ON     4
     eH1_5                 4.473069e-02    1         1  ON     5
     eH1_6                 9.476145e-02    1         1  ON     6
     eH1_7                 1.381756e-01    1         1  ON     7
     eH1_8                 1.456924e-01    1         1  ON     8
     eH1_9                 3.283823e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.088198e-01    1         1  ON     0
     eH2_1                -1.265485e-01    1         1  ON     1
     eH2_2                -8.741031e-02    1         1  ON     2
     eH2_3                -3.640778e-02    1         1  ON     3
     eH2_4                 1.289653e-02    1         1  ON     4
     eH2_5                 4.794967e-02    1         1  ON     5
     eH2_6                 1.006131e-01    1         1  ON     6
     eH2_7                 1.496008e-01    1         1  ON     7
     eH2_8                 1.537439e-01    1         1  ON     8
     eH2_9                 1.292423e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.646786e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 6.2429e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
[n0265.savio3:76697] 127 more processes have sent help message help-mpi-btl-openib.txt / no device params found
[n0265.savio3:76697] Set MCA parameter "orte_base_help_aggregate" to 0 to see all help / error messages
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9708
    reference variance = 0.38436
====================================================
  Execution time = 2.1215e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2473e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5839e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324655251945
                                         uncertainty =       0.003653195185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324655251945
                                         uncertainty =       0.003653195185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402943488
  error estimate for blocks of size 2^( 2) =       0.000416898987
  error estimate for blocks of size 2^( 3) =       0.000430529297
  error estimate for blocks of size 2^( 4) =       0.000443619026
  error estimate for blocks of size 2^( 5) =       0.000454363235
  error estimate for blocks of size 2^( 6) =       0.000462027645
  error estimate for blocks of size 2^( 7) =       0.000467611910

      target function =                  N/A
              le_mean =     -16.903372214987
             les_mean =     286.048718984895
             stat err =       0.000456905454
             autocorr =       1.285773296077
              std dev =       0.569848145429
             le_variance =       0.324726908849


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690337221499e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903372214987       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903628265896       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903764260583       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903818349390       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.903916229138       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.903940970072       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.903955958420       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.903955348984       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.903952886072       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.903954553799       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.903954749090       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.903955259435       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.903955135744       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.163018e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903372214987       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903476158522       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903541189528       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903558995494       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.903591718326       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.903602236570       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.903605969570       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.903606789434       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.903605734798       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.903605833398       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.903605823187       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.903605886017       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.989304e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903372214987       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903403001711       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903424193575       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903429466370       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.903437250878       residual = 7.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.903440825220       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.903442158941       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.903442337953       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.903442193075       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.903442159056       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.903442177461       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.117121e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.098157 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6902e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.027496e-01                 1 1 ON  0
uu_1  1.393666e-01                 1 1 ON  1
uu_2  4.119310e-02                 1 1 ON  2
uu_3  -1.923816e-02                1 1 ON  3
uu_4  -6.301578e-02                1 1 ON  4
uu_5  -9.583186e-02                1 1 ON  5
uu_6  -1.206348e-01                1 1 ON  6
uu_7  -1.311686e-01                1 1 ON  7
uu_8  -1.205154e-01                1 1 ON  8
uu_9  -9.278355e-02                1 1 ON  9
ud_0  4.149128e-01                 1 1 ON  10
ud_1  1.607960e-01                 1 1 ON  11
ud_2  5.910695e-02                 1 1 ON  12
ud_3  4.986067e-04                 1 1 ON  13
ud_4  -5.752019e-02                1 1 ON  14
ud_5  -1.016734e-01                1 1 ON  15
ud_6  -1.291589e-01                1 1 ON  16
ud_7  -1.440606e-01                1 1 ON  17
ud_8  -1.427517e-01                1 1 ON  18
ud_9  -1.344385e-01                1 1 ON  19
eO_0  -7.082993e-01                1 1 ON  20
eO_1  -4.142360e-01                1 1 ON  21
eO_2  -2.890064e-02                1 1 ON  22
eO_3  2.712800e-01                 1 1 ON  23
eO_4  4.920065e-01                 1 1 ON  24
eO_5  4.592030e-01                 1 1 ON  25
eO_6  2.358815e-01                 1 1 ON  26
eO_7  -5.594477e-02                1 1 ON  27
eO_8  -1.961005e-01                1 1 ON  28
eO_9  -5.779932e-02                1 1 ON  29
eH1_0 -2.112932e-01                1 1 ON  30
eH1_1 -1.275940e-01                1 1 ON  31
eH1_2 -8.819432e-02                1 1 ON  32
eH1_3 -3.685457e-02                1 1 ON  33
eH1_4 1.192862e-02                 1 1 ON  34
eH1_5 4.476315e-02                 1 1 ON  35
eH1_6 9.472719e-02                 1 1 ON  36
eH1_7 1.382828e-01                 1 1 ON  37
eH1_8 1.458809e-01                 1 1 ON  38
eH1_9 3.296661e-02                 1 1 ON  39
eH2_0 -2.101919e-01                1 1 ON  40
eH2_1 -1.266550e-01                1 1 ON  41
eH2_2 -8.718049e-02                1 1 ON  42
eH2_3 -3.592268e-02                1 1 ON  43
eH2_4 1.326730e-02                 1 1 ON  44
eH2_5 4.801342e-02                 1 1 ON  45
eH2_6 1.005582e-01                 1 1 ON  46
eH2_7 1.495257e-01                 1 1 ON  47
eH2_8 1.539097e-01                 1 1 ON  48
eH2_9 1.317826e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.7677
    reference variance = 0.222091
====================================================
  Execution time = 2.0454e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2272e-01
  Total weights = 2.0000e+06
  Execution time = 1.8967e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321839233725
                                         uncertainty =       0.002635632685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321839233725
                                         uncertainty =       0.002635632685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401083726
  error estimate for blocks of size 2^( 2) =       0.000414905645
  error estimate for blocks of size 2^( 3) =       0.000429072028
  error estimate for blocks of size 2^( 4) =       0.000441867537
  error estimate for blocks of size 2^( 5) =       0.000452863255
  error estimate for blocks of size 2^( 6) =       0.000459215768
  error estimate for blocks of size 2^( 7) =       0.000461194052

      target function =                  N/A
              le_mean =     -16.905168068945
             les_mean =     286.106443588368
             stat err =       0.000453785153
             autocorr =       1.280060463723
              std dev =       0.567218044465
             le_variance =       0.321736309966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325637420578
                                         uncertainty =       0.002719824639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325637420578
                                         uncertainty =       0.002719824639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403443450
  error estimate for blocks of size 2^( 2) =       0.000416583147
  error estimate for blocks of size 2^( 3) =       0.000430154272
  error estimate for blocks of size 2^( 4) =       0.000442578825
  error estimate for blocks of size 2^( 5) =       0.000453344430
  error estimate for blocks of size 2^( 6) =       0.000459785084
  error estimate for blocks of size 2^( 7) =       0.000461723591

      target function =                  N/A
              le_mean =     -16.905206214961
             les_mean =     286.111530243027
             stat err =       0.000454357983
             autocorr =       1.268326264750
              std dev =       0.570555199285
             le_variance =       0.325533235431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324432854590
                                         uncertainty =       0.002701207546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324432854590
                                         uncertainty =       0.002701207546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402696549
  error estimate for blocks of size 2^( 2) =       0.000415966204
  error estimate for blocks of size 2^( 3) =       0.000429655352
  error estimate for blocks of size 2^( 4) =       0.000442161992
  error estimate for blocks of size 2^( 5) =       0.000452968406
  error estimate for blocks of size 2^( 6) =       0.000459402448
  error estimate for blocks of size 2^( 7) =       0.000461368493

      target function =                  N/A
              le_mean =     -16.905164082576
             les_mean =     286.108901517026
             stat err =       0.000453975335
             autocorr =       1.270892159879
              std dev =       0.569498920435
             le_variance =       0.324329020377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322023975091
                                         uncertainty =       0.002644829554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322023975091
                                         uncertainty =       0.002644829554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401198788
  error estimate for blocks of size 2^( 2) =       0.000414928957
  error estimate for blocks of size 2^( 3) =       0.000429018382
  error estimate for blocks of size 2^( 4) =       0.000441769424
  error estimate for blocks of size 2^( 5) =       0.000452735827
  error estimate for blocks of size 2^( 6) =       0.000459101660
  error estimate for blocks of size 2^( 7) =       0.000461079906

      target function =                  N/A
              le_mean =     -16.905141766686
             les_mean =     286.105738926282
             stat err =       0.000453671704
             autocorr =       1.278686736193
              std dev =       0.567380767630
             le_variance =       0.321920935477


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905168068945        initial
     2.5000e-01     2.5000e+00             1.1630e-02       -16.905206214961  <--
     1.0000e+00     1.0000e+01             3.9893e-03       -16.905164082576
     4.0000e+00     4.0000e+01             1.1171e-03       -16.905141766686

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9993e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.030804e-01 1 1  ON 0
 uu_1                 1.391403e-01 1 1  ON 1
 uu_2                 4.058259e-02 1 1  ON 2
 uu_3                -1.928206e-02 1 1  ON 3
 uu_4                -6.268898e-02 1 1  ON 4
 uu_5                -9.560727e-02 1 1  ON 5
 uu_6                -1.206958e-01 1 1  ON 6
 uu_7                -1.314504e-01 1 1  ON 7
 uu_8                -1.210683e-01 1 1  ON 8
 uu_9                -9.283865e-02 1 1  ON 9
 ud_0                 4.211063e-01 1 1  ON 10
 ud_1                 1.642689e-01 1 1  ON 11
 ud_2                 5.746462e-02 1 1  ON 12
 ud_3                -3.172721e-03 1 1  ON 13
 ud_4                -5.908136e-02 1 1  ON 14
 ud_5                -1.021386e-01 1 1  ON 15
 ud_6                -1.298435e-01 1 1  ON 16
 ud_7                -1.450983e-01 1 1  ON 17
 ud_8                -1.434843e-01 1 1  ON 18
 ud_9                -1.343426e-01 1 1  ON 19
 eO_0                -7.159402e-01 1 1  ON 20
 eO_1                -4.158630e-01 1 1  ON 21
 eO_2                -2.433950e-02 1 1  ON 22
 eO_3                 2.757944e-01 1 1  ON 23
 eO_4                 4.938241e-01 1 1  ON 24
 eO_5                 4.587951e-01 1 1  ON 25
 eO_6                 2.355384e-01 1 1  ON 26
 eO_7                -5.598572e-02 1 1  ON 27
 eO_8                -1.965839e-01 1 1  ON 28
 eO_9                -5.811326e-02 1 1  ON 29
eH1_0                -2.144995e-01 1 1  ON 30
eH1_1                -1.280566e-01 1 1  ON 31
eH1_2                -8.763649e-02 1 1  ON 32
eH1_3                -3.592708e-02 1 1  ON 33
eH1_4                 1.254827e-02 1 1  ON 34
eH1_5                 4.495893e-02 1 1  ON 35
eH1_6                 9.481476e-02 1 1  ON 36
eH1_7                 1.386472e-01 1 1  ON 37
eH1_8                 1.464442e-01 1 1  ON 38
eH1_9                 3.335147e-02 1 1  ON 39
eH2_0                -2.134319e-01 1 1  ON 40
eH2_1                -1.271067e-01 1 1  ON 41
eH2_2                -8.656054e-02 1 1  ON 42
eH2_3                -3.505163e-02 1 1  ON 43
eH2_4                 1.396595e-02 1 1  ON 44
eH2_5                 4.828559e-02 1 1  ON 45
eH2_6                 1.005909e-01 1 1  ON 46
eH2_7                 1.493671e-01 1 1  ON 47
eH2_8                 1.543988e-01 1 1  ON 48
eH2_9                 1.392562e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6902e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6869e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8635
    reference variance = 0.424008
====================================================
  Execution time = 2.0865e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3090e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5749e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330962174396
                                         uncertainty =       0.003872030104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330962174396
                                         uncertainty =       0.003872030104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406755603
  error estimate for blocks of size 2^( 2) =       0.000419643773
  error estimate for blocks of size 2^( 3) =       0.000433560038
  error estimate for blocks of size 2^( 4) =       0.000446823295
  error estimate for blocks of size 2^( 5) =       0.000457282584
  error estimate for blocks of size 2^( 6) =       0.000465189579
  error estimate for blocks of size 2^( 7) =       0.000472679861

      target function =                  N/A
              le_mean =     -16.905302146686
             les_mean =     286.120140746038
             stat err =       0.000460493830
             autocorr =       1.281682762404
              std dev =       0.575239289995
             le_variance =       0.330900240754


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690530214669e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905302146686       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905387210638       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905455063586       residual = 8.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905539319643       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905563400762       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905584183687       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905588696165       residual = 9.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905601670856       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905605850552       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905607789185       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905613374514       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905616108684       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905617170289       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905617484120       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905616705480       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905616392900       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905616214598       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.767348e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905302146686       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905353910423       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905395583810       residual = 7.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905426348809       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905455125370       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905464286792       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905463856499       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905466244671       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905467605467       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905467714072       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905468541729       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905468752976       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905468780957       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 7.693496e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905302146686       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905322320315       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905339554811       residual = 8.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905346721858       residual = 7.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905361523361       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905363021487       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905362660171       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905362990503       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905363246601       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905363236202       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905363304601       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.529316e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.104823 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6451e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.036817e-01 1 1  ON 0
 uu_1                 1.391648e-01 1 1  ON 1
 uu_2                 4.004835e-02 1 1  ON 2
 uu_3                -1.949916e-02 1 1  ON 3
 uu_4                -6.235521e-02 1 1  ON 4
 uu_5                -9.533218e-02 1 1  ON 5
 uu_6                -1.209367e-01 1 1  ON 6
 uu_7                -1.322364e-01 1 1  ON 7
 uu_8                -1.216301e-01 1 1  ON 8
 uu_9                -9.275894e-02 1 1  ON 9
 ud_0                 4.267421e-01 1 1  ON 10
 ud_1                 1.671603e-01 1 1  ON 11
 ud_2                 5.642521e-02 1 1  ON 12
 ud_3                -6.407929e-03 1 1  ON 13
 ud_4                -6.107383e-02 1 1  ON 14
 ud_5                -1.028341e-01 1 1  ON 15
 ud_6                -1.301888e-01 1 1  ON 16
 ud_7                -1.453951e-01 1 1  ON 17
 ud_8                -1.440461e-01 1 1  ON 18
 ud_9                -1.347659e-01 1 1  ON 19
 eO_0                -7.236337e-01 1 1  ON 20
 eO_1                -4.180402e-01 1 1  ON 21
 eO_2                -2.028059e-02 1 1  ON 22
 eO_3                 2.805189e-01 1 1  ON 23
 eO_4                 4.962011e-01 1 1  ON 24
 eO_5                 4.586172e-01 1 1  ON 25
 eO_6                 2.354563e-01 1 1  ON 26
 eO_7                -5.593363e-02 1 1  ON 27
 eO_8                -1.971741e-01 1 1  ON 28
 eO_9                -5.856933e-02 1 1  ON 29
eH1_0                -2.179658e-01 1 1  ON 30
eH1_1                -1.285341e-01 1 1  ON 31
eH1_2                -8.693608e-02 1 1  ON 32
eH1_3                -3.519403e-02 1 1  ON 33
eH1_4                 1.290347e-02 1 1  ON 34
eH1_5                 4.518368e-02 1 1  ON 35
eH1_6                 9.527800e-02 1 1  ON 36
eH1_7                 1.389814e-01 1 1  ON 37
eH1_8                 1.471500e-01 1 1  ON 38
eH1_9                 3.386730e-02 1 1  ON 39
eH2_0                -2.168311e-01 1 1  ON 40
eH2_1                -1.274793e-01 1 1  ON 41
eH2_2                -8.589408e-02 1 1  ON 42
eH2_3                -3.426068e-02 1 1  ON 43
eH2_4                 1.458111e-02 1 1  ON 44
eH2_5                 4.869147e-02 1 1  ON 45
eH2_6                 1.006692e-01 1 1  ON 46
eH2_7                 1.490068e-01 1 1  ON 47
eH2_8                 1.550422e-01 1 1  ON 48
eH2_9                 1.482727e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.934
    reference variance = 0.193454
====================================================
  Execution time = 2.0283e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3085e-01
  Total weights = 2.0000e+06
  Execution time = 1.8926e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327508082024
                                         uncertainty =       0.003882313474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327508082024
                                         uncertainty =       0.003882313474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404651457
  error estimate for blocks of size 2^( 2) =       0.000417926626
  error estimate for blocks of size 2^( 3) =       0.000432285235
  error estimate for blocks of size 2^( 4) =       0.000444530452
  error estimate for blocks of size 2^( 5) =       0.000455941043
  error estimate for blocks of size 2^( 6) =       0.000464940992
  error estimate for blocks of size 2^( 7) =       0.000471035394

      target function =                  N/A
              le_mean =     -16.904501864502
             les_mean =     286.089668726510
             stat err =       0.000459111970
             autocorr =       1.287285908284
              std dev =       0.572263578510
             le_variance =       0.327485603289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334287001714
                                         uncertainty =       0.003979698744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334287001714
                                         uncertainty =       0.003979698744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408818213
  error estimate for blocks of size 2^( 2) =       0.000421631233
  error estimate for blocks of size 2^( 3) =       0.000435570603
  error estimate for blocks of size 2^( 4) =       0.000447484222
  error estimate for blocks of size 2^( 5) =       0.000458744334
  error estimate for blocks of size 2^( 6) =       0.000467665713
  error estimate for blocks of size 2^( 7) =       0.000473621160

      target function =                  N/A
              le_mean =     -16.904496858342
             les_mean =     286.096278529789
             stat err =       0.000461878857
             autocorr =       1.276426152247
              std dev =       0.578156261952
             le_variance =       0.334264663235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334971304929
                                         uncertainty =       0.003976416545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334971304929
                                         uncertainty =       0.003976416545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409236686
  error estimate for blocks of size 2^( 2) =       0.000422016771
  error estimate for blocks of size 2^( 3) =       0.000435938252
  error estimate for blocks of size 2^( 4) =       0.000447843705
  error estimate for blocks of size 2^( 5) =       0.000459108284
  error estimate for blocks of size 2^( 6) =       0.000468039686
  error estimate for blocks of size 2^( 7) =       0.000473990248

      target function =                  N/A
              le_mean =     -16.904518830615
             les_mean =     286.097706057878
             stat err =       0.000462245481
             autocorr =       1.275840045056
              std dev =       0.578748071900
             le_variance =       0.334949330728

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328697887925
                                         uncertainty =       0.003897732460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328697887925
                                         uncertainty =       0.003897732460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405385957
  error estimate for blocks of size 2^( 2) =       0.000418548823
  error estimate for blocks of size 2^( 3) =       0.000432812822
  error estimate for blocks of size 2^( 4) =       0.000444987933
  error estimate for blocks of size 2^( 5) =       0.000456368398
  error estimate for blocks of size 2^( 6) =       0.000465355361
  error estimate for blocks of size 2^( 7) =       0.000471421959

      target function =                  N/A
              le_mean =     -16.904463545577
             les_mean =     286.089563147013
             stat err =       0.000459533413
             autocorr =       1.284981246912
              std dev =       0.573302317826
             le_variance =       0.328675547625


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904501864502        initial
     6.2500e-02     6.2500e-01             1.7673e-02       -16.904496858342
     2.5000e-01     2.5000e+00             7.6935e-03       -16.904518830615  <--
     1.0000e+00     1.0000e+01             2.5293e-03       -16.904463545577

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9773e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.036817e-01 1 1  ON 0
 uu_1                 1.391648e-01 1 1  ON 1
 uu_2                 4.004835e-02 1 1  ON 2
 uu_3                -1.949916e-02 1 1  ON 3
 uu_4                -6.235521e-02 1 1  ON 4
 uu_5                -9.533218e-02 1 1  ON 5
 uu_6                -1.209367e-01 1 1  ON 6
 uu_7                -1.322364e-01 1 1  ON 7
 uu_8                -1.216301e-01 1 1  ON 8
 uu_9                -9.275894e-02 1 1  ON 9
 ud_0                 4.267421e-01 1 1  ON 10
 ud_1                 1.671603e-01 1 1  ON 11
 ud_2                 5.642521e-02 1 1  ON 12
 ud_3                -6.407929e-03 1 1  ON 13
 ud_4                -6.107383e-02 1 1  ON 14
 ud_5                -1.028341e-01 1 1  ON 15
 ud_6                -1.301888e-01 1 1  ON 16
 ud_7                -1.453951e-01 1 1  ON 17
 ud_8                -1.440461e-01 1 1  ON 18
 ud_9                -1.347659e-01 1 1  ON 19
 eO_0                -7.236337e-01 1 1  ON 20
 eO_1                -4.180402e-01 1 1  ON 21
 eO_2                -2.028059e-02 1 1  ON 22
 eO_3                 2.805189e-01 1 1  ON 23
 eO_4                 4.962011e-01 1 1  ON 24
 eO_5                 4.586172e-01 1 1  ON 25
 eO_6                 2.354563e-01 1 1  ON 26
 eO_7                -5.593363e-02 1 1  ON 27
 eO_8                -1.971741e-01 1 1  ON 28
 eO_9                -5.856933e-02 1 1  ON 29
eH1_0                -2.179658e-01 1 1  ON 30
eH1_1                -1.285341e-01 1 1  ON 31
eH1_2                -8.693608e-02 1 1  ON 32
eH1_3                -3.519403e-02 1 1  ON 33
eH1_4                 1.290347e-02 1 1  ON 34
eH1_5                 4.518368e-02 1 1  ON 35
eH1_6                 9.527800e-02 1 1  ON 36
eH1_7                 1.389814e-01 1 1  ON 37
eH1_8                 1.471500e-01 1 1  ON 38
eH1_9                 3.386730e-02 1 1  ON 39
eH2_0                -2.168311e-01 1 1  ON 40
eH2_1                -1.274793e-01 1 1  ON 41
eH2_2                -8.589408e-02 1 1  ON 42
eH2_3                -3.426068e-02 1 1  ON 43
eH2_4                 1.458111e-02 1 1  ON 44
eH2_5                 4.869147e-02 1 1  ON 45
eH2_6                 1.006692e-01 1 1  ON 46
eH2_7                 1.490068e-01 1 1  ON 47
eH2_8                 1.550422e-01 1 1  ON 48
eH2_9                 1.482727e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6272e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6884e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9399
    reference variance = 0.381931
====================================================
  Execution time = 2.0514e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2869e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6196e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328787272559
                                         uncertainty =       0.003023375995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328787272559
                                         uncertainty =       0.003023375995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405396987
  error estimate for blocks of size 2^( 2) =       0.000418753187
  error estimate for blocks of size 2^( 3) =       0.000432284776
  error estimate for blocks of size 2^( 4) =       0.000445176574
  error estimate for blocks of size 2^( 5) =       0.000456493192
  error estimate for blocks of size 2^( 6) =       0.000465188097
  error estimate for blocks of size 2^( 7) =       0.000469812585

      target function =                  N/A
              le_mean =     -16.904768108250
             les_mean =     286.099878062760
             stat err =       0.000459167612
             autocorr =       1.282866491751
              std dev =       0.573317916508
             le_variance =       0.328693433390


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690476810825e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904768108250       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904790889241       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904812148280       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904837964323       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904855789461       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904862406712       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904873041780       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904883368045       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904887323740       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904889107680       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904889399361       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904888136828       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904888533102       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904890303852       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.904889667626       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.904889827991       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.904889803452       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.282082e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904768108250       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904781290652       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904793986256       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904809139947       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904816228874       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904818589537       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904821481270       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904824047492       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904824221035       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904824265609       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904824159161       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904824116155       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904823988462       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 5.218529e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904768108250       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904773017212       residual = 7.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904778055208       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904784319418       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904785185244       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904785798635       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904786259163       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904786771464       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904786769871       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904786739712       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904786704540       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.633426e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111600 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6144e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.041265e-01 1 1  ON 0
 uu_1                 1.393717e-01 1 1  ON 1
 uu_2                 3.998119e-02 1 1  ON 2
 uu_3                -1.978007e-02 1 1  ON 3
 uu_4                -6.245539e-02 1 1  ON 4
 uu_5                -9.541665e-02 1 1  ON 5
 uu_6                -1.210775e-01 1 1  ON 6
 uu_7                -1.323783e-01 1 1  ON 7
 uu_8                -1.222054e-01 1 1  ON 8
 uu_9                -9.296906e-02 1 1  ON 9
 ud_0                 4.302684e-01 1 1  ON 10
 ud_1                 1.690998e-01 1 1  ON 11
 ud_2                 5.642342e-02 1 1  ON 12
 ud_3                -8.043792e-03 1 1  ON 13
 ud_4                -6.255323e-02 1 1  ON 14
 ud_5                -1.034656e-01 1 1  ON 15
 ud_6                -1.302838e-01 1 1  ON 16
 ud_7                -1.456973e-01 1 1  ON 17
 ud_8                -1.448284e-01 1 1  ON 18
 ud_9                -1.351628e-01 1 1  ON 19
 eO_0                -7.288522e-01 1 1  ON 20
 eO_1                -4.202269e-01 1 1  ON 21
 eO_2                -1.819447e-02 1 1  ON 22
 eO_3                 2.841567e-01 1 1  ON 23
 eO_4                 4.987184e-01 1 1  ON 24
 eO_5                 4.590416e-01 1 1  ON 25
 eO_6                 2.354190e-01 1 1  ON 26
 eO_7                -5.574545e-02 1 1  ON 27
 eO_8                -1.978686e-01 1 1  ON 28
 eO_9                -5.916045e-02 1 1  ON 29
eH1_0                -2.205362e-01 1 1  ON 30
eH1_1                -1.292385e-01 1 1  ON 31
eH1_2                -8.663389e-02 1 1  ON 32
eH1_3                -3.475663e-02 1 1  ON 33
eH1_4                 1.306114e-02 1 1  ON 34
eH1_5                 4.549514e-02 1 1  ON 35
eH1_6                 9.587722e-02 1 1  ON 36
eH1_7                 1.392315e-01 1 1  ON 37
eH1_8                 1.477829e-01 1 1  ON 38
eH1_9                 3.447389e-02 1 1  ON 39
eH2_0                -2.193702e-01 1 1  ON 40
eH2_1                -1.278723e-01 1 1  ON 41
eH2_2                -8.553866e-02 1 1  ON 42
eH2_3                -3.394208e-02 1 1  ON 43
eH2_4                 1.476789e-02 1 1  ON 44
eH2_5                 4.899758e-02 1 1  ON 45
eH2_6                 1.009879e-01 1 1  ON 46
eH2_7                 1.488923e-01 1 1  ON 47
eH2_8                 1.557247e-01 1 1  ON 48
eH2_9                 1.566289e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9117
    reference variance = 0.258692
====================================================
  Execution time = 2.0050e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3377e-01
  Total weights = 2.0000e+06
  Execution time = 1.8934e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331555714744
                                         uncertainty =       0.005115437170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331555714744
                                         uncertainty =       0.005115437170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407189321
  error estimate for blocks of size 2^( 2) =       0.000420145364
  error estimate for blocks of size 2^( 3) =       0.000434345752
  error estimate for blocks of size 2^( 4) =       0.000446939069
  error estimate for blocks of size 2^( 5) =       0.000457812636
  error estimate for blocks of size 2^( 6) =       0.000464933913
  error estimate for blocks of size 2^( 7) =       0.000468123438

      target function =                  N/A
              le_mean =     -16.905811999820
             les_mean =     286.138085494415
             stat err =       0.000459452264
             autocorr =       1.273174794431
              std dev =       0.575852660807
             le_variance =       0.331606286959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336103423488
                                         uncertainty =       0.005249735857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336103423488
                                         uncertainty =       0.005249735857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409972053
  error estimate for blocks of size 2^( 2) =       0.000422695871
  error estimate for blocks of size 2^( 3) =       0.000436689623
  error estimate for blocks of size 2^( 4) =       0.000449084284
  error estimate for blocks of size 2^( 5) =       0.000459842999
  error estimate for blocks of size 2^( 6) =       0.000466860334
  error estimate for blocks of size 2^( 7) =       0.000470055501

      target function =                  N/A
              le_mean =     -16.905828520814
             les_mean =     286.143191976173
             stat err =       0.000461460779
             autocorr =       1.266954691557
              std dev =       0.579788038068
             le_variance =       0.336154169086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336101243786
                                         uncertainty =       0.005255564089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336101243786
                                         uncertainty =       0.005255564089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409970337
  error estimate for blocks of size 2^( 2) =       0.000422689052
  error estimate for blocks of size 2^( 3) =       0.000436691781
  error estimate for blocks of size 2^( 4) =       0.000449097831
  error estimate for blocks of size 2^( 5) =       0.000459875180
  error estimate for blocks of size 2^( 6) =       0.000466895622
  error estimate for blocks of size 2^( 7) =       0.000470093905

      target function =                  N/A
              le_mean =     -16.905828473307
             les_mean =     286.143187555882
             stat err =       0.000461490634
             autocorr =       1.267129239893
              std dev =       0.579785611302
             le_variance =       0.336151355072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332311184390
                                         uncertainty =       0.005140746760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332311184390
                                         uncertainty =       0.005140746760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407652795
  error estimate for blocks of size 2^( 2) =       0.000420560412
  error estimate for blocks of size 2^( 3) =       0.000434722081
  error estimate for blocks of size 2^( 4) =       0.000447279958
  error estimate for blocks of size 2^( 5) =       0.000458136630
  error estimate for blocks of size 2^( 6) =       0.000465239886
  error estimate for blocks of size 2^( 7) =       0.000468431699

      target function =                  N/A
              le_mean =     -16.905802968928
             les_mean =     286.138535460608
             stat err =       0.000459772043
             autocorr =       1.272050260235
              std dev =       0.576508111449
             le_variance =       0.332361602567


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905811999820        initial
     6.2500e-02     6.2500e-01             1.2821e-02       -16.905828520814  <--
     2.5000e-01     2.5000e+00             5.2185e-03       -16.905828473307
     1.0000e+00     1.0000e+01             1.6334e-03       -16.905802968928

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 2.9572e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.054675e-01 1 1  ON 0
 uu_1                 1.401533e-01 1 1  ON 1
 uu_2                 4.014023e-02 1 1  ON 2
 uu_3                -2.025742e-02 1 1  ON 3
 uu_4                -6.324954e-02 1 1  ON 4
 uu_5                -9.611049e-02 1 1  ON 5
 uu_6                -1.216984e-01 1 1  ON 6
 uu_7                -1.329453e-01 1 1  ON 7
 uu_8                -1.234697e-01 1 1  ON 8
 uu_9                -9.362182e-02 1 1  ON 9
 ud_0                 4.342242e-01 1 1  ON 10
 ud_1                 1.716855e-01 1 1  ON 11
 ud_2                 5.735348e-02 1 1  ON 12
 ud_3                -8.976409e-03 1 1  ON 13
 ud_4                -6.422559e-02 1 1  ON 14
 ud_5                -1.046425e-01 1 1  ON 15
 ud_6                -1.308538e-01 1 1  ON 16
 ud_7                -1.461810e-01 1 1  ON 17
 ud_8                -1.460612e-01 1 1  ON 18
 ud_9                -1.361152e-01 1 1  ON 19
 eO_0                -7.364545e-01 1 1  ON 20
 eO_1                -4.244221e-01 1 1  ON 21
 eO_2                -1.720584e-02 1 1  ON 22
 eO_3                 2.891224e-01 1 1  ON 23
 eO_4                 5.040075e-01 1 1  ON 24
 eO_5                 4.619918e-01 1 1  ON 25
 eO_6                 2.364515e-01 1 1  ON 26
 eO_7                -5.507707e-02 1 1  ON 27
 eO_8                -1.998130e-01 1 1  ON 28
 eO_9                -6.092872e-02 1 1  ON 29
eH1_0                -2.246326e-01 1 1  ON 30
eH1_1                -1.308186e-01 1 1  ON 31
eH1_2                -8.714499e-02 1 1  ON 32
eH1_3                -3.483335e-02 1 1  ON 33
eH1_4                 1.270538e-02 1 1  ON 34
eH1_5                 4.564375e-02 1 1  ON 35
eH1_6                 9.732837e-02 1 1  ON 36
eH1_7                 1.404043e-01 1 1  ON 37
eH1_8                 1.498066e-01 1 1  ON 38
eH1_9                 3.634939e-02 1 1  ON 39
eH2_0                -2.232813e-01 1 1  ON 40
eH2_1                -1.291387e-01 1 1  ON 41
eH2_2                -8.591152e-02 1 1  ON 42
eH2_3                -3.402472e-02 1 1  ON 43
eH2_4                 1.439509e-02 1 1  ON 44
eH2_5                 4.907791e-02 1 1  ON 45
eH2_6                 1.018999e-01 1 1  ON 46
eH2_7                 1.491373e-01 1 1  ON 47
eH2_8                 1.578185e-01 1 1  ON 48
eH2_9                 1.818757e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5727e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9085
    reference variance = 0.467291
====================================================
  Execution time = 2.0744e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3422e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5402e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333320781836
                                         uncertainty =       0.004912596273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333320781836
                                         uncertainty =       0.004912596273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408788758
  error estimate for blocks of size 2^( 2) =       0.000421641243
  error estimate for blocks of size 2^( 3) =       0.000435006206
  error estimate for blocks of size 2^( 4) =       0.000447421061
  error estimate for blocks of size 2^( 5) =       0.000455906074
  error estimate for blocks of size 2^( 6) =       0.000461775367
  error estimate for blocks of size 2^( 7) =       0.000465514709

      target function =                  N/A
              le_mean =     -16.905680863964
             les_mean =     286.136261804172
             stat err =       0.000457654303
             autocorr =       1.253363989160
              std dev =       0.578114605478
             le_variance =       0.334216497066


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690568086396e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905680863964       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905682325681       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905695720343       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905701251642       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905702625769       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905710359955       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905715509657       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905726757429       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905726333591       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905729805370       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905736260230       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905739344462       residual = 9.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905741401997       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905741845909       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905740563970       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905743707724       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905745102979       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905745019438       residual = 6.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905744666548       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905744333876       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905744743912       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905745313321       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905745499527       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.311603e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905680863964       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905682072490       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905690831474       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905695668459       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905694933891       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905700759716       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905704050351       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905708545019       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905707212649       residual = 5.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905707291105       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905708880709       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905709314857       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905709466227       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905709508070       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905709296654       residual = 6.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 6.521440e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905680863964       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905681577861       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905685157251       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905688528299       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905687722842       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905689277385       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905690770978       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905691467104       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905691043567       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905690815383       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905691150627       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905691103954       residual = 3.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.435571e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123056 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6317e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.073314e-01 1 1  ON 0
 uu_1                 1.414769e-01 1 1  ON 1
 uu_2                 4.045480e-02 1 1  ON 2
 uu_3                -2.050283e-02 1 1  ON 3
 uu_4                -6.407854e-02 1 1  ON 4
 uu_5                -9.668286e-02 1 1  ON 5
 uu_6                -1.225453e-01 1 1  ON 6
 uu_7                -1.339888e-01 1 1  ON 7
 uu_8                -1.248004e-01 1 1  ON 8
 uu_9                -9.511055e-02 1 1  ON 9
 ud_0                 4.374335e-01 1 1  ON 10
 ud_1                 1.741131e-01 1 1  ON 11
 ud_2                 5.847310e-02 1 1  ON 12
 ud_3                -9.117666e-03 1 1  ON 13
 ud_4                -6.473963e-02 1 1  ON 14
 ud_5                -1.050401e-01 1 1  ON 15
 ud_6                -1.311738e-01 1 1  ON 16
 ud_7                -1.470158e-01 1 1  ON 17
 ud_8                -1.478727e-01 1 1  ON 18
 ud_9                -1.377817e-01 1 1  ON 19
 eO_0                -7.429759e-01 1 1  ON 20
 eO_1                -4.282222e-01 1 1  ON 21
 eO_2                -1.710816e-02 1 1  ON 22
 eO_3                 2.932295e-01 1 1  ON 23
 eO_4                 5.090240e-01 1 1  ON 24
 eO_5                 4.664356e-01 1 1  ON 25
 eO_6                 2.382193e-01 1 1  ON 26
 eO_7                -5.476228e-02 1 1  ON 27
 eO_8                -2.029739e-01 1 1  ON 28
 eO_9                -6.304624e-02 1 1  ON 29
eH1_0                -2.286289e-01 1 1  ON 30
eH1_1                -1.322984e-01 1 1  ON 31
eH1_2                -8.799730e-02 1 1  ON 32
eH1_3                -3.508458e-02 1 1  ON 33
eH1_4                 1.247857e-02 1 1  ON 34
eH1_5                 4.531930e-02 1 1  ON 35
eH1_6                 9.760919e-02 1 1  ON 36
eH1_7                 1.411283e-01 1 1  ON 37
eH1_8                 1.530823e-01 1 1  ON 38
eH1_9                 3.910178e-02 1 1  ON 39
eH2_0                -2.269345e-01 1 1  ON 40
eH2_1                -1.301906e-01 1 1  ON 41
eH2_2                -8.616255e-02 1 1  ON 42
eH2_3                -3.339704e-02 1 1  ON 43
eH2_4                 1.440152e-02 1 1  ON 44
eH2_5                 4.842439e-02 1 1  ON 45
eH2_6                 1.022086e-01 1 1  ON 46
eH2_7                 1.493467e-01 1 1  ON 47
eH2_8                 1.594689e-01 1 1  ON 48
eH2_9                 2.091124e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9259
    reference variance = 0.282266
====================================================
  Execution time = 2.0400e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3608e-01
  Total weights = 2.0000e+06
  Execution time = 1.8984e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334222377982
                                         uncertainty =       0.005524462273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334222377982
                                         uncertainty =       0.005524462273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408768755
  error estimate for blocks of size 2^( 2) =       0.000421677415
  error estimate for blocks of size 2^( 3) =       0.000434281681
  error estimate for blocks of size 2^( 4) =       0.000446024524
  error estimate for blocks of size 2^( 5) =       0.000455391195
  error estimate for blocks of size 2^( 6) =       0.000461026933
  error estimate for blocks of size 2^( 7) =       0.000466296110

      target function =                  N/A
              le_mean =     -16.906385123013
             les_mean =     286.160041549879
             stat err =       0.000457184691
             autocorr =       1.250915501620
              std dev =       0.578086316508
             le_variance =       0.334183789334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337492792568
                                         uncertainty =       0.005489888356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337492792568
                                         uncertainty =       0.005489888356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410763120
  error estimate for blocks of size 2^( 2) =       0.000423563148
  error estimate for blocks of size 2^( 3) =       0.000435997946
  error estimate for blocks of size 2^( 4) =       0.000447567213
  error estimate for blocks of size 2^( 5) =       0.000456817853
  error estimate for blocks of size 2^( 6) =       0.000462323811
  error estimate for blocks of size 2^( 7) =       0.000467594275

      target function =                  N/A
              le_mean =     -16.906384267379
             les_mean =     286.163281509641
             stat err =       0.000458575788
             autocorr =       1.246348091145
              std dev =       0.580906775741
             le_variance =       0.337452682101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338144500066
                                         uncertainty =       0.005524778456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338144500066
                                         uncertainty =       0.005524778456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411159334
  error estimate for blocks of size 2^( 2) =       0.000423937138
  error estimate for blocks of size 2^( 3) =       0.000436352960
  error estimate for blocks of size 2^( 4) =       0.000447921689
  error estimate for blocks of size 2^( 5) =       0.000457194249
  error estimate for blocks of size 2^( 6) =       0.000462706999
  error estimate for blocks of size 2^( 7) =       0.000467977996

      target function =                  N/A
              le_mean =     -16.906389907468
             les_mean =     286.164123529574
             stat err =       0.000458950233
             autocorr =       1.245979458418
              std dev =       0.581467105951
             le_variance =       0.338103995303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335103919455
                                         uncertainty =       0.005537108896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335103919455
                                         uncertainty =       0.005537108896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409307256
  error estimate for blocks of size 2^( 2) =       0.000422179951
  error estimate for blocks of size 2^( 3) =       0.000434738101
  error estimate for blocks of size 2^( 4) =       0.000446442435
  error estimate for blocks of size 2^( 5) =       0.000455792741
  error estimate for blocks of size 2^( 6) =       0.000461402831
  error estimate for blocks of size 2^( 7) =       0.000466669386

      target function =                  N/A
              le_mean =     -16.906377691297
             les_mean =     286.160671332282
             stat err =       0.000457576848
             autocorr =       1.249767417980
              std dev =       0.578847872105
             le_variance =       0.335064859040


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906385123013        initial
     1.5625e-02     1.5625e-01             1.3116e-02       -16.906384267379
     6.2500e-02     6.2500e-01             6.5214e-03       -16.906389907468  <--
     2.5000e-01     2.5000e+00             2.4356e-03       -16.906377691297

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 3.2477e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.073314e-01 1 1  ON 0
 uu_1                 1.414769e-01 1 1  ON 1
 uu_2                 4.045480e-02 1 1  ON 2
 uu_3                -2.050283e-02 1 1  ON 3
 uu_4                -6.407854e-02 1 1  ON 4
 uu_5                -9.668286e-02 1 1  ON 5
 uu_6                -1.225453e-01 1 1  ON 6
 uu_7                -1.339888e-01 1 1  ON 7
 uu_8                -1.248004e-01 1 1  ON 8
 uu_9                -9.511055e-02 1 1  ON 9
 ud_0                 4.374335e-01 1 1  ON 10
 ud_1                 1.741131e-01 1 1  ON 11
 ud_2                 5.847310e-02 1 1  ON 12
 ud_3                -9.117666e-03 1 1  ON 13
 ud_4                -6.473963e-02 1 1  ON 14
 ud_5                -1.050401e-01 1 1  ON 15
 ud_6                -1.311738e-01 1 1  ON 16
 ud_7                -1.470158e-01 1 1  ON 17
 ud_8                -1.478727e-01 1 1  ON 18
 ud_9                -1.377817e-01 1 1  ON 19
 eO_0                -7.429759e-01 1 1  ON 20
 eO_1                -4.282222e-01 1 1  ON 21
 eO_2                -1.710816e-02 1 1  ON 22
 eO_3                 2.932295e-01 1 1  ON 23
 eO_4                 5.090240e-01 1 1  ON 24
 eO_5                 4.664356e-01 1 1  ON 25
 eO_6                 2.382193e-01 1 1  ON 26
 eO_7                -5.476228e-02 1 1  ON 27
 eO_8                -2.029739e-01 1 1  ON 28
 eO_9                -6.304624e-02 1 1  ON 29
eH1_0                -2.286289e-01 1 1  ON 30
eH1_1                -1.322984e-01 1 1  ON 31
eH1_2                -8.799730e-02 1 1  ON 32
eH1_3                -3.508458e-02 1 1  ON 33
eH1_4                 1.247857e-02 1 1  ON 34
eH1_5                 4.531930e-02 1 1  ON 35
eH1_6                 9.760919e-02 1 1  ON 36
eH1_7                 1.411283e-01 1 1  ON 37
eH1_8                 1.530823e-01 1 1  ON 38
eH1_9                 3.910178e-02 1 1  ON 39
eH2_0                -2.269345e-01 1 1  ON 40
eH2_1                -1.301906e-01 1 1  ON 41
eH2_2                -8.616255e-02 1 1  ON 42
eH2_3                -3.339704e-02 1 1  ON 43
eH2_4                 1.440152e-02 1 1  ON 44
eH2_5                 4.842439e-02 1 1  ON 45
eH2_6                 1.022086e-01 1 1  ON 46
eH2_7                 1.493467e-01 1 1  ON 47
eH2_8                 1.594689e-01 1 1  ON 48
eH2_9                 2.091124e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8870e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9486
    reference variance = 0.161479
====================================================
  Execution time = 2.1087e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2980e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6860e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329808881476
                                         uncertainty =       0.002762432372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329808881476
                                         uncertainty =       0.002762432372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406077621
  error estimate for blocks of size 2^( 2) =       0.000419071312
  error estimate for blocks of size 2^( 3) =       0.000432585809
  error estimate for blocks of size 2^( 4) =       0.000444847079
  error estimate for blocks of size 2^( 5) =       0.000454384664
  error estimate for blocks of size 2^( 6) =       0.000461252661
  error estimate for blocks of size 2^( 7) =       0.000467288673

      target function =                  N/A
              le_mean =     -16.906111850058
             les_mean =     286.146415790617
             stat err =       0.000456943269
             autocorr =       1.266212090687
              std dev =       0.574280479257
             le_variance =       0.329798068855


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611185006e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906111850058       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906116261370       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906122497315       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906123392488       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906128429750       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906135975981       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906140394128       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906146829441       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906147230449       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906146191711       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906144986844       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906149869329       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906150536469       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906153010136       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906152411690       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906153823062       residual = 8.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906154925156       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906154641227       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906154108877       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906154075596       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906154697884       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906154879763       residual = 6.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.176290e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906111850058       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906115123298       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906119337249       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906119867730       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906123373469       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906127175001       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906127915686       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906130016774       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906130092153       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906129506731       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906128627846       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906129334900       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906129513392       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906129721201       residual = 6.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.923662e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906111850058       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906113460937       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906115928834       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906116053328       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906117307751       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906117401935       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906117556849       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906117705696       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906117972554       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906117780329       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906117789190       residual = 5.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.227592e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145037 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9867e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.083403e-01 1 1  ON 0
 uu_1                 1.419212e-01 1 1  ON 1
 uu_2                 4.100087e-02 1 1  ON 2
 uu_3                -2.043185e-02 1 1  ON 3
 uu_4                -6.426583e-02 1 1  ON 4
 uu_5                -9.679117e-02 1 1  ON 5
 uu_6                -1.225882e-01 1 1  ON 6
 uu_7                -1.343554e-01 1 1  ON 7
 uu_8                -1.266457e-01 1 1  ON 8
 uu_9                -9.722160e-02 1 1  ON 9
 ud_0                 4.399659e-01 1 1  ON 10
 ud_1                 1.759380e-01 1 1  ON 11
 ud_2                 5.992651e-02 1 1  ON 12
 ud_3                -8.409613e-03 1 1  ON 13
 ud_4                -6.476559e-02 1 1  ON 14
 ud_5                -1.059126e-01 1 1  ON 15
 ud_6                -1.326483e-01 1 1  ON 16
 ud_7                -1.482284e-01 1 1  ON 17
 ud_8                -1.490764e-01 1 1  ON 18
 ud_9                -1.391931e-01 1 1  ON 19
 eO_0                -7.463592e-01 1 1  ON 20
 eO_1                -4.309668e-01 1 1  ON 21
 eO_2                -1.764915e-02 1 1  ON 22
 eO_3                 2.947408e-01 1 1  ON 23
 eO_4                 5.128880e-01 1 1  ON 24
 eO_5                 4.703592e-01 1 1  ON 25
 eO_6                 2.405100e-01 1 1  ON 26
 eO_7                -5.376702e-02 1 1  ON 27
 eO_8                -2.059811e-01 1 1  ON 28
 eO_9                -6.570883e-02 1 1  ON 29
eH1_0                -2.308332e-01 1 1  ON 30
eH1_1                -1.340775e-01 1 1  ON 31
eH1_2                -8.980355e-02 1 1  ON 32
eH1_3                -3.637576e-02 1 1  ON 33
eH1_4                 1.144820e-02 1 1  ON 34
eH1_5                 4.414597e-02 1 1  ON 35
eH1_6                 9.872761e-02 1 1  ON 36
eH1_7                 1.439885e-01 1 1  ON 37
eH1_8                 1.559124e-01 1 1  ON 38
eH1_9                 4.155974e-02 1 1  ON 39
eH2_0                -2.286631e-01 1 1  ON 40
eH2_1                -1.311667e-01 1 1  ON 41
eH2_2                -8.684549e-02 1 1  ON 42
eH2_3                -3.345372e-02 1 1  ON 43
eH2_4                 1.401976e-02 1 1  ON 44
eH2_5                 4.802263e-02 1 1  ON 45
eH2_6                 1.018676e-01 1 1  ON 46
eH2_7                 1.492009e-01 1 1  ON 47
eH2_8                 1.612072e-01 1 1  ON 48
eH2_9                 2.371622e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8125
    reference variance = 0.658017
====================================================
  Execution time = 2.0841e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3847e-01
  Total weights = 2.0000e+06
  Execution time = 1.9038e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337319745895
                                         uncertainty =       0.003173668943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337319745895
                                         uncertainty =       0.003173668943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410698756
  error estimate for blocks of size 2^( 2) =       0.000423485133
  error estimate for blocks of size 2^( 3) =       0.000436838216
  error estimate for blocks of size 2^( 4) =       0.000449544655
  error estimate for blocks of size 2^( 5) =       0.000462225487
  error estimate for blocks of size 2^( 6) =       0.000470056136
  error estimate for blocks of size 2^( 7) =       0.000473683403

      target function =                  N/A
              le_mean =     -16.905495289686
             les_mean =     286.133117757611
             stat err =       0.000463877420
             autocorr =       1.275732709550
              std dev =       0.580815751076
             le_variance =       0.337346936698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339390836813
                                         uncertainty =       0.003192423276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339390836813
                                         uncertainty =       0.003192423276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411957175
  error estimate for blocks of size 2^( 2) =       0.000424686999
  error estimate for blocks of size 2^( 3) =       0.000437950266
  error estimate for blocks of size 2^( 4) =       0.000450550804
  error estimate for blocks of size 2^( 5) =       0.000463174875
  error estimate for blocks of size 2^( 6) =       0.000470972128
  error estimate for blocks of size 2^( 7) =       0.000474602429

      target function =                  N/A
              le_mean =     -16.905491783311
             les_mean =     286.135069694740
             stat err =       0.000464825059
             autocorr =       1.273136362006
              std dev =       0.582595424675
             le_variance =       0.339417428852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339605485108
                                         uncertainty =       0.003193471062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339605485108
                                         uncertainty =       0.003193471062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412087652
  error estimate for blocks of size 2^( 2) =       0.000424813240
  error estimate for blocks of size 2^( 3) =       0.000438079309
  error estimate for blocks of size 2^( 4) =       0.000450692835
  error estimate for blocks of size 2^( 5) =       0.000463341683
  error estimate for blocks of size 2^( 6) =       0.000471155560
  error estimate for blocks of size 2^( 7) =       0.000474800982

      target function =                  N/A
              le_mean =     -16.905490443807
             les_mean =     286.135239441832
             stat err =       0.000464997765
             autocorr =       1.273275926434
              std dev =       0.582779946462
             le_variance =       0.339632465998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337815148235
                                         uncertainty =       0.003177890492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337815148235
                                         uncertainty =       0.003177890492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411000221
  error estimate for blocks of size 2^( 2) =       0.000423771227
  error estimate for blocks of size 2^( 3) =       0.000437105090
  error estimate for blocks of size 2^( 4) =       0.000449793616
  error estimate for blocks of size 2^( 5) =       0.000462469448
  error estimate for blocks of size 2^( 6) =       0.000470298646
  error estimate for blocks of size 2^( 7) =       0.000473932436

      target function =                  N/A
              le_mean =     -16.905490360707
             les_mean =     286.133446529947
             stat err =       0.000464123536
             autocorr =       1.275214008086
              std dev =       0.581242086318
             le_variance =       0.337842362907


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905495289686        initial  <--
     1.5625e-02     1.5625e-01             1.1763e-02       -16.905491783311
     6.2500e-02     6.2500e-01             3.9237e-03       -16.905490443807
     2.5000e-01     2.5000e+00             1.2276e-03       -16.905490360707

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3969
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.073314e-01 1 1  ON 0
 uu_1                 1.414769e-01 1 1  ON 1
 uu_2                 4.045480e-02 1 1  ON 2
 uu_3                -2.050283e-02 1 1  ON 3
 uu_4                -6.407854e-02 1 1  ON 4
 uu_5                -9.668286e-02 1 1  ON 5
 uu_6                -1.225453e-01 1 1  ON 6
 uu_7                -1.339888e-01 1 1  ON 7
 uu_8                -1.248004e-01 1 1  ON 8
 uu_9                -9.511055e-02 1 1  ON 9
 ud_0                 4.374335e-01 1 1  ON 10
 ud_1                 1.741131e-01 1 1  ON 11
 ud_2                 5.847310e-02 1 1  ON 12
 ud_3                -9.117666e-03 1 1  ON 13
 ud_4                -6.473963e-02 1 1  ON 14
 ud_5                -1.050401e-01 1 1  ON 15
 ud_6                -1.311738e-01 1 1  ON 16
 ud_7                -1.470158e-01 1 1  ON 17
 ud_8                -1.478727e-01 1 1  ON 18
 ud_9                -1.377817e-01 1 1  ON 19
 eO_0                -7.429759e-01 1 1  ON 20
 eO_1                -4.282222e-01 1 1  ON 21
 eO_2                -1.710816e-02 1 1  ON 22
 eO_3                 2.932295e-01 1 1  ON 23
 eO_4                 5.090240e-01 1 1  ON 24
 eO_5                 4.664356e-01 1 1  ON 25
 eO_6                 2.382193e-01 1 1  ON 26
 eO_7                -5.476228e-02 1 1  ON 27
 eO_8                -2.029739e-01 1 1  ON 28
 eO_9                -6.304624e-02 1 1  ON 29
eH1_0                -2.286289e-01 1 1  ON 30
eH1_1                -1.322984e-01 1 1  ON 31
eH1_2                -8.799730e-02 1 1  ON 32
eH1_3                -3.508458e-02 1 1  ON 33
eH1_4                 1.247857e-02 1 1  ON 34
eH1_5                 4.531930e-02 1 1  ON 35
eH1_6                 9.760919e-02 1 1  ON 36
eH1_7                 1.411283e-01 1 1  ON 37
eH1_8                 1.530823e-01 1 1  ON 38
eH1_9                 3.910178e-02 1 1  ON 39
eH2_0                -2.269345e-01 1 1  ON 40
eH2_1                -1.301906e-01 1 1  ON 41
eH2_2                -8.616255e-02 1 1  ON 42
eH2_3                -3.339704e-02 1 1  ON 43
eH2_4                 1.440152e-02 1 1  ON 44
eH2_5                 4.842439e-02 1 1  ON 45
eH2_6                 1.022086e-01 1 1  ON 46
eH2_7                 1.493467e-01 1 1  ON 47
eH2_8                 1.594689e-01 1 1  ON 48
eH2_9                 2.091124e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0524e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8619
    reference variance = 0.194057
====================================================
  Execution time = 2.0792e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3606e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6394e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336037928636
                                         uncertainty =       0.003561725385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336037928636
                                         uncertainty =       0.003561725385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409912613
  error estimate for blocks of size 2^( 2) =       0.000423275049
  error estimate for blocks of size 2^( 3) =       0.000436227542
  error estimate for blocks of size 2^( 4) =       0.000447700957
  error estimate for blocks of size 2^( 5) =       0.000457776820
  error estimate for blocks of size 2^( 6) =       0.000465715237
  error estimate for blocks of size 2^( 7) =       0.000470447116

      target function =                  N/A
              le_mean =     -16.905550142469
             les_mean =     286.133682151310
             stat err =       0.000460410033
             autocorr =       1.261557340129
              std dev =       0.579703976020
             le_variance =       0.336056699813


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690555014247e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905550142469       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905552503857       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905552769738       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905553105915       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905558028394       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905556980531       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905557695339       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905559384103       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905559715021       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905559221079       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905559054954       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905558815263       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 2.188531e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905550142469       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905551130395       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905551644088       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905551916782       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905553650156       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905552991374       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905553294747       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905553578300       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905553575550       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 6.322564e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905550142469       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905550439452       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905550709165       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905550793495       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905551252238       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905551095269       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905551180486       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905551227894       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905551221170       residual = 2.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.649456e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148730 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6439e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.074272e-01 1 1  ON 0
 uu_1                 1.413393e-01 1 1  ON 1
 uu_2                 4.060785e-02 1 1  ON 2
 uu_3                -2.058287e-02 1 1  ON 3
 uu_4                -6.407073e-02 1 1  ON 4
 uu_5                -9.671874e-02 1 1  ON 5
 uu_6                -1.224084e-01 1 1  ON 6
 uu_7                -1.339799e-01 1 1  ON 7
 uu_8                -1.249930e-01 1 1  ON 8
 uu_9                -9.533037e-02 1 1  ON 9
 ud_0                 4.378012e-01 1 1  ON 10
 ud_1                 1.743918e-01 1 1  ON 11
 ud_2                 5.864708e-02 1 1  ON 12
 ud_3                -9.075261e-03 1 1  ON 13
 ud_4                -6.484507e-02 1 1  ON 14
 ud_5                -1.051059e-01 1 1  ON 15
 ud_6                -1.312734e-01 1 1  ON 16
 ud_7                -1.470464e-01 1 1  ON 17
 ud_8                -1.481877e-01 1 1  ON 18
 ud_9                -1.379844e-01 1 1  ON 19
 eO_0                -7.435395e-01 1 1  ON 20
 eO_1                -4.286691e-01 1 1  ON 21
 eO_2                -1.711654e-02 1 1  ON 22
 eO_3                 2.935683e-01 1 1  ON 23
 eO_4                 5.096563e-01 1 1  ON 24
 eO_5                 4.666888e-01 1 1  ON 25
 eO_6                 2.384604e-01 1 1  ON 26
 eO_7                -5.460549e-02 1 1  ON 27
 eO_8                -2.033066e-01 1 1  ON 28
 eO_9                -6.329499e-02 1 1  ON 29
eH1_0                -2.289914e-01 1 1  ON 30
eH1_1                -1.324675e-01 1 1  ON 31
eH1_2                -8.800040e-02 1 1  ON 32
eH1_3                -3.522285e-02 1 1  ON 33
eH1_4                 1.249847e-02 1 1  ON 34
eH1_5                 4.531599e-02 1 1  ON 35
eH1_6                 9.767027e-02 1 1  ON 36
eH1_7                 1.413001e-01 1 1  ON 37
eH1_8                 1.532506e-01 1 1  ON 38
eH1_9                 3.932835e-02 1 1  ON 39
eH2_0                -2.271963e-01 1 1  ON 40
eH2_1                -1.303658e-01 1 1  ON 41
eH2_2                -8.608038e-02 1 1  ON 42
eH2_3                -3.342250e-02 1 1  ON 43
eH2_4                 1.431683e-02 1 1  ON 44
eH2_5                 4.835664e-02 1 1  ON 45
eH2_6                 1.022811e-01 1 1  ON 46
eH2_7                 1.494105e-01 1 1  ON 47
eH2_8                 1.596456e-01 1 1  ON 48
eH2_9                 2.115665e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9309
    reference variance = 0.355428
====================================================
  Execution time = 2.0254e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3394e-01
  Total weights = 2.0000e+06
  Execution time = 1.9063e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333815102276
                                         uncertainty =       0.004354104255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333815102276
                                         uncertainty =       0.004354104255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408582889
  error estimate for blocks of size 2^( 2) =       0.000421716274
  error estimate for blocks of size 2^( 3) =       0.000435357740
  error estimate for blocks of size 2^( 4) =       0.000448375783
  error estimate for blocks of size 2^( 5) =       0.000459497439
  error estimate for blocks of size 2^( 6) =       0.000467640337
  error estimate for blocks of size 2^( 7) =       0.000473959075

      target function =                  N/A
              le_mean =     -16.904670186840
             les_mean =     286.101753913232
             stat err =       0.000462368159
             autocorr =       1.280605866834
              std dev =       0.577823462956
             le_variance =       0.333879954342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334108769341
                                         uncertainty =       0.004360577228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334108769341
                                         uncertainty =       0.004360577228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408762583
  error estimate for blocks of size 2^( 2) =       0.000421889827
  error estimate for blocks of size 2^( 3) =       0.000435520763
  error estimate for blocks of size 2^( 4) =       0.000448519318
  error estimate for blocks of size 2^( 5) =       0.000459619568
  error estimate for blocks of size 2^( 6) =       0.000467746689
  error estimate for blocks of size 2^( 7) =       0.000474061531

      target function =                  N/A
              le_mean =     -16.904666156238
             les_mean =     286.101911384926
             stat err =       0.000462486777
             autocorr =       1.280136765109
              std dev =       0.578077588347
             le_variance =       0.334173698150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333944220905
                                         uncertainty =       0.004358904359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333944220905
                                         uncertainty =       0.004358904359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408661891
  error estimate for blocks of size 2^( 2) =       0.000421794381
  error estimate for blocks of size 2^( 3) =       0.000435433699
  error estimate for blocks of size 2^( 4) =       0.000448442489
  error estimate for blocks of size 2^( 5) =       0.000459549649
  error estimate for blocks of size 2^( 6) =       0.000467683294
  error estimate for blocks of size 2^( 7) =       0.000474002221

      target function =                  N/A
              le_mean =     -16.904665869864
             les_mean =     286.101737087242
             stat err =       0.000462419413
             autocorr =       1.280394606875
              std dev =       0.577935188839
             le_variance =       0.334009082498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333821585599
                                         uncertainty =       0.004354808975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333821585599
                                         uncertainty =       0.004354808975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408586856
  error estimate for blocks of size 2^( 2) =       0.000421720557
  error estimate for blocks of size 2^( 3) =       0.000435362237
  error estimate for blocks of size 2^( 4) =       0.000448379328
  error estimate for blocks of size 2^( 5) =       0.000459498822
  error estimate for blocks of size 2^( 6) =       0.000467640536
  error estimate for blocks of size 2^( 7) =       0.000473959637

      target function =                  N/A
              le_mean =     -16.904669200612
             les_mean =     286.101727053267
             stat err =       0.000462369581
             autocorr =       1.280588876201
              std dev =       0.577829073411
             le_variance =       0.333886438079


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904670186840        initial  <--
     1.5625e-01     1.5625e+00             2.1885e-03       -16.904666156238
     6.2500e-01     6.2500e+00             6.3226e-04       -16.904665869864
     2.5000e+00     2.5000e+01             1.6495e-04       -16.904669200612

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8300
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.073314e-01 1 1  ON 0
 uu_1                 1.414769e-01 1 1  ON 1
 uu_2                 4.045480e-02 1 1  ON 2
 uu_3                -2.050283e-02 1 1  ON 3
 uu_4                -6.407854e-02 1 1  ON 4
 uu_5                -9.668286e-02 1 1  ON 5
 uu_6                -1.225453e-01 1 1  ON 6
 uu_7                -1.339888e-01 1 1  ON 7
 uu_8                -1.248004e-01 1 1  ON 8
 uu_9                -9.511055e-02 1 1  ON 9
 ud_0                 4.374335e-01 1 1  ON 10
 ud_1                 1.741131e-01 1 1  ON 11
 ud_2                 5.847310e-02 1 1  ON 12
 ud_3                -9.117666e-03 1 1  ON 13
 ud_4                -6.473963e-02 1 1  ON 14
 ud_5                -1.050401e-01 1 1  ON 15
 ud_6                -1.311738e-01 1 1  ON 16
 ud_7                -1.470158e-01 1 1  ON 17
 ud_8                -1.478727e-01 1 1  ON 18
 ud_9                -1.377817e-01 1 1  ON 19
 eO_0                -7.429759e-01 1 1  ON 20
 eO_1                -4.282222e-01 1 1  ON 21
 eO_2                -1.710816e-02 1 1  ON 22
 eO_3                 2.932295e-01 1 1  ON 23
 eO_4                 5.090240e-01 1 1  ON 24
 eO_5                 4.664356e-01 1 1  ON 25
 eO_6                 2.382193e-01 1 1  ON 26
 eO_7                -5.476228e-02 1 1  ON 27
 eO_8                -2.029739e-01 1 1  ON 28
 eO_9                -6.304624e-02 1 1  ON 29
eH1_0                -2.286289e-01 1 1  ON 30
eH1_1                -1.322984e-01 1 1  ON 31
eH1_2                -8.799730e-02 1 1  ON 32
eH1_3                -3.508458e-02 1 1  ON 33
eH1_4                 1.247857e-02 1 1  ON 34
eH1_5                 4.531930e-02 1 1  ON 35
eH1_6                 9.760919e-02 1 1  ON 36
eH1_7                 1.411283e-01 1 1  ON 37
eH1_8                 1.530823e-01 1 1  ON 38
eH1_9                 3.910178e-02 1 1  ON 39
eH2_0                -2.269345e-01 1 1  ON 40
eH2_1                -1.301906e-01 1 1  ON 41
eH2_2                -8.616255e-02 1 1  ON 42
eH2_3                -3.339704e-02 1 1  ON 43
eH2_4                 1.440152e-02 1 1  ON 44
eH2_5                 4.842439e-02 1 1  ON 45
eH2_6                 1.022086e-01 1 1  ON 46
eH2_7                 1.493467e-01 1 1  ON 47
eH2_8                 1.594689e-01 1 1  ON 48
eH2_9                 2.091124e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6277e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9213
    reference variance = 0.568071
====================================================
  Execution time = 2.1441e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3857e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6535e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338601790206
                                         uncertainty =       0.004670725766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338601790206
                                         uncertainty =       0.004670725766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411444651
  error estimate for blocks of size 2^( 2) =       0.000424475282
  error estimate for blocks of size 2^( 3) =       0.000438579550
  error estimate for blocks of size 2^( 4) =       0.000451575785
  error estimate for blocks of size 2^( 5) =       0.000463661129
  error estimate for blocks of size 2^( 6) =       0.000473361470
  error estimate for blocks of size 2^( 7) =       0.000480361519

      target function =                  N/A
              le_mean =     -16.905654365233
             les_mean =     286.139722749542
             stat err =       0.000467239976
             autocorr =       1.289606292454
              std dev =       0.581870605980
             le_variance =       0.338573402104


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690565436523e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905654365233       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905654496832       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905654588499       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905654309573       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905654385737       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905654536057       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905654606552       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905654620585       residual = 9.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 2.776044e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905654365233       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905654400927       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905654430285       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905654363099       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905654382767       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905654408249       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905654430505       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905654432495       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 7.175016e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905654365233       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905654374350       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905654382183       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905654365661       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905654370804       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905654376204       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905654382006       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905654382506       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.809753e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151438 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7102e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.073370e-01 1 1  ON 0
 uu_1                 1.414681e-01 1 1  ON 1
 uu_2                 4.045964e-02 1 1  ON 2
 uu_3                -2.051738e-02 1 1  ON 3
 uu_4                -6.409438e-02 1 1  ON 4
 uu_5                -9.668616e-02 1 1  ON 5
 uu_6                -1.225244e-01 1 1  ON 6
 uu_7                -1.339997e-01 1 1  ON 7
 uu_8                -1.248194e-01 1 1  ON 8
 uu_9                -9.511098e-02 1 1  ON 9
 ud_0                 4.374493e-01 1 1  ON 10
 ud_1                 1.741278e-01 1 1  ON 11
 ud_2                 5.848356e-02 1 1  ON 12
 ud_3                -9.116867e-03 1 1  ON 13
 ud_4                -6.476027e-02 1 1  ON 14
 ud_5                -1.050663e-01 1 1  ON 15
 ud_6                -1.311951e-01 1 1  ON 16
 ud_7                -1.470244e-01 1 1  ON 17
 ud_8                -1.478774e-01 1 1  ON 18
 ud_9                -1.377602e-01 1 1  ON 19
 eO_0                -7.430477e-01 1 1  ON 20
 eO_1                -4.282544e-01 1 1  ON 21
 eO_2                -1.710807e-02 1 1  ON 22
 eO_3                 2.932510e-01 1 1  ON 23
 eO_4                 5.090733e-01 1 1  ON 24
 eO_5                 4.664645e-01 1 1  ON 25
 eO_6                 2.382537e-01 1 1  ON 26
 eO_7                -5.475333e-02 1 1  ON 27
 eO_8                -2.029985e-01 1 1  ON 28
 eO_9                -6.305995e-02 1 1  ON 29
eH1_0                -2.286588e-01 1 1  ON 30
eH1_1                -1.323249e-01 1 1  ON 31
eH1_2                -8.800500e-02 1 1  ON 32
eH1_3                -3.510333e-02 1 1  ON 33
eH1_4                 1.245741e-02 1 1  ON 34
eH1_5                 4.532592e-02 1 1  ON 35
eH1_6                 9.763185e-02 1 1  ON 36
eH1_7                 1.411501e-01 1 1  ON 37
eH1_8                 1.531018e-01 1 1  ON 38
eH1_9                 3.912925e-02 1 1  ON 39
eH2_0                -2.269647e-01 1 1  ON 40
eH2_1                -1.302020e-01 1 1  ON 41
eH2_2                -8.617324e-02 1 1  ON 42
eH2_3                -3.341114e-02 1 1  ON 43
eH2_4                 1.438879e-02 1 1  ON 44
eH2_5                 4.841537e-02 1 1  ON 45
eH2_6                 1.022139e-01 1 1  ON 46
eH2_7                 1.493668e-01 1 1  ON 47
eH2_8                 1.594961e-01 1 1  ON 48
eH2_9                 2.094300e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8844
    reference variance = 0.170635
====================================================
  Execution time = 2.0573e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.4459e-01
  Total weights = 2.0000e+06
  Execution time = 1.8952e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344527830249
                                         uncertainty =       0.007872033672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344527830249
                                         uncertainty =       0.007872033672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415080895
  error estimate for blocks of size 2^( 2) =       0.000427844181
  error estimate for blocks of size 2^( 3) =       0.000441510178
  error estimate for blocks of size 2^( 4) =       0.000453775386
  error estimate for blocks of size 2^( 5) =       0.000465486105
  error estimate for blocks of size 2^( 6) =       0.000474062640
  error estimate for blocks of size 2^( 7) =       0.000483809397

      target function =                  N/A
              le_mean =     -16.904228450690
             les_mean =     286.097523639473
             stat err =       0.000469283382
             autocorr =       1.278217802323
              std dev =       0.587013031066
             le_variance =       0.344584298641

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344562451187
                                         uncertainty =       0.007878156274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344562451187
                                         uncertainty =       0.007878156274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415101740
  error estimate for blocks of size 2^( 2) =       0.000427864424
  error estimate for blocks of size 2^( 3) =       0.000441528948
  error estimate for blocks of size 2^( 4) =       0.000453793120
  error estimate for blocks of size 2^( 5) =       0.000465503563
  error estimate for blocks of size 2^( 6) =       0.000474079741
  error estimate for blocks of size 2^( 7) =       0.000483823741

      target function =                  N/A
              le_mean =     -16.904228227099
             les_mean =     286.097550689821
             stat err =       0.000469300041
             autocorr =       1.278180177697
              std dev =       0.587042509778
             le_variance =       0.344618908287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344541207435
                                         uncertainty =       0.007875279174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344541207435
                                         uncertainty =       0.007875279174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415088948
  error estimate for blocks of size 2^( 2) =       0.000427852082
  error estimate for blocks of size 2^( 3) =       0.000441517438
  error estimate for blocks of size 2^( 4) =       0.000453782282
  error estimate for blocks of size 2^( 5) =       0.000465492926
  error estimate for blocks of size 2^( 6) =       0.000474069343
  error estimate for blocks of size 2^( 7) =       0.000483814515

      target function =                  N/A
              le_mean =     -16.904228280417
             les_mean =     286.097531253259
             stat err =       0.000469289766
             autocorr =       1.278202986498
              std dev =       0.587024419513
             le_variance =       0.344597669104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344529331042
                                         uncertainty =       0.007872446958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344529331042
                                         uncertainty =       0.007872446958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415081798
  error estimate for blocks of size 2^( 2) =       0.000427845071
  error estimate for blocks of size 2^( 3) =       0.000441510992
  error estimate for blocks of size 2^( 4) =       0.000453776161
  error estimate for blocks of size 2^( 5) =       0.000465486873
  error estimate for blocks of size 2^( 6) =       0.000474063395
  error estimate for blocks of size 2^( 7) =       0.000483809946

      target function =                  N/A
              le_mean =     -16.904228425757
             les_mean =     286.097524296438
             stat err =       0.000469284094
             autocorr =       1.278216116603
              std dev =       0.587014308657
             le_variance =       0.344585798568


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904228450690        initial  <--
     1.5625e+00     1.5625e+01             2.7760e-04       -16.904228227099
     6.2500e+00     6.2500e+01             7.1750e-05       -16.904228280417
     2.5000e+01     2.5000e+02             1.8098e-05       -16.904228425757

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1103
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.073314e-01 1 1  ON 0
 uu_1                 1.414769e-01 1 1  ON 1
 uu_2                 4.045480e-02 1 1  ON 2
 uu_3                -2.050283e-02 1 1  ON 3
 uu_4                -6.407854e-02 1 1  ON 4
 uu_5                -9.668286e-02 1 1  ON 5
 uu_6                -1.225453e-01 1 1  ON 6
 uu_7                -1.339888e-01 1 1  ON 7
 uu_8                -1.248004e-01 1 1  ON 8
 uu_9                -9.511055e-02 1 1  ON 9
 ud_0                 4.374335e-01 1 1  ON 10
 ud_1                 1.741131e-01 1 1  ON 11
 ud_2                 5.847310e-02 1 1  ON 12
 ud_3                -9.117666e-03 1 1  ON 13
 ud_4                -6.473963e-02 1 1  ON 14
 ud_5                -1.050401e-01 1 1  ON 15
 ud_6                -1.311738e-01 1 1  ON 16
 ud_7                -1.470158e-01 1 1  ON 17
 ud_8                -1.478727e-01 1 1  ON 18
 ud_9                -1.377817e-01 1 1  ON 19
 eO_0                -7.429759e-01 1 1  ON 20
 eO_1                -4.282222e-01 1 1  ON 21
 eO_2                -1.710816e-02 1 1  ON 22
 eO_3                 2.932295e-01 1 1  ON 23
 eO_4                 5.090240e-01 1 1  ON 24
 eO_5                 4.664356e-01 1 1  ON 25
 eO_6                 2.382193e-01 1 1  ON 26
 eO_7                -5.476228e-02 1 1  ON 27
 eO_8                -2.029739e-01 1 1  ON 28
 eO_9                -6.304624e-02 1 1  ON 29
eH1_0                -2.286289e-01 1 1  ON 30
eH1_1                -1.322984e-01 1 1  ON 31
eH1_2                -8.799730e-02 1 1  ON 32
eH1_3                -3.508458e-02 1 1  ON 33
eH1_4                 1.247857e-02 1 1  ON 34
eH1_5                 4.531930e-02 1 1  ON 35
eH1_6                 9.760919e-02 1 1  ON 36
eH1_7                 1.411283e-01 1 1  ON 37
eH1_8                 1.530823e-01 1 1  ON 38
eH1_9                 3.910178e-02 1 1  ON 39
eH2_0                -2.269345e-01 1 1  ON 40
eH2_1                -1.301906e-01 1 1  ON 41
eH2_2                -8.616255e-02 1 1  ON 42
eH2_3                -3.339704e-02 1 1  ON 43
eH2_4                 1.440152e-02 1 1  ON 44
eH2_5                 4.842439e-02 1 1  ON 45
eH2_6                 1.022086e-01 1 1  ON 46
eH2_7                 1.493467e-01 1 1  ON 47
eH2_8                 1.594689e-01 1 1  ON 48
eH2_9                 2.091124e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7240e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.966
    reference variance = 0.181748
====================================================
  Execution time = 2.0742e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3864e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5538e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338566483425
                                         uncertainty =       0.006987244190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338566483425
                                         uncertainty =       0.006987244190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411486790
  error estimate for blocks of size 2^( 2) =       0.000424495143
  error estimate for blocks of size 2^( 3) =       0.000437532955
  error estimate for blocks of size 2^( 4) =       0.000450643540
  error estimate for blocks of size 2^( 5) =       0.000462362534
  error estimate for blocks of size 2^( 6) =       0.000471150211
  error estimate for blocks of size 2^( 7) =       0.000476170817

      target function =                  N/A
              le_mean =     -16.905404322105
             les_mean =     286.131337881955
             stat err =       0.000465081775
             autocorr =       1.277458637694
              std dev =       0.581930199806
             le_variance =       0.338642757446


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690540432210e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905404322105       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905404324294       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905404240329       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905404284523       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905404272389       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905404295516       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905404290050       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905404299682       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 2.667780e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905404322105       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905404322657       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905404301377       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905404312409       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905404309326       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905404315255       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905404313811       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905404316067       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 6.753154e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905404322105       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905404322243       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905404316904       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905404319661       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905404318887       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905404320379       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905404320013       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905404320567       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 1.693661e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154123 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6303e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.073341e-01 1 1  ON 0
 uu_1                 1.414746e-01 1 1  ON 1
 uu_2                 4.045480e-02 1 1  ON 2
 uu_3                -2.050470e-02 1 1  ON 3
 uu_4                -6.407902e-02 1 1  ON 4
 uu_5                -9.668315e-02 1 1  ON 5
 uu_6                -1.225445e-01 1 1  ON 6
 uu_7                -1.339890e-01 1 1  ON 7
 uu_8                -1.248013e-01 1 1  ON 8
 uu_9                -9.511084e-02 1 1  ON 9
 ud_0                 4.374403e-01 1 1  ON 10
 ud_1                 1.741142e-01 1 1  ON 11
 ud_2                 5.847345e-02 1 1  ON 12
 ud_3                -9.117101e-03 1 1  ON 13
 ud_4                -6.474046e-02 1 1  ON 14
 ud_5                -1.050433e-01 1 1  ON 15
 ud_6                -1.311744e-01 1 1  ON 16
 ud_7                -1.470159e-01 1 1  ON 17
 ud_8                -1.478744e-01 1 1  ON 18
 ud_9                -1.377833e-01 1 1  ON 19
 eO_0                -7.429823e-01 1 1  ON 20
 eO_1                -4.282246e-01 1 1  ON 21
 eO_2                -1.710920e-02 1 1  ON 22
 eO_3                 2.932312e-01 1 1  ON 23
 eO_4                 5.090302e-01 1 1  ON 24
 eO_5                 4.664387e-01 1 1  ON 25
 eO_6                 2.382215e-01 1 1  ON 26
 eO_7                -5.476063e-02 1 1  ON 27
 eO_8                -2.029761e-01 1 1  ON 28
 eO_9                -6.304859e-02 1 1  ON 29
eH1_0                -2.286318e-01 1 1  ON 30
eH1_1                -1.322987e-01 1 1  ON 31
eH1_2                -8.799852e-02 1 1  ON 32
eH1_3                -3.508466e-02 1 1  ON 33
eH1_4                 1.247778e-02 1 1  ON 34
eH1_5                 4.531856e-02 1 1  ON 35
eH1_6                 9.760928e-02 1 1  ON 36
eH1_7                 1.411296e-01 1 1  ON 37
eH1_8                 1.530848e-01 1 1  ON 38
eH1_9                 3.910421e-02 1 1  ON 39
eH2_0                -2.269372e-01 1 1  ON 40
eH2_1                -1.301936e-01 1 1  ON 41
eH2_2                -8.616375e-02 1 1  ON 42
eH2_3                -3.339706e-02 1 1  ON 43
eH2_4                 1.440050e-02 1 1  ON 44
eH2_5                 4.842535e-02 1 1  ON 45
eH2_6                 1.022089e-01 1 1  ON 46
eH2_7                 1.493476e-01 1 1  ON 47
eH2_8                 1.594715e-01 1 1  ON 48
eH2_9                 2.091439e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9623
    reference variance = 0.406365
====================================================
  Execution time = 2.0272e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3480e-01
  Total weights = 2.0000e+06
  Execution time = 1.9016e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334660674974
                                         uncertainty =       0.003416650524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334660674974
                                         uncertainty =       0.003416650524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409142364
  error estimate for blocks of size 2^( 2) =       0.000422128448
  error estimate for blocks of size 2^( 3) =       0.000435479984
  error estimate for blocks of size 2^( 4) =       0.000448660945
  error estimate for blocks of size 2^( 5) =       0.000461470649
  error estimate for blocks of size 2^( 6) =       0.000468516157
  error estimate for blocks of size 2^( 7) =       0.000475314837

      target function =                  N/A
              le_mean =     -16.905102222613
             les_mean =     286.117275937871
             stat err =       0.000463490647
             autocorr =       1.283314344147
              std dev =       0.578614680326
             le_variance =       0.334794948289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334683651932
                                         uncertainty =       0.003416936251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334683651932
                                         uncertainty =       0.003416936251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409156414
  error estimate for blocks of size 2^( 2) =       0.000422141819
  error estimate for blocks of size 2^( 3) =       0.000435492586
  error estimate for blocks of size 2^( 4) =       0.000448673006
  error estimate for blocks of size 2^( 5) =       0.000461482264
  error estimate for blocks of size 2^( 6) =       0.000468527383
  error estimate for blocks of size 2^( 7) =       0.000475325948

      target function =                  N/A
              le_mean =     -16.905102270703
             les_mean =     286.117300557726
             stat err =       0.000463502150
             autocorr =       1.283289909898
              std dev =       0.578634549798
             le_variance =       0.334817942220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334672334600
                                         uncertainty =       0.003416795642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334672334600
                                         uncertainty =       0.003416795642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409149494
  error estimate for blocks of size 2^( 2) =       0.000422135233
  error estimate for blocks of size 2^( 3) =       0.000435486379
  error estimate for blocks of size 2^( 4) =       0.000448667065
  error estimate for blocks of size 2^( 5) =       0.000461476544
  error estimate for blocks of size 2^( 6) =       0.000468521854
  error estimate for blocks of size 2^( 7) =       0.000475320477

      target function =                  N/A
              le_mean =     -16.905102246745
             les_mean =     286.117288421974
             stat err =       0.000463496485
             autocorr =       1.283301949189
              std dev =       0.578624763092
             le_variance =       0.334806616463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334662137733
                                         uncertainty =       0.003416668736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334662137733
                                         uncertainty =       0.003416668736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409143259
  error estimate for blocks of size 2^( 2) =       0.000422129299
  error estimate for blocks of size 2^( 3) =       0.000435480786
  error estimate for blocks of size 2^( 4) =       0.000448661712
  error estimate for blocks of size 2^( 5) =       0.000461471388
  error estimate for blocks of size 2^( 6) =       0.000468516872
  error estimate for blocks of size 2^( 7) =       0.000475315545

      target function =                  N/A
              le_mean =     -16.905102225615
             les_mean =     286.117277503228
             stat err =       0.000463491379
             autocorr =       1.283312789118
              std dev =       0.578615945267
             le_variance =       0.334796412117


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905102222613        initial
     1.5625e+01     1.5625e+02             2.6678e-05       -16.905102270703  <--
     6.2500e+01     6.2500e+02             6.7532e-06       -16.905102246745
     2.5000e+02     2.5000e+03             1.6937e-06       -16.905102225615

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 2.9826e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.073419e-01 1 1  ON 0
 uu_1                 1.414680e-01 1 1  ON 1
 uu_2                 4.045466e-02 1 1  ON 2
 uu_3                -2.051021e-02 1 1  ON 3
 uu_4                -6.408056e-02 1 1  ON 4
 uu_5                -9.668400e-02 1 1  ON 5
 uu_6                -1.225421e-01 1 1  ON 6
 uu_7                -1.339895e-01 1 1  ON 7
 uu_8                -1.248040e-01 1 1  ON 8
 uu_9                -9.511174e-02 1 1  ON 9
 ud_0                 4.374602e-01 1 1  ON 10
 ud_1                 1.741175e-01 1 1  ON 11
 ud_2                 5.847462e-02 1 1  ON 12
 ud_3                -9.115442e-03 1 1  ON 13
 ud_4                -6.474293e-02 1 1  ON 14
 ud_5                -1.050527e-01 1 1  ON 15
 ud_6                -1.311761e-01 1 1  ON 16
 ud_7                -1.470160e-01 1 1  ON 17
 ud_8                -1.478796e-01 1 1  ON 18
 ud_9                -1.377880e-01 1 1  ON 19
 eO_0                -7.430013e-01 1 1  ON 20
 eO_1                -4.282318e-01 1 1  ON 21
 eO_2                -1.711230e-02 1 1  ON 22
 eO_3                 2.932362e-01 1 1  ON 23
 eO_4                 5.090486e-01 1 1  ON 24
 eO_5                 4.664481e-01 1 1  ON 25
 eO_6                 2.382280e-01 1 1  ON 26
 eO_7                -5.475571e-02 1 1  ON 27
 eO_8                -2.029828e-01 1 1  ON 28
 eO_9                -6.305561e-02 1 1  ON 29
eH1_0                -2.286406e-01 1 1  ON 30
eH1_1                -1.322996e-01 1 1  ON 31
eH1_2                -8.800216e-02 1 1  ON 32
eH1_3                -3.508498e-02 1 1  ON 33
eH1_4                 1.247544e-02 1 1  ON 34
eH1_5                 4.531633e-02 1 1  ON 35
eH1_6                 9.760954e-02 1 1  ON 36
eH1_7                 1.411335e-01 1 1  ON 37
eH1_8                 1.530924e-01 1 1  ON 38
eH1_9                 3.911150e-02 1 1  ON 39
eH2_0                -2.269454e-01 1 1  ON 40
eH2_1                -1.302028e-01 1 1  ON 41
eH2_2                -8.616736e-02 1 1  ON 42
eH2_3                -3.339719e-02 1 1  ON 43
eH2_4                 1.439747e-02 1 1  ON 44
eH2_5                 4.842823e-02 1 1  ON 45
eH2_6                 1.022098e-01 1 1  ON 46
eH2_7                 1.493504e-01 1 1  ON 47
eH2_8                 1.594791e-01 1 1  ON 48
eH2_9                 2.092381e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6136e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8832
    reference variance = 0.217393
====================================================
  Execution time = 2.0742e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3420e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5912e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334227686604
                                         uncertainty =       0.003268707405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334227686604
                                         uncertainty =       0.003268707405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408777325
  error estimate for blocks of size 2^( 2) =       0.000421936229
  error estimate for blocks of size 2^( 3) =       0.000434966232
  error estimate for blocks of size 2^( 4) =       0.000447425953
  error estimate for blocks of size 2^( 5) =       0.000458953307
  error estimate for blocks of size 2^( 6) =       0.000468591839
  error estimate for blocks of size 2^( 7) =       0.000474563402

      target function =                  N/A
              le_mean =     -16.905587226441
             les_mean =     286.133077107202
             stat err =       0.000462383625
             autocorr =       1.279473500816
              std dev =       0.578098437543
             le_variance =       0.334197803490


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690558722644e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905587226441       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905587256789       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905587365343       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905587510467       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905587506116       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905587539471       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905587523197       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905587526306       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.222123e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905587226441       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905587234361       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905587261941       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905587301345       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905587301487       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905587307305       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905587301787       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905587303731       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 3.126256e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905587226441       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905587228443       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905587235367       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905587245429       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905587245557       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905587246849       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905587245366       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905587245926       residual = 4.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 7.863503e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156745 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6340e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.073472e-01 1 1  ON 0
 uu_1                 1.414624e-01 1 1  ON 1
 uu_2                 4.045406e-02 1 1  ON 2
 uu_3                -2.051557e-02 1 1  ON 3
 uu_4                -6.408262e-02 1 1  ON 4
 uu_5                -9.668606e-02 1 1  ON 5
 uu_6                -1.225456e-01 1 1  ON 6
 uu_7                -1.339930e-01 1 1  ON 7
 uu_8                -1.248062e-01 1 1  ON 8
 uu_9                -9.511039e-02 1 1  ON 9
 ud_0                 4.374735e-01 1 1  ON 10
 ud_1                 1.741203e-01 1 1  ON 11
 ud_2                 5.847367e-02 1 1  ON 12
 ud_3                -9.112636e-03 1 1  ON 13
 ud_4                -6.475281e-02 1 1  ON 14
 ud_5                -1.050567e-01 1 1  ON 15
 ud_6                -1.311861e-01 1 1  ON 16
 ud_7                -1.470147e-01 1 1  ON 17
 ud_8                -1.478780e-01 1 1  ON 18
 ud_9                -1.377867e-01 1 1  ON 19
 eO_0                -7.430326e-01 1 1  ON 20
 eO_1                -4.282368e-01 1 1  ON 21
 eO_2                -1.711294e-02 1 1  ON 22
 eO_3                 2.932437e-01 1 1  ON 23
 eO_4                 5.090670e-01 1 1  ON 24
 eO_5                 4.664652e-01 1 1  ON 25
 eO_6                 2.382329e-01 1 1  ON 26
 eO_7                -5.475072e-02 1 1  ON 27
 eO_8                -2.029898e-01 1 1  ON 28
 eO_9                -6.306310e-02 1 1  ON 29
eH1_0                -2.286512e-01 1 1  ON 30
eH1_1                -1.323041e-01 1 1  ON 31
eH1_2                -8.800824e-02 1 1  ON 32
eH1_3                -3.509572e-02 1 1  ON 33
eH1_4                 1.247832e-02 1 1  ON 34
eH1_5                 4.530823e-02 1 1  ON 35
eH1_6                 9.760553e-02 1 1  ON 36
eH1_7                 1.411416e-01 1 1  ON 37
eH1_8                 1.531093e-01 1 1  ON 38
eH1_9                 3.912631e-02 1 1  ON 39
eH2_0                -2.269612e-01 1 1  ON 40
eH2_1                -1.302101e-01 1 1  ON 41
eH2_2                -8.617302e-02 1 1  ON 42
eH2_3                -3.339241e-02 1 1  ON 43
eH2_4                 1.439474e-02 1 1  ON 44
eH2_5                 4.842249e-02 1 1  ON 45
eH2_6                 1.022141e-01 1 1  ON 46
eH2_7                 1.493561e-01 1 1  ON 47
eH2_8                 1.594891e-01 1 1  ON 48
eH2_9                 2.093671e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8698
    reference variance = 0.187468
====================================================
  Execution time = 2.0096e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3903e-01
  Total weights = 2.0000e+06
  Execution time = 1.9017e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338983508705
                                         uncertainty =       0.004061871472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338983508705
                                         uncertainty =       0.004061871472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411713767
  error estimate for blocks of size 2^( 2) =       0.000424300137
  error estimate for blocks of size 2^( 3) =       0.000437748374
  error estimate for blocks of size 2^( 4) =       0.000450601920
  error estimate for blocks of size 2^( 5) =       0.000461718578
  error estimate for blocks of size 2^( 6) =       0.000470539777
  error estimate for blocks of size 2^( 7) =       0.000476047696

      target function =                  N/A
              le_mean =     -16.905444718571
             les_mean =     286.133077414573
             stat err =       0.000464726993
             autocorr =       1.274104408033
              std dev =       0.582251192714
             le_variance =       0.339016451417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339034696424
                                         uncertainty =       0.004062558700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339034696424
                                         uncertainty =       0.004062558700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411744871
  error estimate for blocks of size 2^( 2) =       0.000424329685
  error estimate for blocks of size 2^( 3) =       0.000437776361
  error estimate for blocks of size 2^( 4) =       0.000450628386
  error estimate for blocks of size 2^( 5) =       0.000461743777
  error estimate for blocks of size 2^( 6) =       0.000470563891
  error estimate for blocks of size 2^( 7) =       0.000476069702

      target function =                  N/A
              le_mean =     -16.905444676635
             les_mean =     286.133127222828
             stat err =       0.000464751439
             autocorr =       1.274045946978
              std dev =       0.582295180801
             le_variance =       0.339067677584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339010362125
                                         uncertainty =       0.004062227401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339010362125
                                         uncertainty =       0.004062227401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411730085
  error estimate for blocks of size 2^( 2) =       0.000424315630
  error estimate for blocks of size 2^( 3) =       0.000437763041
  error estimate for blocks of size 2^( 4) =       0.000450615807
  error estimate for blocks of size 2^( 5) =       0.000461731818
  error estimate for blocks of size 2^( 6) =       0.000470552450
  error estimate for blocks of size 2^( 7) =       0.000476059233

      target function =                  N/A
              le_mean =     -16.905444685822
             les_mean =     286.133103180989
             stat err =       0.000464739827
             autocorr =       1.274073787479
              std dev =       0.582274269674
             le_variance =       0.339043325124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338986907694
                                         uncertainty =       0.004061916375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338986907694
                                         uncertainty =       0.004061916375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411715832
  error estimate for blocks of size 2^( 2) =       0.000424302098
  error estimate for blocks of size 2^( 3) =       0.000437750230
  error estimate for blocks of size 2^( 4) =       0.000450603677
  error estimate for blocks of size 2^( 5) =       0.000461720254
  error estimate for blocks of size 2^( 6) =       0.000470541381
  error estimate for blocks of size 2^( 7) =       0.000476049155

      target function =                  N/A
              le_mean =     -16.905444713785
             les_mean =     286.133080654296
             stat err =       0.000464728617
             autocorr =       1.274100531345
              std dev =       0.582254113750
             le_variance =       0.339019852978


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905444718571        initial  <--
     3.9062e+00     3.9062e+01             1.2221e-04       -16.905444676635
     1.5625e+01     1.5625e+02             3.1263e-05       -16.905444685822
     6.2500e+01     6.2500e+02             7.8635e-06       -16.905444713785

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6509
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.073419e-01 1 1  ON 0
 uu_1                 1.414680e-01 1 1  ON 1
 uu_2                 4.045466e-02 1 1  ON 2
 uu_3                -2.051021e-02 1 1  ON 3
 uu_4                -6.408056e-02 1 1  ON 4
 uu_5                -9.668400e-02 1 1  ON 5
 uu_6                -1.225421e-01 1 1  ON 6
 uu_7                -1.339895e-01 1 1  ON 7
 uu_8                -1.248040e-01 1 1  ON 8
 uu_9                -9.511174e-02 1 1  ON 9
 ud_0                 4.374602e-01 1 1  ON 10
 ud_1                 1.741175e-01 1 1  ON 11
 ud_2                 5.847462e-02 1 1  ON 12
 ud_3                -9.115442e-03 1 1  ON 13
 ud_4                -6.474293e-02 1 1  ON 14
 ud_5                -1.050527e-01 1 1  ON 15
 ud_6                -1.311761e-01 1 1  ON 16
 ud_7                -1.470160e-01 1 1  ON 17
 ud_8                -1.478796e-01 1 1  ON 18
 ud_9                -1.377880e-01 1 1  ON 19
 eO_0                -7.430013e-01 1 1  ON 20
 eO_1                -4.282318e-01 1 1  ON 21
 eO_2                -1.711230e-02 1 1  ON 22
 eO_3                 2.932362e-01 1 1  ON 23
 eO_4                 5.090486e-01 1 1  ON 24
 eO_5                 4.664481e-01 1 1  ON 25
 eO_6                 2.382280e-01 1 1  ON 26
 eO_7                -5.475571e-02 1 1  ON 27
 eO_8                -2.029828e-01 1 1  ON 28
 eO_9                -6.305561e-02 1 1  ON 29
eH1_0                -2.286406e-01 1 1  ON 30
eH1_1                -1.322996e-01 1 1  ON 31
eH1_2                -8.800216e-02 1 1  ON 32
eH1_3                -3.508498e-02 1 1  ON 33
eH1_4                 1.247544e-02 1 1  ON 34
eH1_5                 4.531633e-02 1 1  ON 35
eH1_6                 9.760954e-02 1 1  ON 36
eH1_7                 1.411335e-01 1 1  ON 37
eH1_8                 1.530924e-01 1 1  ON 38
eH1_9                 3.911150e-02 1 1  ON 39
eH2_0                -2.269454e-01 1 1  ON 40
eH2_1                -1.302028e-01 1 1  ON 41
eH2_2                -8.616736e-02 1 1  ON 42
eH2_3                -3.339719e-02 1 1  ON 43
eH2_4                 1.439747e-02 1 1  ON 44
eH2_5                 4.842823e-02 1 1  ON 45
eH2_6                 1.022098e-01 1 1  ON 46
eH2_7                 1.493504e-01 1 1  ON 47
eH2_8                 1.594791e-01 1 1  ON 48
eH2_9                 2.092381e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5998e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8961
    reference variance = 0.282445
====================================================
  Execution time = 2.2974e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3325e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333184054687
                                         uncertainty =       0.003112522221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333184054687
                                         uncertainty =       0.003112522221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408195230
  error estimate for blocks of size 2^( 2) =       0.000420752025
  error estimate for blocks of size 2^( 3) =       0.000434088031
  error estimate for blocks of size 2^( 4) =       0.000446761219
  error estimate for blocks of size 2^( 5) =       0.000457544956
  error estimate for blocks of size 2^( 6) =       0.000465022700
  error estimate for blocks of size 2^( 7) =       0.000472484990

      target function =                  N/A
              le_mean =     -16.905623489901
             les_mean =     286.133352106835
             stat err =       0.000460453466
             autocorr =       1.272435107757
              std dev =       0.577275230003
             le_variance =       0.333246691175


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690562348990e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905623489901       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905623507899       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905623525508       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905623521864       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905623533854       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905623545330       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905623543256       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905623542541       residual = 7.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 8.739949e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905623489901       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905623494412       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905623498841       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905623497933       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905623500893       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905623503800       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905623503283       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905623503109       residual = 6.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.187534e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905623489901       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905623491029       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905623492138       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905623491911       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905623492649       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905623493378       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905623493250       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905623493207       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 5.470438e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159364 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8647e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.073429e-01 1 1  ON 0
 uu_1                 1.414669e-01 1 1  ON 1
 uu_2                 4.045494e-02 1 1  ON 2
 uu_3                -2.051044e-02 1 1  ON 3
 uu_4                -6.408089e-02 1 1  ON 4
 uu_5                -9.668419e-02 1 1  ON 5
 uu_6                -1.225415e-01 1 1  ON 6
 uu_7                -1.339904e-01 1 1  ON 7
 uu_8                -1.248046e-01 1 1  ON 8
 uu_9                -9.511179e-02 1 1  ON 9
 ud_0                 4.374622e-01 1 1  ON 10
 ud_1                 1.741178e-01 1 1  ON 11
 ud_2                 5.847523e-02 1 1  ON 12
 ud_3                -9.115651e-03 1 1  ON 13
 ud_4                -6.474405e-02 1 1  ON 14
 ud_5                -1.050537e-01 1 1  ON 15
 ud_6                -1.311771e-01 1 1  ON 16
 ud_7                -1.470169e-01 1 1  ON 17
 ud_8                -1.478789e-01 1 1  ON 18
 ud_9                -1.377874e-01 1 1  ON 19
 eO_0                -7.430030e-01 1 1  ON 20
 eO_1                -4.282339e-01 1 1  ON 21
 eO_2                -1.711256e-02 1 1  ON 22
 eO_3                 2.932370e-01 1 1  ON 23
 eO_4                 5.090508e-01 1 1  ON 24
 eO_5                 4.664493e-01 1 1  ON 25
 eO_6                 2.382289e-01 1 1  ON 26
 eO_7                -5.475526e-02 1 1  ON 27
 eO_8                -2.029834e-01 1 1  ON 28
 eO_9                -6.305639e-02 1 1  ON 29
eH1_0                -2.286422e-01 1 1  ON 30
eH1_1                -1.323001e-01 1 1  ON 31
eH1_2                -8.800206e-02 1 1  ON 32
eH1_3                -3.508590e-02 1 1  ON 33
eH1_4                 1.247522e-02 1 1  ON 34
eH1_5                 4.531629e-02 1 1  ON 35
eH1_6                 9.760993e-02 1 1  ON 36
eH1_7                 1.411343e-01 1 1  ON 37
eH1_8                 1.530932e-01 1 1  ON 38
eH1_9                 3.911249e-02 1 1  ON 39
eH2_0                -2.269465e-01 1 1  ON 40
eH2_1                -1.302035e-01 1 1  ON 41
eH2_2                -8.616737e-02 1 1  ON 42
eH2_3                -3.339733e-02 1 1  ON 43
eH2_4                 1.439702e-02 1 1  ON 44
eH2_5                 4.842744e-02 1 1  ON 45
eH2_6                 1.022097e-01 1 1  ON 46
eH2_7                 1.493504e-01 1 1  ON 47
eH2_8                 1.594805e-01 1 1  ON 48
eH2_9                 2.092549e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9199
    reference variance = 0.253429
====================================================
  Execution time = 2.2203e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3478e-01
  Total weights = 2.0000e+06
  Execution time = 1.9039e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334791656384
                                         uncertainty =       0.003507130609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334791656384
                                         uncertainty =       0.003507130609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409131978
  error estimate for blocks of size 2^( 2) =       0.000421954454
  error estimate for blocks of size 2^( 3) =       0.000435800172
  error estimate for blocks of size 2^( 4) =       0.000448048002
  error estimate for blocks of size 2^( 5) =       0.000459203784
  error estimate for blocks of size 2^( 6) =       0.000466644606
  error estimate for blocks of size 2^( 7) =       0.000468160327

      target function =                  N/A
              le_mean =     -16.905471852093
             les_mean =     286.129756325366
             stat err =       0.000460514180
             autocorr =       1.266949087530
              std dev =       0.578599992095
             le_variance =       0.334777950853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334796092039
                                         uncertainty =       0.003507158829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334796092039
                                         uncertainty =       0.003507158829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409134689
  error estimate for blocks of size 2^( 2) =       0.000421957095
  error estimate for blocks of size 2^( 3) =       0.000435802719
  error estimate for blocks of size 2^( 4) =       0.000448050472
  error estimate for blocks of size 2^( 5) =       0.000459206110
  error estimate for blocks of size 2^( 6) =       0.000466646890
  error estimate for blocks of size 2^( 7) =       0.000468162657

      target function =                  N/A
              le_mean =     -16.905471896341
             les_mean =     286.129762257392
             stat err =       0.000460516532
             autocorr =       1.266945244648
              std dev =       0.578603825432
             le_variance =       0.334782386805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334793884112
                                         uncertainty =       0.003507144696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334793884112
                                         uncertainty =       0.003507144696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409133339
  error estimate for blocks of size 2^( 2) =       0.000421955781
  error estimate for blocks of size 2^( 3) =       0.000435801451
  error estimate for blocks of size 2^( 4) =       0.000448049243
  error estimate for blocks of size 2^( 5) =       0.000459204952
  error estimate for blocks of size 2^( 6) =       0.000466645753
  error estimate for blocks of size 2^( 7) =       0.000468161497

      target function =                  N/A
              le_mean =     -16.905471874382
             les_mean =     286.129759306844
             stat err =       0.000460515362
             autocorr =       1.266947159419
              std dev =       0.578601917321
             le_variance =       0.334780178727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334791935135
                                         uncertainty =       0.003507132369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334791935135
                                         uncertainty =       0.003507132369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409132148
  error estimate for blocks of size 2^( 2) =       0.000421954620
  error estimate for blocks of size 2^( 3) =       0.000435800332
  error estimate for blocks of size 2^( 4) =       0.000448048157
  error estimate for blocks of size 2^( 5) =       0.000459203930
  error estimate for blocks of size 2^( 6) =       0.000466644749
  error estimate for blocks of size 2^( 7) =       0.000468160473

      target function =                  N/A
              le_mean =     -16.905471854881
             les_mean =     286.129756698422
             stat err =       0.000460514328
             autocorr =       1.266948846312
              std dev =       0.578600232995
             le_variance =       0.334778229621


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905471852093        initial
     3.9062e+01     3.9062e+02             8.7399e-06       -16.905471896341  <--
     1.5625e+02     1.5625e+03             2.1875e-06       -16.905471874382
     6.2500e+02     6.2500e+03             5.4704e-07       -16.905471854881

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 3.1772e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.073461e-01 1 1  ON 0
 uu_1                 1.414637e-01 1 1  ON 1
 uu_2                 4.045573e-02 1 1  ON 2
 uu_3                -2.051114e-02 1 1  ON 3
 uu_4                -6.408188e-02 1 1  ON 4
 uu_5                -9.668477e-02 1 1  ON 5
 uu_6                -1.225396e-01 1 1  ON 6
 uu_7                -1.339931e-01 1 1  ON 7
 uu_8                -1.248066e-01 1 1  ON 8
 uu_9                -9.511195e-02 1 1  ON 9
 ud_0                 4.374682e-01 1 1  ON 10
 ud_1                 1.741187e-01 1 1  ON 11
 ud_2                 5.847704e-02 1 1  ON 12
 ud_3                -9.116273e-03 1 1  ON 13
 ud_4                -6.474738e-02 1 1  ON 14
 ud_5                -1.050569e-01 1 1  ON 15
 ud_6                -1.311799e-01 1 1  ON 16
 ud_7                -1.470195e-01 1 1  ON 17
 ud_8                -1.478769e-01 1 1  ON 18
 ud_9                -1.377856e-01 1 1  ON 19
 eO_0                -7.430079e-01 1 1  ON 20
 eO_1                -4.282401e-01 1 1  ON 21
 eO_2                -1.711332e-02 1 1  ON 22
 eO_3                 2.932392e-01 1 1  ON 23
 eO_4                 5.090573e-01 1 1  ON 24
 eO_5                 4.664529e-01 1 1  ON 25
 eO_6                 2.382317e-01 1 1  ON 26
 eO_7                -5.475390e-02 1 1  ON 27
 eO_8                -2.029852e-01 1 1  ON 28
 eO_9                -6.305871e-02 1 1  ON 29
eH1_0                -2.286468e-01 1 1  ON 30
eH1_1                -1.323016e-01 1 1  ON 31
eH1_2                -8.800180e-02 1 1  ON 32
eH1_3                -3.508865e-02 1 1  ON 33
eH1_4                 1.247456e-02 1 1  ON 34
eH1_5                 4.531617e-02 1 1  ON 35
eH1_6                 9.761109e-02 1 1  ON 36
eH1_7                 1.411369e-01 1 1  ON 37
eH1_8                 1.530958e-01 1 1  ON 38
eH1_9                 3.911546e-02 1 1  ON 39
eH2_0                -2.269497e-01 1 1  ON 40
eH2_1                -1.302055e-01 1 1  ON 41
eH2_2                -8.616742e-02 1 1  ON 42
eH2_3                -3.339774e-02 1 1  ON 43
eH2_4                 1.439566e-02 1 1  ON 44
eH2_5                 4.842505e-02 1 1  ON 45
eH2_6                 1.022095e-01 1 1  ON 46
eH2_7                 1.493505e-01 1 1  ON 47
eH2_8                 1.594847e-01 1 1  ON 48
eH2_9                 2.093055e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0426e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.903
    reference variance = 0.307983
====================================================
  Execution time = 2.0833e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3683e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5429e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336809809567
                                         uncertainty =       0.002934505244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336809809567
                                         uncertainty =       0.002934505244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410384372
  error estimate for blocks of size 2^( 2) =       0.000423188399
  error estimate for blocks of size 2^( 3) =       0.000437103755
  error estimate for blocks of size 2^( 4) =       0.000450128569
  error estimate for blocks of size 2^( 5) =       0.000463071779
  error estimate for blocks of size 2^( 6) =       0.000471489387
  error estimate for blocks of size 2^( 7) =       0.000476407521

      target function =                  N/A
              le_mean =     -16.904255854197
             les_mean =     286.090696482028
             stat err =       0.000465274314
             autocorr =       1.285394762790
              std dev =       0.580371145292
             le_variance =       0.336830666287


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690425585420e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904255854197       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904255904136       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904255946753       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904255841551       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904255941955       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904255941160       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904255973570       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904255981451       residual = 9.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 4.923605e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904255854197       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904255866786       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904255877227       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904255850115       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904255875293       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904255874101       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904255882955       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904255884788       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.234745e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904255854197       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904255857351       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904255859947       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904255853118       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904255859356       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904255859039       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904255861313       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904255861763       residual = 8.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 3.089285e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162029 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6383e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.073492e-01 1 1  ON 0
 uu_1                 1.414600e-01 1 1  ON 1
 uu_2                 4.045767e-02 1 1  ON 2
 uu_3                -2.051397e-02 1 1  ON 3
 uu_4                -6.408329e-02 1 1  ON 4
 uu_5                -9.668834e-02 1 1  ON 5
 uu_6                -1.225423e-01 1 1  ON 6
 uu_7                -1.339924e-01 1 1  ON 7
 uu_8                -1.248070e-01 1 1  ON 8
 uu_9                -9.511129e-02 1 1  ON 9
 ud_0                 4.374764e-01 1 1  ON 10
 ud_1                 1.741200e-01 1 1  ON 11
 ud_2                 5.847614e-02 1 1  ON 12
 ud_3                -9.116727e-03 1 1  ON 13
 ud_4                -6.475395e-02 1 1  ON 14
 ud_5                -1.050604e-01 1 1  ON 15
 ud_6                -1.311831e-01 1 1  ON 16
 ud_7                -1.470171e-01 1 1  ON 17
 ud_8                -1.478736e-01 1 1  ON 18
 ud_9                -1.377851e-01 1 1  ON 19
 eO_0                -7.430163e-01 1 1  ON 20
 eO_1                -4.282491e-01 1 1  ON 21
 eO_2                -1.711669e-02 1 1  ON 22
 eO_3                 2.932441e-01 1 1  ON 23
 eO_4                 5.090697e-01 1 1  ON 24
 eO_5                 4.664579e-01 1 1  ON 25
 eO_6                 2.382331e-01 1 1  ON 26
 eO_7                -5.475109e-02 1 1  ON 27
 eO_8                -2.029879e-01 1 1  ON 28
 eO_9                -6.306154e-02 1 1  ON 29
eH1_0                -2.286524e-01 1 1  ON 30
eH1_1                -1.323052e-01 1 1  ON 31
eH1_2                -8.800484e-02 1 1  ON 32
eH1_3                -3.509061e-02 1 1  ON 33
eH1_4                 1.247269e-02 1 1  ON 34
eH1_5                 4.531404e-02 1 1  ON 35
eH1_6                 9.761415e-02 1 1  ON 36
eH1_7                 1.411426e-01 1 1  ON 37
eH1_8                 1.531006e-01 1 1  ON 38
eH1_9                 3.911994e-02 1 1  ON 39
eH2_0                -2.269562e-01 1 1  ON 40
eH2_1                -1.302105e-01 1 1  ON 41
eH2_2                -8.616870e-02 1 1  ON 42
eH2_3                -3.340000e-02 1 1  ON 43
eH2_4                 1.439584e-02 1 1  ON 44
eH2_5                 4.842810e-02 1 1  ON 45
eH2_6                 1.022091e-01 1 1  ON 46
eH2_7                 1.493503e-01 1 1  ON 47
eH2_8                 1.594893e-01 1 1  ON 48
eH2_9                 2.093753e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9361
    reference variance = 0.260238
====================================================
  Execution time = 2.0384e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4001e-01
  Total weights = 2.0000e+06
  Execution time = 1.9056e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340006862627
                                         uncertainty =       0.003555418035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340006862627
                                         uncertainty =       0.003555418035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412312677
  error estimate for blocks of size 2^( 2) =       0.000424621921
  error estimate for blocks of size 2^( 3) =       0.000437721365
  error estimate for blocks of size 2^( 4) =       0.000449913545
  error estimate for blocks of size 2^( 5) =       0.000461105367
  error estimate for blocks of size 2^( 6) =       0.000468145350
  error estimate for blocks of size 2^( 7) =       0.000473289881

      target function =                  N/A
              le_mean =     -16.905895063293
             les_mean =     286.149291207679
             stat err =       0.000463113536
             autocorr =       1.261599692010
              std dev =       0.583098179204
             le_variance =       0.340003486592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340033883150
                                         uncertainty =       0.003555752007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340033883150
                                         uncertainty =       0.003555752007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412329062
  error estimate for blocks of size 2^( 2) =       0.000424637574
  error estimate for blocks of size 2^( 3) =       0.000437736488
  error estimate for blocks of size 2^( 4) =       0.000449928118
  error estimate for blocks of size 2^( 5) =       0.000461119227
  error estimate for blocks of size 2^( 6) =       0.000468158987
  error estimate for blocks of size 2^( 7) =       0.000473303011

      target function =                  N/A
              le_mean =     -16.905895098337
             les_mean =     286.149319417457
             stat err =       0.000463127336
             autocorr =       1.261574606181
              std dev =       0.583121352292
             le_variance =       0.340030511499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340020708478
                                         uncertainty =       0.003555589391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340020708478
                                         uncertainty =       0.003555589391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412321073
  error estimate for blocks of size 2^( 2) =       0.000424629938
  error estimate for blocks of size 2^( 3) =       0.000437729112
  error estimate for blocks of size 2^( 4) =       0.000449921011
  error estimate for blocks of size 2^( 5) =       0.000461112469
  error estimate for blocks of size 2^( 6) =       0.000468152341
  error estimate for blocks of size 2^( 7) =       0.000473296617

      target function =                  N/A
              le_mean =     -16.905895080913
             les_mean =     286.149305651608
             stat err =       0.000463120610
             autocorr =       1.261586849360
              std dev =       0.583110053734
             le_variance =       0.340017334765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340008603675
                                         uncertainty =       0.003555439594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340008603675
                                         uncertainty =       0.003555439594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412313732
  error estimate for blocks of size 2^( 2) =       0.000424622929
  error estimate for blocks of size 2^( 3) =       0.000437722339
  error estimate for blocks of size 2^( 4) =       0.000449914484
  error estimate for blocks of size 2^( 5) =       0.000461106260
  error estimate for blocks of size 2^( 6) =       0.000468146229
  error estimate for blocks of size 2^( 7) =       0.000473290728

      target function =                  N/A
              le_mean =     -16.905895065445
             les_mean =     286.149293021768
             stat err =       0.000463114425
             autocorr =       1.261598077148
              std dev =       0.583099672383
             le_variance =       0.340005227934


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905895063293        initial
     9.7656e+00     9.7656e+01             4.9236e-05       -16.905895098337  <--
     3.9062e+01     3.9062e+02             1.2347e-05       -16.905895080913
     1.5625e+02     1.5625e+03             3.0893e-06       -16.905895065445

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 2.9961e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.073582e-01 1 1  ON 0
 uu_1                 1.414494e-01 1 1  ON 1
 uu_2                 4.046293e-02 1 1  ON 2
 uu_3                -2.052210e-02 1 1  ON 3
 uu_4                -6.408773e-02 1 1  ON 4
 uu_5                -9.669887e-02 1 1  ON 5
 uu_6                -1.225505e-01 1 1  ON 6
 uu_7                -1.339904e-01 1 1  ON 7
 uu_8                -1.248080e-01 1 1  ON 8
 uu_9                -9.510928e-02 1 1  ON 9
 ud_0                 4.375003e-01 1 1  ON 10
 ud_1                 1.741239e-01 1 1  ON 11
 ud_2                 5.847379e-02 1 1  ON 12
 ud_3                -9.118343e-03 1 1  ON 13
 ud_4                -6.477318e-02 1 1  ON 14
 ud_5                -1.050712e-01 1 1  ON 15
 ud_6                -1.311926e-01 1 1  ON 16
 ud_7                -1.470099e-01 1 1  ON 17
 ud_8                -1.478637e-01 1 1  ON 18
 ud_9                -1.377838e-01 1 1  ON 19
 eO_0                -7.430416e-01 1 1  ON 20
 eO_1                -4.282757e-01 1 1  ON 21
 eO_2                -1.712668e-02 1 1  ON 22
 eO_3                 2.932588e-01 1 1  ON 23
 eO_4                 5.091066e-01 1 1  ON 24
 eO_5                 4.664729e-01 1 1  ON 25
 eO_6                 2.382375e-01 1 1  ON 26
 eO_7                -5.474268e-02 1 1  ON 27
 eO_8                -2.029959e-01 1 1  ON 28
 eO_9                -6.307004e-02 1 1  ON 29
eH1_0                -2.286693e-01 1 1  ON 30
eH1_1                -1.323159e-01 1 1  ON 31
eH1_2                -8.801395e-02 1 1  ON 32
eH1_3                -3.509654e-02 1 1  ON 33
eH1_4                 1.246704e-02 1 1  ON 34
eH1_5                 4.530763e-02 1 1  ON 35
eH1_6                 9.762333e-02 1 1  ON 36
eH1_7                 1.411600e-01 1 1  ON 37
eH1_8                 1.531150e-01 1 1  ON 38
eH1_9                 3.913339e-02 1 1  ON 39
eH2_0                -2.269757e-01 1 1  ON 40
eH2_1                -1.302252e-01 1 1  ON 41
eH2_2                -8.617276e-02 1 1  ON 42
eH2_3                -3.340666e-02 1 1  ON 43
eH2_4                 1.439628e-02 1 1  ON 44
eH2_5                 4.843718e-02 1 1  ON 45
eH2_6                 1.022080e-01 1 1  ON 46
eH2_7                 1.493498e-01 1 1  ON 47
eH2_8                 1.595030e-01 1 1  ON 48
eH2_9                 2.095847e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6430e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9054
    reference variance = 0.259349
====================================================
  Execution time = 2.0557e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3990e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6081e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339953236668
                                         uncertainty =       0.004966389833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339953236668
                                         uncertainty =       0.004966389833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412251818
  error estimate for blocks of size 2^( 2) =       0.000425289506
  error estimate for blocks of size 2^( 3) =       0.000438044457
  error estimate for blocks of size 2^( 4) =       0.000450623549
  error estimate for blocks of size 2^( 5) =       0.000462237739
  error estimate for blocks of size 2^( 6) =       0.000468129840
  error estimate for blocks of size 2^( 7) =       0.000471806952

      target function =                  N/A
              le_mean =     -16.905647479853
             les_mean =     286.140819665969
             stat err =       0.000463199520
             autocorr =       1.262440859600
              std dev =       0.583012112096
             le_variance =       0.339903122850


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690564747985e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905647479853       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905647635831       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905647657646       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905647899103       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905648376912       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905648294604       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905648177159       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905648189056       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905648190059       residual = 2.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.619869e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905647479853       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905647520730       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905647522476       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905647581327       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905647720872       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905647686387       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905647666194       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905647670354       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 4.102842e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905647479853       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905647490197       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905647490361       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905647504974       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905647541125       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905647531932       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905647528156       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905647526630       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905647527505       residual = 1.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.036391e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164984 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6180e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.073686e-01 1 1  ON 0
 uu_1                 1.414387e-01 1 1  ON 1
 uu_2                 4.046652e-02 1 1  ON 2
 uu_3                -2.053409e-02 1 1  ON 3
 uu_4                -6.407940e-02 1 1  ON 4
 uu_5                -9.670389e-02 1 1  ON 5
 uu_6                -1.225528e-01 1 1  ON 6
 uu_7                -1.339860e-01 1 1  ON 7
 uu_8                -1.248196e-01 1 1  ON 8
 uu_9                -9.512152e-02 1 1  ON 9
 ud_0                 4.375256e-01 1 1  ON 10
 ud_1                 1.741480e-01 1 1  ON 11
 ud_2                 5.848903e-02 1 1  ON 12
 ud_3                -9.114592e-03 1 1  ON 13
 ud_4                -6.478269e-02 1 1  ON 14
 ud_5                -1.050749e-01 1 1  ON 15
 ud_6                -1.312079e-01 1 1  ON 16
 ud_7                -1.470290e-01 1 1  ON 17
 ud_8                -1.478779e-01 1 1  ON 18
 ud_9                -1.377920e-01 1 1  ON 19
 eO_0                -7.430827e-01 1 1  ON 20
 eO_1                -4.283001e-01 1 1  ON 21
 eO_2                -1.712112e-02 1 1  ON 22
 eO_3                 2.932748e-01 1 1  ON 23
 eO_4                 5.091360e-01 1 1  ON 24
 eO_5                 4.664990e-01 1 1  ON 25
 eO_6                 2.382572e-01 1 1  ON 26
 eO_7                -5.473585e-02 1 1  ON 27
 eO_8                -2.030164e-01 1 1  ON 28
 eO_9                -6.308569e-02 1 1  ON 29
eH1_0                -2.286886e-01 1 1  ON 30
eH1_1                -1.323260e-01 1 1  ON 31
eH1_2                -8.802741e-02 1 1  ON 32
eH1_3                -3.510315e-02 1 1  ON 33
eH1_4                 1.245913e-02 1 1  ON 34
eH1_5                 4.530155e-02 1 1  ON 35
eH1_6                 9.762827e-02 1 1  ON 36
eH1_7                 1.411797e-01 1 1  ON 37
eH1_8                 1.531384e-01 1 1  ON 38
eH1_9                 3.915068e-02 1 1  ON 39
eH2_0                -2.269988e-01 1 1  ON 40
eH2_1                -1.302420e-01 1 1  ON 41
eH2_2                -8.618210e-02 1 1  ON 42
eH2_3                -3.340384e-02 1 1  ON 43
eH2_4                 1.440251e-02 1 1  ON 44
eH2_5                 4.844310e-02 1 1  ON 45
eH2_6                 1.022136e-01 1 1  ON 46
eH2_7                 1.493476e-01 1 1  ON 47
eH2_8                 1.595148e-01 1 1  ON 48
eH2_9                 2.097735e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.868
    reference variance = 0.232623
====================================================
  Execution time = 2.0182e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3419e-01
  Total weights = 2.0000e+06
  Execution time = 1.8865e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334151221256
                                         uncertainty =       0.003130961124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334151221256
                                         uncertainty =       0.003130961124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408765765
  error estimate for blocks of size 2^( 2) =       0.000421178559
  error estimate for blocks of size 2^( 3) =       0.000434273374
  error estimate for blocks of size 2^( 4) =       0.000446839116
  error estimate for blocks of size 2^( 5) =       0.000456934985
  error estimate for blocks of size 2^( 6) =       0.000463362815
  error estimate for blocks of size 2^( 7) =       0.000467507166

      target function =                  N/A
              le_mean =     -16.905588151430
             les_mean =     286.133089480453
             stat err =       0.000458661020
             autocorr =       1.259025811351
              std dev =       0.578082089115
             le_variance =       0.334178901755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334187051401
                                         uncertainty =       0.003131167811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334187051401
                                         uncertainty =       0.003131167811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408787682
  error estimate for blocks of size 2^( 2) =       0.000421199478
  error estimate for blocks of size 2^( 3) =       0.000434292117
  error estimate for blocks of size 2^( 4) =       0.000446855805
  error estimate for blocks of size 2^( 5) =       0.000456949785
  error estimate for blocks of size 2^( 6) =       0.000463375928
  error estimate for blocks of size 2^( 7) =       0.000467520360

      target function =                  N/A
              le_mean =     -16.905588516954
             les_mean =     286.133137675867
             stat err =       0.000458675469
             autocorr =       1.258970129889
              std dev =       0.578113084451
             le_variance =       0.334214738413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334167868085
                                         uncertainty =       0.003131042281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334167868085
                                         uncertainty =       0.003131042281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408775948
  error estimate for blocks of size 2^( 2) =       0.000421188284
  error estimate for blocks of size 2^( 3) =       0.000434282021
  error estimate for blocks of size 2^( 4) =       0.000446846769
  error estimate for blocks of size 2^( 5) =       0.000456941641
  error estimate for blocks of size 2^( 6) =       0.000463368607
  error estimate for blocks of size 2^( 7) =       0.000467512993

      target function =                  N/A
              le_mean =     -16.905588352938
             les_mean =     286.133112943120
             stat err =       0.000458667503
             autocorr =       1.258998674999
              std dev =       0.578096489549
             le_variance =       0.334195551229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334153248526
                                         uncertainty =       0.003130969797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334153248526
                                         uncertainty =       0.003130969797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408767005
  error estimate for blocks of size 2^( 2) =       0.000421179743
  error estimate for blocks of size 2^( 3) =       0.000434274421
  error estimate for blocks of size 2^( 4) =       0.000446840039
  error estimate for blocks of size 2^( 5) =       0.000456935782
  error estimate for blocks of size 2^( 6) =       0.000463363500
  error estimate for blocks of size 2^( 7) =       0.000467507856

      target function =                  N/A
              le_mean =     -16.905588175941
             les_mean =     286.133092336771
             stat err =       0.000458661794
             autocorr =       1.259022421523
              std dev =       0.578083842827
             le_variance =       0.334180929337


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905588151430        initial
     2.4414e+00     2.4414e+01             1.6199e-04       -16.905588516954  <--
     9.7656e+00     9.7656e+01             4.1028e-05       -16.905588352938
     3.9062e+01     3.9062e+02             1.0364e-05       -16.905588175941

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.9666e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.073970e-01 1 1  ON 0
 uu_1                 1.414123e-01 1 1  ON 1
 uu_2                 4.047414e-02 1 1  ON 2
 uu_3                -2.056339e-02 1 1  ON 3
 uu_4                -6.406072e-02 1 1  ON 4
 uu_5                -9.671650e-02 1 1  ON 5
 uu_6                -1.225615e-01 1 1  ON 6
 uu_7                -1.339749e-01 1 1  ON 7
 uu_8                -1.248536e-01 1 1  ON 8
 uu_9                -9.515817e-02 1 1  ON 9
 ud_0                 4.376011e-01 1 1  ON 10
 ud_1                 1.742174e-01 1 1  ON 11
 ud_2                 5.853277e-02 1 1  ON 12
 ud_3                -9.103470e-03 1 1  ON 13
 ud_4                -6.480992e-02 1 1  ON 14
 ud_5                -1.050885e-01 1 1  ON 15
 ud_6                -1.312498e-01 1 1  ON 16
 ud_7                -1.470836e-01 1 1  ON 17
 ud_8                -1.479200e-01 1 1  ON 18
 ud_9                -1.378166e-01 1 1  ON 19
 eO_0                -7.432036e-01 1 1  ON 20
 eO_1                -4.283723e-01 1 1  ON 21
 eO_2                -1.710734e-02 1 1  ON 22
 eO_3                 2.933209e-01 1 1  ON 23
 eO_4                 5.092234e-01 1 1  ON 24
 eO_5                 4.665787e-01 1 1  ON 25
 eO_6                 2.383173e-01 1 1  ON 26
 eO_7                -5.471480e-02 1 1  ON 27
 eO_8                -2.030785e-01 1 1  ON 28
 eO_9                -6.313309e-02 1 1  ON 29
eH1_0                -2.287457e-01 1 1  ON 30
eH1_1                -1.323575e-01 1 1  ON 31
eH1_2                -8.806761e-02 1 1  ON 32
eH1_3                -3.512376e-02 1 1  ON 33
eH1_4                 1.243543e-02 1 1  ON 34
eH1_5                 4.528355e-02 1 1  ON 35
eH1_6                 9.764277e-02 1 1  ON 36
eH1_7                 1.412387e-01 1 1  ON 37
eH1_8                 1.532094e-01 1 1  ON 38
eH1_9                 3.920316e-02 1 1  ON 39
eH2_0                -2.270670e-01 1 1  ON 40
eH2_1                -1.302900e-01 1 1  ON 41
eH2_2                -8.621155e-02 1 1  ON 42
eH2_3                -3.339674e-02 1 1  ON 43
eH2_4                 1.441950e-02 1 1  ON 44
eH2_5                 4.845948e-02 1 1  ON 45
eH2_6                 1.022308e-01 1 1  ON 46
eH2_7                 1.493416e-01 1 1  ON 47
eH2_8                 1.595509e-01 1 1  ON 48
eH2_9                 2.103462e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5928e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8963
    reference variance = 0.347754
====================================================
  Execution time = 2.0592e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3695e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4759e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336975364072
                                         uncertainty =       0.003409255369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336975364072
                                         uncertainty =       0.003409255369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410457712
  error estimate for blocks of size 2^( 2) =       0.000423158607
  error estimate for blocks of size 2^( 3) =       0.000436587238
  error estimate for blocks of size 2^( 4) =       0.000449670796
  error estimate for blocks of size 2^( 5) =       0.000461448298
  error estimate for blocks of size 2^( 6) =       0.000468799262
  error estimate for blocks of size 2^( 7) =       0.000474468953

      target function =                  N/A
              le_mean =     -16.904874820061
             les_mean =     286.111743579330
             stat err =       0.000463596827
             autocorr =       1.275686827986
              std dev =       0.580474862402
             le_variance =       0.336951065881


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690487482006e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904874820061       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904875439646       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904874787980       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904875192954       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904875702581       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904875485344       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904875394391       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904875683490       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904875600854       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 5.998443e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904874820061       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904874997880       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904874785260       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904874895558       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904875029923       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904874943791       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904874919937       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904874974591       residual = 7.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.570735e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904874820061       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904874866224       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904874811524       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904874829972       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904874867547       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904874844637       residual = 9.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904874840768       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904874851632       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 3.982691e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167781 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6075e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.074616e-01 1 1  ON 0
 uu_1                 1.414072e-01 1 1  ON 1
 uu_2                 4.048331e-02 1 1  ON 2
 uu_3                -2.057071e-02 1 1  ON 3
 uu_4                -6.410632e-02 1 1  ON 4
 uu_5                -9.677206e-02 1 1  ON 5
 uu_6                -1.225545e-01 1 1  ON 6
 uu_7                -1.340248e-01 1 1  ON 7
 uu_8                -1.249075e-01 1 1  ON 8
 uu_9                -9.515645e-02 1 1  ON 9
 ud_0                 4.377010e-01 1 1  ON 10
 ud_1                 1.742478e-01 1 1  ON 11
 ud_2                 5.856234e-02 1 1  ON 12
 ud_3                -9.099482e-03 1 1  ON 13
 ud_4                -6.484438e-02 1 1  ON 14
 ud_5                -1.051248e-01 1 1  ON 15
 ud_6                -1.313042e-01 1 1  ON 16
 ud_7                -1.470753e-01 1 1  ON 17
 ud_8                -1.479440e-01 1 1  ON 18
 ud_9                -1.378431e-01 1 1  ON 19
 eO_0                -7.433511e-01 1 1  ON 20
 eO_1                -4.285053e-01 1 1  ON 21
 eO_2                -1.710280e-02 1 1  ON 22
 eO_3                 2.933916e-01 1 1  ON 23
 eO_4                 5.093805e-01 1 1  ON 24
 eO_5                 4.666689e-01 1 1  ON 25
 eO_6                 2.383599e-01 1 1  ON 26
 eO_7                -5.468509e-02 1 1  ON 27
 eO_8                -2.031367e-01 1 1  ON 28
 eO_9                -6.318063e-02 1 1  ON 29
eH1_0                -2.288297e-01 1 1  ON 30
eH1_1                -1.323320e-01 1 1  ON 31
eH1_2                -8.808971e-02 1 1  ON 32
eH1_3                -3.517391e-02 1 1  ON 33
eH1_4                 1.238296e-02 1 1  ON 34
eH1_5                 4.528233e-02 1 1  ON 35
eH1_6                 9.767596e-02 1 1  ON 36
eH1_7                 1.412722e-01 1 1  ON 37
eH1_8                 1.532574e-01 1 1  ON 38
eH1_9                 3.927013e-02 1 1  ON 39
eH2_0                -2.271587e-01 1 1  ON 40
eH2_1                -1.303308e-01 1 1  ON 41
eH2_2                -8.624302e-02 1 1  ON 42
eH2_3                -3.341431e-02 1 1  ON 43
eH2_4                 1.437146e-02 1 1  ON 44
eH2_5                 4.849194e-02 1 1  ON 45
eH2_6                 1.022735e-01 1 1  ON 46
eH2_7                 1.493471e-01 1 1  ON 47
eH2_8                 1.596105e-01 1 1  ON 48
eH2_9                 2.111969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8939
    reference variance = 0.232197
====================================================
  Execution time = 2.0526e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4838e-01
  Total weights = 2.0000e+06
  Execution time = 1.8853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348380220926
                                         uncertainty =       0.004924459375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348380220926
                                         uncertainty =       0.004924459375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417315812
  error estimate for blocks of size 2^( 2) =       0.000429855784
  error estimate for blocks of size 2^( 3) =       0.000442530500
  error estimate for blocks of size 2^( 4) =       0.000455096268
  error estimate for blocks of size 2^( 5) =       0.000466727505
  error estimate for blocks of size 2^( 6) =       0.000475563702
  error estimate for blocks of size 2^( 7) =       0.000482084108

      target function =                  N/A
              le_mean =     -16.905456997634
             les_mean =     286.142781099143
             stat err =       0.000469867895
             autocorr =       1.267715682597
              std dev =       0.590173681578
             le_variance =       0.348304974427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348611698610
                                         uncertainty =       0.004928169105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348611698610
                                         uncertainty =       0.004928169105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417454413
  error estimate for blocks of size 2^( 2) =       0.000429989391
  error estimate for blocks of size 2^( 3) =       0.000442656480
  error estimate for blocks of size 2^( 4) =       0.000455215960
  error estimate for blocks of size 2^( 5) =       0.000466843247
  error estimate for blocks of size 2^( 6) =       0.000475676420
  error estimate for blocks of size 2^( 7) =       0.000482194032

      target function =                  N/A
              le_mean =     -16.905457251757
             les_mean =     286.143021091343
             stat err =       0.000469982415
             autocorr =       1.267491637813
              std dev =       0.590369693176
             le_variance =       0.348536374621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348534333070
                                         uncertainty =       0.004926999603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348534333070
                                         uncertainty =       0.004926999603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417408092
  error estimate for blocks of size 2^( 2) =       0.000429944555
  error estimate for blocks of size 2^( 3) =       0.000442614407
  error estimate for blocks of size 2^( 4) =       0.000455176506
  error estimate for blocks of size 2^( 5) =       0.000466805580
  error estimate for blocks of size 2^( 6) =       0.000475640088
  error estimate for blocks of size 2^( 7) =       0.000482159419

      target function =                  N/A
              le_mean =     -16.905457240247
             les_mean =     286.142943358237
             stat err =       0.000469945398
             autocorr =       1.267573275164
              std dev =       0.590304184832
             le_variance =       0.348459030630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348400780557
                                         uncertainty =       0.004924803375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348400780557
                                         uncertainty =       0.004924803375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417328124
  error estimate for blocks of size 2^( 2) =       0.000429867622
  error estimate for blocks of size 2^( 3) =       0.000442541698
  error estimate for blocks of size 2^( 4) =       0.000455106998
  error estimate for blocks of size 2^( 5) =       0.000466737971
  error estimate for blocks of size 2^( 6) =       0.000475573948
  error estimate for blocks of size 2^( 7) =       0.000482094243

      target function =                  N/A
              le_mean =     -16.905457027090
             les_mean =     286.142802647053
             stat err =       0.000469878290
             autocorr =       1.267696970571
              std dev =       0.590191093149
             le_variance =       0.348325526433


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905456997634        initial
     6.1035e-01     6.1035e+00             5.9984e-04       -16.905457251757  <--
     2.4414e+00     2.4414e+01             1.5707e-04       -16.905457240247
     9.7656e+00     9.7656e+01             3.9827e-05       -16.905457027090

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 3.0030e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.076106e-01 1 1  ON 0
 uu_1                 1.414160e-01 1 1  ON 1
 uu_2                 4.051559e-02 1 1  ON 2
 uu_3                -2.059560e-02 1 1  ON 3
 uu_4                -6.422554e-02 1 1  ON 4
 uu_5                -9.692367e-02 1 1  ON 5
 uu_6                -1.225679e-01 1 1  ON 6
 uu_7                -1.341612e-01 1 1  ON 7
 uu_8                -1.250613e-01 1 1  ON 8
 uu_9                -9.515275e-02 1 1  ON 9
 ud_0                 4.379226e-01 1 1  ON 10
 ud_1                 1.743639e-01 1 1  ON 11
 ud_2                 5.864635e-02 1 1  ON 12
 ud_3                -9.089540e-03 1 1  ON 13
 ud_4                -6.491919e-02 1 1  ON 14
 ud_5                -1.052231e-01 1 1  ON 15
 ud_6                -1.314337e-01 1 1  ON 16
 ud_7                -1.470682e-01 1 1  ON 17
 ud_8                -1.480146e-01 1 1  ON 18
 ud_9                -1.379199e-01 1 1  ON 19
 eO_0                -7.437939e-01 1 1  ON 20
 eO_1                -4.288709e-01 1 1  ON 21
 eO_2                -1.711369e-02 1 1  ON 22
 eO_3                 2.936116e-01 1 1  ON 23
 eO_4                 5.098233e-01 1 1  ON 24
 eO_5                 4.669433e-01 1 1  ON 25
 eO_6                 2.384952e-01 1 1  ON 26
 eO_7                -5.459605e-02 1 1  ON 27
 eO_8                -2.033106e-01 1 1  ON 28
 eO_9                -6.332356e-02 1 1  ON 29
eH1_0                -2.290611e-01 1 1  ON 30
eH1_1                -1.323085e-01 1 1  ON 31
eH1_2                -8.816040e-02 1 1  ON 32
eH1_3                -3.530178e-02 1 1  ON 33
eH1_4                 1.223777e-02 1 1  ON 34
eH1_5                 4.527698e-02 1 1  ON 35
eH1_6                 9.777314e-02 1 1  ON 36
eH1_7                 1.413764e-01 1 1  ON 37
eH1_8                 1.534022e-01 1 1  ON 38
eH1_9                 3.947229e-02 1 1  ON 39
eH2_0                -2.274253e-01 1 1  ON 40
eH2_1                -1.304459e-01 1 1  ON 41
eH2_2                -8.634395e-02 1 1  ON 42
eH2_3                -3.347431e-02 1 1  ON 43
eH2_4                 1.424534e-02 1 1  ON 44
eH2_5                 4.856864e-02 1 1  ON 45
eH2_6                 1.023948e-01 1 1  ON 46
eH2_7                 1.493693e-01 1 1  ON 47
eH2_8                 1.597901e-01 1 1  ON 48
eH2_9                 2.137583e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6112e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.895
    reference variance = 0.264235
====================================================
  Execution time = 2.0974e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3431e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6009e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334363275731
                                         uncertainty =       0.003202543178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334363275731
                                         uncertainty =       0.003202543178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408846619
  error estimate for blocks of size 2^( 2) =       0.000421862801
  error estimate for blocks of size 2^( 3) =       0.000435176142
  error estimate for blocks of size 2^( 4) =       0.000448241334
  error estimate for blocks of size 2^( 5) =       0.000459934399
  error estimate for blocks of size 2^( 6) =       0.000468481902
  error estimate for blocks of size 2^( 7) =       0.000475170408

      target function =                  N/A
              le_mean =     -16.905447996549
             les_mean =     286.128482913035
             stat err =       0.000462957011
             autocorr =       1.282213983686
              std dev =       0.578196433893
             le_variance =       0.334311116166


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690544799655e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905447996549       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905450850516       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905451208511       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905452470043       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905456275038       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905456795703       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905457118670       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905457599432       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905458447335       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905458674845       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905458946968       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905458879506       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 2.142047e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905447996549       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905449082719       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905449140916       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905449402950       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905450776672       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905450947378       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905450840936       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905451007266       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905450997934       residual = 9.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 6.009406e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905447996549       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905448308876       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905448321386       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905448382253       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905448731505       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905448771475       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905448764920       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905448792501       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.526597e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171356 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6583e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.075353e-01 1 1  ON 0
 uu_1                 1.414168e-01 1 1  ON 1
 uu_2                 4.063073e-02 1 1  ON 2
 uu_3                -2.055926e-02 1 1  ON 3
 uu_4                -6.421324e-02 1 1  ON 4
 uu_5                -9.708673e-02 1 1  ON 5
 uu_6                -1.225064e-01 1 1  ON 6
 uu_7                -1.341771e-01 1 1  ON 7
 uu_8                -1.252587e-01 1 1  ON 8
 uu_9                -9.532093e-02 1 1  ON 9
 ud_0                 4.382997e-01 1 1  ON 10
 ud_1                 1.746489e-01 1 1  ON 11
 ud_2                 5.878939e-02 1 1  ON 12
 ud_3                -9.034635e-03 1 1  ON 13
 ud_4                -6.494168e-02 1 1  ON 14
 ud_5                -1.052865e-01 1 1  ON 15
 ud_6                -1.315547e-01 1 1  ON 16
 ud_7                -1.471058e-01 1 1  ON 17
 ud_8                -1.481197e-01 1 1  ON 18
 ud_9                -1.381750e-01 1 1  ON 19
 eO_0                -7.442664e-01 1 1  ON 20
 eO_1                -4.293427e-01 1 1  ON 21
 eO_2                -1.723146e-02 1 1  ON 22
 eO_3                 2.939703e-01 1 1  ON 23
 eO_4                 5.104242e-01 1 1  ON 24
 eO_5                 4.672976e-01 1 1  ON 25
 eO_6                 2.387502e-01 1 1  ON 26
 eO_7                -5.443433e-02 1 1  ON 27
 eO_8                -2.036786e-01 1 1  ON 28
 eO_9                -6.359459e-02 1 1  ON 29
eH1_0                -2.294472e-01 1 1  ON 30
eH1_1                -1.324428e-01 1 1  ON 31
eH1_2                -8.829303e-02 1 1  ON 32
eH1_3                -3.526861e-02 1 1  ON 33
eH1_4                 1.209534e-02 1 1  ON 34
eH1_5                 4.513319e-02 1 1  ON 35
eH1_6                 9.787663e-02 1 1  ON 36
eH1_7                 1.417390e-01 1 1  ON 37
eH1_8                 1.536304e-01 1 1  ON 38
eH1_9                 3.968503e-02 1 1  ON 39
eH2_0                -2.276346e-01 1 1  ON 40
eH2_1                -1.305747e-01 1 1  ON 41
eH2_2                -8.640791e-02 1 1  ON 42
eH2_3                -3.358619e-02 1 1  ON 43
eH2_4                 1.409130e-02 1 1  ON 44
eH2_5                 4.855299e-02 1 1  ON 45
eH2_6                 1.023922e-01 1 1  ON 46
eH2_7                 1.493935e-01 1 1  ON 47
eH2_8                 1.600387e-01 1 1  ON 48
eH2_9                 2.175676e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8947
    reference variance = 0.236088
====================================================
  Execution time = 2.0270e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3965e-01
  Total weights = 2.0000e+06
  Execution time = 1.8902e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339521309128
                                         uncertainty =       0.005443562845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339521309128
                                         uncertainty =       0.005443562845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412042044
  error estimate for blocks of size 2^( 2) =       0.000425016636
  error estimate for blocks of size 2^( 3) =       0.000438177912
  error estimate for blocks of size 2^( 4) =       0.000452029416
  error estimate for blocks of size 2^( 5) =       0.000462913419
  error estimate for blocks of size 2^( 6) =       0.000471034640
  error estimate for blocks of size 2^( 7) =       0.000477222722

      target function =                  N/A
              le_mean =     -16.905191903177
             les_mean =     286.125070405574
             stat err =       0.000465800049
             autocorr =       1.277956274046
              std dev =       0.582715446949
             le_variance =       0.339557292113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339886920574
                                         uncertainty =       0.005449993557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339886920574
                                         uncertainty =       0.005449993557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412263781
  error estimate for blocks of size 2^( 2) =       0.000425228093
  error estimate for blocks of size 2^( 3) =       0.000438373749
  error estimate for blocks of size 2^( 4) =       0.000452202860
  error estimate for blocks of size 2^( 5) =       0.000463067768
  error estimate for blocks of size 2^( 6) =       0.000471180928
  error estimate for blocks of size 2^( 7) =       0.000477357535

      target function =                  N/A
              le_mean =     -16.905195741623
             les_mean =     286.125565742785
             stat err =       0.000465952273
             autocorr =       1.277416452171
              std dev =       0.583029030285
             le_variance =       0.339922850155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339717855939
                                         uncertainty =       0.005446680769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339717855939
                                         uncertainty =       0.005446680769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412161273
  error estimate for blocks of size 2^( 2) =       0.000425129414
  error estimate for blocks of size 2^( 3) =       0.000438283033
  error estimate for blocks of size 2^( 4) =       0.000452121784
  error estimate for blocks of size 2^( 5) =       0.000462995154
  error estimate for blocks of size 2^( 6) =       0.000471115024
  error estimate for blocks of size 2^( 7) =       0.000477296700

      target function =                  N/A
              le_mean =     -16.905195639100
             les_mean =     286.125393256883
             stat err =       0.000465882166
             autocorr =       1.277667374337
              std dev =       0.582884062671
             le_variance =       0.339753830516

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339549287230
                                         uncertainty =       0.005444033482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339549287230
                                         uncertainty =       0.005444033482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412059020
  error estimate for blocks of size 2^( 2) =       0.000425032604
  error estimate for blocks of size 2^( 3) =       0.000438192830
  error estimate for blocks of size 2^( 4) =       0.000452042610
  error estimate for blocks of size 2^( 5) =       0.000462925212
  error estimate for blocks of size 2^( 6) =       0.000471046490
  error estimate for blocks of size 2^( 7) =       0.000477233780

      target function =                  N/A
              le_mean =     -16.905192415861
             les_mean =     286.125115718763
             stat err =       0.000465812023
             autocorr =       1.277916676221
              std dev =       0.582739454033
             le_variance =       0.339585271287


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905191903177        initial
     1.5259e-01     1.5259e+00             2.1420e-03       -16.905195741623  <--
     6.1035e-01     6.1035e+00             6.0094e-04       -16.905195639100
     2.4414e+00     2.4414e+01             1.5266e-04       -16.905192415861

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 2.9763e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.076159e-01 1 1  ON 0
 uu_1                 1.415453e-01 1 1  ON 1
 uu_2                 4.079000e-02 1 1  ON 2
 uu_3                -2.050590e-02 1 1  ON 3
 uu_4                -6.430041e-02 1 1  ON 4
 uu_5                -9.739995e-02 1 1  ON 5
 uu_6                -1.226397e-01 1 1  ON 6
 uu_7                -1.343122e-01 1 1  ON 7
 uu_8                -1.257253e-01 1 1  ON 8
 uu_9                -9.579158e-02 1 1  ON 9
 ud_0                 4.391385e-01 1 1  ON 10
 ud_1                 1.753158e-01 1 1  ON 11
 ud_2                 5.927215e-02 1 1  ON 12
 ud_3                -8.814372e-03 1 1  ON 13
 ud_4                -6.492343e-02 1 1  ON 14
 ud_5                -1.054164e-01 1 1  ON 15
 ud_6                -1.317647e-01 1 1  ON 16
 ud_7                -1.472775e-01 1 1  ON 17
 ud_8                -1.483602e-01 1 1  ON 18
 ud_9                -1.388723e-01 1 1  ON 19
 eO_0                -7.455215e-01 1 1  ON 20
 eO_1                -4.304564e-01 1 1  ON 21
 eO_2                -1.757883e-02 1 1  ON 22
 eO_3                 2.947418e-01 1 1  ON 23
 eO_4                 5.119653e-01 1 1  ON 24
 eO_5                 4.684235e-01 1 1  ON 25
 eO_6                 2.395232e-01 1 1  ON 26
 eO_7                -5.394850e-02 1 1  ON 27
 eO_8                -2.047536e-01 1 1  ON 28
 eO_9                -6.441003e-02 1 1  ON 29
eH1_0                -2.303224e-01 1 1  ON 30
eH1_1                -1.328861e-01 1 1  ON 31
eH1_2                -8.868760e-02 1 1  ON 32
eH1_3                -3.540390e-02 1 1  ON 33
eH1_4                 1.173630e-02 1 1  ON 34
eH1_5                 4.472356e-02 1 1  ON 35
eH1_6                 9.809798e-02 1 1  ON 36
eH1_7                 1.427714e-01 1 1  ON 37
eH1_8                 1.543311e-01 1 1  ON 38
eH1_9                 4.034632e-02 1 1  ON 39
eH2_0                -2.282069e-01 1 1  ON 40
eH2_1                -1.310006e-01 1 1  ON 41
eH2_2                -8.671994e-02 1 1  ON 42
eH2_3                -3.386766e-02 1 1  ON 43
eH2_4                 1.371964e-02 1 1  ON 44
eH2_5                 4.837670e-02 1 1  ON 45
eH2_6                 1.024029e-01 1 1  ON 46
eH2_7                 1.495164e-01 1 1  ON 47
eH2_8                 1.607887e-01 1 1  ON 48
eH2_9                 2.291095e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6354e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.7959
    reference variance = 0.258204
====================================================
  Execution time = 2.0695e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3393e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0285e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333884611045
                                         uncertainty =       0.003153947961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333884611045
                                         uncertainty =       0.003153947961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408615340
  error estimate for blocks of size 2^( 2) =       0.000421462222
  error estimate for blocks of size 2^( 3) =       0.000434748699
  error estimate for blocks of size 2^( 4) =       0.000447745678
  error estimate for blocks of size 2^( 5) =       0.000458960408
  error estimate for blocks of size 2^( 6) =       0.000468018930
  error estimate for blocks of size 2^( 7) =       0.000472499986

      target function =                  N/A
              le_mean =     -16.905916219201
             les_mean =     286.143936036081
             stat err =       0.000461806250
             autocorr =       1.277292257469
              std dev =       0.577869355822
             le_variance =       0.333932992399


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690591621920e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905916219201       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905918753655       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905922506638       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905922910230       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905922864278       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905934463068       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905940374786       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905938406833       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905938440521       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905938454344       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905938794505       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905938346996       residual = 9.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905938846984       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905939511699       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905938886452       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 6.151909e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905916219201       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905917809227       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905919944657       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905919952629       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905919878122       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905925434143       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905925242743       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905924258316       residual = 8.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905924379804       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905924247832       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905924202632       residual = 8.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.749907e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905916219201       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905916857626       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905917729431       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905917773432       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905917708336       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905918576730       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905918954136       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905918834991       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905918654716       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 4.595187e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176416 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8194e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.078292e-01 1 1  ON 0
 uu_1                 1.417246e-01 1 1  ON 1
 uu_2                 4.087140e-02 1 1  ON 2
 uu_3                -2.053492e-02 1 1  ON 3
 uu_4                -6.438244e-02 1 1  ON 4
 uu_5                -9.730761e-02 1 1  ON 5
 uu_6                -1.228765e-01 1 1  ON 6
 uu_7                -1.344933e-01 1 1  ON 7
 uu_8                -1.262983e-01 1 1  ON 8
 uu_9                -9.638063e-02 1 1  ON 9
 ud_0                 4.395463e-01 1 1  ON 10
 ud_1                 1.758762e-01 1 1  ON 11
 ud_2                 5.972081e-02 1 1  ON 12
 ud_3                -8.539011e-03 1 1  ON 13
 ud_4                -6.522403e-02 1 1  ON 14
 ud_5                -1.055122e-01 1 1  ON 15
 ud_6                -1.316851e-01 1 1  ON 16
 ud_7                -1.471943e-01 1 1  ON 17
 ud_8                -1.486242e-01 1 1  ON 18
 ud_9                -1.396771e-01 1 1  ON 19
 eO_0                -7.470752e-01 1 1  ON 20
 eO_1                -4.315135e-01 1 1  ON 21
 eO_2                -1.815346e-02 1 1  ON 22
 eO_3                 2.953329e-01 1 1  ON 23
 eO_4                 5.135470e-01 1 1  ON 24
 eO_5                 4.701734e-01 1 1  ON 25
 eO_6                 2.407842e-01 1 1  ON 26
 eO_7                -5.353539e-02 1 1  ON 27
 eO_8                -2.059016e-01 1 1  ON 28
 eO_9                -6.544933e-02 1 1  ON 29
eH1_0                -2.314705e-01 1 1  ON 30
eH1_1                -1.337410e-01 1 1  ON 31
eH1_2                -8.940535e-02 1 1  ON 32
eH1_3                -3.616369e-02 1 1  ON 33
eH1_4                 1.141541e-02 1 1  ON 34
eH1_5                 4.422638e-02 1 1  ON 35
eH1_6                 9.863365e-02 1 1  ON 36
eH1_7                 1.437415e-01 1 1  ON 37
eH1_8                 1.557395e-01 1 1  ON 38
eH1_9                 4.165837e-02 1 1  ON 39
eH2_0                -2.289683e-01 1 1  ON 40
eH2_1                -1.316853e-01 1 1  ON 41
eH2_2                -8.702714e-02 1 1  ON 42
eH2_3                -3.382164e-02 1 1  ON 43
eH2_4                 1.375760e-02 1 1  ON 44
eH2_5                 4.824337e-02 1 1  ON 45
eH2_6                 1.028501e-01 1 1  ON 46
eH2_7                 1.498595e-01 1 1  ON 47
eH2_8                 1.612346e-01 1 1  ON 48
eH2_9                 2.371844e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9308
    reference variance = 0.706008
====================================================
  Execution time = 2.0199e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3833e-01
  Total weights = 2.0000e+06
  Execution time = 1.8910e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338320616401
                                         uncertainty =       0.004432131101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338320616401
                                         uncertainty =       0.004432131101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411283157
  error estimate for blocks of size 2^( 2) =       0.000424490475
  error estimate for blocks of size 2^( 3) =       0.000437659843
  error estimate for blocks of size 2^( 4) =       0.000450565789
  error estimate for blocks of size 2^( 5) =       0.000461918789
  error estimate for blocks of size 2^( 6) =       0.000471581489
  error estimate for blocks of size 2^( 7) =       0.000477827622

      target function =                  N/A
              le_mean =     -16.904643512191
             les_mean =     286.105279775243
             stat err =       0.000465473422
             autocorr =       1.280878479053
              std dev =       0.581642218309
             le_variance =       0.338307670120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338748002602
                                         uncertainty =       0.004434597292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338748002602
                                         uncertainty =       0.004434597292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411542463
  error estimate for blocks of size 2^( 2) =       0.000424746330
  error estimate for blocks of size 2^( 3) =       0.000437893042
  error estimate for blocks of size 2^( 4) =       0.000450760509
  error estimate for blocks of size 2^( 5) =       0.000462090086
  error estimate for blocks of size 2^( 6) =       0.000471736730
  error estimate for blocks of size 2^( 7) =       0.000477987847

      target function =                  N/A
              le_mean =     -16.904644258367
             les_mean =     286.105731729511
             stat err =       0.000465643793
             autocorr =       1.280201503008
              std dev =       0.582008932019
             le_variance =       0.338734396950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338379795999
                                         uncertainty =       0.004430331045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338379795999
                                         uncertainty =       0.004430331045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411318831
  error estimate for blocks of size 2^( 2) =       0.000424529235
  error estimate for blocks of size 2^( 3) =       0.000437692504
  error estimate for blocks of size 2^( 4) =       0.000450580266
  error estimate for blocks of size 2^( 5) =       0.000461928333
  error estimate for blocks of size 2^( 6) =       0.000471589420
  error estimate for blocks of size 2^( 7) =       0.000477850201

      target function =                  N/A
              le_mean =     -16.904645261926
             les_mean =     286.105397623405
             stat err =       0.000465487055
             autocorr =       1.280731319974
              std dev =       0.581692668869
             le_variance =       0.338366361016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338272806837
                                         uncertainty =       0.004431034562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338272806837
                                         uncertainty =       0.004431034562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411254041
  error estimate for blocks of size 2^( 2) =       0.000424462624
  error estimate for blocks of size 2^( 3) =       0.000437632229
  error estimate for blocks of size 2^( 4) =       0.000450536698
  error estimate for blocks of size 2^( 5) =       0.000461890675
  error estimate for blocks of size 2^( 6) =       0.000471554556
  error estimate for blocks of size 2^( 7) =       0.000477804681

      target function =                  N/A
              le_mean =     -16.904643141341
             les_mean =     286.105219339888
             stat err =       0.000465446653
             autocorr =       1.280912504439
              std dev =       0.581601042761
             le_variance =       0.338259772941


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904643512191        initial
     3.8147e-02     3.8147e-01             6.1519e-03       -16.904644258367
     1.5259e-01     1.5259e+00             1.7499e-03       -16.904645261926  <--
     6.1035e-01     6.1035e+00             4.5952e-04       -16.904643141341

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 3.3377e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.078292e-01 1 1  ON 0
 uu_1                 1.417246e-01 1 1  ON 1
 uu_2                 4.087140e-02 1 1  ON 2
 uu_3                -2.053492e-02 1 1  ON 3
 uu_4                -6.438244e-02 1 1  ON 4
 uu_5                -9.730761e-02 1 1  ON 5
 uu_6                -1.228765e-01 1 1  ON 6
 uu_7                -1.344933e-01 1 1  ON 7
 uu_8                -1.262983e-01 1 1  ON 8
 uu_9                -9.638063e-02 1 1  ON 9
 ud_0                 4.395463e-01 1 1  ON 10
 ud_1                 1.758762e-01 1 1  ON 11
 ud_2                 5.972081e-02 1 1  ON 12
 ud_3                -8.539011e-03 1 1  ON 13
 ud_4                -6.522403e-02 1 1  ON 14
 ud_5                -1.055122e-01 1 1  ON 15
 ud_6                -1.316851e-01 1 1  ON 16
 ud_7                -1.471943e-01 1 1  ON 17
 ud_8                -1.486242e-01 1 1  ON 18
 ud_9                -1.396771e-01 1 1  ON 19
 eO_0                -7.470752e-01 1 1  ON 20
 eO_1                -4.315135e-01 1 1  ON 21
 eO_2                -1.815346e-02 1 1  ON 22
 eO_3                 2.953329e-01 1 1  ON 23
 eO_4                 5.135470e-01 1 1  ON 24
 eO_5                 4.701734e-01 1 1  ON 25
 eO_6                 2.407842e-01 1 1  ON 26
 eO_7                -5.353539e-02 1 1  ON 27
 eO_8                -2.059016e-01 1 1  ON 28
 eO_9                -6.544933e-02 1 1  ON 29
eH1_0                -2.314705e-01 1 1  ON 30
eH1_1                -1.337410e-01 1 1  ON 31
eH1_2                -8.940535e-02 1 1  ON 32
eH1_3                -3.616369e-02 1 1  ON 33
eH1_4                 1.141541e-02 1 1  ON 34
eH1_5                 4.422638e-02 1 1  ON 35
eH1_6                 9.863365e-02 1 1  ON 36
eH1_7                 1.437415e-01 1 1  ON 37
eH1_8                 1.557395e-01 1 1  ON 38
eH1_9                 4.165837e-02 1 1  ON 39
eH2_0                -2.289683e-01 1 1  ON 40
eH2_1                -1.316853e-01 1 1  ON 41
eH2_2                -8.702714e-02 1 1  ON 42
eH2_3                -3.382164e-02 1 1  ON 43
eH2_4                 1.375760e-02 1 1  ON 44
eH2_5                 4.824337e-02 1 1  ON 45
eH2_6                 1.028501e-01 1 1  ON 46
eH2_7                 1.498595e-01 1 1  ON 47
eH2_8                 1.612346e-01 1 1  ON 48
eH2_9                 2.371844e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.1578e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8475
    reference variance = 0.368359
====================================================
  Execution time = 2.1104e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3469e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5878e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334557523005
                                         uncertainty =       0.003796651169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334557523005
                                         uncertainty =       0.003796651169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409079130
  error estimate for blocks of size 2^( 2) =       0.000421958429
  error estimate for blocks of size 2^( 3) =       0.000434613689
  error estimate for blocks of size 2^( 4) =       0.000447218839
  error estimate for blocks of size 2^( 5) =       0.000457490123
  error estimate for blocks of size 2^( 6) =       0.000464748157
  error estimate for blocks of size 2^( 7) =       0.000465932831

      target function =                  N/A
              le_mean =     -16.905305948489
             les_mean =     286.124060513717
             stat err =       0.000458847488
             autocorr =       1.258120008099
              std dev =       0.578525253605
             le_variance =       0.334691469058


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690530594849e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905305948489       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905308290915       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905308373266       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905311571084       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905307989980       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905308947665       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905312429187       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905314877660       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905317428742       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905317818258       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905321713782       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905320884545       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905319958118       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905320295545       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905320670436       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 6.148087e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905305948489       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905307436658       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905307879034       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905309230889       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905307038216       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905309217241       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905308914008       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905309179694       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905310080549       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905310121436       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905310363791       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.530927e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905305948489       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905306553741       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905307043862       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905307431324       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905306603252       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905307476658       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905306994566       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905307174236       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905307206536       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.856947e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181468 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6701e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.083608e-01 1 1  ON 0
 uu_1                 1.420820e-01 1 1  ON 1
 uu_2                 4.098473e-02 1 1  ON 2
 uu_3                -2.057705e-02 1 1  ON 3
 uu_4                -6.453568e-02 1 1  ON 4
 uu_5                -9.758510e-02 1 1  ON 5
 uu_6                -1.233926e-01 1 1  ON 6
 uu_7                -1.349938e-01 1 1  ON 7
 uu_8                -1.268805e-01 1 1  ON 8
 uu_9                -9.691450e-02 1 1  ON 9
 ud_0                 4.403100e-01 1 1  ON 10
 ud_1                 1.761865e-01 1 1  ON 11
 ud_2                 5.983219e-02 1 1  ON 12
 ud_3                -8.643234e-03 1 1  ON 13
 ud_4                -6.530837e-02 1 1  ON 14
 ud_5                -1.059491e-01 1 1  ON 15
 ud_6                -1.320129e-01 1 1  ON 16
 ud_7                -1.474484e-01 1 1  ON 17
 ud_8                -1.483911e-01 1 1  ON 18
 ud_9                -1.397636e-01 1 1  ON 19
 eO_0                -7.483473e-01 1 1  ON 20
 eO_1                -4.323836e-01 1 1  ON 21
 eO_2                -1.823855e-02 1 1  ON 22
 eO_3                 2.957424e-01 1 1  ON 23
 eO_4                 5.144318e-01 1 1  ON 24
 eO_5                 4.715624e-01 1 1  ON 25
 eO_6                 2.420872e-01 1 1  ON 26
 eO_7                -5.323032e-02 1 1  ON 27
 eO_8                -2.069566e-01 1 1  ON 28
 eO_9                -6.631640e-02 1 1  ON 29
eH1_0                -2.320130e-01 1 1  ON 30
eH1_1                -1.343577e-01 1 1  ON 31
eH1_2                -8.983749e-02 1 1  ON 32
eH1_3                -3.668730e-02 1 1  ON 33
eH1_4                 1.096426e-02 1 1  ON 34
eH1_5                 4.399273e-02 1 1  ON 35
eH1_6                 9.827224e-02 1 1  ON 36
eH1_7                 1.449065e-01 1 1  ON 37
eH1_8                 1.568833e-01 1 1  ON 38
eH1_9                 4.257290e-02 1 1  ON 39
eH2_0                -2.293685e-01 1 1  ON 40
eH2_1                -1.322926e-01 1 1  ON 41
eH2_2                -8.774313e-02 1 1  ON 42
eH2_3                -3.409901e-02 1 1  ON 43
eH2_4                 1.352887e-02 1 1  ON 44
eH2_5                 4.760186e-02 1 1  ON 45
eH2_6                 1.024238e-01 1 1  ON 46
eH2_7                 1.499904e-01 1 1  ON 47
eH2_8                 1.627603e-01 1 1  ON 48
eH2_9                 2.524937e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8558
    reference variance = 0.325302
====================================================
  Execution time = 2.0291e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3528e-01
  Total weights = 2.0000e+06
  Execution time = 1.8871e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334564832029
                                         uncertainty =       0.005224208162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334564832029
                                         uncertainty =       0.005224208162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408980195
  error estimate for blocks of size 2^( 2) =       0.000422087615
  error estimate for blocks of size 2^( 3) =       0.000436036964
  error estimate for blocks of size 2^( 4) =       0.000448850267
  error estimate for blocks of size 2^( 5) =       0.000459298962
  error estimate for blocks of size 2^( 6) =       0.000466316158
  error estimate for blocks of size 2^( 7) =       0.000471060715

      target function =                  N/A
              le_mean =     -16.905413556595
             les_mean =     286.127536952328
             stat err =       0.000461381525
             autocorr =       1.272670113580
              std dev =       0.578385338740
             le_variance =       0.334529600070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335906502518
                                         uncertainty =       0.005251437601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335906502518
                                         uncertainty =       0.005251437601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409799387
  error estimate for blocks of size 2^( 2) =       0.000422870478
  error estimate for blocks of size 2^( 3) =       0.000436766834
  error estimate for blocks of size 2^( 4) =       0.000449521641
  error estimate for blocks of size 2^( 5) =       0.000459931622
  error estimate for blocks of size 2^( 6) =       0.000466912477
  error estimate for blocks of size 2^( 7) =       0.000471639570

      target function =                  N/A
              le_mean =     -16.905411835723
             les_mean =     286.128820243380
             stat err =       0.000462001327
             autocorr =       1.270994984519
              std dev =       0.579543851591
             le_variance =       0.335871075917

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336082144445
                                         uncertainty =       0.005250478253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336082144445
                                         uncertainty =       0.005250478253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409906525
  error estimate for blocks of size 2^( 2) =       0.000422970161
  error estimate for blocks of size 2^( 3) =       0.000436863985
  error estimate for blocks of size 2^( 4) =       0.000449621830
  error estimate for blocks of size 2^( 5) =       0.000460044710
  error estimate for blocks of size 2^( 6) =       0.000467027848
  error estimate for blocks of size 2^( 7) =       0.000471761705

      target function =                  N/A
              le_mean =     -16.905412658001
             les_mean =     286.129023687986
             stat err =       0.000462114023
             autocorr =       1.270950488825
              std dev =       0.579695367149
             le_variance =       0.336046718695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334896862263
                                         uncertainty =       0.005229669149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334896862263
                                         uncertainty =       0.005229669149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409183077
  error estimate for blocks of size 2^( 2) =       0.000422280237
  error estimate for blocks of size 2^( 3) =       0.000436217668
  error estimate for blocks of size 2^( 4) =       0.000449019753
  error estimate for blocks of size 2^( 5) =       0.000459464251
  error estimate for blocks of size 2^( 6) =       0.000466474159
  error estimate for blocks of size 2^( 7) =       0.000471216787

      target function =                  N/A
              le_mean =     -16.905412978738
             les_mean =     286.127849395973
             stat err =       0.000461543737
             autocorr =       1.272302546745
              std dev =       0.578672257598
             le_variance =       0.334861581714


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905413556595        initial  <--
     3.8147e-02     3.8147e-01             6.1481e-03       -16.905411835723
     1.5259e-01     1.5259e+00             1.5309e-03       -16.905412658001
     6.1035e-01     6.1035e+00             3.8569e-04       -16.905412978738

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7700
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.078292e-01 1 1  ON 0
 uu_1                 1.417246e-01 1 1  ON 1
 uu_2                 4.087140e-02 1 1  ON 2
 uu_3                -2.053492e-02 1 1  ON 3
 uu_4                -6.438244e-02 1 1  ON 4
 uu_5                -9.730761e-02 1 1  ON 5
 uu_6                -1.228765e-01 1 1  ON 6
 uu_7                -1.344933e-01 1 1  ON 7
 uu_8                -1.262983e-01 1 1  ON 8
 uu_9                -9.638063e-02 1 1  ON 9
 ud_0                 4.395463e-01 1 1  ON 10
 ud_1                 1.758762e-01 1 1  ON 11
 ud_2                 5.972081e-02 1 1  ON 12
 ud_3                -8.539011e-03 1 1  ON 13
 ud_4                -6.522403e-02 1 1  ON 14
 ud_5                -1.055122e-01 1 1  ON 15
 ud_6                -1.316851e-01 1 1  ON 16
 ud_7                -1.471943e-01 1 1  ON 17
 ud_8                -1.486242e-01 1 1  ON 18
 ud_9                -1.396771e-01 1 1  ON 19
 eO_0                -7.470752e-01 1 1  ON 20
 eO_1                -4.315135e-01 1 1  ON 21
 eO_2                -1.815346e-02 1 1  ON 22
 eO_3                 2.953329e-01 1 1  ON 23
 eO_4                 5.135470e-01 1 1  ON 24
 eO_5                 4.701734e-01 1 1  ON 25
 eO_6                 2.407842e-01 1 1  ON 26
 eO_7                -5.353539e-02 1 1  ON 27
 eO_8                -2.059016e-01 1 1  ON 28
 eO_9                -6.544933e-02 1 1  ON 29
eH1_0                -2.314705e-01 1 1  ON 30
eH1_1                -1.337410e-01 1 1  ON 31
eH1_2                -8.940535e-02 1 1  ON 32
eH1_3                -3.616369e-02 1 1  ON 33
eH1_4                 1.141541e-02 1 1  ON 34
eH1_5                 4.422638e-02 1 1  ON 35
eH1_6                 9.863365e-02 1 1  ON 36
eH1_7                 1.437415e-01 1 1  ON 37
eH1_8                 1.557395e-01 1 1  ON 38
eH1_9                 4.165837e-02 1 1  ON 39
eH2_0                -2.289683e-01 1 1  ON 40
eH2_1                -1.316853e-01 1 1  ON 41
eH2_2                -8.702714e-02 1 1  ON 42
eH2_3                -3.382164e-02 1 1  ON 43
eH2_4                 1.375760e-02 1 1  ON 44
eH2_5                 4.824337e-02 1 1  ON 45
eH2_6                 1.028501e-01 1 1  ON 46
eH2_7                 1.498595e-01 1 1  ON 47
eH2_8                 1.612346e-01 1 1  ON 48
eH2_9                 2.371844e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6519e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8694
    reference variance = 0.963628
====================================================
  Execution time = 2.0745e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4062e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5370e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340492240120
                                         uncertainty =       0.006631146069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340492240120
                                         uncertainty =       0.006631146069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412688445
  error estimate for blocks of size 2^( 2) =       0.000425310385
  error estimate for blocks of size 2^( 3) =       0.000437669658
  error estimate for blocks of size 2^( 4) =       0.000448741222
  error estimate for blocks of size 2^( 5) =       0.000458508300
  error estimate for blocks of size 2^( 6) =       0.000465977238
  error estimate for blocks of size 2^( 7) =       0.000468966567

      target function =                  N/A
              le_mean =     -16.905759416973
             les_mean =     286.145324798833
             stat err =       0.000460548332
             autocorr =       1.245391248636
              std dev =       0.583629595349
             le_variance =       0.340623504567


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690575941697e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905759416973       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905760033924       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905760769755       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905760444015       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905762018482       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905762359289       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905761946654       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905761996867       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905761995208       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905762133193       residual = 2.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 5.965786e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905759416973       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905759613145       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905759783783       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905759680109       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905760205189       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905760295975       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905760179971       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905760194132       residual = 8.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.448796e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905759416973       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905759469593       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905759508908       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905759480114       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905759622007       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905759652209       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905759623618       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905759626588       residual = 4.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.723672e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184437 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6290e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.078811e-01 1 1  ON 0
 uu_1                 1.416908e-01 1 1  ON 1
 uu_2                 4.081509e-02 1 1  ON 2
 uu_3                -2.055829e-02 1 1  ON 3
 uu_4                -6.439469e-02 1 1  ON 4
 uu_5                -9.732320e-02 1 1  ON 5
 uu_6                -1.228064e-01 1 1  ON 6
 uu_7                -1.345003e-01 1 1  ON 7
 uu_8                -1.263726e-01 1 1  ON 8
 uu_9                -9.641708e-02 1 1  ON 9
 ud_0                 4.396557e-01 1 1  ON 10
 ud_1                 1.760102e-01 1 1  ON 11
 ud_2                 5.979749e-02 1 1  ON 12
 ud_3                -8.476199e-03 1 1  ON 13
 ud_4                -6.521643e-02 1 1  ON 14
 ud_5                -1.056105e-01 1 1  ON 15
 ud_6                -1.317448e-01 1 1  ON 16
 ud_7                -1.472409e-01 1 1  ON 17
 ud_8                -1.487502e-01 1 1  ON 18
 ud_9                -1.397492e-01 1 1  ON 19
 eO_0                -7.471395e-01 1 1  ON 20
 eO_1                -4.316226e-01 1 1  ON 21
 eO_2                -1.816299e-02 1 1  ON 22
 eO_3                 2.953069e-01 1 1  ON 23
 eO_4                 5.136911e-01 1 1  ON 24
 eO_5                 4.702815e-01 1 1  ON 25
 eO_6                 2.408909e-01 1 1  ON 26
 eO_7                -5.347522e-02 1 1  ON 27
 eO_8                -2.060148e-01 1 1  ON 28
 eO_9                -6.553375e-02 1 1  ON 29
eH1_0                -2.314565e-01 1 1  ON 30
eH1_1                -1.338164e-01 1 1  ON 31
eH1_2                -8.944567e-02 1 1  ON 32
eH1_3                -3.621100e-02 1 1  ON 33
eH1_4                 1.132045e-02 1 1  ON 34
eH1_5                 4.422403e-02 1 1  ON 35
eH1_6                 9.865054e-02 1 1  ON 36
eH1_7                 1.437791e-01 1 1  ON 37
eH1_8                 1.558353e-01 1 1  ON 38
eH1_9                 4.175149e-02 1 1  ON 39
eH2_0                -2.290109e-01 1 1  ON 40
eH2_1                -1.316976e-01 1 1  ON 41
eH2_2                -8.707278e-02 1 1  ON 42
eH2_3                -3.387455e-02 1 1  ON 43
eH2_4                 1.364008e-02 1 1  ON 44
eH2_5                 4.824824e-02 1 1  ON 45
eH2_6                 1.028388e-01 1 1  ON 46
eH2_7                 1.498583e-01 1 1  ON 47
eH2_8                 1.613480e-01 1 1  ON 48
eH2_9                 2.386332e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8913
    reference variance = 1.03578
====================================================
  Execution time = 2.0319e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4386e-01
  Total weights = 2.0000e+06
  Execution time = 1.8874e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343743240912
                                         uncertainty =       0.006786447130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343743240912
                                         uncertainty =       0.006786447130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414615167
  error estimate for blocks of size 2^( 2) =       0.000427277931
  error estimate for blocks of size 2^( 3) =       0.000440222472
  error estimate for blocks of size 2^( 4) =       0.000452384242
  error estimate for blocks of size 2^( 5) =       0.000462039315
  error estimate for blocks of size 2^( 6) =       0.000469309763
  error estimate for blocks of size 2^( 7) =       0.000475340869

      target function =                  N/A
              le_mean =     -16.905837050560
             les_mean =     286.151137681136
             stat err =       0.000464768547
             autocorr =       1.256559593736
              std dev =       0.586354391959
             le_variance =       0.343811472969

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343888995218
                                         uncertainty =       0.006784017891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343888995218
                                         uncertainty =       0.006784017891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414703095
  error estimate for blocks of size 2^( 2) =       0.000427362394
  error estimate for blocks of size 2^( 3) =       0.000440298189
  error estimate for blocks of size 2^( 4) =       0.000452452201
  error estimate for blocks of size 2^( 5) =       0.000462104213
  error estimate for blocks of size 2^( 6) =       0.000469370177
  error estimate for blocks of size 2^( 7) =       0.000475396957

      target function =                  N/A
              le_mean =     -16.905836270651
             les_mean =     286.151257151786
             stat err =       0.000464830887
             autocorr =       1.256363768327
              std dev =       0.586478741056
             le_variance =       0.343957313711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343838761379
                                         uncertainty =       0.006784674226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343838761379
                                         uncertainty =       0.006784674226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414672782
  error estimate for blocks of size 2^( 2) =       0.000427333537
  error estimate for blocks of size 2^( 3) =       0.000440272518
  error estimate for blocks of size 2^( 4) =       0.000452429624
  error estimate for blocks of size 2^( 5) =       0.000462083306
  error estimate for blocks of size 2^( 6) =       0.000469350894
  error estimate for blocks of size 2^( 7) =       0.000475379406

      target function =                  N/A
              le_mean =     -16.905836359382
             les_mean =     286.151209870801
             stat err =       0.000464810808
             autocorr =       1.256438900637
              std dev =       0.586435872511
             le_variance =       0.343907032568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343754604121
                                         uncertainty =       0.006786109642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343754604121
                                         uncertainty =       0.006786109642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414622021
  error estimate for blocks of size 2^( 2) =       0.000427284555
  error estimate for blocks of size 2^( 3) =       0.000440228374
  error estimate for blocks of size 2^( 4) =       0.000452389553
  error estimate for blocks of size 2^( 5) =       0.000462044497
  error estimate for blocks of size 2^( 6) =       0.000469314568
  error estimate for blocks of size 2^( 7) =       0.000475345355

      target function =                  N/A
              le_mean =     -16.905836924614
             les_mean =     286.151144789766
             stat err =       0.000464773493
             autocorr =       1.256544795423
              std dev =       0.586364084872
             le_variance =       0.343822840028


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905837050560        initial  <--
     3.8147e-01     3.8147e+00             5.9658e-04       -16.905836270651
     1.5259e+00     1.5259e+01             1.4488e-04       -16.905836359382
     6.1035e+00     6.1035e+01             3.7237e-05       -16.905836924614

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7969
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.078292e-01 1 1  ON 0
 uu_1                 1.417246e-01 1 1  ON 1
 uu_2                 4.087140e-02 1 1  ON 2
 uu_3                -2.053492e-02 1 1  ON 3
 uu_4                -6.438244e-02 1 1  ON 4
 uu_5                -9.730761e-02 1 1  ON 5
 uu_6                -1.228765e-01 1 1  ON 6
 uu_7                -1.344933e-01 1 1  ON 7
 uu_8                -1.262983e-01 1 1  ON 8
 uu_9                -9.638063e-02 1 1  ON 9
 ud_0                 4.395463e-01 1 1  ON 10
 ud_1                 1.758762e-01 1 1  ON 11
 ud_2                 5.972081e-02 1 1  ON 12
 ud_3                -8.539011e-03 1 1  ON 13
 ud_4                -6.522403e-02 1 1  ON 14
 ud_5                -1.055122e-01 1 1  ON 15
 ud_6                -1.316851e-01 1 1  ON 16
 ud_7                -1.471943e-01 1 1  ON 17
 ud_8                -1.486242e-01 1 1  ON 18
 ud_9                -1.396771e-01 1 1  ON 19
 eO_0                -7.470752e-01 1 1  ON 20
 eO_1                -4.315135e-01 1 1  ON 21
 eO_2                -1.815346e-02 1 1  ON 22
 eO_3                 2.953329e-01 1 1  ON 23
 eO_4                 5.135470e-01 1 1  ON 24
 eO_5                 4.701734e-01 1 1  ON 25
 eO_6                 2.407842e-01 1 1  ON 26
 eO_7                -5.353539e-02 1 1  ON 27
 eO_8                -2.059016e-01 1 1  ON 28
 eO_9                -6.544933e-02 1 1  ON 29
eH1_0                -2.314705e-01 1 1  ON 30
eH1_1                -1.337410e-01 1 1  ON 31
eH1_2                -8.940535e-02 1 1  ON 32
eH1_3                -3.616369e-02 1 1  ON 33
eH1_4                 1.141541e-02 1 1  ON 34
eH1_5                 4.422638e-02 1 1  ON 35
eH1_6                 9.863365e-02 1 1  ON 36
eH1_7                 1.437415e-01 1 1  ON 37
eH1_8                 1.557395e-01 1 1  ON 38
eH1_9                 4.165837e-02 1 1  ON 39
eH2_0                -2.289683e-01 1 1  ON 40
eH2_1                -1.316853e-01 1 1  ON 41
eH2_2                -8.702714e-02 1 1  ON 42
eH2_3                -3.382164e-02 1 1  ON 43
eH2_4                 1.375760e-02 1 1  ON 44
eH2_5                 4.824337e-02 1 1  ON 45
eH2_6                 1.028501e-01 1 1  ON 46
eH2_7                 1.498595e-01 1 1  ON 47
eH2_8                 1.612346e-01 1 1  ON 48
eH2_9                 2.371844e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6357e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9066
    reference variance = 0.334125
====================================================
  Execution time = 2.0509e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5333e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4980e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353442279747
                                         uncertainty =       0.008230851616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353442279747
                                         uncertainty =       0.008230851616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420316881
  error estimate for blocks of size 2^( 2) =       0.000432889142
  error estimate for blocks of size 2^( 3) =       0.000446038036
  error estimate for blocks of size 2^( 4) =       0.000458110060
  error estimate for blocks of size 2^( 5) =       0.000468896799
  error estimate for blocks of size 2^( 6) =       0.000475785057
  error estimate for blocks of size 2^( 7) =       0.000482818457

      target function =                  N/A
              le_mean =     -16.905823776165
             les_mean =     286.160209935018
             stat err =       0.000471402593
             autocorr =       1.257854098718
              std dev =       0.594417833635
             le_variance =       0.353332560943


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690582377616e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905823776165       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905824155266       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905824389777       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905824353547       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905824412609       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905824392887       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905824388814       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905824380155       residual = 5.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 7.586913e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905823776165       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905823875632       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905823937758       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905823928446       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905823943556       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905823937872       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905823936252       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905823934138       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.927879e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905823776165       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905823801343       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905823817116       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905823814777       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905823818585       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905823817117       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905823816667       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905823816142       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 4.840109e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187080 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6014e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.078322e-01 1 1  ON 0
 uu_1                 1.417291e-01 1 1  ON 1
 uu_2                 4.086927e-02 1 1  ON 2
 uu_3                -2.054113e-02 1 1  ON 3
 uu_4                -6.438050e-02 1 1  ON 4
 uu_5                -9.731130e-02 1 1  ON 5
 uu_6                -1.228815e-01 1 1  ON 6
 uu_7                -1.344940e-01 1 1  ON 7
 uu_8                -1.263027e-01 1 1  ON 8
 uu_9                -9.638226e-02 1 1  ON 9
 ud_0                 4.395441e-01 1 1  ON 10
 ud_1                 1.758818e-01 1 1  ON 11
 ud_2                 5.972791e-02 1 1  ON 12
 ud_3                -8.542062e-03 1 1  ON 13
 ud_4                -6.521915e-02 1 1  ON 14
 ud_5                -1.055218e-01 1 1  ON 15
 ud_6                -1.316873e-01 1 1  ON 16
 ud_7                -1.471951e-01 1 1  ON 17
 ud_8                -1.486186e-01 1 1  ON 18
 ud_9                -1.396776e-01 1 1  ON 19
 eO_0                -7.470945e-01 1 1  ON 20
 eO_1                -4.315225e-01 1 1  ON 21
 eO_2                -1.814967e-02 1 1  ON 22
 eO_3                 2.953365e-01 1 1  ON 23
 eO_4                 5.135638e-01 1 1  ON 24
 eO_5                 4.701792e-01 1 1  ON 25
 eO_6                 2.407943e-01 1 1  ON 26
 eO_7                -5.352763e-02 1 1  ON 27
 eO_8                -2.059099e-01 1 1  ON 28
 eO_9                -6.545887e-02 1 1  ON 29
eH1_0                -2.314881e-01 1 1  ON 30
eH1_1                -1.337522e-01 1 1  ON 31
eH1_2                -8.940775e-02 1 1  ON 32
eH1_3                -3.617795e-02 1 1  ON 33
eH1_4                 1.141385e-02 1 1  ON 34
eH1_5                 4.422921e-02 1 1  ON 35
eH1_6                 9.863624e-02 1 1  ON 36
eH1_7                 1.437531e-01 1 1  ON 37
eH1_8                 1.557564e-01 1 1  ON 38
eH1_9                 4.167168e-02 1 1  ON 39
eH2_0                -2.289801e-01 1 1  ON 40
eH2_1                -1.316890e-01 1 1  ON 41
eH2_2                -8.703293e-02 1 1  ON 42
eH2_3                -3.381644e-02 1 1  ON 43
eH2_4                 1.375277e-02 1 1  ON 44
eH2_5                 4.823663e-02 1 1  ON 45
eH2_6                 1.028559e-01 1 1  ON 46
eH2_7                 1.498622e-01 1 1  ON 47
eH2_8                 1.612420e-01 1 1  ON 48
eH2_9                 2.373120e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9358
    reference variance = 0.335325
====================================================
  Execution time = 1.9969e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3797e-01
  Total weights = 2.0000e+06
  Execution time = 1.8602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337691432569
                                         uncertainty =       0.005096271271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337691432569
                                         uncertainty =       0.005096271271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411081727
  error estimate for blocks of size 2^( 2) =       0.000424090065
  error estimate for blocks of size 2^( 3) =       0.000437315820
  error estimate for blocks of size 2^( 4) =       0.000450277377
  error estimate for blocks of size 2^( 5) =       0.000460677971
  error estimate for blocks of size 2^( 6) =       0.000468959854
  error estimate for blocks of size 2^( 7) =       0.000476872932

      target function =                  N/A
              le_mean =     -16.905922150009
             les_mean =     286.148179945104
             stat err =       0.000464197033
             autocorr =       1.275112130730
              std dev =       0.581357353021
             le_variance =       0.337976371912

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337674563878
                                         uncertainty =       0.005095415130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337674563878
                                         uncertainty =       0.005095415130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411071461
  error estimate for blocks of size 2^( 2) =       0.000424080559
  error estimate for blocks of size 2^( 3) =       0.000437306729
  error estimate for blocks of size 2^( 4) =       0.000450268500
  error estimate for blocks of size 2^( 5) =       0.000460669061
  error estimate for blocks of size 2^( 6) =       0.000468951056
  error estimate for blocks of size 2^( 7) =       0.000476862413

      target function =                  N/A
              le_mean =     -16.905921939619
             les_mean =     286.148155951249
             stat err =       0.000464187758
             autocorr =       1.275124858145
              std dev =       0.581342834928
             le_variance =       0.337959491722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337681440775
                                         uncertainty =       0.005095807554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337681440775
                                         uncertainty =       0.005095807554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411075645
  error estimate for blocks of size 2^( 2) =       0.000424084415
  error estimate for blocks of size 2^( 3) =       0.000437310424
  error estimate for blocks of size 2^( 4) =       0.000450272123
  error estimate for blocks of size 2^( 5) =       0.000460672717
  error estimate for blocks of size 2^( 6) =       0.000468954679
  error estimate for blocks of size 2^( 7) =       0.000476866815

      target function =                  N/A
              le_mean =     -16.905922038891
             les_mean =     286.148166188293
             stat err =       0.000464191584
             autocorr =       1.275119918361
              std dev =       0.581348752654
             le_variance =       0.337966372213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337690127171
                                         uncertainty =       0.005096212157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337690127171
                                         uncertainty =       0.005096212157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411080932
  error estimate for blocks of size 2^( 2) =       0.000424089326
  error estimate for blocks of size 2^( 3) =       0.000437315115
  error estimate for blocks of size 2^( 4) =       0.000450276690
  error estimate for blocks of size 2^( 5) =       0.000460677285
  error estimate for blocks of size 2^( 6) =       0.000468959178
  error estimate for blocks of size 2^( 7) =       0.000476872136

      target function =                  N/A
              le_mean =     -16.905922135688
             les_mean =     286.148178154415
             stat err =       0.000464196323
             autocorr =       1.275113154534
              std dev =       0.581356229388
             le_variance =       0.337975065449


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905922150009        initial  <--
     3.8147e+00     3.8147e+01             7.5869e-05       -16.905921939619
     1.5259e+01     1.5259e+02             1.9279e-05       -16.905922038891
     6.1035e+01     6.1035e+02             4.8401e-06       -16.905922135688

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3271
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.078292e-01 1 1  ON 0
 uu_1                 1.417246e-01 1 1  ON 1
 uu_2                 4.087140e-02 1 1  ON 2
 uu_3                -2.053492e-02 1 1  ON 3
 uu_4                -6.438244e-02 1 1  ON 4
 uu_5                -9.730761e-02 1 1  ON 5
 uu_6                -1.228765e-01 1 1  ON 6
 uu_7                -1.344933e-01 1 1  ON 7
 uu_8                -1.262983e-01 1 1  ON 8
 uu_9                -9.638063e-02 1 1  ON 9
 ud_0                 4.395463e-01 1 1  ON 10
 ud_1                 1.758762e-01 1 1  ON 11
 ud_2                 5.972081e-02 1 1  ON 12
 ud_3                -8.539011e-03 1 1  ON 13
 ud_4                -6.522403e-02 1 1  ON 14
 ud_5                -1.055122e-01 1 1  ON 15
 ud_6                -1.316851e-01 1 1  ON 16
 ud_7                -1.471943e-01 1 1  ON 17
 ud_8                -1.486242e-01 1 1  ON 18
 ud_9                -1.396771e-01 1 1  ON 19
 eO_0                -7.470752e-01 1 1  ON 20
 eO_1                -4.315135e-01 1 1  ON 21
 eO_2                -1.815346e-02 1 1  ON 22
 eO_3                 2.953329e-01 1 1  ON 23
 eO_4                 5.135470e-01 1 1  ON 24
 eO_5                 4.701734e-01 1 1  ON 25
 eO_6                 2.407842e-01 1 1  ON 26
 eO_7                -5.353539e-02 1 1  ON 27
 eO_8                -2.059016e-01 1 1  ON 28
 eO_9                -6.544933e-02 1 1  ON 29
eH1_0                -2.314705e-01 1 1  ON 30
eH1_1                -1.337410e-01 1 1  ON 31
eH1_2                -8.940535e-02 1 1  ON 32
eH1_3                -3.616369e-02 1 1  ON 33
eH1_4                 1.141541e-02 1 1  ON 34
eH1_5                 4.422638e-02 1 1  ON 35
eH1_6                 9.863365e-02 1 1  ON 36
eH1_7                 1.437415e-01 1 1  ON 37
eH1_8                 1.557395e-01 1 1  ON 38
eH1_9                 4.165837e-02 1 1  ON 39
eH2_0                -2.289683e-01 1 1  ON 40
eH2_1                -1.316853e-01 1 1  ON 41
eH2_2                -8.702714e-02 1 1  ON 42
eH2_3                -3.382164e-02 1 1  ON 43
eH2_4                 1.375760e-02 1 1  ON 44
eH2_5                 4.824337e-02 1 1  ON 45
eH2_6                 1.028501e-01 1 1  ON 46
eH2_7                 1.498595e-01 1 1  ON 47
eH2_8                 1.612346e-01 1 1  ON 48
eH2_9                 2.371844e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5350e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.828
    reference variance = 0.31757
====================================================
  Execution time = 2.0842e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3803e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5415e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337955259959
                                         uncertainty =       0.003296977999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337955259959
                                         uncertainty =       0.003296977999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411113638
  error estimate for blocks of size 2^( 2) =       0.000423619283
  error estimate for blocks of size 2^( 3) =       0.000436063486
  error estimate for blocks of size 2^( 4) =       0.000448563089
  error estimate for blocks of size 2^( 5) =       0.000458010460
  error estimate for blocks of size 2^( 6) =       0.000465899079
  error estimate for blocks of size 2^( 7) =       0.000469978562

      target function =                  N/A
              le_mean =     -16.906249524520
             les_mean =     286.159301662434
             stat err =       0.000460612797
             autocorr =       1.255302034564
              std dev =       0.581402482030
             le_variance =       0.338028846111


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690624952452e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906249524520       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906249535320       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906249560851       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906249564367       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906249562696       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906249560329       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906249564870       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 6.439131e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906249524520       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906249527227       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906249533672       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906249534539       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906249534130       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906249533554       residual = 9.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906249534676       residual = 6.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.610631e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906249524520       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906249525197       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906249526812       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906249527029       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906249526927       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906249526784       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906249527063       residual = 6.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 4.027109e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.189374 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6391e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.078282e-01 1 1  ON 0
 uu_1                 1.417255e-01 1 1  ON 1
 uu_2                 4.087142e-02 1 1  ON 2
 uu_3                -2.053428e-02 1 1  ON 3
 uu_4                -6.438268e-02 1 1  ON 4
 uu_5                -9.730755e-02 1 1  ON 5
 uu_6                -1.228769e-01 1 1  ON 6
 uu_7                -1.344935e-01 1 1  ON 7
 uu_8                -1.262992e-01 1 1  ON 8
 uu_9                -9.638148e-02 1 1  ON 9
 ud_0                 4.395464e-01 1 1  ON 10
 ud_1                 1.758764e-01 1 1  ON 11
 ud_2                 5.972181e-02 1 1  ON 12
 ud_3                -8.539025e-03 1 1  ON 13
 ud_4                -6.522358e-02 1 1  ON 14
 ud_5                -1.055131e-01 1 1  ON 15
 ud_6                -1.316857e-01 1 1  ON 16
 ud_7                -1.471942e-01 1 1  ON 17
 ud_8                -1.486243e-01 1 1  ON 18
 ud_9                -1.396771e-01 1 1  ON 19
 eO_0                -7.470762e-01 1 1  ON 20
 eO_1                -4.315140e-01 1 1  ON 21
 eO_2                -1.815383e-02 1 1  ON 22
 eO_3                 2.953330e-01 1 1  ON 23
 eO_4                 5.135476e-01 1 1  ON 24
 eO_5                 4.701748e-01 1 1  ON 25
 eO_6                 2.407854e-01 1 1  ON 26
 eO_7                -5.353478e-02 1 1  ON 27
 eO_8                -2.059026e-01 1 1  ON 28
 eO_9                -6.545024e-02 1 1  ON 29
eH1_0                -2.314709e-01 1 1  ON 30
eH1_1                -1.337420e-01 1 1  ON 31
eH1_2                -8.940560e-02 1 1  ON 32
eH1_3                -3.616464e-02 1 1  ON 33
eH1_4                 1.141561e-02 1 1  ON 34
eH1_5                 4.422648e-02 1 1  ON 35
eH1_6                 9.863342e-02 1 1  ON 36
eH1_7                 1.437419e-01 1 1  ON 37
eH1_8                 1.557405e-01 1 1  ON 38
eH1_9                 4.165943e-02 1 1  ON 39
eH2_0                -2.289692e-01 1 1  ON 40
eH2_1                -1.316859e-01 1 1  ON 41
eH2_2                -8.702799e-02 1 1  ON 42
eH2_3                -3.382227e-02 1 1  ON 43
eH2_4                 1.375764e-02 1 1  ON 44
eH2_5                 4.824303e-02 1 1  ON 45
eH2_6                 1.028496e-01 1 1  ON 46
eH2_7                 1.498604e-01 1 1  ON 47
eH2_8                 1.612362e-01 1 1  ON 48
eH2_9                 2.371986e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8828
    reference variance = 0.325971
====================================================
  Execution time = 2.0201e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3749e-01
  Total weights = 2.0000e+06
  Execution time = 1.8650e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337495348829
                                         uncertainty =       0.004332455157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337495348829
                                         uncertainty =       0.004332455157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410786231
  error estimate for blocks of size 2^( 2) =       0.000423257524
  error estimate for blocks of size 2^( 3) =       0.000436774558
  error estimate for blocks of size 2^( 4) =       0.000449149487
  error estimate for blocks of size 2^( 5) =       0.000458843109
  error estimate for blocks of size 2^( 6) =       0.000467129645
  error estimate for blocks of size 2^( 7) =       0.000471743850

      target function =                  N/A
              le_mean =     -16.906193794291
             les_mean =     286.156879095956
             stat err =       0.000461716523
             autocorr =       1.263336596556
              std dev =       0.580939458621
             le_variance =       0.337490654583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337492655613
                                         uncertainty =       0.004332448352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337492655613
                                         uncertainty =       0.004332448352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410784592
  error estimate for blocks of size 2^( 2) =       0.000423255989
  error estimate for blocks of size 2^( 3) =       0.000436773053
  error estimate for blocks of size 2^( 4) =       0.000449148036
  error estimate for blocks of size 2^( 5) =       0.000458841700
  error estimate for blocks of size 2^( 6) =       0.000467128198
  error estimate for blocks of size 2^( 7) =       0.000471742415

      target function =                  N/A
              le_mean =     -16.906193796907
             les_mean =     286.156876491518
             stat err =       0.000461715087
             autocorr =       1.263338820321
              std dev =       0.580937140892
             le_variance =       0.337487961668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337493990578
                                         uncertainty =       0.004332451718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337493990578
                                         uncertainty =       0.004332451718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410785404
  error estimate for blocks of size 2^( 2) =       0.000423256750
  error estimate for blocks of size 2^( 3) =       0.000436773800
  error estimate for blocks of size 2^( 4) =       0.000449148756
  error estimate for blocks of size 2^( 5) =       0.000458842399
  error estimate for blocks of size 2^( 6) =       0.000467128916
  error estimate for blocks of size 2^( 7) =       0.000471743127

      target function =                  N/A
              le_mean =     -16.906193795665
             les_mean =     286.156877784323
             stat err =       0.000461715799
             autocorr =       1.263337720607
              std dev =       0.580938289739
             le_variance =       0.337489296485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337495178660
                                         uncertainty =       0.004332454726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337495178660
                                         uncertainty =       0.004332454726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410786127
  error estimate for blocks of size 2^( 2) =       0.000423257427
  error estimate for blocks of size 2^( 3) =       0.000436774463
  error estimate for blocks of size 2^( 4) =       0.000449149396
  error estimate for blocks of size 2^( 5) =       0.000458843020
  error estimate for blocks of size 2^( 6) =       0.000467129554
  error estimate for blocks of size 2^( 7) =       0.000471743759

      target function =                  N/A
              le_mean =     -16.906193794463
             les_mean =     286.156878931624
             stat err =       0.000461716432
             autocorr =       1.263336737459
              std dev =       0.580939312178
             le_variance =       0.337490484433


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906193794291        initial
     3.8147e+01     3.8147e+02             6.4391e-06       -16.906193796907  <--
     1.5259e+02     1.5259e+03             1.6106e-06       -16.906193795665
     6.1035e+02     6.1035e+03             4.0271e-07       -16.906193794463

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 2.9590e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.078255e-01 1 1  ON 0
 uu_1                 1.417284e-01 1 1  ON 1
 uu_2                 4.087148e-02 1 1  ON 2
 uu_3                -2.053240e-02 1 1  ON 3
 uu_4                -6.438337e-02 1 1  ON 4
 uu_5                -9.730739e-02 1 1  ON 5
 uu_6                -1.228781e-01 1 1  ON 6
 uu_7                -1.344941e-01 1 1  ON 7
 uu_8                -1.263016e-01 1 1  ON 8
 uu_9                -9.638404e-02 1 1  ON 9
 ud_0                 4.395466e-01 1 1  ON 10
 ud_1                 1.758773e-01 1 1  ON 11
 ud_2                 5.972477e-02 1 1  ON 12
 ud_3                -8.539044e-03 1 1  ON 13
 ud_4                -6.522225e-02 1 1  ON 14
 ud_5                -1.055156e-01 1 1  ON 15
 ud_6                -1.316873e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486247e-01 1 1  ON 18
 ud_9                -1.396773e-01 1 1  ON 19
 eO_0                -7.470792e-01 1 1  ON 20
 eO_1                -4.315156e-01 1 1  ON 21
 eO_2                -1.815493e-02 1 1  ON 22
 eO_3                 2.953332e-01 1 1  ON 23
 eO_4                 5.135495e-01 1 1  ON 24
 eO_5                 4.701791e-01 1 1  ON 25
 eO_6                 2.407891e-01 1 1  ON 26
 eO_7                -5.353295e-02 1 1  ON 27
 eO_8                -2.059056e-01 1 1  ON 28
 eO_9                -6.545296e-02 1 1  ON 29
eH1_0                -2.314719e-01 1 1  ON 30
eH1_1                -1.337452e-01 1 1  ON 31
eH1_2                -8.940638e-02 1 1  ON 32
eH1_3                -3.616750e-02 1 1  ON 33
eH1_4                 1.141620e-02 1 1  ON 34
eH1_5                 4.422680e-02 1 1  ON 35
eH1_6                 9.863272e-02 1 1  ON 36
eH1_7                 1.437432e-01 1 1  ON 37
eH1_8                 1.557435e-01 1 1  ON 38
eH1_9                 4.166262e-02 1 1  ON 39
eH2_0                -2.289721e-01 1 1  ON 40
eH2_1                -1.316875e-01 1 1  ON 41
eH2_2                -8.703053e-02 1 1  ON 42
eH2_3                -3.382417e-02 1 1  ON 43
eH2_4                 1.375774e-02 1 1  ON 44
eH2_5                 4.824202e-02 1 1  ON 45
eH2_6                 1.028480e-01 1 1  ON 46
eH2_7                 1.498629e-01 1 1  ON 47
eH2_8                 1.612410e-01 1 1  ON 48
eH2_9                 2.372414e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5987e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9405
    reference variance = 0.274126
====================================================
  Execution time = 2.0459e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3524e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6358e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335256323286
                                         uncertainty =       0.003185910385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335256323286
                                         uncertainty =       0.003185910385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409412695
  error estimate for blocks of size 2^( 2) =       0.000422082281
  error estimate for blocks of size 2^( 3) =       0.000434479303
  error estimate for blocks of size 2^( 4) =       0.000446812566
  error estimate for blocks of size 2^( 5) =       0.000457513415
  error estimate for blocks of size 2^( 6) =       0.000465965055
  error estimate for blocks of size 2^( 7) =       0.000469065838

      target function =                  N/A
              le_mean =     -16.905774706285
             les_mean =     286.140455761071
             stat err =       0.000459839219
             autocorr =       1.261506252710
              std dev =       0.578996985328
             le_variance =       0.335237509019


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690577470629e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905774706285       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905774713513       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905774646227       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905774616974       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905774648419       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905774684350       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905774681044       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905774676267       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 3.358138e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905774706285       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905774708115       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905774690849       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905774683541       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905774691376       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905774699805       residual = 7.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905774699399       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905774698161       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 8.493097e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905774706285       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905774706744       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905774702399       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905774700572       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905774702529       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905774704600       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905774704522       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905774704214       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 2.129586e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191991 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6102e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.078269e-01 1 1  ON 0
 uu_1                 1.417317e-01 1 1  ON 1
 uu_2                 4.087095e-02 1 1  ON 2
 uu_3                -2.053357e-02 1 1  ON 3
 uu_4                -6.438504e-02 1 1  ON 4
 uu_5                -9.730876e-02 1 1  ON 5
 uu_6                -1.228807e-01 1 1  ON 6
 uu_7                -1.344957e-01 1 1  ON 7
 uu_8                -1.263028e-01 1 1  ON 8
 uu_9                -9.638591e-02 1 1  ON 9
 ud_0                 4.395446e-01 1 1  ON 10
 ud_1                 1.758776e-01 1 1  ON 11
 ud_2                 5.972721e-02 1 1  ON 12
 ud_3                -8.537372e-03 1 1  ON 13
 ud_4                -6.522020e-02 1 1  ON 14
 ud_5                -1.055186e-01 1 1  ON 15
 ud_6                -1.316864e-01 1 1  ON 16
 ud_7                -1.471937e-01 1 1  ON 17
 ud_8                -1.486240e-01 1 1  ON 18
 ud_9                -1.396780e-01 1 1  ON 19
 eO_0                -7.470877e-01 1 1  ON 20
 eO_1                -4.315154e-01 1 1  ON 21
 eO_2                -1.815659e-02 1 1  ON 22
 eO_3                 2.953330e-01 1 1  ON 23
 eO_4                 5.135530e-01 1 1  ON 24
 eO_5                 4.701849e-01 1 1  ON 25
 eO_6                 2.407954e-01 1 1  ON 26
 eO_7                -5.353050e-02 1 1  ON 27
 eO_8                -2.059093e-01 1 1  ON 28
 eO_9                -6.545649e-02 1 1  ON 29
eH1_0                -2.314748e-01 1 1  ON 30
eH1_1                -1.337465e-01 1 1  ON 31
eH1_2                -8.940599e-02 1 1  ON 32
eH1_3                -3.616950e-02 1 1  ON 33
eH1_4                 1.141593e-02 1 1  ON 34
eH1_5                 4.422445e-02 1 1  ON 35
eH1_6                 9.863294e-02 1 1  ON 36
eH1_7                 1.437457e-01 1 1  ON 37
eH1_8                 1.557472e-01 1 1  ON 38
eH1_9                 4.166540e-02 1 1  ON 39
eH2_0                -2.289776e-01 1 1  ON 40
eH2_1                -1.316909e-01 1 1  ON 41
eH2_2                -8.703289e-02 1 1  ON 42
eH2_3                -3.382490e-02 1 1  ON 43
eH2_4                 1.375587e-02 1 1  ON 44
eH2_5                 4.824114e-02 1 1  ON 45
eH2_6                 1.028477e-01 1 1  ON 46
eH2_7                 1.498659e-01 1 1  ON 47
eH2_8                 1.612468e-01 1 1  ON 48
eH2_9                 2.372988e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9164
    reference variance = 0.252681
====================================================
  Execution time = 2.2620e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3809e-01
  Total weights = 2.0000e+06
  Execution time = 1.8682e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338088159775
                                         uncertainty =       0.003351732391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338088159775
                                         uncertainty =       0.003351732391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411154603
  error estimate for blocks of size 2^( 2) =       0.000423752438
  error estimate for blocks of size 2^( 3) =       0.000436468025
  error estimate for blocks of size 2^( 4) =       0.000448753432
  error estimate for blocks of size 2^( 5) =       0.000459568607
  error estimate for blocks of size 2^( 6) =       0.000467324364
  error estimate for blocks of size 2^( 7) =       0.000474386848

      target function =                  N/A
              le_mean =     -16.905711066678
             les_mean =     286.141162715709
             stat err =       0.000462508313
             autocorr =       1.265402746833
              std dev =       0.581460415471
             le_variance =       0.338096214760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338081779277
                                         uncertainty =       0.003351583147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338081779277
                                         uncertainty =       0.003351583147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411150731
  error estimate for blocks of size 2^( 2) =       0.000423748714
  error estimate for blocks of size 2^( 3) =       0.000436464394
  error estimate for blocks of size 2^( 4) =       0.000448749953
  error estimate for blocks of size 2^( 5) =       0.000459565138
  error estimate for blocks of size 2^( 6) =       0.000467320831
  error estimate for blocks of size 2^( 7) =       0.000474383349

      target function =                  N/A
              le_mean =     -16.905711086034
             les_mean =     286.141157002461
             stat err =       0.000462504818
             autocorr =       1.265407455027
              std dev =       0.581454939843
             le_variance =       0.338089847067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338084817990
                                         uncertainty =       0.003351654274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338084817990
                                         uncertainty =       0.003351654274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411152575
  error estimate for blocks of size 2^( 2) =       0.000423750489
  error estimate for blocks of size 2^( 3) =       0.000436466125
  error estimate for blocks of size 2^( 4) =       0.000448751612
  error estimate for blocks of size 2^( 5) =       0.000459566792
  error estimate for blocks of size 2^( 6) =       0.000467322517
  error estimate for blocks of size 2^( 7) =       0.000474385023

      target function =                  N/A
              le_mean =     -16.905711075416
             les_mean =     286.141159675878
             stat err =       0.000462506486
             autocorr =       1.265405232729
              std dev =       0.581457547443
             le_variance =       0.338092879478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338087736918
                                         uncertainty =       0.003351722512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338087736918
                                         uncertainty =       0.003351722512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411154346
  error estimate for blocks of size 2^( 2) =       0.000423752192
  error estimate for blocks of size 2^( 3) =       0.000436467784
  error estimate for blocks of size 2^( 4) =       0.000448753202
  error estimate for blocks of size 2^( 5) =       0.000459568377
  error estimate for blocks of size 2^( 6) =       0.000467324130
  error estimate for blocks of size 2^( 7) =       0.000474386617

      target function =                  N/A
              le_mean =     -16.905711067708
             les_mean =     286.141162328488
             stat err =       0.000462508082
             autocorr =       1.265403061856
              std dev =       0.581460052556
             le_variance =       0.338095792719


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905711066678        initial
     9.5367e+00     9.5367e+01             3.3581e-05       -16.905711086034  <--
     3.8147e+01     3.8147e+02             8.4931e-06       -16.905711075416
     1.5259e+02     1.5259e+03             2.1296e-06       -16.905711067708

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 3.2023e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.078312e-01 1 1  ON 0
 uu_1                 1.417415e-01 1 1  ON 1
 uu_2                 4.086954e-02 1 1  ON 2
 uu_3                -2.053703e-02 1 1  ON 3
 uu_4                -6.439003e-02 1 1  ON 4
 uu_5                -9.731288e-02 1 1  ON 5
 uu_6                -1.228883e-01 1 1  ON 6
 uu_7                -1.345008e-01 1 1  ON 7
 uu_8                -1.263062e-01 1 1  ON 8
 uu_9                -9.639153e-02 1 1  ON 9
 ud_0                 4.395389e-01 1 1  ON 10
 ud_1                 1.758786e-01 1 1  ON 11
 ud_2                 5.973422e-02 1 1  ON 12
 ud_3                -8.532317e-03 1 1  ON 13
 ud_4                -6.521437e-02 1 1  ON 14
 ud_5                -1.055272e-01 1 1  ON 15
 ud_6                -1.316837e-01 1 1  ON 16
 ud_7                -1.471935e-01 1 1  ON 17
 ud_8                -1.486219e-01 1 1  ON 18
 ud_9                -1.396800e-01 1 1  ON 19
 eO_0                -7.471128e-01 1 1  ON 20
 eO_1                -4.315153e-01 1 1  ON 21
 eO_2                -1.816147e-02 1 1  ON 22
 eO_3                 2.953325e-01 1 1  ON 23
 eO_4                 5.135635e-01 1 1  ON 24
 eO_5                 4.702022e-01 1 1  ON 25
 eO_6                 2.408140e-01 1 1  ON 26
 eO_7                -5.352316e-02 1 1  ON 27
 eO_8                -2.059202e-01 1 1  ON 28
 eO_9                -6.546706e-02 1 1  ON 29
eH1_0                -2.314835e-01 1 1  ON 30
eH1_1                -1.337504e-01 1 1  ON 31
eH1_2                -8.940489e-02 1 1  ON 32
eH1_3                -3.617543e-02 1 1  ON 33
eH1_4                 1.141511e-02 1 1  ON 34
eH1_5                 4.421742e-02 1 1  ON 35
eH1_6                 9.863357e-02 1 1  ON 36
eH1_7                 1.437530e-01 1 1  ON 37
eH1_8                 1.557583e-01 1 1  ON 38
eH1_9                 4.167374e-02 1 1  ON 39
eH2_0                -2.289941e-01 1 1  ON 40
eH2_1                -1.317012e-01 1 1  ON 41
eH2_2                -8.703990e-02 1 1  ON 42
eH2_3                -3.382722e-02 1 1  ON 43
eH2_4                 1.375034e-02 1 1  ON 44
eH2_5                 4.823845e-02 1 1  ON 45
eH2_6                 1.028467e-01 1 1  ON 46
eH2_7                 1.498749e-01 1 1  ON 47
eH2_8                 1.612640e-01 1 1  ON 48
eH2_9                 2.374706e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8134e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9559
    reference variance = 0.182982
====================================================
  Execution time = 2.3116e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3344e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333398094047
                                         uncertainty =       0.003635113432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333398094047
                                         uncertainty =       0.003635113432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408316418
  error estimate for blocks of size 2^( 2) =       0.000420947950
  error estimate for blocks of size 2^( 3) =       0.000433742029
  error estimate for blocks of size 2^( 4) =       0.000447196900
  error estimate for blocks of size 2^( 5) =       0.000458817672
  error estimate for blocks of size 2^( 6) =       0.000466611634
  error estimate for blocks of size 2^( 7) =       0.000471291569

      target function =                  N/A
              le_mean =     -16.905728645751
             les_mean =     286.137105470679
             stat err =       0.000460979444
             autocorr =       1.274586853318
              std dev =       0.577446615410
             le_variance =       0.333444593648


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690572864575e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905728645751       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905728725964       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905729242480       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905729266804       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905729514933       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905729124179       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905729320582       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905729326571       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 1.203134e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905728645751       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905728666704       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905728806474       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905728817795       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905728889624       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905728785777       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905728829260       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905728832954       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 3.018453e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905728645751       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905728651048       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905728686731       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905728689928       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905728708621       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905728682347       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905728692749       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905728693818       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 7.549577e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194609 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8616e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.078444e-01 1 1  ON 0
 uu_1                 1.417439e-01 1 1  ON 1
 uu_2                 4.087867e-02 1 1  ON 2
 uu_3                -2.054440e-02 1 1  ON 3
 uu_4                -6.439814e-02 1 1  ON 4
 uu_5                -9.731713e-02 1 1  ON 5
 uu_6                -1.228859e-01 1 1  ON 6
 uu_7                -1.345099e-01 1 1  ON 7
 uu_8                -1.263154e-01 1 1  ON 8
 uu_9                -9.640045e-02 1 1  ON 9
 ud_0                 4.395377e-01 1 1  ON 10
 ud_1                 1.758895e-01 1 1  ON 11
 ud_2                 5.973974e-02 1 1  ON 12
 ud_3                -8.524397e-03 1 1  ON 13
 ud_4                -6.520092e-02 1 1  ON 14
 ud_5                -1.055347e-01 1 1  ON 15
 ud_6                -1.316924e-01 1 1  ON 16
 ud_7                -1.472027e-01 1 1  ON 17
 ud_8                -1.486232e-01 1 1  ON 18
 ud_9                -1.396840e-01 1 1  ON 19
 eO_0                -7.471394e-01 1 1  ON 20
 eO_1                -4.315261e-01 1 1  ON 21
 eO_2                -1.816368e-02 1 1  ON 22
 eO_3                 2.953253e-01 1 1  ON 23
 eO_4                 5.135921e-01 1 1  ON 24
 eO_5                 4.702265e-01 1 1  ON 25
 eO_6                 2.408346e-01 1 1  ON 26
 eO_7                -5.351922e-02 1 1  ON 27
 eO_8                -2.059347e-01 1 1  ON 28
 eO_9                -6.548090e-02 1 1  ON 29
eH1_0                -2.315031e-01 1 1  ON 30
eH1_1                -1.337671e-01 1 1  ON 31
eH1_2                -8.941095e-02 1 1  ON 32
eH1_3                -3.618807e-02 1 1  ON 33
eH1_4                 1.141295e-02 1 1  ON 34
eH1_5                 4.422713e-02 1 1  ON 35
eH1_6                 9.864605e-02 1 1  ON 36
eH1_7                 1.437718e-01 1 1  ON 37
eH1_8                 1.557686e-01 1 1  ON 38
eH1_9                 4.168144e-02 1 1  ON 39
eH2_0                -2.290083e-01 1 1  ON 40
eH2_1                -1.317007e-01 1 1  ON 41
eH2_2                -8.704509e-02 1 1  ON 42
eH2_3                -3.383167e-02 1 1  ON 43
eH2_4                 1.373792e-02 1 1  ON 44
eH2_5                 4.821395e-02 1 1  ON 45
eH2_6                 1.028389e-01 1 1  ON 46
eH2_7                 1.498868e-01 1 1  ON 47
eH2_8                 1.612892e-01 1 1  ON 48
eH2_9                 2.377725e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.942
    reference variance = 0.339151
====================================================
  Execution time = 2.0099e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3763e-01
  Total weights = 2.0000e+06
  Execution time = 1.8614e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337700260680
                                         uncertainty =       0.004093180090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337700260680
                                         uncertainty =       0.004093180090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410875493
  error estimate for blocks of size 2^( 2) =       0.000423742505
  error estimate for blocks of size 2^( 3) =       0.000436794432
  error estimate for blocks of size 2^( 4) =       0.000449386257
  error estimate for blocks of size 2^( 5) =       0.000460435597
  error estimate for blocks of size 2^( 6) =       0.000469746661
  error estimate for blocks of size 2^( 7) =       0.000474719929

      target function =                  N/A
              le_mean =     -16.906145288102
             les_mean =     286.155385675307
             stat err =       0.000463572111
             autocorr =       1.272958145466
              std dev =       0.581065694841
             le_variance =       0.337637341721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337686028257
                                         uncertainty =       0.004092777900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337686028257
                                         uncertainty =       0.004092777900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410866838
  error estimate for blocks of size 2^( 2) =       0.000423734053
  error estimate for blocks of size 2^( 3) =       0.000436785769
  error estimate for blocks of size 2^( 4) =       0.000449376835
  error estimate for blocks of size 2^( 5) =       0.000460427121
  error estimate for blocks of size 2^( 6) =       0.000469738523
  error estimate for blocks of size 2^( 7) =       0.000474710898

      target function =                  N/A
              le_mean =     -16.906144928590
             les_mean =     286.155359293981
             stat err =       0.000463563344
             autocorr =       1.272963631700
              std dev =       0.581053453926
             le_variance =       0.337623116319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337690454440
                                         uncertainty =       0.004092934071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337690454440
                                         uncertainty =       0.004092934071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410869528
  error estimate for blocks of size 2^( 2) =       0.000423736689
  error estimate for blocks of size 2^( 3) =       0.000436788558
  error estimate for blocks of size 2^( 4) =       0.000449380032
  error estimate for blocks of size 2^( 5) =       0.000460429943
  error estimate for blocks of size 2^( 6) =       0.000469741206
  error estimate for blocks of size 2^( 7) =       0.000474713990

      target function =                  N/A
              le_mean =     -16.906145076209
             les_mean =     286.155368707307
             stat err =       0.000463566293
             autocorr =       1.272963151418
              std dev =       0.581057259050
             le_variance =       0.337627538294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337698929063
                                         uncertainty =       0.004093147643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337698929063
                                         uncertainty =       0.004093147643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410874683
  error estimate for blocks of size 2^( 2) =       0.000423741715
  error estimate for blocks of size 2^( 3) =       0.000436793637
  error estimate for blocks of size 2^( 4) =       0.000449385419
  error estimate for blocks of size 2^( 5) =       0.000460434834
  error estimate for blocks of size 2^( 6) =       0.000469745924
  error estimate for blocks of size 2^( 7) =       0.000474719131

      target function =                  N/A
              le_mean =     -16.906145260030
             les_mean =     286.155383394854
             stat err =       0.000463571327
             autocorr =       1.272958858793
              std dev =       0.581064549280
             le_variance =       0.337636010429


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906145288102        initial  <--
     2.3842e+00     2.3842e+01             1.2031e-04       -16.906144928590
     9.5367e+00     9.5367e+01             3.0185e-05       -16.906145076209
     3.8147e+01     3.8147e+02             7.5496e-06       -16.906145260030

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4759
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.078312e-01 1 1  ON 0
 uu_1                 1.417415e-01 1 1  ON 1
 uu_2                 4.086954e-02 1 1  ON 2
 uu_3                -2.053703e-02 1 1  ON 3
 uu_4                -6.439003e-02 1 1  ON 4
 uu_5                -9.731288e-02 1 1  ON 5
 uu_6                -1.228883e-01 1 1  ON 6
 uu_7                -1.345008e-01 1 1  ON 7
 uu_8                -1.263062e-01 1 1  ON 8
 uu_9                -9.639153e-02 1 1  ON 9
 ud_0                 4.395389e-01 1 1  ON 10
 ud_1                 1.758786e-01 1 1  ON 11
 ud_2                 5.973422e-02 1 1  ON 12
 ud_3                -8.532317e-03 1 1  ON 13
 ud_4                -6.521437e-02 1 1  ON 14
 ud_5                -1.055272e-01 1 1  ON 15
 ud_6                -1.316837e-01 1 1  ON 16
 ud_7                -1.471935e-01 1 1  ON 17
 ud_8                -1.486219e-01 1 1  ON 18
 ud_9                -1.396800e-01 1 1  ON 19
 eO_0                -7.471128e-01 1 1  ON 20
 eO_1                -4.315153e-01 1 1  ON 21
 eO_2                -1.816147e-02 1 1  ON 22
 eO_3                 2.953325e-01 1 1  ON 23
 eO_4                 5.135635e-01 1 1  ON 24
 eO_5                 4.702022e-01 1 1  ON 25
 eO_6                 2.408140e-01 1 1  ON 26
 eO_7                -5.352316e-02 1 1  ON 27
 eO_8                -2.059202e-01 1 1  ON 28
 eO_9                -6.546706e-02 1 1  ON 29
eH1_0                -2.314835e-01 1 1  ON 30
eH1_1                -1.337504e-01 1 1  ON 31
eH1_2                -8.940489e-02 1 1  ON 32
eH1_3                -3.617543e-02 1 1  ON 33
eH1_4                 1.141511e-02 1 1  ON 34
eH1_5                 4.421742e-02 1 1  ON 35
eH1_6                 9.863357e-02 1 1  ON 36
eH1_7                 1.437530e-01 1 1  ON 37
eH1_8                 1.557583e-01 1 1  ON 38
eH1_9                 4.167374e-02 1 1  ON 39
eH2_0                -2.289941e-01 1 1  ON 40
eH2_1                -1.317012e-01 1 1  ON 41
eH2_2                -8.703990e-02 1 1  ON 42
eH2_3                -3.382722e-02 1 1  ON 43
eH2_4                 1.375034e-02 1 1  ON 44
eH2_5                 4.823845e-02 1 1  ON 45
eH2_6                 1.028467e-01 1 1  ON 46
eH2_7                 1.498749e-01 1 1  ON 47
eH2_8                 1.612640e-01 1 1  ON 48
eH2_9                 2.374706e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8125e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8581
    reference variance = 0.387178
====================================================
  Execution time = 2.0910e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2998e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6100e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330045322851
                                         uncertainty =       0.002552834910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330045322851
                                         uncertainty =       0.002552834910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406190006
  error estimate for blocks of size 2^( 2) =       0.000419553480
  error estimate for blocks of size 2^( 3) =       0.000433363324
  error estimate for blocks of size 2^( 4) =       0.000446626905
  error estimate for blocks of size 2^( 5) =       0.000458481756
  error estimate for blocks of size 2^( 6) =       0.000468465275
  error estimate for blocks of size 2^( 7) =       0.000475250766

      target function =                  N/A
              le_mean =     -16.905636051464
             les_mean =     286.130510781062
             stat err =       0.000462206176
             autocorr =       1.294830798113
              std dev =       0.574439414992
             le_variance =       0.329980641497


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690563605146e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905636051464       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905636074352       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905636105239       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905636109722       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905636088416       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905636108819       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905636110991       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905636108981       residual = 1.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 1.072895e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905636051464       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905636057216       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905636065012       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905636066100       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905636060732       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905636065821       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905636066348       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905636065865       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.684006e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905636051464       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905636052904       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905636054857       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905636055128       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905636053783       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905636055054       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905636055184       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905636055066       residual = 1.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 6.711122e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.197213 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6527e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.078326e-01 1 1  ON 0
 uu_1                 1.417424e-01 1 1  ON 1
 uu_2                 4.086948e-02 1 1  ON 2
 uu_3                -2.053714e-02 1 1  ON 3
 uu_4                -6.439055e-02 1 1  ON 4
 uu_5                -9.731348e-02 1 1  ON 5
 uu_6                -1.228888e-01 1 1  ON 6
 uu_7                -1.345029e-01 1 1  ON 7
 uu_8                -1.263071e-01 1 1  ON 8
 uu_9                -9.639155e-02 1 1  ON 9
 ud_0                 4.395393e-01 1 1  ON 10
 ud_1                 1.758788e-01 1 1  ON 11
 ud_2                 5.973459e-02 1 1  ON 12
 ud_3                -8.532360e-03 1 1  ON 13
 ud_4                -6.521424e-02 1 1  ON 14
 ud_5                -1.055287e-01 1 1  ON 15
 ud_6                -1.316843e-01 1 1  ON 16
 ud_7                -1.471933e-01 1 1  ON 17
 ud_8                -1.486208e-01 1 1  ON 18
 ud_9                -1.396797e-01 1 1  ON 19
 eO_0                -7.471153e-01 1 1  ON 20
 eO_1                -4.315167e-01 1 1  ON 21
 eO_2                -1.816184e-02 1 1  ON 22
 eO_3                 2.953326e-01 1 1  ON 23
 eO_4                 5.135650e-01 1 1  ON 24
 eO_5                 4.702049e-01 1 1  ON 25
 eO_6                 2.408160e-01 1 1  ON 26
 eO_7                -5.352236e-02 1 1  ON 27
 eO_8                -2.059215e-01 1 1  ON 28
 eO_9                -6.546848e-02 1 1  ON 29
eH1_0                -2.314852e-01 1 1  ON 30
eH1_1                -1.337520e-01 1 1  ON 31
eH1_2                -8.940490e-02 1 1  ON 32
eH1_3                -3.617657e-02 1 1  ON 33
eH1_4                 1.141348e-02 1 1  ON 34
eH1_5                 4.421739e-02 1 1  ON 35
eH1_6                 9.863354e-02 1 1  ON 36
eH1_7                 1.437542e-01 1 1  ON 37
eH1_8                 1.557604e-01 1 1  ON 38
eH1_9                 4.167613e-02 1 1  ON 39
eH2_0                -2.289949e-01 1 1  ON 40
eH2_1                -1.317020e-01 1 1  ON 41
eH2_2                -8.704161e-02 1 1  ON 42
eH2_3                -3.382812e-02 1 1  ON 43
eH2_4                 1.374959e-02 1 1  ON 44
eH2_5                 4.823813e-02 1 1  ON 45
eH2_6                 1.028472e-01 1 1  ON 46
eH2_7                 1.498758e-01 1 1  ON 47
eH2_8                 1.612657e-01 1 1  ON 48
eH2_9                 2.374918e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9095
    reference variance = 0.429497
====================================================
  Execution time = 2.0268e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3953e-01
  Total weights = 2.0000e+06
  Execution time = 1.8671e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339554506351
                                         uncertainty =       0.003712403511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339554506351
                                         uncertainty =       0.003712403511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412025289
  error estimate for blocks of size 2^( 2) =       0.000424830230
  error estimate for blocks of size 2^( 3) =       0.000438279809
  error estimate for blocks of size 2^( 4) =       0.000450863563
  error estimate for blocks of size 2^( 5) =       0.000461390558
  error estimate for blocks of size 2^( 6) =       0.000468613299
  error estimate for blocks of size 2^( 7) =       0.000476025493

      target function =                  N/A
              le_mean =     -16.906370901904
             les_mean =     286.164906579888
             stat err =       0.000464223228
             autocorr =       1.269421910679
              std dev =       0.582691751184
             le_variance =       0.339529676898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339557290506
                                         uncertainty =       0.003712437050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339557290506
                                         uncertainty =       0.003712437050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412026978
  error estimate for blocks of size 2^( 2) =       0.000424831861
  error estimate for blocks of size 2^( 3) =       0.000438281370
  error estimate for blocks of size 2^( 4) =       0.000450865063
  error estimate for blocks of size 2^( 5) =       0.000461392026
  error estimate for blocks of size 2^( 6) =       0.000468614659
  error estimate for blocks of size 2^( 7) =       0.000476026942

      target function =                  N/A
              le_mean =     -16.906370898938
             les_mean =     286.164909264339
             stat err =       0.000464224672
             autocorr =       1.269419396951
              std dev =       0.582694140732
             le_variance =       0.339532461643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339555902048
                                         uncertainty =       0.003712420387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339555902048
                                         uncertainty =       0.003712420387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412026136
  error estimate for blocks of size 2^( 2) =       0.000424831048
  error estimate for blocks of size 2^( 3) =       0.000438280591
  error estimate for blocks of size 2^( 4) =       0.000450864315
  error estimate for blocks of size 2^( 5) =       0.000461391295
  error estimate for blocks of size 2^( 6) =       0.000468613982
  error estimate for blocks of size 2^( 7) =       0.000476026221

      target function =                  N/A
              le_mean =     -16.906370900408
             les_mean =     286.164907925278
             stat err =       0.000464223953
             autocorr =       1.269420656666
              std dev =       0.582692949064
             le_variance =       0.339531072889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339554680914
                                         uncertainty =       0.003712405624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339554680914
                                         uncertainty =       0.003712405624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412025395
  error estimate for blocks of size 2^( 2) =       0.000424830333
  error estimate for blocks of size 2^( 3) =       0.000438279907
  error estimate for blocks of size 2^( 4) =       0.000450863657
  error estimate for blocks of size 2^( 5) =       0.000461390650
  error estimate for blocks of size 2^( 6) =       0.000468613384
  error estimate for blocks of size 2^( 7) =       0.000476025584

      target function =                  N/A
              le_mean =     -16.906370901714
             les_mean =     286.164906748068
             stat err =       0.000464223319
             autocorr =       1.269421754013
              std dev =       0.582691901006
             le_variance =       0.339529851498


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906370901904        initial  <--
     2.3842e+01     2.3842e+02             1.0729e-05       -16.906370898938
     9.5367e+01     9.5367e+02             2.6840e-06       -16.906370900408
     3.8147e+02     3.8147e+03             6.7111e-07       -16.906370901714

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6786
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.078312e-01 1 1  ON 0
 uu_1                 1.417415e-01 1 1  ON 1
 uu_2                 4.086954e-02 1 1  ON 2
 uu_3                -2.053703e-02 1 1  ON 3
 uu_4                -6.439003e-02 1 1  ON 4
 uu_5                -9.731288e-02 1 1  ON 5
 uu_6                -1.228883e-01 1 1  ON 6
 uu_7                -1.345008e-01 1 1  ON 7
 uu_8                -1.263062e-01 1 1  ON 8
 uu_9                -9.639153e-02 1 1  ON 9
 ud_0                 4.395389e-01 1 1  ON 10
 ud_1                 1.758786e-01 1 1  ON 11
 ud_2                 5.973422e-02 1 1  ON 12
 ud_3                -8.532317e-03 1 1  ON 13
 ud_4                -6.521437e-02 1 1  ON 14
 ud_5                -1.055272e-01 1 1  ON 15
 ud_6                -1.316837e-01 1 1  ON 16
 ud_7                -1.471935e-01 1 1  ON 17
 ud_8                -1.486219e-01 1 1  ON 18
 ud_9                -1.396800e-01 1 1  ON 19
 eO_0                -7.471128e-01 1 1  ON 20
 eO_1                -4.315153e-01 1 1  ON 21
 eO_2                -1.816147e-02 1 1  ON 22
 eO_3                 2.953325e-01 1 1  ON 23
 eO_4                 5.135635e-01 1 1  ON 24
 eO_5                 4.702022e-01 1 1  ON 25
 eO_6                 2.408140e-01 1 1  ON 26
 eO_7                -5.352316e-02 1 1  ON 27
 eO_8                -2.059202e-01 1 1  ON 28
 eO_9                -6.546706e-02 1 1  ON 29
eH1_0                -2.314835e-01 1 1  ON 30
eH1_1                -1.337504e-01 1 1  ON 31
eH1_2                -8.940489e-02 1 1  ON 32
eH1_3                -3.617543e-02 1 1  ON 33
eH1_4                 1.141511e-02 1 1  ON 34
eH1_5                 4.421742e-02 1 1  ON 35
eH1_6                 9.863357e-02 1 1  ON 36
eH1_7                 1.437530e-01 1 1  ON 37
eH1_8                 1.557583e-01 1 1  ON 38
eH1_9                 4.167374e-02 1 1  ON 39
eH2_0                -2.289941e-01 1 1  ON 40
eH2_1                -1.317012e-01 1 1  ON 41
eH2_2                -8.703990e-02 1 1  ON 42
eH2_3                -3.382722e-02 1 1  ON 43
eH2_4                 1.375034e-02 1 1  ON 44
eH2_5                 4.823845e-02 1 1  ON 45
eH2_6                 1.028467e-01 1 1  ON 46
eH2_7                 1.498749e-01 1 1  ON 47
eH2_8                 1.612640e-01 1 1  ON 48
eH2_9                 2.374706e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6271e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9971
    reference variance = 0.267139
====================================================
  Execution time = 2.0807e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3729e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5777e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337209145925
                                         uncertainty =       0.003956791908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337209145925
                                         uncertainty =       0.003956791908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410666460
  error estimate for blocks of size 2^( 2) =       0.000423242718
  error estimate for blocks of size 2^( 3) =       0.000436664003
  error estimate for blocks of size 2^( 4) =       0.000449328675
  error estimate for blocks of size 2^( 5) =       0.000459247510
  error estimate for blocks of size 2^( 6) =       0.000468227983
  error estimate for blocks of size 2^( 7) =       0.000471872253

      target function =                  N/A
              le_mean =     -16.905531733857
             les_mean =     286.134296919052
             stat err =       0.000462169105
             autocorr =       1.266552952423
              std dev =       0.580770077799
             le_variance =       0.337293883267


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690553173386e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905531733857       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905531734945       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905531737112       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905531737038       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905531738547       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905531737569       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905531737814       residual = 8.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.132170e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905531733857       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905531734129       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905531734671       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905531734652       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905531735030       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905531734785       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905531734847       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.831462e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905531733857       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905531733925       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905531734060       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905531734055       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905531734149       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905531734088       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905531734105       residual = 8.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 7.079305e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199433 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6391e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.078313e-01 1 1  ON 0
 uu_1                 1.417415e-01 1 1  ON 1
 uu_2                 4.086955e-02 1 1  ON 2
 uu_3                -2.053704e-02 1 1  ON 3
 uu_4                -6.439015e-02 1 1  ON 4
 uu_5                -9.731295e-02 1 1  ON 5
 uu_6                -1.228884e-01 1 1  ON 6
 uu_7                -1.345008e-01 1 1  ON 7
 uu_8                -1.263062e-01 1 1  ON 8
 uu_9                -9.639157e-02 1 1  ON 9
 ud_0                 4.395390e-01 1 1  ON 10
 ud_1                 1.758787e-01 1 1  ON 11
 ud_2                 5.973427e-02 1 1  ON 12
 ud_3                -8.532321e-03 1 1  ON 13
 ud_4                -6.521432e-02 1 1  ON 14
 ud_5                -1.055273e-01 1 1  ON 15
 ud_6                -1.316839e-01 1 1  ON 16
 ud_7                -1.471936e-01 1 1  ON 17
 ud_8                -1.486218e-01 1 1  ON 18
 ud_9                -1.396800e-01 1 1  ON 19
 eO_0                -7.471131e-01 1 1  ON 20
 eO_1                -4.315153e-01 1 1  ON 21
 eO_2                -1.816152e-02 1 1  ON 22
 eO_3                 2.953324e-01 1 1  ON 23
 eO_4                 5.135636e-01 1 1  ON 24
 eO_5                 4.702025e-01 1 1  ON 25
 eO_6                 2.408142e-01 1 1  ON 26
 eO_7                -5.352310e-02 1 1  ON 27
 eO_8                -2.059203e-01 1 1  ON 28
 eO_9                -6.546717e-02 1 1  ON 29
eH1_0                -2.314837e-01 1 1  ON 30
eH1_1                -1.337504e-01 1 1  ON 31
eH1_2                -8.940497e-02 1 1  ON 32
eH1_3                -3.617559e-02 1 1  ON 33
eH1_4                 1.141502e-02 1 1  ON 34
eH1_5                 4.421741e-02 1 1  ON 35
eH1_6                 9.863360e-02 1 1  ON 36
eH1_7                 1.437531e-01 1 1  ON 37
eH1_8                 1.557584e-01 1 1  ON 38
eH1_9                 4.167391e-02 1 1  ON 39
eH2_0                -2.289943e-01 1 1  ON 40
eH2_1                -1.317014e-01 1 1  ON 41
eH2_2                -8.704011e-02 1 1  ON 42
eH2_3                -3.382734e-02 1 1  ON 43
eH2_4                 1.375035e-02 1 1  ON 44
eH2_5                 4.823855e-02 1 1  ON 45
eH2_6                 1.028466e-01 1 1  ON 46
eH2_7                 1.498750e-01 1 1  ON 47
eH2_8                 1.612642e-01 1 1  ON 48
eH2_9                 2.374728e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8743
    reference variance = 0.242525
====================================================
  Execution time = 2.0377e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3000e-01
  Total weights = 2.0000e+06
  Execution time = 1.8624e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329717468172
                                         uncertainty =       0.002578071269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329717468172
                                         uncertainty =       0.002578071269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406202522
  error estimate for blocks of size 2^( 2) =       0.000418715769
  error estimate for blocks of size 2^( 3) =       0.000431610800
  error estimate for blocks of size 2^( 4) =       0.000443620345
  error estimate for blocks of size 2^( 5) =       0.000454433622
  error estimate for blocks of size 2^( 6) =       0.000461911306
  error estimate for blocks of size 2^( 7) =       0.000466619378

      target function =                  N/A
              le_mean =     -16.905273140969
             les_mean =     286.118260783281
             stat err =       0.000456646163
             autocorr =       1.263788486679
              std dev =       0.574457115476
             le_variance =       0.330000977521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329717707554
                                         uncertainty =       0.002578074940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329717707554
                                         uncertainty =       0.002578074940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406202668
  error estimate for blocks of size 2^( 2) =       0.000418715906
  error estimate for blocks of size 2^( 3) =       0.000431610927
  error estimate for blocks of size 2^( 4) =       0.000443620463
  error estimate for blocks of size 2^( 5) =       0.000454433731
  error estimate for blocks of size 2^( 6) =       0.000461911415
  error estimate for blocks of size 2^( 7) =       0.000466619473

      target function =                  N/A
              le_mean =     -16.905273144085
             les_mean =     286.118261126776
             stat err =       0.000456646270
             autocorr =       1.263788169888
              std dev =       0.574457322741
             le_variance =       0.330001215651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329717587830
                                         uncertainty =       0.002578073105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329717587830
                                         uncertainty =       0.002578073105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406202595
  error estimate for blocks of size 2^( 2) =       0.000418715837
  error estimate for blocks of size 2^( 3) =       0.000431610864
  error estimate for blocks of size 2^( 4) =       0.000443620404
  error estimate for blocks of size 2^( 5) =       0.000454433676
  error estimate for blocks of size 2^( 6) =       0.000461911360
  error estimate for blocks of size 2^( 7) =       0.000466619425

      target function =                  N/A
              le_mean =     -16.905273142528
             les_mean =     286.118260955028
             stat err =       0.000456646217
             autocorr =       1.263788328310
              std dev =       0.574457219079
             le_variance =       0.330001096552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329717483128
                                         uncertainty =       0.002578071498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329717483128
                                         uncertainty =       0.002578071498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406202531
  error estimate for blocks of size 2^( 2) =       0.000418715777
  error estimate for blocks of size 2^( 3) =       0.000431610808
  error estimate for blocks of size 2^( 4) =       0.000443620352
  error estimate for blocks of size 2^( 5) =       0.000454433629
  error estimate for blocks of size 2^( 6) =       0.000461911312
  error estimate for blocks of size 2^( 7) =       0.000466619384

      target function =                  N/A
              le_mean =     -16.905273141164
             les_mean =     286.118260804748
             stat err =       0.000456646170
             autocorr =       1.263788466878
              std dev =       0.574457128425
             le_variance =       0.330000992399


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905273140969        initial
     2.3842e+02     2.3842e+03             1.1322e-06       -16.905273144085  <--
     9.5367e+02     9.5367e+03             2.8315e-07       -16.905273142528
     3.8147e+03     3.8147e+04             7.0793e-08       -16.905273141164

*****************************************************************************
Applying the update for shift_i =   2.3842e+02     and shift_s =   2.3842e+03
*****************************************************************************

  Execution time = 2.9773e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.078313e-01 1 1  ON 0
 uu_1                 1.417415e-01 1 1  ON 1
 uu_2                 4.086956e-02 1 1  ON 2
 uu_3                -2.053706e-02 1 1  ON 3
 uu_4                -6.439050e-02 1 1  ON 4
 uu_5                -9.731317e-02 1 1  ON 5
 uu_6                -1.228887e-01 1 1  ON 6
 uu_7                -1.345008e-01 1 1  ON 7
 uu_8                -1.263062e-01 1 1  ON 8
 uu_9                -9.639170e-02 1 1  ON 9
 ud_0                 4.395392e-01 1 1  ON 10
 ud_1                 1.758790e-01 1 1  ON 11
 ud_2                 5.973442e-02 1 1  ON 12
 ud_3                -8.532331e-03 1 1  ON 13
 ud_4                -6.521418e-02 1 1  ON 14
 ud_5                -1.055277e-01 1 1  ON 15
 ud_6                -1.316844e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486217e-01 1 1  ON 18
 ud_9                -1.396798e-01 1 1  ON 19
 eO_0                -7.471140e-01 1 1  ON 20
 eO_1                -4.315153e-01 1 1  ON 21
 eO_2                -1.816166e-02 1 1  ON 22
 eO_3                 2.953320e-01 1 1  ON 23
 eO_4                 5.135641e-01 1 1  ON 24
 eO_5                 4.702034e-01 1 1  ON 25
 eO_6                 2.408148e-01 1 1  ON 26
 eO_7                -5.352291e-02 1 1  ON 27
 eO_8                -2.059207e-01 1 1  ON 28
 eO_9                -6.546752e-02 1 1  ON 29
eH1_0                -2.314840e-01 1 1  ON 30
eH1_1                -1.337504e-01 1 1  ON 31
eH1_2                -8.940523e-02 1 1  ON 32
eH1_3                -3.617609e-02 1 1  ON 33
eH1_4                 1.141477e-02 1 1  ON 34
eH1_5                 4.421736e-02 1 1  ON 35
eH1_6                 9.863367e-02 1 1  ON 36
eH1_7                 1.437534e-01 1 1  ON 37
eH1_8                 1.557588e-01 1 1  ON 38
eH1_9                 4.167443e-02 1 1  ON 39
eH2_0                -2.289948e-01 1 1  ON 40
eH2_1                -1.317017e-01 1 1  ON 41
eH2_2                -8.704076e-02 1 1  ON 42
eH2_3                -3.382770e-02 1 1  ON 43
eH2_4                 1.375038e-02 1 1  ON 44
eH2_5                 4.823887e-02 1 1  ON 45
eH2_6                 1.028464e-01 1 1  ON 46
eH2_7                 1.498753e-01 1 1  ON 47
eH2_8                 1.612649e-01 1 1  ON 48
eH2_9                 2.374793e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6237e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8866
    reference variance = 0.247622
====================================================
  Execution time = 2.0855e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4445e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5848e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344434527008
                                         uncertainty =       0.007402321142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344434527008
                                         uncertainty =       0.007402321142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415002655
  error estimate for blocks of size 2^( 2) =       0.000427731145
  error estimate for blocks of size 2^( 3) =       0.000440624304
  error estimate for blocks of size 2^( 4) =       0.000452933603
  error estimate for blocks of size 2^( 5) =       0.000462567570
  error estimate for blocks of size 2^( 6) =       0.000470197375
  error estimate for blocks of size 2^( 7) =       0.000477210389

      target function =                  N/A
              le_mean =     -16.905041407753
             les_mean =     286.124879233577
             stat err =       0.000465727234
             autocorr =       1.259393706891
              std dev =       0.586902383681
             le_variance =       0.344454407971


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690504140775e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905041407753       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905041410551       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905041422804       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905041421914       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905041424116       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905041423009       residual = 9.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905041426485       residual = 7.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 4.350101e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905041407753       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905041408454       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905041411535       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905041411311       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905041411857       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905041411586       residual = 9.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905041412450       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.087855e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905041407753       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905041407928       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905041408700       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905041408643       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905041408780       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905041408712       residual = 9.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905041408928       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.719844e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201734 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6447e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.078315e-01 1 1  ON 0
 uu_1                 1.417414e-01 1 1  ON 1
 uu_2                 4.086982e-02 1 1  ON 2
 uu_3                -2.053719e-02 1 1  ON 3
 uu_4                -6.439053e-02 1 1  ON 4
 uu_5                -9.731340e-02 1 1  ON 5
 uu_6                -1.228887e-01 1 1  ON 6
 uu_7                -1.345014e-01 1 1  ON 7
 uu_8                -1.263064e-01 1 1  ON 8
 uu_9                -9.639175e-02 1 1  ON 9
 ud_0                 4.395395e-01 1 1  ON 10
 ud_1                 1.758792e-01 1 1  ON 11
 ud_2                 5.973470e-02 1 1  ON 12
 ud_3                -8.532212e-03 1 1  ON 13
 ud_4                -6.521417e-02 1 1  ON 14
 ud_5                -1.055282e-01 1 1  ON 15
 ud_6                -1.316848e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486215e-01 1 1  ON 18
 ud_9                -1.396796e-01 1 1  ON 19
 eO_0                -7.471150e-01 1 1  ON 20
 eO_1                -4.315158e-01 1 1  ON 21
 eO_2                -1.816199e-02 1 1  ON 22
 eO_3                 2.953322e-01 1 1  ON 23
 eO_4                 5.135652e-01 1 1  ON 24
 eO_5                 4.702042e-01 1 1  ON 25
 eO_6                 2.408155e-01 1 1  ON 26
 eO_7                -5.352261e-02 1 1  ON 27
 eO_8                -2.059213e-01 1 1  ON 28
 eO_9                -6.546805e-02 1 1  ON 29
eH1_0                -2.314844e-01 1 1  ON 30
eH1_1                -1.337509e-01 1 1  ON 31
eH1_2                -8.940561e-02 1 1  ON 32
eH1_3                -3.617657e-02 1 1  ON 33
eH1_4                 1.141416e-02 1 1  ON 34
eH1_5                 4.421733e-02 1 1  ON 35
eH1_6                 9.863363e-02 1 1  ON 36
eH1_7                 1.437543e-01 1 1  ON 37
eH1_8                 1.557598e-01 1 1  ON 38
eH1_9                 4.167502e-02 1 1  ON 39
eH2_0                -2.289951e-01 1 1  ON 40
eH2_1                -1.317022e-01 1 1  ON 41
eH2_2                -8.704096e-02 1 1  ON 42
eH2_3                -3.382842e-02 1 1  ON 43
eH2_4                 1.374989e-02 1 1  ON 44
eH2_5                 4.823888e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498755e-01 1 1  ON 47
eH2_8                 1.612657e-01 1 1  ON 48
eH2_9                 2.374893e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9205
    reference variance = 0.310473
====================================================
  Execution time = 2.0489e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3876e-01
  Total weights = 2.0000e+06
  Execution time = 1.8605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338875997865
                                         uncertainty =       0.004310928911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338875997865
                                         uncertainty =       0.004310928911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411560206
  error estimate for blocks of size 2^( 2) =       0.000424794004
  error estimate for blocks of size 2^( 3) =       0.000438567968
  error estimate for blocks of size 2^( 4) =       0.000451857024
  error estimate for blocks of size 2^( 5) =       0.000464494811
  error estimate for blocks of size 2^( 6) =       0.000473013414
  error estimate for blocks of size 2^( 7) =       0.000477643859

      target function =                  N/A
              le_mean =     -16.906006579801
             les_mean =     286.151821912926
             stat err =       0.000466752277
             autocorr =       1.286192991832
              std dev =       0.582034024807
             le_variance =       0.338763606033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338876111241
                                         uncertainty =       0.004310926846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338876111241
                                         uncertainty =       0.004310926846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411560275
  error estimate for blocks of size 2^( 2) =       0.000424794087
  error estimate for blocks of size 2^( 3) =       0.000438568055
  error estimate for blocks of size 2^( 4) =       0.000451857104
  error estimate for blocks of size 2^( 5) =       0.000464494872
  error estimate for blocks of size 2^( 6) =       0.000473013458
  error estimate for blocks of size 2^( 7) =       0.000477643917

      target function =                  N/A
              le_mean =     -16.906006584006
             les_mean =     286.151822168416
             stat err =       0.000466752338
             autocorr =       1.286192897036
              std dev =       0.582034122145
             le_variance =       0.338763719341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338876051862
                                         uncertainty =       0.004310927823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338876051862
                                         uncertainty =       0.004310927823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411560239
  error estimate for blocks of size 2^( 2) =       0.000424794044
  error estimate for blocks of size 2^( 3) =       0.000438568010
  error estimate for blocks of size 2^( 4) =       0.000451857063
  error estimate for blocks of size 2^( 5) =       0.000464494840
  error estimate for blocks of size 2^( 6) =       0.000473013435
  error estimate for blocks of size 2^( 7) =       0.000477643887

      target function =                  N/A
              le_mean =     -16.906006581924
             les_mean =     286.151822038667
             stat err =       0.000466752306
             autocorr =       1.286192948261
              std dev =       0.582034071166
             le_variance =       0.338763659998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338876004528
                                         uncertainty =       0.004310928774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338876004528
                                         uncertainty =       0.004310928774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411560210
  error estimate for blocks of size 2^( 2) =       0.000424794009
  error estimate for blocks of size 2^( 3) =       0.000438567974
  error estimate for blocks of size 2^( 4) =       0.000451857029
  error estimate for blocks of size 2^( 5) =       0.000464494815
  error estimate for blocks of size 2^( 6) =       0.000473013416
  error estimate for blocks of size 2^( 7) =       0.000477643862

      target function =                  N/A
              le_mean =     -16.906006580067
             les_mean =     286.151821928567
             stat err =       0.000466752281
             autocorr =       1.286192986505
              std dev =       0.582034030527
             le_variance =       0.338763612691


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906006579801        initial
     5.9605e+01     5.9605e+02             4.3501e-06       -16.906006584006  <--
     2.3842e+02     2.3842e+03             1.0879e-06       -16.906006581924
     9.5367e+02     9.5367e+03             2.7198e-07       -16.906006580067

*****************************************************************************
Applying the update for shift_i =   5.9605e+01     and shift_s =   5.9605e+02
*****************************************************************************

  Execution time = 2.9861e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053757e-02 1 1  ON 3
 uu_4                -6.439065e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228887e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639189e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531850e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816299e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546964e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940674e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141234e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167680e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383058e-02 1 1  ON 43
eH2_4                 1.374844e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028466e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612678e-01 1 1  ON 48
eH2_9                 2.375193e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6551e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9546
    reference variance = 0.191909
====================================================
  Execution time = 2.0687e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3695e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5383e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335396445532
                                         uncertainty =       0.003258981675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335396445532
                                         uncertainty =       0.003258981675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410454942
  error estimate for blocks of size 2^( 2) =       0.000423370415
  error estimate for blocks of size 2^( 3) =       0.000437530998
  error estimate for blocks of size 2^( 4) =       0.000450286733
  error estimate for blocks of size 2^( 5) =       0.000461714062
  error estimate for blocks of size 2^( 6) =       0.000469418960
  error estimate for blocks of size 2^( 7) =       0.000474850164

      target function =                  N/A
              le_mean =     -16.906077720936
             les_mean =     286.152410256032
             stat err =       0.000464067480
             autocorr =       1.278295600626
              std dev =       0.580470945154
             le_variance =       0.336946518168


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690607772094e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906077720936       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906077732265       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906077723512       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906077723014       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906077759170       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906077754492       residual = 9.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906077772492       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906077773549       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 2.308031e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906077720936       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906077723791       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906077721594       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906077721467       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906077730406       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906077729106       residual = 9.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906077733695       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906077733948       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 5.800412e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906077720936       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906077721651       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906077721102       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906077721070       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906077723298       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906077722964       residual = 9.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906077724117       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906077724180       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.452022e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204376 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6232e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.078328e-01 1 1  ON 0
 uu_1                 1.417429e-01 1 1  ON 1
 uu_2                 4.087072e-02 1 1  ON 2
 uu_3                -2.053797e-02 1 1  ON 3
 uu_4                -6.439107e-02 1 1  ON 4
 uu_5                -9.731478e-02 1 1  ON 5
 uu_6                -1.228910e-01 1 1  ON 6
 uu_7                -1.345060e-01 1 1  ON 7
 uu_8                -1.263071e-01 1 1  ON 8
 uu_9                -9.639206e-02 1 1  ON 9
 ud_0                 4.395407e-01 1 1  ON 10
 ud_1                 1.758799e-01 1 1  ON 11
 ud_2                 5.973709e-02 1 1  ON 12
 ud_3                -8.532425e-03 1 1  ON 13
 ud_4                -6.521292e-02 1 1  ON 14
 ud_5                -1.055318e-01 1 1  ON 15
 ud_6                -1.316870e-01 1 1  ON 16
 ud_7                -1.471941e-01 1 1  ON 17
 ud_8                -1.486204e-01 1 1  ON 18
 ud_9                -1.396787e-01 1 1  ON 19
 eO_0                -7.471240e-01 1 1  ON 20
 eO_1                -4.315190e-01 1 1  ON 21
 eO_2                -1.816269e-02 1 1  ON 22
 eO_3                 2.953331e-01 1 1  ON 23
 eO_4                 5.135728e-01 1 1  ON 24
 eO_5                 4.702116e-01 1 1  ON 25
 eO_6                 2.408194e-01 1 1  ON 26
 eO_7                -5.352120e-02 1 1  ON 27
 eO_8                -2.059251e-01 1 1  ON 28
 eO_9                -6.547178e-02 1 1  ON 29
eH1_0                -2.314854e-01 1 1  ON 30
eH1_1                -1.337560e-01 1 1  ON 31
eH1_2                -8.940808e-02 1 1  ON 32
eH1_3                -3.617952e-02 1 1  ON 33
eH1_4                 1.141211e-02 1 1  ON 34
eH1_5                 4.421582e-02 1 1  ON 35
eH1_6                 9.863368e-02 1 1  ON 36
eH1_7                 1.437593e-01 1 1  ON 37
eH1_8                 1.557654e-01 1 1  ON 38
eH1_9                 4.167944e-02 1 1  ON 39
eH2_0                -2.289994e-01 1 1  ON 40
eH2_1                -1.317053e-01 1 1  ON 41
eH2_2                -8.704278e-02 1 1  ON 42
eH2_3                -3.383376e-02 1 1  ON 43
eH2_4                 1.374754e-02 1 1  ON 44
eH2_5                 4.824123e-02 1 1  ON 45
eH2_6                 1.028478e-01 1 1  ON 46
eH2_7                 1.498759e-01 1 1  ON 47
eH2_8                 1.612709e-01 1 1  ON 48
eH2_9                 2.375573e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9607
    reference variance = 0.358308
====================================================
  Execution time = 2.0155e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4354e-01
  Total weights = 2.0000e+06
  Execution time = 1.8643e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343647232900
                                         uncertainty =       0.007355503387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343647232900
                                         uncertainty =       0.007355503387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414451218
  error estimate for blocks of size 2^( 2) =       0.000427407297
  error estimate for blocks of size 2^( 3) =       0.000440874801
  error estimate for blocks of size 2^( 4) =       0.000453132869
  error estimate for blocks of size 2^( 5) =       0.000464449765
  error estimate for blocks of size 2^( 6) =       0.000469818886
  error estimate for blocks of size 2^( 7) =       0.000472742104

      target function =                  N/A
              le_mean =     -16.905331529983
             les_mean =     286.133773591244
             stat err =       0.000465035906
             autocorr =       1.259001167378
              std dev =       0.586122533580
             le_variance =       0.343539624371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343648562294
                                         uncertainty =       0.007355480156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343648562294
                                         uncertainty =       0.007355480156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414452020
  error estimate for blocks of size 2^( 2) =       0.000427408112
  error estimate for blocks of size 2^( 3) =       0.000440875512
  error estimate for blocks of size 2^( 4) =       0.000453133425
  error estimate for blocks of size 2^( 5) =       0.000464450103
  error estimate for blocks of size 2^( 6) =       0.000469818889
  error estimate for blocks of size 2^( 7) =       0.000472742221

      target function =                  N/A
              le_mean =     -16.905331519110
             les_mean =     286.133774553342
             stat err =       0.000465036160
             autocorr =       1.258997665850
              std dev =       0.586123667925
             le_variance =       0.343540954102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343647857765
                                         uncertainty =       0.007355490353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343647857765
                                         uncertainty =       0.007355490353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414451595
  error estimate for blocks of size 2^( 2) =       0.000427407682
  error estimate for blocks of size 2^( 3) =       0.000440875135
  error estimate for blocks of size 2^( 4) =       0.000453133126
  error estimate for blocks of size 2^( 5) =       0.000464449914
  error estimate for blocks of size 2^( 6) =       0.000469818863
  error estimate for blocks of size 2^( 7) =       0.000472742141

      target function =                  N/A
              le_mean =     -16.905331523806
             les_mean =     286.133774007468
             stat err =       0.000465036011
             autocorr =       1.258999445017
              std dev =       0.586123066812
             le_variance =       0.343540249449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343647309637
                                         uncertainty =       0.007355501712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343647309637
                                         uncertainty =       0.007355501712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414451264
  error estimate for blocks of size 2^( 2) =       0.000427407344
  error estimate for blocks of size 2^( 3) =       0.000440874842
  error estimate for blocks of size 2^( 4) =       0.000453132900
  error estimate for blocks of size 2^( 5) =       0.000464449783
  error estimate for blocks of size 2^( 6) =       0.000469818883
  error estimate for blocks of size 2^( 7) =       0.000472742108

      target function =                  N/A
              le_mean =     -16.905331529176
             les_mean =     286.133773640723
             stat err =       0.000465035919
             autocorr =       1.259000953005
              std dev =       0.586122599065
             le_variance =       0.343539701135


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905331529983        initial  <--
     1.4901e+01     1.4901e+02             2.3080e-05       -16.905331519110
     5.9605e+01     5.9605e+02             5.8004e-06       -16.905331523806
     2.3842e+02     2.3842e+03             1.4520e-06       -16.905331529176

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.3381
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053757e-02 1 1  ON 3
 uu_4                -6.439065e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228887e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639189e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531850e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816299e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546964e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940674e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141234e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167680e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383058e-02 1 1  ON 43
eH2_4                 1.374844e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028466e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612678e-01 1 1  ON 48
eH2_9                 2.375193e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9668e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8667
    reference variance = 0.223289
====================================================
  Execution time = 2.0638e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3164e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3175e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331703650426
                                         uncertainty =       0.002500666320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331703650426
                                         uncertainty =       0.002500666320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407208041
  error estimate for blocks of size 2^( 2) =       0.000420470394
  error estimate for blocks of size 2^( 3) =       0.000434126669
  error estimate for blocks of size 2^( 4) =       0.000446873500
  error estimate for blocks of size 2^( 5) =       0.000460238715
  error estimate for blocks of size 2^( 6) =       0.000472283085
  error estimate for blocks of size 2^( 7) =       0.000482492451

      target function =                  N/A
              le_mean =     -16.905052478636
             les_mean =     286.112435916131
             stat err =       0.000465471938
             autocorr =       1.306635090197
              std dev =       0.575879133607
             le_variance =       0.331636776524


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690505247864e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905052478636       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905052482825       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905052483769       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905052484707       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905052485593       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905052482887       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905052484007       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905052484977       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.821816e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905052478636       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905052479684       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905052479920       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905052480155       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905052480375       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905052479699       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905052479981       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905052480225       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 4.554784e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905052478636       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905052478898       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905052478957       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905052479016       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905052479070       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905052478901       residual = 9.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905052478971       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905052479031       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.138711e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207330 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7307e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.078321e-01 1 1  ON 0
 uu_1                 1.417412e-01 1 1  ON 1
 uu_2                 4.087054e-02 1 1  ON 2
 uu_3                -2.053763e-02 1 1  ON 3
 uu_4                -6.439079e-02 1 1  ON 4
 uu_5                -9.731425e-02 1 1  ON 5
 uu_6                -1.228890e-01 1 1  ON 6
 uu_7                -1.345033e-01 1 1  ON 7
 uu_8                -1.263070e-01 1 1  ON 8
 uu_9                -9.639181e-02 1 1  ON 9
 ud_0                 4.395405e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973552e-02 1 1  ON 12
 ud_3                -8.532009e-03 1 1  ON 13
 ud_4                -6.521420e-02 1 1  ON 14
 ud_5                -1.055300e-01 1 1  ON 15
 ud_6                -1.316861e-01 1 1  ON 16
 ud_7                -1.471940e-01 1 1  ON 17
 ud_8                -1.486209e-01 1 1  ON 18
 ud_9                -1.396789e-01 1 1  ON 19
 eO_0                -7.471187e-01 1 1  ON 20
 eO_1                -4.315176e-01 1 1  ON 21
 eO_2                -1.816309e-02 1 1  ON 22
 eO_3                 2.953327e-01 1 1  ON 23
 eO_4                 5.135688e-01 1 1  ON 24
 eO_5                 4.702072e-01 1 1  ON 25
 eO_6                 2.408179e-01 1 1  ON 26
 eO_7                -5.352158e-02 1 1  ON 27
 eO_8                -2.059232e-01 1 1  ON 28
 eO_9                -6.546981e-02 1 1  ON 29
eH1_0                -2.314858e-01 1 1  ON 30
eH1_1                -1.337527e-01 1 1  ON 31
eH1_2                -8.940707e-02 1 1  ON 32
eH1_3                -3.617819e-02 1 1  ON 33
eH1_4                 1.141226e-02 1 1  ON 34
eH1_5                 4.421743e-02 1 1  ON 35
eH1_6                 9.863369e-02 1 1  ON 36
eH1_7                 1.437572e-01 1 1  ON 37
eH1_8                 1.557629e-01 1 1  ON 38
eH1_9                 4.167701e-02 1 1  ON 39
eH2_0                -2.289963e-01 1 1  ON 40
eH2_1                -1.317038e-01 1 1  ON 41
eH2_2                -8.704175e-02 1 1  ON 42
eH2_3                -3.383060e-02 1 1  ON 43
eH2_4                 1.374838e-02 1 1  ON 44
eH2_5                 4.823868e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498763e-01 1 1  ON 47
eH2_8                 1.612682e-01 1 1  ON 48
eH2_9                 2.375239e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8968
    reference variance = 0.200308
====================================================
  Execution time = 2.0230e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5526e-01
  Total weights = 2.0000e+06
  Execution time = 1.8612e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355223870101
                                         uncertainty =       0.022830646654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355223870101
                                         uncertainty =       0.022830646654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421459747
  error estimate for blocks of size 2^( 2) =       0.000434207979
  error estimate for blocks of size 2^( 3) =       0.000447703427
  error estimate for blocks of size 2^( 4) =       0.000461034246
  error estimate for blocks of size 2^( 5) =       0.000473287939
  error estimate for blocks of size 2^( 6) =       0.000482524592
  error estimate for blocks of size 2^( 7) =       0.000485804927

      target function =                  N/A
              le_mean =     -16.904663046093
             les_mean =     286.122889160560
             stat err =       0.000475662926
             autocorr =       1.273756468256
              std dev =       0.596034089828
             le_variance =       0.355256636237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355224997472
                                         uncertainty =       0.022830665059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355224997472
                                         uncertainty =       0.022830665059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421460415
  error estimate for blocks of size 2^( 2) =       0.000434208621
  error estimate for blocks of size 2^( 3) =       0.000447704023
  error estimate for blocks of size 2^( 4) =       0.000461034799
  error estimate for blocks of size 2^( 5) =       0.000473288458
  error estimate for blocks of size 2^( 6) =       0.000482525103
  error estimate for blocks of size 2^( 7) =       0.000485805397

      target function =                  N/A
              le_mean =     -16.904663045175
             les_mean =     286.122890256627
             stat err =       0.000475663439
             autocorr =       1.273755176424
              std dev =       0.596035035335
             le_variance =       0.355257763346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355224434561
                                         uncertainty =       0.022830655877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355224434561
                                         uncertainty =       0.022830655877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421460081
  error estimate for blocks of size 2^( 2) =       0.000434208301
  error estimate for blocks of size 2^( 3) =       0.000447703726
  error estimate for blocks of size 2^( 4) =       0.000461034523
  error estimate for blocks of size 2^( 5) =       0.000473288199
  error estimate for blocks of size 2^( 6) =       0.000482524848
  error estimate for blocks of size 2^( 7) =       0.000485805162

      target function =                  N/A
              le_mean =     -16.904663045631
             les_mean =     286.122889709274
             stat err =       0.000475663183
             autocorr =       1.273755821617
              std dev =       0.596034563231
             le_variance =       0.355257200566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355223940682
                                         uncertainty =       0.022830647807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355223940682
                                         uncertainty =       0.022830647807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421459789
  error estimate for blocks of size 2^( 2) =       0.000434208019
  error estimate for blocks of size 2^( 3) =       0.000447703465
  error estimate for blocks of size 2^( 4) =       0.000461034281
  error estimate for blocks of size 2^( 5) =       0.000473287972
  error estimate for blocks of size 2^( 6) =       0.000482524624
  error estimate for blocks of size 2^( 7) =       0.000485804956

      target function =                  N/A
              le_mean =     -16.904663046035
             les_mean =     286.122889229167
             stat err =       0.000475662958
             autocorr =       1.273756387396
              std dev =       0.596034149023
             le_variance =       0.355256706802


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904663046093        initial  <--
     1.4901e+02     1.4901e+03             1.8218e-06       -16.904663045175
     5.9605e+02     5.9605e+03             4.5548e-07       -16.904663045631
     2.3842e+03     2.3842e+04             1.1387e-07       -16.904663046035

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5925
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053757e-02 1 1  ON 3
 uu_4                -6.439065e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228887e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639189e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531850e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816299e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546964e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940674e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141234e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167680e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383058e-02 1 1  ON 43
eH2_4                 1.374844e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028466e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612678e-01 1 1  ON 48
eH2_9                 2.375193e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6908e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9754
    reference variance = 0.224497
====================================================
  Execution time = 2.0848e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3511e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5674e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335115401012
                                         uncertainty =       0.004832318999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335115401012
                                         uncertainty =       0.004832318999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409336546
  error estimate for blocks of size 2^( 2) =       0.000422819572
  error estimate for blocks of size 2^( 3) =       0.000436143722
  error estimate for blocks of size 2^( 4) =       0.000448574952
  error estimate for blocks of size 2^( 5) =       0.000459252727
  error estimate for blocks of size 2^( 6) =       0.000467196056
  error estimate for blocks of size 2^( 7) =       0.000472141571

      target function =                  N/A
              le_mean =     -16.905665695541
             les_mean =     286.136645258096
             stat err =       0.000461791326
             autocorr =       1.272713061637
              std dev =       0.578889295355
             le_variance =       0.335112816276


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690566569554e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905665695541       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905665695596       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905665695031       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905665695066       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905665695488       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905665695627       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905665695622       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905665695649       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.686737e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905665695541       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905665695554       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905665695413       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905665695422       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905665695526       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905665695564       residual = 8.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905665695561       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905665695571       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 4.216928e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905665695541       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905665695544       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905665695509       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905665695511       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905665695537       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905665695535       residual = 8.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905665695542       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905665695544       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.054237e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.209956 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6423e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087060e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439067e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228887e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639190e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973554e-02 1 1  ON 12
 ud_3                -8.531849e-03 1 1  ON 13
 ud_4                -6.521413e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471939e-01 1 1  ON 17
 ud_8                -1.486212e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471183e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816302e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352169e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546967e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337525e-01 1 1  ON 31
eH1_2                -8.940678e-02 1 1  ON 32
eH1_3                -3.617801e-02 1 1  ON 33
eH1_4                 1.141232e-02 1 1  ON 34
eH1_5                 4.421723e-02 1 1  ON 35
eH1_6                 9.863351e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167683e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383061e-02 1 1  ON 43
eH2_4                 1.374844e-02 1 1  ON 44
eH2_5                 4.823889e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498762e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375197e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9625
    reference variance = 0.291802
====================================================
  Execution time = 2.0067e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3607e-01
  Total weights = 2.0000e+06
  Execution time = 1.8555e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336192687033
                                         uncertainty =       0.002860887283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336192687033
                                         uncertainty =       0.002860887283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409921471
  error estimate for blocks of size 2^( 2) =       0.000422421683
  error estimate for blocks of size 2^( 3) =       0.000435942427
  error estimate for blocks of size 2^( 4) =       0.000449022499
  error estimate for blocks of size 2^( 5) =       0.000460945357
  error estimate for blocks of size 2^( 6) =       0.000468936805
  error estimate for blocks of size 2^( 7) =       0.000474845072

      target function =                  N/A
              le_mean =     -16.905757288083
             les_mean =     286.140700539778
             stat err =       0.000463437433
             autocorr =       1.278147244578
              std dev =       0.579716503333
             le_variance =       0.336071224236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336192704092
                                         uncertainty =       0.002860887284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336192704092
                                         uncertainty =       0.002860887284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409921481
  error estimate for blocks of size 2^( 2) =       0.000422421693
  error estimate for blocks of size 2^( 3) =       0.000435942436
  error estimate for blocks of size 2^( 4) =       0.000449022506
  error estimate for blocks of size 2^( 5) =       0.000460945363
  error estimate for blocks of size 2^( 6) =       0.000468936811
  error estimate for blocks of size 2^( 7) =       0.000474845079

      target function =                  N/A
              le_mean =     -16.905757287497
             les_mean =     286.140700537003
             stat err =       0.000463437440
             autocorr =       1.278147215675
              std dev =       0.579716518044
             le_variance =       0.336071241293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336192695560
                                         uncertainty =       0.002860887284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336192695560
                                         uncertainty =       0.002860887284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409921476
  error estimate for blocks of size 2^( 2) =       0.000422421688
  error estimate for blocks of size 2^( 3) =       0.000435942431
  error estimate for blocks of size 2^( 4) =       0.000449022502
  error estimate for blocks of size 2^( 5) =       0.000460945360
  error estimate for blocks of size 2^( 6) =       0.000468936808
  error estimate for blocks of size 2^( 7) =       0.000474845076

      target function =                  N/A
              le_mean =     -16.905757287790
             les_mean =     286.140700538386
             stat err =       0.000463437437
             autocorr =       1.278147230129
              std dev =       0.579716510686
             le_variance =       0.336071232762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336192688098
                                         uncertainty =       0.002860887283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336192688098
                                         uncertainty =       0.002860887283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409921471
  error estimate for blocks of size 2^( 2) =       0.000422421683
  error estimate for blocks of size 2^( 3) =       0.000435942427
  error estimate for blocks of size 2^( 4) =       0.000449022499
  error estimate for blocks of size 2^( 5) =       0.000460945357
  error estimate for blocks of size 2^( 6) =       0.000468936806
  error estimate for blocks of size 2^( 7) =       0.000474845073

      target function =                  N/A
              le_mean =     -16.905757288046
             les_mean =     286.140700539604
             stat err =       0.000463437434
             autocorr =       1.278147242764
              std dev =       0.579716504252
             le_variance =       0.336071225302


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905757288083        initial  <--
     1.4901e+03     1.4901e+04             1.6867e-07       -16.905757287497
     5.9605e+03     5.9605e+04             4.2169e-08       -16.905757287790
     2.3842e+04     2.3842e+05             1.0542e-08       -16.905757288046

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4377
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053757e-02 1 1  ON 3
 uu_4                -6.439065e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228887e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639189e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531850e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816299e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546964e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940674e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141234e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167680e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383058e-02 1 1  ON 43
eH2_4                 1.374844e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028466e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612678e-01 1 1  ON 48
eH2_9                 2.375193e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5867e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9233
    reference variance = 0.291429
====================================================
  Execution time = 2.0472e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4435e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5076e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344413519077
                                         uncertainty =       0.006518950205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344413519077
                                         uncertainty =       0.006518950205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414941068
  error estimate for blocks of size 2^( 2) =       0.000427708813
  error estimate for blocks of size 2^( 3) =       0.000440388179
  error estimate for blocks of size 2^( 4) =       0.000453291904
  error estimate for blocks of size 2^( 5) =       0.000464972490
  error estimate for blocks of size 2^( 6) =       0.000472650424
  error estimate for blocks of size 2^( 7) =       0.000479541161

      target function =                  N/A
              le_mean =     -16.904997851543
             les_mean =     286.123304368721
             stat err =       0.000467613995
             autocorr =       1.269995432538
              std dev =       0.586815286297
             le_variance =       0.344352180232


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690499785154e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904997851543       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904997851582       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904997851561       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904997851599       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904997851614       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904997851603       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904997851603       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904997851612       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.479472e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904997851543       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904997851553       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904997851547       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904997851557       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904997851558       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904997851560       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904997851537       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904997851648       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.698685e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904997851543       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904997851545       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904997851544       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904997851546       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904997851536       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904997851601       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904997851526       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904997851609       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 9.246715e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.212531 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6004e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053757e-02 1 1  ON 3
 uu_4                -6.439065e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228887e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639190e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531849e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816299e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940674e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141233e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167681e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383058e-02 1 1  ON 43
eH2_4                 1.374843e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028466e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375194e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9243
    reference variance = 0.372411
====================================================
  Execution time = 2.0217e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4313e-01
  Total weights = 2.0000e+06
  Execution time = 1.8672e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343057969001
                                         uncertainty =       0.005218558865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343057969001
                                         uncertainty =       0.005218558865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414205588
  error estimate for blocks of size 2^( 2) =       0.000427128512
  error estimate for blocks of size 2^( 3) =       0.000440682564
  error estimate for blocks of size 2^( 4) =       0.000452632691
  error estimate for blocks of size 2^( 5) =       0.000462329116
  error estimate for blocks of size 2^( 6) =       0.000471514029
  error estimate for blocks of size 2^( 7) =       0.000475086842

      target function =                  N/A
              le_mean =     -16.905720059614
             les_mean =     286.146503100871
             stat err =       0.000465390669
             autocorr =       1.262418749268
              std dev =       0.585775160268
             le_variance =       0.343132538387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343057978313
                                         uncertainty =       0.005218558967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343057978313
                                         uncertainty =       0.005218558967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414205594
  error estimate for blocks of size 2^( 2) =       0.000427128517
  error estimate for blocks of size 2^( 3) =       0.000440682569
  error estimate for blocks of size 2^( 4) =       0.000452632695
  error estimate for blocks of size 2^( 5) =       0.000462329120
  error estimate for blocks of size 2^( 6) =       0.000471514033
  error estimate for blocks of size 2^( 7) =       0.000475086846

      target function =                  N/A
              le_mean =     -16.905720059576
             les_mean =     286.146503108871
             stat err =       0.000465390674
             autocorr =       1.262418738814
              std dev =       0.585775168218
             le_variance =       0.343132547701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343057973657
                                         uncertainty =       0.005218558916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343057973657
                                         uncertainty =       0.005218558916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414205591
  error estimate for blocks of size 2^( 2) =       0.000427128514
  error estimate for blocks of size 2^( 3) =       0.000440682566
  error estimate for blocks of size 2^( 4) =       0.000452632693
  error estimate for blocks of size 2^( 5) =       0.000462329118
  error estimate for blocks of size 2^( 6) =       0.000471514031
  error estimate for blocks of size 2^( 7) =       0.000475086844

      target function =                  N/A
              le_mean =     -16.905720059595
             les_mean =     286.146503104871
             stat err =       0.000465390671
             autocorr =       1.262418744046
              std dev =       0.585775164243
             le_variance =       0.343132543044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343057969583
                                         uncertainty =       0.005218558871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343057969583
                                         uncertainty =       0.005218558871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414205588
  error estimate for blocks of size 2^( 2) =       0.000427128512
  error estimate for blocks of size 2^( 3) =       0.000440682564
  error estimate for blocks of size 2^( 4) =       0.000452632691
  error estimate for blocks of size 2^( 5) =       0.000462329116
  error estimate for blocks of size 2^( 6) =       0.000471514029
  error estimate for blocks of size 2^( 7) =       0.000475086842

      target function =                  N/A
              le_mean =     -16.905720059612
             les_mean =     286.146503101371
             stat err =       0.000465390669
             autocorr =       1.262418748607
              std dev =       0.585775160765
             le_variance =       0.343132538969


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905720059614        initial  <--
     1.4901e+04     1.4901e+05             1.4795e-08       -16.905720059576
     5.9605e+04     5.9605e+05             3.6987e-09       -16.905720059595
     2.3842e+05     2.3842e+06             9.2467e-10       -16.905720059612

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5972
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053757e-02 1 1  ON 3
 uu_4                -6.439065e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228887e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639189e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531850e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816299e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546964e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940674e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141234e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167680e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383058e-02 1 1  ON 43
eH2_4                 1.374844e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028466e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612678e-01 1 1  ON 48
eH2_9                 2.375193e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5649e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8972
    reference variance = 0.261878
====================================================
  Execution time = 2.0708e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.9305e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5201e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393197686070
                                         uncertainty =       0.060794641813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393197686070
                                         uncertainty =       0.060794641813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000443309819
  error estimate for blocks of size 2^( 2) =       0.000454939396
  error estimate for blocks of size 2^( 3) =       0.000466541191
  error estimate for blocks of size 2^( 4) =       0.000478213950
  error estimate for blocks of size 2^( 5) =       0.000488800298
  error estimate for blocks of size 2^( 6) =       0.000493584285
  error estimate for blocks of size 2^( 7) =       0.000495271898

      target function =                  N/A
              le_mean =     -16.905305353076
             les_mean =     286.182396075616
             stat err =       0.000488967608
             autocorr =       1.216593461247
              std dev =       0.626934758481
             le_variance =       0.393047191391


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690530535308e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905305353076       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905305353082       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905305353080       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905305353080       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905305353130       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905305352998       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905305353175       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905305353083       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.900807e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905305353076       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905305353078       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905305353077       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905305353077       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905305353193       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905305353028       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905305353081       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905305353058       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 4.752020e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905305353076       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905305353077       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905305353076       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905305353076       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905305353283       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905305353122       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905305351727       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905305352158       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 1.188006e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.215120 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6235e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053757e-02 1 1  ON 3
 uu_4                -6.439065e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228887e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639190e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531850e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816299e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546964e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940674e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141234e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167680e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383058e-02 1 1  ON 43
eH2_4                 1.374844e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028466e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612678e-01 1 1  ON 48
eH2_9                 2.375193e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9213
    reference variance = 0.218494
====================================================
  Execution time = 1.9948e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3783e-01
  Total weights = 2.0000e+06
  Execution time = 1.8669e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337869002898
                                         uncertainty =       0.004416542355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337869002898
                                         uncertainty =       0.004416542355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410993815
  error estimate for blocks of size 2^( 2) =       0.000423813887
  error estimate for blocks of size 2^( 3) =       0.000437014987
  error estimate for blocks of size 2^( 4) =       0.000448964304
  error estimate for blocks of size 2^( 5) =       0.000459504859
  error estimate for blocks of size 2^( 6) =       0.000466149796
  error estimate for blocks of size 2^( 7) =       0.000471307914

      target function =                  N/A
              le_mean =     -16.904734437387
             les_mean =     286.107878061235
             stat err =       0.000461481718
             autocorr =       1.260777441847
              std dev =       0.581233026921
             le_variance =       0.337831831584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337869003264
                                         uncertainty =       0.004416542358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337869003264
                                         uncertainty =       0.004416542358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410993815
  error estimate for blocks of size 2^( 2) =       0.000423813887
  error estimate for blocks of size 2^( 3) =       0.000437014987
  error estimate for blocks of size 2^( 4) =       0.000448964304
  error estimate for blocks of size 2^( 5) =       0.000459504859
  error estimate for blocks of size 2^( 6) =       0.000466149796
  error estimate for blocks of size 2^( 7) =       0.000471307914

      target function =                  N/A
              le_mean =     -16.904734437390
             les_mean =     286.107878061713
             stat err =       0.000461481718
             autocorr =       1.260777441467
              std dev =       0.581233027236
             le_variance =       0.337831831950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337869003081
                                         uncertainty =       0.004416542356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337869003081
                                         uncertainty =       0.004416542356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410993815
  error estimate for blocks of size 2^( 2) =       0.000423813887
  error estimate for blocks of size 2^( 3) =       0.000437014987
  error estimate for blocks of size 2^( 4) =       0.000448964304
  error estimate for blocks of size 2^( 5) =       0.000459504859
  error estimate for blocks of size 2^( 6) =       0.000466149796
  error estimate for blocks of size 2^( 7) =       0.000471307914

      target function =                  N/A
              le_mean =     -16.904734437388
             les_mean =     286.107878061474
             stat err =       0.000461481718
             autocorr =       1.260777441659
              std dev =       0.581233027079
             le_variance =       0.337831831767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337869002921
                                         uncertainty =       0.004416542355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337869002921
                                         uncertainty =       0.004416542355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410993815
  error estimate for blocks of size 2^( 2) =       0.000423813887
  error estimate for blocks of size 2^( 3) =       0.000437014987
  error estimate for blocks of size 2^( 4) =       0.000448964304
  error estimate for blocks of size 2^( 5) =       0.000459504859
  error estimate for blocks of size 2^( 6) =       0.000466149796
  error estimate for blocks of size 2^( 7) =       0.000471307914

      target function =                  N/A
              le_mean =     -16.904734437387
             les_mean =     286.107878061265
             stat err =       0.000461481718
             autocorr =       1.260777441823
              std dev =       0.581233026941
             le_variance =       0.337831831607


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904734437387        initial
     1.4901e+05     1.4901e+06             1.9008e-09       -16.904734437390  <--
     5.9605e+05     5.9605e+06             4.7520e-10       -16.904734437388
     2.3842e+06     2.3842e+07             1.1880e-10       -16.904734437387

*****************************************************************************
Applying the update for shift_i =   1.4901e+05     and shift_s =   1.4901e+06
*****************************************************************************

  Execution time = 2.9342e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087060e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439065e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228887e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639190e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531850e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816299e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546964e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940674e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141234e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167680e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383058e-02 1 1  ON 43
eH2_4                 1.374844e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028466e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375194e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5680e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8855
    reference variance = 0.291999
====================================================
  Execution time = 2.0778e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3723e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5362e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337156537530
                                         uncertainty =       0.003926812830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337156537530
                                         uncertainty =       0.003926812830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410627252
  error estimate for blocks of size 2^( 2) =       0.000423452799
  error estimate for blocks of size 2^( 3) =       0.000436863358
  error estimate for blocks of size 2^( 4) =       0.000449351911
  error estimate for blocks of size 2^( 5) =       0.000460401597
  error estimate for blocks of size 2^( 6) =       0.000467435702
  error estimate for blocks of size 2^( 7) =       0.000472538036

      target function =                  N/A
              le_mean =     -16.905549345915
             les_mean =     286.134827998252
             stat err =       0.000462431812
             autocorr =       1.268235390103
              std dev =       0.580714628452
             le_variance =       0.337229479698


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690554934592e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905549345915       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905549345925       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905549345919       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905549345929       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905549345934       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905549345956       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905549345946       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905549345958       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 8.987880e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905549345915       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905549345918       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905549345916       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905549345810       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905549345915       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905549345943       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905549345936       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905549345830       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 2.246974e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905549345915       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905549345916       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905549345915       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905549346185       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905549345915       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905549346113       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905549345895       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905549346223       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 5.617437e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.217784 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6322e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087060e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439065e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228887e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639190e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531850e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816299e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940674e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141234e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167681e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383058e-02 1 1  ON 43
eH2_4                 1.374844e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028466e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375194e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8974
    reference variance = 0.896334
====================================================
  Execution time = 2.0274e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3303e-01
  Total weights = 2.0000e+06
  Execution time = 1.8645e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332985794471
                                         uncertainty =       0.003286211591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332985794471
                                         uncertainty =       0.003286211591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408060848
  error estimate for blocks of size 2^( 2) =       0.000420805645
  error estimate for blocks of size 2^( 3) =       0.000434588255
  error estimate for blocks of size 2^( 4) =       0.000447021366
  error estimate for blocks of size 2^( 5) =       0.000458944872
  error estimate for blocks of size 2^( 6) =       0.000465575033
  error estimate for blocks of size 2^( 7) =       0.000470108813

      target function =                  N/A
              le_mean =     -16.905315241292
             les_mean =     286.122710552854
             stat err =       0.000460412521
             autocorr =       1.273046875647
              std dev =       0.577085186009
             le_variance =       0.333027311912

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332985798185
                                         uncertainty =       0.003286211600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332985798185
                                         uncertainty =       0.003286211600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408060851
  error estimate for blocks of size 2^( 2) =       0.000420805647
  error estimate for blocks of size 2^( 3) =       0.000434588257
  error estimate for blocks of size 2^( 4) =       0.000447021368
  error estimate for blocks of size 2^( 5) =       0.000458944874
  error estimate for blocks of size 2^( 6) =       0.000465575035
  error estimate for blocks of size 2^( 7) =       0.000470108814

      target function =                  N/A
              le_mean =     -16.905315241322
             les_mean =     286.122710557591
             stat err =       0.000460412523
             autocorr =       1.273046870765
              std dev =       0.577085189229
             le_variance =       0.333027315628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332985796328
                                         uncertainty =       0.003286211596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332985796328
                                         uncertainty =       0.003286211596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408060849
  error estimate for blocks of size 2^( 2) =       0.000420805646
  error estimate for blocks of size 2^( 3) =       0.000434588256
  error estimate for blocks of size 2^( 4) =       0.000447021367
  error estimate for blocks of size 2^( 5) =       0.000458944873
  error estimate for blocks of size 2^( 6) =       0.000465575034
  error estimate for blocks of size 2^( 7) =       0.000470108814

      target function =                  N/A
              le_mean =     -16.905315241307
             les_mean =     286.122710555223
             stat err =       0.000460412522
             autocorr =       1.273046873213
              std dev =       0.577085187619
             le_variance =       0.333027313770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332985794703
                                         uncertainty =       0.003286211592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332985794703
                                         uncertainty =       0.003286211592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408060848
  error estimate for blocks of size 2^( 2) =       0.000420805645
  error estimate for blocks of size 2^( 3) =       0.000434588256
  error estimate for blocks of size 2^( 4) =       0.000447021366
  error estimate for blocks of size 2^( 5) =       0.000458944872
  error estimate for blocks of size 2^( 6) =       0.000465575033
  error estimate for blocks of size 2^( 7) =       0.000470108813

      target function =                  N/A
              le_mean =     -16.905315241294
             les_mean =     286.122710553150
             stat err =       0.000460412521
             autocorr =       1.273046875350
              std dev =       0.577085186211
             le_variance =       0.333027312144


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905315241292        initial
     3.7253e+04     3.7253e+05             8.9879e-09       -16.905315241322  <--
     1.4901e+05     1.4901e+06             2.2470e-09       -16.905315241307
     5.9605e+05     5.9605e+06             5.6174e-10       -16.905315241294

*****************************************************************************
Applying the update for shift_i =   3.7253e+04     and shift_s =   3.7253e+05
*****************************************************************************

  Execution time = 2.9662e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439065e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228887e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639189e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531851e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816299e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940675e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141234e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167681e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383059e-02 1 1  ON 43
eH2_4                 1.374844e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375194e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5990e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9919
    reference variance = 0.288482
====================================================
  Execution time = 2.3013e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4293e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6069e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342968854673
                                         uncertainty =       0.006228886697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342968854673
                                         uncertainty =       0.006228886697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414082796
  error estimate for blocks of size 2^( 2) =       0.000426833301
  error estimate for blocks of size 2^( 3) =       0.000439463131
  error estimate for blocks of size 2^( 4) =       0.000451827712
  error estimate for blocks of size 2^( 5) =       0.000462183824
  error estimate for blocks of size 2^( 6) =       0.000470371335
  error estimate for blocks of size 2^( 7) =       0.000476257686

      target function =                  N/A
              le_mean =     -16.905992375820
             les_mean =     286.155507164057
             stat err =       0.000465160139
             autocorr =       1.261916471462
              std dev =       0.585601506340
             le_variance =       0.342929124228


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690599237582e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905992375820       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905992375856       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905992375812       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905992375813       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905992375897       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905992375887       residual = 7.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905992375895       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905992375908       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 3.221145e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905992375820       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905992375829       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905992375818       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905992375806       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905992375864       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905992375843       residual = 7.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905992375807       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905992375801       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 8.052877e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905992375820       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905992375822       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905992375820       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905992375847       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905992375725       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905992375832       residual = 7.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905992375772       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905992375751       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 2.013220e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.220425 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8636e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439065e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228887e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639190e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531849e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816300e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940675e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141233e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167681e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704156e-02 1 1  ON 42
eH2_3                -3.383059e-02 1 1  ON 43
eH2_4                 1.374844e-02 1 1  ON 44
eH2_5                 4.823889e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498762e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375195e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9943
    reference variance = 0.658607
====================================================
  Execution time = 2.2148e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3580e-01
  Total weights = 2.0000e+06
  Execution time = 1.8536e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335733592766
                                         uncertainty =       0.003241231768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335733592766
                                         uncertainty =       0.003241231768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409755031
  error estimate for blocks of size 2^( 2) =       0.000422221464
  error estimate for blocks of size 2^( 3) =       0.000435131682
  error estimate for blocks of size 2^( 4) =       0.000446540596
  error estimate for blocks of size 2^( 5) =       0.000457266056
  error estimate for blocks of size 2^( 6) =       0.000464982439
  error estimate for blocks of size 2^( 7) =       0.000470574832

      target function =                  N/A
              le_mean =     -16.906139852815
             les_mean =     286.153362925584
             stat err =       0.000459840981
             autocorr =       1.259408896943
              std dev =       0.579481121831
             le_variance =       0.335798370559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335733602494
                                         uncertainty =       0.003241231895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335733602494
                                         uncertainty =       0.003241231895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409755037
  error estimate for blocks of size 2^( 2) =       0.000422221470
  error estimate for blocks of size 2^( 3) =       0.000435131687
  error estimate for blocks of size 2^( 4) =       0.000446540601
  error estimate for blocks of size 2^( 5) =       0.000457266061
  error estimate for blocks of size 2^( 6) =       0.000464982443
  error estimate for blocks of size 2^( 7) =       0.000470574837

      target function =                  N/A
              le_mean =     -16.906139852680
             les_mean =     286.153362930749
             stat err =       0.000459840986
             autocorr =       1.259408886000
              std dev =       0.579481130223
             le_variance =       0.335798380285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335733597630
                                         uncertainty =       0.003241231832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335733597630
                                         uncertainty =       0.003241231832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409755034
  error estimate for blocks of size 2^( 2) =       0.000422221467
  error estimate for blocks of size 2^( 3) =       0.000435131685
  error estimate for blocks of size 2^( 4) =       0.000446540599
  error estimate for blocks of size 2^( 5) =       0.000457266059
  error estimate for blocks of size 2^( 6) =       0.000464982441
  error estimate for blocks of size 2^( 7) =       0.000470574834

      target function =                  N/A
              le_mean =     -16.906139852747
             les_mean =     286.153362928167
             stat err =       0.000459840983
             autocorr =       1.259408891473
              std dev =       0.579481126027
             le_variance =       0.335798375422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335733593374
                                         uncertainty =       0.003241231776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335733593374
                                         uncertainty =       0.003241231776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409755031
  error estimate for blocks of size 2^( 2) =       0.000422221464
  error estimate for blocks of size 2^( 3) =       0.000435131682
  error estimate for blocks of size 2^( 4) =       0.000446540597
  error estimate for blocks of size 2^( 5) =       0.000457266057
  error estimate for blocks of size 2^( 6) =       0.000464982439
  error estimate for blocks of size 2^( 7) =       0.000470574832

      target function =                  N/A
              le_mean =     -16.906139852806
             les_mean =     286.153362925907
             stat err =       0.000459840981
             autocorr =       1.259408896258
              std dev =       0.579481122356
             le_variance =       0.335798371167


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906139852815        initial  <--
     9.3132e+03     9.3132e+04             3.2211e-08       -16.906139852680
     3.7253e+04     3.7253e+05             8.0529e-09       -16.906139852747
     1.4901e+05     1.4901e+06             2.0132e-09       -16.906139852806

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.5023
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439065e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228887e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639189e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531851e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816299e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940675e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141234e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167681e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383059e-02 1 1  ON 43
eH2_4                 1.374844e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375194e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0153e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9157
    reference variance = 0.247171
====================================================
  Execution time = 2.0463e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5618e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356274179624
                                         uncertainty =       0.011301908456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356274179624
                                         uncertainty =       0.011301908456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422008518
  error estimate for blocks of size 2^( 2) =       0.000434289377
  error estimate for blocks of size 2^( 3) =       0.000446749607
  error estimate for blocks of size 2^( 4) =       0.000458413886
  error estimate for blocks of size 2^( 5) =       0.000469224239
  error estimate for blocks of size 2^( 6) =       0.000477585426
  error estimate for blocks of size 2^( 7) =       0.000482241337

      target function =                  N/A
              le_mean =     -16.905798178096
             les_mean =     286.162194239364
             stat err =       0.000471866222
             autocorr =       1.250245630551
              std dev =       0.596810169927
             le_variance =       0.356182378928


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690579817810e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905798178096       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905798178100       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905798178097       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905798178139       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905798178101       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905798178109       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905798178202       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 3.011398e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905798178096       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905798178097       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905798178096       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905798178095       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905798178175       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905798177625       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905798178117       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 7.528495e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905798178096       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905798178097       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905798178096       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905798178012       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905798178481       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905798178056       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905798179252       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.882119e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.222616 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6088e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439065e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228887e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639189e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531851e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816299e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940675e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141234e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167681e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383059e-02 1 1  ON 43
eH2_4                 1.374844e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375194e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9287
    reference variance = 0.304098
====================================================
  Execution time = 2.0091e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3879e-01
  Total weights = 2.0000e+06
  Execution time = 1.8633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338895761001
                                         uncertainty =       0.002869127940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338895761001
                                         uncertainty =       0.002869127940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411575478
  error estimate for blocks of size 2^( 2) =       0.000424700344
  error estimate for blocks of size 2^( 3) =       0.000438192441
  error estimate for blocks of size 2^( 4) =       0.000451401319
  error estimate for blocks of size 2^( 5) =       0.000463046081
  error estimate for blocks of size 2^( 6) =       0.000472322700
  error estimate for blocks of size 2^( 7) =       0.000477374731

      target function =                  N/A
              le_mean =     -16.905309549399
             les_mean =     286.128279540543
             stat err =       0.000466036208
             autocorr =       1.282154425211
              std dev =       0.582055623587
             le_variance =       0.338788748949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338895761074
                                         uncertainty =       0.002869127936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338895761074
                                         uncertainty =       0.002869127936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411575479
  error estimate for blocks of size 2^( 2) =       0.000424700344
  error estimate for blocks of size 2^( 3) =       0.000438192441
  error estimate for blocks of size 2^( 4) =       0.000451401319
  error estimate for blocks of size 2^( 5) =       0.000463046081
  error estimate for blocks of size 2^( 6) =       0.000472322700
  error estimate for blocks of size 2^( 7) =       0.000477374731

      target function =                  N/A
              le_mean =     -16.905309549416
             les_mean =     286.128279541199
             stat err =       0.000466036208
             autocorr =       1.282154425439
              std dev =       0.582055623649
             le_variance =       0.338788749022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338895761037
                                         uncertainty =       0.002869127938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338895761037
                                         uncertainty =       0.002869127938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411575478
  error estimate for blocks of size 2^( 2) =       0.000424700344
  error estimate for blocks of size 2^( 3) =       0.000438192441
  error estimate for blocks of size 2^( 4) =       0.000451401319
  error estimate for blocks of size 2^( 5) =       0.000463046081
  error estimate for blocks of size 2^( 6) =       0.000472322700
  error estimate for blocks of size 2^( 7) =       0.000477374731

      target function =                  N/A
              le_mean =     -16.905309549407
             les_mean =     286.128279540871
             stat err =       0.000466036208
             autocorr =       1.282154425319
              std dev =       0.582055623618
             le_variance =       0.338788748986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338895761005
                                         uncertainty =       0.002869127940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338895761005
                                         uncertainty =       0.002869127940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411575478
  error estimate for blocks of size 2^( 2) =       0.000424700344
  error estimate for blocks of size 2^( 3) =       0.000438192441
  error estimate for blocks of size 2^( 4) =       0.000451401319
  error estimate for blocks of size 2^( 5) =       0.000463046081
  error estimate for blocks of size 2^( 6) =       0.000472322700
  error estimate for blocks of size 2^( 7) =       0.000477374731

      target function =                  N/A
              le_mean =     -16.905309549400
             les_mean =     286.128279540584
             stat err =       0.000466036208
             autocorr =       1.282154425228
              std dev =       0.582055623591
             le_variance =       0.338788748954


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905309549399        initial
     9.3132e+04     9.3132e+05             3.0114e-09       -16.905309549416  <--
     3.7253e+05     3.7253e+06             7.5285e-10       -16.905309549407
     1.4901e+06     1.4901e+07             1.8821e-10       -16.905309549400

*****************************************************************************
Applying the update for shift_i =   9.3132e+04     and shift_s =   9.3132e+05
*****************************************************************************

  Execution time = 2.9507e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439065e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228887e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639189e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531852e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816299e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940675e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141233e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167681e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383059e-02 1 1  ON 43
eH2_4                 1.374844e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375195e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5602e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9054
    reference variance = 0.397145
====================================================
  Execution time = 2.0997e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3144e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4874e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331301275198
                                         uncertainty =       0.003591597349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331301275198
                                         uncertainty =       0.003591597349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407089130
  error estimate for blocks of size 2^( 2) =       0.000419622529
  error estimate for blocks of size 2^( 3) =       0.000432845493
  error estimate for blocks of size 2^( 4) =       0.000445472775
  error estimate for blocks of size 2^( 5) =       0.000456076073
  error estimate for blocks of size 2^( 6) =       0.000463709803
  error estimate for blocks of size 2^( 7) =       0.000469584980

      target function =                  N/A
              le_mean =     -16.905158932304
             les_mean =     286.115841480556
             stat err =       0.000458710908
             autocorr =       1.269694161718
              std dev =       0.575710968989
             le_variance =       0.331443119814


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690515893230e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905158932304       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905158932293       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905158932294       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905158932295       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905158932267       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905158932262       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905158932283       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905158932285       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 1.330615e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905158932304       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905158932301       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905158932302       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905158932339       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905158932213       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905158932287       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905158932262       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905158932290       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 3.326546e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905158932304       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905158932303       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905158932304       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905158932546       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905158932397       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905158932247       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905158932469       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905158933261       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 8.316364e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.225232 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6492e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439065e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228887e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639190e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531852e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816299e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940675e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141233e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167681e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383059e-02 1 1  ON 43
eH2_4                 1.374844e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375195e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8497
    reference variance = 0.712719
====================================================
  Execution time = 1.9985e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4129e-01
  Total weights = 2.0000e+06
  Execution time = 1.8544e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341303113247
                                         uncertainty =       0.009641476612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341303113247
                                         uncertainty =       0.009641476612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413089960
  error estimate for blocks of size 2^( 2) =       0.000425798171
  error estimate for blocks of size 2^( 3) =       0.000438681106
  error estimate for blocks of size 2^( 4) =       0.000450259420
  error estimate for blocks of size 2^( 5) =       0.000460839169
  error estimate for blocks of size 2^( 6) =       0.000468193248
  error estimate for blocks of size 2^( 7) =       0.000473880187

      target function =                  N/A
              le_mean =     -16.905546581368
             les_mean =     286.138791674976
             stat err =       0.000463293006
             autocorr =       1.257830749771
              std dev =       0.584197424532
             le_variance =       0.341286630829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341303123411
                                         uncertainty =       0.009641476851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341303123411
                                         uncertainty =       0.009641476851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413089967
  error estimate for blocks of size 2^( 2) =       0.000425798177
  error estimate for blocks of size 2^( 3) =       0.000438681112
  error estimate for blocks of size 2^( 4) =       0.000450259425
  error estimate for blocks of size 2^( 5) =       0.000460839175
  error estimate for blocks of size 2^( 6) =       0.000468193253
  error estimate for blocks of size 2^( 7) =       0.000473880191

      target function =                  N/A
              le_mean =     -16.905546581367
             les_mean =     286.138791685120
             stat err =       0.000463293011
             autocorr =       1.257830739811
              std dev =       0.584197433228
             le_variance =       0.341286640990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341303118329
                                         uncertainty =       0.009641476732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341303118329
                                         uncertainty =       0.009641476732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413089964
  error estimate for blocks of size 2^( 2) =       0.000425798174
  error estimate for blocks of size 2^( 3) =       0.000438681109
  error estimate for blocks of size 2^( 4) =       0.000450259423
  error estimate for blocks of size 2^( 5) =       0.000460839172
  error estimate for blocks of size 2^( 6) =       0.000468193250
  error estimate for blocks of size 2^( 7) =       0.000473880189

      target function =                  N/A
              le_mean =     -16.905546581367
             les_mean =     286.138791680048
             stat err =       0.000463293008
             autocorr =       1.257830744790
              std dev =       0.584197428880
             le_variance =       0.341286635910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341303113882
                                         uncertainty =       0.009641476627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341303113882
                                         uncertainty =       0.009641476627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413089961
  error estimate for blocks of size 2^( 2) =       0.000425798172
  error estimate for blocks of size 2^( 3) =       0.000438681107
  error estimate for blocks of size 2^( 4) =       0.000450259420
  error estimate for blocks of size 2^( 5) =       0.000460839170
  error estimate for blocks of size 2^( 6) =       0.000468193248
  error estimate for blocks of size 2^( 7) =       0.000473880187

      target function =                  N/A
              le_mean =     -16.905546581368
             les_mean =     286.138791675610
             stat err =       0.000463293006
             autocorr =       1.257830749149
              std dev =       0.584197425075
             le_variance =       0.341286631465


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905546581368        initial  <--
     2.3283e+04     2.3283e+05             1.3306e-08       -16.905546581367
     9.3132e+04     9.3132e+05             3.3265e-09       -16.905546581367
     3.7253e+05     3.7253e+06             8.3164e-10       -16.905546581368

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3357
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439065e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228887e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639189e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531852e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816299e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940675e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141233e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167681e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383059e-02 1 1  ON 43
eH2_4                 1.374844e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375195e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5833e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.897
    reference variance = 0.262494
====================================================
  Execution time = 2.0617e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3796e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4990e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338020364363
                                         uncertainty =       0.003353249086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338020364363
                                         uncertainty =       0.003353249086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411070707
  error estimate for blocks of size 2^( 2) =       0.000424356764
  error estimate for blocks of size 2^( 3) =       0.000437483544
  error estimate for blocks of size 2^( 4) =       0.000450617699
  error estimate for blocks of size 2^( 5) =       0.000461923802
  error estimate for blocks of size 2^( 6) =       0.000470536404
  error estimate for blocks of size 2^( 7) =       0.000475786110

      target function =                  N/A
              le_mean =     -16.905060750600
             les_mean =     286.119037064749
             stat err =       0.000464716004
             autocorr =       1.278033381622
              std dev =       0.581341768899
             le_variance =       0.337958252267


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690506075060e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905060750600       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905060750610       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905060750610       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905060750585       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905060750408       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905060750503       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905060750544       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905060750566       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.127462e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905060750600       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905060750602       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905060750602       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905060751477       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905060750753       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905060751022       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905060750448       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905060750562       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 2.818662e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905060750600       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905060750600       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905060750600       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905060750442       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905060749806       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905060751310       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905060749049       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905060751559       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 7.046639e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.227923 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6131e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439065e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228887e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639189e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531852e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816299e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940675e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141233e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167681e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383059e-02 1 1  ON 43
eH2_4                 1.374844e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375195e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9003
    reference variance = 0.295182
====================================================
  Execution time = 2.0142e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3266e-01
  Total weights = 2.0000e+06
  Execution time = 1.8529e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332725938744
                                         uncertainty =       0.002795437091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332725938744
                                         uncertainty =       0.002795437091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407836824
  error estimate for blocks of size 2^( 2) =       0.000420644654
  error estimate for blocks of size 2^( 3) =       0.000434254310
  error estimate for blocks of size 2^( 4) =       0.000447302596
  error estimate for blocks of size 2^( 5) =       0.000458062316
  error estimate for blocks of size 2^( 6) =       0.000467216561
  error estimate for blocks of size 2^( 7) =       0.000471868577

      target function =                  N/A
              le_mean =     -16.905594338123
             les_mean =     286.131781509195
             stat err =       0.000461112513
             autocorr =       1.278323997591
              std dev =       0.576768368010
             le_variance =       0.332661750336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332725939771
                                         uncertainty =       0.002795437102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332725939771
                                         uncertainty =       0.002795437102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407836825
  error estimate for blocks of size 2^( 2) =       0.000420644654
  error estimate for blocks of size 2^( 3) =       0.000434254310
  error estimate for blocks of size 2^( 4) =       0.000447302597
  error estimate for blocks of size 2^( 5) =       0.000458062316
  error estimate for blocks of size 2^( 6) =       0.000467216561
  error estimate for blocks of size 2^( 7) =       0.000471868578

      target function =                  N/A
              le_mean =     -16.905594338127
             les_mean =     286.131781510328
             stat err =       0.000461112513
             autocorr =       1.278323996506
              std dev =       0.576768368900
             le_variance =       0.332661751364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332725939258
                                         uncertainty =       0.002795437097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332725939258
                                         uncertainty =       0.002795437097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407836825
  error estimate for blocks of size 2^( 2) =       0.000420644654
  error estimate for blocks of size 2^( 3) =       0.000434254310
  error estimate for blocks of size 2^( 4) =       0.000447302596
  error estimate for blocks of size 2^( 5) =       0.000458062316
  error estimate for blocks of size 2^( 6) =       0.000467216561
  error estimate for blocks of size 2^( 7) =       0.000471868578

      target function =                  N/A
              le_mean =     -16.905594338125
             les_mean =     286.131781509762
             stat err =       0.000461112513
             autocorr =       1.278323997046
              std dev =       0.576768368455
             le_variance =       0.332661750850

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332725938808
                                         uncertainty =       0.002795437092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332725938808
                                         uncertainty =       0.002795437092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407836824
  error estimate for blocks of size 2^( 2) =       0.000420644654
  error estimate for blocks of size 2^( 3) =       0.000434254310
  error estimate for blocks of size 2^( 4) =       0.000447302596
  error estimate for blocks of size 2^( 5) =       0.000458062316
  error estimate for blocks of size 2^( 6) =       0.000467216561
  error estimate for blocks of size 2^( 7) =       0.000471868578

      target function =                  N/A
              le_mean =     -16.905594338124
             les_mean =     286.131781509266
             stat err =       0.000461112513
             autocorr =       1.278323997520
              std dev =       0.576768368065
             le_variance =       0.332661750401


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905594338123        initial
     2.3283e+05     2.3283e+06             1.1275e-09       -16.905594338127  <--
     9.3132e+05     9.3132e+06             2.8187e-10       -16.905594338125
     3.7253e+06     3.7253e+07             7.0466e-11       -16.905594338124

*****************************************************************************
Applying the update for shift_i =   2.3283e+05     and shift_s =   2.3283e+06
*****************************************************************************

  Execution time = 2.9489e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439065e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228887e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639189e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531852e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816299e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940675e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141233e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167681e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383059e-02 1 1  ON 43
eH2_4                 1.374844e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375195e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5626e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.938
    reference variance = 0.149497
====================================================
  Execution time = 2.0828e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3950e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5905e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339266088841
                                         uncertainty =       0.004220817662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339266088841
                                         uncertainty =       0.004220817662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412006220
  error estimate for blocks of size 2^( 2) =       0.000424768539
  error estimate for blocks of size 2^( 3) =       0.000438581659
  error estimate for blocks of size 2^( 4) =       0.000450666867
  error estimate for blocks of size 2^( 5) =       0.000461839153
  error estimate for blocks of size 2^( 6) =       0.000472112138
  error estimate for blocks of size 2^( 7) =       0.000477120082

      target function =                  N/A
              le_mean =     -16.906008740538
             les_mean =     286.152629615842
             stat err =       0.000465434560
             autocorr =       1.276173464844
              std dev =       0.582664783937
             le_variance =       0.339498250441


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690600874054e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906008740538       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906008740541       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906008740517       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906008740514       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906008740506       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906008740516       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906008740565       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906008740509       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 5.102625e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906008740538       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906008740539       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906008740533       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906008740532       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906008740531       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906008740556       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906008740686       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906008740599       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.275657e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906008740538       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906008740538       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906008740537       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906008740537       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906008739970       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906008740605       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906008739976       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906008741180       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 3.189145e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230537 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6426e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439065e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228887e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639190e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531852e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816299e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940675e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141233e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167681e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383059e-02 1 1  ON 43
eH2_4                 1.374844e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375195e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9251
    reference variance = 0.327208
====================================================
  Execution time = 2.0556e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3646e-01
  Total weights = 2.0000e+06
  Execution time = 1.8585e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336486125471
                                         uncertainty =       0.003909267371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336486125471
                                         uncertainty =       0.003909267371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410157882
  error estimate for blocks of size 2^( 2) =       0.000422574841
  error estimate for blocks of size 2^( 3) =       0.000435669820
  error estimate for blocks of size 2^( 4) =       0.000446657140
  error estimate for blocks of size 2^( 5) =       0.000456455051
  error estimate for blocks of size 2^( 6) =       0.000463316423
  error estimate for blocks of size 2^( 7) =       0.000464658341

      target function =                  N/A
              le_mean =     -16.906070123377
             les_mean =     286.151665825399
             stat err =       0.000457771739
             autocorr =       1.245649420126
              std dev =       0.580050840080
             le_variance =       0.336458977078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336486129009
                                         uncertainty =       0.003909267469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336486129009
                                         uncertainty =       0.003909267469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410157885
  error estimate for blocks of size 2^( 2) =       0.000422574843
  error estimate for blocks of size 2^( 3) =       0.000435669822
  error estimate for blocks of size 2^( 4) =       0.000446657142
  error estimate for blocks of size 2^( 5) =       0.000456455053
  error estimate for blocks of size 2^( 6) =       0.000463316424
  error estimate for blocks of size 2^( 7) =       0.000464658343

      target function =                  N/A
              le_mean =     -16.906070123401
             les_mean =     286.151665829748
             stat err =       0.000457771741
             autocorr =       1.245649416419
              std dev =       0.580050843129
             le_variance =       0.336458980614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336486127240
                                         uncertainty =       0.003909267420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336486127240
                                         uncertainty =       0.003909267420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410157884
  error estimate for blocks of size 2^( 2) =       0.000422574842
  error estimate for blocks of size 2^( 3) =       0.000435669821
  error estimate for blocks of size 2^( 4) =       0.000446657141
  error estimate for blocks of size 2^( 5) =       0.000456455052
  error estimate for blocks of size 2^( 6) =       0.000463316423
  error estimate for blocks of size 2^( 7) =       0.000464658342

      target function =                  N/A
              le_mean =     -16.906070123389
             les_mean =     286.151665827573
             stat err =       0.000457771740
             autocorr =       1.245649418278
              std dev =       0.580050841604
             le_variance =       0.336458978846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336486125692
                                         uncertainty =       0.003909267377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336486125692
                                         uncertainty =       0.003909267377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410157883
  error estimate for blocks of size 2^( 2) =       0.000422574841
  error estimate for blocks of size 2^( 3) =       0.000435669820
  error estimate for blocks of size 2^( 4) =       0.000446657140
  error estimate for blocks of size 2^( 5) =       0.000456455051
  error estimate for blocks of size 2^( 6) =       0.000463316423
  error estimate for blocks of size 2^( 7) =       0.000464658342

      target function =                  N/A
              le_mean =     -16.906070123379
             les_mean =     286.151665825671
             stat err =       0.000457771739
             autocorr =       1.245649419900
              std dev =       0.580050840271
             le_variance =       0.336458977299


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906070123377        initial
     5.8208e+04     5.8208e+05             5.1026e-09       -16.906070123401  <--
     2.3283e+05     2.3283e+06             1.2757e-09       -16.906070123389
     9.3132e+05     9.3132e+06             3.1891e-10       -16.906070123379

*****************************************************************************
Applying the update for shift_i =   5.8208e+04     and shift_s =   5.8208e+05
*****************************************************************************

  Execution time = 2.9928e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439066e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228888e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639190e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531852e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816299e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940675e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141233e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167682e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383059e-02 1 1  ON 43
eH2_4                 1.374844e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375195e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6468e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9395
    reference variance = 0.18953
====================================================
  Execution time = 2.0432e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4959e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7519e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349562603608
                                         uncertainty =       0.007757268662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349562603608
                                         uncertainty =       0.007757268662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418086720
  error estimate for blocks of size 2^( 2) =       0.000430947957
  error estimate for blocks of size 2^( 3) =       0.000444583805
  error estimate for blocks of size 2^( 4) =       0.000457271738
  error estimate for blocks of size 2^( 5) =       0.000467853194
  error estimate for blocks of size 2^( 6) =       0.000477233991
  error estimate for blocks of size 2^( 7) =       0.000484453841

      target function =                  N/A
              le_mean =     -16.905053330920
             les_mean =     286.130420957379
             stat err =       0.000471703191
             autocorr =       1.272931056377
              std dev =       0.591263909706
             le_variance =       0.349593010921


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690505333092e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905053330920       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905053330921       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905053330994       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905053330998       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905053330998       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905053331016       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905053331049       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905053331044       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 2.233896e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905053330920       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905053330920       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905053330939       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905053330991       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905053330940       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905053330949       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905053330975       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905053330924       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 5.584769e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905053330920       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905053330920       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905053330925       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905053330925       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905053330924       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905053330939       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905053330878       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905053330996       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.396194e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.233171 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6192e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439066e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228888e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639190e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531852e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316859e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816300e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940675e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141233e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863348e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167682e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383059e-02 1 1  ON 43
eH2_4                 1.374843e-02 1 1  ON 44
eH2_5                 4.823889e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498762e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375195e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9407
    reference variance = 0.281686
====================================================
  Execution time = 2.2454e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3838e-01
  Total weights = 2.0000e+06
  Execution time = 1.8608e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338396667659
                                         uncertainty =       0.004084598390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338396667659
                                         uncertainty =       0.004084598390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411328152
  error estimate for blocks of size 2^( 2) =       0.000423902254
  error estimate for blocks of size 2^( 3) =       0.000436963530
  error estimate for blocks of size 2^( 4) =       0.000449644013
  error estimate for blocks of size 2^( 5) =       0.000460055626
  error estimate for blocks of size 2^( 6) =       0.000466893706
  error estimate for blocks of size 2^( 7) =       0.000472045802

      target function =                  N/A
              le_mean =     -16.904725130671
             les_mean =     286.108113271663
             stat err =       0.000462159787
             autocorr =       1.262430386442
              std dev =       0.581705851193
             le_variance =       0.338381697312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338396678188
                                         uncertainty =       0.004084598489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338396678188
                                         uncertainty =       0.004084598489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411328158
  error estimate for blocks of size 2^( 2) =       0.000423902260
  error estimate for blocks of size 2^( 3) =       0.000436963535
  error estimate for blocks of size 2^( 4) =       0.000449644019
  error estimate for blocks of size 2^( 5) =       0.000460055632
  error estimate for blocks of size 2^( 6) =       0.000466893711
  error estimate for blocks of size 2^( 7) =       0.000472045806

      target function =                  N/A
              le_mean =     -16.904725130630
             les_mean =     286.108113280809
             stat err =       0.000462159792
             autocorr =       1.262430375134
              std dev =       0.581705860250
             le_variance =       0.338381707849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338396672923
                                         uncertainty =       0.004084598440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338396672923
                                         uncertainty =       0.004084598440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411328155
  error estimate for blocks of size 2^( 2) =       0.000423902257
  error estimate for blocks of size 2^( 3) =       0.000436963532
  error estimate for blocks of size 2^( 4) =       0.000449644016
  error estimate for blocks of size 2^( 5) =       0.000460055629
  error estimate for blocks of size 2^( 6) =       0.000466893708
  error estimate for blocks of size 2^( 7) =       0.000472045804

      target function =                  N/A
              le_mean =     -16.904725130650
             les_mean =     286.108113276236
             stat err =       0.000462159789
             autocorr =       1.262430380793
              std dev =       0.581705855722
             le_variance =       0.338381702581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338396668317
                                         uncertainty =       0.004084598397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338396668317
                                         uncertainty =       0.004084598397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411328152
  error estimate for blocks of size 2^( 2) =       0.000423902254
  error estimate for blocks of size 2^( 3) =       0.000436963530
  error estimate for blocks of size 2^( 4) =       0.000449644014
  error estimate for blocks of size 2^( 5) =       0.000460055627
  error estimate for blocks of size 2^( 6) =       0.000466893706
  error estimate for blocks of size 2^( 7) =       0.000472045802

      target function =                  N/A
              le_mean =     -16.904725130668
             les_mean =     286.108113272234
             stat err =       0.000462159787
             autocorr =       1.262430385741
              std dev =       0.581705851759
             le_variance =       0.338381697971


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904725130671        initial  <--
     1.4552e+04     1.4552e+05             2.2339e-08       -16.904725130630
     5.8208e+04     5.8208e+05             5.5848e-09       -16.904725130650
     2.3283e+05     2.3283e+06             1.3962e-09       -16.904725130668

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.8553
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439066e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228888e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639190e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531852e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816299e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940675e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141233e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167682e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383059e-02 1 1  ON 43
eH2_4                 1.374844e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375195e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8053e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8782
    reference variance = 0.310289
====================================================
  Execution time = 2.2433e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4061e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5467e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340550502591
                                         uncertainty =       0.003453197447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340550502591
                                         uncertainty =       0.003453197447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412679786
  error estimate for blocks of size 2^( 2) =       0.000425575063
  error estimate for blocks of size 2^( 3) =       0.000438520982
  error estimate for blocks of size 2^( 4) =       0.000450200478
  error estimate for blocks of size 2^( 5) =       0.000461051191
  error estimate for blocks of size 2^( 6) =       0.000470320092
  error estimate for blocks of size 2^( 7) =       0.000475934076

      target function =                  N/A
              le_mean =     -16.906156890050
             les_mean =     286.158749832685
             stat err =       0.000464376459
             autocorr =       1.266234079450
              std dev =       0.583617350673
             le_variance =       0.340609212007


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690615689005e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906156890050       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906156890050       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906156890056       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906156890032       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906156890076       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906156889813       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906156890143       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 1.556963e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906156890050       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906156890050       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906156890051       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906156890052       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906156890103       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906156890227       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906156889971       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 3.892410e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906156890050       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906156890050       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906156890050       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906156890050       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906156890240       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906156889072       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906156890308       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 9.731015e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.235415 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7987e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439066e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228888e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639190e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531852e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816299e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940675e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141233e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167682e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383059e-02 1 1  ON 43
eH2_4                 1.374843e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375195e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8958
    reference variance = 0.347008
====================================================
  Execution time = 2.0183e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3752e-01
  Total weights = 2.0000e+06
  Execution time = 1.8542e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337541570808
                                         uncertainty =       0.005166011791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337541570808
                                         uncertainty =       0.005166011791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410802452
  error estimate for blocks of size 2^( 2) =       0.000423709832
  error estimate for blocks of size 2^( 3) =       0.000436775155
  error estimate for blocks of size 2^( 4) =       0.000450209035
  error estimate for blocks of size 2^( 5) =       0.000460050274
  error estimate for blocks of size 2^( 6) =       0.000468384425
  error estimate for blocks of size 2^( 7) =       0.000471576756

      target function =                  N/A
              le_mean =     -16.905450009077
             les_mean =     286.131757150558
             stat err =       0.000462555122
             autocorr =       1.267829738224
              std dev =       0.580962399735
             le_variance =       0.337517309906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337541571916
                                         uncertainty =       0.005166011794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337541571916
                                         uncertainty =       0.005166011794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410802453
  error estimate for blocks of size 2^( 2) =       0.000423709833
  error estimate for blocks of size 2^( 3) =       0.000436775156
  error estimate for blocks of size 2^( 4) =       0.000450209036
  error estimate for blocks of size 2^( 5) =       0.000460050274
  error estimate for blocks of size 2^( 6) =       0.000468384426
  error estimate for blocks of size 2^( 7) =       0.000471576756

      target function =                  N/A
              le_mean =     -16.905450009082
             les_mean =     286.131757151831
             stat err =       0.000462555123
             autocorr =       1.267829737213
              std dev =       0.580962400689
             le_variance =       0.337517311015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337541571362
                                         uncertainty =       0.005166011793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337541571362
                                         uncertainty =       0.005166011793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410802453
  error estimate for blocks of size 2^( 2) =       0.000423709832
  error estimate for blocks of size 2^( 3) =       0.000436775155
  error estimate for blocks of size 2^( 4) =       0.000450209036
  error estimate for blocks of size 2^( 5) =       0.000460050274
  error estimate for blocks of size 2^( 6) =       0.000468384426
  error estimate for blocks of size 2^( 7) =       0.000471576756

      target function =                  N/A
              le_mean =     -16.905450009080
             les_mean =     286.131757151195
             stat err =       0.000462555123
             autocorr =       1.267829737722
              std dev =       0.580962400212
             le_variance =       0.337517310461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337541570877
                                         uncertainty =       0.005166011791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337541570877
                                         uncertainty =       0.005166011791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410802453
  error estimate for blocks of size 2^( 2) =       0.000423709832
  error estimate for blocks of size 2^( 3) =       0.000436775155
  error estimate for blocks of size 2^( 4) =       0.000450209035
  error estimate for blocks of size 2^( 5) =       0.000460050274
  error estimate for blocks of size 2^( 6) =       0.000468384425
  error estimate for blocks of size 2^( 7) =       0.000471576756

      target function =                  N/A
              le_mean =     -16.905450009078
             les_mean =     286.131757150638
             stat err =       0.000462555123
             autocorr =       1.267829738164
              std dev =       0.580962399795
             le_variance =       0.337517309976


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905450009077        initial
     1.4552e+05     1.4552e+06             1.5570e-09       -16.905450009082  <--
     5.8208e+05     5.8208e+06             3.8924e-10       -16.905450009080
     2.3283e+06     2.3283e+07             9.7310e-11       -16.905450009078

*****************************************************************************
Applying the update for shift_i =   1.4552e+05     and shift_s =   1.4552e+06
*****************************************************************************

  Execution time = 2.9532e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439066e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228888e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639190e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531852e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816300e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940675e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141233e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167682e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383059e-02 1 1  ON 43
eH2_4                 1.374843e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375195e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7526e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9621
    reference variance = 0.204397
====================================================
  Execution time = 2.0524e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4189e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5559e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341966381692
                                         uncertainty =       0.006704108760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341966381692
                                         uncertainty =       0.006704108760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413453021
  error estimate for blocks of size 2^( 2) =       0.000426090292
  error estimate for blocks of size 2^( 3) =       0.000439605568
  error estimate for blocks of size 2^( 4) =       0.000452371759
  error estimate for blocks of size 2^( 5) =       0.000462830807
  error estimate for blocks of size 2^( 6) =       0.000471156275
  error estimate for blocks of size 2^( 7) =       0.000476110347

      target function =                  N/A
              le_mean =     -16.905748321745
             les_mean =     286.146212948467
             stat err =       0.000465617297
             autocorr =       1.268252923138
              std dev =       0.584710869767
             le_variance =       0.341886801223


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574832175e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905748321745       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905748321745       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905748321739       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905748321745       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905748321761       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905748321741       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905748321740       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905748321739       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 8.072635e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905748321745       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905748321745       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905748321744       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905748321748       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905748321746       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905748321748       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905748321724       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905748321627       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 2.018160e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905748321745       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905748321745       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905748321745       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905748321745       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905748321745       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905748321854       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905748321629       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905748322090       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 5.045399e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.238000 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6088e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439066e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228888e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639190e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531852e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316859e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816300e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940675e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141233e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167682e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383059e-02 1 1  ON 43
eH2_4                 1.374843e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375195e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8537
    reference variance = 0.183085
====================================================
  Execution time = 2.0206e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6585e-01
  Total weights = 2.0000e+06
  Execution time = 1.8544e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365980495834
                                         uncertainty =       0.018387431179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365980495834
                                         uncertainty =       0.018387431179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427700270
  error estimate for blocks of size 2^( 2) =       0.000439951239
  error estimate for blocks of size 2^( 3) =       0.000453112581
  error estimate for blocks of size 2^( 4) =       0.000466224956
  error estimate for blocks of size 2^( 5) =       0.000476477804
  error estimate for blocks of size 2^( 6) =       0.000484889019
  error estimate for blocks of size 2^( 7) =       0.000490821436

      target function =                  N/A
              le_mean =     -16.905864877998
             les_mean =     286.174122132527
             stat err =       0.000479603304
             autocorr =       1.257434242745
              std dev =       0.604859522811
             le_variance =       0.365855042335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365980501735
                                         uncertainty =       0.018387431295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365980501735
                                         uncertainty =       0.018387431295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427700274
  error estimate for blocks of size 2^( 2) =       0.000439951242
  error estimate for blocks of size 2^( 3) =       0.000453112584
  error estimate for blocks of size 2^( 4) =       0.000466224959
  error estimate for blocks of size 2^( 5) =       0.000476477807
  error estimate for blocks of size 2^( 6) =       0.000484889022
  error estimate for blocks of size 2^( 7) =       0.000490821438

      target function =                  N/A
              le_mean =     -16.905864877995
             les_mean =     286.174122138331
             stat err =       0.000479603307
             autocorr =       1.257434237186
              std dev =       0.604859527688
             le_variance =       0.365855048235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365980498784
                                         uncertainty =       0.018387431237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365980498784
                                         uncertainty =       0.018387431237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427700272
  error estimate for blocks of size 2^( 2) =       0.000439951240
  error estimate for blocks of size 2^( 3) =       0.000453112583
  error estimate for blocks of size 2^( 4) =       0.000466224957
  error estimate for blocks of size 2^( 5) =       0.000476477806
  error estimate for blocks of size 2^( 6) =       0.000484889021
  error estimate for blocks of size 2^( 7) =       0.000490821437

      target function =                  N/A
              le_mean =     -16.905864877996
             les_mean =     286.174122135429
             stat err =       0.000479603305
             autocorr =       1.257434239967
              std dev =       0.604859525249
             le_variance =       0.365855045285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365980496202
                                         uncertainty =       0.018387431187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365980496202
                                         uncertainty =       0.018387431187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427700270
  error estimate for blocks of size 2^( 2) =       0.000439951239
  error estimate for blocks of size 2^( 3) =       0.000453112581
  error estimate for blocks of size 2^( 4) =       0.000466224956
  error estimate for blocks of size 2^( 5) =       0.000476477805
  error estimate for blocks of size 2^( 6) =       0.000484889019
  error estimate for blocks of size 2^( 7) =       0.000490821436

      target function =                  N/A
              le_mean =     -16.905864877998
             les_mean =     286.174122132890
             stat err =       0.000479603304
             autocorr =       1.257434242403
              std dev =       0.604859523115
             le_variance =       0.365855042703


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905864877998        initial  <--
     3.6380e+04     3.6380e+05             8.0726e-09       -16.905864877995
     1.4552e+05     1.4552e+06             2.0182e-09       -16.905864877996
     5.8208e+05     5.8208e+06             5.0454e-10       -16.905864877998

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5789
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439066e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228888e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639190e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531852e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816300e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940675e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141233e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167682e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383059e-02 1 1  ON 43
eH2_4                 1.374843e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375195e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5677e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8419
    reference variance = 0.264585
====================================================
  Execution time = 2.0578e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3881e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338899132933
                                         uncertainty =       0.009918928688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338899132933
                                         uncertainty =       0.009918928688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411590042
  error estimate for blocks of size 2^( 2) =       0.000424327972
  error estimate for blocks of size 2^( 3) =       0.000437554894
  error estimate for blocks of size 2^( 4) =       0.000449994175
  error estimate for blocks of size 2^( 5) =       0.000460806540
  error estimate for blocks of size 2^( 6) =       0.000467505112
  error estimate for blocks of size 2^( 7) =       0.000469812964

      target function =                  N/A
              le_mean =     -16.905455736578
             les_mean =     286.133246218152
             stat err =       0.000462029698
             autocorr =       1.260114659897
              std dev =       0.582076220230
             le_variance =       0.338812726157


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690545573658e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905455736578       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905455736580       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905455736581       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905455736773       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905455736275       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905455736539       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905455736791       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905455736462       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 7.166981e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905455736578       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905455736578       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905455736579       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905455736924       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905455737779       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905455736577       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905455737801       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905455736722       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.791749e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905455736578       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905455736578       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905455736578       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905455736681       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905455736578       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905455737658       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905455735606       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905455736599       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 4.479361e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.240649 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6086e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439066e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228888e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639190e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531852e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816300e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940675e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141233e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167682e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383059e-02 1 1  ON 43
eH2_4                 1.374843e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375195e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8497
    reference variance = 0.293721
====================================================
  Execution time = 2.0362e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3426e-01
  Total weights = 2.0000e+06
  Execution time = 1.8546e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334331580412
                                         uncertainty =       0.003398468669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334331580412
                                         uncertainty =       0.003398468669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408815417
  error estimate for blocks of size 2^( 2) =       0.000421884288
  error estimate for blocks of size 2^( 3) =       0.000434898832
  error estimate for blocks of size 2^( 4) =       0.000447425548
  error estimate for blocks of size 2^( 5) =       0.000458437835
  error estimate for blocks of size 2^( 6) =       0.000467258513
  error estimate for blocks of size 2^( 7) =       0.000476592061

      target function =                  N/A
              le_mean =     -16.905887775385
             les_mean =     286.143301397602
             stat err =       0.000462428489
             autocorr =       1.279483334185
              std dev =       0.578152307637
             le_variance =       0.334260090826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334331581028
                                         uncertainty =       0.003398468678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334331581028
                                         uncertainty =       0.003398468678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408815418
  error estimate for blocks of size 2^( 2) =       0.000421884288
  error estimate for blocks of size 2^( 3) =       0.000434898833
  error estimate for blocks of size 2^( 4) =       0.000447425548
  error estimate for blocks of size 2^( 5) =       0.000458437835
  error estimate for blocks of size 2^( 6) =       0.000467258513
  error estimate for blocks of size 2^( 7) =       0.000476592062

      target function =                  N/A
              le_mean =     -16.905887775385
             les_mean =     286.143301398231
             stat err =       0.000462428490
             autocorr =       1.279483333556
              std dev =       0.578152308169
             le_variance =       0.334260091441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334331580720
                                         uncertainty =       0.003398468673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334331580720
                                         uncertainty =       0.003398468673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408815417
  error estimate for blocks of size 2^( 2) =       0.000421884288
  error estimate for blocks of size 2^( 3) =       0.000434898832
  error estimate for blocks of size 2^( 4) =       0.000447425548
  error estimate for blocks of size 2^( 5) =       0.000458437835
  error estimate for blocks of size 2^( 6) =       0.000467258513
  error estimate for blocks of size 2^( 7) =       0.000476592062

      target function =                  N/A
              le_mean =     -16.905887775385
             les_mean =     286.143301397917
             stat err =       0.000462428489
             autocorr =       1.279483333875
              std dev =       0.578152307903
             le_variance =       0.334260091134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334331580451
                                         uncertainty =       0.003398468669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334331580451
                                         uncertainty =       0.003398468669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408815417
  error estimate for blocks of size 2^( 2) =       0.000421884288
  error estimate for blocks of size 2^( 3) =       0.000434898832
  error estimate for blocks of size 2^( 4) =       0.000447425548
  error estimate for blocks of size 2^( 5) =       0.000458437835
  error estimate for blocks of size 2^( 6) =       0.000467258513
  error estimate for blocks of size 2^( 7) =       0.000476592062

      target function =                  N/A
              le_mean =     -16.905887775385
             les_mean =     286.143301397641
             stat err =       0.000462428489
             autocorr =       1.279483334151
              std dev =       0.578152307670
             le_variance =       0.334260090865


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905887775385        initial
     3.6380e+05     3.6380e+06             7.1670e-10       -16.905887775385  <--
     1.4552e+06     1.4552e+07             1.7917e-10       -16.905887775385
     5.8208e+06     5.8208e+07             4.4794e-11       -16.905887775385

*****************************************************************************
Applying the update for shift_i =   3.6380e+05     and shift_s =   3.6380e+06
*****************************************************************************

  Execution time = 2.9716e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439066e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228888e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639190e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531852e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316858e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816300e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940675e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141233e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167682e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704155e-02 1 1  ON 42
eH2_3                -3.383059e-02 1 1  ON 43
eH2_4                 1.374843e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375195e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5809e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9949
    reference variance = 0.279429
====================================================
  Execution time = 2.0438e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3591e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6168e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335876814992
                                         uncertainty =       0.003020781936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335876814992
                                         uncertainty =       0.003020781936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409826213
  error estimate for blocks of size 2^( 2) =       0.000422595627
  error estimate for blocks of size 2^( 3) =       0.000436117091
  error estimate for blocks of size 2^( 4) =       0.000449271993
  error estimate for blocks of size 2^( 5) =       0.000459862323
  error estimate for blocks of size 2^( 6) =       0.000468287542
  error estimate for blocks of size 2^( 7) =       0.000471396962

      target function =                  N/A
              le_mean =     -16.905530935040
             les_mean =     286.132891077941
             stat err =       0.000462204705
             autocorr =       1.271947709954
              std dev =       0.579581789135
             le_variance =       0.335915050297


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690553093504e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905530935040       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905530935042       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905530935066       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905530935050       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905530935065       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905530935116       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905530935223       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905530934594       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 2.867127e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905530935040       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905530935041       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905530935047       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905530935037       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905530935341       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905530934628       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905530934910       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905530934599       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 7.167826e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905530935040       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905530935040       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905530935042       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905530935398       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905530935251       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905530935887       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905530934648       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905530934866       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.791961e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.243276 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6073e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439066e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228888e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639190e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531853e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316859e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816300e-02 1 1  ON 22
 eO_3                 2.953328e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940675e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141233e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167682e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704156e-02 1 1  ON 42
eH2_3                -3.383059e-02 1 1  ON 43
eH2_4                 1.374843e-02 1 1  ON 44
eH2_5                 4.823890e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375195e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9097
    reference variance = 0.592266
====================================================
  Execution time = 2.0058e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2712e-01
  Total weights = 2.0000e+06
  Execution time = 1.8522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327165281856
                                         uncertainty =       0.001981425245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327165281856
                                         uncertainty =       0.001981425245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404425956
  error estimate for blocks of size 2^( 2) =       0.000417691357
  error estimate for blocks of size 2^( 3) =       0.000431548834
  error estimate for blocks of size 2^( 4) =       0.000445017639
  error estimate for blocks of size 2^( 5) =       0.000456988018
  error estimate for blocks of size 2^( 6) =       0.000465629595
  error estimate for blocks of size 2^( 7) =       0.000468924949

      target function =                  N/A
              le_mean =     -16.905231585813
             les_mean =     286.113975514626
             stat err =       0.000459140050
             autocorr =       1.288879489690
              std dev =       0.571944672338
             le_variance =       0.327120708215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327165284107
                                         uncertainty =       0.001981425257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327165284107
                                         uncertainty =       0.001981425257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404425958
  error estimate for blocks of size 2^( 2) =       0.000417691358
  error estimate for blocks of size 2^( 3) =       0.000431548835
  error estimate for blocks of size 2^( 4) =       0.000445017640
  error estimate for blocks of size 2^( 5) =       0.000456988019
  error estimate for blocks of size 2^( 6) =       0.000465629596
  error estimate for blocks of size 2^( 7) =       0.000468924950

      target function =                  N/A
              le_mean =     -16.905231585815
             les_mean =     286.113975516953
             stat err =       0.000459140051
             autocorr =       1.288879487253
              std dev =       0.571944674304
             le_variance =       0.327120710465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327165282982
                                         uncertainty =       0.001981425251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327165282982
                                         uncertainty =       0.001981425251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404425957
  error estimate for blocks of size 2^( 2) =       0.000417691357
  error estimate for blocks of size 2^( 3) =       0.000431548834
  error estimate for blocks of size 2^( 4) =       0.000445017639
  error estimate for blocks of size 2^( 5) =       0.000456988019
  error estimate for blocks of size 2^( 6) =       0.000465629596
  error estimate for blocks of size 2^( 7) =       0.000468924949

      target function =                  N/A
              le_mean =     -16.905231585814
             les_mean =     286.113975515789
             stat err =       0.000459140051
             autocorr =       1.288879488476
              std dev =       0.571944673321
             le_variance =       0.327120709340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327165281997
                                         uncertainty =       0.001981425245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327165281997
                                         uncertainty =       0.001981425245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404425956
  error estimate for blocks of size 2^( 2) =       0.000417691357
  error estimate for blocks of size 2^( 3) =       0.000431548834
  error estimate for blocks of size 2^( 4) =       0.000445017639
  error estimate for blocks of size 2^( 5) =       0.000456988018
  error estimate for blocks of size 2^( 6) =       0.000465629595
  error estimate for blocks of size 2^( 7) =       0.000468924949

      target function =                  N/A
              le_mean =     -16.905231585813
             les_mean =     286.113975514771
             stat err =       0.000459140050
             autocorr =       1.288879489548
              std dev =       0.571944672461
             le_variance =       0.327120708356


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905231585813        initial
     9.0949e+04     9.0949e+05             2.8671e-09       -16.905231585815  <--
     3.6380e+05     3.6380e+06             7.1678e-10       -16.905231585814
     1.4552e+06     1.4552e+07             1.7920e-10       -16.905231585813

*****************************************************************************
Applying the update for shift_i =   9.0949e+04     and shift_s =   9.0949e+05
*****************************************************************************

  Execution time = 2.9393e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.078319e-01 1 1  ON 0
 uu_1                 1.417410e-01 1 1  ON 1
 uu_2                 4.087059e-02 1 1  ON 2
 uu_3                -2.053758e-02 1 1  ON 3
 uu_4                -6.439066e-02 1 1  ON 4
 uu_5                -9.731408e-02 1 1  ON 5
 uu_6                -1.228888e-01 1 1  ON 6
 uu_7                -1.345031e-01 1 1  ON 7
 uu_8                -1.263069e-01 1 1  ON 8
 uu_9                -9.639190e-02 1 1  ON 9
 ud_0                 4.395403e-01 1 1  ON 10
 ud_1                 1.758796e-01 1 1  ON 11
 ud_2                 5.973553e-02 1 1  ON 12
 ud_3                -8.531853e-03 1 1  ON 13
 ud_4                -6.521414e-02 1 1  ON 14
 ud_5                -1.055299e-01 1 1  ON 15
 ud_6                -1.316859e-01 1 1  ON 16
 ud_7                -1.471938e-01 1 1  ON 17
 ud_8                -1.486211e-01 1 1  ON 18
 ud_9                -1.396792e-01 1 1  ON 19
 eO_0                -7.471182e-01 1 1  ON 20
 eO_1                -4.315174e-01 1 1  ON 21
 eO_2                -1.816300e-02 1 1  ON 22
 eO_3                 2.953329e-01 1 1  ON 23
 eO_4                 5.135685e-01 1 1  ON 24
 eO_5                 4.702068e-01 1 1  ON 25
 eO_6                 2.408177e-01 1 1  ON 26
 eO_7                -5.352170e-02 1 1  ON 27
 eO_8                -2.059231e-01 1 1  ON 28
 eO_9                -6.546965e-02 1 1  ON 29
eH1_0                -2.314856e-01 1 1  ON 30
eH1_1                -1.337524e-01 1 1  ON 31
eH1_2                -8.940675e-02 1 1  ON 32
eH1_3                -3.617800e-02 1 1  ON 33
eH1_4                 1.141233e-02 1 1  ON 34
eH1_5                 4.421722e-02 1 1  ON 35
eH1_6                 9.863349e-02 1 1  ON 36
eH1_7                 1.437569e-01 1 1  ON 37
eH1_8                 1.557627e-01 1 1  ON 38
eH1_9                 4.167682e-02 1 1  ON 39
eH2_0                -2.289961e-01 1 1  ON 40
eH2_1                -1.317036e-01 1 1  ON 41
eH2_2                -8.704156e-02 1 1  ON 42
eH2_3                -3.383059e-02 1 1  ON 43
eH2_4                 1.374843e-02 1 1  ON 44
eH2_5                 4.823889e-02 1 1  ON 45
eH2_6                 1.028465e-01 1 1  ON 46
eH2_7                 1.498761e-01 1 1  ON 47
eH2_8                 1.612679e-01 1 1  ON 48
eH2_9                 2.375196e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5473e+01 secs
  Total Execution time = 2.2779e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
