Rank =    0  Free Memory = 69873 MB
Rank =    1  Free Memory = 69873 MB
Rank =    2  Free Memory = 69873 MB
Rank =    3  Free Memory = 69873 MB
Rank =    4  Free Memory = 69873 MB
Rank =    5  Free Memory = 69873 MB
Rank =    6  Free Memory = 69873 MB
Rank =    7  Free Memory = 69873 MB
Rank =    8  Free Memory = 69873 MB
Rank =    9  Free Memory = 69872 MB
Rank =   10  Free Memory = 69871 MB
Rank =   11  Free Memory = 69871 MB
Rank =   12  Free Memory = 69871 MB
Rank =   13  Free Memory = 69871 MB
Rank =   14  Free Memory = 69870 MB
Rank =   15  Free Memory = 69856 MB
Rank =   16  Free Memory = 69856 MB
Rank =   17  Free Memory = 69856 MB
Rank =   18  Free Memory = 69856 MB
Rank =   19  Free Memory = 69856 MB
Rank =   20  Free Memory = 69856 MB
Rank =   21  Free Memory = 69856 MB
Rank =   22  Free Memory = 69856 MB
Rank =   23  Free Memory = 69856 MB
Rank =   24  Free Memory = 69856 MB
Rank =   25  Free Memory = 69856 MB
Rank =   26  Free Memory = 69856 MB
Rank =   27  Free Memory = 69856 MB
Rank =   28  Free Memory = 69856 MB
Rank =   29  Free Memory = 69856 MB
Rank =   30  Free Memory = 69856 MB
Rank =   31  Free Memory = 69856 MB
Rank =   32  Free Memory = 64244 MB
Rank =   33  Free Memory = 64244 MB
Rank =   34  Free Memory = 64244 MB
Rank =   35  Free Memory = 64244 MB
Rank =   36  Free Memory = 64244 MB
Rank =   37  Free Memory = 64244 MB
Rank =   38  Free Memory = 64244 MB
Rank =   39  Free Memory = 64244 MB
Rank =   40  Free Memory = 64244 MB
Rank =   41  Free Memory = 64244 MB
Rank =   42  Free Memory = 64244 MB
Rank =   43  Free Memory = 64244 MB
Rank =   44  Free Memory = 64244 MB
Rank =   45  Free Memory = 64244 MB
Rank =   46  Free Memory = 64244 MB
Rank =   47  Free Memory = 64244 MB
Rank =   48  Free Memory = 64243 MB
Rank =   49  Free Memory = 64243 MB
Rank =   50  Free Memory = 64243 MB
Rank =   51  Free Memory = 64243 MB
Rank =   52  Free Memory = 64243 MB
Rank =   53  Free Memory = 64243 MB
Rank =   54  Free Memory = 64243 MB
Rank =   55  Free Memory = 64243 MB
Rank =   56  Free Memory = 64243 MB
Rank =   57  Free Memory = 64242 MB
Rank =   58  Free Memory = 64242 MB
Rank =   59  Free Memory = 64242 MB
Rank =   60  Free Memory = 64242 MB
Rank =   61  Free Memory = 64242 MB
Rank =   62  Free Memory = 64242 MB
Rank =   63  Free Memory = 64242 MB
Rank =   64  Free Memory = 48916 MB
Rank =   65  Free Memory = 48916 MB
Rank =   66  Free Memory = 48916 MB
Rank =   67  Free Memory = 48916 MB
Rank =   68  Free Memory = 48916 MB
Rank =   69  Free Memory = 48916 MB
Rank =   70  Free Memory = 48916 MB
Rank =   71  Free Memory = 48916 MB
Rank =   72  Free Memory = 48916 MB
Rank =   73  Free Memory = 48916 MB
Rank =   74  Free Memory = 48916 MB
Rank =   75  Free Memory = 48916 MB
Rank =   76  Free Memory = 48916 MB
Rank =   77  Free Memory = 48916 MB
Rank =   78  Free Memory = 48916 MB
Rank =   79  Free Memory = 48916 MB
Rank =   80  Free Memory = 48916 MB
Rank =   81  Free Memory = 48916 MB
Rank =   82  Free Memory = 48916 MB
Rank =   83  Free Memory = 48916 MB
Rank =   84  Free Memory = 48916 MB
Rank =   85  Free Memory = 48916 MB
Rank =   86  Free Memory = 48916 MB
Rank =   87  Free Memory = 48916 MB
Rank =   88  Free Memory = 48916 MB
Rank =   89  Free Memory = 48916 MB
Rank =   90  Free Memory = 48916 MB
Rank =   91  Free Memory = 48916 MB
Rank =   92  Free Memory = 48916 MB
Rank =   93  Free Memory = 48916 MB
Rank =   94  Free Memory = 48916 MB
Rank =   95  Free Memory = 48916 MB
Rank =   96  Free Memory = 70930 MB
Rank =   97  Free Memory = 70930 MB
Rank =   98  Free Memory = 70930 MB
Rank =   99  Free Memory = 70930 MB
Rank =  100  Free Memory = 70930 MB
Rank =  101  Free Memory = 70930 MB
Rank =  102  Free Memory = 70930 MB
Rank =  103  Free Memory = 70930 MB
Rank =  104  Free Memory = 70930 MB
Rank =  105  Free Memory = 70930 MB
Rank =  106  Free Memory = 70930 MB
Rank =  107  Free Memory = 70930 MB
Rank =  108  Free Memory = 70930 MB
Rank =  109  Free Memory = 70930 MB
Rank =  110  Free Memory = 70930 MB
Rank =  111  Free Memory = 70930 MB
Rank =  112  Free Memory = 70930 MB
Rank =  113  Free Memory = 70930 MB
Rank =  114  Free Memory = 70930 MB
Rank =  115  Free Memory = 70930 MB
Rank =  116  Free Memory = 70930 MB
Rank =  117  Free Memory = 70930 MB
Rank =  118  Free Memory = 70930 MB
Rank =  119  Free Memory = 70930 MB
Rank =  120  Free Memory = 70930 MB
Rank =  121  Free Memory = 70930 MB
Rank =  122  Free Memory = 70930 MB
Rank =  123  Free Memory = 70930 MB
Rank =  124  Free Memory = 70930 MB
Rank =  125  Free Memory = 70930 MB
Rank =  126  Free Memory = 70930 MB
Rank =  127  Free Memory = 70930 MB
  Input file(s): opt_h2o_1b1_gvptt_369dets_run001f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_369dets_run001f.xml

  Project = H2O
  date    = 2023-05-12 09:24:18 PDT
  host    = n0011.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 50

  Range of prime numbers to use as seeds over processors and threads = 239-1069


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.091451e-01    1         1  ON     0
     uu_1                 1.438076e-01    1         1  ON     1
     uu_2                 4.526876e-02    1         1  ON     2
     uu_3                -1.721964e-02    1         1  ON     3
     uu_4                -6.488875e-02    1         1  ON     4
     uu_5                -9.954102e-02    1         1  ON     5
     uu_6                -1.254622e-01    1         1  ON     6
     uu_7                -1.369702e-01    1         1  ON     7
     uu_8                -1.275182e-01    1         1  ON     8
     uu_9                -9.859529e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.284984e-01    1         1  ON     0
     ud_1                 1.730259e-01    1         1  ON     1
     ud_2                 6.202993e-02    1         1  ON     2
     ud_3                -4.743695e-03    1         1  ON     3
     ud_4                -5.975048e-02    1         1  ON     4
     ud_5                -1.016923e-01    1         1  ON     5
     ud_6                -1.301851e-01    1         1  ON     6
     ud_7                -1.481098e-01    1         1  ON     7
     ud_8                -1.507025e-01    1         1  ON     8
     ud_9                -1.400661e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.428886e-01    1         1  ON     0
     eO_1                -4.297340e-01    1         1  ON     1
     eO_2                -1.824421e-02    1         1  ON     2
     eO_3                 2.955075e-01    1         1  ON     3
     eO_4                 5.131383e-01    1         1  ON     4
     eO_5                 4.684636e-01    1         1  ON     5
     eO_6                 2.393809e-01    1         1  ON     6
     eO_7                -5.266611e-02    1         1  ON     7
     eO_8                -2.073836e-01    1         1  ON     8
     eO_9                -6.707734e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.400678e-01    1         1  ON     0
     eH1_1                -1.373305e-01    1         1  ON     1
     eH1_2                -9.436432e-02    1         1  ON     2
     eH1_3                -4.276759e-02    1         1  ON     3
     eH1_4                 1.245707e-02    1         1  ON     4
     eH1_5                 4.892510e-02    1         1  ON     5
     eH1_6                 1.050477e-01    1         1  ON     6
     eH1_7                 1.514894e-01    1         1  ON     7
     eH1_8                 1.599022e-01    1         1  ON     8
     eH1_9                 4.245759e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.393653e-01    1         1  ON     0
     eH2_1                -1.358647e-01    1         1  ON     1
     eH2_2                -9.286237e-02    1         1  ON     2
     eH2_3                -4.116637e-02    1         1  ON     3
     eH2_4                 1.451613e-02    1         1  ON     4
     eH2_5                 5.195402e-02    1         1  ON     5
     eH2_6                 1.091876e-01    1         1  ON     6
     eH2_7                 1.555268e-01    1         1  ON     7
     eH2_8                 1.675721e-01    1         1  ON     8
     eH2_9                 2.809299e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 369 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 4.319919e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 79 unique up determinants.
Found 79 unique down determinants.
Number of terms in pairs array: 24
Number of terms in pairs array: 24
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.9187e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9828
    reference variance = 0.300786
====================================================
  Execution time = 2.6018e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2661e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6548e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326605351951
                                         uncertainty =       0.003755100044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326605351951
                                         uncertainty =       0.003755100044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404112079
  error estimate for blocks of size 2^( 2) =       0.000416191347
  error estimate for blocks of size 2^( 3) =       0.000428382801
  error estimate for blocks of size 2^( 4) =       0.000440657073
  error estimate for blocks of size 2^( 5) =       0.000451839492
  error estimate for blocks of size 2^( 6) =       0.000460612324
  error estimate for blocks of size 2^( 7) =       0.000467155721

      target function =                  N/A
              le_mean =     -16.910898409222
             les_mean =     286.305097988679
             stat err =       0.000455066153
             autocorr =       1.268076356132
              std dev =       0.571500782987
             le_variance =       0.326613144955


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.691089840922e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910898409222       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910906478163       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910908221619       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910913136382       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910916285325       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910917616266       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910917914794       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910917501446       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910918148038       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910918674316       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910918674928       residual = 7.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.863665e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910898409222       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910901691135       residual = 7.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910902568473       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910903425750       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910905208232       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910905426438       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910905601470       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910905453961       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910905502396       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 6.097184e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910898409222       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910899382199       residual = 8.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910899676187       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910899842202       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910900321812       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910900423338       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910900465572       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910900443024       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910900435817       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.669362e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006685 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2689e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.088071e-01                 1 1 ON  0
uu_1  1.435241e-01                 1 1 ON  1
uu_2  4.557845e-02                 1 1 ON  2
uu_3  -1.692670e-02                1 1 ON  3
uu_4  -6.479124e-02                1 1 ON  4
uu_5  -9.949159e-02                1 1 ON  5
uu_6  -1.256248e-01                1 1 ON  6
uu_7  -1.370697e-01                1 1 ON  7
uu_8  -1.276344e-01                1 1 ON  8
uu_9  -9.861132e-02                1 1 ON  9
ud_0  4.290150e-01                 1 1 ON  10
ud_1  1.733840e-01                 1 1 ON  11
ud_2  6.173813e-02                 1 1 ON  12
ud_3  -5.110433e-03                1 1 ON  13
ud_4  -5.990641e-02                1 1 ON  14
ud_5  -1.017421e-01                1 1 ON  15
ud_6  -1.302251e-01                1 1 ON  16
ud_7  -1.481717e-01                1 1 ON  17
ud_8  -1.506976e-01                1 1 ON  18
ud_9  -1.400330e-01                1 1 ON  19
eO_0  -7.434984e-01                1 1 ON  20
eO_1  -4.299932e-01                1 1 ON  21
eO_2  -1.787831e-02                1 1 ON  22
eO_3  2.958949e-01                 1 1 ON  23
eO_4  5.133131e-01                 1 1 ON  24
eO_5  4.685844e-01                 1 1 ON  25
eO_6  2.394011e-01                 1 1 ON  26
eO_7  -5.262493e-02                1 1 ON  27
eO_8  -2.074983e-01                1 1 ON  28
eO_9  -6.720013e-02                1 1 ON  29
eH1_0 -2.405005e-01                1 1 ON  30
eH1_1 -1.374505e-01                1 1 ON  31
eH1_2 -9.446193e-02                1 1 ON  32
eH1_3 -4.290916e-02                1 1 ON  33
eH1_4 1.248549e-02                 1 1 ON  34
eH1_5 4.903662e-02                 1 1 ON  35
eH1_6 1.051964e-01                 1 1 ON  36
eH1_7 1.516209e-01                 1 1 ON  37
eH1_8 1.600845e-01                 1 1 ON  38
eH1_9 4.262464e-02                 1 1 ON  39
eH2_0 -2.396794e-01                1 1 ON  40
eH2_1 -1.359458e-01                1 1 ON  41
eH2_2 -9.293213e-02                1 1 ON  42
eH2_3 -4.133127e-02                1 1 ON  43
eH2_4 1.458646e-02                 1 1 ON  44
eH2_5 5.192890e-02                 1 1 ON  45
eH2_6 1.091545e-01                 1 1 ON  46
eH2_7 1.555610e-01                 1 1 ON  47
eH2_8 1.678407e-01                 1 1 ON  48
eH2_9 2.838245e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9175
    reference variance = 0.287016
====================================================
  Execution time = 2.7382e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3414e-01
  Total weights = 2.0000e+06
  Execution time = 2.9857e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334076585276
                                         uncertainty =       0.005771854495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334076585276
                                         uncertainty =       0.005771854495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408655736
  error estimate for blocks of size 2^( 2) =       0.000420764529
  error estimate for blocks of size 2^( 3) =       0.000432741379
  error estimate for blocks of size 2^( 4) =       0.000444376766
  error estimate for blocks of size 2^( 5) =       0.000455372878
  error estimate for blocks of size 2^( 6) =       0.000464309392
  error estimate for blocks of size 2^( 7) =       0.000467789346

      target function =                  N/A
              le_mean =     -16.910210003520
             les_mean =     286.289201217784
             stat err =       0.000457962095
             autocorr =       1.255867635612
              std dev =       0.577926484624
             le_variance =       0.333999021630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334615809928
                                         uncertainty =       0.005789095374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334615809928
                                         uncertainty =       0.005789095374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408985190
  error estimate for blocks of size 2^( 2) =       0.000421047537
  error estimate for blocks of size 2^( 3) =       0.000432975677
  error estimate for blocks of size 2^( 4) =       0.000444562114
  error estimate for blocks of size 2^( 5) =       0.000455531945
  error estimate for blocks of size 2^( 6) =       0.000464450594
  error estimate for blocks of size 2^( 7) =       0.000467902079

      target function =                  N/A
              le_mean =     -16.910218124961
             les_mean =     286.290014637418
             stat err =       0.000458111683
             autocorr =       1.254664390364
              std dev =       0.578392402193
             le_variance =       0.334537770915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334379496281
                                         uncertainty =       0.005782032895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334379496281
                                         uncertainty =       0.005782032895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408840780
  error estimate for blocks of size 2^( 2) =       0.000420912173
  error estimate for blocks of size 2^( 3) =       0.000432852264
  error estimate for blocks of size 2^( 4) =       0.000444451591
  error estimate for blocks of size 2^( 5) =       0.000455435346
  error estimate for blocks of size 2^( 6) =       0.000464362143
  error estimate for blocks of size 2^( 7) =       0.000467821660

      target function =                  N/A
              le_mean =     -16.910214691731
             les_mean =     286.289662320499
             stat err =       0.000458017685
             autocorr =       1.255035694140
              std dev =       0.578188176296
             le_variance =       0.334301567208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334108805839
                                         uncertainty =       0.005773117951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334108805839
                                         uncertainty =       0.005773117951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408675414
  error estimate for blocks of size 2^( 2) =       0.000420778141
  error estimate for blocks of size 2^( 3) =       0.000432749227
  error estimate for blocks of size 2^( 4) =       0.000444379183
  error estimate for blocks of size 2^( 5) =       0.000455373955
  error estimate for blocks of size 2^( 6) =       0.000464309414
  error estimate for blocks of size 2^( 7) =       0.000467786518

      target function =                  N/A
              le_mean =     -16.910209569096
             les_mean =     286.289218692274
             stat err =       0.000457962267
             autocorr =       1.255747639392
              std dev =       0.577954313532
             le_variance =       0.334031188530


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910210003520        initial
     2.5000e-01     2.5000e+00             1.8637e-03       -16.910218124961  <--
     1.0000e+00     1.0000e+01             6.0972e-04       -16.910214691731
     4.0000e+00     4.0000e+01             1.6694e-04       -16.910209569096

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.2272e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.083413e-01 1 1  ON 0
 uu_1                 1.433305e-01 1 1  ON 1
 uu_2                 4.594837e-02 1 1  ON 2
 uu_3                -1.645002e-02 1 1  ON 3
 uu_4                -6.459432e-02 1 1  ON 4
 uu_5                -9.948424e-02 1 1  ON 5
 uu_6                -1.259918e-01 1 1  ON 6
 uu_7                -1.374068e-01 1 1  ON 7
 uu_8                -1.280332e-01 1 1  ON 8
 uu_9                -9.868774e-02 1 1  ON 9
 ud_0                 4.299995e-01 1 1  ON 10
 ud_1                 1.739154e-01 1 1  ON 11
 ud_2                 6.147378e-02 1 1  ON 12
 ud_3                -5.768135e-03 1 1  ON 13
 ud_4                -6.032754e-02 1 1  ON 14
 ud_5                -1.019287e-01 1 1  ON 15
 ud_6                -1.303287e-01 1 1  ON 16
 ud_7                -1.483116e-01 1 1  ON 17
 ud_8                -1.506945e-01 1 1  ON 18
 ud_9                -1.399403e-01 1 1  ON 19
 eO_0                -7.447523e-01 1 1  ON 20
 eO_1                -4.307207e-01 1 1  ON 21
 eO_2                -1.730496e-02 1 1  ON 22
 eO_3                 2.968261e-01 1 1  ON 23
 eO_4                 5.139105e-01 1 1  ON 24
 eO_5                 4.690035e-01 1 1  ON 25
 eO_6                 2.394774e-01 1 1  ON 26
 eO_7                -5.251419e-02 1 1  ON 27
 eO_8                -2.078451e-01 1 1  ON 28
 eO_9                -6.756789e-02 1 1  ON 29
eH1_0                -2.415573e-01 1 1  ON 30
eH1_1                -1.378534e-01 1 1  ON 31
eH1_2                -9.480003e-02 1 1  ON 32
eH1_3                -4.327680e-02 1 1  ON 33
eH1_4                 1.242155e-02 1 1  ON 34
eH1_5                 4.931117e-02 1 1  ON 35
eH1_6                 1.056364e-01 1 1  ON 36
eH1_7                 1.520245e-01 1 1  ON 37
eH1_8                 1.606304e-01 1 1  ON 38
eH1_9                 4.312320e-02 1 1  ON 39
eH2_0                -2.404412e-01 1 1  ON 40
eH2_1                -1.362557e-01 1 1  ON 41
eH2_2                -9.319327e-02 1 1  ON 42
eH2_3                -4.169410e-02 1 1  ON 43
eH2_4                 1.458165e-02 1 1  ON 44
eH2_5                 5.187472e-02 1 1  ON 45
eH2_6                 1.090816e-01 1 1  ON 46
eH2_7                 1.556612e-01 1 1  ON 47
eH2_8                 1.686293e-01 1 1  ON 48
eH2_9                 2.924405e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4967e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6950e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9418
    reference variance = 0.341812
====================================================
  Execution time = 2.5371e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.5083e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6767e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350837228663
                                         uncertainty =       0.014447377089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350837228663
                                         uncertainty =       0.014447377089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418827362
  error estimate for blocks of size 2^( 2) =       0.000430308733
  error estimate for blocks of size 2^( 3) =       0.000442388425
  error estimate for blocks of size 2^( 4) =       0.000454588155
  error estimate for blocks of size 2^( 5) =       0.000465357260
  error estimate for blocks of size 2^( 6) =       0.000472538447
  error estimate for blocks of size 2^( 7) =       0.000478103773

      target function =                  N/A
              le_mean =     -16.909961859830
             les_mean =     286.297642643482
             stat err =       0.000467646909
             autocorr =       1.246711724222
              std dev =       0.592311335359
             le_variance =       0.350832717995


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690996185983e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909961859830       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909967684880       residual = 9.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909970559374       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909975011737       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909972928743       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909976648054       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909983461234       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909987905379       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909987341600       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909989162045       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909989999982       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909990423812       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909990129862       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909989642396       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909989417860       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 4.119551e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909961859830       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909965366944       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909967655279       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909970155526       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909968783080       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909969524781       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909971441294       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909972488630       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909972439543       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909972425710       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909972654521       residual = 8.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.350701e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909961859830       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909963213038       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909964363087       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909965018908       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909964468871       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909964820671       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909965065496       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909965304865       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909965303705       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.081191e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.012589 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2062e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.081312e-01 1 1  ON 0
 uu_1                 1.432726e-01 1 1  ON 1
 uu_2                 4.622155e-02 1 1  ON 2
 uu_3                -1.606221e-02 1 1  ON 3
 uu_4                -6.457321e-02 1 1  ON 4
 uu_5                -9.954188e-02 1 1  ON 5
 uu_6                -1.260090e-01 1 1  ON 6
 uu_7                -1.376125e-01 1 1  ON 7
 uu_8                -1.286144e-01 1 1  ON 8
 uu_9                -9.923149e-02 1 1  ON 9
 ud_0                 4.311701e-01 1 1  ON 10
 ud_1                 1.746030e-01 1 1  ON 11
 ud_2                 6.154660e-02 1 1  ON 12
 ud_3                -6.290659e-03 1 1  ON 13
 ud_4                -6.061069e-02 1 1  ON 14
 ud_5                -1.019713e-01 1 1  ON 15
 ud_6                -1.302875e-01 1 1  ON 16
 ud_7                -1.483509e-01 1 1  ON 17
 ud_8                -1.510861e-01 1 1  ON 18
 ud_9                -1.404002e-01 1 1  ON 19
 eO_0                -7.461030e-01 1 1  ON 20
 eO_1                -4.317389e-01 1 1  ON 21
 eO_2                -1.707119e-02 1 1  ON 22
 eO_3                 2.980199e-01 1 1  ON 23
 eO_4                 5.148528e-01 1 1  ON 24
 eO_5                 4.698120e-01 1 1  ON 25
 eO_6                 2.399555e-01 1 1  ON 26
 eO_7                -5.228007e-02 1 1  ON 27
 eO_8                -2.086869e-01 1 1  ON 28
 eO_9                -6.819267e-02 1 1  ON 29
eH1_0                -2.426536e-01 1 1  ON 30
eH1_1                -1.381422e-01 1 1  ON 31
eH1_2                -9.544669e-02 1 1  ON 32
eH1_3                -4.409802e-02 1 1  ON 33
eH1_4                 1.210387e-02 1 1  ON 34
eH1_5                 4.930395e-02 1 1  ON 35
eH1_6                 1.062445e-01 1 1  ON 36
eH1_7                 1.528545e-01 1 1  ON 37
eH1_8                 1.616222e-01 1 1  ON 38
eH1_9                 4.379332e-02 1 1  ON 39
eH2_0                -2.410475e-01 1 1  ON 40
eH2_1                -1.365885e-01 1 1  ON 41
eH2_2                -9.345129e-02 1 1  ON 42
eH2_3                -4.224631e-02 1 1  ON 43
eH2_4                 1.457516e-02 1 1  ON 44
eH2_5                 5.194465e-02 1 1  ON 45
eH2_6                 1.094833e-01 1 1  ON 46
eH2_7                 1.556261e-01 1 1  ON 47
eH2_8                 1.691917e-01 1 1  ON 48
eH2_9                 3.007759e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9242
    reference variance = 0.223344
====================================================
  Execution time = 2.5106e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4720e-01
  Total weights = 2.0000e+06
  Execution time = 2.9836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346661426328
                                         uncertainty =       0.009427633314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346661426328
                                         uncertainty =       0.009427633314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416307567
  error estimate for blocks of size 2^( 2) =       0.000428025585
  error estimate for blocks of size 2^( 3) =       0.000440720278
  error estimate for blocks of size 2^( 4) =       0.000452341276
  error estimate for blocks of size 2^( 5) =       0.000463880792
  error estimate for blocks of size 2^( 6) =       0.000473559652
  error estimate for blocks of size 2^( 7) =       0.000479811893

      target function =                  N/A
              le_mean =     -16.910620481969
             les_mean =     286.315708892360
             stat err =       0.000467398403
             autocorr =       1.260508675286
              std dev =       0.588747807187
             le_variance =       0.346623980468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347919367182
                                         uncertainty =       0.009498709710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347919367182
                                         uncertainty =       0.009498709710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417062368
  error estimate for blocks of size 2^( 2) =       0.000428739976
  error estimate for blocks of size 2^( 3) =       0.000441383730
  error estimate for blocks of size 2^( 4) =       0.000452954178
  error estimate for blocks of size 2^( 5) =       0.000464447852
  error estimate for blocks of size 2^( 6) =       0.000474112343
  error estimate for blocks of size 2^( 7) =       0.000480315162

      target function =                  N/A
              le_mean =     -16.910607713518
             les_mean =     286.316535103633
             stat err =       0.000467957384
             autocorr =       1.258956137856
              std dev =       0.589815256746
             le_variance =       0.347882037090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347848771690
                                         uncertainty =       0.009505817196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347848771690
                                         uncertainty =       0.009505817196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417020072
  error estimate for blocks of size 2^( 2) =       0.000428697871
  error estimate for blocks of size 2^( 3) =       0.000441348218
  error estimate for blocks of size 2^( 4) =       0.000452928001
  error estimate for blocks of size 2^( 5) =       0.000464431964
  error estimate for blocks of size 2^( 6) =       0.000474099719
  error estimate for blocks of size 2^( 7) =       0.000480298542

      target function =                  N/A
              le_mean =     -16.910610067553
             les_mean =     286.316544164396
             stat err =       0.000467939556
             autocorr =       1.259115585169
              std dev =       0.589755442078
             le_variance =       0.347811481461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346857158641
                                         uncertainty =       0.009443243964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346857158641
                                         uncertainty =       0.009443243964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416425116
  error estimate for blocks of size 2^( 2) =       0.000428134919
  error estimate for blocks of size 2^( 3) =       0.000440821570
  error estimate for blocks of size 2^( 4) =       0.000452435531
  error estimate for blocks of size 2^( 5) =       0.000463969748
  error estimate for blocks of size 2^( 6) =       0.000473647488
  error estimate for blocks of size 2^( 7) =       0.000479888792

      target function =                  N/A
              le_mean =     -16.910616764832
             les_mean =     286.315778947501
             stat err =       0.000467485390
             autocorr =       1.260266101732
              std dev =       0.588914046270
             le_variance =       0.346819753894


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910620481969        initial  <--
     6.2500e-02     6.2500e-01             4.1196e-03       -16.910607713518
     2.5000e-01     2.5000e+00             1.3507e-03       -16.910610067553
     1.0000e+00     1.0000e+01             4.0812e-04       -16.910616764832

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.9902
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.083413e-01 1 1  ON 0
 uu_1                 1.433305e-01 1 1  ON 1
 uu_2                 4.594837e-02 1 1  ON 2
 uu_3                -1.645002e-02 1 1  ON 3
 uu_4                -6.459432e-02 1 1  ON 4
 uu_5                -9.948424e-02 1 1  ON 5
 uu_6                -1.259918e-01 1 1  ON 6
 uu_7                -1.374068e-01 1 1  ON 7
 uu_8                -1.280332e-01 1 1  ON 8
 uu_9                -9.868774e-02 1 1  ON 9
 ud_0                 4.299995e-01 1 1  ON 10
 ud_1                 1.739154e-01 1 1  ON 11
 ud_2                 6.147378e-02 1 1  ON 12
 ud_3                -5.768135e-03 1 1  ON 13
 ud_4                -6.032754e-02 1 1  ON 14
 ud_5                -1.019287e-01 1 1  ON 15
 ud_6                -1.303287e-01 1 1  ON 16
 ud_7                -1.483116e-01 1 1  ON 17
 ud_8                -1.506945e-01 1 1  ON 18
 ud_9                -1.399403e-01 1 1  ON 19
 eO_0                -7.447523e-01 1 1  ON 20
 eO_1                -4.307207e-01 1 1  ON 21
 eO_2                -1.730496e-02 1 1  ON 22
 eO_3                 2.968261e-01 1 1  ON 23
 eO_4                 5.139105e-01 1 1  ON 24
 eO_5                 4.690035e-01 1 1  ON 25
 eO_6                 2.394774e-01 1 1  ON 26
 eO_7                -5.251419e-02 1 1  ON 27
 eO_8                -2.078451e-01 1 1  ON 28
 eO_9                -6.756789e-02 1 1  ON 29
eH1_0                -2.415573e-01 1 1  ON 30
eH1_1                -1.378534e-01 1 1  ON 31
eH1_2                -9.480003e-02 1 1  ON 32
eH1_3                -4.327680e-02 1 1  ON 33
eH1_4                 1.242155e-02 1 1  ON 34
eH1_5                 4.931117e-02 1 1  ON 35
eH1_6                 1.056364e-01 1 1  ON 36
eH1_7                 1.520245e-01 1 1  ON 37
eH1_8                 1.606304e-01 1 1  ON 38
eH1_9                 4.312320e-02 1 1  ON 39
eH2_0                -2.404412e-01 1 1  ON 40
eH2_1                -1.362557e-01 1 1  ON 41
eH2_2                -9.319327e-02 1 1  ON 42
eH2_3                -4.169410e-02 1 1  ON 43
eH2_4                 1.458165e-02 1 1  ON 44
eH2_5                 5.187472e-02 1 1  ON 45
eH2_6                 1.090816e-01 1 1  ON 46
eH2_7                 1.556612e-01 1 1  ON 47
eH2_8                 1.686293e-01 1 1  ON 48
eH2_9                 2.924405e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2061e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6942e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8894
    reference variance = 0.184653
====================================================
  Execution time = 2.5390e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3957e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6980e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339673093979
                                         uncertainty =       0.010691913809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339673093979
                                         uncertainty =       0.010691913809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412049023
  error estimate for blocks of size 2^( 2) =       0.000423902039
  error estimate for blocks of size 2^( 3) =       0.000436310902
  error estimate for blocks of size 2^( 4) =       0.000447332831
  error estimate for blocks of size 2^( 5) =       0.000457389145
  error estimate for blocks of size 2^( 6) =       0.000465572652
  error estimate for blocks of size 2^( 7) =       0.000472373640

      target function =                  N/A
              le_mean =     -16.910712861629
             les_mean =     286.311778113135
             stat err =       0.000460667067
             autocorr =       1.249903701026
              std dev =       0.582725316462
             le_variance =       0.339568794445


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691071286163e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910712861629       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910716686206       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910718515266       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910719336680       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910719360521       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910719622760       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910719472897       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910720129493       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910720095190       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910720063119       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 6.274615e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910712861629       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910714032786       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910714729509       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910715004554       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910715023002       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910715095234       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910714987507       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910715114948       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910715086102       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.918033e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910712861629       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910713171859       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910713370077       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910713447674       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910713457814       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910713474046       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910713443075       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910713470846       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910713460945       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 5.044402e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015853 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2100e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.083015e-01 1 1  ON 0
 uu_1                 1.433029e-01 1 1  ON 1
 uu_2                 4.595069e-02 1 1  ON 2
 uu_3                -1.636892e-02 1 1  ON 3
 uu_4                -6.454552e-02 1 1  ON 4
 uu_5                -9.947398e-02 1 1  ON 5
 uu_6                -1.259688e-01 1 1  ON 6
 uu_7                -1.374617e-01 1 1  ON 7
 uu_8                -1.281100e-01 1 1  ON 8
 uu_9                -9.873649e-02 1 1  ON 9
 ud_0                 4.301913e-01 1 1  ON 10
 ud_1                 1.740278e-01 1 1  ON 11
 ud_2                 6.142287e-02 1 1  ON 12
 ud_3                -5.870252e-03 1 1  ON 13
 ud_4                -6.036272e-02 1 1  ON 14
 ud_5                -1.019585e-01 1 1  ON 15
 ud_6                -1.303581e-01 1 1  ON 16
 ud_7                -1.483315e-01 1 1  ON 17
 ud_8                -1.507585e-01 1 1  ON 18
 ud_9                -1.399473e-01 1 1  ON 19
 eO_0                -7.449136e-01 1 1  ON 20
 eO_1                -4.308358e-01 1 1  ON 21
 eO_2                -1.720663e-02 1 1  ON 22
 eO_3                 2.969773e-01 1 1  ON 23
 eO_4                 5.139955e-01 1 1  ON 24
 eO_5                 4.690305e-01 1 1  ON 25
 eO_6                 2.395108e-01 1 1  ON 26
 eO_7                -5.250991e-02 1 1  ON 27
 eO_8                -2.079165e-01 1 1  ON 28
 eO_9                -6.761698e-02 1 1  ON 29
eH1_0                -2.416462e-01 1 1  ON 30
eH1_1                -1.378916e-01 1 1  ON 31
eH1_2                -9.484131e-02 1 1  ON 32
eH1_3                -4.334728e-02 1 1  ON 33
eH1_4                 1.239409e-02 1 1  ON 34
eH1_5                 4.929204e-02 1 1  ON 35
eH1_6                 1.057050e-01 1 1  ON 36
eH1_7                 1.520979e-01 1 1  ON 37
eH1_8                 1.607034e-01 1 1  ON 38
eH1_9                 4.319077e-02 1 1  ON 39
eH2_0                -2.405283e-01 1 1  ON 40
eH2_1                -1.363060e-01 1 1  ON 41
eH2_2                -9.323265e-02 1 1  ON 42
eH2_3                -4.172111e-02 1 1  ON 43
eH2_4                 1.460115e-02 1 1  ON 44
eH2_5                 5.185902e-02 1 1  ON 45
eH2_6                 1.090649e-01 1 1  ON 46
eH2_7                 1.556760e-01 1 1  ON 47
eH2_8                 1.687152e-01 1 1  ON 48
eH2_9                 2.935003e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9395
    reference variance = 0.185388
====================================================
  Execution time = 2.4872e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3583e-01
  Total weights = 2.0000e+06
  Execution time = 3.0025e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335800737529
                                         uncertainty =       0.007389909536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335800737529
                                         uncertainty =       0.007389909536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409703346
  error estimate for blocks of size 2^( 2) =       0.000421613215
  error estimate for blocks of size 2^( 3) =       0.000434484405
  error estimate for blocks of size 2^( 4) =       0.000446685893
  error estimate for blocks of size 2^( 5) =       0.000457731475
  error estimate for blocks of size 2^( 6) =       0.000466811612
  error estimate for blocks of size 2^( 7) =       0.000472202792

      target function =                  N/A
              le_mean =     -16.910768543936
             les_mean =     286.309806241680
             stat err =       0.000460857943
             autocorr =       1.265304733275
              std dev =       0.579408028052
             le_variance =       0.335713662971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336158845916
                                         uncertainty =       0.007394505197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336158845916
                                         uncertainty =       0.007394505197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409921785
  error estimate for blocks of size 2^( 2) =       0.000421816636
  error estimate for blocks of size 2^( 3) =       0.000434673325
  error estimate for blocks of size 2^( 4) =       0.000446859171
  error estimate for blocks of size 2^( 5) =       0.000457888621
  error estimate for blocks of size 2^( 6) =       0.000466950360
  error estimate for blocks of size 2^( 7) =       0.000472328507

      target function =                  N/A
              le_mean =     -16.910771139625
             les_mean =     286.310252109015
             stat err =       0.000461006665
             autocorr =       1.264772485687
              std dev =       0.579716948418
             le_variance =       0.336071740283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336034313188
                                         uncertainty =       0.007393174221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336034313188
                                         uncertainty =       0.007393174221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409845833
  error estimate for blocks of size 2^( 2) =       0.000421745398
  error estimate for blocks of size 2^( 3) =       0.000434607063
  error estimate for blocks of size 2^( 4) =       0.000446798567
  error estimate for blocks of size 2^( 5) =       0.000457833845
  error estimate for blocks of size 2^( 6) =       0.000466901866
  error estimate for blocks of size 2^( 7) =       0.000472285475

      target function =                  N/A
              le_mean =     -16.910769933778
             les_mean =     286.310086799045
             stat err =       0.000460954938
             autocorr =       1.264957388915
              std dev =       0.579609535686
             le_variance =       0.335947213859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335831798366
                                         uncertainty =       0.007390362413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335831798366
                                         uncertainty =       0.007390362413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409722296
  error estimate for blocks of size 2^( 2) =       0.000421630737
  error estimate for blocks of size 2^( 3) =       0.000434500623
  error estimate for blocks of size 2^( 4) =       0.000446700758
  error estimate for blocks of size 2^( 5) =       0.000457744942
  error estimate for blocks of size 2^( 6) =       0.000466823444
  error estimate for blocks of size 2^( 7) =       0.000472213656

      target function =                  N/A
              le_mean =     -16.910768677054
             les_mean =     286.309841801422
             stat err =       0.000460870700
             autocorr =       1.265257733809
              std dev =       0.579434828499
             le_variance =       0.335744720477


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910768543936        initial
     6.2500e-01     6.2500e+00             6.2746e-04       -16.910771139625  <--
     2.5000e+00     2.5000e+01             1.9180e-04       -16.910769933778
     1.0000e+01     1.0000e+02             5.0444e-05       -16.910768677054

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.9800e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.082100e-01 1 1  ON 0
 uu_1                 1.432608e-01 1 1  ON 1
 uu_2                 4.596987e-02 1 1  ON 2
 uu_3                -1.620620e-02 1 1  ON 3
 uu_4                -6.441059e-02 1 1  ON 4
 uu_5                -9.943257e-02 1 1  ON 5
 uu_6                -1.259197e-01 1 1  ON 6
 uu_7                -1.376086e-01 1 1  ON 7
 uu_8                -1.283325e-01 1 1  ON 8
 uu_9                -9.888419e-02 1 1  ON 9
 ud_0                 4.306270e-01 1 1  ON 10
 ud_1                 1.742858e-01 1 1  ON 11
 ud_2                 6.136649e-02 1 1  ON 12
 ud_3                -6.094580e-03 1 1  ON 13
 ud_4                -6.048114e-02 1 1  ON 14
 ud_5                -1.020291e-01 1 1  ON 15
 ud_6                -1.304361e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509340e-01 1 1  ON 18
 ud_9                -1.399664e-01 1 1  ON 19
 eO_0                -7.453525e-01 1 1  ON 20
 eO_1                -4.311321e-01 1 1  ON 21
 eO_2                -1.701203e-02 1 1  ON 22
 eO_3                 2.974002e-01 1 1  ON 23
 eO_4                 5.142732e-01 1 1  ON 24
 eO_5                 4.691232e-01 1 1  ON 25
 eO_6                 2.396086e-01 1 1  ON 26
 eO_7                -5.249497e-02 1 1  ON 27
 eO_8                -2.081281e-01 1 1  ON 28
 eO_9                -6.776341e-02 1 1  ON 29
eH1_0                -2.418984e-01 1 1  ON 30
eH1_1                -1.380302e-01 1 1  ON 31
eH1_2                -9.497405e-02 1 1  ON 32
eH1_3                -4.353375e-02 1 1  ON 33
eH1_4                 1.229551e-02 1 1  ON 34
eH1_5                 4.924310e-02 1 1  ON 35
eH1_6                 1.059105e-01 1 1  ON 36
eH1_7                 1.523195e-01 1 1  ON 37
eH1_8                 1.609236e-01 1 1  ON 38
eH1_9                 4.339288e-02 1 1  ON 39
eH2_0                -2.407730e-01 1 1  ON 40
eH2_1                -1.364515e-01 1 1  ON 41
eH2_2                -9.334395e-02 1 1  ON 42
eH2_3                -4.180797e-02 1 1  ON 43
eH2_4                 1.462503e-02 1 1  ON 44
eH2_5                 5.182347e-02 1 1  ON 45
eH2_6                 1.090212e-01 1 1  ON 46
eH2_7                 1.557198e-01 1 1  ON 47
eH2_8                 1.689700e-01 1 1  ON 48
eH2_9                 2.966556e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1908e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6933e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9901
    reference variance = 0.346711
====================================================
  Execution time = 2.5384e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3404e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334066796483
                                         uncertainty =       0.007691516762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334066796483
                                         uncertainty =       0.007691516762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408680256
  error estimate for blocks of size 2^( 2) =       0.000420833149
  error estimate for blocks of size 2^( 3) =       0.000433253551
  error estimate for blocks of size 2^( 4) =       0.000444710558
  error estimate for blocks of size 2^( 5) =       0.000454220843
  error estimate for blocks of size 2^( 6) =       0.000462821038
  error estimate for blocks of size 2^( 7) =       0.000464929472

      target function =                  N/A
              le_mean =     -16.910203829844
             les_mean =     286.289032502611
             stat err =       0.000456670478
             autocorr =       1.248643788078
              std dev =       0.577961160255
             le_variance =       0.334039102763


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691020382984e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910203829844       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910205747380       residual = 8.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910208995036       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910211556817       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910211175811       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910212836431       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910214392040       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910213753308       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910213628554       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910213709906       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910213686322       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910213699837       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.628592e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910203829844       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910204658102       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910206346336       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910207203480       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910206918742       residual = 9.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910207286976       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910207549145       residual = 8.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910207439373       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910207353692       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910207397296       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 5.462689e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910203829844       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910204082960       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910204653440       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910204803756       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910204868268       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910204861659       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910204911220       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910204874818       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910204867731       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.550405e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.019810 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2013e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.081223e-01 1 1  ON 0
 uu_1                 1.432501e-01 1 1  ON 1
 uu_2                 4.598599e-02 1 1  ON 2
 uu_3                -1.605299e-02 1 1  ON 3
 uu_4                -6.427469e-02 1 1  ON 4
 uu_5                -9.947212e-02 1 1  ON 5
 uu_6                -1.259388e-01 1 1  ON 6
 uu_7                -1.376819e-01 1 1  ON 7
 uu_8                -1.285612e-01 1 1  ON 8
 uu_9                -9.901930e-02 1 1  ON 9
 ud_0                 4.310959e-01 1 1  ON 10
 ud_1                 1.745969e-01 1 1  ON 11
 ud_2                 6.140552e-02 1 1  ON 12
 ud_3                -6.202392e-03 1 1  ON 13
 ud_4                -6.054498e-02 1 1  ON 14
 ud_5                -1.020545e-01 1 1  ON 15
 ud_6                -1.305661e-01 1 1  ON 16
 ud_7                -1.483665e-01 1 1  ON 17
 ud_8                -1.510891e-01 1 1  ON 18
 ud_9                -1.401321e-01 1 1  ON 19
 eO_0                -7.458988e-01 1 1  ON 20
 eO_1                -4.313497e-01 1 1  ON 21
 eO_2                -1.683481e-02 1 1  ON 22
 eO_3                 2.977230e-01 1 1  ON 23
 eO_4                 5.145386e-01 1 1  ON 24
 eO_5                 4.693436e-01 1 1  ON 25
 eO_6                 2.398662e-01 1 1  ON 26
 eO_7                -5.237273e-02 1 1  ON 27
 eO_8                -2.084339e-01 1 1  ON 28
 eO_9                -6.801647e-02 1 1  ON 29
eH1_0                -2.422813e-01 1 1  ON 30
eH1_1                -1.382980e-01 1 1  ON 31
eH1_2                -9.525982e-02 1 1  ON 32
eH1_3                -4.376410e-02 1 1  ON 33
eH1_4                 1.231713e-02 1 1  ON 34
eH1_5                 4.937237e-02 1 1  ON 35
eH1_6                 1.061314e-01 1 1  ON 36
eH1_7                 1.524482e-01 1 1  ON 37
eH1_8                 1.612516e-01 1 1  ON 38
eH1_9                 4.373945e-02 1 1  ON 39
eH2_0                -2.412216e-01 1 1  ON 40
eH2_1                -1.365226e-01 1 1  ON 41
eH2_2                -9.344568e-02 1 1  ON 42
eH2_3                -4.200960e-02 1 1  ON 43
eH2_4                 1.451925e-02 1 1  ON 44
eH2_5                 5.181514e-02 1 1  ON 45
eH2_6                 1.091763e-01 1 1  ON 46
eH2_7                 1.558030e-01 1 1  ON 47
eH2_8                 1.692661e-01 1 1  ON 48
eH2_9                 3.005608e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8324
    reference variance = 0.18823
====================================================
  Execution time = 2.4872e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3013e-01
  Total weights = 2.0000e+06
  Execution time = 2.9944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329939152499
                                         uncertainty =       0.004034753654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329939152499
                                         uncertainty =       0.004034753654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406140694
  error estimate for blocks of size 2^( 2) =       0.000418387541
  error estimate for blocks of size 2^( 3) =       0.000431861290
  error estimate for blocks of size 2^( 4) =       0.000444578456
  error estimate for blocks of size 2^( 5) =       0.000456544981
  error estimate for blocks of size 2^( 6) =       0.000464213602
  error estimate for blocks of size 2^( 7) =       0.000468723235

      target function =                  N/A
              le_mean =     -16.909749244492
             les_mean =     286.269519873841
             stat err =       0.000458515069
             autocorr =       1.274542178219
              std dev =       0.574369678176
             le_variance =       0.329900527208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330556154122
                                         uncertainty =       0.004041343008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330556154122
                                         uncertainty =       0.004041343008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406520354
  error estimate for blocks of size 2^( 2) =       0.000418748716
  error estimate for blocks of size 2^( 3) =       0.000432198971
  error estimate for blocks of size 2^( 4) =       0.000444887506
  error estimate for blocks of size 2^( 5) =       0.000456829982
  error estimate for blocks of size 2^( 6) =       0.000464484885
  error estimate for blocks of size 2^( 7) =       0.000468985341

      target function =                  N/A
              le_mean =     -16.909744729147
             les_mean =     286.269984235440
             stat err =       0.000458796929
             autocorr =       1.273727174132
              std dev =       0.574906597438
             le_variance =       0.330517595778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330403270859
                                         uncertainty =       0.004039851450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330403270859
                                         uncertainty =       0.004039851450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406426316
  error estimate for blocks of size 2^( 2) =       0.000418658077
  error estimate for blocks of size 2^( 3) =       0.000432114619
  error estimate for blocks of size 2^( 4) =       0.000444811547
  error estimate for blocks of size 2^( 5) =       0.000456759578
  error estimate for blocks of size 2^( 6) =       0.000464419058
  error estimate for blocks of size 2^( 7) =       0.000468923175

      target function =                  N/A
              le_mean =     -16.909745353543
             les_mean =     286.269852457451
             stat err =       0.000458728340
             autocorr =       1.273935676842
              std dev =       0.574773608458
             le_variance =       0.330364700980

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330012457152
                                         uncertainty =       0.004035613583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330012457152
                                         uncertainty =       0.004035613583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406185819
  error estimate for blocks of size 2^( 2) =       0.000418430023
  error estimate for blocks of size 2^( 3) =       0.000431900983
  error estimate for blocks of size 2^( 4) =       0.000444615035
  error estimate for blocks of size 2^( 5) =       0.000456578622
  error estimate for blocks of size 2^( 6) =       0.000464245856
  error estimate for blocks of size 2^( 7) =       0.000468754680

      target function =                  N/A
              le_mean =     -16.909748431714
             les_mean =     286.269565698144
             stat err =       0.000458548548
             autocorr =       1.274445097671
              std dev =       0.574433494203
             le_variance =       0.329973839262


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909749244492        initial  <--
     1.5625e-01     1.5625e+00             1.6286e-03       -16.909744729147
     6.2500e-01     6.2500e+00             5.4627e-04       -16.909745353543
     2.5000e+00     2.5000e+01             1.5504e-04       -16.909748431714

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.8143
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.082100e-01 1 1  ON 0
 uu_1                 1.432608e-01 1 1  ON 1
 uu_2                 4.596987e-02 1 1  ON 2
 uu_3                -1.620620e-02 1 1  ON 3
 uu_4                -6.441059e-02 1 1  ON 4
 uu_5                -9.943257e-02 1 1  ON 5
 uu_6                -1.259197e-01 1 1  ON 6
 uu_7                -1.376086e-01 1 1  ON 7
 uu_8                -1.283325e-01 1 1  ON 8
 uu_9                -9.888419e-02 1 1  ON 9
 ud_0                 4.306270e-01 1 1  ON 10
 ud_1                 1.742858e-01 1 1  ON 11
 ud_2                 6.136649e-02 1 1  ON 12
 ud_3                -6.094580e-03 1 1  ON 13
 ud_4                -6.048114e-02 1 1  ON 14
 ud_5                -1.020291e-01 1 1  ON 15
 ud_6                -1.304361e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509340e-01 1 1  ON 18
 ud_9                -1.399664e-01 1 1  ON 19
 eO_0                -7.453525e-01 1 1  ON 20
 eO_1                -4.311321e-01 1 1  ON 21
 eO_2                -1.701203e-02 1 1  ON 22
 eO_3                 2.974002e-01 1 1  ON 23
 eO_4                 5.142732e-01 1 1  ON 24
 eO_5                 4.691232e-01 1 1  ON 25
 eO_6                 2.396086e-01 1 1  ON 26
 eO_7                -5.249497e-02 1 1  ON 27
 eO_8                -2.081281e-01 1 1  ON 28
 eO_9                -6.776341e-02 1 1  ON 29
eH1_0                -2.418984e-01 1 1  ON 30
eH1_1                -1.380302e-01 1 1  ON 31
eH1_2                -9.497405e-02 1 1  ON 32
eH1_3                -4.353375e-02 1 1  ON 33
eH1_4                 1.229551e-02 1 1  ON 34
eH1_5                 4.924310e-02 1 1  ON 35
eH1_6                 1.059105e-01 1 1  ON 36
eH1_7                 1.523195e-01 1 1  ON 37
eH1_8                 1.609236e-01 1 1  ON 38
eH1_9                 4.339288e-02 1 1  ON 39
eH2_0                -2.407730e-01 1 1  ON 40
eH2_1                -1.364515e-01 1 1  ON 41
eH2_2                -9.334395e-02 1 1  ON 42
eH2_3                -4.180797e-02 1 1  ON 43
eH2_4                 1.462503e-02 1 1  ON 44
eH2_5                 5.182347e-02 1 1  ON 45
eH2_6                 1.090212e-01 1 1  ON 46
eH2_7                 1.557198e-01 1 1  ON 47
eH2_8                 1.689700e-01 1 1  ON 48
eH2_9                 2.966556e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1836e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9631
    reference variance = 0.266383
====================================================
  Execution time = 2.5298e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4012e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6795e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340159323038
                                         uncertainty =       0.006666434685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340159323038
                                         uncertainty =       0.006666434685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412384659
  error estimate for blocks of size 2^( 2) =       0.000423783559
  error estimate for blocks of size 2^( 3) =       0.000436069674
  error estimate for blocks of size 2^( 4) =       0.000447635660
  error estimate for blocks of size 2^( 5) =       0.000457293757
  error estimate for blocks of size 2^( 6) =       0.000465556055
  error estimate for blocks of size 2^( 7) =       0.000473184989

      target function =                  N/A
              le_mean =     -16.910816317428
             les_mean =     286.315830565156
             stat err =       0.000460917615
             autocorr =       1.249227715238
              std dev =       0.583199977231
             le_variance =       0.340122213443


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691081631743e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910816317428       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910817370096       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910817881862       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910817961542       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910818229098       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910818638259       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910818814486       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910818844415       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910818771072       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 2.560950e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910816317428       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910816609917       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910816758943       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910816775535       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910816850525       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910816936598       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910816982941       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910816993789       residual = 9.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 6.724866e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910816317428       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910816392645       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910816431512       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910816435499       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910816454798       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910816474945       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910816486734       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910816489679       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.702480e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022645 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1991e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.081925e-01 1 1  ON 0
 uu_1                 1.432563e-01 1 1  ON 1
 uu_2                 4.598759e-02 1 1  ON 2
 uu_3                -1.617300e-02 1 1  ON 3
 uu_4                -6.439759e-02 1 1  ON 4
 uu_5                -9.943128e-02 1 1  ON 5
 uu_6                -1.259288e-01 1 1  ON 6
 uu_7                -1.376240e-01 1 1  ON 7
 uu_8                -1.283698e-01 1 1  ON 8
 uu_9                -9.890541e-02 1 1  ON 9
 ud_0                 4.306598e-01 1 1  ON 10
 ud_1                 1.743351e-01 1 1  ON 11
 ud_2                 6.136458e-02 1 1  ON 12
 ud_3                -6.131578e-03 1 1  ON 13
 ud_4                -6.049201e-02 1 1  ON 14
 ud_5                -1.020274e-01 1 1  ON 15
 ud_6                -1.304368e-01 1 1  ON 16
 ud_7                -1.483853e-01 1 1  ON 17
 ud_8                -1.509451e-01 1 1  ON 18
 ud_9                -1.399779e-01 1 1  ON 19
 eO_0                -7.454198e-01 1 1  ON 20
 eO_1                -4.311676e-01 1 1  ON 21
 eO_2                -1.699434e-02 1 1  ON 22
 eO_3                 2.974618e-01 1 1  ON 23
 eO_4                 5.143124e-01 1 1  ON 24
 eO_5                 4.691417e-01 1 1  ON 25
 eO_6                 2.396207e-01 1 1  ON 26
 eO_7                -5.248484e-02 1 1  ON 27
 eO_8                -2.081582e-01 1 1  ON 28
 eO_9                -6.778758e-02 1 1  ON 29
eH1_0                -2.419352e-01 1 1  ON 30
eH1_1                -1.380452e-01 1 1  ON 31
eH1_2                -9.500630e-02 1 1  ON 32
eH1_3                -4.356416e-02 1 1  ON 33
eH1_4                 1.229056e-02 1 1  ON 34
eH1_5                 4.924859e-02 1 1  ON 35
eH1_6                 1.059184e-01 1 1  ON 36
eH1_7                 1.523461e-01 1 1  ON 37
eH1_8                 1.609691e-01 1 1  ON 38
eH1_9                 4.342523e-02 1 1  ON 39
eH2_0                -2.408217e-01 1 1  ON 40
eH2_1                -1.364576e-01 1 1  ON 41
eH2_2                -9.334622e-02 1 1  ON 42
eH2_3                -4.181928e-02 1 1  ON 43
eH2_4                 1.463805e-02 1 1  ON 44
eH2_5                 5.181892e-02 1 1  ON 45
eH2_6                 1.090250e-01 1 1  ON 46
eH2_7                 1.557364e-01 1 1  ON 47
eH2_8                 1.689892e-01 1 1  ON 48
eH2_9                 2.968866e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.967
    reference variance = 0.298302
====================================================
  Execution time = 2.7373e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2785e-01
  Total weights = 2.0000e+06
  Execution time = 2.9867e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327931340397
                                         uncertainty =       0.003474183306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327931340397
                                         uncertainty =       0.003474183306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404875014
  error estimate for blocks of size 2^( 2) =       0.000416570412
  error estimate for blocks of size 2^( 3) =       0.000429289475
  error estimate for blocks of size 2^( 4) =       0.000441316416
  error estimate for blocks of size 2^( 5) =       0.000451718152
  error estimate for blocks of size 2^( 6) =       0.000460227640
  error estimate for blocks of size 2^( 7) =       0.000463004046

      target function =                  N/A
              le_mean =     -16.910464664081
             les_mean =     286.291662544581
             stat err =       0.000454066563
             autocorr =       1.257758014300
              std dev =       0.572579735381
             le_variance =       0.327847553369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327950181057
                                         uncertainty =       0.003473116757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327950181057
                                         uncertainty =       0.003473116757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404886658
  error estimate for blocks of size 2^( 2) =       0.000416579561
  error estimate for blocks of size 2^( 3) =       0.000429294801
  error estimate for blocks of size 2^( 4) =       0.000441318218
  error estimate for blocks of size 2^( 5) =       0.000451718205
  error estimate for blocks of size 2^( 6) =       0.000460227932
  error estimate for blocks of size 2^( 7) =       0.000463004693

      target function =                  N/A
              le_mean =     -16.910463647048
             les_mean =     286.291647006358
             stat err =       0.000454067262
             autocorr =       1.257689539805
              std dev =       0.572596203405
             le_variance =       0.327866412154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327933463924
                                         uncertainty =       0.003473435928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327933463924
                                         uncertainty =       0.003473435928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404876333
  error estimate for blocks of size 2^( 2) =       0.000416570531
  error estimate for blocks of size 2^( 3) =       0.000429287709
  error estimate for blocks of size 2^( 4) =       0.000441312922
  error estimate for blocks of size 2^( 5) =       0.000451713927
  error estimate for blocks of size 2^( 6) =       0.000460223967
  error estimate for blocks of size 2^( 7) =       0.000463000726

      target function =                  N/A
              le_mean =     -16.910464040070
             les_mean =     286.291643577069
             stat err =       0.000454062886
             autocorr =       1.257729441252
              std dev =       0.572581601595
             le_variance =       0.327849690486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327931249994
                                         uncertainty =       0.003474080747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327931249994
                                         uncertainty =       0.003474080747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404874959
  error estimate for blocks of size 2^( 2) =       0.000416570206
  error estimate for blocks of size 2^( 3) =       0.000429289036
  error estimate for blocks of size 2^( 4) =       0.000441315760
  error estimate for blocks of size 2^( 5) =       0.000451717410
  error estimate for blocks of size 2^( 6) =       0.000460226980
  error estimate for blocks of size 2^( 7) =       0.000463003434

      target function =                  N/A
              le_mean =     -16.910464575792
             les_mean =     286.291659469932
             stat err =       0.000454065896
             autocorr =       1.257754659533
              std dev =       0.572579657981
             le_variance =       0.327847464734


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910464664081        initial  <--
     1.5625e+00     1.5625e+01             2.5610e-04       -16.910463647048
     6.2500e+00     6.2500e+01             6.7249e-05       -16.910464040070
     2.5000e+01     2.5000e+02             1.7025e-05       -16.910464575792

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2681
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.082100e-01 1 1  ON 0
 uu_1                 1.432608e-01 1 1  ON 1
 uu_2                 4.596987e-02 1 1  ON 2
 uu_3                -1.620620e-02 1 1  ON 3
 uu_4                -6.441059e-02 1 1  ON 4
 uu_5                -9.943257e-02 1 1  ON 5
 uu_6                -1.259197e-01 1 1  ON 6
 uu_7                -1.376086e-01 1 1  ON 7
 uu_8                -1.283325e-01 1 1  ON 8
 uu_9                -9.888419e-02 1 1  ON 9
 ud_0                 4.306270e-01 1 1  ON 10
 ud_1                 1.742858e-01 1 1  ON 11
 ud_2                 6.136649e-02 1 1  ON 12
 ud_3                -6.094580e-03 1 1  ON 13
 ud_4                -6.048114e-02 1 1  ON 14
 ud_5                -1.020291e-01 1 1  ON 15
 ud_6                -1.304361e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509340e-01 1 1  ON 18
 ud_9                -1.399664e-01 1 1  ON 19
 eO_0                -7.453525e-01 1 1  ON 20
 eO_1                -4.311321e-01 1 1  ON 21
 eO_2                -1.701203e-02 1 1  ON 22
 eO_3                 2.974002e-01 1 1  ON 23
 eO_4                 5.142732e-01 1 1  ON 24
 eO_5                 4.691232e-01 1 1  ON 25
 eO_6                 2.396086e-01 1 1  ON 26
 eO_7                -5.249497e-02 1 1  ON 27
 eO_8                -2.081281e-01 1 1  ON 28
 eO_9                -6.776341e-02 1 1  ON 29
eH1_0                -2.418984e-01 1 1  ON 30
eH1_1                -1.380302e-01 1 1  ON 31
eH1_2                -9.497405e-02 1 1  ON 32
eH1_3                -4.353375e-02 1 1  ON 33
eH1_4                 1.229551e-02 1 1  ON 34
eH1_5                 4.924310e-02 1 1  ON 35
eH1_6                 1.059105e-01 1 1  ON 36
eH1_7                 1.523195e-01 1 1  ON 37
eH1_8                 1.609236e-01 1 1  ON 38
eH1_9                 4.339288e-02 1 1  ON 39
eH2_0                -2.407730e-01 1 1  ON 40
eH2_1                -1.364515e-01 1 1  ON 41
eH2_2                -9.334395e-02 1 1  ON 42
eH2_3                -4.180797e-02 1 1  ON 43
eH2_4                 1.462503e-02 1 1  ON 44
eH2_5                 5.182347e-02 1 1  ON 45
eH2_6                 1.090212e-01 1 1  ON 46
eH2_7                 1.557198e-01 1 1  ON 47
eH2_8                 1.689700e-01 1 1  ON 48
eH2_9                 2.966556e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4266e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6935e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8964
    reference variance = 0.17869
====================================================
  Execution time = 2.5421e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3103e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7079e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331119687459
                                         uncertainty =       0.006439023419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331119687459
                                         uncertainty =       0.006439023419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406837361
  error estimate for blocks of size 2^( 2) =       0.000418760062
  error estimate for blocks of size 2^( 3) =       0.000431566532
  error estimate for blocks of size 2^( 4) =       0.000444291171
  error estimate for blocks of size 2^( 5) =       0.000456768584
  error estimate for blocks of size 2^( 6) =       0.000463922970
  error estimate for blocks of size 2^( 7) =       0.000467999532

      target function =                  N/A
              le_mean =     -16.910275419217
             les_mean =     286.288447864815
             stat err =       0.000458245564
             autocorr =       1.268688146747
              std dev =       0.575354913569
             le_variance =       0.331033276568


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691027541922e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910275419217       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910275521827       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910275617269       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910275662769       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910275606083       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910275584784       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910275624365       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910275630923       residual = 7.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 2.660117e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910275419217       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910275445048       residual = 9.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910275469370       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910275480860       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910275466571       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910275461177       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910275471057       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910275472598       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 6.674255e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910275419217       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910275425686       residual = 9.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910275431796       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910275434675       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910275431096       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910275429743       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910275432212       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910275432592       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 1.670077e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025357 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2142e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.082085e-01 1 1  ON 0
 uu_1                 1.432613e-01 1 1  ON 1
 uu_2                 4.597207e-02 1 1  ON 2
 uu_3                -1.620458e-02 1 1  ON 3
 uu_4                -6.441002e-02 1 1  ON 4
 uu_5                -9.943302e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376127e-01 1 1  ON 7
 uu_8                -1.283341e-01 1 1  ON 8
 uu_9                -9.888534e-02 1 1  ON 9
 ud_0                 4.306311e-01 1 1  ON 10
 ud_1                 1.742878e-01 1 1  ON 11
 ud_2                 6.136554e-02 1 1  ON 12
 ud_3                -6.098279e-03 1 1  ON 13
 ud_4                -6.048190e-02 1 1  ON 14
 ud_5                -1.020302e-01 1 1  ON 15
 ud_6                -1.304335e-01 1 1  ON 16
 ud_7                -1.483839e-01 1 1  ON 17
 ud_8                -1.509345e-01 1 1  ON 18
 ud_9                -1.399678e-01 1 1  ON 19
 eO_0                -7.453592e-01 1 1  ON 20
 eO_1                -4.311364e-01 1 1  ON 21
 eO_2                -1.701044e-02 1 1  ON 22
 eO_3                 2.974066e-01 1 1  ON 23
 eO_4                 5.142769e-01 1 1  ON 24
 eO_5                 4.691257e-01 1 1  ON 25
 eO_6                 2.396100e-01 1 1  ON 26
 eO_7                -5.249446e-02 1 1  ON 27
 eO_8                -2.081304e-01 1 1  ON 28
 eO_9                -6.776571e-02 1 1  ON 29
eH1_0                -2.419029e-01 1 1  ON 30
eH1_1                -1.380308e-01 1 1  ON 31
eH1_2                -9.497717e-02 1 1  ON 32
eH1_3                -4.353604e-02 1 1  ON 33
eH1_4                 1.229563e-02 1 1  ON 34
eH1_5                 4.924323e-02 1 1  ON 35
eH1_6                 1.059123e-01 1 1  ON 36
eH1_7                 1.523229e-01 1 1  ON 37
eH1_8                 1.609268e-01 1 1  ON 38
eH1_9                 4.339514e-02 1 1  ON 39
eH2_0                -2.407758e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334616e-02 1 1  ON 42
eH2_3                -4.181197e-02 1 1  ON 43
eH2_4                 1.462368e-02 1 1  ON 44
eH2_5                 5.182362e-02 1 1  ON 45
eH2_6                 1.090233e-01 1 1  ON 46
eH2_7                 1.557212e-01 1 1  ON 47
eH2_8                 1.689732e-01 1 1  ON 48
eH2_9                 2.966938e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8962
    reference variance = 0.144351
====================================================
  Execution time = 2.5010e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2793e-01
  Total weights = 2.0000e+06
  Execution time = 2.9792e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328022534315
                                         uncertainty =       0.003896377917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328022534315
                                         uncertainty =       0.003896377917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404927201
  error estimate for blocks of size 2^( 2) =       0.000416500207
  error estimate for blocks of size 2^( 3) =       0.000428989751
  error estimate for blocks of size 2^( 4) =       0.000440347073
  error estimate for blocks of size 2^( 5) =       0.000451193416
  error estimate for blocks of size 2^( 6) =       0.000458557775
  error estimate for blocks of size 2^( 7) =       0.000462560486

      target function =                  N/A
              le_mean =     -16.910644138638
             les_mean =     286.297817095224
             stat err =       0.000453164688
             autocorr =       1.252443720185
              std dev =       0.572653538827
             le_variance =       0.327932075532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328031942815
                                         uncertainty =       0.003896383450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328031942815
                                         uncertainty =       0.003896383450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404933009
  error estimate for blocks of size 2^( 2) =       0.000416505563
  error estimate for blocks of size 2^( 3) =       0.000428994596
  error estimate for blocks of size 2^( 4) =       0.000440351448
  error estimate for blocks of size 2^( 5) =       0.000451197429
  error estimate for blocks of size 2^( 6) =       0.000458561561
  error estimate for blocks of size 2^( 7) =       0.000462564183

      target function =                  N/A
              le_mean =     -16.910644062125
             les_mean =     286.297823916170
             stat err =       0.000453168655
             autocorr =       1.252429716422
              std dev =       0.572661753806
             le_variance =       0.327941484272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328027239745
                                         uncertainty =       0.003896380085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328027239745
                                         uncertainty =       0.003896380085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404930106
  error estimate for blocks of size 2^( 2) =       0.000416502884
  error estimate for blocks of size 2^( 3) =       0.000428992171
  error estimate for blocks of size 2^( 4) =       0.000440349256
  error estimate for blocks of size 2^( 5) =       0.000451195416
  error estimate for blocks of size 2^( 6) =       0.000458559661
  error estimate for blocks of size 2^( 7) =       0.000462562328

      target function =                  N/A
              le_mean =     -16.910644099565
             les_mean =     286.297820479296
             stat err =       0.000453166665
             autocorr =       1.252436678262
              std dev =       0.572657647401
             le_variance =       0.327936781127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328023122321
                                         uncertainty =       0.003896378168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328023122321
                                         uncertainty =       0.003896378168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404927564
  error estimate for blocks of size 2^( 2) =       0.000416500542
  error estimate for blocks of size 2^( 3) =       0.000428990053
  error estimate for blocks of size 2^( 4) =       0.000440347346
  error estimate for blocks of size 2^( 5) =       0.000451193666
  error estimate for blocks of size 2^( 6) =       0.000458558011
  error estimate for blocks of size 2^( 7) =       0.000462560716

      target function =                  N/A
              le_mean =     -16.910644133697
             les_mean =     286.297817516148
             stat err =       0.000453164935
             autocorr =       1.252442838572
              std dev =       0.572654052251
             le_variance =       0.327932663559


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910644138638        initial  <--
     1.5625e+01     1.5625e+02             2.6601e-05       -16.910644062125
     6.2500e+01     6.2500e+02             6.6743e-06       -16.910644099565
     2.5000e+02     2.5000e+03             1.6701e-06       -16.910644133697

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.9341
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.082100e-01 1 1  ON 0
 uu_1                 1.432608e-01 1 1  ON 1
 uu_2                 4.596987e-02 1 1  ON 2
 uu_3                -1.620620e-02 1 1  ON 3
 uu_4                -6.441059e-02 1 1  ON 4
 uu_5                -9.943257e-02 1 1  ON 5
 uu_6                -1.259197e-01 1 1  ON 6
 uu_7                -1.376086e-01 1 1  ON 7
 uu_8                -1.283325e-01 1 1  ON 8
 uu_9                -9.888419e-02 1 1  ON 9
 ud_0                 4.306270e-01 1 1  ON 10
 ud_1                 1.742858e-01 1 1  ON 11
 ud_2                 6.136649e-02 1 1  ON 12
 ud_3                -6.094580e-03 1 1  ON 13
 ud_4                -6.048114e-02 1 1  ON 14
 ud_5                -1.020291e-01 1 1  ON 15
 ud_6                -1.304361e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509340e-01 1 1  ON 18
 ud_9                -1.399664e-01 1 1  ON 19
 eO_0                -7.453525e-01 1 1  ON 20
 eO_1                -4.311321e-01 1 1  ON 21
 eO_2                -1.701203e-02 1 1  ON 22
 eO_3                 2.974002e-01 1 1  ON 23
 eO_4                 5.142732e-01 1 1  ON 24
 eO_5                 4.691232e-01 1 1  ON 25
 eO_6                 2.396086e-01 1 1  ON 26
 eO_7                -5.249497e-02 1 1  ON 27
 eO_8                -2.081281e-01 1 1  ON 28
 eO_9                -6.776341e-02 1 1  ON 29
eH1_0                -2.418984e-01 1 1  ON 30
eH1_1                -1.380302e-01 1 1  ON 31
eH1_2                -9.497405e-02 1 1  ON 32
eH1_3                -4.353375e-02 1 1  ON 33
eH1_4                 1.229551e-02 1 1  ON 34
eH1_5                 4.924310e-02 1 1  ON 35
eH1_6                 1.059105e-01 1 1  ON 36
eH1_7                 1.523195e-01 1 1  ON 37
eH1_8                 1.609236e-01 1 1  ON 38
eH1_9                 4.339288e-02 1 1  ON 39
eH2_0                -2.407730e-01 1 1  ON 40
eH2_1                -1.364515e-01 1 1  ON 41
eH2_2                -9.334395e-02 1 1  ON 42
eH2_3                -4.180797e-02 1 1  ON 43
eH2_4                 1.462503e-02 1 1  ON 44
eH2_5                 5.182347e-02 1 1  ON 45
eH2_6                 1.090212e-01 1 1  ON 46
eH2_7                 1.557198e-01 1 1  ON 47
eH2_8                 1.689700e-01 1 1  ON 48
eH2_9                 2.966556e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2083e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9558
    reference variance = 0.250836
====================================================
  Execution time = 2.5522e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2284e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322872253071
                                         uncertainty =       0.002918636307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322872253071
                                         uncertainty =       0.002918636307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401768714
  error estimate for blocks of size 2^( 2) =       0.000413206218
  error estimate for blocks of size 2^( 3) =       0.000425489320
  error estimate for blocks of size 2^( 4) =       0.000437809279
  error estimate for blocks of size 2^( 5) =       0.000448250559
  error estimate for blocks of size 2^( 6) =       0.000455357015
  error estimate for blocks of size 2^( 7) =       0.000461541885

      target function =                  N/A
              le_mean =     -16.910751434736
             les_mean =     286.296350125694
             stat err =       0.000450739685
             autocorr =       1.258633718837
              std dev =       0.568186764796
             le_variance =       0.322836199689


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691075143474e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910751434736       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910751440637       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910751447352       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910751445238       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910751448844       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910751447622       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910751450685       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910751450519       residual = 7.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.669837e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910751434736       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910751436212       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910751437894       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910751437365       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910751438267       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910751437960       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910751438726       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910751438684       residual = 7.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 6.678898e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910751434736       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910751435105       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910751435526       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910751435393       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910751435619       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910751435542       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910751435735       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910751435722       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 1.669994e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.028108 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2224e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.082096e-01 1 1  ON 0
 uu_1                 1.432606e-01 1 1  ON 1
 uu_2                 4.597018e-02 1 1  ON 2
 uu_3                -1.620609e-02 1 1  ON 3
 uu_4                -6.441055e-02 1 1  ON 4
 uu_5                -9.943251e-02 1 1  ON 5
 uu_6                -1.259197e-01 1 1  ON 6
 uu_7                -1.376087e-01 1 1  ON 7
 uu_8                -1.283327e-01 1 1  ON 8
 uu_9                -9.888434e-02 1 1  ON 9
 ud_0                 4.306274e-01 1 1  ON 10
 ud_1                 1.742861e-01 1 1  ON 11
 ud_2                 6.136640e-02 1 1  ON 12
 ud_3                -6.094864e-03 1 1  ON 13
 ud_4                -6.048131e-02 1 1  ON 14
 ud_5                -1.020291e-01 1 1  ON 15
 ud_6                -1.304359e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509341e-01 1 1  ON 18
 ud_9                -1.399666e-01 1 1  ON 19
 eO_0                -7.453531e-01 1 1  ON 20
 eO_1                -4.311324e-01 1 1  ON 21
 eO_2                -1.701209e-02 1 1  ON 22
 eO_3                 2.974008e-01 1 1  ON 23
 eO_4                 5.142737e-01 1 1  ON 24
 eO_5                 4.691233e-01 1 1  ON 25
 eO_6                 2.396088e-01 1 1  ON 26
 eO_7                -5.249487e-02 1 1  ON 27
 eO_8                -2.081283e-01 1 1  ON 28
 eO_9                -6.776364e-02 1 1  ON 29
eH1_0                -2.418989e-01 1 1  ON 30
eH1_1                -1.380302e-01 1 1  ON 31
eH1_2                -9.497427e-02 1 1  ON 32
eH1_3                -4.353395e-02 1 1  ON 33
eH1_4                 1.229552e-02 1 1  ON 34
eH1_5                 4.924316e-02 1 1  ON 35
eH1_6                 1.059105e-01 1 1  ON 36
eH1_7                 1.523196e-01 1 1  ON 37
eH1_8                 1.609238e-01 1 1  ON 38
eH1_9                 4.339324e-02 1 1  ON 39
eH2_0                -2.407732e-01 1 1  ON 40
eH2_1                -1.364517e-01 1 1  ON 41
eH2_2                -9.334419e-02 1 1  ON 42
eH2_3                -4.180811e-02 1 1  ON 43
eH2_4                 1.462483e-02 1 1  ON 44
eH2_5                 5.182360e-02 1 1  ON 45
eH2_6                 1.090213e-01 1 1  ON 46
eH2_7                 1.557198e-01 1 1  ON 47
eH2_8                 1.689702e-01 1 1  ON 48
eH2_9                 2.966590e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9002
    reference variance = 0.140903
====================================================
  Execution time = 2.4868e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3116e-01
  Total weights = 2.0000e+06
  Execution time = 2.9842e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330846659399
                                         uncertainty =       0.004128862351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330846659399
                                         uncertainty =       0.004128862351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406913343
  error estimate for blocks of size 2^( 2) =       0.000418784102
  error estimate for blocks of size 2^( 3) =       0.000431254512
  error estimate for blocks of size 2^( 4) =       0.000444884785
  error estimate for blocks of size 2^( 5) =       0.000456572951
  error estimate for blocks of size 2^( 6) =       0.000464076780
  error estimate for blocks of size 2^( 7) =       0.000469202637

      target function =                  N/A
              le_mean =     -16.910312329140
             les_mean =     286.289819841668
             stat err =       0.000458684288
             autocorr =       1.270643927351
              std dev =       0.575462369054
             le_variance =       0.331156938197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330847182249
                                         uncertainty =       0.004128868975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330847182249
                                         uncertainty =       0.004128868975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406913665
  error estimate for blocks of size 2^( 2) =       0.000418784386
  error estimate for blocks of size 2^( 3) =       0.000431254750
  error estimate for blocks of size 2^( 4) =       0.000444884988
  error estimate for blocks of size 2^( 5) =       0.000456573122
  error estimate for blocks of size 2^( 6) =       0.000464076953
  error estimate for blocks of size 2^( 7) =       0.000469202841

      target function =                  N/A
              le_mean =     -16.910312333866
             les_mean =     286.289820524825
             stat err =       0.000458684476
             autocorr =       1.270642960466
              std dev =       0.575462823748
             le_variance =       0.331157461517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330846920394
                                         uncertainty =       0.004128865652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330846920394
                                         uncertainty =       0.004128865652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406913504
  error estimate for blocks of size 2^( 2) =       0.000418784244
  error estimate for blocks of size 2^( 3) =       0.000431254631
  error estimate for blocks of size 2^( 4) =       0.000444884886
  error estimate for blocks of size 2^( 5) =       0.000456573037
  error estimate for blocks of size 2^( 6) =       0.000464076866
  error estimate for blocks of size 2^( 7) =       0.000469202739

      target function =                  N/A
              le_mean =     -16.910312331505
             les_mean =     286.289820182904
             stat err =       0.000458684382
             autocorr =       1.270643444250
              std dev =       0.575462596028
             le_variance =       0.331157199427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330846692007
                                         uncertainty =       0.004128862763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330846692007
                                         uncertainty =       0.004128862763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406913364
  error estimate for blocks of size 2^( 2) =       0.000418784120
  error estimate for blocks of size 2^( 3) =       0.000431254527
  error estimate for blocks of size 2^( 4) =       0.000444884797
  error estimate for blocks of size 2^( 5) =       0.000456572962
  error estimate for blocks of size 2^( 6) =       0.000464076791
  error estimate for blocks of size 2^( 7) =       0.000469202650

      target function =                  N/A
              le_mean =     -16.910312329435
             les_mean =     286.289819884297
             stat err =       0.000458684300
             autocorr =       1.270643866968
              std dev =       0.575462397412
             le_variance =       0.331156970835


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910312329140        initial
     1.5625e+02     1.5625e+03             2.6698e-06       -16.910312333866  <--
     6.2500e+02     6.2500e+03             6.6789e-07       -16.910312331505
     2.5000e+03     2.5000e+04             1.6700e-07       -16.910312329435

*****************************************************************************
Applying the update for shift_i =   1.5625e+02     and shift_s =   1.5625e+03
*****************************************************************************

  Execution time = 3.9786e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.082085e-01 1 1  ON 0
 uu_1                 1.432602e-01 1 1  ON 1
 uu_2                 4.597112e-02 1 1  ON 2
 uu_3                -1.620574e-02 1 1  ON 3
 uu_4                -6.441042e-02 1 1  ON 4
 uu_5                -9.943232e-02 1 1  ON 5
 uu_6                -1.259197e-01 1 1  ON 6
 uu_7                -1.376089e-01 1 1  ON 7
 uu_8                -1.283333e-01 1 1  ON 8
 uu_9                -9.888480e-02 1 1  ON 9
 ud_0                 4.306286e-01 1 1  ON 10
 ud_1                 1.742869e-01 1 1  ON 11
 ud_2                 6.136613e-02 1 1  ON 12
 ud_3                -6.095717e-03 1 1  ON 13
 ud_4                -6.048182e-02 1 1  ON 14
 ud_5                -1.020290e-01 1 1  ON 15
 ud_6                -1.304353e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509344e-01 1 1  ON 18
 ud_9                -1.399672e-01 1 1  ON 19
 eO_0                -7.453550e-01 1 1  ON 20
 eO_1                -4.311334e-01 1 1  ON 21
 eO_2                -1.701228e-02 1 1  ON 22
 eO_3                 2.974028e-01 1 1  ON 23
 eO_4                 5.142752e-01 1 1  ON 24
 eO_5                 4.691235e-01 1 1  ON 25
 eO_6                 2.396092e-01 1 1  ON 26
 eO_7                -5.249459e-02 1 1  ON 27
 eO_8                -2.081290e-01 1 1  ON 28
 eO_9                -6.776435e-02 1 1  ON 29
eH1_0                -2.419003e-01 1 1  ON 30
eH1_1                -1.380303e-01 1 1  ON 31
eH1_2                -9.497494e-02 1 1  ON 32
eH1_3                -4.353455e-02 1 1  ON 33
eH1_4                 1.229555e-02 1 1  ON 34
eH1_5                 4.924335e-02 1 1  ON 35
eH1_6                 1.059105e-01 1 1  ON 36
eH1_7                 1.523199e-01 1 1  ON 37
eH1_8                 1.609247e-01 1 1  ON 38
eH1_9                 4.339432e-02 1 1  ON 39
eH2_0                -2.407737e-01 1 1  ON 40
eH2_1                -1.364521e-01 1 1  ON 41
eH2_2                -9.334489e-02 1 1  ON 42
eH2_3                -4.180852e-02 1 1  ON 43
eH2_4                 1.462422e-02 1 1  ON 44
eH2_5                 5.182401e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689709e-01 1 1  ON 48
eH2_9                 2.966692e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2018e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8332
    reference variance = 0.201154
====================================================
  Execution time = 2.5589e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.3034e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7074e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330427799072
                                         uncertainty =       0.003989971327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330427799072
                                         uncertainty =       0.003989971327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406410914
  error estimate for blocks of size 2^( 2) =       0.000418281377
  error estimate for blocks of size 2^( 3) =       0.000430520460
  error estimate for blocks of size 2^( 4) =       0.000441491579
  error estimate for blocks of size 2^( 5) =       0.000451496692
  error estimate for blocks of size 2^( 6) =       0.000458797410
  error estimate for blocks of size 2^( 7) =       0.000462604066

      target function =                  N/A
              le_mean =     -16.912431289299
             les_mean =     286.360671612005
             stat err =       0.000453597437
             autocorr =       1.245691379207
              std dev =       0.574751826380
             le_variance =       0.330339661927


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691243128930e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.912431289299       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.912431356904       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.912431384260       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.912431384736       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.912431416488       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.912431433616       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.912431441894       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.912431437194       residual = 9.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.275759e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.912431289299       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.912431306270       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.912431313168       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.912431313262       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.912431321193       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.912431325497       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.912431327585       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.912431326411       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 3.200420e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.912431289299       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.912431293546       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.912431295274       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.912431295296       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.912431297278       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.912431298355       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.912431298879       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.912431298585       residual = 9.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 8.007992e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.030806 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2309e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.082071e-01 1 1  ON 0
 uu_1                 1.432596e-01 1 1  ON 1
 uu_2                 4.597209e-02 1 1  ON 2
 uu_3                -1.620454e-02 1 1  ON 3
 uu_4                -6.440974e-02 1 1  ON 4
 uu_5                -9.943274e-02 1 1  ON 5
 uu_6                -1.259197e-01 1 1  ON 6
 uu_7                -1.376097e-01 1 1  ON 7
 uu_8                -1.283342e-01 1 1  ON 8
 uu_9                -9.888517e-02 1 1  ON 9
 ud_0                 4.306296e-01 1 1  ON 10
 ud_1                 1.742881e-01 1 1  ON 11
 ud_2                 6.136626e-02 1 1  ON 12
 ud_3                -6.096963e-03 1 1  ON 13
 ud_4                -6.048221e-02 1 1  ON 14
 ud_5                -1.020290e-01 1 1  ON 15
 ud_6                -1.304337e-01 1 1  ON 16
 ud_7                -1.483847e-01 1 1  ON 17
 ud_8                -1.509356e-01 1 1  ON 18
 ud_9                -1.399682e-01 1 1  ON 19
 eO_0                -7.453582e-01 1 1  ON 20
 eO_1                -4.311341e-01 1 1  ON 21
 eO_2                -1.701136e-02 1 1  ON 22
 eO_3                 2.974051e-01 1 1  ON 23
 eO_4                 5.142764e-01 1 1  ON 24
 eO_5                 4.691244e-01 1 1  ON 25
 eO_6                 2.396098e-01 1 1  ON 26
 eO_7                -5.249445e-02 1 1  ON 27
 eO_8                -2.081301e-01 1 1  ON 28
 eO_9                -6.776525e-02 1 1  ON 29
eH1_0                -2.419026e-01 1 1  ON 30
eH1_1                -1.380313e-01 1 1  ON 31
eH1_2                -9.497588e-02 1 1  ON 32
eH1_3                -4.353494e-02 1 1  ON 33
eH1_4                 1.229494e-02 1 1  ON 34
eH1_5                 4.924376e-02 1 1  ON 35
eH1_6                 1.059115e-01 1 1  ON 36
eH1_7                 1.523211e-01 1 1  ON 37
eH1_8                 1.609260e-01 1 1  ON 38
eH1_9                 4.339567e-02 1 1  ON 39
eH2_0                -2.407755e-01 1 1  ON 40
eH2_1                -1.364519e-01 1 1  ON 41
eH2_2                -9.334566e-02 1 1  ON 42
eH2_3                -4.180946e-02 1 1  ON 43
eH2_4                 1.462386e-02 1 1  ON 44
eH2_5                 5.182430e-02 1 1  ON 45
eH2_6                 1.090221e-01 1 1  ON 46
eH2_7                 1.557202e-01 1 1  ON 47
eH2_8                 1.689723e-01 1 1  ON 48
eH2_9                 2.966824e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8948
    reference variance = 0.393153
====================================================
  Execution time = 2.5199e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2744e-01
  Total weights = 2.0000e+06
  Execution time = 2.9783e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327491714317
                                         uncertainty =       0.002796781461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327491714317
                                         uncertainty =       0.002796781461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404622031
  error estimate for blocks of size 2^( 2) =       0.000416333555
  error estimate for blocks of size 2^( 3) =       0.000428899319
  error estimate for blocks of size 2^( 4) =       0.000440645484
  error estimate for blocks of size 2^( 5) =       0.000450859606
  error estimate for blocks of size 2^( 6) =       0.000457276164
  error estimate for blocks of size 2^( 7) =       0.000460668726

      target function =                  N/A
              le_mean =     -16.910611798991
             les_mean =     286.296229227986
             stat err =       0.000452362495
             autocorr =       1.249896725653
              std dev =       0.572221963503
             le_variance =       0.327437975515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327490132688
                                         uncertainty =       0.002796762705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327490132688
                                         uncertainty =       0.002796762705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404621055
  error estimate for blocks of size 2^( 2) =       0.000416332520
  error estimate for blocks of size 2^( 3) =       0.000428898209
  error estimate for blocks of size 2^( 4) =       0.000440644249
  error estimate for blocks of size 2^( 5) =       0.000450858417
  error estimate for blocks of size 2^( 6) =       0.000457275039
  error estimate for blocks of size 2^( 7) =       0.000460667336

      target function =                  N/A
              le_mean =     -16.910611779506
             les_mean =     286.296226989258
             stat err =       0.000452361260
             autocorr =       1.249895934275
              std dev =       0.572220583172
             le_variance =       0.327436395806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327490904727
                                         uncertainty =       0.002796771928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327490904727
                                         uncertainty =       0.002796771928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404621531
  error estimate for blocks of size 2^( 2) =       0.000416333026
  error estimate for blocks of size 2^( 3) =       0.000428898752
  error estimate for blocks of size 2^( 4) =       0.000440644855
  error estimate for blocks of size 2^( 5) =       0.000450859001
  error estimate for blocks of size 2^( 6) =       0.000457275591
  error estimate for blocks of size 2^( 7) =       0.000460668019

      target function =                  N/A
              le_mean =     -16.910611788971
             les_mean =     286.296228080469
             stat err =       0.000452361867
             autocorr =       1.249896340251
              std dev =       0.572221256935
             le_variance =       0.327437166889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327491612474
                                         uncertainty =       0.002796780265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327491612474
                                         uncertainty =       0.002796780265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404621968
  error estimate for blocks of size 2^( 2) =       0.000416333488
  error estimate for blocks of size 2^( 3) =       0.000428899248
  error estimate for blocks of size 2^( 4) =       0.000440645405
  error estimate for blocks of size 2^( 5) =       0.000450859530
  error estimate for blocks of size 2^( 6) =       0.000457276092
  error estimate for blocks of size 2^( 7) =       0.000460668637

      target function =                  N/A
              le_mean =     -16.910611797721
             les_mean =     286.296229083298
             stat err =       0.000452362416
             autocorr =       1.249896677760
              std dev =       0.572221874619
             le_variance =       0.327437873792


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910611798991        initial  <--
     3.9062e+01     3.9062e+02             1.2758e-05       -16.910611779506
     1.5625e+02     1.5625e+03             3.2004e-06       -16.910611788971
     6.2500e+02     6.2500e+03             8.0080e-07       -16.910611797721

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.1199
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.082085e-01 1 1  ON 0
 uu_1                 1.432602e-01 1 1  ON 1
 uu_2                 4.597112e-02 1 1  ON 2
 uu_3                -1.620574e-02 1 1  ON 3
 uu_4                -6.441042e-02 1 1  ON 4
 uu_5                -9.943232e-02 1 1  ON 5
 uu_6                -1.259197e-01 1 1  ON 6
 uu_7                -1.376089e-01 1 1  ON 7
 uu_8                -1.283333e-01 1 1  ON 8
 uu_9                -9.888480e-02 1 1  ON 9
 ud_0                 4.306286e-01 1 1  ON 10
 ud_1                 1.742869e-01 1 1  ON 11
 ud_2                 6.136613e-02 1 1  ON 12
 ud_3                -6.095717e-03 1 1  ON 13
 ud_4                -6.048182e-02 1 1  ON 14
 ud_5                -1.020290e-01 1 1  ON 15
 ud_6                -1.304353e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509344e-01 1 1  ON 18
 ud_9                -1.399672e-01 1 1  ON 19
 eO_0                -7.453550e-01 1 1  ON 20
 eO_1                -4.311334e-01 1 1  ON 21
 eO_2                -1.701228e-02 1 1  ON 22
 eO_3                 2.974028e-01 1 1  ON 23
 eO_4                 5.142752e-01 1 1  ON 24
 eO_5                 4.691235e-01 1 1  ON 25
 eO_6                 2.396092e-01 1 1  ON 26
 eO_7                -5.249459e-02 1 1  ON 27
 eO_8                -2.081290e-01 1 1  ON 28
 eO_9                -6.776435e-02 1 1  ON 29
eH1_0                -2.419003e-01 1 1  ON 30
eH1_1                -1.380303e-01 1 1  ON 31
eH1_2                -9.497494e-02 1 1  ON 32
eH1_3                -4.353455e-02 1 1  ON 33
eH1_4                 1.229555e-02 1 1  ON 34
eH1_5                 4.924335e-02 1 1  ON 35
eH1_6                 1.059105e-01 1 1  ON 36
eH1_7                 1.523199e-01 1 1  ON 37
eH1_8                 1.609247e-01 1 1  ON 38
eH1_9                 4.339432e-02 1 1  ON 39
eH2_0                -2.407737e-01 1 1  ON 40
eH2_1                -1.364521e-01 1 1  ON 41
eH2_2                -9.334489e-02 1 1  ON 42
eH2_3                -4.180852e-02 1 1  ON 43
eH2_4                 1.462422e-02 1 1  ON 44
eH2_5                 5.182401e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689709e-01 1 1  ON 48
eH2_9                 2.966692e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2436e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8481
    reference variance = 0.147833
====================================================
  Execution time = 2.6156e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2937e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6759e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329367040465
                                         uncertainty =       0.003247458592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329367040465
                                         uncertainty =       0.003247458592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405816183
  error estimate for blocks of size 2^( 2) =       0.000417356641
  error estimate for blocks of size 2^( 3) =       0.000429460864
  error estimate for blocks of size 2^( 4) =       0.000441926119
  error estimate for blocks of size 2^( 5) =       0.000452908740
  error estimate for blocks of size 2^( 6) =       0.000459521044
  error estimate for blocks of size 2^( 7) =       0.000464480378

      target function =                  N/A
              le_mean =     -16.910917041409
             les_mean =     286.308488565966
             stat err =       0.000454709070
             autocorr =       1.255476275756
              std dev =       0.573910750243
             le_variance =       0.329373549244


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691091704141e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910917041409       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910917040714       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910917040698       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910917043199       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910917044974       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910917044763       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910917045512       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910917045643       residual = 8.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.088120e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910917041409       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910917041235       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910917041231       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910917041855       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910917042300       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910917042246       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910917042434       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910917042466       residual = 8.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 2.720911e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910917041409       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910917041365       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910917041364       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910917041520       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910917041629       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910917041620       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910917041667       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910917041671       residual = 8.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 6.802657e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.033459 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2843e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.082084e-01 1 1  ON 0
 uu_1                 1.432602e-01 1 1  ON 1
 uu_2                 4.597120e-02 1 1  ON 2
 uu_3                -1.620564e-02 1 1  ON 3
 uu_4                -6.441043e-02 1 1  ON 4
 uu_5                -9.943228e-02 1 1  ON 5
 uu_6                -1.259197e-01 1 1  ON 6
 uu_7                -1.376089e-01 1 1  ON 7
 uu_8                -1.283335e-01 1 1  ON 8
 uu_9                -9.888491e-02 1 1  ON 9
 ud_0                 4.306288e-01 1 1  ON 10
 ud_1                 1.742870e-01 1 1  ON 11
 ud_2                 6.136614e-02 1 1  ON 12
 ud_3                -6.095827e-03 1 1  ON 13
 ud_4                -6.048183e-02 1 1  ON 14
 ud_5                -1.020291e-01 1 1  ON 15
 ud_6                -1.304353e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509345e-01 1 1  ON 18
 ud_9                -1.399673e-01 1 1  ON 19
 eO_0                -7.453552e-01 1 1  ON 20
 eO_1                -4.311336e-01 1 1  ON 21
 eO_2                -1.701211e-02 1 1  ON 22
 eO_3                 2.974030e-01 1 1  ON 23
 eO_4                 5.142753e-01 1 1  ON 24
 eO_5                 4.691236e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249455e-02 1 1  ON 27
 eO_8                -2.081291e-01 1 1  ON 28
 eO_9                -6.776444e-02 1 1  ON 29
eH1_0                -2.419004e-01 1 1  ON 30
eH1_1                -1.380304e-01 1 1  ON 31
eH1_2                -9.497498e-02 1 1  ON 32
eH1_3                -4.353463e-02 1 1  ON 33
eH1_4                 1.229555e-02 1 1  ON 34
eH1_5                 4.924337e-02 1 1  ON 35
eH1_6                 1.059106e-01 1 1  ON 36
eH1_7                 1.523199e-01 1 1  ON 37
eH1_8                 1.609248e-01 1 1  ON 38
eH1_9                 4.339441e-02 1 1  ON 39
eH2_0                -2.407738e-01 1 1  ON 40
eH2_1                -1.364521e-01 1 1  ON 41
eH2_2                -9.334495e-02 1 1  ON 42
eH2_3                -4.180858e-02 1 1  ON 43
eH2_4                 1.462420e-02 1 1  ON 44
eH2_5                 5.182402e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689710e-01 1 1  ON 48
eH2_9                 2.966706e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9508
    reference variance = 0.308153
====================================================
  Execution time = 2.5044e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3959e-01
  Total weights = 2.0000e+06
  Execution time = 3.6831e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339715209026
                                         uncertainty =       0.004290793191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339715209026
                                         uncertainty =       0.004290793191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412064370
  error estimate for blocks of size 2^( 2) =       0.000423725511
  error estimate for blocks of size 2^( 3) =       0.000435611534
  error estimate for blocks of size 2^( 4) =       0.000447435194
  error estimate for blocks of size 2^( 5) =       0.000457553535
  error estimate for blocks of size 2^( 6) =       0.000463994688
  error estimate for blocks of size 2^( 7) =       0.000467894741

      target function =                  N/A
              le_mean =     -16.910540997175
             les_mean =     286.305990738212
             stat err =       0.000459219539
             autocorr =       1.241968521194
              std dev =       0.582747021328
             le_variance =       0.339594090867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339715490515
                                         uncertainty =       0.004290799902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339715490515
                                         uncertainty =       0.004290799902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412064541
  error estimate for blocks of size 2^( 2) =       0.000423725662
  error estimate for blocks of size 2^( 3) =       0.000435611662
  error estimate for blocks of size 2^( 4) =       0.000447435309
  error estimate for blocks of size 2^( 5) =       0.000457553642
  error estimate for blocks of size 2^( 6) =       0.000463994770
  error estimate for blocks of size 2^( 7) =       0.000467894803

      target function =                  N/A
              le_mean =     -16.910540998948
             les_mean =     286.305991079668
             stat err =       0.000459219631
             autocorr =       1.241967986235
              std dev =       0.582747262847
             le_variance =       0.339594372355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339715349727
                                         uncertainty =       0.004290796546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339715349727
                                         uncertainty =       0.004290796546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412064456
  error estimate for blocks of size 2^( 2) =       0.000423725586
  error estimate for blocks of size 2^( 3) =       0.000435611598
  error estimate for blocks of size 2^( 4) =       0.000447435251
  error estimate for blocks of size 2^( 5) =       0.000457553588
  error estimate for blocks of size 2^( 6) =       0.000463994729
  error estimate for blocks of size 2^( 7) =       0.000467894772

      target function =                  N/A
              le_mean =     -16.910540998061
             les_mean =     286.305990908873
             stat err =       0.000459219585
             autocorr =       1.241968253686
              std dev =       0.582747142050
             le_variance =       0.339594231568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339715226612
                                         uncertainty =       0.004290793610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339715226612
                                         uncertainty =       0.004290793610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412064381
  error estimate for blocks of size 2^( 2) =       0.000423725521
  error estimate for blocks of size 2^( 3) =       0.000435611542
  error estimate for blocks of size 2^( 4) =       0.000447435201
  error estimate for blocks of size 2^( 5) =       0.000457553541
  error estimate for blocks of size 2^( 6) =       0.000463994693
  error estimate for blocks of size 2^( 7) =       0.000467894745

      target function =                  N/A
              le_mean =     -16.910540997286
             les_mean =     286.305990759541
             stat err =       0.000459219545
             autocorr =       1.241968487759
              std dev =       0.582747036417
             le_variance =       0.339594108453


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910540997175        initial
     3.9062e+02     3.9062e+03             1.0881e-06       -16.910540998948  <--
     1.5625e+03     1.5625e+04             2.7209e-07       -16.910540998061
     6.2500e+03     6.2500e+04             6.8027e-08       -16.910540997286

*****************************************************************************
Applying the update for shift_i =   3.9062e+02     and shift_s =   3.9062e+03
*****************************************************************************

  Execution time = 4.1210e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4061e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9108
    reference variance = 0.222032
====================================================
  Execution time = 2.5500e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3617e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6815e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336205548648
                                         uncertainty =       0.006374988214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336205548648
                                         uncertainty =       0.006374988214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409978880
  error estimate for blocks of size 2^( 2) =       0.000421519740
  error estimate for blocks of size 2^( 3) =       0.000433832637
  error estimate for blocks of size 2^( 4) =       0.000446185108
  error estimate for blocks of size 2^( 5) =       0.000457666474
  error estimate for blocks of size 2^( 6) =       0.000465478189
  error estimate for blocks of size 2^( 7) =       0.000469732984

      target function =                  N/A
              le_mean =     -16.910156519085
             les_mean =     286.289558695676
             stat err =       0.000459765689
             autocorr =       1.257622059018
              std dev =       0.579797692148
             le_variance =       0.336165363820


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691015651908e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910156519085       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910156522087       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910156512115       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910156504606       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910156502277       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910156502666       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910156504684       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910156506787       residual = 7.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 4.588234e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910156519085       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910156519836       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910156517336       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910156515458       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910156514871       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910156514968       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910156515469       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910156515993       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.147796e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910156519085       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910156519273       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910156518647       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910156518178       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910156518030       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910156518055       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910156518180       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910156518307       residual = 7.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 2.869953e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.036109 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2193e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.082077e-01 1 1  ON 0
 uu_1                 1.432602e-01 1 1  ON 1
 uu_2                 4.597167e-02 1 1  ON 2
 uu_3                -1.620498e-02 1 1  ON 3
 uu_4                -6.441000e-02 1 1  ON 4
 uu_5                -9.943241e-02 1 1  ON 5
 uu_6                -1.259197e-01 1 1  ON 6
 uu_7                -1.376092e-01 1 1  ON 7
 uu_8                -1.283342e-01 1 1  ON 8
 uu_9                -9.888549e-02 1 1  ON 9
 ud_0                 4.306303e-01 1 1  ON 10
 ud_1                 1.742879e-01 1 1  ON 11
 ud_2                 6.136599e-02 1 1  ON 12
 ud_3                -6.096916e-03 1 1  ON 13
 ud_4                -6.048214e-02 1 1  ON 14
 ud_5                -1.020291e-01 1 1  ON 15
 ud_6                -1.304349e-01 1 1  ON 16
 ud_7                -1.483847e-01 1 1  ON 17
 ud_8                -1.509350e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453572e-01 1 1  ON 20
 eO_1                -4.311347e-01 1 1  ON 21
 eO_2                -1.701127e-02 1 1  ON 22
 eO_3                 2.974046e-01 1 1  ON 23
 eO_4                 5.142764e-01 1 1  ON 24
 eO_5                 4.691241e-01 1 1  ON 25
 eO_6                 2.396095e-01 1 1  ON 26
 eO_7                -5.249425e-02 1 1  ON 27
 eO_8                -2.081300e-01 1 1  ON 28
 eO_9                -6.776505e-02 1 1  ON 29
eH1_0                -2.419016e-01 1 1  ON 30
eH1_1                -1.380308e-01 1 1  ON 31
eH1_2                -9.497545e-02 1 1  ON 32
eH1_3                -4.353553e-02 1 1  ON 33
eH1_4                 1.229526e-02 1 1  ON 34
eH1_5                 4.924353e-02 1 1  ON 35
eH1_6                 1.059112e-01 1 1  ON 36
eH1_7                 1.523205e-01 1 1  ON 37
eH1_8                 1.609257e-01 1 1  ON 38
eH1_9                 4.339532e-02 1 1  ON 39
eH2_0                -2.407746e-01 1 1  ON 40
eH2_1                -1.364523e-01 1 1  ON 41
eH2_2                -9.334538e-02 1 1  ON 42
eH2_3                -4.180904e-02 1 1  ON 43
eH2_4                 1.462397e-02 1 1  ON 44
eH2_5                 5.182398e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557202e-01 1 1  ON 47
eH2_8                 1.689718e-01 1 1  ON 48
eH2_9                 2.966804e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9299
    reference variance = 0.472956
====================================================
  Execution time = 2.4751e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3744e-01
  Total weights = 2.0000e+06
  Execution time = 2.9522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337450215074
                                         uncertainty =       0.007696528173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337450215074
                                         uncertainty =       0.007696528173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410755267
  error estimate for blocks of size 2^( 2) =       0.000421924465
  error estimate for blocks of size 2^( 3) =       0.000434354990
  error estimate for blocks of size 2^( 4) =       0.000446562439
  error estimate for blocks of size 2^( 5) =       0.000456645648
  error estimate for blocks of size 2^( 6) =       0.000465311745
  error estimate for blocks of size 2^( 7) =       0.000471776722

      target function =                  N/A
              le_mean =     -16.911026139604
             les_mean =     286.320244703944
             stat err =       0.000460074138
             autocorr =       1.254554005815
              std dev =       0.580895669028
             le_variance =       0.337439778295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337451972146
                                         uncertainty =       0.007696541664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337451972146
                                         uncertainty =       0.007696541664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410756336
  error estimate for blocks of size 2^( 2) =       0.000421925459
  error estimate for blocks of size 2^( 3) =       0.000434355891
  error estimate for blocks of size 2^( 4) =       0.000446563296
  error estimate for blocks of size 2^( 5) =       0.000456646434
  error estimate for blocks of size 2^( 6) =       0.000465312449
  error estimate for blocks of size 2^( 7) =       0.000471777430

      target function =                  N/A
              le_mean =     -16.911026134727
             les_mean =     286.320246296493
             stat err =       0.000460074902
             autocorr =       1.254551638812
              std dev =       0.580897181785
             le_variance =       0.337441535805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337451093850
                                         uncertainty =       0.007696534885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337451093850
                                         uncertainty =       0.007696534885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410755802
  error estimate for blocks of size 2^( 2) =       0.000421924962
  error estimate for blocks of size 2^( 3) =       0.000434355441
  error estimate for blocks of size 2^( 4) =       0.000446562867
  error estimate for blocks of size 2^( 5) =       0.000456646041
  error estimate for blocks of size 2^( 6) =       0.000465312097
  error estimate for blocks of size 2^( 7) =       0.000471777076

      target function =                  N/A
              le_mean =     -16.911026137130
             les_mean =     286.320245499264
             stat err =       0.000460074520
             autocorr =       1.254552821525
              std dev =       0.580896425614
             le_variance =       0.337440657291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337450324923
                                         uncertainty =       0.007696529011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337450324923
                                         uncertainty =       0.007696529011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410755334
  error estimate for blocks of size 2^( 2) =       0.000421924527
  error estimate for blocks of size 2^( 3) =       0.000434355047
  error estimate for blocks of size 2^( 4) =       0.000446562492
  error estimate for blocks of size 2^( 5) =       0.000456645697
  error estimate for blocks of size 2^( 6) =       0.000465311789
  error estimate for blocks of size 2^( 7) =       0.000471776766

      target function =                  N/A
              le_mean =     -16.911026139293
             les_mean =     286.320244803287
             stat err =       0.000460074186
             autocorr =       1.254553857761
              std dev =       0.580895763603
             le_variance =       0.337439888171


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911026139604        initial  <--
     9.7656e+01     9.7656e+02             4.5882e-06       -16.911026134727
     3.9062e+02     3.9062e+03             1.1478e-06       -16.911026137130
     1.5625e+03     1.5625e+04             2.8700e-07       -16.911026139293

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.5770
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1777e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9096
    reference variance = 0.159913
====================================================
  Execution time = 2.5377e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2533e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6999e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325363065683
                                         uncertainty =       0.003819166394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325363065683
                                         uncertainty =       0.003819166394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403319359
  error estimate for blocks of size 2^( 2) =       0.000414971889
  error estimate for blocks of size 2^( 3) =       0.000426936465
  error estimate for blocks of size 2^( 4) =       0.000438327966
  error estimate for blocks of size 2^( 5) =       0.000448359510
  error estimate for blocks of size 2^( 6) =       0.000455021623
  error estimate for blocks of size 2^( 7) =       0.000459219107

      target function =                  N/A
              le_mean =     -16.910941148827
             les_mean =     286.305263386843
             stat err =       0.000450232051
             autocorr =       1.246162507620
              std dev =       0.570379707233
             le_variance =       0.325333010423


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691094114883e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910941148827       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910941149524       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910941148872       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910941148516       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910941148787       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910941149033       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910941149513       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910941149628       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910941149485       residual = 1.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 4.765381e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910941148827       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910941149001       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910941148838       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910941148749       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910941148817       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910941148880       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910941148998       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910941149022       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910941148971       residual = 1.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 1.191449e-07

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910941148827       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910941148870       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910941148830       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910941148806       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910941148824       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910941148838       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910941148873       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910941148861       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910941148807       residual = 1.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 2.978689e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.039231 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2089e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.082081e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620534e-02 1 1  ON 3
 uu_4                -6.441041e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888526e-02 1 1  ON 9
 ud_0                 4.306295e-01 1 1  ON 10
 ud_1                 1.742875e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096206e-03 1 1  ON 13
 ud_4                -6.048191e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453562e-01 1 1  ON 20
 eO_1                -4.311341e-01 1 1  ON 21
 eO_2                -1.701156e-02 1 1  ON 22
 eO_3                 2.974037e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396094e-01 1 1  ON 26
 eO_7                -5.249440e-02 1 1  ON 27
 eO_8                -2.081296e-01 1 1  ON 28
 eO_9                -6.776474e-02 1 1  ON 29
eH1_0                -2.419010e-01 1 1  ON 30
eH1_1                -1.380307e-01 1 1  ON 31
eH1_2                -9.497512e-02 1 1  ON 32
eH1_3                -4.353489e-02 1 1  ON 33
eH1_4                 1.229559e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059110e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339474e-02 1 1  ON 39
eH2_0                -2.407743e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334517e-02 1 1  ON 42
eH2_3                -4.180875e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182403e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557200e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966757e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9425
    reference variance = 0.23179
====================================================
  Execution time = 2.4839e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4173e-01
  Total weights = 2.0000e+06
  Execution time = 2.9788e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341759333074
                                         uncertainty =       0.010184054190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341759333074
                                         uncertainty =       0.010184054190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413357077
  error estimate for blocks of size 2^( 2) =       0.000424548639
  error estimate for blocks of size 2^( 3) =       0.000436596666
  error estimate for blocks of size 2^( 4) =       0.000447761502
  error estimate for blocks of size 2^( 5) =       0.000456345571
  error estimate for blocks of size 2^( 6) =       0.000463428430
  error estimate for blocks of size 2^( 7) =       0.000466557798

      target function =                  N/A
              le_mean =     -16.911124019379
             les_mean =     286.327843574153
             stat err =       0.000458523325
             autocorr =       1.230473064972
              std dev =       0.584575184389
             le_variance =       0.341728146203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341759446595
                                         uncertainty =       0.010184051793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341759446595
                                         uncertainty =       0.010184051793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413357146
  error estimate for blocks of size 2^( 2) =       0.000424548702
  error estimate for blocks of size 2^( 3) =       0.000436596723
  error estimate for blocks of size 2^( 4) =       0.000447761551
  error estimate for blocks of size 2^( 5) =       0.000456345619
  error estimate for blocks of size 2^( 6) =       0.000463428471
  error estimate for blocks of size 2^( 7) =       0.000466557834

      target function =                  N/A
              le_mean =     -16.911124019057
             les_mean =     286.327843676642
             stat err =       0.000458523369
             autocorr =       1.230472889619
              std dev =       0.584575281371
             le_variance =       0.341728259590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341759389829
                                         uncertainty =       0.010184052990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341759389829
                                         uncertainty =       0.010184052990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413357111
  error estimate for blocks of size 2^( 2) =       0.000424548671
  error estimate for blocks of size 2^( 3) =       0.000436596695
  error estimate for blocks of size 2^( 4) =       0.000447761527
  error estimate for blocks of size 2^( 5) =       0.000456345595
  error estimate for blocks of size 2^( 6) =       0.000463428450
  error estimate for blocks of size 2^( 7) =       0.000466557816

      target function =                  N/A
              le_mean =     -16.911124019218
             les_mean =     286.327843625391
             stat err =       0.000458523347
             autocorr =       1.230472977291
              std dev =       0.584575232875
             le_variance =       0.341728202890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341759340168
                                         uncertainty =       0.010184054040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341759340168
                                         uncertainty =       0.010184054040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413357081
  error estimate for blocks of size 2^( 2) =       0.000424548643
  error estimate for blocks of size 2^( 3) =       0.000436596670
  error estimate for blocks of size 2^( 4) =       0.000447761505
  error estimate for blocks of size 2^( 5) =       0.000456345574
  error estimate for blocks of size 2^( 6) =       0.000463428432
  error estimate for blocks of size 2^( 7) =       0.000466557800

      target function =                  N/A
              le_mean =     -16.911124019359
             les_mean =     286.327843580558
             stat err =       0.000458523328
             autocorr =       1.230473054006
              std dev =       0.584575190449
             le_variance =       0.341728153288


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911124019379        initial  <--
     9.7656e+02     9.7656e+03             4.7654e-07       -16.911124019057
     3.9062e+03     3.9062e+04             1.1914e-07       -16.911124019218
     1.5625e+04     1.5625e+05             2.9787e-08       -16.911124019359

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.7261
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1822e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8583
    reference variance = 0.260417
====================================================
  Execution time = 2.5467e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3708e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6831e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337135887679
                                         uncertainty =       0.009443300812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337135887679
                                         uncertainty =       0.009443300812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410533540
  error estimate for blocks of size 2^( 2) =       0.000421971912
  error estimate for blocks of size 2^( 3) =       0.000434221339
  error estimate for blocks of size 2^( 4) =       0.000445952400
  error estimate for blocks of size 2^( 5) =       0.000456270427
  error estimate for blocks of size 2^( 6) =       0.000465049353
  error estimate for blocks of size 2^( 7) =       0.000469164453

      target function =                  N/A
              le_mean =     -16.910316306567
             les_mean =     286.295872994706
             stat err =       0.000459109158
             autocorr =       1.250646649008
              std dev =       0.580582100232
             le_variance =       0.337075575110


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691031630657e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910316306567       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910316306677       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910316306934       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910316306946       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910316307001       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910316306910       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910316306931       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910316306942       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 3.775642e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910316306567       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910316306594       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910316306659       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910316306662       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910316306686       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910316306631       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910316306661       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910316306657       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 9.439163e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910316306567       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910316306574       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910316306590       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910316306590       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910316306649       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910316306121       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910316306581       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910316306590       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 2.359793e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.041866 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2161e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888525e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742875e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096162e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453561e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701159e-02 1 1  ON 22
 eO_3                 2.974037e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334515e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557200e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966751e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8562
    reference variance = 0.562516
====================================================
  Execution time = 2.4768e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4141e-01
  Total weights = 2.0000e+06
  Execution time = 2.9610e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341279057432
                                         uncertainty =       0.007402719466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341279057432
                                         uncertainty =       0.007402719466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413162272
  error estimate for blocks of size 2^( 2) =       0.000424662688
  error estimate for blocks of size 2^( 3) =       0.000437460979
  error estimate for blocks of size 2^( 4) =       0.000449653873
  error estimate for blocks of size 2^( 5) =       0.000459962452
  error estimate for blocks of size 2^( 6) =       0.000468742798
  error estimate for blocks of size 2^( 7) =       0.000476758843

      target function =                  N/A
              le_mean =     -16.911042360503
             les_mean =     286.324759673585
             stat err =       0.000463779492
             autocorr =       1.260032557670
              std dev =       0.584299688135
             le_variance =       0.341406125554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341279066156
                                         uncertainty =       0.007402720114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341279066156
                                         uncertainty =       0.007402720114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413162277
  error estimate for blocks of size 2^( 2) =       0.000424662693
  error estimate for blocks of size 2^( 3) =       0.000437460983
  error estimate for blocks of size 2^( 4) =       0.000449653877
  error estimate for blocks of size 2^( 5) =       0.000459962455
  error estimate for blocks of size 2^( 6) =       0.000468742800
  error estimate for blocks of size 2^( 7) =       0.000476758845

      target function =                  N/A
              le_mean =     -16.911042360352
             les_mean =     286.324759677201
             stat err =       0.000463779494
             autocorr =       1.260032539659
              std dev =       0.584299695591
             le_variance =       0.341406134268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341279061794
                                         uncertainty =       0.007402719790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341279061794
                                         uncertainty =       0.007402719790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413162274
  error estimate for blocks of size 2^( 2) =       0.000424662690
  error estimate for blocks of size 2^( 3) =       0.000437460981
  error estimate for blocks of size 2^( 4) =       0.000449653875
  error estimate for blocks of size 2^( 5) =       0.000459962453
  error estimate for blocks of size 2^( 6) =       0.000468742799
  error estimate for blocks of size 2^( 7) =       0.000476758844

      target function =                  N/A
              le_mean =     -16.911042360428
             les_mean =     286.324759675393
             stat err =       0.000463779493
             autocorr =       1.260032548657
              std dev =       0.584299691863
             le_variance =       0.341406129911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341279057977
                                         uncertainty =       0.007402719507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341279057977
                                         uncertainty =       0.007402719507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413162272
  error estimate for blocks of size 2^( 2) =       0.000424662688
  error estimate for blocks of size 2^( 3) =       0.000437460979
  error estimate for blocks of size 2^( 4) =       0.000449653873
  error estimate for blocks of size 2^( 5) =       0.000459962452
  error estimate for blocks of size 2^( 6) =       0.000468742798
  error estimate for blocks of size 2^( 7) =       0.000476758844

      target function =                  N/A
              le_mean =     -16.911042360494
             les_mean =     286.324759673811
             stat err =       0.000463779492
             autocorr =       1.260032556534
              std dev =       0.584299688601
             le_variance =       0.341406126099


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911042360503        initial  <--
     9.7656e+03     9.7656e+04             3.7756e-08       -16.911042360352
     3.9062e+04     3.9062e+05             9.4392e-09       -16.911042360428
     1.5625e+05     1.5625e+06             2.3598e-09       -16.911042360494

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.6253
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1794e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8094
    reference variance = 0.165744
====================================================
  Execution time = 2.5623e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3035e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6020e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330108392445
                                         uncertainty =       0.004200948315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330108392445
                                         uncertainty =       0.004200948315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406416789
  error estimate for blocks of size 2^( 2) =       0.000418576019
  error estimate for blocks of size 2^( 3) =       0.000431440391
  error estimate for blocks of size 2^( 4) =       0.000443180248
  error estimate for blocks of size 2^( 5) =       0.000453323954
  error estimate for blocks of size 2^( 6) =       0.000461886099
  error estimate for blocks of size 2^( 7) =       0.000466086485

      target function =                  N/A
              le_mean =     -16.910491083813
             les_mean =     286.295057742652
             stat err =       0.000456119197
             autocorr =       1.259544227293
              std dev =       0.574760134419
             le_variance =       0.330349212117


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691049108381e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910491083813       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910491083838       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910491083831       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910491083833       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910491083836       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910491083877       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910491083837       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910491083816       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 3.424258e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910491083813       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910491083819       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910491083817       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910491083818       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910491083945       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910491083814       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910491083816       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910491083982       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 8.560650e-10

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910491083813       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910491083814       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910491083814       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910491084072       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910491084010       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910491083814       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910491083804       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910491085024       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 2.140163e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.044485 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2236e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096157e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557200e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9415
    reference variance = 0.250268
====================================================
  Execution time = 2.4859e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3717e-01
  Total weights = 2.0000e+06
  Execution time = 2.9709e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337117570474
                                         uncertainty =       0.007708293815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337117570474
                                         uncertainty =       0.007708293815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410591628
  error estimate for blocks of size 2^( 2) =       0.000421893756
  error estimate for blocks of size 2^( 3) =       0.000433353192
  error estimate for blocks of size 2^( 4) =       0.000444257124
  error estimate for blocks of size 2^( 5) =       0.000453268482
  error estimate for blocks of size 2^( 6) =       0.000459473767
  error estimate for blocks of size 2^( 7) =       0.000463829945

      target function =                  N/A
              le_mean =     -16.910763334664
             les_mean =     286.311087363149
             stat err =       0.000455207330
             autocorr =       1.229131395868
              std dev =       0.580664249572
             le_variance =       0.337170970731

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337117570762
                                         uncertainty =       0.007708293800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337117570762
                                         uncertainty =       0.007708293800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410591629
  error estimate for blocks of size 2^( 2) =       0.000421893756
  error estimate for blocks of size 2^( 3) =       0.000433353192
  error estimate for blocks of size 2^( 4) =       0.000444257124
  error estimate for blocks of size 2^( 5) =       0.000453268482
  error estimate for blocks of size 2^( 6) =       0.000459473767
  error estimate for blocks of size 2^( 7) =       0.000463829945

      target function =                  N/A
              le_mean =     -16.910763334650
             les_mean =     286.311087362967
             stat err =       0.000455207330
             autocorr =       1.229131394633
              std dev =       0.580664249822
             le_variance =       0.337170971021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337117570618
                                         uncertainty =       0.007708293807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337117570618
                                         uncertainty =       0.007708293807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410591629
  error estimate for blocks of size 2^( 2) =       0.000421893756
  error estimate for blocks of size 2^( 3) =       0.000433353192
  error estimate for blocks of size 2^( 4) =       0.000444257124
  error estimate for blocks of size 2^( 5) =       0.000453268482
  error estimate for blocks of size 2^( 6) =       0.000459473767
  error estimate for blocks of size 2^( 7) =       0.000463829945

      target function =                  N/A
              le_mean =     -16.910763334657
             les_mean =     286.311087363058
             stat err =       0.000455207330
             autocorr =       1.229131395251
              std dev =       0.580664249697
             le_variance =       0.337170970876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337117570492
                                         uncertainty =       0.007708293814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337117570492
                                         uncertainty =       0.007708293814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410591628
  error estimate for blocks of size 2^( 2) =       0.000421893756
  error estimate for blocks of size 2^( 3) =       0.000433353192
  error estimate for blocks of size 2^( 4) =       0.000444257124
  error estimate for blocks of size 2^( 5) =       0.000453268482
  error estimate for blocks of size 2^( 6) =       0.000459473767
  error estimate for blocks of size 2^( 7) =       0.000463829945

      target function =                  N/A
              le_mean =     -16.910763334663
             les_mean =     286.311087363137
             stat err =       0.000455207330
             autocorr =       1.229131395785
              std dev =       0.580664249588
             le_variance =       0.337170970749


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910763334664        initial  <--
     9.7656e+04     9.7656e+05             3.4243e-09       -16.910763334650
     3.9062e+05     3.9062e+06             8.5606e-10       -16.910763334657
     1.5625e+06     1.5625e+07             2.1402e-10       -16.910763334663

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5498
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5793e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9527
    reference variance = 0.24397
====================================================
  Execution time = 2.5582e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3776e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337847307303
                                         uncertainty =       0.010391656968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337847307303
                                         uncertainty =       0.010391656968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410947682
  error estimate for blocks of size 2^( 2) =       0.000422439015
  error estimate for blocks of size 2^( 3) =       0.000433896283
  error estimate for blocks of size 2^( 4) =       0.000445934697
  error estimate for blocks of size 2^( 5) =       0.000455616169
  error estimate for blocks of size 2^( 6) =       0.000462469523
  error estimate for blocks of size 2^( 7) =       0.000465927213

      target function =                  N/A
              le_mean =     -16.911172526608
             les_mean =     286.325512049944
             stat err =       0.000457486900
             autocorr =       1.239322278494
              std dev =       0.581167784816
             le_variance =       0.337755994108


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691117252661e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911172526608       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911172526608       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911172526609       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911172526609       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911172526543       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911172526609       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911172526370       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911172525980       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 3.682631e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911172526608       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911172526608       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911172526608       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911172527152       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911172527423       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911172526573       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911172526593       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911172526729       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 9.206581e-11

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911172526608       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911172526608       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911172526608       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911172525047       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911172526608       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911172514486       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911172534526       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911172505015       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 2.301638e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.047126 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2288e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9149
    reference variance = 0.201806
====================================================
  Execution time = 2.4965e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2859e-01
  Total weights = 2.0000e+06
  Execution time = 2.9585e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328677346351
                                         uncertainty =       0.002970003985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328677346351
                                         uncertainty =       0.002970003985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405332310
  error estimate for blocks of size 2^( 2) =       0.000416998038
  error estimate for blocks of size 2^( 3) =       0.000429511956
  error estimate for blocks of size 2^( 4) =       0.000440936208
  error estimate for blocks of size 2^( 5) =       0.000451809919
  error estimate for blocks of size 2^( 6) =       0.000459438183
  error estimate for blocks of size 2^( 7) =       0.000465913542

      target function =                  N/A
              le_mean =     -16.911085662177
             les_mean =     286.313406672300
             stat err =       0.000454524463
             autocorr =       1.257453914282
              std dev =       0.573226450123
             le_variance =       0.328588563121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328677346605
                                         uncertainty =       0.002970003987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328677346605
                                         uncertainty =       0.002970003987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405332310
  error estimate for blocks of size 2^( 2) =       0.000416998038
  error estimate for blocks of size 2^( 3) =       0.000429511956
  error estimate for blocks of size 2^( 4) =       0.000440936208
  error estimate for blocks of size 2^( 5) =       0.000451809919
  error estimate for blocks of size 2^( 6) =       0.000459438183
  error estimate for blocks of size 2^( 7) =       0.000465913542

      target function =                  N/A
              le_mean =     -16.911085662176
             les_mean =     286.313406672524
             stat err =       0.000454524463
             autocorr =       1.257453913962
              std dev =       0.573226450345
             le_variance =       0.328588563375

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328677346478
                                         uncertainty =       0.002970003986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328677346478
                                         uncertainty =       0.002970003986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405332310
  error estimate for blocks of size 2^( 2) =       0.000416998038
  error estimate for blocks of size 2^( 3) =       0.000429511956
  error estimate for blocks of size 2^( 4) =       0.000440936208
  error estimate for blocks of size 2^( 5) =       0.000451809919
  error estimate for blocks of size 2^( 6) =       0.000459438183
  error estimate for blocks of size 2^( 7) =       0.000465913542

      target function =                  N/A
              le_mean =     -16.911085662176
             les_mean =     286.313406672412
             stat err =       0.000454524463
             autocorr =       1.257453914122
              std dev =       0.573226450234
             le_variance =       0.328588563248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328677346367
                                         uncertainty =       0.002970003985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328677346367
                                         uncertainty =       0.002970003985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405332310
  error estimate for blocks of size 2^( 2) =       0.000416998038
  error estimate for blocks of size 2^( 3) =       0.000429511956
  error estimate for blocks of size 2^( 4) =       0.000440936208
  error estimate for blocks of size 2^( 5) =       0.000451809919
  error estimate for blocks of size 2^( 6) =       0.000459438183
  error estimate for blocks of size 2^( 7) =       0.000465913542

      target function =                  N/A
              le_mean =     -16.911085662177
             les_mean =     286.313406672314
             stat err =       0.000454524463
             autocorr =       1.257453914265
              std dev =       0.573226450137
             le_variance =       0.328588563137


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911085662177        initial  <--
     9.7656e+05     9.7656e+06             3.6826e-10       -16.911085662176
     3.9062e+06     3.9062e+07             9.2066e-11       -16.911085662176
     1.5625e+07     1.5625e+08             2.3016e-11       -16.911085662177

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.8454
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2140e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8906
    reference variance = 0.103093
====================================================
  Execution time = 2.5537e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2870e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7664e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328737245013
                                         uncertainty =       0.003629782811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328737245013
                                         uncertainty =       0.003629782811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405399033
  error estimate for blocks of size 2^( 2) =       0.000416706337
  error estimate for blocks of size 2^( 3) =       0.000428750851
  error estimate for blocks of size 2^( 4) =       0.000440586626
  error estimate for blocks of size 2^( 5) =       0.000450463795
  error estimate for blocks of size 2^( 6) =       0.000458014801
  error estimate for blocks of size 2^( 7) =       0.000463285390

      target function =                  N/A
              le_mean =     -16.910350953763
             les_mean =     286.288665967627
             stat err =       0.000453087653
             autocorr =       1.249105259418
              std dev =       0.573320811200
             le_variance =       0.328696752555


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691035095376e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910350953763       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910350953763       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910350953763       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910350954188       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910350958140       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910350954035       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910350948687       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910350951244       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 3.879590e-11

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910350953763       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910350953763       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910350953763       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910350953763       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910350956452       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910350932595       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910350982195       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910350957299       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+07 is 9.698852e-12

solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910350953763       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910350953763       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910350953763       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910350953787       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910351029288       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910350845428       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910350869488       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910350947777       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+08 is 2.424873e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.049809 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2314e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9073
    reference variance = 0.312079
====================================================
  Execution time = 2.5050e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3132e-01
  Total weights = 2.0000e+06
  Execution time = 2.9555e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331378897916
                                         uncertainty =       0.003837324822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331378897916
                                         uncertainty =       0.003837324822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407011908
  error estimate for blocks of size 2^( 2) =       0.000419110659
  error estimate for blocks of size 2^( 3) =       0.000431131552
  error estimate for blocks of size 2^( 4) =       0.000442771449
  error estimate for blocks of size 2^( 5) =       0.000453261842
  error estimate for blocks of size 2^( 6) =       0.000460826469
  error estimate for blocks of size 2^( 7) =       0.000464846602

      target function =                  N/A
              le_mean =     -16.911040177063
             les_mean =     286.314597091773
             stat err =       0.000455426590
             autocorr =       1.252052486709
              std dev =       0.575601760939
             le_variance =       0.331317387196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331378897939
                                         uncertainty =       0.003837324822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331378897939
                                         uncertainty =       0.003837324822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407011908
  error estimate for blocks of size 2^( 2) =       0.000419110659
  error estimate for blocks of size 2^( 3) =       0.000431131552
  error estimate for blocks of size 2^( 4) =       0.000442771449
  error estimate for blocks of size 2^( 5) =       0.000453261842
  error estimate for blocks of size 2^( 6) =       0.000460826469
  error estimate for blocks of size 2^( 7) =       0.000464846602

      target function =                  N/A
              le_mean =     -16.911040177063
             les_mean =     286.314597091793
             stat err =       0.000455426590
             autocorr =       1.252052486671
              std dev =       0.575601760959
             le_variance =       0.331317387219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331378897928
                                         uncertainty =       0.003837324822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331378897928
                                         uncertainty =       0.003837324822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407011908
  error estimate for blocks of size 2^( 2) =       0.000419110659
  error estimate for blocks of size 2^( 3) =       0.000431131552
  error estimate for blocks of size 2^( 4) =       0.000442771449
  error estimate for blocks of size 2^( 5) =       0.000453261842
  error estimate for blocks of size 2^( 6) =       0.000460826469
  error estimate for blocks of size 2^( 7) =       0.000464846602

      target function =                  N/A
              le_mean =     -16.911040177063
             les_mean =     286.314597091783
             stat err =       0.000455426590
             autocorr =       1.252052486688
              std dev =       0.575601760949
             le_variance =       0.331317387207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331378897918
                                         uncertainty =       0.003837324822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331378897918
                                         uncertainty =       0.003837324822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407011908
  error estimate for blocks of size 2^( 2) =       0.000419110659
  error estimate for blocks of size 2^( 3) =       0.000431131552
  error estimate for blocks of size 2^( 4) =       0.000442771449
  error estimate for blocks of size 2^( 5) =       0.000453261842
  error estimate for blocks of size 2^( 6) =       0.000460826469
  error estimate for blocks of size 2^( 7) =       0.000464846602

      target function =                  N/A
              le_mean =     -16.911040177063
             les_mean =     286.314597091775
             stat err =       0.000455426590
             autocorr =       1.252052486702
              std dev =       0.575601760940
             le_variance =       0.331317387197


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911040177063        initial  <--
     9.7656e+06     9.7656e+07             3.8796e-11       -16.911040177063
     3.9062e+07     3.9062e+08             9.6989e-12       -16.911040177063
     1.5625e+08     1.5625e+09             2.4249e-12       -16.911040177063

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.9575
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2281e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9041
    reference variance = 0.176773
====================================================
  Execution time = 2.5582e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2838e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.9737e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328398057175
                                         uncertainty =       0.003169989994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328398057175
                                         uncertainty =       0.003169989994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405206445
  error estimate for blocks of size 2^( 2) =       0.000417175067
  error estimate for blocks of size 2^( 3) =       0.000429766232
  error estimate for blocks of size 2^( 4) =       0.000441599921
  error estimate for blocks of size 2^( 5) =       0.000451790006
  error estimate for blocks of size 2^( 6) =       0.000462611588
  error estimate for blocks of size 2^( 7) =       0.000466820021

      target function =                  N/A
              le_mean =     -16.911068692021
             les_mean =     286.312628668353
             stat err =       0.000455705384
             autocorr =       1.264781866975
              std dev =       0.573048450212
             le_variance =       0.328384526291


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691106869202e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911068692021       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911068692021       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911068692021       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911068684548       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911068717623       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911068720570       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911068717609       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911068696778       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 4.376685e-12

solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911068692021       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911068692021       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911068692021       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911068810414       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911068722961       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911068404003       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911068739768       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911068780009       residual = 9.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+08 is 1.094285e-12

solving harmonic davidson linear method for identity shift 1.5625e+09, overlap shift 1.5625e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911068692021       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911068692021       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911068692021       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911068473871       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911068041479       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911067695596       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911068228508       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911068710261       residual = 9.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+09 is 2.738512e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.052470 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2567e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.7737
    reference variance = 0.395246
====================================================
  Execution time = 2.4888e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3551e-01
  Total weights = 2.0000e+06
  Execution time = 2.9508e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335259652765
                                         uncertainty =       0.005320512352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335259652765
                                         uncertainty =       0.005320512352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409580434
  error estimate for blocks of size 2^( 2) =       0.000421231596
  error estimate for blocks of size 2^( 3) =       0.000433764861
  error estimate for blocks of size 2^( 4) =       0.000446283700
  error estimate for blocks of size 2^( 5) =       0.000457836146
  error estimate for blocks of size 2^( 6) =       0.000465186147
  error estimate for blocks of size 2^( 7) =       0.000468693625

      target function =                  N/A
              le_mean =     -16.910165099377
             les_mean =     286.289195783551
             stat err =       0.000459499904
             autocorr =       1.258613680353
              std dev =       0.579234204032
             le_variance =       0.335512263120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335259652767
                                         uncertainty =       0.005320512352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335259652767
                                         uncertainty =       0.005320512352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409580434
  error estimate for blocks of size 2^( 2) =       0.000421231596
  error estimate for blocks of size 2^( 3) =       0.000433764861
  error estimate for blocks of size 2^( 4) =       0.000446283700
  error estimate for blocks of size 2^( 5) =       0.000457836146
  error estimate for blocks of size 2^( 6) =       0.000465186147
  error estimate for blocks of size 2^( 7) =       0.000468693625

      target function =                  N/A
              le_mean =     -16.910165099377
             les_mean =     286.289195783553
             stat err =       0.000459499904
             autocorr =       1.258613680348
              std dev =       0.579234204034
             le_variance =       0.335512263123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335259652766
                                         uncertainty =       0.005320512352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335259652766
                                         uncertainty =       0.005320512352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409580434
  error estimate for blocks of size 2^( 2) =       0.000421231596
  error estimate for blocks of size 2^( 3) =       0.000433764861
  error estimate for blocks of size 2^( 4) =       0.000446283700
  error estimate for blocks of size 2^( 5) =       0.000457836146
  error estimate for blocks of size 2^( 6) =       0.000465186147
  error estimate for blocks of size 2^( 7) =       0.000468693625

      target function =                  N/A
              le_mean =     -16.910165099377
             les_mean =     286.289195783552
             stat err =       0.000459499904
             autocorr =       1.258613680353
              std dev =       0.579234204033
             le_variance =       0.335512263121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335259652765
                                         uncertainty =       0.005320512352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335259652765
                                         uncertainty =       0.005320512352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409580434
  error estimate for blocks of size 2^( 2) =       0.000421231596
  error estimate for blocks of size 2^( 3) =       0.000433764861
  error estimate for blocks of size 2^( 4) =       0.000446283700
  error estimate for blocks of size 2^( 5) =       0.000457836146
  error estimate for blocks of size 2^( 6) =       0.000465186147
  error estimate for blocks of size 2^( 7) =       0.000468693625

      target function =                  N/A
              le_mean =     -16.910165099377
             les_mean =     286.289195783551
             stat err =       0.000459499904
             autocorr =       1.258613680350
              std dev =       0.579234204032
             le_variance =       0.335512263120


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910165099377        initial
     9.7656e+07     9.7656e+08             4.3767e-12       -16.910165099377  <--
     3.9062e+08     3.9062e+09             1.0943e-12       -16.910165099377
     1.5625e+09     1.5625e+10             2.7385e-13       -16.910165099377

*****************************************************************************
Applying the update for shift_i =   9.7656e+07     and shift_s =   9.7656e+08
*****************************************************************************

  Execution time = 3.9734e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2309e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9165
    reference variance = 0.347934
====================================================
  Execution time = 2.5529e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2757e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7077e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327509567671
                                         uncertainty =       0.004196280050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327509567671
                                         uncertainty =       0.004196280050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404703591
  error estimate for blocks of size 2^( 2) =       0.000416641950
  error estimate for blocks of size 2^( 3) =       0.000428978687
  error estimate for blocks of size 2^( 4) =       0.000440657448
  error estimate for blocks of size 2^( 5) =       0.000451801955
  error estimate for blocks of size 2^( 6) =       0.000459200151
  error estimate for blocks of size 2^( 7) =       0.000464463615

      target function =                  N/A
              le_mean =     -16.911321105995
             les_mean =     286.320351380209
             stat err =       0.000454030792
             autocorr =       1.258625418430
              std dev =       0.572337307832
             le_variance =       0.327569993936


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691132110599e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911321105995       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911321105995       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911321105995       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911321105995       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911321111671       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911321105943       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911321109599       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911321101672       residual = 7.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 1.864232e-11

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911321105995       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911321105995       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911321105995       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911321092900       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911321100130       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911321070246       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911321084891       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911321108353       residual = 7.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 4.660366e-12

solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911321105995       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911321105995       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911321105995       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911321105995       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911321074608       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911321101242       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911320870378       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911321312670       residual = 7.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+08 is 1.164998e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055112 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2248e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8235
    reference variance = 0.398157
====================================================
  Execution time = 2.4944e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4196e-01
  Total weights = 2.0000e+06
  Execution time = 2.9575e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341914925180
                                         uncertainty =       0.007664210160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341914925180
                                         uncertainty =       0.007664210160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413497779
  error estimate for blocks of size 2^( 2) =       0.000425188423
  error estimate for blocks of size 2^( 3) =       0.000437293353
  error estimate for blocks of size 2^( 4) =       0.000448059434
  error estimate for blocks of size 2^( 5) =       0.000457699514
  error estimate for blocks of size 2^( 6) =       0.000464419332
  error estimate for blocks of size 2^( 7) =       0.000467116582

      target function =                  N/A
              le_mean =     -16.910737516423
             les_mean =     286.315004005129
             stat err =       0.000459323716
             autocorr =       1.233932422506
              std dev =       0.584774167303
             le_variance =       0.341960826745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341914925190
                                         uncertainty =       0.007664210160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341914925190
                                         uncertainty =       0.007664210160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413497779
  error estimate for blocks of size 2^( 2) =       0.000425188423
  error estimate for blocks of size 2^( 3) =       0.000437293353
  error estimate for blocks of size 2^( 4) =       0.000448059434
  error estimate for blocks of size 2^( 5) =       0.000457699514
  error estimate for blocks of size 2^( 6) =       0.000464419332
  error estimate for blocks of size 2^( 7) =       0.000467116582

      target function =                  N/A
              le_mean =     -16.910737516423
             les_mean =     286.315004005137
             stat err =       0.000459323716
             autocorr =       1.233932422498
              std dev =       0.584774167312
             le_variance =       0.341960826755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341914925185
                                         uncertainty =       0.007664210160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341914925185
                                         uncertainty =       0.007664210160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413497779
  error estimate for blocks of size 2^( 2) =       0.000425188423
  error estimate for blocks of size 2^( 3) =       0.000437293353
  error estimate for blocks of size 2^( 4) =       0.000448059434
  error estimate for blocks of size 2^( 5) =       0.000457699514
  error estimate for blocks of size 2^( 6) =       0.000464419332
  error estimate for blocks of size 2^( 7) =       0.000467116582

      target function =                  N/A
              le_mean =     -16.910737516423
             les_mean =     286.315004005133
             stat err =       0.000459323716
             autocorr =       1.233932422506
              std dev =       0.584774167307
             le_variance =       0.341960826750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341914925181
                                         uncertainty =       0.007664210160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341914925181
                                         uncertainty =       0.007664210160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413497779
  error estimate for blocks of size 2^( 2) =       0.000425188423
  error estimate for blocks of size 2^( 3) =       0.000437293353
  error estimate for blocks of size 2^( 4) =       0.000448059434
  error estimate for blocks of size 2^( 5) =       0.000457699514
  error estimate for blocks of size 2^( 6) =       0.000464419332
  error estimate for blocks of size 2^( 7) =       0.000467116582

      target function =                  N/A
              le_mean =     -16.910737516423
             les_mean =     286.315004005129
             stat err =       0.000459323716
             autocorr =       1.233932422507
              std dev =       0.584774167304
             le_variance =       0.341960826746


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910737516423        initial  <--
     2.4414e+07     2.4414e+08             1.8642e-11       -16.910737516423
     9.7656e+07     9.7656e+08             4.6604e-12       -16.910737516423
     3.9062e+08     3.9062e+09             1.1650e-12       -16.910737516423

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.8242
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2080e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.933
    reference variance = 0.140304
====================================================
  Execution time = 2.7537e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3887e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6049e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338994169065
                                         uncertainty =       0.005179745930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338994169065
                                         uncertainty =       0.005179745930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411623273
  error estimate for blocks of size 2^( 2) =       0.000423455590
  error estimate for blocks of size 2^( 3) =       0.000435891588
  error estimate for blocks of size 2^( 4) =       0.000448548411
  error estimate for blocks of size 2^( 5) =       0.000460530014
  error estimate for blocks of size 2^( 6) =       0.000468772833
  error estimate for blocks of size 2^( 7) =       0.000476033314

      target function =                  N/A
              le_mean =     -16.910606015655
             les_mean =     286.307463084832
             stat err =       0.000463471143
             autocorr =       1.267784842253
              std dev =       0.582123215092
             le_variance =       0.338867437549


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691060601566e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910606015655       residual = 9.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910606015655       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910606015655       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910606015655       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910605828567       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910605958300       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910605982288       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910606028102       residual = 7.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+08 is 1.743892e-12

solving harmonic davidson linear method for identity shift 9.7656e+08, overlap shift 9.7656e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910606015655       residual = 9.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910606015655       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910606015655       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910606173774       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910605862374       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910605904344       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910606282630       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910605973859       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+08 is 4.359149e-13

solving harmonic davidson linear method for identity shift 3.9062e+09, overlap shift 3.9062e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910606015655       residual = 9.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910606015655       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910606015655       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910606015655       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910606015655       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910606736675       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910608533412       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910602946526       residual = 9.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+09 is 1.088479e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057708 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4154e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9017
    reference variance = 0.233339
====================================================
  Execution time = 2.4815e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3863e-01
  Total weights = 2.0000e+06
  Execution time = 2.9729e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338714163198
                                         uncertainty =       0.007901377684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338714163198
                                         uncertainty =       0.007901377684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411481268
  error estimate for blocks of size 2^( 2) =       0.000422564768
  error estimate for blocks of size 2^( 3) =       0.000435188411
  error estimate for blocks of size 2^( 4) =       0.000446646661
  error estimate for blocks of size 2^( 5) =       0.000458803562
  error estimate for blocks of size 2^( 6) =       0.000465962617
  error estimate for blocks of size 2^( 7) =       0.000473791442

      target function =                  N/A
              le_mean =     -16.910386565655
             les_mean =     286.299807298567
             stat err =       0.000461301071
             autocorr =       1.256807564784
              std dev =       0.581922390000
             le_variance =       0.338633667983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338714163198
                                         uncertainty =       0.007901377684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338714163198
                                         uncertainty =       0.007901377684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411481268
  error estimate for blocks of size 2^( 2) =       0.000422564768
  error estimate for blocks of size 2^( 3) =       0.000435188411
  error estimate for blocks of size 2^( 4) =       0.000446646661
  error estimate for blocks of size 2^( 5) =       0.000458803562
  error estimate for blocks of size 2^( 6) =       0.000465962617
  error estimate for blocks of size 2^( 7) =       0.000473791442

      target function =                  N/A
              le_mean =     -16.910386565655
             les_mean =     286.299807298568
             stat err =       0.000461301071
             autocorr =       1.256807564785
              std dev =       0.581922390000
             le_variance =       0.338633667984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338714163198
                                         uncertainty =       0.007901377684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338714163198
                                         uncertainty =       0.007901377684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411481268
  error estimate for blocks of size 2^( 2) =       0.000422564768
  error estimate for blocks of size 2^( 3) =       0.000435188411
  error estimate for blocks of size 2^( 4) =       0.000446646661
  error estimate for blocks of size 2^( 5) =       0.000458803562
  error estimate for blocks of size 2^( 6) =       0.000465962617
  error estimate for blocks of size 2^( 7) =       0.000473791442

      target function =                  N/A
              le_mean =     -16.910386565655
             les_mean =     286.299807298567
             stat err =       0.000461301071
             autocorr =       1.256807564785
              std dev =       0.581922390000
             le_variance =       0.338633667983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338714163198
                                         uncertainty =       0.007901377684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338714163198
                                         uncertainty =       0.007901377684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411481268
  error estimate for blocks of size 2^( 2) =       0.000422564768
  error estimate for blocks of size 2^( 3) =       0.000435188411
  error estimate for blocks of size 2^( 4) =       0.000446646661
  error estimate for blocks of size 2^( 5) =       0.000458803562
  error estimate for blocks of size 2^( 6) =       0.000465962617
  error estimate for blocks of size 2^( 7) =       0.000473791442

      target function =                  N/A
              le_mean =     -16.910386565655
             les_mean =     286.299807298567
             stat err =       0.000461301071
             autocorr =       1.256807564783
              std dev =       0.581922390000
             le_variance =       0.338633667983


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910386565655        initial  <--
     2.4414e+08     2.4414e+09             1.7439e-12       -16.910386565655
     9.7656e+08     9.7656e+09             4.3591e-13       -16.910386565655
     3.9062e+09     3.9062e+10             1.0885e-13       -16.910386565655

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.7259
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3903e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9743
    reference variance = 0.410526
====================================================
  Execution time = 2.5567e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3228e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6834e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332322653284
                                         uncertainty =       0.004762435181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332322653284
                                         uncertainty =       0.004762435181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407601823
  error estimate for blocks of size 2^( 2) =       0.000419681049
  error estimate for blocks of size 2^( 3) =       0.000431809446
  error estimate for blocks of size 2^( 4) =       0.000444217219
  error estimate for blocks of size 2^( 5) =       0.000453684476
  error estimate for blocks of size 2^( 6) =       0.000463017614
  error estimate for blocks of size 2^( 7) =       0.000466324928

      target function =                  N/A
              le_mean =     -16.910781837820
             les_mean =     286.306820691991
             stat err =       0.000456811059
             autocorr =       1.256032808546
              std dev =       0.576436025756
             le_variance =       0.332278491789


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691078183782e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+09, overlap shift 2.4414e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910781837820       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910781837820       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910781837820       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910781837820       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910781548832       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910780036832       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910781899278       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910782042437       residual = 6.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+09 is 1.837824e-13

solving harmonic davidson linear method for identity shift 9.7656e+09, overlap shift 9.7656e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910781837820       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910781837820       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910781837820       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910780308716       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910781953943       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910778923983       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910784142851       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910782736470       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+09 is 4.602874e-14

solving harmonic davidson linear method for identity shift 3.9062e+10, overlap shift 3.9062e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910781837820       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910781837820       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910781837820       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910803634042       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910786002081       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910795664390       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910753467069       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910819770914       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910455164782       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911003700689       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910817102914       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910339355979       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.911237709218       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.912643355566       residual = 4.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.912372518986       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909710701621       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909080589275       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.912040643606       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.911674656624       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.913880397676       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905549935755       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.908211276673       residual = 8.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.911205689579       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.910191335143       residual = 5.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.912940472000       residual = 5.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.913709619233       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.916226719193       residual = 5.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.908895528968       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.928227383513       residual = 4.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.914044000737       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.912070274548       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.906959072996       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.909001636279       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.908842991241       residual = 4.87e-04           smallest_sin_value = 9.99e-01
davidson iteration   34:   krylov dim =  35   energy =     -16.915941264993       residual = 3.88e-03           smallest_sin_value = 9.93e-01
davidson iteration   35 stopping due to small subspace S singular value of 9.43e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+10 is 1.156285e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.080057 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2282e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9931
    reference variance = 0.318754
====================================================
  Execution time = 2.5230e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3180e-01
  Total weights = 2.0000e+06
  Execution time = 2.9744e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331827331996
                                         uncertainty =       0.004584563905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331827331996
                                         uncertainty =       0.004584563905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407309648
  error estimate for blocks of size 2^( 2) =       0.000419792806
  error estimate for blocks of size 2^( 3) =       0.000432283379
  error estimate for blocks of size 2^( 4) =       0.000444075709
  error estimate for blocks of size 2^( 5) =       0.000454632555
  error estimate for blocks of size 2^( 6) =       0.000464666193
  error estimate for blocks of size 2^( 7) =       0.000467639909

      target function =                  N/A
              le_mean =     -16.910998750475
             les_mean =     286.313680871646
             stat err =       0.000457753592
             autocorr =       1.263031336368
              std dev =       0.576022828518
             le_variance =       0.331802298974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331827331996
                                         uncertainty =       0.004584563905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331827331996
                                         uncertainty =       0.004584563905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407309648
  error estimate for blocks of size 2^( 2) =       0.000419792806
  error estimate for blocks of size 2^( 3) =       0.000432283379
  error estimate for blocks of size 2^( 4) =       0.000444075709
  error estimate for blocks of size 2^( 5) =       0.000454632555
  error estimate for blocks of size 2^( 6) =       0.000464666193
  error estimate for blocks of size 2^( 7) =       0.000467639909

      target function =                  N/A
              le_mean =     -16.910998750475
             les_mean =     286.313680871646
             stat err =       0.000457753592
             autocorr =       1.263031336364
              std dev =       0.576022828518
             le_variance =       0.331802298974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331827331996
                                         uncertainty =       0.004584563905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331827331996
                                         uncertainty =       0.004584563905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407309648
  error estimate for blocks of size 2^( 2) =       0.000419792806
  error estimate for blocks of size 2^( 3) =       0.000432283379
  error estimate for blocks of size 2^( 4) =       0.000444075709
  error estimate for blocks of size 2^( 5) =       0.000454632555
  error estimate for blocks of size 2^( 6) =       0.000464666193
  error estimate for blocks of size 2^( 7) =       0.000467639909

      target function =                  N/A
              le_mean =     -16.910998750475
             les_mean =     286.313680871646
             stat err =       0.000457753592
             autocorr =       1.263031336368
              std dev =       0.576022828518
             le_variance =       0.331802298974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331827331996
                                         uncertainty =       0.004584563905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331827331996
                                         uncertainty =       0.004584563905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407309648
  error estimate for blocks of size 2^( 2) =       0.000419792806
  error estimate for blocks of size 2^( 3) =       0.000432283379
  error estimate for blocks of size 2^( 4) =       0.000444075709
  error estimate for blocks of size 2^( 5) =       0.000454632555
  error estimate for blocks of size 2^( 6) =       0.000464666193
  error estimate for blocks of size 2^( 7) =       0.000467639909

      target function =                  N/A
              le_mean =     -16.910998750475
             les_mean =     286.313680871646
             stat err =       0.000457753592
             autocorr =       1.263031336368
              std dev =       0.576022828518
             le_variance =       0.331802298974


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910998750475        initial  <--
     2.4414e+09     2.4414e+10             1.8378e-13       -16.910998750475
     9.7656e+09     9.7656e+10             4.6029e-14       -16.910998750475
     3.9062e+10     3.9062e+11             1.1563e-14       -16.910998750475

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.1841
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2473e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.958
    reference variance = 0.353675
====================================================
  Execution time = 2.5614e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3085e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6352e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330977813769
                                         uncertainty =       0.003820254331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330977813769
                                         uncertainty =       0.003820254331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406724897
  error estimate for blocks of size 2^( 2) =       0.000418571865
  error estimate for blocks of size 2^( 3) =       0.000431299255
  error estimate for blocks of size 2^( 4) =       0.000443162743
  error estimate for blocks of size 2^( 5) =       0.000455002059
  error estimate for blocks of size 2^( 6) =       0.000462853661
  error estimate for blocks of size 2^( 7) =       0.000464457508

      target function =                  N/A
              le_mean =     -16.910478314420
             les_mean =     286.295126941423
             stat err =       0.000456368993
             autocorr =       1.259014530412
              std dev =       0.575195866111
             le_variance =       0.330850284391


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691047831442e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+10, overlap shift 2.4414e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910478314420       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910478314420       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910478314420       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910478314420       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910478211878       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910477761386       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910467984698       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910324155600       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910486861046       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910491863702       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910487078961       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910438457272       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910418820710       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910392801208       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910478402648       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910467356999       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910414210973       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.909895639649       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.910092656040       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.910149835478       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905055193761       residual = 3.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.911502668555       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.911748904816       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.910960701880       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.912653178809       residual = 6.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.908839902361       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.908653667566       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.912294840485       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.909194042967       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.909727910599       residual = 7.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.912322913576       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.909230066665       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.910157469646       residual = 8.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.911901274087       residual = 3.02e-04           smallest_sin_value = 9.99e-01
davidson iteration   34:   krylov dim =  35   energy =     -16.910390328594       residual = 1.69e-04           smallest_sin_value = 9.97e-01
davidson iteration   35 stopping due to small subspace S singular value of 9.63e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+10 is 1.504878e-14

solving harmonic davidson linear method for identity shift 9.7656e+10, overlap shift 9.7656e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910478314420       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910478314420       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910478314420       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910478314420       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910488341855       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910550082358       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910540229120       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910282026558       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910717442230       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910290630099       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909637918987       residual = 9.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910868535918       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910997576098       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909413946485       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.911556718685       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910188413507       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.912986126816       residual = 8.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.899993112344       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.916414315913       residual = 4.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906374954309       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.902778056124       residual = 7.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.900494401472       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.912329340804       residual = 4.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.904965395337       residual = 3.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.917470299996       residual = 6.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.915806388879       residual = 3.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.914129990302       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.895719170222       residual = 3.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.906445789460       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.914123279095       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.899749798440       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.903744680458       residual = 6.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.913170273753       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.930498727678       residual = 5.95e-02           smallest_sin_value = 9.99e-01
davidson iteration   34:   krylov dim =  35   energy =     -16.889889978371       residual = 6.24e-02           smallest_sin_value = 9.99e-01
davidson iteration   35 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+10 is 4.008323e-15

solving harmonic davidson linear method for identity shift 3.9062e+11, overlap shift 3.9062e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910478314420       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910478314420       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910478314420       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910113070586       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910477502390       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910392633803       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910420306054       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910271929979       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911721172561       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907324233865       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.914302120533       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.916288316236       residual = 4.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.919587639612       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909862312473       residual = 9.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.926342336663       residual = 3.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.914703325626       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.887959625914       residual = 6.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.994090156931       residual = 9.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.884640980453       residual = 8.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.938737798625       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.952203735413       residual = 2.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.924512533463       residual = 2.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906358148081       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.901416765739       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.941373845300       residual = 1.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.938327651880       residual = 9.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.900841845880       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.930476382027       residual = 4.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.931240617744       residual = 5.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.917115092195       residual = 5.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.956056723165       residual = 2.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.936804307616       residual = 8.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.888631601374       residual = 6.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.876673916756       residual = 1.96e-01           smallest_sin_value = 9.99e-01
davidson iteration   34:   krylov dim =  35   energy =     -16.811799240925       residual = 1.14e+00           smallest_sin_value = 9.95e-01
davidson iteration   35 stopping due to small subspace S singular value of 9.61e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+11 is 9.109753e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135586 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2316e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8503
    reference variance = 0.230965
====================================================
  Execution time = 2.4830e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2722e-01
  Total weights = 2.0000e+06
  Execution time = 2.9728e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327230493722
                                         uncertainty =       0.004431783400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327230493722
                                         uncertainty =       0.004431783400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404487772
  error estimate for blocks of size 2^( 2) =       0.000415870534
  error estimate for blocks of size 2^( 3) =       0.000427973900
  error estimate for blocks of size 2^( 4) =       0.000438872986
  error estimate for blocks of size 2^( 5) =       0.000449302019
  error estimate for blocks of size 2^( 6) =       0.000457969648
  error estimate for blocks of size 2^( 7) =       0.000461514338

      target function =                  N/A
              le_mean =     -16.910354695197
             les_mean =     286.287316469659
             stat err =       0.000451914748
             autocorr =       1.248251894683
              std dev =       0.572032093416
             le_variance =       0.327220715898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327230493722
                                         uncertainty =       0.004431783400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327230493722
                                         uncertainty =       0.004431783400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404487772
  error estimate for blocks of size 2^( 2) =       0.000415870534
  error estimate for blocks of size 2^( 3) =       0.000427973900
  error estimate for blocks of size 2^( 4) =       0.000438872986
  error estimate for blocks of size 2^( 5) =       0.000449302019
  error estimate for blocks of size 2^( 6) =       0.000457969648
  error estimate for blocks of size 2^( 7) =       0.000461514338

      target function =                  N/A
              le_mean =     -16.910354695197
             les_mean =     286.287316469659
             stat err =       0.000451914748
             autocorr =       1.248251894684
              std dev =       0.572032093416
             le_variance =       0.327220715898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327230493722
                                         uncertainty =       0.004431783400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327230493722
                                         uncertainty =       0.004431783400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404487772
  error estimate for blocks of size 2^( 2) =       0.000415870534
  error estimate for blocks of size 2^( 3) =       0.000427973900
  error estimate for blocks of size 2^( 4) =       0.000438872986
  error estimate for blocks of size 2^( 5) =       0.000449302019
  error estimate for blocks of size 2^( 6) =       0.000457969648
  error estimate for blocks of size 2^( 7) =       0.000461514338

      target function =                  N/A
              le_mean =     -16.910354695197
             les_mean =     286.287316469659
             stat err =       0.000451914748
             autocorr =       1.248251894684
              std dev =       0.572032093416
             le_variance =       0.327220715898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327230493722
                                         uncertainty =       0.004431783400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327230493722
                                         uncertainty =       0.004431783400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404487772
  error estimate for blocks of size 2^( 2) =       0.000415870534
  error estimate for blocks of size 2^( 3) =       0.000427973900
  error estimate for blocks of size 2^( 4) =       0.000438872986
  error estimate for blocks of size 2^( 5) =       0.000449302019
  error estimate for blocks of size 2^( 6) =       0.000457969648
  error estimate for blocks of size 2^( 7) =       0.000461514338

      target function =                  N/A
              le_mean =     -16.910354695197
             les_mean =     286.287316469659
             stat err =       0.000451914748
             autocorr =       1.248251894682
              std dev =       0.572032093416
             le_variance =       0.327220715898


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910354695197        initial
     2.4414e+10     2.4414e+11             1.5049e-14       -16.910354695197
     9.7656e+10     9.7656e+11             4.0083e-15       -16.910354695197
     3.9062e+11     3.9062e+12             9.1098e-16       -16.910354695197  <--

*****************************************************************************
Applying the update for shift_i =   3.9062e+11     and shift_s =   3.9062e+12
*****************************************************************************

  Execution time = 3.9830e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2156e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8388
    reference variance = 0.356777
====================================================
  Execution time = 2.5530e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3001e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7130e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330009215423
                                         uncertainty =       0.005598295977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330009215423
                                         uncertainty =       0.005598295977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406205870
  error estimate for blocks of size 2^( 2) =       0.000417969317
  error estimate for blocks of size 2^( 3) =       0.000429890126
  error estimate for blocks of size 2^( 4) =       0.000441554041
  error estimate for blocks of size 2^( 5) =       0.000452070536
  error estimate for blocks of size 2^( 6) =       0.000459767300
  error estimate for blocks of size 2^( 7) =       0.000464606896

      target function =                  N/A
              le_mean =     -16.911224827191
             les_mean =     286.319531408896
             stat err =       0.000454499693
             autocorr =       1.251914870924
              std dev =       0.574461850856
             le_variance =       0.330006418089


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691122482719e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+10, overlap shift 9.7656e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911224827191       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911224827191       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911224827191       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911166924533       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911227256100       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911175884222       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911227176899       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911239941530       residual = 9.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911316914114       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911212758187       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911346490832       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.911938534336       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910563406673       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.911313599425       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.911786444416       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909531649809       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.911087125918       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.913165915442       residual = 5.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.909353864022       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.911960257516       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.910541217180       residual = 8.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.920002396430       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.895820897129       residual = 3.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.899610721391       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.903868653421       residual = 7.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.904921100160       residual = 5.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.907099560808       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.910455815785       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.914898333513       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.904766468431       residual = 7.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.909806144105       residual = 6.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.905461240228       residual = 4.38e-03           smallest_sin_value = 9.98e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.917278705999       residual = 6.54e-03           smallest_sin_value = 9.94e-01
davidson iteration   33 stopping due to small subspace S singular value of 8.84e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+10 is 4.770902e-15

solving harmonic davidson linear method for identity shift 3.9062e+11, overlap shift 3.9062e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911224827191       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911224827191       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911224827191       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911224827191       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911324336230       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911436764409       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911464648571       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910644713787       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.912652285007       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911292698795       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910314434337       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.911960717691       residual = 9.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910217924304       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.892340510054       residual = 4.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.917815304610       residual = 5.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.914496328132       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906211869658       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.880765090220       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.893482130419       residual = 4.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.844022931792       residual = 5.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.925973976818       residual = 3.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.881521654989       residual = 1.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.926530617589       residual = 3.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.884889903348       residual = 9.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.881945777115       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.914668949496       residual = 7.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.959716397456       residual = 3.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.941386533088       residual = 1.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.837497407104       residual = 6.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.931484166152       residual = 7.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.945671397839       residual = 1.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.922208353963       residual = 1.74e-02           smallest_sin_value = 9.98e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.936333251820       residual = 8.35e-02           smallest_sin_value = 9.90e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.49e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+11 is 5.466398e-16

solving harmonic davidson linear method for identity shift 1.5625e+12, overlap shift 1.5625e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911224827191       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911224827191       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.36e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166722 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2282e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8693
    reference variance = 0.424661
====================================================
  Execution time = 2.5256e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3182e-01
  Total weights = 2.0000e+06
  Execution time = 2.9796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331420834327
                                         uncertainty =       0.004289654843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331420834327
                                         uncertainty =       0.004289654843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407317837
  error estimate for blocks of size 2^( 2) =       0.000419285270
  error estimate for blocks of size 2^( 3) =       0.000431484555
  error estimate for blocks of size 2^( 4) =       0.000443348653
  error estimate for blocks of size 2^( 5) =       0.000453991091
  error estimate for blocks of size 2^( 6) =       0.000460785590
  error estimate for blocks of size 2^( 7) =       0.000467783503

      target function =                  N/A
              le_mean =     -16.910837675595
             les_mean =     286.308246364446
             stat err =       0.000456477209
             autocorr =       1.255947082913
              std dev =       0.576034408719
             le_variance =       0.331815640029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331420834327
                                         uncertainty =       0.004289654843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331420834327
                                         uncertainty =       0.004289654843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407317837
  error estimate for blocks of size 2^( 2) =       0.000419285270
  error estimate for blocks of size 2^( 3) =       0.000431484555
  error estimate for blocks of size 2^( 4) =       0.000443348653
  error estimate for blocks of size 2^( 5) =       0.000453991091
  error estimate for blocks of size 2^( 6) =       0.000460785590
  error estimate for blocks of size 2^( 7) =       0.000467783503

      target function =                  N/A
              le_mean =     -16.910837675595
             les_mean =     286.308246364446
             stat err =       0.000456477209
             autocorr =       1.255947082909
              std dev =       0.576034408719
             le_variance =       0.331815640029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331420834327
                                         uncertainty =       0.004289654843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331420834327
                                         uncertainty =       0.004289654843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407317837
  error estimate for blocks of size 2^( 2) =       0.000419285270
  error estimate for blocks of size 2^( 3) =       0.000431484555
  error estimate for blocks of size 2^( 4) =       0.000443348653
  error estimate for blocks of size 2^( 5) =       0.000453991091
  error estimate for blocks of size 2^( 6) =       0.000460785590
  error estimate for blocks of size 2^( 7) =       0.000467783503

      target function =                  N/A
              le_mean =     -16.910837675595
             les_mean =     286.308246364446
             stat err =       0.000456477209
             autocorr =       1.255947082911
              std dev =       0.576034408719
             le_variance =       0.331815640029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331420834327
                                         uncertainty =       0.004289654843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331420834327
                                         uncertainty =       0.004289654843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407317837
  error estimate for blocks of size 2^( 2) =       0.000419285270
  error estimate for blocks of size 2^( 3) =       0.000431484555
  error estimate for blocks of size 2^( 4) =       0.000443348653
  error estimate for blocks of size 2^( 5) =       0.000453991091
  error estimate for blocks of size 2^( 6) =       0.000460785590
  error estimate for blocks of size 2^( 7) =       0.000467783503

      target function =                  N/A
              le_mean =     -16.910837675595
             les_mean =     286.308246364446
             stat err =       0.000456477209
             autocorr =       1.255947082913
              std dev =       0.576034408719
             le_variance =       0.331815640029


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910837675595        initial  <--
     9.7656e+10     9.7656e+11             4.7709e-15       -16.910837675595
     3.9062e+11     3.9062e+12             5.4664e-16       -16.910837675595
     1.5625e+12     1.5625e+13             0.0000e+00       -16.910837675595

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.2586
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2563e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8857
    reference variance = 0.238728
====================================================
  Execution time = 2.7746e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.6863e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7698e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.368745358103
                                         uncertainty =       0.035591780712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.368745358103
                                         uncertainty =       0.035591780712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000429321969
  error estimate for blocks of size 2^( 2) =       0.000440897129
  error estimate for blocks of size 2^( 3) =       0.000453059571
  error estimate for blocks of size 2^( 4) =       0.000464795487
  error estimate for blocks of size 2^( 5) =       0.000476331226
  error estimate for blocks of size 2^( 6) =       0.000484065859
  error estimate for blocks of size 2^( 7) =       0.000490018266

      target function =                  N/A
              le_mean =     -16.910473622758
             les_mean =     286.332752667561
             stat err =       0.000478802709
             autocorr =       1.243789751480
              std dev =       0.607152950981
             le_variance =       0.368634705885


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691047362276e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+11, overlap shift 9.7656e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910473622758       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910473622758       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910473622758       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910475689865       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910448667261       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910613251213       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909998893669       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911240282764       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911128904418       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910139487504       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.920901993778       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.920546438177       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.911582166910       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.918080617079       residual = 8.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.914887021889       residual = 3.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907436089898       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.791314376784       residual = 1.90e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.947243910693       residual = 2.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.040976047323       residual = 2.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.883272208480       residual = 8.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.864664095072       residual = 2.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.817475850395       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.911085157745       residual = 4.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.926119933915       residual = 6.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.984923511745       residual = 6.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.937683473670       residual = 1.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.885004760130       residual = 1.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.669880630823       residual = 7.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.004919016127       residual = 1.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.960299753705       residual = 3.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.913034023288       residual = 2.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.852305691079       residual = 4.31e-01           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.900909041907       residual = 1.41e-02           smallest_sin_value = 9.99e-01
davidson iteration   33:   krylov dim =  34   energy =     -16.816168667328       residual = 1.05e+00           smallest_sin_value = 9.95e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.65e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+11 is 3.735607e-16

solving harmonic davidson linear method for identity shift 3.9062e+12, overlap shift 3.9062e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910473622758       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910473622758       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5625e+13, overlap shift 1.5625e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910473622758       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910473622758       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+13 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184772 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4543e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9236
    reference variance = 0.263071
====================================================
  Execution time = 2.5080e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3074e-01
  Total weights = 2.0000e+06
  Execution time = 2.9679e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330803143741
                                         uncertainty =       0.004068936753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330803143741
                                         uncertainty =       0.004068936753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406658669
  error estimate for blocks of size 2^( 2) =       0.000418493419
  error estimate for blocks of size 2^( 3) =       0.000431321372
  error estimate for blocks of size 2^( 4) =       0.000443041897
  error estimate for blocks of size 2^( 5) =       0.000453163561
  error estimate for blocks of size 2^( 6) =       0.000462080898
  error estimate for blocks of size 2^( 7) =       0.000468402296

      target function =                  N/A
              le_mean =     -16.910976470349
             les_mean =     286.311867562269
             stat err =       0.000456672163
             autocorr =       1.261098497909
              std dev =       0.575102205657
             le_variance =       0.330742546952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330803143741
                                         uncertainty =       0.004068936753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330803143741
                                         uncertainty =       0.004068936753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406658669
  error estimate for blocks of size 2^( 2) =       0.000418493419
  error estimate for blocks of size 2^( 3) =       0.000431321372
  error estimate for blocks of size 2^( 4) =       0.000443041897
  error estimate for blocks of size 2^( 5) =       0.000453163561
  error estimate for blocks of size 2^( 6) =       0.000462080898
  error estimate for blocks of size 2^( 7) =       0.000468402296

      target function =                  N/A
              le_mean =     -16.910976470349
             les_mean =     286.311867562269
             stat err =       0.000456672163
             autocorr =       1.261098497911
              std dev =       0.575102205657
             le_variance =       0.330742546952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330803143741
                                         uncertainty =       0.004068936753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330803143741
                                         uncertainty =       0.004068936753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406658669
  error estimate for blocks of size 2^( 2) =       0.000418493419
  error estimate for blocks of size 2^( 3) =       0.000431321372
  error estimate for blocks of size 2^( 4) =       0.000443041897
  error estimate for blocks of size 2^( 5) =       0.000453163561
  error estimate for blocks of size 2^( 6) =       0.000462080898
  error estimate for blocks of size 2^( 7) =       0.000468402296

      target function =                  N/A
              le_mean =     -16.910976470349
             les_mean =     286.311867562269
             stat err =       0.000456672163
             autocorr =       1.261098497909
              std dev =       0.575102205657
             le_variance =       0.330742546952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330803143741
                                         uncertainty =       0.004068936753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330803143741
                                         uncertainty =       0.004068936753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406658669
  error estimate for blocks of size 2^( 2) =       0.000418493419
  error estimate for blocks of size 2^( 3) =       0.000431321372
  error estimate for blocks of size 2^( 4) =       0.000443041897
  error estimate for blocks of size 2^( 5) =       0.000453163561
  error estimate for blocks of size 2^( 6) =       0.000462080898
  error estimate for blocks of size 2^( 7) =       0.000468402296

      target function =                  N/A
              le_mean =     -16.910976470349
             les_mean =     286.311867562269
             stat err =       0.000456672163
             autocorr =       1.261098497909
              std dev =       0.575102205657
             le_variance =       0.330742546952


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910976470349        initial  <--
     9.7656e+11     9.7656e+12             3.7356e-16       -16.910976470349
     3.9062e+12     3.9062e+13             0.0000e+00       -16.910976470349
     1.5625e+13     1.5625e+14             0.0000e+00       -16.910976470349

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.9314
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4481e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9379
    reference variance = 0.51001
====================================================
  Execution time = 2.5527e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4033e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6305e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340408867293
                                         uncertainty =       0.010209768151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340408867293
                                         uncertainty =       0.010209768151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412508793
  error estimate for blocks of size 2^( 2) =       0.000424044371
  error estimate for blocks of size 2^( 3) =       0.000435803848
  error estimate for blocks of size 2^( 4) =       0.000447564433
  error estimate for blocks of size 2^( 5) =       0.000457318751
  error estimate for blocks of size 2^( 6) =       0.000467968817
  error estimate for blocks of size 2^( 7) =       0.000474018781

      target function =                  N/A
              le_mean =     -16.910988164798
             les_mean =     286.321847548706
             stat err =       0.000461717695
             autocorr =       1.252814056092
              std dev =       0.583375529931
             le_variance =       0.340327008922


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691098816480e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+12, overlap shift 9.7656e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910988164798       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910988164798       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.9062e+13, overlap shift 3.9062e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910988164798       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910988164798       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.26e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5625e+14, overlap shift 1.5625e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910988164798       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910988164798       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.26e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185817 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2167e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.866
    reference variance = 0.399846
====================================================
  Execution time = 2.5109e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2461e-01
  Total weights = 2.0000e+06
  Execution time = 2.9745e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324555782737
                                         uncertainty =       0.003585389959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324555782737
                                         uncertainty =       0.003585389959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402873928
  error estimate for blocks of size 2^( 2) =       0.000414627296
  error estimate for blocks of size 2^( 3) =       0.000427217651
  error estimate for blocks of size 2^( 4) =       0.000439293515
  error estimate for blocks of size 2^( 5) =       0.000448595271
  error estimate for blocks of size 2^( 6) =       0.000456048449
  error estimate for blocks of size 2^( 7) =       0.000460027639

      target function =                  N/A
              le_mean =     -16.910780277510
             les_mean =     286.299104236253
             stat err =       0.000450991219
             autocorr =       1.253134955761
              std dev =       0.569749773454
             le_variance =       0.324614804351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324555782737
                                         uncertainty =       0.003585389959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324555782737
                                         uncertainty =       0.003585389959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402873928
  error estimate for blocks of size 2^( 2) =       0.000414627296
  error estimate for blocks of size 2^( 3) =       0.000427217651
  error estimate for blocks of size 2^( 4) =       0.000439293515
  error estimate for blocks of size 2^( 5) =       0.000448595271
  error estimate for blocks of size 2^( 6) =       0.000456048449
  error estimate for blocks of size 2^( 7) =       0.000460027639

      target function =                  N/A
              le_mean =     -16.910780277510
             les_mean =     286.299104236253
             stat err =       0.000450991219
             autocorr =       1.253134955761
              std dev =       0.569749773454
             le_variance =       0.324614804351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324555782737
                                         uncertainty =       0.003585389959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324555782737
                                         uncertainty =       0.003585389959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402873928
  error estimate for blocks of size 2^( 2) =       0.000414627296
  error estimate for blocks of size 2^( 3) =       0.000427217651
  error estimate for blocks of size 2^( 4) =       0.000439293515
  error estimate for blocks of size 2^( 5) =       0.000448595271
  error estimate for blocks of size 2^( 6) =       0.000456048449
  error estimate for blocks of size 2^( 7) =       0.000460027639

      target function =                  N/A
              le_mean =     -16.910780277510
             les_mean =     286.299104236253
             stat err =       0.000450991219
             autocorr =       1.253134955761
              std dev =       0.569749773454
             le_variance =       0.324614804351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324555782737
                                         uncertainty =       0.003585389959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324555782737
                                         uncertainty =       0.003585389959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402873928
  error estimate for blocks of size 2^( 2) =       0.000414627296
  error estimate for blocks of size 2^( 3) =       0.000427217651
  error estimate for blocks of size 2^( 4) =       0.000439293515
  error estimate for blocks of size 2^( 5) =       0.000448595271
  error estimate for blocks of size 2^( 6) =       0.000456048449
  error estimate for blocks of size 2^( 7) =       0.000460027639

      target function =                  N/A
              le_mean =     -16.910780277510
             les_mean =     286.299104236253
             stat err =       0.000450991219
             autocorr =       1.253134955761
              std dev =       0.569749773454
             le_variance =       0.324614804351


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910780277510        initial  <--
     9.7656e+12     9.7656e+13             0.0000e+00       -16.910780277510
     3.9062e+13     3.9062e+14             0.0000e+00       -16.910780277510
     1.5625e+14     1.5625e+15             0.0000e+00       -16.910780277510

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.0185
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2192e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8661
    reference variance = 0.115166
====================================================
  Execution time = 2.5912e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3216e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7293e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331990676196
                                         uncertainty =       0.005144149100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331990676196
                                         uncertainty =       0.005144149100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407529885
  error estimate for blocks of size 2^( 2) =       0.000419734882
  error estimate for blocks of size 2^( 3) =       0.000432844946
  error estimate for blocks of size 2^( 4) =       0.000445114187
  error estimate for blocks of size 2^( 5) =       0.000455701785
  error estimate for blocks of size 2^( 6) =       0.000462835101
  error estimate for blocks of size 2^( 7) =       0.000467160090

      target function =                  N/A
              le_mean =     -16.910760193370
             les_mean =     286.305971365889
             stat err =       0.000457702791
             autocorr =       1.261386553685
              std dev =       0.576334290406
             le_variance =       0.332161214298


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691076019337e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+13, overlap shift 9.7656e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910760193370       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910760193370       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.9062e+14, overlap shift 3.9062e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910760193370       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910760193370       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910760193370       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910760193371       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.471022086120       residual = 3.37e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.161819240323       residual = 9.37e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -19.079842542183       residual = 6.17e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.283292772583       residual = 5.59e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -15.894034594996       residual = 1.75e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -14.141703121511       residual = 1.22e+03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -21.770282335699       residual = 2.98e+03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.556255893727       residual = 4.49e+03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -10.405075541382       residual = 6.00e+03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -13.103494202666       residual = 1.75e+03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -25.013299077607       residual = 9.40e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -15.054973715224       residual = 8.59e+02           smallest_sin_value = 1.00e+00
davidson iteration   16 stopping due to too large eigenvalue change
davidson solver did not converge after         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+14 is 5.549577e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+15, overlap shift 1.5625e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910760193370       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910760193370       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910760193370       residual = 9.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.540429009639       residual = 1.90e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907391419460       residual = 6.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.434418708092       residual = 3.32e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -15.950713679447       residual = 1.23e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -14.101453173264       residual = 1.20e+03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -19.488481771277       residual = 8.56e+02           smallest_sin_value = 1.00e+00
davidson iteration    9 stopping due to too large eigenvalue change
davidson solver did not converge after          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+15 is 7.280211e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190699 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2655e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8693
    reference variance = 0.304806
====================================================
  Execution time = 2.5009e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.3165e-01
  Total weights = 2.0000e+06
  Execution time = 2.9839e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331616682834
                                         uncertainty =       0.004321109937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331616682834
                                         uncertainty =       0.004321109937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407215033
  error estimate for blocks of size 2^( 2) =       0.000419053993
  error estimate for blocks of size 2^( 3) =       0.000431441455
  error estimate for blocks of size 2^( 4) =       0.000442694630
  error estimate for blocks of size 2^( 5) =       0.000452820701
  error estimate for blocks of size 2^( 6) =       0.000460247373
  error estimate for blocks of size 2^( 7) =       0.000465447856

      target function =                  N/A
              le_mean =     -16.911643761056
             les_mean =     286.335342701435
             stat err =       0.000455302640
             autocorr =       1.250122963533
              std dev =       0.575889022625
             le_variance =       0.331648166380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331616682834
                                         uncertainty =       0.004321109937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331616682834
                                         uncertainty =       0.004321109937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407215033
  error estimate for blocks of size 2^( 2) =       0.000419053993
  error estimate for blocks of size 2^( 3) =       0.000431441455
  error estimate for blocks of size 2^( 4) =       0.000442694630
  error estimate for blocks of size 2^( 5) =       0.000452820701
  error estimate for blocks of size 2^( 6) =       0.000460247373
  error estimate for blocks of size 2^( 7) =       0.000465447856

      target function =                  N/A
              le_mean =     -16.911643761056
             les_mean =     286.335342701435
             stat err =       0.000455302640
             autocorr =       1.250122963533
              std dev =       0.575889022625
             le_variance =       0.331648166380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331616682834
                                         uncertainty =       0.004321109937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331616682834
                                         uncertainty =       0.004321109937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407215033
  error estimate for blocks of size 2^( 2) =       0.000419053993
  error estimate for blocks of size 2^( 3) =       0.000431441455
  error estimate for blocks of size 2^( 4) =       0.000442694630
  error estimate for blocks of size 2^( 5) =       0.000452820701
  error estimate for blocks of size 2^( 6) =       0.000460247373
  error estimate for blocks of size 2^( 7) =       0.000465447856

      target function =                  N/A
              le_mean =     -16.911643761056
             les_mean =     286.335342701435
             stat err =       0.000455302640
             autocorr =       1.250122963533
              std dev =       0.575889022625
             le_variance =       0.331648166380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331616682834
                                         uncertainty =       0.004321109937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331616682834
                                         uncertainty =       0.004321109937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407215033
  error estimate for blocks of size 2^( 2) =       0.000419053993
  error estimate for blocks of size 2^( 3) =       0.000431441455
  error estimate for blocks of size 2^( 4) =       0.000442694630
  error estimate for blocks of size 2^( 5) =       0.000452820701
  error estimate for blocks of size 2^( 6) =       0.000460247373
  error estimate for blocks of size 2^( 7) =       0.000465447856

      target function =                  N/A
              le_mean =     -16.911643761056
             les_mean =     286.335342701435
             stat err =       0.000455302640
             autocorr =       1.250122963533
              std dev =       0.575889022625
             le_variance =       0.331648166380


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911643761056        initial  <--
     9.7656e+13     9.7656e+14             0.0000e+00       -16.911643761056
     3.9062e+14     3.9062e+15             5.5496e-19       -16.911643761056
     1.5625e+15     1.5625e+16             7.2802e-20       -16.911643761056

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.8692
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2531e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1031
    reference variance = 2.32845
====================================================
  Execution time = 2.5581e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.2986e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7111e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329685052277
                                         uncertainty =       0.003536591455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329685052277
                                         uncertainty =       0.003536591455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406112834
  error estimate for blocks of size 2^( 2) =       0.000417779229
  error estimate for blocks of size 2^( 3) =       0.000429578816
  error estimate for blocks of size 2^( 4) =       0.000440534442
  error estimate for blocks of size 2^( 5) =       0.000450105614
  error estimate for blocks of size 2^( 6) =       0.000455073346
  error estimate for blocks of size 2^( 7) =       0.000459587627

      target function =                  N/A
              le_mean =     -16.911589553555
             les_mean =     286.331716331084
             stat err =       0.000451325257
             autocorr =       1.235053718400
              std dev =       0.574330277889
             le_variance =       0.329855268100


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691158955356e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+14, overlap shift 9.7656e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911589553555       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911589553555       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+15, overlap shift 3.9062e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911589553555       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911589553555       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+16, overlap shift 1.5625e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911589553555       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911589553555       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191799 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2302e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9126
    reference variance = 0.580363
====================================================
  Execution time = 2.5032e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3265e-01
  Total weights = 2.0000e+06
  Execution time = 2.9607e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332650792205
                                         uncertainty =       0.004006573572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332650792205
                                         uncertainty =       0.004006573572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407829023
  error estimate for blocks of size 2^( 2) =       0.000419699342
  error estimate for blocks of size 2^( 3) =       0.000431403639
  error estimate for blocks of size 2^( 4) =       0.000442961090
  error estimate for blocks of size 2^( 5) =       0.000452929429
  error estimate for blocks of size 2^( 6) =       0.000462196723
  error estimate for blocks of size 2^( 7) =       0.000466087657

      target function =                  N/A
              le_mean =     -16.910611842862
             les_mean =     286.301441758270
             stat err =       0.000456043725
             autocorr =       1.250422297400
              std dev =       0.576757336005
             le_variance =       0.332649024635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332650792205
                                         uncertainty =       0.004006573572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332650792205
                                         uncertainty =       0.004006573572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407829023
  error estimate for blocks of size 2^( 2) =       0.000419699342
  error estimate for blocks of size 2^( 3) =       0.000431403639
  error estimate for blocks of size 2^( 4) =       0.000442961090
  error estimate for blocks of size 2^( 5) =       0.000452929429
  error estimate for blocks of size 2^( 6) =       0.000462196723
  error estimate for blocks of size 2^( 7) =       0.000466087657

      target function =                  N/A
              le_mean =     -16.910611842862
             les_mean =     286.301441758270
             stat err =       0.000456043725
             autocorr =       1.250422297400
              std dev =       0.576757336005
             le_variance =       0.332649024635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332650792205
                                         uncertainty =       0.004006573572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332650792205
                                         uncertainty =       0.004006573572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407829023
  error estimate for blocks of size 2^( 2) =       0.000419699342
  error estimate for blocks of size 2^( 3) =       0.000431403639
  error estimate for blocks of size 2^( 4) =       0.000442961090
  error estimate for blocks of size 2^( 5) =       0.000452929429
  error estimate for blocks of size 2^( 6) =       0.000462196723
  error estimate for blocks of size 2^( 7) =       0.000466087657

      target function =                  N/A
              le_mean =     -16.910611842862
             les_mean =     286.301441758270
             stat err =       0.000456043725
             autocorr =       1.250422297400
              std dev =       0.576757336005
             le_variance =       0.332649024635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332650792205
                                         uncertainty =       0.004006573572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332650792205
                                         uncertainty =       0.004006573572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407829023
  error estimate for blocks of size 2^( 2) =       0.000419699342
  error estimate for blocks of size 2^( 3) =       0.000431403639
  error estimate for blocks of size 2^( 4) =       0.000442961090
  error estimate for blocks of size 2^( 5) =       0.000452929429
  error estimate for blocks of size 2^( 6) =       0.000462196723
  error estimate for blocks of size 2^( 7) =       0.000466087657

      target function =                  N/A
              le_mean =     -16.910611842862
             les_mean =     286.301441758270
             stat err =       0.000456043725
             autocorr =       1.250422297400
              std dev =       0.576757336005
             le_variance =       0.332649024635


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910611842862        initial  <--
     9.7656e+14     9.7656e+15             0.0000e+00       -16.910611842862
     3.9062e+15     3.9062e+16             0.0000e+00       -16.910611842862
     1.5625e+16     1.5625e+17             0.0000e+00       -16.910611842862

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.8610
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2170e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.809
    reference variance = 0.2067
====================================================
  Execution time = 2.7797e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3107e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6374e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331132800842
                                         uncertainty =       0.004062929762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331132800842
                                         uncertainty =       0.004062929762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406857294
  error estimate for blocks of size 2^( 2) =       0.000418433443
  error estimate for blocks of size 2^( 3) =       0.000431483676
  error estimate for blocks of size 2^( 4) =       0.000443879519
  error estimate for blocks of size 2^( 5) =       0.000454711954
  error estimate for blocks of size 2^( 6) =       0.000463706676
  error estimate for blocks of size 2^( 7) =       0.000467980447

      target function =                  N/A
              le_mean =     -16.909987035771
             les_mean =     286.278727099529
             stat err =       0.000457569649
             autocorr =       1.264824318674
              std dev =       0.575383102915
             le_variance =       0.331065715120


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690998703577e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+15, overlap shift 9.7656e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909987035771       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909987035771       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+16, overlap shift 3.9062e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909987035771       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909987035771       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+17, overlap shift 1.5625e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909987035771       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909987035771       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192896 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4444e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8946
    reference variance = 0.372403
====================================================
  Execution time = 2.5031e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2437e-01
  Total weights = 2.0000e+06
  Execution time = 2.9749e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324417119066
                                         uncertainty =       0.003514439163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324417119066
                                         uncertainty =       0.003514439163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402723606
  error estimate for blocks of size 2^( 2) =       0.000414783462
  error estimate for blocks of size 2^( 3) =       0.000427006304
  error estimate for blocks of size 2^( 4) =       0.000438588936
  error estimate for blocks of size 2^( 5) =       0.000449154381
  error estimate for blocks of size 2^( 6) =       0.000457350600
  error estimate for blocks of size 2^( 7) =       0.000461456865

      target function =                  N/A
              le_mean =     -16.911267651101
             les_mean =     286.315346010299
             stat err =       0.000451637696
             autocorr =       1.257668525057
              std dev =       0.569537185181
             le_variance =       0.324372605303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324417119066
                                         uncertainty =       0.003514439163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324417119066
                                         uncertainty =       0.003514439163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402723606
  error estimate for blocks of size 2^( 2) =       0.000414783462
  error estimate for blocks of size 2^( 3) =       0.000427006304
  error estimate for blocks of size 2^( 4) =       0.000438588936
  error estimate for blocks of size 2^( 5) =       0.000449154381
  error estimate for blocks of size 2^( 6) =       0.000457350600
  error estimate for blocks of size 2^( 7) =       0.000461456865

      target function =                  N/A
              le_mean =     -16.911267651101
             les_mean =     286.315346010299
             stat err =       0.000451637696
             autocorr =       1.257668525057
              std dev =       0.569537185181
             le_variance =       0.324372605303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324417119066
                                         uncertainty =       0.003514439163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324417119066
                                         uncertainty =       0.003514439163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402723606
  error estimate for blocks of size 2^( 2) =       0.000414783462
  error estimate for blocks of size 2^( 3) =       0.000427006304
  error estimate for blocks of size 2^( 4) =       0.000438588936
  error estimate for blocks of size 2^( 5) =       0.000449154381
  error estimate for blocks of size 2^( 6) =       0.000457350600
  error estimate for blocks of size 2^( 7) =       0.000461456865

      target function =                  N/A
              le_mean =     -16.911267651101
             les_mean =     286.315346010299
             stat err =       0.000451637696
             autocorr =       1.257668525057
              std dev =       0.569537185181
             le_variance =       0.324372605303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324417119066
                                         uncertainty =       0.003514439163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324417119066
                                         uncertainty =       0.003514439163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402723606
  error estimate for blocks of size 2^( 2) =       0.000414783462
  error estimate for blocks of size 2^( 3) =       0.000427006304
  error estimate for blocks of size 2^( 4) =       0.000438588936
  error estimate for blocks of size 2^( 5) =       0.000449154381
  error estimate for blocks of size 2^( 6) =       0.000457350600
  error estimate for blocks of size 2^( 7) =       0.000461456865

      target function =                  N/A
              le_mean =     -16.911267651101
             les_mean =     286.315346010299
             stat err =       0.000451637696
             autocorr =       1.257668525057
              std dev =       0.569537185181
             le_variance =       0.324372605303


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911267651101        initial  <--
     9.7656e+15     9.7656e+16             0.0000e+00       -16.911267651101
     3.9062e+16     3.9062e+17             0.0000e+00       -16.911267651101
     1.5625e+17     1.5625e+18             0.0000e+00       -16.911267651101

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.9518
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4436e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9121
    reference variance = 0.297271
====================================================
  Execution time = 2.5692e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.2766e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7279e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327749050686
                                         uncertainty =       0.003137651677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327749050686
                                         uncertainty =       0.003137651677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404759263
  error estimate for blocks of size 2^( 2) =       0.000416180295
  error estimate for blocks of size 2^( 3) =       0.000428154544
  error estimate for blocks of size 2^( 4) =       0.000439332066
  error estimate for blocks of size 2^( 5) =       0.000448751670
  error estimate for blocks of size 2^( 6) =       0.000455116710
  error estimate for blocks of size 2^( 7) =       0.000457792781

      target function =                  N/A
              le_mean =     -16.911640074503
             les_mean =     286.331229967505
             stat err =       0.000450248307
             autocorr =       1.237401344905
              std dev =       0.572416039086
             le_variance =       0.327660121803


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691164007450e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+16, overlap shift 9.7656e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911640074503       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911640074503       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+17, overlap shift 3.9062e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911640074503       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911640074503       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+18, overlap shift 1.5625e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911640074503       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911640074503       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.193995 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2430e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9418
    reference variance = 0.78617
====================================================
  Execution time = 2.6192e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2529e-01
  Total weights = 2.0000e+06
  Execution time = 2.9741e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325342189530
                                         uncertainty =       0.004527090893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325342189530
                                         uncertainty =       0.004527090893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403291295
  error estimate for blocks of size 2^( 2) =       0.000414964980
  error estimate for blocks of size 2^( 3) =       0.000427443679
  error estimate for blocks of size 2^( 4) =       0.000440068775
  error estimate for blocks of size 2^( 5) =       0.000451081805
  error estimate for blocks of size 2^( 6) =       0.000458288746
  error estimate for blocks of size 2^( 7) =       0.000464685507

      target function =                  N/A
              le_mean =     -16.910389450522
             les_mean =     286.286558942761
             stat err =       0.000453531209
             autocorr =       1.264668376740
              std dev =       0.570340018831
             le_variance =       0.325287737081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325342189530
                                         uncertainty =       0.004527090893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325342189530
                                         uncertainty =       0.004527090893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403291295
  error estimate for blocks of size 2^( 2) =       0.000414964980
  error estimate for blocks of size 2^( 3) =       0.000427443679
  error estimate for blocks of size 2^( 4) =       0.000440068775
  error estimate for blocks of size 2^( 5) =       0.000451081805
  error estimate for blocks of size 2^( 6) =       0.000458288746
  error estimate for blocks of size 2^( 7) =       0.000464685507

      target function =                  N/A
              le_mean =     -16.910389450522
             les_mean =     286.286558942761
             stat err =       0.000453531209
             autocorr =       1.264668376740
              std dev =       0.570340018831
             le_variance =       0.325287737081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325342189530
                                         uncertainty =       0.004527090893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325342189530
                                         uncertainty =       0.004527090893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403291295
  error estimate for blocks of size 2^( 2) =       0.000414964980
  error estimate for blocks of size 2^( 3) =       0.000427443679
  error estimate for blocks of size 2^( 4) =       0.000440068775
  error estimate for blocks of size 2^( 5) =       0.000451081805
  error estimate for blocks of size 2^( 6) =       0.000458288746
  error estimate for blocks of size 2^( 7) =       0.000464685507

      target function =                  N/A
              le_mean =     -16.910389450522
             les_mean =     286.286558942761
             stat err =       0.000453531209
             autocorr =       1.264668376740
              std dev =       0.570340018831
             le_variance =       0.325287737081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325342189530
                                         uncertainty =       0.004527090893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325342189530
                                         uncertainty =       0.004527090893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403291295
  error estimate for blocks of size 2^( 2) =       0.000414964980
  error estimate for blocks of size 2^( 3) =       0.000427443679
  error estimate for blocks of size 2^( 4) =       0.000440068775
  error estimate for blocks of size 2^( 5) =       0.000451081805
  error estimate for blocks of size 2^( 6) =       0.000458288746
  error estimate for blocks of size 2^( 7) =       0.000464685507

      target function =                  N/A
              le_mean =     -16.910389450522
             les_mean =     286.286558942761
             stat err =       0.000453531209
             autocorr =       1.264668376740
              std dev =       0.570340018831
             le_variance =       0.325287737081


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910389450522        initial  <--
     9.7656e+16     9.7656e+17             0.0000e+00       -16.910389450522
     3.9062e+17     3.9062e+18             0.0000e+00       -16.910389450522
     1.5625e+18     1.5625e+19             0.0000e+00       -16.910389450522

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.0356
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3474e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9212
    reference variance = 0.250128
====================================================
  Execution time = 2.5712e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3195e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6323e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331817753431
                                         uncertainty =       0.006655927712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331817753431
                                         uncertainty =       0.006655927712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407401423
  error estimate for blocks of size 2^( 2) =       0.000419215953
  error estimate for blocks of size 2^( 3) =       0.000431359236
  error estimate for blocks of size 2^( 4) =       0.000443774702
  error estimate for blocks of size 2^( 5) =       0.000454374512
  error estimate for blocks of size 2^( 6) =       0.000463608112
  error estimate for blocks of size 2^( 7) =       0.000468785525

      target function =                  N/A
              le_mean =     -16.911055380277
             les_mean =     286.315745747747
             stat err =       0.000457635713
             autocorr =       1.261812233761
              std dev =       0.576152617751
             le_variance =       0.331951838941


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691105538028e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+17, overlap shift 9.7656e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911055380277       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911055380277       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+18, overlap shift 3.9062e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911055380277       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911055380277       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911055380277       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911055380289       residual = 1.59e+00           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+18 is 6.295747e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+19, overlap shift 1.5625e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911055380277       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911055380277       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911055380277       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911055380289       residual = 1.28e+00           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+19 is 1.573937e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.195449 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2355e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9161
    reference variance = 0.449705
====================================================
  Execution time = 2.5151e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3331e-01
  Total weights = 2.0000e+06
  Execution time = 2.9822e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333373685892
                                         uncertainty =       0.006242872059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333373685892
                                         uncertainty =       0.006242872059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408235243
  error estimate for blocks of size 2^( 2) =       0.000420343282
  error estimate for blocks of size 2^( 3) =       0.000433305755
  error estimate for blocks of size 2^( 4) =       0.000446654418
  error estimate for blocks of size 2^( 5) =       0.000458715839
  error estimate for blocks of size 2^( 6) =       0.000469859889
  error estimate for blocks of size 2^( 7) =       0.000477333937

      target function =                  N/A
              le_mean =     -16.910931503690
             les_mean =     286.312916183216
             stat err =       0.000463141021
             autocorr =       1.287079896952
              std dev =       0.577331817398
             le_variance =       0.333312027380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333373685892
                                         uncertainty =       0.006242872059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333373685892
                                         uncertainty =       0.006242872059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408235243
  error estimate for blocks of size 2^( 2) =       0.000420343282
  error estimate for blocks of size 2^( 3) =       0.000433305755
  error estimate for blocks of size 2^( 4) =       0.000446654418
  error estimate for blocks of size 2^( 5) =       0.000458715839
  error estimate for blocks of size 2^( 6) =       0.000469859889
  error estimate for blocks of size 2^( 7) =       0.000477333937

      target function =                  N/A
              le_mean =     -16.910931503690
             les_mean =     286.312916183216
             stat err =       0.000463141021
             autocorr =       1.287079896952
              std dev =       0.577331817398
             le_variance =       0.333312027380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333373685892
                                         uncertainty =       0.006242872059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333373685892
                                         uncertainty =       0.006242872059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408235243
  error estimate for blocks of size 2^( 2) =       0.000420343282
  error estimate for blocks of size 2^( 3) =       0.000433305755
  error estimate for blocks of size 2^( 4) =       0.000446654418
  error estimate for blocks of size 2^( 5) =       0.000458715839
  error estimate for blocks of size 2^( 6) =       0.000469859889
  error estimate for blocks of size 2^( 7) =       0.000477333937

      target function =                  N/A
              le_mean =     -16.910931503690
             les_mean =     286.312916183216
             stat err =       0.000463141021
             autocorr =       1.287079896952
              std dev =       0.577331817398
             le_variance =       0.333312027380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333373685892
                                         uncertainty =       0.006242872059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333373685892
                                         uncertainty =       0.006242872059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408235243
  error estimate for blocks of size 2^( 2) =       0.000420343282
  error estimate for blocks of size 2^( 3) =       0.000433305755
  error estimate for blocks of size 2^( 4) =       0.000446654418
  error estimate for blocks of size 2^( 5) =       0.000458715839
  error estimate for blocks of size 2^( 6) =       0.000469859889
  error estimate for blocks of size 2^( 7) =       0.000477333937

      target function =                  N/A
              le_mean =     -16.910931503690
             les_mean =     286.312916183216
             stat err =       0.000463141021
             autocorr =       1.287079896952
              std dev =       0.577331817398
             le_variance =       0.333312027380


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910931503690        initial  <--
     9.7656e+17     9.7656e+18             0.0000e+00       -16.910931503690
     3.9062e+18     3.9062e+19             6.2957e-23       -16.910931503690
     1.5625e+19     1.5625e+20             1.5739e-23       -16.910931503690

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.0528
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2414e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9056
    reference variance = 0.224899
====================================================
  Execution time = 2.6015e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3469e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5735e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334745021159
                                         uncertainty =       0.005918045019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334745021159
                                         uncertainty =       0.005918045019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409077858
  error estimate for blocks of size 2^( 2) =       0.000420796038
  error estimate for blocks of size 2^( 3) =       0.000433093250
  error estimate for blocks of size 2^( 4) =       0.000444969867
  error estimate for blocks of size 2^( 5) =       0.000454655428
  error estimate for blocks of size 2^( 6) =       0.000461145811
  error estimate for blocks of size 2^( 7) =       0.000468220633

      target function =                  N/A
              le_mean =     -16.910074721358
             les_mean =     286.285316302312
             stat err =       0.000457247935
             autocorr =       1.249371396455
              std dev =       0.578523454789
             le_variance =       0.334689387741


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691007472136e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+18, overlap shift 9.7656e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910074721358       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910074721358       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910074721358       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+18 is 1.011747e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+19, overlap shift 3.9062e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910074721358       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910074721358       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910074721358       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+19 is 2.529367e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+20, overlap shift 1.5625e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910074721358       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910074721358       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910074721358       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+20 is 6.323417e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196820 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2599e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9699
    reference variance = 0.166663
====================================================
  Execution time = 2.5035e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3220e-01
  Total weights = 2.0000e+06
  Execution time = 2.9642e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332218121925
                                         uncertainty =       0.004253002583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332218121925
                                         uncertainty =       0.004253002583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407554005
  error estimate for blocks of size 2^( 2) =       0.000418912007
  error estimate for blocks of size 2^( 3) =       0.000430746236
  error estimate for blocks of size 2^( 4) =       0.000441004716
  error estimate for blocks of size 2^( 5) =       0.000451357225
  error estimate for blocks of size 2^( 6) =       0.000458414635
  error estimate for blocks of size 2^( 7) =       0.000462379035

      target function =                  N/A
              le_mean =     -16.910962972837
             les_mean =     286.312869036946
             stat err =       0.000453288903
             autocorr =       1.237028890654
              std dev =       0.576368401623
             le_variance =       0.332200534389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332218121925
                                         uncertainty =       0.004253002583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332218121925
                                         uncertainty =       0.004253002583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407554005
  error estimate for blocks of size 2^( 2) =       0.000418912007
  error estimate for blocks of size 2^( 3) =       0.000430746236
  error estimate for blocks of size 2^( 4) =       0.000441004716
  error estimate for blocks of size 2^( 5) =       0.000451357225
  error estimate for blocks of size 2^( 6) =       0.000458414635
  error estimate for blocks of size 2^( 7) =       0.000462379035

      target function =                  N/A
              le_mean =     -16.910962972837
             les_mean =     286.312869036946
             stat err =       0.000453288903
             autocorr =       1.237028890654
              std dev =       0.576368401623
             le_variance =       0.332200534389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332218121925
                                         uncertainty =       0.004253002583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332218121925
                                         uncertainty =       0.004253002583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407554005
  error estimate for blocks of size 2^( 2) =       0.000418912007
  error estimate for blocks of size 2^( 3) =       0.000430746236
  error estimate for blocks of size 2^( 4) =       0.000441004716
  error estimate for blocks of size 2^( 5) =       0.000451357225
  error estimate for blocks of size 2^( 6) =       0.000458414635
  error estimate for blocks of size 2^( 7) =       0.000462379035

      target function =                  N/A
              le_mean =     -16.910962972837
             les_mean =     286.312869036946
             stat err =       0.000453288903
             autocorr =       1.237028890654
              std dev =       0.576368401623
             le_variance =       0.332200534389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332218121925
                                         uncertainty =       0.004253002583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332218121925
                                         uncertainty =       0.004253002583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407554005
  error estimate for blocks of size 2^( 2) =       0.000418912007
  error estimate for blocks of size 2^( 3) =       0.000430746236
  error estimate for blocks of size 2^( 4) =       0.000441004716
  error estimate for blocks of size 2^( 5) =       0.000451357225
  error estimate for blocks of size 2^( 6) =       0.000458414635
  error estimate for blocks of size 2^( 7) =       0.000462379035

      target function =                  N/A
              le_mean =     -16.910962972837
             les_mean =     286.312869036946
             stat err =       0.000453288903
             autocorr =       1.237028890654
              std dev =       0.576368401623
             le_variance =       0.332200534389


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910962972837        initial  <--
     9.7656e+18     9.7656e+19             1.0117e-23       -16.910962972837
     3.9062e+19     3.9062e+20             2.5294e-24       -16.910962972837
     1.5625e+20     1.5625e+21             6.3234e-25       -16.910962972837

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.8863
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2492e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9748
    reference variance = 0.244501
====================================================
  Execution time = 2.5650e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.5693e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.0269e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357064931385
                                         uncertainty =       0.022411812015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357064931385
                                         uncertainty =       0.022411812015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422453066
  error estimate for blocks of size 2^( 2) =       0.000434107338
  error estimate for blocks of size 2^( 3) =       0.000446519078
  error estimate for blocks of size 2^( 4) =       0.000457963715
  error estimate for blocks of size 2^( 5) =       0.000468519708
  error estimate for blocks of size 2^( 6) =       0.000474396005
  error estimate for blocks of size 2^( 7) =       0.000479335794

      target function =                  N/A
              le_mean =     -16.911457391440
             les_mean =     286.354324110380
             stat err =       0.000470053805
             autocorr =       1.238050079820
              std dev =       0.597438855743
             le_variance =       0.356933186352


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691145739144e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+19, overlap shift 9.7656e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911457391440       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911457391440       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+20, overlap shift 3.9062e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911457391440       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911457391440       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+21, overlap shift 1.5625e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911457391440       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911457391440       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.197935 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3686e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9239
    reference variance = 0.21458
====================================================
  Execution time = 2.4905e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3902e-01
  Total weights = 2.0000e+06
  Execution time = 2.9643e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339068428411
                                         uncertainty =       0.013668376261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339068428411
                                         uncertainty =       0.013668376261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411717833
  error estimate for blocks of size 2^( 2) =       0.000423572294
  error estimate for blocks of size 2^( 3) =       0.000436318030
  error estimate for blocks of size 2^( 4) =       0.000448738343
  error estimate for blocks of size 2^( 5) =       0.000459508060
  error estimate for blocks of size 2^( 6) =       0.000468186617
  error estimate for blocks of size 2^( 7) =       0.000472642151

      target function =                  N/A
              le_mean =     -16.910213765495
             les_mean =     286.294352572799
             stat err =       0.000462268793
             autocorr =       1.260636261757
              std dev =       0.582256942909
             le_variance =       0.339023147566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339068428411
                                         uncertainty =       0.013668376261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339068428411
                                         uncertainty =       0.013668376261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411717833
  error estimate for blocks of size 2^( 2) =       0.000423572294
  error estimate for blocks of size 2^( 3) =       0.000436318030
  error estimate for blocks of size 2^( 4) =       0.000448738343
  error estimate for blocks of size 2^( 5) =       0.000459508060
  error estimate for blocks of size 2^( 6) =       0.000468186617
  error estimate for blocks of size 2^( 7) =       0.000472642151

      target function =                  N/A
              le_mean =     -16.910213765495
             les_mean =     286.294352572799
             stat err =       0.000462268793
             autocorr =       1.260636261757
              std dev =       0.582256942909
             le_variance =       0.339023147566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339068428411
                                         uncertainty =       0.013668376261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339068428411
                                         uncertainty =       0.013668376261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411717833
  error estimate for blocks of size 2^( 2) =       0.000423572294
  error estimate for blocks of size 2^( 3) =       0.000436318030
  error estimate for blocks of size 2^( 4) =       0.000448738343
  error estimate for blocks of size 2^( 5) =       0.000459508060
  error estimate for blocks of size 2^( 6) =       0.000468186617
  error estimate for blocks of size 2^( 7) =       0.000472642151

      target function =                  N/A
              le_mean =     -16.910213765495
             les_mean =     286.294352572799
             stat err =       0.000462268793
             autocorr =       1.260636261757
              std dev =       0.582256942909
             le_variance =       0.339023147566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339068428411
                                         uncertainty =       0.013668376261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339068428411
                                         uncertainty =       0.013668376261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411717833
  error estimate for blocks of size 2^( 2) =       0.000423572294
  error estimate for blocks of size 2^( 3) =       0.000436318030
  error estimate for blocks of size 2^( 4) =       0.000448738343
  error estimate for blocks of size 2^( 5) =       0.000459508060
  error estimate for blocks of size 2^( 6) =       0.000468186617
  error estimate for blocks of size 2^( 7) =       0.000472642151

      target function =                  N/A
              le_mean =     -16.910213765495
             les_mean =     286.294352572799
             stat err =       0.000462268793
             autocorr =       1.260636261757
              std dev =       0.582256942909
             le_variance =       0.339023147566


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910213765495        initial  <--
     9.7656e+19     9.7656e+20             0.0000e+00       -16.910213765495
     3.9062e+20     3.9062e+21             0.0000e+00       -16.910213765495
     1.5625e+21     1.5625e+22             0.0000e+00       -16.910213765495

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.7719
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3465e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9304
    reference variance = 0.229469
====================================================
  Execution time = 2.5668e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3357e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.8196e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333691477582
                                         uncertainty =       0.005485535238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333691477582
                                         uncertainty =       0.005485535238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408391322
  error estimate for blocks of size 2^( 2) =       0.000419755571
  error estimate for blocks of size 2^( 3) =       0.000431374435
  error estimate for blocks of size 2^( 4) =       0.000442394582
  error estimate for blocks of size 2^( 5) =       0.000451701081
  error estimate for blocks of size 2^( 6) =       0.000456553484
  error estimate for blocks of size 2^( 7) =       0.000458393256

      target function =                  N/A
              le_mean =     -16.911044912550
             les_mean =     286.317006811648
             stat err =       0.000452260601
             autocorr =       1.226378419494
              std dev =       0.577552546662
             le_variance =       0.333566944156


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691104491255e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+20, overlap shift 9.7656e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911044912550       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911044912550       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+21, overlap shift 3.9062e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911044912550       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911044912550       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+22, overlap shift 1.5625e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911044912550       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911044912550       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199057 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2498e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9437
    reference variance = 0.161186
====================================================
  Execution time = 2.4881e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3627e-01
  Total weights = 2.0000e+06
  Execution time = 2.9805e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336298684568
                                         uncertainty =       0.007105304216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336298684568
                                         uncertainty =       0.007105304216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410045068
  error estimate for blocks of size 2^( 2) =       0.000422048393
  error estimate for blocks of size 2^( 3) =       0.000433886072
  error estimate for blocks of size 2^( 4) =       0.000445407183
  error estimate for blocks of size 2^( 5) =       0.000455834467
  error estimate for blocks of size 2^( 6) =       0.000461694056
  error estimate for blocks of size 2^( 7) =       0.000466864454

      target function =                  N/A
              le_mean =     -16.911329711986
             les_mean =     286.329346374985
             stat err =       0.000457450040
             autocorr =       1.244583830483
              std dev =       0.579891296392
             le_variance =       0.336273915631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336298684568
                                         uncertainty =       0.007105304216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336298684568
                                         uncertainty =       0.007105304216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410045068
  error estimate for blocks of size 2^( 2) =       0.000422048393
  error estimate for blocks of size 2^( 3) =       0.000433886072
  error estimate for blocks of size 2^( 4) =       0.000445407183
  error estimate for blocks of size 2^( 5) =       0.000455834467
  error estimate for blocks of size 2^( 6) =       0.000461694056
  error estimate for blocks of size 2^( 7) =       0.000466864454

      target function =                  N/A
              le_mean =     -16.911329711986
             les_mean =     286.329346374985
             stat err =       0.000457450040
             autocorr =       1.244583830483
              std dev =       0.579891296392
             le_variance =       0.336273915631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336298684568
                                         uncertainty =       0.007105304216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336298684568
                                         uncertainty =       0.007105304216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410045068
  error estimate for blocks of size 2^( 2) =       0.000422048393
  error estimate for blocks of size 2^( 3) =       0.000433886072
  error estimate for blocks of size 2^( 4) =       0.000445407183
  error estimate for blocks of size 2^( 5) =       0.000455834467
  error estimate for blocks of size 2^( 6) =       0.000461694056
  error estimate for blocks of size 2^( 7) =       0.000466864454

      target function =                  N/A
              le_mean =     -16.911329711986
             les_mean =     286.329346374985
             stat err =       0.000457450040
             autocorr =       1.244583830483
              std dev =       0.579891296392
             le_variance =       0.336273915631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336298684568
                                         uncertainty =       0.007105304216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336298684568
                                         uncertainty =       0.007105304216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410045068
  error estimate for blocks of size 2^( 2) =       0.000422048393
  error estimate for blocks of size 2^( 3) =       0.000433886072
  error estimate for blocks of size 2^( 4) =       0.000445407183
  error estimate for blocks of size 2^( 5) =       0.000455834467
  error estimate for blocks of size 2^( 6) =       0.000461694056
  error estimate for blocks of size 2^( 7) =       0.000466864454

      target function =                  N/A
              le_mean =     -16.911329711986
             les_mean =     286.329346374985
             stat err =       0.000457450040
             autocorr =       1.244583830483
              std dev =       0.579891296392
             le_variance =       0.336273915631


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911329711986        initial  <--
     9.7656e+20     9.7656e+21             0.0000e+00       -16.911329711986
     3.9062e+21     3.9062e+22             0.0000e+00       -16.911329711986
     1.5625e+22     1.5625e+23             0.0000e+00       -16.911329711986

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.7896
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2330e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8636
    reference variance = 0.253996
====================================================
  Execution time = 2.5422e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.2288e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5908e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322962650296
                                         uncertainty =       0.003321126871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322962650296
                                         uncertainty =       0.003321126871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401793680
  error estimate for blocks of size 2^( 2) =       0.000413680120
  error estimate for blocks of size 2^( 3) =       0.000425950037
  error estimate for blocks of size 2^( 4) =       0.000437340284
  error estimate for blocks of size 2^( 5) =       0.000448400205
  error estimate for blocks of size 2^( 6) =       0.000456182462
  error estimate for blocks of size 2^( 7) =       0.000462382703

      target function =                  N/A
              le_mean =     -16.910446970184
             les_mean =     286.286092892613
             stat err =       0.000451076414
             autocorr =       1.260358326798
              std dev =       0.568222071593
             le_variance =       0.322876322645


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691044697018e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+21, overlap shift 9.7656e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910446970184       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910446970184       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+22, overlap shift 3.9062e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910446970184       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910446970184       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+23, overlap shift 1.5625e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910446970184       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910446970184       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.200151 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2023e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8934
    reference variance = 0.187556
====================================================
  Execution time = 2.5292e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2262e-01
  Total weights = 2.0000e+06
  Execution time = 2.9771e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322586299064
                                         uncertainty =       0.003051202634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322586299064
                                         uncertainty =       0.003051202634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401634514
  error estimate for blocks of size 2^( 2) =       0.000413023847
  error estimate for blocks of size 2^( 3) =       0.000424877873
  error estimate for blocks of size 2^( 4) =       0.000435853651
  error estimate for blocks of size 2^( 5) =       0.000445183399
  error estimate for blocks of size 2^( 6) =       0.000452539473
  error estimate for blocks of size 2^( 7) =       0.000454084408

      target function =                  N/A
              le_mean =     -16.911335134819
             les_mean =     286.315876447036
             stat err =       0.000446915233
             autocorr =       1.238192763003
              std dev =       0.567996977253
             le_variance =       0.322620566169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322586299064
                                         uncertainty =       0.003051202634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322586299064
                                         uncertainty =       0.003051202634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401634514
  error estimate for blocks of size 2^( 2) =       0.000413023847
  error estimate for blocks of size 2^( 3) =       0.000424877873
  error estimate for blocks of size 2^( 4) =       0.000435853651
  error estimate for blocks of size 2^( 5) =       0.000445183399
  error estimate for blocks of size 2^( 6) =       0.000452539473
  error estimate for blocks of size 2^( 7) =       0.000454084408

      target function =                  N/A
              le_mean =     -16.911335134819
             les_mean =     286.315876447036
             stat err =       0.000446915233
             autocorr =       1.238192763003
              std dev =       0.567996977253
             le_variance =       0.322620566169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322586299064
                                         uncertainty =       0.003051202634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322586299064
                                         uncertainty =       0.003051202634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401634514
  error estimate for blocks of size 2^( 2) =       0.000413023847
  error estimate for blocks of size 2^( 3) =       0.000424877873
  error estimate for blocks of size 2^( 4) =       0.000435853651
  error estimate for blocks of size 2^( 5) =       0.000445183399
  error estimate for blocks of size 2^( 6) =       0.000452539473
  error estimate for blocks of size 2^( 7) =       0.000454084408

      target function =                  N/A
              le_mean =     -16.911335134819
             les_mean =     286.315876447036
             stat err =       0.000446915233
             autocorr =       1.238192763003
              std dev =       0.567996977253
             le_variance =       0.322620566169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322586299064
                                         uncertainty =       0.003051202634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322586299064
                                         uncertainty =       0.003051202634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401634514
  error estimate for blocks of size 2^( 2) =       0.000413023847
  error estimate for blocks of size 2^( 3) =       0.000424877873
  error estimate for blocks of size 2^( 4) =       0.000435853651
  error estimate for blocks of size 2^( 5) =       0.000445183399
  error estimate for blocks of size 2^( 6) =       0.000452539473
  error estimate for blocks of size 2^( 7) =       0.000454084408

      target function =                  N/A
              le_mean =     -16.911335134819
             les_mean =     286.315876447036
             stat err =       0.000446915233
             autocorr =       1.238192763003
              std dev =       0.567996977253
             le_variance =       0.322620566169


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911335134819        initial  <--
     9.7656e+21     9.7656e+22             0.0000e+00       -16.911335134819
     3.9062e+22     3.9062e+23             0.0000e+00       -16.911335134819
     1.5625e+23     1.5625e+24             0.0000e+00       -16.911335134819

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 40.1641
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2194e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8963
    reference variance = 0.229027
====================================================
  Execution time = 2.5518e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4427e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5692e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344245542159
                                         uncertainty =       0.007790415657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344245542159
                                         uncertainty =       0.007790415657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414892076
  error estimate for blocks of size 2^( 2) =       0.000426165456
  error estimate for blocks of size 2^( 3) =       0.000438208559
  error estimate for blocks of size 2^( 4) =       0.000451159078
  error estimate for blocks of size 2^( 5) =       0.000463007383
  error estimate for blocks of size 2^( 6) =       0.000472816343
  error estimate for blocks of size 2^( 7) =       0.000475457246

      target function =                  N/A
              le_mean =     -16.910498280977
             les_mean =     286.309222808042
             stat err =       0.000465610012
             autocorr =       1.259430889123
              std dev =       0.586746000641
             le_variance =       0.344270869268


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691049828098e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+22, overlap shift 9.7656e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910498280977       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910498280977       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910498280977       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910498292469       residual = 2.75e+02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+22 is 2.648030e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+23, overlap shift 3.9062e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910498280977       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910498280977       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910498280977       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+23 is 2.972393e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+24, overlap shift 1.5625e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910498280977       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910498280977       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910498280977       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+24 is 7.430982e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201595 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2097e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8981
    reference variance = 0.324754
====================================================
  Execution time = 2.4921e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4030e-01
  Total weights = 2.0000e+06
  Execution time = 2.9813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340373661426
                                         uncertainty =       0.004661385887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340373661426
                                         uncertainty =       0.004661385887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412493337
  error estimate for blocks of size 2^( 2) =       0.000424479996
  error estimate for blocks of size 2^( 3) =       0.000436581164
  error estimate for blocks of size 2^( 4) =       0.000448254169
  error estimate for blocks of size 2^( 5) =       0.000457645157
  error estimate for blocks of size 2^( 6) =       0.000466988399
  error estimate for blocks of size 2^( 7) =       0.000470339403

      target function =                  N/A
              le_mean =     -16.911219645155
             les_mean =     286.329651222355
             stat err =       0.000460806782
             autocorr =       1.247969149684
              std dev =       0.583353671312
             le_variance =       0.340301505833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340373661426
                                         uncertainty =       0.004661385887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340373661426
                                         uncertainty =       0.004661385887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412493337
  error estimate for blocks of size 2^( 2) =       0.000424479996
  error estimate for blocks of size 2^( 3) =       0.000436581164
  error estimate for blocks of size 2^( 4) =       0.000448254169
  error estimate for blocks of size 2^( 5) =       0.000457645157
  error estimate for blocks of size 2^( 6) =       0.000466988399
  error estimate for blocks of size 2^( 7) =       0.000470339403

      target function =                  N/A
              le_mean =     -16.911219645155
             les_mean =     286.329651222355
             stat err =       0.000460806782
             autocorr =       1.247969149684
              std dev =       0.583353671312
             le_variance =       0.340301505833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340373661426
                                         uncertainty =       0.004661385887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340373661426
                                         uncertainty =       0.004661385887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412493337
  error estimate for blocks of size 2^( 2) =       0.000424479996
  error estimate for blocks of size 2^( 3) =       0.000436581164
  error estimate for blocks of size 2^( 4) =       0.000448254169
  error estimate for blocks of size 2^( 5) =       0.000457645157
  error estimate for blocks of size 2^( 6) =       0.000466988399
  error estimate for blocks of size 2^( 7) =       0.000470339403

      target function =                  N/A
              le_mean =     -16.911219645155
             les_mean =     286.329651222355
             stat err =       0.000460806782
             autocorr =       1.247969149684
              std dev =       0.583353671312
             le_variance =       0.340301505833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340373661426
                                         uncertainty =       0.004661385887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340373661426
                                         uncertainty =       0.004661385887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412493337
  error estimate for blocks of size 2^( 2) =       0.000424479996
  error estimate for blocks of size 2^( 3) =       0.000436581164
  error estimate for blocks of size 2^( 4) =       0.000448254169
  error estimate for blocks of size 2^( 5) =       0.000457645157
  error estimate for blocks of size 2^( 6) =       0.000466988399
  error estimate for blocks of size 2^( 7) =       0.000470339403

      target function =                  N/A
              le_mean =     -16.911219645155
             les_mean =     286.329651222355
             stat err =       0.000460806782
             autocorr =       1.247969149684
              std dev =       0.583353671312
             le_variance =       0.340301505833


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911219645155        initial  <--
     9.7656e+22     9.7656e+23             2.6480e-27       -16.911219645155
     3.9062e+23     3.9062e+24             2.9724e-28       -16.911219645155
     1.5625e+24     1.5625e+25             7.4310e-29       -16.911219645155

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.8492
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1953e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9573
    reference variance = 0.194169
====================================================
  Execution time = 2.5417e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2992e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329783773174
                                         uncertainty =       0.006082637523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329783773174
                                         uncertainty =       0.006082637523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406150929
  error estimate for blocks of size 2^( 2) =       0.000417853411
  error estimate for blocks of size 2^( 3) =       0.000430118926
  error estimate for blocks of size 2^( 4) =       0.000441840142
  error estimate for blocks of size 2^( 5) =       0.000452697161
  error estimate for blocks of size 2^( 6) =       0.000462185251
  error estimate for blocks of size 2^( 7) =       0.000469643282

      target function =                  N/A
              le_mean =     -16.911243582236
             les_mean =     286.320076486881
             stat err =       0.000456591459
             autocorr =       1.263806734482
              std dev =       0.574384152036
             le_variance =       0.329917154110


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691124358224e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+23, overlap shift 9.7656e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911243582236       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911243582236       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+24, overlap shift 3.9062e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911243582236       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911243582236       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+25, overlap shift 1.5625e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911243582236       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911243582236       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.202708 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2013e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8925
    reference variance = 0.711582
====================================================
  Execution time = 2.7389e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4912e-01
  Total weights = 2.0000e+06
  Execution time = 2.9722e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349155859473
                                         uncertainty =       0.020657200093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349155859473
                                         uncertainty =       0.020657200093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417805167
  error estimate for blocks of size 2^( 2) =       0.000429438226
  error estimate for blocks of size 2^( 3) =       0.000441636017
  error estimate for blocks of size 2^( 4) =       0.000453438349
  error estimate for blocks of size 2^( 5) =       0.000464558131
  error estimate for blocks of size 2^( 6) =       0.000473426782
  error estimate for blocks of size 2^( 7) =       0.000477472581

      target function =                  N/A
              le_mean =     -16.910973618999
             les_mean =     286.330150882423
             stat err =       0.000467223960
             autocorr =       1.250554434371
              std dev =       0.590865733046
             le_variance =       0.349122314488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349155859473
                                         uncertainty =       0.020657200093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349155859473
                                         uncertainty =       0.020657200093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417805167
  error estimate for blocks of size 2^( 2) =       0.000429438226
  error estimate for blocks of size 2^( 3) =       0.000441636017
  error estimate for blocks of size 2^( 4) =       0.000453438349
  error estimate for blocks of size 2^( 5) =       0.000464558131
  error estimate for blocks of size 2^( 6) =       0.000473426782
  error estimate for blocks of size 2^( 7) =       0.000477472581

      target function =                  N/A
              le_mean =     -16.910973618999
             les_mean =     286.330150882423
             stat err =       0.000467223960
             autocorr =       1.250554434371
              std dev =       0.590865733046
             le_variance =       0.349122314488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349155859473
                                         uncertainty =       0.020657200093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349155859473
                                         uncertainty =       0.020657200093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417805167
  error estimate for blocks of size 2^( 2) =       0.000429438226
  error estimate for blocks of size 2^( 3) =       0.000441636017
  error estimate for blocks of size 2^( 4) =       0.000453438349
  error estimate for blocks of size 2^( 5) =       0.000464558131
  error estimate for blocks of size 2^( 6) =       0.000473426782
  error estimate for blocks of size 2^( 7) =       0.000477472581

      target function =                  N/A
              le_mean =     -16.910973618999
             les_mean =     286.330150882423
             stat err =       0.000467223960
             autocorr =       1.250554434371
              std dev =       0.590865733046
             le_variance =       0.349122314488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349155859473
                                         uncertainty =       0.020657200093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349155859473
                                         uncertainty =       0.020657200093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417805167
  error estimate for blocks of size 2^( 2) =       0.000429438226
  error estimate for blocks of size 2^( 3) =       0.000441636017
  error estimate for blocks of size 2^( 4) =       0.000453438349
  error estimate for blocks of size 2^( 5) =       0.000464558131
  error estimate for blocks of size 2^( 6) =       0.000473426782
  error estimate for blocks of size 2^( 7) =       0.000477472581

      target function =                  N/A
              le_mean =     -16.910973618999
             les_mean =     286.330150882423
             stat err =       0.000467223960
             autocorr =       1.250554434371
              std dev =       0.590865733046
             le_variance =       0.349122314488


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910973618999        initial  <--
     9.7656e+23     9.7656e+24             0.0000e+00       -16.910973618999
     3.9062e+24     3.9062e+25             0.0000e+00       -16.910973618999
     1.5625e+25     1.5625e+26             0.0000e+00       -16.910973618999

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2592
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4279e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9355
    reference variance = 0.25427
====================================================
  Execution time = 2.5496e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.2994e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6622e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330073439239
                                         uncertainty =       0.003812969232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330073439239
                                         uncertainty =       0.003812969232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406165722
  error estimate for blocks of size 2^( 2) =       0.000417704796
  error estimate for blocks of size 2^( 3) =       0.000429644579
  error estimate for blocks of size 2^( 4) =       0.000441206043
  error estimate for blocks of size 2^( 5) =       0.000451519644
  error estimate for blocks of size 2^( 6) =       0.000460216260
  error estimate for blocks of size 2^( 7) =       0.000465480091

      target function =                  N/A
              le_mean =     -16.909458274751
             les_mean =     286.259720168132
             stat err =       0.000454605510
             autocorr =       1.252745502525
              std dev =       0.574405072709
             le_variance =       0.329941187554


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690945827475e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+24, overlap shift 9.7656e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909458274751       residual = 9.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909458274751       residual = 9.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+25, overlap shift 3.9062e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909458274751       residual = 9.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909458274751       residual = 9.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+26, overlap shift 1.5625e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909458274751       residual = 9.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909458274751       residual = 9.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203819 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2168e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8015
    reference variance = 0.178673
====================================================
  Execution time = 2.4959e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2893e-01
  Total weights = 2.0000e+06
  Execution time = 2.9852e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329009866868
                                         uncertainty =       0.004367425077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329009866868
                                         uncertainty =       0.004367425077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405545682
  error estimate for blocks of size 2^( 2) =       0.000417470747
  error estimate for blocks of size 2^( 3) =       0.000429128438
  error estimate for blocks of size 2^( 4) =       0.000440775781
  error estimate for blocks of size 2^( 5) =       0.000450150392
  error estimate for blocks of size 2^( 6) =       0.000458000663
  error estimate for blocks of size 2^( 7) =       0.000461781481

      target function =                  N/A
              le_mean =     -16.910550712051
             les_mean =     286.295659819974
             stat err =       0.000452677079
             autocorr =       1.245940915433
              std dev =       0.573528202975
             le_variance =       0.328934599608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329009866868
                                         uncertainty =       0.004367425077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329009866868
                                         uncertainty =       0.004367425077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405545682
  error estimate for blocks of size 2^( 2) =       0.000417470747
  error estimate for blocks of size 2^( 3) =       0.000429128438
  error estimate for blocks of size 2^( 4) =       0.000440775781
  error estimate for blocks of size 2^( 5) =       0.000450150392
  error estimate for blocks of size 2^( 6) =       0.000458000663
  error estimate for blocks of size 2^( 7) =       0.000461781481

      target function =                  N/A
              le_mean =     -16.910550712051
             les_mean =     286.295659819974
             stat err =       0.000452677079
             autocorr =       1.245940915433
              std dev =       0.573528202975
             le_variance =       0.328934599608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329009866868
                                         uncertainty =       0.004367425077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329009866868
                                         uncertainty =       0.004367425077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405545682
  error estimate for blocks of size 2^( 2) =       0.000417470747
  error estimate for blocks of size 2^( 3) =       0.000429128438
  error estimate for blocks of size 2^( 4) =       0.000440775781
  error estimate for blocks of size 2^( 5) =       0.000450150392
  error estimate for blocks of size 2^( 6) =       0.000458000663
  error estimate for blocks of size 2^( 7) =       0.000461781481

      target function =                  N/A
              le_mean =     -16.910550712051
             les_mean =     286.295659819974
             stat err =       0.000452677079
             autocorr =       1.245940915433
              std dev =       0.573528202975
             le_variance =       0.328934599608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329009866868
                                         uncertainty =       0.004367425077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329009866868
                                         uncertainty =       0.004367425077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405545682
  error estimate for blocks of size 2^( 2) =       0.000417470747
  error estimate for blocks of size 2^( 3) =       0.000429128438
  error estimate for blocks of size 2^( 4) =       0.000440775781
  error estimate for blocks of size 2^( 5) =       0.000450150392
  error estimate for blocks of size 2^( 6) =       0.000458000663
  error estimate for blocks of size 2^( 7) =       0.000461781481

      target function =                  N/A
              le_mean =     -16.910550712051
             les_mean =     286.295659819974
             stat err =       0.000452677079
             autocorr =       1.245940915433
              std dev =       0.573528202975
             le_variance =       0.328934599608


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910550712051        initial  <--
     9.7656e+24     9.7656e+25             0.0000e+00       -16.910550712051
     3.9062e+25     3.9062e+26             0.0000e+00       -16.910550712051
     1.5625e+26     1.5625e+27             0.0000e+00       -16.910550712051

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.8127
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1987e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9068
    reference variance = 0.172993
====================================================
  Execution time = 2.5568e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2664e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326666496238
                                         uncertainty =       0.002968359369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326666496238
                                         uncertainty =       0.002968359369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404126334
  error estimate for blocks of size 2^( 2) =       0.000416221633
  error estimate for blocks of size 2^( 3) =       0.000428883091
  error estimate for blocks of size 2^( 4) =       0.000440441279
  error estimate for blocks of size 2^( 5) =       0.000451327347
  error estimate for blocks of size 2^( 6) =       0.000460531927
  error estimate for blocks of size 2^( 7) =       0.000466052965

      target function =                  N/A
              le_mean =     -16.911350998180
             les_mean =     286.320428607953
             stat err =       0.000454588379
             autocorr =       1.265325781384
              std dev =       0.571520942415
             le_variance =       0.326636187618


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691135099818e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+25, overlap shift 9.7656e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911350998180       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911350998180       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+26, overlap shift 3.9062e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911350998180       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911350998180       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+27, overlap shift 1.5625e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911350998180       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911350998180       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204924 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2294e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9336
    reference variance = 0.164674
====================================================
  Execution time = 2.4970e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2387e-01
  Total weights = 2.0000e+06
  Execution time = 2.9643e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323971497273
                                         uncertainty =       0.003612603247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323971497273
                                         uncertainty =       0.003612603247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402412505
  error estimate for blocks of size 2^( 2) =       0.000413875818
  error estimate for blocks of size 2^( 3) =       0.000426244806
  error estimate for blocks of size 2^( 4) =       0.000437671926
  error estimate for blocks of size 2^( 5) =       0.000448419481
  error estimate for blocks of size 2^( 6) =       0.000455764140
  error estimate for blocks of size 2^( 7) =       0.000459365521

      target function =                  N/A
              le_mean =     -16.910735130673
             les_mean =     286.296834146085
             stat err =       0.000450305267
             autocorr =       1.252192555808
              std dev =       0.569097222141
             le_variance =       0.323871648249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323971497273
                                         uncertainty =       0.003612603247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323971497273
                                         uncertainty =       0.003612603247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402412505
  error estimate for blocks of size 2^( 2) =       0.000413875818
  error estimate for blocks of size 2^( 3) =       0.000426244806
  error estimate for blocks of size 2^( 4) =       0.000437671926
  error estimate for blocks of size 2^( 5) =       0.000448419481
  error estimate for blocks of size 2^( 6) =       0.000455764140
  error estimate for blocks of size 2^( 7) =       0.000459365521

      target function =                  N/A
              le_mean =     -16.910735130673
             les_mean =     286.296834146085
             stat err =       0.000450305267
             autocorr =       1.252192555808
              std dev =       0.569097222141
             le_variance =       0.323871648249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323971497273
                                         uncertainty =       0.003612603247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323971497273
                                         uncertainty =       0.003612603247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402412505
  error estimate for blocks of size 2^( 2) =       0.000413875818
  error estimate for blocks of size 2^( 3) =       0.000426244806
  error estimate for blocks of size 2^( 4) =       0.000437671926
  error estimate for blocks of size 2^( 5) =       0.000448419481
  error estimate for blocks of size 2^( 6) =       0.000455764140
  error estimate for blocks of size 2^( 7) =       0.000459365521

      target function =                  N/A
              le_mean =     -16.910735130673
             les_mean =     286.296834146085
             stat err =       0.000450305267
             autocorr =       1.252192555808
              std dev =       0.569097222141
             le_variance =       0.323871648249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323971497273
                                         uncertainty =       0.003612603247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323971497273
                                         uncertainty =       0.003612603247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402412505
  error estimate for blocks of size 2^( 2) =       0.000413875818
  error estimate for blocks of size 2^( 3) =       0.000426244806
  error estimate for blocks of size 2^( 4) =       0.000437671926
  error estimate for blocks of size 2^( 5) =       0.000448419481
  error estimate for blocks of size 2^( 6) =       0.000455764140
  error estimate for blocks of size 2^( 7) =       0.000459365521

      target function =                  N/A
              le_mean =     -16.910735130673
             les_mean =     286.296834146085
             stat err =       0.000450305267
             autocorr =       1.252192555808
              std dev =       0.569097222141
             le_variance =       0.323871648249


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910735130673        initial  <--
     9.7656e+25     9.7656e+26             0.0000e+00       -16.910735130673
     3.9062e+26     3.9062e+27             0.0000e+00       -16.910735130673
     1.5625e+27     1.5625e+28             0.0000e+00       -16.910735130673

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.8141
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2116e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.0152
    reference variance = 0.400098
====================================================
  Execution time = 2.5610e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3445e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6423e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334458236464
                                         uncertainty =       0.006208986129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334458236464
                                         uncertainty =       0.006208986129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408930557
  error estimate for blocks of size 2^( 2) =       0.000420610077
  error estimate for blocks of size 2^( 3) =       0.000433022580
  error estimate for blocks of size 2^( 4) =       0.000444307433
  error estimate for blocks of size 2^( 5) =       0.000453306224
  error estimate for blocks of size 2^( 6) =       0.000458841086
  error estimate for blocks of size 2^( 7) =       0.000463325388

      target function =                  N/A
              le_mean =     -16.910419213100
             les_mean =     286.296726195885
             stat err =       0.000454945033
             autocorr =       1.237709510626
              std dev =       0.578315139299
             le_variance =       0.334448400342


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691041921310e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+26, overlap shift 9.7656e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910419213100       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910419213100       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+27, overlap shift 3.9062e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910419213100       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910419213100       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+28, overlap shift 1.5625e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910419213100       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910419213100       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206035 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2262e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9392
    reference variance = 0.254996
====================================================
  Execution time = 2.5069e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3245e-01
  Total weights = 2.0000e+06
  Execution time = 2.9603e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332443386009
                                         uncertainty =       0.008343289097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332443386009
                                         uncertainty =       0.008343289097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407709281
  error estimate for blocks of size 2^( 2) =       0.000419111976
  error estimate for blocks of size 2^( 3) =       0.000430761539
  error estimate for blocks of size 2^( 4) =       0.000441687467
  error estimate for blocks of size 2^( 5) =       0.000450728619
  error estimate for blocks of size 2^( 6) =       0.000456706806
  error estimate for blocks of size 2^( 7) =       0.000460935503

      target function =                  N/A
              le_mean =     -16.910851131967
             les_mean =     286.309339556128
             stat err =       0.000452514599
             autocorr =       1.231867491982
              std dev =       0.576587993992
             le_variance =       0.332453714815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332443386009
                                         uncertainty =       0.008343289097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332443386009
                                         uncertainty =       0.008343289097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407709281
  error estimate for blocks of size 2^( 2) =       0.000419111976
  error estimate for blocks of size 2^( 3) =       0.000430761539
  error estimate for blocks of size 2^( 4) =       0.000441687467
  error estimate for blocks of size 2^( 5) =       0.000450728619
  error estimate for blocks of size 2^( 6) =       0.000456706806
  error estimate for blocks of size 2^( 7) =       0.000460935503

      target function =                  N/A
              le_mean =     -16.910851131967
             les_mean =     286.309339556128
             stat err =       0.000452514599
             autocorr =       1.231867491982
              std dev =       0.576587993992
             le_variance =       0.332453714815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332443386009
                                         uncertainty =       0.008343289097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332443386009
                                         uncertainty =       0.008343289097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407709281
  error estimate for blocks of size 2^( 2) =       0.000419111976
  error estimate for blocks of size 2^( 3) =       0.000430761539
  error estimate for blocks of size 2^( 4) =       0.000441687467
  error estimate for blocks of size 2^( 5) =       0.000450728619
  error estimate for blocks of size 2^( 6) =       0.000456706806
  error estimate for blocks of size 2^( 7) =       0.000460935503

      target function =                  N/A
              le_mean =     -16.910851131967
             les_mean =     286.309339556128
             stat err =       0.000452514599
             autocorr =       1.231867491982
              std dev =       0.576587993992
             le_variance =       0.332453714815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332443386009
                                         uncertainty =       0.008343289097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332443386009
                                         uncertainty =       0.008343289097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407709281
  error estimate for blocks of size 2^( 2) =       0.000419111976
  error estimate for blocks of size 2^( 3) =       0.000430761539
  error estimate for blocks of size 2^( 4) =       0.000441687467
  error estimate for blocks of size 2^( 5) =       0.000450728619
  error estimate for blocks of size 2^( 6) =       0.000456706806
  error estimate for blocks of size 2^( 7) =       0.000460935503

      target function =                  N/A
              le_mean =     -16.910851131967
             les_mean =     286.309339556128
             stat err =       0.000452514599
             autocorr =       1.231867491982
              std dev =       0.576587993992
             le_variance =       0.332453714815


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910851131967        initial  <--
     9.7656e+26     9.7656e+27             0.0000e+00       -16.910851131967
     3.9062e+27     3.9062e+28             0.0000e+00       -16.910851131967
     1.5625e+28     1.5625e+29             0.0000e+00       -16.910851131967

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.9093
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2178e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8424
    reference variance = 0.278712
====================================================
  Execution time = 2.5517e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3524e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335297724021
                                         uncertainty =       0.004605245279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335297724021
                                         uncertainty =       0.004605245279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409414055
  error estimate for blocks of size 2^( 2) =       0.000420575278
  error estimate for blocks of size 2^( 3) =       0.000433172983
  error estimate for blocks of size 2^( 4) =       0.000444682867
  error estimate for blocks of size 2^( 5) =       0.000454608334
  error estimate for blocks of size 2^( 6) =       0.000463189627
  error estimate for blocks of size 2^( 7) =       0.000465714876

      target function =                  N/A
              le_mean =     -16.910436581973
             les_mean =     286.298104962654
             stat err =       0.000457048926
             autocorr =       1.246234842583
              std dev =       0.578998909635
             le_variance =       0.335239737359


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691043658197e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+27, overlap shift 9.7656e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910436581973       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910436581973       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910436582053       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+27 is 1.231468e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+28, overlap shift 3.9062e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910436581973       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910436581973       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910436581973       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+28 is 3.078670e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+29, overlap shift 1.5625e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910436581973       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910436581973       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910436581820       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+29 is 7.696674e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207417 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2215e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8416
    reference variance = 0.180494
====================================================
  Execution time = 2.7191e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4964e-01
  Total weights = 2.0000e+06
  Execution time = 2.9775e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349759707786
                                         uncertainty =       0.021780601668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349759707786
                                         uncertainty =       0.021780601668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418116151
  error estimate for blocks of size 2^( 2) =       0.000429969978
  error estimate for blocks of size 2^( 3) =       0.000442192423
  error estimate for blocks of size 2^( 4) =       0.000454846914
  error estimate for blocks of size 2^( 5) =       0.000465932269
  error estimate for blocks of size 2^( 6) =       0.000468391877
  error estimate for blocks of size 2^( 7) =       0.000477187290

      target function =                  N/A
              le_mean =     -16.910768362946
             les_mean =     286.323728682389
             stat err =       0.000466589588
             autocorr =       1.245306335314
              std dev =       0.591305531842
             le_variance =       0.349642231987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349759707786
                                         uncertainty =       0.021780601668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349759707786
                                         uncertainty =       0.021780601668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418116151
  error estimate for blocks of size 2^( 2) =       0.000429969978
  error estimate for blocks of size 2^( 3) =       0.000442192423
  error estimate for blocks of size 2^( 4) =       0.000454846914
  error estimate for blocks of size 2^( 5) =       0.000465932269
  error estimate for blocks of size 2^( 6) =       0.000468391877
  error estimate for blocks of size 2^( 7) =       0.000477187290

      target function =                  N/A
              le_mean =     -16.910768362946
             les_mean =     286.323728682389
             stat err =       0.000466589588
             autocorr =       1.245306335314
              std dev =       0.591305531842
             le_variance =       0.349642231987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349759707786
                                         uncertainty =       0.021780601668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349759707786
                                         uncertainty =       0.021780601668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418116151
  error estimate for blocks of size 2^( 2) =       0.000429969978
  error estimate for blocks of size 2^( 3) =       0.000442192423
  error estimate for blocks of size 2^( 4) =       0.000454846914
  error estimate for blocks of size 2^( 5) =       0.000465932269
  error estimate for blocks of size 2^( 6) =       0.000468391877
  error estimate for blocks of size 2^( 7) =       0.000477187290

      target function =                  N/A
              le_mean =     -16.910768362946
             les_mean =     286.323728682389
             stat err =       0.000466589588
             autocorr =       1.245306335314
              std dev =       0.591305531842
             le_variance =       0.349642231987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349759707786
                                         uncertainty =       0.021780601668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349759707786
                                         uncertainty =       0.021780601668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418116151
  error estimate for blocks of size 2^( 2) =       0.000429969978
  error estimate for blocks of size 2^( 3) =       0.000442192423
  error estimate for blocks of size 2^( 4) =       0.000454846914
  error estimate for blocks of size 2^( 5) =       0.000465932269
  error estimate for blocks of size 2^( 6) =       0.000468391877
  error estimate for blocks of size 2^( 7) =       0.000477187290

      target function =                  N/A
              le_mean =     -16.910768362946
             les_mean =     286.323728682389
             stat err =       0.000466589588
             autocorr =       1.245306335314
              std dev =       0.591305531842
             le_variance =       0.349642231987


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910768362946        initial  <--
     9.7656e+27     9.7656e+28             1.2315e-32       -16.910768362946
     3.9062e+28     3.9062e+29             3.0787e-33       -16.910768362946
     1.5625e+29     1.5625e+30             7.6967e-34       -16.910768362946

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.0649
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4287e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8091
    reference variance = 0.505284
====================================================
  Execution time = 2.5462e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2918e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7855e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329217895169
                                         uncertainty =       0.003625853262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329217895169
                                         uncertainty =       0.003625853262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405696075
  error estimate for blocks of size 2^( 2) =       0.000417650968
  error estimate for blocks of size 2^( 3) =       0.000430108260
  error estimate for blocks of size 2^( 4) =       0.000441103790
  error estimate for blocks of size 2^( 5) =       0.000452650437
  error estimate for blocks of size 2^( 6) =       0.000460594227
  error estimate for blocks of size 2^( 7) =       0.000466985418

      target function =                  N/A
              le_mean =     -16.910561325154
             les_mean =     286.296262777360
             stat err =       0.000455333468
             autocorr =       1.259672169795
              std dev =       0.573740891127
             le_variance =       0.329178610151


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691056132515e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+28, overlap shift 9.7656e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910561325154       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910561325154       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+29, overlap shift 3.9062e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910561325154       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910561325154       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+30, overlap shift 1.5625e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910561325154       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910561325154       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208517 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2258e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9312
    reference variance = 0.240828
====================================================
  Execution time = 2.4927e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3082e-01
  Total weights = 2.0000e+06
  Execution time = 2.9836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330933909367
                                         uncertainty =       0.004214673275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330933909367
                                         uncertainty =       0.004214673275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406704793
  error estimate for blocks of size 2^( 2) =       0.000418207196
  error estimate for blocks of size 2^( 3) =       0.000430802630
  error estimate for blocks of size 2^( 4) =       0.000442085638
  error estimate for blocks of size 2^( 5) =       0.000453411261
  error estimate for blocks of size 2^( 6) =       0.000460744468
  error estimate for blocks of size 2^( 7) =       0.000466266212

      target function =                  N/A
              le_mean =     -16.910677684495
             les_mean =     286.301837161447
             stat err =       0.000455626895
             autocorr =       1.255047380761
              std dev =       0.575167434737
             le_variance =       0.330817577982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330933909367
                                         uncertainty =       0.004214673275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330933909367
                                         uncertainty =       0.004214673275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406704793
  error estimate for blocks of size 2^( 2) =       0.000418207196
  error estimate for blocks of size 2^( 3) =       0.000430802630
  error estimate for blocks of size 2^( 4) =       0.000442085638
  error estimate for blocks of size 2^( 5) =       0.000453411261
  error estimate for blocks of size 2^( 6) =       0.000460744468
  error estimate for blocks of size 2^( 7) =       0.000466266212

      target function =                  N/A
              le_mean =     -16.910677684495
             les_mean =     286.301837161447
             stat err =       0.000455626895
             autocorr =       1.255047380761
              std dev =       0.575167434737
             le_variance =       0.330817577982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330933909367
                                         uncertainty =       0.004214673275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330933909367
                                         uncertainty =       0.004214673275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406704793
  error estimate for blocks of size 2^( 2) =       0.000418207196
  error estimate for blocks of size 2^( 3) =       0.000430802630
  error estimate for blocks of size 2^( 4) =       0.000442085638
  error estimate for blocks of size 2^( 5) =       0.000453411261
  error estimate for blocks of size 2^( 6) =       0.000460744468
  error estimate for blocks of size 2^( 7) =       0.000466266212

      target function =                  N/A
              le_mean =     -16.910677684495
             les_mean =     286.301837161447
             stat err =       0.000455626895
             autocorr =       1.255047380761
              std dev =       0.575167434737
             le_variance =       0.330817577982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330933909367
                                         uncertainty =       0.004214673275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330933909367
                                         uncertainty =       0.004214673275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406704793
  error estimate for blocks of size 2^( 2) =       0.000418207196
  error estimate for blocks of size 2^( 3) =       0.000430802630
  error estimate for blocks of size 2^( 4) =       0.000442085638
  error estimate for blocks of size 2^( 5) =       0.000453411261
  error estimate for blocks of size 2^( 6) =       0.000460744468
  error estimate for blocks of size 2^( 7) =       0.000466266212

      target function =                  N/A
              le_mean =     -16.910677684495
             les_mean =     286.301837161447
             stat err =       0.000455626895
             autocorr =       1.255047380761
              std dev =       0.575167434737
             le_variance =       0.330817577982


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910677684495        initial  <--
     9.7656e+28     9.7656e+29             0.0000e+00       -16.910677684495
     3.9062e+29     3.9062e+30             0.0000e+00       -16.910677684495
     1.5625e+30     1.5625e+31             0.0000e+00       -16.910677684495

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.7944
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2059e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 30408 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8665
    reference variance = 0.19628
====================================================
  Execution time = 2.5370e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3556e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6472e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335565931460
                                         uncertainty =       0.005613468914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335565931460
                                         uncertainty =       0.005613468914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409612674
  error estimate for blocks of size 2^( 2) =       0.000421754401
  error estimate for blocks of size 2^( 3) =       0.000434428885
  error estimate for blocks of size 2^( 4) =       0.000446074707
  error estimate for blocks of size 2^( 5) =       0.000457274207
  error estimate for blocks of size 2^( 6) =       0.000465461202
  error estimate for blocks of size 2^( 7) =       0.000473490606

      target function =                  N/A
              le_mean =     -16.909681975675
             les_mean =     286.272909436437
             stat err =       0.000460575180
             autocorr =       1.264312086431
              std dev =       0.579279799203
             le_variance =       0.335565085765


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690968197567e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+29, overlap shift 9.7656e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909681975675       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909681975675       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+30, overlap shift 3.9062e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909681975675       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909681975675       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+31, overlap shift 1.5625e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909681975675       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909681975675       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.209595 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2026e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9481
    reference variance = 0.236638
====================================================
  Execution time = 2.5104e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3087e-01
  Total weights = 2.0000e+06
  Execution time = 2.9716e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331014271450
                                         uncertainty =       0.005117804894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331014271450
                                         uncertainty =       0.005117804894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406739556
  error estimate for blocks of size 2^( 2) =       0.000418565703
  error estimate for blocks of size 2^( 3) =       0.000431252857
  error estimate for blocks of size 2^( 4) =       0.000442666788
  error estimate for blocks of size 2^( 5) =       0.000453863465
  error estimate for blocks of size 2^( 6) =       0.000462636365
  error estimate for blocks of size 2^( 7) =       0.000470716900

      target function =                  N/A
              le_mean =     -16.910715748289
             les_mean =     286.303181086753
             stat err =       0.000457470879
             autocorr =       1.265010374777
              std dev =       0.575216596380
             le_variance =       0.330874132751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331014271450
                                         uncertainty =       0.005117804894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331014271450
                                         uncertainty =       0.005117804894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406739556
  error estimate for blocks of size 2^( 2) =       0.000418565703
  error estimate for blocks of size 2^( 3) =       0.000431252857
  error estimate for blocks of size 2^( 4) =       0.000442666788
  error estimate for blocks of size 2^( 5) =       0.000453863465
  error estimate for blocks of size 2^( 6) =       0.000462636365
  error estimate for blocks of size 2^( 7) =       0.000470716900

      target function =                  N/A
              le_mean =     -16.910715748289
             les_mean =     286.303181086753
             stat err =       0.000457470879
             autocorr =       1.265010374777
              std dev =       0.575216596380
             le_variance =       0.330874132751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331014271450
                                         uncertainty =       0.005117804894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331014271450
                                         uncertainty =       0.005117804894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406739556
  error estimate for blocks of size 2^( 2) =       0.000418565703
  error estimate for blocks of size 2^( 3) =       0.000431252857
  error estimate for blocks of size 2^( 4) =       0.000442666788
  error estimate for blocks of size 2^( 5) =       0.000453863465
  error estimate for blocks of size 2^( 6) =       0.000462636365
  error estimate for blocks of size 2^( 7) =       0.000470716900

      target function =                  N/A
              le_mean =     -16.910715748289
             les_mean =     286.303181086753
             stat err =       0.000457470879
             autocorr =       1.265010374777
              std dev =       0.575216596380
             le_variance =       0.330874132751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331014271450
                                         uncertainty =       0.005117804894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331014271450
                                         uncertainty =       0.005117804894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406739556
  error estimate for blocks of size 2^( 2) =       0.000418565703
  error estimate for blocks of size 2^( 3) =       0.000431252857
  error estimate for blocks of size 2^( 4) =       0.000442666788
  error estimate for blocks of size 2^( 5) =       0.000453863465
  error estimate for blocks of size 2^( 6) =       0.000462636365
  error estimate for blocks of size 2^( 7) =       0.000470716900

      target function =                  N/A
              le_mean =     -16.910715748289
             les_mean =     286.303181086753
             stat err =       0.000457470879
             autocorr =       1.265010374777
              std dev =       0.575216596380
             le_variance =       0.330874132751


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910715748289        initial  <--
     9.7656e+29     9.7656e+30             0.0000e+00       -16.910715748289
     3.9062e+30     3.9062e+31             0.0000e+00       -16.910715748289
     1.5625e+31     1.5625e+32             0.0000e+00       -16.910715748289

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 39.9308
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.082082e-01 1 1  ON 0
 uu_1                 1.432603e-01 1 1  ON 1
 uu_2                 4.597145e-02 1 1  ON 2
 uu_3                -1.620535e-02 1 1  ON 3
 uu_4                -6.441045e-02 1 1  ON 4
 uu_5                -9.943215e-02 1 1  ON 5
 uu_6                -1.259196e-01 1 1  ON 6
 uu_7                -1.376090e-01 1 1  ON 7
 uu_8                -1.283339e-01 1 1  ON 8
 uu_9                -9.888524e-02 1 1  ON 9
 ud_0                 4.306294e-01 1 1  ON 10
 ud_1                 1.742874e-01 1 1  ON 11
 ud_2                 6.136616e-02 1 1  ON 12
 ud_3                -6.096156e-03 1 1  ON 13
 ud_4                -6.048189e-02 1 1  ON 14
 ud_5                -1.020292e-01 1 1  ON 15
 ud_6                -1.304350e-01 1 1  ON 16
 ud_7                -1.483846e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.399676e-01 1 1  ON 19
 eO_0                -7.453560e-01 1 1  ON 20
 eO_1                -4.311340e-01 1 1  ON 21
 eO_2                -1.701160e-02 1 1  ON 22
 eO_3                 2.974036e-01 1 1  ON 23
 eO_4                 5.142758e-01 1 1  ON 24
 eO_5                 4.691238e-01 1 1  ON 25
 eO_6                 2.396093e-01 1 1  ON 26
 eO_7                -5.249441e-02 1 1  ON 27
 eO_8                -2.081295e-01 1 1  ON 28
 eO_9                -6.776471e-02 1 1  ON 29
eH1_0                -2.419009e-01 1 1  ON 30
eH1_1                -1.380306e-01 1 1  ON 31
eH1_2                -9.497510e-02 1 1  ON 32
eH1_3                -4.353488e-02 1 1  ON 33
eH1_4                 1.229558e-02 1 1  ON 34
eH1_5                 4.924344e-02 1 1  ON 35
eH1_6                 1.059109e-01 1 1  ON 36
eH1_7                 1.523201e-01 1 1  ON 37
eH1_8                 1.609251e-01 1 1  ON 38
eH1_9                 4.339469e-02 1 1  ON 39
eH2_0                -2.407742e-01 1 1  ON 40
eH2_1                -1.364522e-01 1 1  ON 41
eH2_2                -9.334514e-02 1 1  ON 42
eH2_3                -4.180876e-02 1 1  ON 43
eH2_4                 1.462414e-02 1 1  ON 44
eH2_5                 5.182405e-02 1 1  ON 45
eH2_6                 1.090218e-01 1 1  ON 46
eH2_7                 1.557199e-01 1 1  ON 47
eH2_8                 1.689714e-01 1 1  ON 48
eH2_9                 2.966750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1964e+01 secs
  Total Execution time = 2.9101e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
