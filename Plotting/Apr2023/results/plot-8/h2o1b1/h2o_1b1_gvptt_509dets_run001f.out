Rank =    0  Free Memory = 65093 MB
Rank =    1  Free Memory = 65093 MB
Rank =    2  Free Memory = 65092 MB
Rank =    3  Free Memory = 65092 MB
Rank =    4  Free Memory = 65091 MB
Rank =    5  Free Memory = 65091 MB
Rank =    6  Free Memory = 65091 MB
Rank =    7  Free Memory = 65091 MB
Rank =    8  Free Memory = 65091 MB
Rank =    9  Free Memory = 65091 MB
Rank =   10  Free Memory = 65091 MB
Rank =   11  Free Memory = 65091 MB
Rank =   12  Free Memory = 65091 MB
Rank =   13  Free Memory = 65090 MB
Rank =   14  Free Memory = 65090 MB
Rank =   15  Free Memory = 65077 MB
Rank =   16  Free Memory = 65076 MB
Rank =   17  Free Memory = 65076 MB
Rank =   18  Free Memory = 65076 MB
Rank =   19  Free Memory = 65076 MB
Rank =   20  Free Memory = 65076 MB
Rank =   21  Free Memory = 65076 MB
Rank =   22  Free Memory = 65076 MB
Rank =   23  Free Memory = 65076 MB
Rank =   24  Free Memory = 65076 MB
Rank =   25  Free Memory = 65076 MB
Rank =   26  Free Memory = 65076 MB
Rank =   27  Free Memory = 65076 MB
Rank =   28  Free Memory = 65076 MB
Rank =   29  Free Memory = 65076 MB
Rank =   30  Free Memory = 65076 MB
Rank =   31  Free Memory = 65076 MB
Rank =   32  Free Memory = 71612 MB
Rank =   33  Free Memory = 71612 MB
Rank =   34  Free Memory = 71612 MB
Rank =   35  Free Memory = 71612 MB
Rank =   36  Free Memory = 71612 MB
Rank =   37  Free Memory = 71612 MB
Rank =   38  Free Memory = 71612 MB
Rank =   39  Free Memory = 71612 MB
Rank =   40  Free Memory = 71612 MB
Rank =   41  Free Memory = 71612 MB
Rank =   42  Free Memory = 71612 MB
Rank =   43  Free Memory = 71612 MB
Rank =   44  Free Memory = 71612 MB
Rank =   45  Free Memory = 71612 MB
Rank =   46  Free Memory = 71612 MB
Rank =   47  Free Memory = 71612 MB
Rank =   48  Free Memory = 71612 MB
Rank =   49  Free Memory = 71612 MB
Rank =   50  Free Memory = 71612 MB
Rank =   51  Free Memory = 71612 MB
Rank =   52  Free Memory = 71612 MB
Rank =   53  Free Memory = 71612 MB
Rank =   54  Free Memory = 71612 MB
Rank =   55  Free Memory = 71612 MB
Rank =   56  Free Memory = 71612 MB
Rank =   57  Free Memory = 71612 MB
Rank =   58  Free Memory = 71612 MB
Rank =   59  Free Memory = 71612 MB
Rank =   60  Free Memory = 71612 MB
Rank =   61  Free Memory = 71612 MB
Rank =   62  Free Memory = 71612 MB
Rank =   63  Free Memory = 71612 MB
Rank =   64  Free Memory = 70500 MB
Rank =   65  Free Memory = 70500 MB
Rank =   66  Free Memory = 70500 MB
Rank =   67  Free Memory = 70500 MB
Rank =   68  Free Memory = 70500 MB
Rank =   69  Free Memory = 70500 MB
Rank =   70  Free Memory = 70500 MB
Rank =   71  Free Memory = 70500 MB
Rank =   72  Free Memory = 70499 MB
Rank =   73  Free Memory = 70499 MB
Rank =   74  Free Memory = 70499 MB
Rank =   75  Free Memory = 70499 MB
Rank =   76  Free Memory = 70499 MB
Rank =   77  Free Memory = 70499 MB
Rank =   78  Free Memory = 70499 MB
Rank =   79  Free Memory = 70499 MB
Rank =   80  Free Memory = 70499 MB
Rank =   81  Free Memory = 70499 MB
Rank =   82  Free Memory = 70499 MB
Rank =   83  Free Memory = 70499 MB
Rank =   84  Free Memory = 70499 MB
Rank =   85  Free Memory = 70499 MB
Rank =   86  Free Memory = 70499 MB
Rank =   87  Free Memory = 70499 MB
Rank =   88  Free Memory = 70499 MB
Rank =   89  Free Memory = 70499 MB
Rank =   90  Free Memory = 70499 MB
Rank =   91  Free Memory = 70499 MB
Rank =   92  Free Memory = 70499 MB
Rank =   93  Free Memory = 70499 MB
Rank =   94  Free Memory = 70499 MB
Rank =   95  Free Memory = 70499 MB
Rank =   96  Free Memory = 85067 MB
Rank =   97  Free Memory = 85067 MB
Rank =   98  Free Memory = 85067 MB
Rank =   99  Free Memory = 85067 MB
Rank =  100  Free Memory = 85067 MB
Rank =  101  Free Memory = 85067 MB
Rank =  102  Free Memory = 85067 MB
Rank =  103  Free Memory = 85067 MB
Rank =  104  Free Memory = 85067 MB
Rank =  105  Free Memory = 85067 MB
Rank =  106  Free Memory = 85067 MB
Rank =  107  Free Memory = 85067 MB
Rank =  108  Free Memory = 85067 MB
Rank =  109  Free Memory = 85067 MB
Rank =  110  Free Memory = 85067 MB
Rank =  111  Free Memory = 85067 MB
Rank =  112  Free Memory = 85067 MB
Rank =  113  Free Memory = 85067 MB
Rank =  114  Free Memory = 85067 MB
Rank =  115  Free Memory = 85067 MB
Rank =  116  Free Memory = 85067 MB
Rank =  117  Free Memory = 85067 MB
Rank =  118  Free Memory = 85067 MB
Rank =  119  Free Memory = 85067 MB
Rank =  120  Free Memory = 85067 MB
Rank =  121  Free Memory = 85067 MB
Rank =  122  Free Memory = 85067 MB
Rank =  123  Free Memory = 85067 MB
Rank =  124  Free Memory = 85067 MB
Rank =  125  Free Memory = 85067 MB
Rank =  126  Free Memory = 85067 MB
Rank =  127  Free Memory = 85067 MB
  Input file(s): opt_h2o_1b1_gvptt_509dets_run001f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_509dets_run001f.xml

  Project = H2O
  date    = 2023-05-12 09:05:14 PDT
  host    = n0063.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 954

  Range of prime numbers to use as seeds over processors and threads = 7541-8699


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.104488e-01    1         1  ON     0
     uu_1                 1.451872e-01    1         1  ON     1
     uu_2                 4.686032e-02    1         1  ON     2
     uu_3                -1.690185e-02    1         1  ON     3
     uu_4                -6.719980e-02    1         1  ON     4
     uu_5                -1.045517e-01    1         1  ON     5
     uu_6                -1.337664e-01    1         1  ON     6
     uu_7                -1.484277e-01    1         1  ON     7
     uu_8                -1.417913e-01    1         1  ON     8
     uu_9                -1.133394e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.377993e-01    1         1  ON     0
     ud_1                 1.807766e-01    1         1  ON     1
     ud_2                 6.676427e-02    1         1  ON     2
     ud_3                -2.468539e-03    1         1  ON     3
     ud_4                -5.879366e-02    1         1  ON     4
     ud_5                -1.017359e-01    1         1  ON     5
     ud_6                -1.314851e-01    1         1  ON     6
     ud_7                -1.518336e-01    1         1  ON     7
     ud_8                -1.559983e-01    1         1  ON     8
     ud_9                -1.458672e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.502936e-01    1         1  ON     0
     eO_1                -4.330916e-01    1         1  ON     1
     eO_2                -1.089686e-02    1         1  ON     2
     eO_3                 3.131291e-01    1         1  ON     3
     eO_4                 5.354736e-01    1         1  ON     4
     eO_5                 4.900319e-01    1         1  ON     5
     eO_6                 2.520544e-01    1         1  ON     6
     eO_7                -5.269935e-02    1         1  ON     7
     eO_8                -2.392831e-01    1         1  ON     8
     eO_9                -1.012782e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.692891e-01    1         1  ON     0
     eH1_1                -1.625909e-01    1         1  ON     1
     eH1_2                -1.192488e-01    1         1  ON     2
     eH1_3                -6.622487e-02    1         1  ON     3
     eH1_4                -6.804306e-03    1         1  ON     4
     eH1_5                 3.784775e-02    1         1  ON     5
     eH1_6                 1.097672e-01    1         1  ON     6
     eH1_7                 1.752039e-01    1         1  ON     7
     eH1_8                 2.046735e-01    1         1  ON     8
     eH1_9                 9.439494e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.667619e-01    1         1  ON     0
     eH2_1                -1.607083e-01    1         1  ON     1
     eH2_2                -1.169117e-01    1         1  ON     2
     eH2_3                -6.359674e-02    1         1  ON     3
     eH2_4                -3.728041e-03    1         1  ON     4
     eH2_5                 3.950978e-02    1         1  ON     5
     eH2_6                 1.105446e-01    1         1  ON     6
     eH2_7                 1.730995e-01    1         1  ON     7
     eH2_8                 2.092273e-01    1         1  ON     8
     eH2_9                 8.964165e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 509 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 4.427929e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 94 unique up determinants.
Found 94 unique down determinants.
Number of terms in pairs array: 24
Number of terms in pairs array: 24
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.2709e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8726
    reference variance = 0.233885
====================================================
  Execution time = 2.8831e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3547e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1267e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335421414839
                                         uncertainty =       0.004728496677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335421414839
                                         uncertainty =       0.004728496677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409552456
  error estimate for blocks of size 2^( 2) =       0.000421247840
  error estimate for blocks of size 2^( 3) =       0.000433375898
  error estimate for blocks of size 2^( 4) =       0.000444837040
  error estimate for blocks of size 2^( 5) =       0.000454803605
  error estimate for blocks of size 2^( 6) =       0.000463010277
  error estimate for blocks of size 2^( 7) =       0.000466203261

      target function =                  N/A
              le_mean =     -16.910637805130
             les_mean =     286.305137236756
             stat err =       0.000457213546
             autocorr =       1.246289993239
              std dev =       0.579194637564
             le_variance =       0.335466428183


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.691063780513e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910637805130       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910640926318       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910642858223       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910644136184       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910645167451       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910644577669       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910643869684       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910644618579       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910644602744       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910644663195       residual = 9.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 6.238602e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910637805130       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910638910784       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910639624290       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910640028556       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910640333140       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910640186021       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910639917189       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910640090141       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910640129612       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.766087e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910637805130       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910638113710       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910638324833       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910638432272       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910638515961       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910638482747       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910638406203       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910638442453       residual = 7.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 4.744618e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154652 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6117e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.103699e-01                 1 1 ON  0
uu_1  1.451564e-01                 1 1 ON  1
uu_2  4.695278e-02                 1 1 ON  2
uu_3  -1.682550e-02                1 1 ON  3
uu_4  -6.715880e-02                1 1 ON  4
uu_5  -1.044966e-01                1 1 ON  5
uu_6  -1.337419e-01                1 1 ON  6
uu_7  -1.485317e-01                1 1 ON  7
uu_8  -1.418736e-01                1 1 ON  8
uu_9  -1.134046e-01                1 1 ON  9
ud_0  4.378614e-01                 1 1 ON  10
ud_1  1.809368e-01                 1 1 ON  11
ud_2  6.691244e-02                 1 1 ON  12
ud_3  -2.409742e-03                1 1 ON  13
ud_4  -5.877958e-02                1 1 ON  14
ud_5  -1.017166e-01                1 1 ON  15
ud_6  -1.314417e-01                1 1 ON  16
ud_7  -1.518523e-01                1 1 ON  17
ud_8  -1.561750e-01                1 1 ON  18
ud_9  -1.459919e-01                1 1 ON  19
eO_0  -7.501820e-01                1 1 ON  20
eO_1  -4.329302e-01                1 1 ON  21
eO_2  -1.094075e-02                1 1 ON  22
eO_3  3.131013e-01                 1 1 ON  23
eO_4  5.355084e-01                 1 1 ON  24
eO_5  4.901197e-01                 1 1 ON  25
eO_6  2.521337e-01                 1 1 ON  26
eO_7  -5.278838e-02                1 1 ON  27
eO_8  -2.394392e-01                1 1 ON  28
eO_9  -1.014048e-01                1 1 ON  29
eH1_0 -2.694249e-01                1 1 ON  30
eH1_1 -1.627074e-01                1 1 ON  31
eH1_2 -1.192654e-01                1 1 ON  32
eH1_3 -6.625636e-02                1 1 ON  33
eH1_4 -6.824843e-03                1 1 ON  34
eH1_5 3.795173e-02                 1 1 ON  35
eH1_6 1.097420e-01                 1 1 ON  36
eH1_7 1.752050e-01                 1 1 ON  37
eH1_8 2.047565e-01                 1 1 ON  38
eH1_9 9.454208e-02                 1 1 ON  39
eH2_0 -2.668980e-01                1 1 ON  40
eH2_1 -1.606488e-01                1 1 ON  41
eH2_2 -1.170033e-01                1 1 ON  42
eH2_3 -6.371140e-02                1 1 ON  43
eH2_4 -3.803327e-03                1 1 ON  44
eH2_5 3.956754e-02                 1 1 ON  45
eH2_6 1.104983e-01                 1 1 ON  46
eH2_7 1.731786e-01                 1 1 ON  47
eH2_8 2.093078e-01                 1 1 ON  48
eH2_9 8.980009e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.89
    reference variance = 0.192341
====================================================
  Execution time = 2.7675e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.6453e-01
  Total weights = 2.0000e+06
  Execution time = 3.4781e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364776018017
                                         uncertainty =       0.026981363777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364776018017
                                         uncertainty =       0.026981363777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427008039
  error estimate for blocks of size 2^( 2) =       0.000438319850
  error estimate for blocks of size 2^( 3) =       0.000450409407
  error estimate for blocks of size 2^( 4) =       0.000461496765
  error estimate for blocks of size 2^( 5) =       0.000472222425
  error estimate for blocks of size 2^( 6) =       0.000479866734
  error estimate for blocks of size 2^( 7) =       0.000486434914

      target function =                  N/A
              le_mean =     -16.910402379914
             les_mean =     286.326380199211
             stat err =       0.000475005210
             autocorr =       1.237441402432
              std dev =       0.603880560172
             le_variance =       0.364671730953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364486939867
                                         uncertainty =       0.026946799922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364486939867
                                         uncertainty =       0.026946799922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426838788
  error estimate for blocks of size 2^( 2) =       0.000438149485
  error estimate for blocks of size 2^( 3) =       0.000450234154
  error estimate for blocks of size 2^( 4) =       0.000461316892
  error estimate for blocks of size 2^( 5) =       0.000472046928
  error estimate for blocks of size 2^( 6) =       0.000479705635
  error estimate for blocks of size 2^( 7) =       0.000486283163

      target function =                  N/A
              le_mean =     -16.910401342808
             les_mean =     286.326056093991
             stat err =       0.000474838154
             autocorr =       1.237552013536
              std dev =       0.603641202476
             le_variance =       0.364382701327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364502190697
                                         uncertainty =       0.026949433690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364502190697
                                         uncertainty =       0.026949433690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426847721
  error estimate for blocks of size 2^( 2) =       0.000438160536
  error estimate for blocks of size 2^( 3) =       0.000450248108
  error estimate for blocks of size 2^( 4) =       0.000461333107
  error estimate for blocks of size 2^( 5) =       0.000472062791
  error estimate for blocks of size 2^( 6) =       0.000479715374
  error estimate for blocks of size 2^( 7) =       0.000486290689

      target function =                  N/A
              le_mean =     -16.910401135679
             les_mean =     286.326064340839
             stat err =       0.000474850490
             autocorr =       1.237564513234
              std dev =       0.603653835803
             le_variance =       0.364397953480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364728169890
                                         uncertainty =       0.026975809351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364728169890
                                         uncertainty =       0.026975809351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426980031
  error estimate for blocks of size 2^( 2) =       0.000438292210
  error estimate for blocks of size 2^( 3) =       0.000450381640
  error estimate for blocks of size 2^( 4) =       0.000461468749
  error estimate for blocks of size 2^( 5) =       0.000472195096
  error estimate for blocks of size 2^( 6) =       0.000479840585
  error estimate for blocks of size 2^( 7) =       0.000486409889

      target function =                  N/A
              le_mean =     -16.910402093369
             les_mean =     286.326322669993
             stat err =       0.000474978580
             autocorr =       1.237464992237
              std dev =       0.603840949999
             le_variance =       0.364623892896


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910402379914        initial  <--
     2.5000e-01     2.5000e+00             6.2386e-04       -16.910401342808
     1.0000e+00     1.0000e+01             1.7661e-04       -16.910401135679
     4.0000e+00     4.0000e+01             4.7446e-05       -16.910402093369

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0612
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.104488e-01 1 1  ON 0
 uu_1                 1.451872e-01 1 1  ON 1
 uu_2                 4.686032e-02 1 1  ON 2
 uu_3                -1.690185e-02 1 1  ON 3
 uu_4                -6.719980e-02 1 1  ON 4
 uu_5                -1.045517e-01 1 1  ON 5
 uu_6                -1.337664e-01 1 1  ON 6
 uu_7                -1.484277e-01 1 1  ON 7
 uu_8                -1.417913e-01 1 1  ON 8
 uu_9                -1.133394e-01 1 1  ON 9
 ud_0                 4.377993e-01 1 1  ON 10
 ud_1                 1.807766e-01 1 1  ON 11
 ud_2                 6.676427e-02 1 1  ON 12
 ud_3                -2.468539e-03 1 1  ON 13
 ud_4                -5.879366e-02 1 1  ON 14
 ud_5                -1.017359e-01 1 1  ON 15
 ud_6                -1.314851e-01 1 1  ON 16
 ud_7                -1.518336e-01 1 1  ON 17
 ud_8                -1.559983e-01 1 1  ON 18
 ud_9                -1.458672e-01 1 1  ON 19
 eO_0                -7.502936e-01 1 1  ON 20
 eO_1                -4.330916e-01 1 1  ON 21
 eO_2                -1.089686e-02 1 1  ON 22
 eO_3                 3.131291e-01 1 1  ON 23
 eO_4                 5.354736e-01 1 1  ON 24
 eO_5                 4.900319e-01 1 1  ON 25
 eO_6                 2.520544e-01 1 1  ON 26
 eO_7                -5.269935e-02 1 1  ON 27
 eO_8                -2.392831e-01 1 1  ON 28
 eO_9                -1.012782e-01 1 1  ON 29
eH1_0                -2.692891e-01 1 1  ON 30
eH1_1                -1.625909e-01 1 1  ON 31
eH1_2                -1.192488e-01 1 1  ON 32
eH1_3                -6.622487e-02 1 1  ON 33
eH1_4                -6.804306e-03 1 1  ON 34
eH1_5                 3.784775e-02 1 1  ON 35
eH1_6                 1.097672e-01 1 1  ON 36
eH1_7                 1.752039e-01 1 1  ON 37
eH1_8                 2.046735e-01 1 1  ON 38
eH1_9                 9.439494e-02 1 1  ON 39
eH2_0                -2.667619e-01 1 1  ON 40
eH2_1                -1.607083e-01 1 1  ON 41
eH2_2                -1.169117e-01 1 1  ON 42
eH2_3                -6.359674e-02 1 1  ON 43
eH2_4                -3.728041e-03 1 1  ON 44
eH2_5                 3.950978e-02 1 1  ON 45
eH2_6                 1.105446e-01 1 1  ON 46
eH2_7                 1.730995e-01 1 1  ON 47
eH2_8                 2.092273e-01 1 1  ON 48
eH2_9                 8.964165e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1186e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6881e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9278
    reference variance = 0.239919
====================================================
  Execution time = 2.8001e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4283e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1600e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342858315862
                                         uncertainty =       0.006403635206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342858315862
                                         uncertainty =       0.006403635206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414020446
  error estimate for blocks of size 2^( 2) =       0.000425987384
  error estimate for blocks of size 2^( 3) =       0.000437910099
  error estimate for blocks of size 2^( 4) =       0.000449830509
  error estimate for blocks of size 2^( 5) =       0.000460208163
  error estimate for blocks of size 2^( 6) =       0.000467595819
  error estimate for blocks of size 2^( 7) =       0.000472875670

      target function =                  N/A
              le_mean =     -16.909829565691
             les_mean =     286.285161628161
             stat err =       0.000462627540
             autocorr =       1.248588667495
              std dev =       0.585513329366
             le_variance =       0.342825858865


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690982956569e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909829565691       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909829843934       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909829742217       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909829833020       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909829700836       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909829704897       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909829724654       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909829814176       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 9.936296e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909829565691       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909829638616       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909829611470       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909829635015       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909829597031       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909829598253       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909829603263       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909829623883       residual = 4.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.501113e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909829565691       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909829584145       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909829577243       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909829583186       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909829573369       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909829573688       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909829574945       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909829579934       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 6.264502e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157365 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5167e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.104403e-01 1 1  ON 0
 uu_1                 1.451839e-01 1 1  ON 1
 uu_2                 4.687455e-02 1 1  ON 2
 uu_3                -1.689029e-02 1 1  ON 3
 uu_4                -6.720839e-02 1 1  ON 4
 uu_5                -1.045609e-01 1 1  ON 5
 uu_6                -1.337565e-01 1 1  ON 6
 uu_7                -1.484292e-01 1 1  ON 7
 uu_8                -1.417985e-01 1 1  ON 8
 uu_9                -1.133480e-01 1 1  ON 9
 ud_0                 4.378072e-01 1 1  ON 10
 ud_1                 1.807929e-01 1 1  ON 11
 ud_2                 6.676724e-02 1 1  ON 12
 ud_3                -2.466574e-03 1 1  ON 13
 ud_4                -5.878996e-02 1 1  ON 14
 ud_5                -1.017426e-01 1 1  ON 15
 ud_6                -1.314801e-01 1 1  ON 16
 ud_7                -1.518300e-01 1 1  ON 17
 ud_8                -1.560038e-01 1 1  ON 18
 ud_9                -1.458808e-01 1 1  ON 19
 eO_0                -7.502786e-01 1 1  ON 20
 eO_1                -4.330869e-01 1 1  ON 21
 eO_2                -1.090535e-02 1 1  ON 22
 eO_3                 3.131277e-01 1 1  ON 23
 eO_4                 5.354825e-01 1 1  ON 24
 eO_5                 4.900396e-01 1 1  ON 25
 eO_6                 2.520595e-01 1 1  ON 26
 eO_7                -5.270158e-02 1 1  ON 27
 eO_8                -2.392933e-01 1 1  ON 28
 eO_9                -1.012939e-01 1 1  ON 29
eH1_0                -2.692952e-01 1 1  ON 30
eH1_1                -1.626036e-01 1 1  ON 31
eH1_2                -1.192506e-01 1 1  ON 32
eH1_3                -6.622994e-02 1 1  ON 33
eH1_4                -6.798409e-03 1 1  ON 34
eH1_5                 3.784297e-02 1 1  ON 35
eH1_6                 1.097592e-01 1 1  ON 36
eH1_7                 1.752096e-01 1 1  ON 37
eH1_8                 2.046850e-01 1 1  ON 38
eH1_9                 9.441007e-02 1 1  ON 39
eH2_0                -2.667719e-01 1 1  ON 40
eH2_1                -1.607075e-01 1 1  ON 41
eH2_2                -1.169205e-01 1 1  ON 42
eH2_3                -6.360986e-02 1 1  ON 43
eH2_4                -3.740130e-03 1 1  ON 44
eH2_5                 3.951431e-02 1 1  ON 45
eH2_6                 1.105412e-01 1 1  ON 46
eH2_7                 1.731001e-01 1 1  ON 47
eH2_8                 2.092413e-01 1 1  ON 48
eH2_9                 8.966666e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.929
    reference variance = 0.18612
====================================================
  Execution time = 2.7612e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3367e-01
  Total weights = 2.0000e+06
  Execution time = 3.4720e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333389214215
                                         uncertainty =       0.003755896425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333389214215
                                         uncertainty =       0.003755896425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408460495
  error estimate for blocks of size 2^( 2) =       0.000420270861
  error estimate for blocks of size 2^( 3) =       0.000432019894
  error estimate for blocks of size 2^( 4) =       0.000444385333
  error estimate for blocks of size 2^( 5) =       0.000454149610
  error estimate for blocks of size 2^( 6) =       0.000461407661
  error estimate for blocks of size 2^( 7) =       0.000464854298

      target function =                  N/A
              le_mean =     -16.910745450253
             les_mean =     286.306991468700
             stat err =       0.000456199225
             autocorr =       1.247409272362
              std dev =       0.577650372010
             le_variance =       0.333679952284

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333363693828
                                         uncertainty =       0.003755366720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333363693828
                                         uncertainty =       0.003755366720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408444844
  error estimate for blocks of size 2^( 2) =       0.000420254323
  error estimate for blocks of size 2^( 3) =       0.000432002344
  error estimate for blocks of size 2^( 4) =       0.000444368112
  error estimate for blocks of size 2^( 5) =       0.000454131047
  error estimate for blocks of size 2^( 6) =       0.000461390271
  error estimate for blocks of size 2^( 7) =       0.000464834058

      target function =                  N/A
              le_mean =     -16.910746539818
             les_mean =     286.307002748238
             stat err =       0.000456180872
             autocorr =       1.247404499348
              std dev =       0.577628237791
             le_variance =       0.333654381093

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333374023270
                                         uncertainty =       0.003755603097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333374023270
                                         uncertainty =       0.003755603097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408451180
  error estimate for blocks of size 2^( 2) =       0.000420261107
  error estimate for blocks of size 2^( 3) =       0.000432009639
  error estimate for blocks of size 2^( 4) =       0.000444375290
  error estimate for blocks of size 2^( 5) =       0.000454138830
  error estimate for blocks of size 2^( 6) =       0.000461397511
  error estimate for blocks of size 2^( 7) =       0.000464842580

      target function =                  N/A
              le_mean =     -16.910746023217
             les_mean =     286.306995628092
             stat err =       0.000456188552
             autocorr =       1.247407800033
              std dev =       0.577637198578
             le_variance =       0.333664733181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333387216737
                                         uncertainty =       0.003755858700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333387216737
                                         uncertainty =       0.003755858700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408459270
  error estimate for blocks of size 2^( 2) =       0.000420269581
  error estimate for blocks of size 2^( 3) =       0.000432018551
  error estimate for blocks of size 2^( 4) =       0.000444384019
  error estimate for blocks of size 2^( 5) =       0.000454148201
  error estimate for blocks of size 2^( 6) =       0.000461406333
  error estimate for blocks of size 2^( 7) =       0.000464852769

      target function =                  N/A
              le_mean =     -16.910745521901
             les_mean =     286.306991890844
             stat err =       0.000456197830
             autocorr =       1.247409123939
              std dev =       0.577648639910
             le_variance =       0.333677951189


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910745450253        initial
     2.5000e+00     2.5000e+01             9.9363e-05       -16.910746539818  <--
     1.0000e+01     1.0000e+02             2.5011e-05       -16.910746023217
     4.0000e+01     4.0000e+02             6.2645e-06       -16.910745521901

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 4.4991e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.104162e-01 1 1  ON 0
 uu_1                 1.451778e-01 1 1  ON 1
 uu_2                 4.691194e-02 1 1  ON 2
 uu_3                -1.685815e-02 1 1  ON 3
 uu_4                -6.723014e-02 1 1  ON 4
 uu_5                -1.045875e-01 1 1  ON 5
 uu_6                -1.337296e-01 1 1  ON 6
 uu_7                -1.484336e-01 1 1  ON 7
 uu_8                -1.418197e-01 1 1  ON 8
 uu_9                -1.133736e-01 1 1  ON 9
 ud_0                 4.378331e-01 1 1  ON 10
 ud_1                 1.808367e-01 1 1  ON 11
 ud_2                 6.677809e-02 1 1  ON 12
 ud_3                -2.459633e-03 1 1  ON 13
 ud_4                -5.878107e-02 1 1  ON 14
 ud_5                -1.017608e-01 1 1  ON 15
 ud_6                -1.314666e-01 1 1  ON 16
 ud_7                -1.518192e-01 1 1  ON 17
 ud_8                -1.560195e-01 1 1  ON 18
 ud_9                -1.459213e-01 1 1  ON 19
 eO_0                -7.502360e-01 1 1  ON 20
 eO_1                -4.330724e-01 1 1  ON 21
 eO_2                -1.092685e-02 1 1  ON 22
 eO_3                 3.131227e-01 1 1  ON 23
 eO_4                 5.355074e-01 1 1  ON 24
 eO_5                 4.900622e-01 1 1  ON 25
 eO_6                 2.520747e-01 1 1  ON 26
 eO_7                -5.270801e-02 1 1  ON 27
 eO_8                -2.393234e-01 1 1  ON 28
 eO_9                -1.013405e-01 1 1  ON 29
eH1_0                -2.693140e-01 1 1  ON 30
eH1_1                -1.626392e-01 1 1  ON 31
eH1_2                -1.192572e-01 1 1  ON 32
eH1_3                -6.624400e-02 1 1  ON 33
eH1_4                -6.781658e-03 1 1  ON 34
eH1_5                 3.782853e-02 1 1  ON 35
eH1_6                 1.097349e-01 1 1  ON 36
eH1_7                 1.752266e-01 1 1  ON 37
eH1_8                 2.047193e-01 1 1  ON 38
eH1_9                 9.445503e-02 1 1  ON 39
eH2_0                -2.668013e-01 1 1  ON 40
eH2_1                -1.607076e-01 1 1  ON 41
eH2_2                -1.169472e-01 1 1  ON 42
eH2_3                -6.364704e-02 1 1  ON 43
eH2_4                -3.775748e-03 1 1  ON 44
eH2_5                 3.952716e-02 1 1  ON 45
eH2_6                 1.105316e-01 1 1  ON 46
eH2_7                 1.731021e-01 1 1  ON 47
eH2_8                 2.092831e-01 1 1  ON 48
eH2_9                 8.974101e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0192e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9523
    reference variance = 0.276217
====================================================
  Execution time = 2.7965e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4001e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.0770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340148090276
                                         uncertainty =       0.011339660773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340148090276
                                         uncertainty =       0.011339660773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412319081
  error estimate for blocks of size 2^( 2) =       0.000423861605
  error estimate for blocks of size 2^( 3) =       0.000435846469
  error estimate for blocks of size 2^( 4) =       0.000446817523
  error estimate for blocks of size 2^( 5) =       0.000456670235
  error estimate for blocks of size 2^( 6) =       0.000463398167
  error estimate for blocks of size 2^( 7) =       0.000467749567

      target function =                  N/A
              le_mean =     -16.909963545688
             les_mean =     286.286880995928
             stat err =       0.000458658873
             autocorr =       1.237407467551
              std dev =       0.583107236660
             le_variance =       0.340014049446


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690996354569e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909963545688       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909964494086       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909964841893       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909963522741       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909964902995       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909965347341       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909964806869       residual = 9.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909964865281       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909965015837       residual = 9.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.644717e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909963545688       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909963825037       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909963823837       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909963401582       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909963840376       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909963947708       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909963786467       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909963827262       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909963840049       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.003774e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909963545688       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909963618781       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909963608596       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909963495107       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909963610366       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909963639678       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909963599383       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909963608241       residual = 7.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.694824e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160371 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5049e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.104060e-01 1 1  ON 0
 uu_1                 1.451952e-01 1 1  ON 1
 uu_2                 4.697537e-02 1 1  ON 2
 uu_3                -1.679077e-02 1 1  ON 3
 uu_4                -6.726449e-02 1 1  ON 4
 uu_5                -1.045972e-01 1 1  ON 5
 uu_6                -1.336949e-01 1 1  ON 6
 uu_7                -1.484282e-01 1 1  ON 7
 uu_8                -1.418901e-01 1 1  ON 8
 uu_9                -1.134526e-01 1 1  ON 9
 ud_0                 4.379087e-01 1 1  ON 10
 ud_1                 1.809371e-01 1 1  ON 11
 ud_2                 6.679295e-02 1 1  ON 12
 ud_3                -2.436992e-03 1 1  ON 13
 ud_4                -5.874623e-02 1 1  ON 14
 ud_5                -1.017794e-01 1 1  ON 15
 ud_6                -1.314226e-01 1 1  ON 16
 ud_7                -1.518661e-01 1 1  ON 17
 ud_8                -1.561169e-01 1 1  ON 18
 ud_9                -1.460022e-01 1 1  ON 19
 eO_0                -7.501439e-01 1 1  ON 20
 eO_1                -4.330535e-01 1 1  ON 21
 eO_2                -1.092582e-02 1 1  ON 22
 eO_3                 3.131065e-01 1 1  ON 23
 eO_4                 5.355486e-01 1 1  ON 24
 eO_5                 4.900873e-01 1 1  ON 25
 eO_6                 2.521006e-01 1 1  ON 26
 eO_7                -5.274953e-02 1 1  ON 27
 eO_8                -2.394071e-01 1 1  ON 28
 eO_9                -1.013947e-01 1 1  ON 29
eH1_0                -2.693353e-01 1 1  ON 30
eH1_1                -1.626773e-01 1 1  ON 31
eH1_2                -1.192873e-01 1 1  ON 32
eH1_3                -6.624406e-02 1 1  ON 33
eH1_4                -6.751041e-03 1 1  ON 34
eH1_5                 3.781334e-02 1 1  ON 35
eH1_6                 1.097053e-01 1 1  ON 36
eH1_7                 1.752263e-01 1 1  ON 37
eH1_8                 2.047698e-01 1 1  ON 38
eH1_9                 9.451027e-02 1 1  ON 39
eH2_0                -2.668342e-01 1 1  ON 40
eH2_1                -1.606991e-01 1 1  ON 41
eH2_2                -1.169964e-01 1 1  ON 42
eH2_3                -6.368212e-02 1 1  ON 43
eH2_4                -3.833173e-03 1 1  ON 44
eH2_5                 3.954581e-02 1 1  ON 45
eH2_6                 1.105236e-01 1 1  ON 46
eH2_7                 1.731270e-01 1 1  ON 47
eH2_8                 2.093297e-01 1 1  ON 48
eH2_9                 8.981362e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9792
    reference variance = 0.271291
====================================================
  Execution time = 2.7528e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3920e-01
  Total weights = 2.0000e+06
  Execution time = 3.4861e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339273722975
                                         uncertainty =       0.004915320953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339273722975
                                         uncertainty =       0.004915320953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411823041
  error estimate for blocks of size 2^( 2) =       0.000423123556
  error estimate for blocks of size 2^( 3) =       0.000434922871
  error estimate for blocks of size 2^( 4) =       0.000446100471
  error estimate for blocks of size 2^( 5) =       0.000456734108
  error estimate for blocks of size 2^( 6) =       0.000464548264
  error estimate for blocks of size 2^( 7) =       0.000467581111

      target function =                  N/A
              le_mean =     -16.911012369046
             les_mean =     286.321535610429
             stat err =       0.000458740989
             autocorr =       1.240834358306
              std dev =       0.582405729697
             le_variance =       0.339196433984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339296963197
                                         uncertainty =       0.004916716010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339296963197
                                         uncertainty =       0.004916716010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411837166
  error estimate for blocks of size 2^( 2) =       0.000423127667
  error estimate for blocks of size 2^( 3) =       0.000434917645
  error estimate for blocks of size 2^( 4) =       0.000446091909
  error estimate for blocks of size 2^( 5) =       0.000456726269
  error estimate for blocks of size 2^( 6) =       0.000464548272
  error estimate for blocks of size 2^( 7) =       0.000467587745

      target function =                  N/A
              le_mean =     -16.911012865964
             les_mean =     286.321575686046
             stat err =       0.000458738549
             autocorr =       1.240736043709
              std dev =       0.582425705880
             le_variance =       0.339219702870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339280766862
                                         uncertainty =       0.004916055982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339280766862
                                         uncertainty =       0.004916055982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411827321
  error estimate for blocks of size 2^( 2) =       0.000423121762
  error estimate for blocks of size 2^( 3) =       0.000434915641
  error estimate for blocks of size 2^( 4) =       0.000446091476
  error estimate for blocks of size 2^( 5) =       0.000456725558
  error estimate for blocks of size 2^( 6) =       0.000464545253
  error estimate for blocks of size 2^( 7) =       0.000467582668

      target function =                  N/A
              le_mean =     -16.911012753473
             les_mean =     286.321555663079
             stat err =       0.000458736239
             autocorr =       1.240782870412
              std dev =       0.582411782646
             le_variance =       0.339203484565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339273888682
                                         uncertainty =       0.004915419772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339273888682
                                         uncertainty =       0.004915419772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411823141
  error estimate for blocks of size 2^( 2) =       0.000423122836
  error estimate for blocks of size 2^( 3) =       0.000434921444
  error estimate for blocks of size 2^( 4) =       0.000446098844
  error estimate for blocks of size 2^( 5) =       0.000456732527
  error estimate for blocks of size 2^( 6) =       0.000464547443
  error estimate for blocks of size 2^( 7) =       0.000467580881

      target function =                  N/A
              le_mean =     -16.911012396689
             les_mean =     286.321536710927
             stat err =       0.000458739924
             autocorr =       1.240827992737
              std dev =       0.582405871849
             le_variance =       0.339196599564


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911012369046        initial
     6.2500e-01     6.2500e+00             3.6447e-04       -16.911012865964  <--
     2.5000e+00     2.5000e+01             1.0038e-04       -16.911012753473
     1.0000e+01     1.0000e+02             2.6948e-05       -16.911012396689

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 4.4919e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.103928e-01 1 1  ON 0
 uu_1                 1.452595e-01 1 1  ON 1
 uu_2                 4.712875e-02 1 1  ON 2
 uu_3                -1.664303e-02 1 1  ON 3
 uu_4                -6.731313e-02 1 1  ON 4
 uu_5                -1.046249e-01 1 1  ON 5
 uu_6                -1.336159e-01 1 1  ON 6
 uu_7                -1.483998e-01 1 1  ON 7
 uu_8                -1.420831e-01 1 1  ON 8
 uu_9                -1.136846e-01 1 1  ON 9
 ud_0                 4.381215e-01 1 1  ON 10
 ud_1                 1.811584e-01 1 1  ON 11
 ud_2                 6.687589e-02 1 1  ON 12
 ud_3                -2.355195e-03 1 1  ON 13
 ud_4                -5.865742e-02 1 1  ON 14
 ud_5                -1.017996e-01 1 1  ON 15
 ud_6                -1.313345e-01 1 1  ON 16
 ud_7                -1.519699e-01 1 1  ON 17
 ud_8                -1.563839e-01 1 1  ON 18
 ud_9                -1.462417e-01 1 1  ON 19
 eO_0                -7.499146e-01 1 1  ON 20
 eO_1                -4.329728e-01 1 1  ON 21
 eO_2                -1.089808e-02 1 1  ON 22
 eO_3                 3.130626e-01 1 1  ON 23
 eO_4                 5.356517e-01 1 1  ON 24
 eO_5                 4.901544e-01 1 1  ON 25
 eO_6                 2.521798e-01 1 1  ON 26
 eO_7                -5.286362e-02 1 1  ON 27
 eO_8                -2.396515e-01 1 1  ON 28
 eO_9                -1.015540e-01 1 1  ON 29
eH1_0                -2.694081e-01 1 1  ON 30
eH1_1                -1.627722e-01 1 1  ON 31
eH1_2                -1.193673e-01 1 1  ON 32
eH1_3                -6.624511e-02 1 1  ON 33
eH1_4                -6.676082e-03 1 1  ON 34
eH1_5                 3.777450e-02 1 1  ON 35
eH1_6                 1.096180e-01 1 1  ON 36
eH1_7                 1.752236e-01 1 1  ON 37
eH1_8                 2.049165e-01 1 1  ON 38
eH1_9                 9.467099e-02 1 1  ON 39
eH2_0                -2.669330e-01 1 1  ON 40
eH2_1                -1.607106e-01 1 1  ON 41
eH2_2                -1.171268e-01 1 1  ON 42
eH2_3                -6.377660e-02 1 1  ON 43
eH2_4                -3.985971e-03 1 1  ON 44
eH2_5                 3.959213e-02 1 1  ON 45
eH2_6                 1.105045e-01 1 1  ON 46
eH2_7                 1.732046e-01 1 1  ON 47
eH2_8                 2.094684e-01 1 1  ON 48
eH2_9                 9.002552e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9976e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9965
    reference variance = 0.540615
====================================================
  Execution time = 2.8064e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3916e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2461e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338953801760
                                         uncertainty =       0.004587023587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338953801760
                                         uncertainty =       0.004587023587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411801773
  error estimate for blocks of size 2^( 2) =       0.000424065132
  error estimate for blocks of size 2^( 3) =       0.000436576877
  error estimate for blocks of size 2^( 4) =       0.000447996002
  error estimate for blocks of size 2^( 5) =       0.000458631013
  error estimate for blocks of size 2^( 6) =       0.000467780145
  error estimate for blocks of size 2^( 7) =       0.000473996889

      target function =                  N/A
              le_mean =     -16.910132330416
             les_mean =     286.291736662455
             stat err =       0.000462101012
             autocorr =       1.259207833047
              std dev =       0.582375651827
             le_variance =       0.339161399840


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691013233042e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910132330416       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910131898279       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910133133386       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910134547965       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910134728265       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910135434240       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910135928987       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910136091634       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910136379832       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910136333446       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910136209984       residual = 6.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.092280e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910132330416       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910132150645       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910132780477       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910133120478       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910133348737       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910133548455       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910133467918       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910133514648       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910133564137       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.749330e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910132330416       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910132276528       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910132492318       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910132554772       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910132632033       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910132675513       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910132646198       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910132640040       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 6.949795e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164351 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5318e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.104434e-01 1 1  ON 0
 uu_1                 1.453219e-01 1 1  ON 1
 uu_2                 4.732956e-02 1 1  ON 2
 uu_3                -1.656952e-02 1 1  ON 3
 uu_4                -6.726297e-02 1 1  ON 4
 uu_5                -1.047779e-01 1 1  ON 5
 uu_6                -1.334404e-01 1 1  ON 6
 uu_7                -1.485484e-01 1 1  ON 7
 uu_8                -1.423476e-01 1 1  ON 8
 uu_9                -1.138933e-01 1 1  ON 9
 ud_0                 4.381617e-01 1 1  ON 10
 ud_1                 1.811935e-01 1 1  ON 11
 ud_2                 6.695794e-02 1 1  ON 12
 ud_3                -2.397760e-03 1 1  ON 13
 ud_4                -5.864922e-02 1 1  ON 14
 ud_5                -1.016898e-01 1 1  ON 15
 ud_6                -1.314522e-01 1 1  ON 16
 ud_7                -1.519704e-01 1 1  ON 17
 ud_8                -1.563111e-01 1 1  ON 18
 ud_9                -1.463368e-01 1 1  ON 19
 eO_0                -7.497873e-01 1 1  ON 20
 eO_1                -4.328808e-01 1 1  ON 21
 eO_2                -1.097116e-02 1 1  ON 22
 eO_3                 3.131513e-01 1 1  ON 23
 eO_4                 5.356271e-01 1 1  ON 24
 eO_5                 4.903599e-01 1 1  ON 25
 eO_6                 2.523338e-01 1 1  ON 26
 eO_7                -5.294386e-02 1 1  ON 27
 eO_8                -2.398926e-01 1 1  ON 28
 eO_9                -1.017751e-01 1 1  ON 29
eH1_0                -2.696299e-01 1 1  ON 30
eH1_1                -1.628966e-01 1 1  ON 31
eH1_2                -1.194689e-01 1 1  ON 32
eH1_3                -6.636122e-02 1 1  ON 33
eH1_4                -6.668226e-03 1 1  ON 34
eH1_5                 3.781274e-02 1 1  ON 35
eH1_6                 1.095675e-01 1 1  ON 36
eH1_7                 1.752733e-01 1 1  ON 37
eH1_8                 2.051188e-01 1 1  ON 38
eH1_9                 9.494592e-02 1 1  ON 39
eH2_0                -2.671217e-01 1 1  ON 40
eH2_1                -1.607547e-01 1 1  ON 41
eH2_2                -1.171682e-01 1 1  ON 42
eH2_3                -6.391396e-02 1 1  ON 43
eH2_4                -3.992797e-03 1 1  ON 44
eH2_5                 3.949480e-02 1 1  ON 45
eH2_6                 1.104417e-01 1 1  ON 46
eH2_7                 1.733630e-01 1 1  ON 47
eH2_8                 2.096609e-01 1 1  ON 48
eH2_9                 9.023198e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9338
    reference variance = 0.227431
====================================================
  Execution time = 2.9606e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4990e-01
  Total weights = 2.0000e+06
  Execution time = 3.4897e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350145818952
                                         uncertainty =       0.010641482324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350145818952
                                         uncertainty =       0.010641482324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418311720
  error estimate for blocks of size 2^( 2) =       0.000429696916
  error estimate for blocks of size 2^( 3) =       0.000441395187
  error estimate for blocks of size 2^( 4) =       0.000453282775
  error estimate for blocks of size 2^( 5) =       0.000462415255
  error estimate for blocks of size 2^( 6) =       0.000469441253
  error estimate for blocks of size 2^( 7) =       0.000475721813

      target function =                  N/A
              le_mean =     -16.910456601256
             les_mean =     286.313511677516
             stat err =       0.000465215274
             autocorr =       1.236823892838
              std dev =       0.591582107188
             le_variance =       0.349969389545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350042130817
                                         uncertainty =       0.010639707977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350042130817
                                         uncertainty =       0.010639707977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418249790
  error estimate for blocks of size 2^( 2) =       0.000429633016
  error estimate for blocks of size 2^( 3) =       0.000441328788
  error estimate for blocks of size 2^( 4) =       0.000453217179
  error estimate for blocks of size 2^( 5) =       0.000462355086
  error estimate for blocks of size 2^( 6) =       0.000469396603
  error estimate for blocks of size 2^( 7) =       0.000475667484

      target function =                  N/A
              le_mean =     -16.910455884469
             les_mean =     286.313383819044
             stat err =       0.000465159088
             autocorr =       1.236891365514
              std dev =       0.591494525263
             le_variance =       0.349865773416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350000436170
                                         uncertainty =       0.010638908361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350000436170
                                         uncertainty =       0.010638908361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418224882
  error estimate for blocks of size 2^( 2) =       0.000429611017
  error estimate for blocks of size 2^( 3) =       0.000441310166
  error estimate for blocks of size 2^( 4) =       0.000453201161
  error estimate for blocks of size 2^( 5) =       0.000462340516
  error estimate for blocks of size 2^( 6) =       0.000469380400
  error estimate for blocks of size 2^( 7) =       0.000475652649

      target function =                  N/A
              le_mean =     -16.910455753422
             les_mean =     286.313337718057
             stat err =       0.000465143681
             autocorr =       1.236956754220
              std dev =       0.591459300815
             le_variance =       0.349824104521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350117563302
                                         uncertainty =       0.010640945447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350117563302
                                         uncertainty =       0.010640945447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418294845
  error estimate for blocks of size 2^( 2) =       0.000429680384
  error estimate for blocks of size 2^( 3) =       0.000441379026
  error estimate for blocks of size 2^( 4) =       0.000453267253
  error estimate for blocks of size 2^( 5) =       0.000462401061
  error estimate for blocks of size 2^( 6) =       0.000469429353
  error estimate for blocks of size 2^( 7) =       0.000475708651

      target function =                  N/A
              le_mean =     -16.910456339251
             les_mean =     286.313474581758
             stat err =       0.000465201579
             autocorr =       1.236850860576
              std dev =       0.591558243133
             le_variance =       0.349941155019


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910456601256        initial  <--
     1.5625e-01     1.5625e+00             1.0923e-03       -16.910455884469
     6.2500e-01     6.2500e+00             2.7493e-04       -16.910455753422
     2.5000e+00     2.5000e+01             6.9498e-05       -16.910456339251

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.0832
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.103928e-01 1 1  ON 0
 uu_1                 1.452595e-01 1 1  ON 1
 uu_2                 4.712875e-02 1 1  ON 2
 uu_3                -1.664303e-02 1 1  ON 3
 uu_4                -6.731313e-02 1 1  ON 4
 uu_5                -1.046249e-01 1 1  ON 5
 uu_6                -1.336159e-01 1 1  ON 6
 uu_7                -1.483998e-01 1 1  ON 7
 uu_8                -1.420831e-01 1 1  ON 8
 uu_9                -1.136846e-01 1 1  ON 9
 ud_0                 4.381215e-01 1 1  ON 10
 ud_1                 1.811584e-01 1 1  ON 11
 ud_2                 6.687589e-02 1 1  ON 12
 ud_3                -2.355195e-03 1 1  ON 13
 ud_4                -5.865742e-02 1 1  ON 14
 ud_5                -1.017996e-01 1 1  ON 15
 ud_6                -1.313345e-01 1 1  ON 16
 ud_7                -1.519699e-01 1 1  ON 17
 ud_8                -1.563839e-01 1 1  ON 18
 ud_9                -1.462417e-01 1 1  ON 19
 eO_0                -7.499146e-01 1 1  ON 20
 eO_1                -4.329728e-01 1 1  ON 21
 eO_2                -1.089808e-02 1 1  ON 22
 eO_3                 3.130626e-01 1 1  ON 23
 eO_4                 5.356517e-01 1 1  ON 24
 eO_5                 4.901544e-01 1 1  ON 25
 eO_6                 2.521798e-01 1 1  ON 26
 eO_7                -5.286362e-02 1 1  ON 27
 eO_8                -2.396515e-01 1 1  ON 28
 eO_9                -1.015540e-01 1 1  ON 29
eH1_0                -2.694081e-01 1 1  ON 30
eH1_1                -1.627722e-01 1 1  ON 31
eH1_2                -1.193673e-01 1 1  ON 32
eH1_3                -6.624511e-02 1 1  ON 33
eH1_4                -6.676082e-03 1 1  ON 34
eH1_5                 3.777450e-02 1 1  ON 35
eH1_6                 1.096180e-01 1 1  ON 36
eH1_7                 1.752236e-01 1 1  ON 37
eH1_8                 2.049165e-01 1 1  ON 38
eH1_9                 9.467099e-02 1 1  ON 39
eH2_0                -2.669330e-01 1 1  ON 40
eH2_1                -1.607106e-01 1 1  ON 41
eH2_2                -1.171268e-01 1 1  ON 42
eH2_3                -6.377660e-02 1 1  ON 43
eH2_4                -3.985971e-03 1 1  ON 44
eH2_5                 3.959213e-02 1 1  ON 45
eH2_6                 1.105045e-01 1 1  ON 46
eH2_7                 1.732046e-01 1 1  ON 47
eH2_8                 2.094684e-01 1 1  ON 48
eH2_9                 9.002552e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2409e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6935e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9382
    reference variance = 0.257461
====================================================
  Execution time = 2.8104e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3187e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1889e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331983834285
                                         uncertainty =       0.003309704229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331983834285
                                         uncertainty =       0.003309704229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407349542
  error estimate for blocks of size 2^( 2) =       0.000418902554
  error estimate for blocks of size 2^( 3) =       0.000430855909
  error estimate for blocks of size 2^( 4) =       0.000442330375
  error estimate for blocks of size 2^( 5) =       0.000451341359
  error estimate for blocks of size 2^( 6) =       0.000459612217
  error estimate for blocks of size 2^( 7) =       0.000466240819

      target function =                  N/A
              le_mean =     -16.910782583238
             les_mean =     286.306434710429
             stat err =       0.000454881192
             autocorr =       1.246985768149
              std dev =       0.576079247001
             le_variance =       0.331867298825


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691078258324e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910782583238       residual = 8.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910782873779       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910782723978       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910782783789       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910782661583       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910782549133       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910782641938       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910782632816       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.472678e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910782583238       residual = 8.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910782662094       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910782623586       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910782642457       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910782614733       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910782582774       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910782600738       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910782594123       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.770130e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910782583238       residual = 8.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910782603383       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910782593732       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910782598731       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910782591985       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910782583854       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910782587920       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910782585935       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 9.484475e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167058 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5299e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714436e-02 1 1  ON 2
 uu_3                -1.665162e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688544e-02 1 1  ON 12
 ud_3                -2.369275e-03 1 1  ON 13
 ud_4                -5.865175e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089673e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286831e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015700e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193840e-01 1 1  ON 32
eH1_3                -6.625760e-02 1 1  ON 33
eH1_4                -6.679755e-03 1 1  ON 34
eH1_5                 3.776924e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752242e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470399e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377687e-02 1 1  ON 43
eH2_4                -4.015074e-03 1 1  ON 44
eH2_5                 3.958436e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005581e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9668
    reference variance = 0.474211
====================================================
  Execution time = 2.7487e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3806e-01
  Total weights = 2.0000e+06
  Execution time = 3.4820e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338147572186
                                         uncertainty =       0.003818607714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338147572186
                                         uncertainty =       0.003818607714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411133117
  error estimate for blocks of size 2^( 2) =       0.000422598764
  error estimate for blocks of size 2^( 3) =       0.000434343479
  error estimate for blocks of size 2^( 4) =       0.000445003227
  error estimate for blocks of size 2^( 5) =       0.000455531906
  error estimate for blocks of size 2^( 6) =       0.000461796455
  error estimate for blocks of size 2^( 7) =       0.000464578417

      target function =                  N/A
              le_mean =     -16.910494158835
             les_mean =     286.302873407456
             stat err =       0.000456727502
             autocorr =       1.234097304220
              std dev =       0.581430030623
             le_variance =       0.338060880510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338142203615
                                         uncertainty =       0.003818575994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338142203615
                                         uncertainty =       0.003818575994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411129861
  error estimate for blocks of size 2^( 2) =       0.000422595056
  error estimate for blocks of size 2^( 3) =       0.000434339344
  error estimate for blocks of size 2^( 4) =       0.000444999371
  error estimate for blocks of size 2^( 5) =       0.000455527306
  error estimate for blocks of size 2^( 6) =       0.000461790761
  error estimate for blocks of size 2^( 7) =       0.000464573574

      target function =                  N/A
              le_mean =     -16.910494139121
             les_mean =     286.302867385754
             stat err =       0.000456722753
             autocorr =       1.234091191899
              std dev =       0.581425425603
             le_variance =       0.338055525538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338144039221
                                         uncertainty =       0.003818586373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338144039221
                                         uncertainty =       0.003818586373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411130974
  error estimate for blocks of size 2^( 2) =       0.000422596385
  error estimate for blocks of size 2^( 3) =       0.000434340850
  error estimate for blocks of size 2^( 4) =       0.000445000746
  error estimate for blocks of size 2^( 5) =       0.000455528964
  error estimate for blocks of size 2^( 6) =       0.000461792838
  error estimate for blocks of size 2^( 7) =       0.000464575541

      target function =                  N/A
              le_mean =     -16.910494159291
             les_mean =     286.302869897509
             stat err =       0.000456724522
             autocorr =       1.234094073535
              std dev =       0.581426998952
             le_variance =       0.338057355110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338147057541
                                         uncertainty =       0.003818604630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338147057541
                                         uncertainty =       0.003818604630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411132805
  error estimate for blocks of size 2^( 2) =       0.000422598423
  error estimate for blocks of size 2^( 3) =       0.000434343105
  error estimate for blocks of size 2^( 4) =       0.000445002873
  error estimate for blocks of size 2^( 5) =       0.000455531490
  error estimate for blocks of size 2^( 6) =       0.000461795950
  error estimate for blocks of size 2^( 7) =       0.000464578018

      target function =                  N/A
              le_mean =     -16.910494157986
             les_mean =     286.302872865078
             stat err =       0.000456727083
             autocorr =       1.234096916880
              std dev =       0.581429588891
             le_variance =       0.338060366838


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910494158835        initial
     1.5625e+00     1.5625e+01             1.4727e-04       -16.910494139121
     6.2500e+00     6.2500e+01             3.7701e-05       -16.910494159291  <--
     2.5000e+01     2.5000e+02             9.4845e-06       -16.910494157986

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 4.4883e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714436e-02 1 1  ON 2
 uu_3                -1.665162e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688544e-02 1 1  ON 12
 ud_3                -2.369275e-03 1 1  ON 13
 ud_4                -5.865175e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089673e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286831e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015700e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193840e-01 1 1  ON 32
eH1_3                -6.625760e-02 1 1  ON 33
eH1_4                -6.679755e-03 1 1  ON 34
eH1_5                 3.776924e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752242e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470399e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377687e-02 1 1  ON 43
eH2_4                -4.015074e-03 1 1  ON 44
eH2_5                 3.958436e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005581e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0218e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6939e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8983
    reference variance = 0.279196
====================================================
  Execution time = 2.8088e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.6505e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1577e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365207913750
                                         uncertainty =       0.011079373009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365207913750
                                         uncertainty =       0.011079373009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427226902
  error estimate for blocks of size 2^( 2) =       0.000438633094
  error estimate for blocks of size 2^( 3) =       0.000450901515
  error estimate for blocks of size 2^( 4) =       0.000463253471
  error estimate for blocks of size 2^( 5) =       0.000473200260
  error estimate for blocks of size 2^( 6) =       0.000480515523
  error estimate for blocks of size 2^( 7) =       0.000488200312

      target function =                  N/A
              le_mean =     -16.909717048561
             les_mean =     286.303576130985
             stat err =       0.000476292391
             autocorr =       1.242882589666
              std dev =       0.604190078629
             le_variance =       0.365045651114


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690971704856e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909717048561       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909717020629       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909717075764       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909716702439       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909717028021       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909717092661       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909717104630       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909717127219       residual = 8.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.295060e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909717048561       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909717041015       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909717045189       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909716949137       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909717041535       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909717052006       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909717050401       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909717063786       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.264382e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909717048561       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909717046636       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909717046868       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909717022741       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909717046597       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909717048935       residual = 8.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909717048099       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909717051964       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 8.174594e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169924 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5252e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.103661e-01 1 1  ON 0
 uu_1                 1.452649e-01 1 1  ON 1
 uu_2                 4.716137e-02 1 1  ON 2
 uu_3                -1.664763e-02 1 1  ON 3
 uu_4                -6.731181e-02 1 1  ON 4
 uu_5                -1.046420e-01 1 1  ON 5
 uu_6                -1.336219e-01 1 1  ON 6
 uu_7                -1.484107e-01 1 1  ON 7
 uu_8                -1.420831e-01 1 1  ON 8
 uu_9                -1.136880e-01 1 1  ON 9
 ud_0                 4.381343e-01 1 1  ON 10
 ud_1                 1.811648e-01 1 1  ON 11
 ud_2                 6.689592e-02 1 1  ON 12
 ud_3                -2.378795e-03 1 1  ON 13
 ud_4                -5.865163e-02 1 1  ON 14
 ud_5                -1.017908e-01 1 1  ON 15
 ud_6                -1.313704e-01 1 1  ON 16
 ud_7                -1.519522e-01 1 1  ON 17
 ud_8                -1.563785e-01 1 1  ON 18
 ud_9                -1.462374e-01 1 1  ON 19
 eO_0                -7.498829e-01 1 1  ON 20
 eO_1                -4.329509e-01 1 1  ON 21
 eO_2                -1.090981e-02 1 1  ON 22
 eO_3                 3.130736e-01 1 1  ON 23
 eO_4                 5.356642e-01 1 1  ON 24
 eO_5                 4.901666e-01 1 1  ON 25
 eO_6                 2.521972e-01 1 1  ON 26
 eO_7                -5.288793e-02 1 1  ON 27
 eO_8                -2.396855e-01 1 1  ON 28
 eO_9                -1.015844e-01 1 1  ON 29
eH1_0                -2.694221e-01 1 1  ON 30
eH1_1                -1.628106e-01 1 1  ON 31
eH1_2                -1.194123e-01 1 1  ON 32
eH1_3                -6.626217e-02 1 1  ON 33
eH1_4                -6.672624e-03 1 1  ON 34
eH1_5                 3.777316e-02 1 1  ON 35
eH1_6                 1.096042e-01 1 1  ON 36
eH1_7                 1.752251e-01 1 1  ON 37
eH1_8                 2.049700e-01 1 1  ON 38
eH1_9                 9.473477e-02 1 1  ON 39
eH2_0                -2.669893e-01 1 1  ON 40
eH2_1                -1.607150e-01 1 1  ON 41
eH2_2                -1.171497e-01 1 1  ON 42
eH2_3                -6.377975e-02 1 1  ON 43
eH2_4                -4.007786e-03 1 1  ON 44
eH2_5                 3.957219e-02 1 1  ON 45
eH2_6                 1.104893e-01 1 1  ON 46
eH2_7                 1.732336e-01 1 1  ON 47
eH2_8                 2.095095e-01 1 1  ON 48
eH2_9                 9.008846e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9515
    reference variance = 0.374576
====================================================
  Execution time = 2.7517e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3930e-01
  Total weights = 2.0000e+06
  Execution time = 3.4757e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339368978514
                                         uncertainty =       0.009329585443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339368978514
                                         uncertainty =       0.009329585443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411892541
  error estimate for blocks of size 2^( 2) =       0.000423559827
  error estimate for blocks of size 2^( 3) =       0.000435089547
  error estimate for blocks of size 2^( 4) =       0.000445794259
  error estimate for blocks of size 2^( 5) =       0.000454289071
  error estimate for blocks of size 2^( 6) =       0.000461775347
  error estimate for blocks of size 2^( 7) =       0.000467682217

      target function =                  N/A
              le_mean =     -16.909913333325
             les_mean =     286.284479701626
             stat err =       0.000457385224
             autocorr =       1.233094627235
              std dev =       0.582504017765
             le_variance =       0.339310930712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339332006892
                                         uncertainty =       0.009324137665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339332006892
                                         uncertainty =       0.009324137665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411870113
  error estimate for blocks of size 2^( 2) =       0.000423536897
  error estimate for blocks of size 2^( 3) =       0.000435064983
  error estimate for blocks of size 2^( 4) =       0.000445768792
  error estimate for blocks of size 2^( 5) =       0.000454263233
  error estimate for blocks of size 2^( 6) =       0.000461749996
  error estimate for blocks of size 2^( 7) =       0.000467658967

      target function =                  N/A
              le_mean =     -16.909913295492
             les_mean =     286.284441471008
             stat err =       0.000457360247
             autocorr =       1.233094242142
              std dev =       0.582472299414
             le_variance =       0.339273979584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339346189030
                                         uncertainty =       0.009326445716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339346189030
                                         uncertainty =       0.009326445716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411878715
  error estimate for blocks of size 2^( 2) =       0.000423545781
  error estimate for blocks of size 2^( 3) =       0.000435074645
  error estimate for blocks of size 2^( 4) =       0.000445778893
  error estimate for blocks of size 2^( 5) =       0.000454273546
  error estimate for blocks of size 2^( 6) =       0.000461760083
  error estimate for blocks of size 2^( 7) =       0.000467668176

      target function =                  N/A
              le_mean =     -16.909913275524
             les_mean =     286.284454968185
             stat err =       0.000457370174
             autocorr =       1.233096264646
              std dev =       0.582484465108
             le_variance =       0.339288152092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339365931211
                                         uncertainty =       0.009329177760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339365931211
                                         uncertainty =       0.009329177760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411890692
  error estimate for blocks of size 2^( 2) =       0.000423557953
  error estimate for blocks of size 2^( 3) =       0.000435087565
  error estimate for blocks of size 2^( 4) =       0.000445792218
  error estimate for blocks of size 2^( 5) =       0.000454287012
  error estimate for blocks of size 2^( 6) =       0.000461773321
  error estimate for blocks of size 2^( 7) =       0.000467680351

      target function =                  N/A
              le_mean =     -16.909913323184
             les_mean =     286.284476312725
             stat err =       0.000457383225
             autocorr =       1.233094922583
              std dev =       0.582501403256
             le_variance =       0.339307884795


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909913333325        initial  <--
     1.5625e+00     1.5625e+01             1.2951e-04       -16.909913295492
     6.2500e+00     6.2500e+01             3.2644e-05       -16.909913275524
     2.5000e+01     2.5000e+02             8.1746e-06       -16.909913323184

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.8911
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714436e-02 1 1  ON 2
 uu_3                -1.665162e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688544e-02 1 1  ON 12
 ud_3                -2.369275e-03 1 1  ON 13
 ud_4                -5.865175e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089673e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286831e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015700e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193840e-01 1 1  ON 32
eH1_3                -6.625760e-02 1 1  ON 33
eH1_4                -6.679755e-03 1 1  ON 34
eH1_5                 3.776924e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752242e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470399e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377687e-02 1 1  ON 43
eH2_4                -4.015074e-03 1 1  ON 44
eH2_5                 3.958436e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005581e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0150e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6936e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8599
    reference variance = 0.232407
====================================================
  Execution time = 2.8162e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4614e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1503e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346242011410
                                         uncertainty =       0.008463401135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346242011410
                                         uncertainty =       0.008463401135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416017036
  error estimate for blocks of size 2^( 2) =       0.000427688526
  error estimate for blocks of size 2^( 3) =       0.000439125909
  error estimate for blocks of size 2^( 4) =       0.000449520721
  error estimate for blocks of size 2^( 5) =       0.000461603832
  error estimate for blocks of size 2^( 6) =       0.000468638133
  error estimate for blocks of size 2^( 7) =       0.000474817738

      target function =                  N/A
              le_mean =     -16.910453878392
             les_mean =     286.309590549018
             stat err =       0.000463645106
             autocorr =       1.242078739989
              std dev =       0.588336934821
             le_variance =       0.346140348875


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691045387839e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910453878392       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910453912053       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910453902546       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910453907484       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910453938418       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910453945743       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910453950824       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910453946726       residual = 1.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.327291e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910453878392       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910453886866       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910453884487       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910453885777       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910453893397       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910453895322       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910453896716       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910453895649       residual = 1.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 3.320783e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910453878392       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910453880514       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910453879919       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910453880245       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910453882143       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910453882630       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910453882987       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910453882717       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 8.303591e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172652 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5319e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.103771e-01 1 1  ON 0
 uu_1                 1.452524e-01 1 1  ON 1
 uu_2                 4.714675e-02 1 1  ON 2
 uu_3                -1.665133e-02 1 1  ON 3
 uu_4                -6.730546e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336198e-01 1 1  ON 6
 uu_7                -1.483994e-01 1 1  ON 7
 uu_8                -1.420786e-01 1 1  ON 8
 uu_9                -1.136846e-01 1 1  ON 9
 ud_0                 4.381332e-01 1 1  ON 10
 ud_1                 1.811519e-01 1 1  ON 11
 ud_2                 6.688676e-02 1 1  ON 12
 ud_3                -2.368622e-03 1 1  ON 13
 ud_4                -5.865157e-02 1 1  ON 14
 ud_5                -1.017981e-01 1 1  ON 15
 ud_6                -1.313461e-01 1 1  ON 16
 ud_7                -1.519667e-01 1 1  ON 17
 ud_8                -1.563808e-01 1 1  ON 18
 ud_9                -1.462352e-01 1 1  ON 19
 eO_0                -7.499061e-01 1 1  ON 20
 eO_1                -4.329500e-01 1 1  ON 21
 eO_2                -1.089748e-02 1 1  ON 22
 eO_3                 3.130644e-01 1 1  ON 23
 eO_4                 5.356521e-01 1 1  ON 24
 eO_5                 4.901573e-01 1 1  ON 25
 eO_6                 2.521882e-01 1 1  ON 26
 eO_7                -5.286891e-02 1 1  ON 27
 eO_8                -2.396690e-01 1 1  ON 28
 eO_9                -1.015724e-01 1 1  ON 29
eH1_0                -2.694218e-01 1 1  ON 30
eH1_1                -1.627837e-01 1 1  ON 31
eH1_2                -1.193839e-01 1 1  ON 32
eH1_3                -6.625879e-02 1 1  ON 33
eH1_4                -6.681169e-03 1 1  ON 34
eH1_5                 3.776909e-02 1 1  ON 35
eH1_6                 1.096078e-01 1 1  ON 36
eH1_7                 1.752249e-01 1 1  ON 37
eH1_8                 2.049528e-01 1 1  ON 38
eH1_9                 9.470731e-02 1 1  ON 39
eH2_0                -2.669710e-01 1 1  ON 40
eH2_1                -1.607100e-01 1 1  ON 41
eH2_2                -1.171357e-01 1 1  ON 42
eH2_3                -6.377782e-02 1 1  ON 43
eH2_4                -4.015858e-03 1 1  ON 44
eH2_5                 3.958410e-02 1 1  ON 45
eH2_6                 1.105061e-01 1 1  ON 46
eH2_7                 1.732263e-01 1 1  ON 47
eH2_8                 2.094923e-01 1 1  ON 48
eH2_9                 9.005865e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9338
    reference variance = 0.31814
====================================================
  Execution time = 2.7699e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3500e-01
  Total weights = 2.0000e+06
  Execution time = 3.4705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335059456920
                                         uncertainty =       0.004428912017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335059456920
                                         uncertainty =       0.004428912017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409269003
  error estimate for blocks of size 2^( 2) =       0.000420849660
  error estimate for blocks of size 2^( 3) =       0.000432996233
  error estimate for blocks of size 2^( 4) =       0.000444717065
  error estimate for blocks of size 2^( 5) =       0.000454190827
  error estimate for blocks of size 2^( 6) =       0.000460423184
  error estimate for blocks of size 2^( 7) =       0.000460936549

      target function =                  N/A
              le_mean =     -16.910295250400
             les_mean =     286.293087521094
             stat err =       0.000455066906
             autocorr =       1.236325426096
              std dev =       0.578793774074
             le_variance =       0.335002232907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335056972192
                                         uncertainty =       0.004428943632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335056972192
                                         uncertainty =       0.004428943632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409267484
  error estimate for blocks of size 2^( 2) =       0.000420848036
  error estimate for blocks of size 2^( 3) =       0.000432994482
  error estimate for blocks of size 2^( 4) =       0.000444715157
  error estimate for blocks of size 2^( 5) =       0.000454188972
  error estimate for blocks of size 2^( 6) =       0.000460421650
  error estimate for blocks of size 2^( 7) =       0.000460935033

      target function =                  N/A
              le_mean =     -16.910295230022
             les_mean =     286.293084345232
             stat err =       0.000455065203
             autocorr =       1.236325347832
              std dev =       0.578791625920
             le_variance =       0.334999746236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335058165847
                                         uncertainty =       0.004428928413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335058165847
                                         uncertainty =       0.004428928413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409268213
  error estimate for blocks of size 2^( 2) =       0.000420848819
  error estimate for blocks of size 2^( 3) =       0.000432995329
  error estimate for blocks of size 2^( 4) =       0.000444716083
  error estimate for blocks of size 2^( 5) =       0.000454189872
  error estimate for blocks of size 2^( 6) =       0.000460422392
  error estimate for blocks of size 2^( 7) =       0.000460935765

      target function =                  N/A
              le_mean =     -16.910295239426
             les_mean =     286.293085857929
             stat err =       0.000455066028
             autocorr =       1.236325421242
              std dev =       0.578792657919
             le_variance =       0.335000940861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335059293866
                                         uncertainty =       0.004428914086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335059293866
                                         uncertainty =       0.004428914086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409268903
  error estimate for blocks of size 2^( 2) =       0.000420849554
  error estimate for blocks of size 2^( 3) =       0.000432996119
  error estimate for blocks of size 2^( 4) =       0.000444716941
  error estimate for blocks of size 2^( 5) =       0.000454190706
  error estimate for blocks of size 2^( 6) =       0.000460423084
  error estimate for blocks of size 2^( 7) =       0.000460936450

      target function =                  N/A
              le_mean =     -16.910295248987
             les_mean =     286.293087310153
             stat err =       0.000455066796
             autocorr =       1.236325426546
              std dev =       0.578793633112
             le_variance =       0.335002069731


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910295250400        initial  <--
     1.5625e+01     1.5625e+02             1.3273e-05       -16.910295230022
     6.2500e+01     6.2500e+02             3.3208e-06       -16.910295239426
     2.5000e+02     2.5000e+03             8.3036e-07       -16.910295248987

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0845
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714436e-02 1 1  ON 2
 uu_3                -1.665162e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688544e-02 1 1  ON 12
 ud_3                -2.369275e-03 1 1  ON 13
 ud_4                -5.865175e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089673e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286831e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015700e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193840e-01 1 1  ON 32
eH1_3                -6.625760e-02 1 1  ON 33
eH1_4                -6.679755e-03 1 1  ON 34
eH1_5                 3.776924e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752242e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470399e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377687e-02 1 1  ON 43
eH2_4                -4.015074e-03 1 1  ON 44
eH2_5                 3.958436e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005581e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0411e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6931e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8946
    reference variance = 0.170192
====================================================
  Execution time = 3.0177e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3704e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1066e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337145977321
                                         uncertainty =       0.004454925213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337145977321
                                         uncertainty =       0.004454925213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410512055
  error estimate for blocks of size 2^( 2) =       0.000422047356
  error estimate for blocks of size 2^( 3) =       0.000433521233
  error estimate for blocks of size 2^( 4) =       0.000445111115
  error estimate for blocks of size 2^( 5) =       0.000454434357
  error estimate for blocks of size 2^( 6) =       0.000462332051
  error estimate for blocks of size 2^( 7) =       0.000466581059

      target function =                  N/A
              le_mean =     -16.910144579991
             les_mean =     286.290029841896
             stat err =       0.000457114645
             autocorr =       1.239933638185
              std dev =       0.580551715369
             le_variance =       0.337040294218


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691014457999e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910144579991       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910144592656       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910144592379       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910144595304       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910144593634       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910144597812       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910144597715       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910144597918       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.188459e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910144579991       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910144583160       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910144583092       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910144583823       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910144583405       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910144584450       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910144584425       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910144584476       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 2.971552e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910144579991       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910144580783       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910144580767       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910144580949       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910144580844       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910144581106       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910144581099       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910144581115       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 7.429131e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175365 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7290e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714449e-02 1 1  ON 2
 uu_3                -1.665141e-02 1 1  ON 3
 uu_4                -6.730672e-02 1 1  ON 4
 uu_5                -1.046347e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420791e-01 1 1  ON 8
 uu_9                -1.136842e-01 1 1  ON 9
 ud_0                 4.381313e-01 1 1  ON 10
 ud_1                 1.811499e-01 1 1  ON 11
 ud_2                 6.688552e-02 1 1  ON 12
 ud_3                -2.369383e-03 1 1  ON 13
 ud_4                -5.865171e-02 1 1  ON 14
 ud_5                -1.017968e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519659e-01 1 1  ON 17
 ud_8                -1.563801e-01 1 1  ON 18
 ud_9                -1.462338e-01 1 1  ON 19
 eO_0                -7.499078e-01 1 1  ON 20
 eO_1                -4.329514e-01 1 1  ON 21
 eO_2                -1.089673e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901560e-01 1 1  ON 25
 eO_6                 2.521882e-01 1 1  ON 26
 eO_7                -5.286826e-02 1 1  ON 27
 eO_8                -2.396677e-01 1 1  ON 28
 eO_9                -1.015703e-01 1 1  ON 29
eH1_0                -2.694190e-01 1 1  ON 30
eH1_1                -1.627828e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625779e-02 1 1  ON 33
eH1_4                -6.679684e-03 1 1  ON 34
eH1_5                 3.776922e-02 1 1  ON 35
eH1_6                 1.096077e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049507e-01 1 1  ON 38
eH1_9                 9.470423e-02 1 1  ON 39
eH2_0                -2.669708e-01 1 1  ON 40
eH2_1                -1.607078e-01 1 1  ON 41
eH2_2                -1.171338e-01 1 1  ON 42
eH2_3                -6.377702e-02 1 1  ON 43
eH2_4                -4.015243e-03 1 1  ON 44
eH2_5                 3.958436e-02 1 1  ON 45
eH2_6                 1.105058e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094904e-01 1 1  ON 48
eH2_9                 9.005611e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.847
    reference variance = 0.237997
====================================================
  Execution time = 2.7652e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4655e-01
  Total weights = 2.0000e+06
  Execution time = 3.4680e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346666942511
                                         uncertainty =       0.007256958576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346666942511
                                         uncertainty =       0.007256958576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416261318
  error estimate for blocks of size 2^( 2) =       0.000427615432
  error estimate for blocks of size 2^( 3) =       0.000439257457
  error estimate for blocks of size 2^( 4) =       0.000450330639
  error estimate for blocks of size 2^( 5) =       0.000459657266
  error estimate for blocks of size 2^( 6) =       0.000465262929
  error estimate for blocks of size 2^( 7) =       0.000469679238

      target function =                  N/A
              le_mean =     -16.910557784032
             les_mean =     286.313511363186
             stat err =       0.000461232518
             autocorr =       1.227743735633
              std dev =       0.588682401115
             le_variance =       0.346546969383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346667084707
                                         uncertainty =       0.007256959611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346667084707
                                         uncertainty =       0.007256959611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416261403
  error estimate for blocks of size 2^( 2) =       0.000427615496
  error estimate for blocks of size 2^( 3) =       0.000439257488
  error estimate for blocks of size 2^( 4) =       0.000450330650
  error estimate for blocks of size 2^( 5) =       0.000459657275
  error estimate for blocks of size 2^( 6) =       0.000465262954
  error estimate for blocks of size 2^( 7) =       0.000469679295

      target function =                  N/A
              le_mean =     -16.910557783121
             les_mean =     286.313511474328
             stat err =       0.000461232544
             autocorr =       1.227743370689
              std dev =       0.588682521673
             le_variance =       0.346547111323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346667013326
                                         uncertainty =       0.007256959086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346667013326
                                         uncertainty =       0.007256959086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416261360
  error estimate for blocks of size 2^( 2) =       0.000427615464
  error estimate for blocks of size 2^( 3) =       0.000439257473
  error estimate for blocks of size 2^( 4) =       0.000450330644
  error estimate for blocks of size 2^( 5) =       0.000459657270
  error estimate for blocks of size 2^( 6) =       0.000465262941
  error estimate for blocks of size 2^( 7) =       0.000469679266

      target function =                  N/A
              le_mean =     -16.910557783572
             les_mean =     286.313511418327
             stat err =       0.000461232530
             autocorr =       1.227743553251
              std dev =       0.588682461154
             le_variance =       0.346547040070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346666951353
                                         uncertainty =       0.007256958640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346666951353
                                         uncertainty =       0.007256958640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416261323
  error estimate for blocks of size 2^( 2) =       0.000427615436
  error estimate for blocks of size 2^( 3) =       0.000439257459
  error estimate for blocks of size 2^( 4) =       0.000450330639
  error estimate for blocks of size 2^( 5) =       0.000459657266
  error estimate for blocks of size 2^( 6) =       0.000465262930
  error estimate for blocks of size 2^( 7) =       0.000469679241

      target function =                  N/A
              le_mean =     -16.910557783974
             les_mean =     286.313511370057
             stat err =       0.000461232519
             autocorr =       1.227743712830
              std dev =       0.588682408612
             le_variance =       0.346546978209


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910557784032        initial  <--
     1.5625e+02     1.5625e+03             1.1885e-06       -16.910557783121
     6.2500e+02     6.2500e+03             2.9716e-07       -16.910557783572
     2.5000e+03     2.5000e+04             7.4291e-08       -16.910557783974

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.9911
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714436e-02 1 1  ON 2
 uu_3                -1.665162e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688544e-02 1 1  ON 12
 ud_3                -2.369275e-03 1 1  ON 13
 ud_4                -5.865175e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089673e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286831e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015700e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193840e-01 1 1  ON 32
eH1_3                -6.625760e-02 1 1  ON 33
eH1_4                -6.679755e-03 1 1  ON 34
eH1_5                 3.776924e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752242e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470399e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377687e-02 1 1  ON 43
eH2_4                -4.015074e-03 1 1  ON 44
eH2_5                 3.958436e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005581e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2288e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8577
    reference variance = 0.273457
====================================================
  Execution time = 2.8168e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3452e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1356e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334517049197
                                         uncertainty =       0.002957172881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334517049197
                                         uncertainty =       0.002957172881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408971621
  error estimate for blocks of size 2^( 2) =       0.000420658407
  error estimate for blocks of size 2^( 3) =       0.000432185590
  error estimate for blocks of size 2^( 4) =       0.000443565124
  error estimate for blocks of size 2^( 5) =       0.000454510053
  error estimate for blocks of size 2^( 6) =       0.000462026212
  error estimate for blocks of size 2^( 7) =       0.000465779533

      target function =                  N/A
              le_mean =     -16.910364478029
             les_mean =     286.294942186081
             stat err =       0.000456470230
             autocorr =       1.245772021891
              std dev =       0.578373213040
             le_variance =       0.334515573562


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691036447803e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910364478029       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910364478220       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910364478251       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910364478424       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910364478397       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910364478390       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910364478469       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910364478489       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.209141e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910364478029       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910364478077       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910364478084       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910364478127       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910364478121       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910364478119       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910364478140       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910364478150       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 3.023103e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910364478029       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910364478041       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910364478043       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910364478052       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910364478052       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910364478053       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910364478057       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910364478060       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 7.557914e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178078 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5310e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714438e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730683e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811496e-01 1 1  ON 11
 ud_2                 6.688546e-02 1 1  ON 12
 ud_3                -2.369290e-03 1 1  ON 13
 ud_4                -5.865173e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089676e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286831e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625762e-02 1 1  ON 33
eH1_4                -6.679746e-03 1 1  ON 34
eH1_5                 3.776924e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015085e-03 1 1  ON 44
eH2_5                 3.958436e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732254e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005583e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9074
    reference variance = 0.247745
====================================================
  Execution time = 2.7463e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.5583e-01
  Total weights = 2.0000e+06
  Execution time = 3.4829e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355778904945
                                         uncertainty =       0.007443973452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355778904945
                                         uncertainty =       0.007443973452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421799422
  error estimate for blocks of size 2^( 2) =       0.000433264692
  error estimate for blocks of size 2^( 3) =       0.000445515207
  error estimate for blocks of size 2^( 4) =       0.000457563681
  error estimate for blocks of size 2^( 5) =       0.000466768699
  error estimate for blocks of size 2^( 6) =       0.000474437408
  error estimate for blocks of size 2^( 7) =       0.000481267318

      target function =                  N/A
              le_mean =     -16.910142055825
             les_mean =     286.308733675389
             stat err =       0.000470009276
             autocorr =       1.241654874361
              std dev =       0.596514463473
             le_variance =       0.355829505132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355778895548
                                         uncertainty =       0.007443971550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355778895548
                                         uncertainty =       0.007443971550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421799417
  error estimate for blocks of size 2^( 2) =       0.000433264687
  error estimate for blocks of size 2^( 3) =       0.000445515201
  error estimate for blocks of size 2^( 4) =       0.000457563671
  error estimate for blocks of size 2^( 5) =       0.000466768688
  error estimate for blocks of size 2^( 6) =       0.000474437395
  error estimate for blocks of size 2^( 7) =       0.000481267304

      target function =                  N/A
              le_mean =     -16.910142055459
             les_mean =     286.308733653586
             stat err =       0.000470009265
             autocorr =       1.241654845664
              std dev =       0.596514455555
             le_variance =       0.355829495686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355778900247
                                         uncertainty =       0.007443972501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355778900247
                                         uncertainty =       0.007443972501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421799419
  error estimate for blocks of size 2^( 2) =       0.000433264689
  error estimate for blocks of size 2^( 3) =       0.000445515204
  error estimate for blocks of size 2^( 4) =       0.000457563676
  error estimate for blocks of size 2^( 5) =       0.000466768693
  error estimate for blocks of size 2^( 6) =       0.000474437401
  error estimate for blocks of size 2^( 7) =       0.000481267311

      target function =                  N/A
              le_mean =     -16.910142055642
             les_mean =     286.308733664485
             stat err =       0.000470009270
             autocorr =       1.241654860007
              std dev =       0.596514459514
             le_variance =       0.355829500409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355778904358
                                         uncertainty =       0.007443973333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355778904358
                                         uncertainty =       0.007443973333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421799422
  error estimate for blocks of size 2^( 2) =       0.000433264691
  error estimate for blocks of size 2^( 3) =       0.000445515206
  error estimate for blocks of size 2^( 4) =       0.000457563680
  error estimate for blocks of size 2^( 5) =       0.000466768698
  error estimate for blocks of size 2^( 6) =       0.000474437407
  error estimate for blocks of size 2^( 7) =       0.000481267317

      target function =                  N/A
              le_mean =     -16.910142055802
             les_mean =     286.308733674025
             stat err =       0.000470009276
             autocorr =       1.241654872571
              std dev =       0.596514462978
             le_variance =       0.355829504542


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910142055825        initial  <--
     1.5625e+03     1.5625e+04             1.2091e-07       -16.910142055459
     6.2500e+03     6.2500e+04             3.0231e-08       -16.910142055642
     2.5000e+04     2.5000e+05             7.5579e-09       -16.910142055802

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.9159
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714436e-02 1 1  ON 2
 uu_3                -1.665162e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688544e-02 1 1  ON 12
 ud_3                -2.369275e-03 1 1  ON 13
 ud_4                -5.865175e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089673e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286831e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015700e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193840e-01 1 1  ON 32
eH1_3                -6.625760e-02 1 1  ON 33
eH1_4                -6.679755e-03 1 1  ON 34
eH1_5                 3.776924e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752242e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470399e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377687e-02 1 1  ON 43
eH2_4                -4.015074e-03 1 1  ON 44
eH2_5                 3.958436e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005581e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0233e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8955
    reference variance = 0.366882
====================================================
  Execution time = 2.8262e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.4212e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1322e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342033344598
                                         uncertainty =       0.004633191985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342033344598
                                         uncertainty =       0.004633191985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413596572
  error estimate for blocks of size 2^( 2) =       0.000425421774
  error estimate for blocks of size 2^( 3) =       0.000437915585
  error estimate for blocks of size 2^( 4) =       0.000449095841
  error estimate for blocks of size 2^( 5) =       0.000459479195
  error estimate for blocks of size 2^( 6) =       0.000466859053
  error estimate for blocks of size 2^( 7) =       0.000474095366

      target function =                  N/A
              le_mean =     -16.909204263054
             les_mean =     286.263312887879
             stat err =       0.000462382364
             autocorr =       1.249823423803
              std dev =       0.584913881918
             le_variance =       0.342124249260


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690920426305e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909204263054       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909204263104       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909204263127       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909204263121       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909204263099       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909204263102       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909204263119       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909204263118       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 1.424370e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909204263054       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909204263066       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909204263072       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909204263071       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909204263066       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909204263090       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909204262990       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909204263107       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 3.560925e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909204263054       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909204263057       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909204263059       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909204263058       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909204263063       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909204263057       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909204263054       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909204263238       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+05 is 8.902314e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180790 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5401e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714436e-02 1 1  ON 2
 uu_3                -1.665162e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688544e-02 1 1  ON 12
 ud_3                -2.369275e-03 1 1  ON 13
 ud_4                -5.865175e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089673e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286831e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015700e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193840e-01 1 1  ON 32
eH1_3                -6.625760e-02 1 1  ON 33
eH1_4                -6.679754e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752242e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470399e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377687e-02 1 1  ON 43
eH2_4                -4.015075e-03 1 1  ON 44
eH2_5                 3.958437e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005582e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9828
    reference variance = 0.247964
====================================================
  Execution time = 2.7452e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3756e-01
  Total weights = 2.0000e+06
  Execution time = 3.4709e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337566100592
                                         uncertainty =       0.008846867248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337566100592
                                         uncertainty =       0.008846867248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410827359
  error estimate for blocks of size 2^( 2) =       0.000422404476
  error estimate for blocks of size 2^( 3) =       0.000434166644
  error estimate for blocks of size 2^( 4) =       0.000445426263
  error estimate for blocks of size 2^( 5) =       0.000455134033
  error estimate for blocks of size 2^( 6) =       0.000460517675
  error estimate for blocks of size 2^( 7) =       0.000464545326

      target function =                  N/A
              le_mean =     -16.910169435337
             les_mean =     286.291388401380
             stat err =       0.000456405824
             autocorr =       1.234194592796
              std dev =       0.580997623359
             le_variance =       0.337558238349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337566101073
                                         uncertainty =       0.008846867220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337566101073
                                         uncertainty =       0.008846867220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410827360
  error estimate for blocks of size 2^( 2) =       0.000422404477
  error estimate for blocks of size 2^( 3) =       0.000434166644
  error estimate for blocks of size 2^( 4) =       0.000445426262
  error estimate for blocks of size 2^( 5) =       0.000455134033
  error estimate for blocks of size 2^( 6) =       0.000460517674
  error estimate for blocks of size 2^( 7) =       0.000464545326

      target function =                  N/A
              le_mean =     -16.910169435331
             les_mean =     286.291388401663
             stat err =       0.000456405824
             autocorr =       1.234194590614
              std dev =       0.580997623775
             le_variance =       0.337558238832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337566100832
                                         uncertainty =       0.008846867234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337566100832
                                         uncertainty =       0.008846867234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410827359
  error estimate for blocks of size 2^( 2) =       0.000422404476
  error estimate for blocks of size 2^( 3) =       0.000434166644
  error estimate for blocks of size 2^( 4) =       0.000445426262
  error estimate for blocks of size 2^( 5) =       0.000455134033
  error estimate for blocks of size 2^( 6) =       0.000460517675
  error estimate for blocks of size 2^( 7) =       0.000464545326

      target function =                  N/A
              le_mean =     -16.910169435334
             les_mean =     286.291388401521
             stat err =       0.000456405824
             autocorr =       1.234194591704
              std dev =       0.580997623567
             le_variance =       0.337558238590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337566100622
                                         uncertainty =       0.008846867246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337566100622
                                         uncertainty =       0.008846867246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410827359
  error estimate for blocks of size 2^( 2) =       0.000422404476
  error estimate for blocks of size 2^( 3) =       0.000434166644
  error estimate for blocks of size 2^( 4) =       0.000445426263
  error estimate for blocks of size 2^( 5) =       0.000455134033
  error estimate for blocks of size 2^( 6) =       0.000460517675
  error estimate for blocks of size 2^( 7) =       0.000464545326

      target function =                  N/A
              le_mean =     -16.910169435337
             les_mean =     286.291388401398
             stat err =       0.000456405824
             autocorr =       1.234194592661
              std dev =       0.580997623385
             le_variance =       0.337558238379


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910169435337        initial  <--
     1.5625e+04     1.5625e+05             1.4244e-08       -16.910169435331
     6.2500e+04     6.2500e+05             3.5609e-09       -16.910169435334
     2.5000e+05     2.5000e+06             8.9023e-10       -16.910169435337

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.8871
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714436e-02 1 1  ON 2
 uu_3                -1.665162e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688544e-02 1 1  ON 12
 ud_3                -2.369275e-03 1 1  ON 13
 ud_4                -5.865175e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089673e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286831e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015700e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193840e-01 1 1  ON 32
eH1_3                -6.625760e-02 1 1  ON 33
eH1_4                -6.679755e-03 1 1  ON 34
eH1_5                 3.776924e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752242e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470399e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377687e-02 1 1  ON 43
eH2_4                -4.015074e-03 1 1  ON 44
eH2_5                 3.958436e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005581e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0296e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8865
    reference variance = 0.370661
====================================================
  Execution time = 2.8264e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4986e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349955569474
                                         uncertainty =       0.008826140135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349955569474
                                         uncertainty =       0.008826140135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418247317
  error estimate for blocks of size 2^( 2) =       0.000429538877
  error estimate for blocks of size 2^( 3) =       0.000441675369
  error estimate for blocks of size 2^( 4) =       0.000453511656
  error estimate for blocks of size 2^( 5) =       0.000462737174
  error estimate for blocks of size 2^( 6) =       0.000470797756
  error estimate for blocks of size 2^( 7) =       0.000473735371

      target function =                  N/A
              le_mean =     -16.909570365985
             les_mean =     286.283431424061
             stat err =       0.000465195489
             autocorr =       1.237099585998
              std dev =       0.591491028505
             le_variance =       0.349861636802


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690957036598e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909570365985       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909570365992       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909570365992       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909570365992       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909570365952       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909570365937       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909570365741       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909570366247       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.447552e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909570365985       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909570365987       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909570365987       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909570365957       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909570365971       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909570365641       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909570366096       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909570366023       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 3.618880e-10

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909570365985       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909570365985       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909570365985       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909570365916       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909570365985       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909570365537       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909570366063       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909570364518       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+06 is 9.047200e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183466 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5396e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714436e-02 1 1  ON 2
 uu_3                -1.665162e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688544e-02 1 1  ON 12
 ud_3                -2.369275e-03 1 1  ON 13
 ud_4                -5.865175e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089673e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286831e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015700e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193840e-01 1 1  ON 32
eH1_3                -6.625760e-02 1 1  ON 33
eH1_4                -6.679755e-03 1 1  ON 34
eH1_5                 3.776924e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752242e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470399e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377687e-02 1 1  ON 43
eH2_4                -4.015074e-03 1 1  ON 44
eH2_5                 3.958436e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005581e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8773
    reference variance = 0.193966
====================================================
  Execution time = 2.7636e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3849e-01
  Total weights = 2.0000e+06
  Execution time = 3.4824e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338473093961
                                         uncertainty =       0.004834658186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338473093961
                                         uncertainty =       0.004834658186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411394421
  error estimate for blocks of size 2^( 2) =       0.000422838403
  error estimate for blocks of size 2^( 3) =       0.000435123198
  error estimate for blocks of size 2^( 4) =       0.000446276584
  error estimate for blocks of size 2^( 5) =       0.000456248080
  error estimate for blocks of size 2^( 6) =       0.000463950846
  error estimate for blocks of size 2^( 7) =       0.000470858600

      target function =                  N/A
              le_mean =     -16.909830354565
             les_mean =     286.280853190053
             stat err =       0.000459333528
             autocorr =       1.246635521813
              std dev =       0.581799569538
             le_variance =       0.338490739115

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338473093994
                                         uncertainty =       0.004834658187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338473093994
                                         uncertainty =       0.004834658187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411394421
  error estimate for blocks of size 2^( 2) =       0.000422838403
  error estimate for blocks of size 2^( 3) =       0.000435123198
  error estimate for blocks of size 2^( 4) =       0.000446276584
  error estimate for blocks of size 2^( 5) =       0.000456248080
  error estimate for blocks of size 2^( 6) =       0.000463950846
  error estimate for blocks of size 2^( 7) =       0.000470858600

      target function =                  N/A
              le_mean =     -16.909830354566
             les_mean =     286.280853190106
             stat err =       0.000459333528
             autocorr =       1.246635521569
              std dev =       0.581799569566
             le_variance =       0.338490739148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338473093977
                                         uncertainty =       0.004834658187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338473093977
                                         uncertainty =       0.004834658187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411394421
  error estimate for blocks of size 2^( 2) =       0.000422838403
  error estimate for blocks of size 2^( 3) =       0.000435123198
  error estimate for blocks of size 2^( 4) =       0.000446276584
  error estimate for blocks of size 2^( 5) =       0.000456248080
  error estimate for blocks of size 2^( 6) =       0.000463950846
  error estimate for blocks of size 2^( 7) =       0.000470858600

      target function =                  N/A
              le_mean =     -16.909830354566
             les_mean =     286.280853190080
             stat err =       0.000459333528
             autocorr =       1.246635521696
              std dev =       0.581799569552
             le_variance =       0.338490739131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338473093963
                                         uncertainty =       0.004834658186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338473093963
                                         uncertainty =       0.004834658186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411394421
  error estimate for blocks of size 2^( 2) =       0.000422838403
  error estimate for blocks of size 2^( 3) =       0.000435123198
  error estimate for blocks of size 2^( 4) =       0.000446276584
  error estimate for blocks of size 2^( 5) =       0.000456248080
  error estimate for blocks of size 2^( 6) =       0.000463950846
  error estimate for blocks of size 2^( 7) =       0.000470858600

      target function =                  N/A
              le_mean =     -16.909830354566
             les_mean =     286.280853190056
             stat err =       0.000459333528
             autocorr =       1.246635521802
              std dev =       0.581799569540
             le_variance =       0.338490739117


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909830354565        initial
     1.5625e+05     1.5625e+06             1.4476e-09       -16.909830354566  <--
     6.2500e+05     6.2500e+06             3.6189e-10       -16.909830354566
     2.5000e+06     2.5000e+07             9.0472e-11       -16.909830354566

*****************************************************************************
Applying the update for shift_i =   1.5625e+05     and shift_s =   1.5625e+06
*****************************************************************************

  Execution time = 4.8855e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714436e-02 1 1  ON 2
 uu_3                -1.665162e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688544e-02 1 1  ON 12
 ud_3                -2.369275e-03 1 1  ON 13
 ud_4                -5.865175e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089673e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286831e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015700e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193840e-01 1 1  ON 32
eH1_3                -6.625760e-02 1 1  ON 33
eH1_4                -6.679756e-03 1 1  ON 34
eH1_5                 3.776924e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752242e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470399e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377687e-02 1 1  ON 43
eH2_4                -4.015074e-03 1 1  ON 44
eH2_5                 3.958437e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005581e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4258e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8029
    reference variance = 0.352678
====================================================
  Execution time = 2.8229e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3927e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1794e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339304517645
                                         uncertainty =       0.005823157708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339304517645
                                         uncertainty =       0.005823157708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411867145
  error estimate for blocks of size 2^( 2) =       0.000424040428
  error estimate for blocks of size 2^( 3) =       0.000435681740
  error estimate for blocks of size 2^( 4) =       0.000447232311
  error estimate for blocks of size 2^( 5) =       0.000456257055
  error estimate for blocks of size 2^( 6) =       0.000462667072
  error estimate for blocks of size 2^( 7) =       0.000466680810

      target function =                  N/A
              le_mean =     -16.910196878546
             les_mean =     286.294027392140
             stat err =       0.000458209312
             autocorr =       1.237694677767
              std dev =       0.582468102640
             le_variance =       0.339269090593


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691019687855e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910196878546       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910196878559       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910196878573       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910196878584       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910196878584       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910196878601       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910196878591       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910196878604       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 4.689565e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910196878546       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910196878549       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910196878553       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910196878558       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910196878547       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910196878709       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910196878516       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910196878503       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.172392e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910196878546       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910196878547       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910196878548       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910196878622       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910196878548       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910196878562       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910196878622       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910196878805       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 2.930982e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.186167 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5415e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714436e-02 1 1  ON 2
 uu_3                -1.665162e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688544e-02 1 1  ON 12
 ud_3                -2.369275e-03 1 1  ON 13
 ud_4                -5.865175e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089673e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286831e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015700e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193840e-01 1 1  ON 32
eH1_3                -6.625760e-02 1 1  ON 33
eH1_4                -6.679755e-03 1 1  ON 34
eH1_5                 3.776924e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752242e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470399e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377687e-02 1 1  ON 43
eH2_4                -4.015074e-03 1 1  ON 44
eH2_5                 3.958437e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005582e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8701
    reference variance = 0.290768
====================================================
  Execution time = 2.7291e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3521e-01
  Total weights = 2.0000e+06
  Execution time = 3.4755e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335288287320
                                         uncertainty =       0.003127884525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335288287320
                                         uncertainty =       0.003127884525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409397108
  error estimate for blocks of size 2^( 2) =       0.000421132008
  error estimate for blocks of size 2^( 3) =       0.000433336677
  error estimate for blocks of size 2^( 4) =       0.000444627853
  error estimate for blocks of size 2^( 5) =       0.000454720853
  error estimate for blocks of size 2^( 6) =       0.000461900942
  error estimate for blocks of size 2^( 7) =       0.000463327963

      target function =                  N/A
              le_mean =     -16.909526212403
             les_mean =     286.267288544374
             stat err =       0.000456144403
             autocorr =       1.241409770525
              std dev =       0.578974942499
             le_variance =       0.335211984042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335288285887
                                         uncertainty =       0.003127884514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335288285887
                                         uncertainty =       0.003127884514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409397107
  error estimate for blocks of size 2^( 2) =       0.000421132007
  error estimate for blocks of size 2^( 3) =       0.000433336676
  error estimate for blocks of size 2^( 4) =       0.000444627852
  error estimate for blocks of size 2^( 5) =       0.000454720852
  error estimate for blocks of size 2^( 6) =       0.000461900941
  error estimate for blocks of size 2^( 7) =       0.000463327962

      target function =                  N/A
              le_mean =     -16.909526212430
             les_mean =     286.267288543858
             stat err =       0.000456144402
             autocorr =       1.241409770232
              std dev =       0.578974941261
             le_variance =       0.335211982609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335288286603
                                         uncertainty =       0.003127884519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335288286603
                                         uncertainty =       0.003127884519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409397108
  error estimate for blocks of size 2^( 2) =       0.000421132007
  error estimate for blocks of size 2^( 3) =       0.000433336677
  error estimate for blocks of size 2^( 4) =       0.000444627853
  error estimate for blocks of size 2^( 5) =       0.000454720852
  error estimate for blocks of size 2^( 6) =       0.000461900942
  error estimate for blocks of size 2^( 7) =       0.000463327962

      target function =                  N/A
              le_mean =     -16.909526212416
             les_mean =     286.267288544116
             stat err =       0.000456144402
             autocorr =       1.241409770383
              std dev =       0.578974941880
             le_variance =       0.335211983325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335288287230
                                         uncertainty =       0.003127884524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335288287230
                                         uncertainty =       0.003127884524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409397108
  error estimate for blocks of size 2^( 2) =       0.000421132008
  error estimate for blocks of size 2^( 3) =       0.000433336677
  error estimate for blocks of size 2^( 4) =       0.000444627853
  error estimate for blocks of size 2^( 5) =       0.000454720853
  error estimate for blocks of size 2^( 6) =       0.000461900942
  error estimate for blocks of size 2^( 7) =       0.000463327963

      target function =                  N/A
              le_mean =     -16.909526212405
             les_mean =     286.267288544342
             stat err =       0.000456144403
             autocorr =       1.241409770512
              std dev =       0.578974942422
             le_variance =       0.335211983952


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909526212403        initial
     3.9062e+04     3.9062e+05             4.6896e-09       -16.909526212430  <--
     1.5625e+05     1.5625e+06             1.1724e-09       -16.909526212416
     6.2500e+05     6.2500e+06             2.9310e-10       -16.909526212405

*****************************************************************************
Applying the update for shift_i =   3.9062e+04     and shift_s =   3.9062e+05
*****************************************************************************

  Execution time = 4.4681e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714436e-02 1 1  ON 2
 uu_3                -1.665162e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688544e-02 1 1  ON 12
 ud_3                -2.369274e-03 1 1  ON 13
 ud_4                -5.865175e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089673e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286831e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015700e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193840e-01 1 1  ON 32
eH1_3                -6.625760e-02 1 1  ON 33
eH1_4                -6.679755e-03 1 1  ON 34
eH1_5                 3.776924e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752242e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470399e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015073e-03 1 1  ON 44
eH2_5                 3.958437e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005582e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0105e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9949
    reference variance = 0.557615
====================================================
  Execution time = 2.8161e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4236e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.0913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342421197743
                                         uncertainty =       0.005887443495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342421197743
                                         uncertainty =       0.005887443495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413736870
  error estimate for blocks of size 2^( 2) =       0.000425502936
  error estimate for blocks of size 2^( 3) =       0.000438158140
  error estimate for blocks of size 2^( 4) =       0.000449465268
  error estimate for blocks of size 2^( 5) =       0.000460247660
  error estimate for blocks of size 2^( 6) =       0.000469632159
  error estimate for blocks of size 2^( 7) =       0.000475777901

      target function =                  N/A
              le_mean =     -16.910272602486
             les_mean =     286.299675713857
             stat err =       0.000463780747
             autocorr =       1.256541923346
              std dev =       0.585112292333
             le_variance =       0.342356394640


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691027260249e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910272602486       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910272602499       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910272602660       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910272602728       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910272602725       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910272602747       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910272602743       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910272602732       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.176991e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910272602486       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910272602489       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910272602530       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910272602546       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910272602593       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910272602522       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910272602550       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910272602564       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 5.442487e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910272602486       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910272602487       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910272602497       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910272602493       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910272602558       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910272602484       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910272602488       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910272602485       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.360622e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188871 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5259e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714436e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369277e-03 1 1  ON 13
 ud_4                -5.865175e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089673e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286831e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015700e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193840e-01 1 1  ON 32
eH1_3                -6.625760e-02 1 1  ON 33
eH1_4                -6.679754e-03 1 1  ON 34
eH1_5                 3.776924e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752242e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470400e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015076e-03 1 1  ON 44
eH2_5                 3.958437e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005582e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8285
    reference variance = 0.883229
====================================================
  Execution time = 2.7445e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3145e-01
  Total weights = 2.0000e+06
  Execution time = 3.4553e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331448351765
                                         uncertainty =       0.003181584305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331448351765
                                         uncertainty =       0.003181584305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407092664
  error estimate for blocks of size 2^( 2) =       0.000418447033
  error estimate for blocks of size 2^( 3) =       0.000430229317
  error estimate for blocks of size 2^( 4) =       0.000441812878
  error estimate for blocks of size 2^( 5) =       0.000452096446
  error estimate for blocks of size 2^( 6) =       0.000458816136
  error estimate for blocks of size 2^( 7) =       0.000463091099

      target function =                  N/A
              le_mean =     -16.910927315309
             les_mean =     286.310911371547
             stat err =       0.000453954140
             autocorr =       1.243476008902
              std dev =       0.575715966075
             le_variance =       0.331448873594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331448350562
                                         uncertainty =       0.003181584179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331448350562
                                         uncertainty =       0.003181584179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407092663
  error estimate for blocks of size 2^( 2) =       0.000418447032
  error estimate for blocks of size 2^( 3) =       0.000430229316
  error estimate for blocks of size 2^( 4) =       0.000441812877
  error estimate for blocks of size 2^( 5) =       0.000452096445
  error estimate for blocks of size 2^( 6) =       0.000458816135
  error estimate for blocks of size 2^( 7) =       0.000463091098

      target function =                  N/A
              le_mean =     -16.910927315398
             les_mean =     286.310911373340
             stat err =       0.000453954139
             autocorr =       1.243476007171
              std dev =       0.575715965030
             le_variance =       0.331448872390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331448351164
                                         uncertainty =       0.003181584242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331448351164
                                         uncertainty =       0.003181584242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407092663
  error estimate for blocks of size 2^( 2) =       0.000418447032
  error estimate for blocks of size 2^( 3) =       0.000430229317
  error estimate for blocks of size 2^( 4) =       0.000441812878
  error estimate for blocks of size 2^( 5) =       0.000452096445
  error estimate for blocks of size 2^( 6) =       0.000458816136
  error estimate for blocks of size 2^( 7) =       0.000463091099

      target function =                  N/A
              le_mean =     -16.910927315354
             les_mean =     286.310911372443
             stat err =       0.000453954139
             autocorr =       1.243476008032
              std dev =       0.575715965552
             le_variance =       0.331448872992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331448351690
                                         uncertainty =       0.003181584297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331448351690
                                         uncertainty =       0.003181584297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407092664
  error estimate for blocks of size 2^( 2) =       0.000418447033
  error estimate for blocks of size 2^( 3) =       0.000430229317
  error estimate for blocks of size 2^( 4) =       0.000441812878
  error estimate for blocks of size 2^( 5) =       0.000452096446
  error estimate for blocks of size 2^( 6) =       0.000458816136
  error estimate for blocks of size 2^( 7) =       0.000463091099

      target function =                  N/A
              le_mean =     -16.910927315315
             les_mean =     286.310911371659
             stat err =       0.000453954140
             autocorr =       1.243476008792
              std dev =       0.575715966010
             le_variance =       0.331448873519


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910927315309        initial
     9.7656e+03     9.7656e+04             2.1770e-08       -16.910927315398  <--
     3.9062e+04     3.9062e+05             5.4425e-09       -16.910927315354
     1.5625e+05     1.5625e+06             1.3606e-09       -16.910927315315

*****************************************************************************
Applying the update for shift_i =   9.7656e+03     and shift_s =   9.7656e+04
*****************************************************************************

  Execution time = 4.4847e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0114e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9769
    reference variance = 0.422447
====================================================
  Execution time = 2.8221e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3557e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1251e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335599289692
                                         uncertainty =       0.004400858819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335599289692
                                         uncertainty =       0.004400858819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409613703
  error estimate for blocks of size 2^( 2) =       0.000421456064
  error estimate for blocks of size 2^( 3) =       0.000433540805
  error estimate for blocks of size 2^( 4) =       0.000444969200
  error estimate for blocks of size 2^( 5) =       0.000455292381
  error estimate for blocks of size 2^( 6) =       0.000462342939
  error estimate for blocks of size 2^( 7) =       0.000463726779

      target function =                  N/A
              le_mean =     -16.910204281865
             les_mean =     286.290575458137
             stat err =       0.000456582825
             autocorr =       1.242482234214
              std dev =       0.579281254227
             le_variance =       0.335566771498


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691020428187e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910204281865       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910204282074       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910204282160       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910204282109       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910204282448       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910204282473       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910204282432       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910204282415       residual = 5.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 9.999085e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910204281865       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910204281918       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910204281939       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910204281926       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910204282008       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910204282028       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910204282000       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910204282006       residual = 5.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.499802e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910204281865       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910204281878       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910204281884       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910204281881       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910204281913       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910204281889       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910204281901       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910204281913       residual = 5.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 6.249524e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191564 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5353e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714439e-02 1 1  ON 2
 uu_3                -1.665160e-02 1 1  ON 3
 uu_4                -6.730680e-02 1 1  ON 4
 uu_5                -1.046347e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420790e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688546e-02 1 1  ON 12
 ud_3                -2.369285e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521882e-01 1 1  ON 26
 eO_7                -5.286833e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694190e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679742e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470403e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377690e-02 1 1  ON 43
eH2_4                -4.015088e-03 1 1  ON 44
eH2_5                 3.958439e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005585e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9198
    reference variance = 0.203576
====================================================
  Execution time = 2.7518e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3304e-01
  Total weights = 2.0000e+06
  Execution time = 3.4579e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333147503626
                                         uncertainty =       0.004107538373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333147503626
                                         uncertainty =       0.004107538373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408067997
  error estimate for blocks of size 2^( 2) =       0.000419116176
  error estimate for blocks of size 2^( 3) =       0.000430448345
  error estimate for blocks of size 2^( 4) =       0.000441844882
  error estimate for blocks of size 2^( 5) =       0.000450784562
  error estimate for blocks of size 2^( 6) =       0.000457456274
  error estimate for blocks of size 2^( 7) =       0.000458385631

      target function =                  N/A
              le_mean =     -16.910215415091
             les_mean =     286.288424198265
             stat err =       0.000452117837
             autocorr =       1.227547230226
              std dev =       0.577095295427
             le_variance =       0.333038980004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333147464237
                                         uncertainty =       0.004107537923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333147464237
                                         uncertainty =       0.004107537923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408067973
  error estimate for blocks of size 2^( 2) =       0.000419116152
  error estimate for blocks of size 2^( 3) =       0.000430448321
  error estimate for blocks of size 2^( 4) =       0.000441844857
  error estimate for blocks of size 2^( 5) =       0.000450784538
  error estimate for blocks of size 2^( 6) =       0.000457456249
  error estimate for blocks of size 2^( 7) =       0.000458385607

      target function =                  N/A
              le_mean =     -16.910215414982
             les_mean =     286.288424155217
             stat err =       0.000452117813
             autocorr =       1.227547243816
              std dev =       0.577095261316
             le_variance =       0.333038940633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333147483929
                                         uncertainty =       0.004107538148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333147483929
                                         uncertainty =       0.004107538148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408067985
  error estimate for blocks of size 2^( 2) =       0.000419116164
  error estimate for blocks of size 2^( 3) =       0.000430448333
  error estimate for blocks of size 2^( 4) =       0.000441844870
  error estimate for blocks of size 2^( 5) =       0.000450784550
  error estimate for blocks of size 2^( 6) =       0.000457456261
  error estimate for blocks of size 2^( 7) =       0.000458385619

      target function =                  N/A
              le_mean =     -16.910215415037
             les_mean =     286.288424176737
             stat err =       0.000452117825
             autocorr =       1.227547237022
              std dev =       0.577095278369
             le_variance =       0.333038960316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333147501164
                                         uncertainty =       0.004107538344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333147501164
                                         uncertainty =       0.004107538344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408067995
  error estimate for blocks of size 2^( 2) =       0.000419116175
  error estimate for blocks of size 2^( 3) =       0.000430448343
  error estimate for blocks of size 2^( 4) =       0.000441844880
  error estimate for blocks of size 2^( 5) =       0.000450784561
  error estimate for blocks of size 2^( 6) =       0.000457456272
  error estimate for blocks of size 2^( 7) =       0.000458385630

      target function =                  N/A
              le_mean =     -16.910215415084
             les_mean =     286.288424195574
             stat err =       0.000452117836
             autocorr =       1.227547231075
              std dev =       0.577095293295
             le_variance =       0.333038977543


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910215415091        initial  <--
     2.4414e+03     2.4414e+04             9.9991e-08       -16.910215414982
     9.7656e+03     9.7656e+04             2.4998e-08       -16.910215415037
     3.9062e+04     3.9062e+05             6.2495e-09       -16.910215415084

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.9525
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0313e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8674
    reference variance = 0.21222
====================================================
  Execution time = 2.8099e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3627e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.0800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336352256314
                                         uncertainty =       0.005279563498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336352256314
                                         uncertainty =       0.005279563498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410040206
  error estimate for blocks of size 2^( 2) =       0.000421607471
  error estimate for blocks of size 2^( 3) =       0.000433378116
  error estimate for blocks of size 2^( 4) =       0.000444703249
  error estimate for blocks of size 2^( 5) =       0.000455122957
  error estimate for blocks of size 2^( 6) =       0.000461793041
  error estimate for blocks of size 2^( 7) =       0.000467759640

      target function =                  N/A
              le_mean =     -16.909915593522
             les_mean =     286.281511152428
             stat err =       0.000457344722
             autocorr =       1.244040322707
              std dev =       0.579884419969
             le_variance =       0.336265940523


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690991559352e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909915593522       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909915593561       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909915593573       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909915593577       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909915593570       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909915593579       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909915593582       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909915593595       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 7.217687e-09

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909915593522       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909915593532       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909915593535       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909915593536       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909915593537       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909915593586       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909915593547       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909915593526       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 1.804423e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909915593522       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909915593524       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909915593525       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909915593570       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909915593476       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909915593676       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909915593984       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909915593541       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 4.511057e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194262 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5186e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369287e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470402e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8609
    reference variance = 0.545039
====================================================
  Execution time = 2.9602e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.5105e-01
  Total weights = 2.0000e+06
  Execution time = 3.4620e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350965614631
                                         uncertainty =       0.016773321336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350965614631
                                         uncertainty =       0.016773321336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418955188
  error estimate for blocks of size 2^( 2) =       0.000430746112
  error estimate for blocks of size 2^( 3) =       0.000442854844
  error estimate for blocks of size 2^( 4) =       0.000454100520
  error estimate for blocks of size 2^( 5) =       0.000464523903
  error estimate for blocks of size 2^( 6) =       0.000471622925
  error estimate for blocks of size 2^( 7) =       0.000476099764

      target function =                  N/A
              le_mean =     -16.910550623747
             les_mean =     286.317769121956
             stat err =       0.000466586778
             autocorr =       1.240308471023
              std dev =       0.592492108950
             le_variance =       0.351046899169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350965615326
                                         uncertainty =       0.016773321428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350965615326
                                         uncertainty =       0.016773321428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418955188
  error estimate for blocks of size 2^( 2) =       0.000430746112
  error estimate for blocks of size 2^( 3) =       0.000442854844
  error estimate for blocks of size 2^( 4) =       0.000454100520
  error estimate for blocks of size 2^( 5) =       0.000464523903
  error estimate for blocks of size 2^( 6) =       0.000471622925
  error estimate for blocks of size 2^( 7) =       0.000476099764

      target function =                  N/A
              le_mean =     -16.910550623729
             les_mean =     286.317769122033
             stat err =       0.000466586778
             autocorr =       1.240308468683
              std dev =       0.592492109536
             le_variance =       0.351046899862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350965614979
                                         uncertainty =       0.016773321382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350965614979
                                         uncertainty =       0.016773321382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418955188
  error estimate for blocks of size 2^( 2) =       0.000430746112
  error estimate for blocks of size 2^( 3) =       0.000442854844
  error estimate for blocks of size 2^( 4) =       0.000454100520
  error estimate for blocks of size 2^( 5) =       0.000464523903
  error estimate for blocks of size 2^( 6) =       0.000471622925
  error estimate for blocks of size 2^( 7) =       0.000476099764

      target function =                  N/A
              le_mean =     -16.910550623738
             les_mean =     286.317769121994
             stat err =       0.000466586778
             autocorr =       1.240308469855
              std dev =       0.592492109243
             le_variance =       0.351046899515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350965614675
                                         uncertainty =       0.016773321342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350965614675
                                         uncertainty =       0.016773321342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418955188
  error estimate for blocks of size 2^( 2) =       0.000430746112
  error estimate for blocks of size 2^( 3) =       0.000442854844
  error estimate for blocks of size 2^( 4) =       0.000454100520
  error estimate for blocks of size 2^( 5) =       0.000464523903
  error estimate for blocks of size 2^( 6) =       0.000471622925
  error estimate for blocks of size 2^( 7) =       0.000476099764

      target function =                  N/A
              le_mean =     -16.910550623746
             les_mean =     286.317769121961
             stat err =       0.000466586778
             autocorr =       1.240308470880
              std dev =       0.592492108987
             le_variance =       0.351046899212


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910550623747        initial  <--
     2.4414e+04     2.4414e+05             7.2177e-09       -16.910550623729
     9.7656e+04     9.7656e+05             1.8044e-09       -16.910550623738
     3.9062e+05     3.9062e+06             4.5111e-10       -16.910550623746

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.0227
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2217e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.0037
    reference variance = 0.370843
====================================================
  Execution time = 2.9010e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3982e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1741e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339701495292
                                         uncertainty =       0.005145323425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339701495292
                                         uncertainty =       0.005145323425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412202398
  error estimate for blocks of size 2^( 2) =       0.000423704702
  error estimate for blocks of size 2^( 3) =       0.000435945325
  error estimate for blocks of size 2^( 4) =       0.000447473842
  error estimate for blocks of size 2^( 5) =       0.000457086667
  error estimate for blocks of size 2^( 6) =       0.000465186877
  error estimate for blocks of size 2^( 7) =       0.000471505957

      target function =                  N/A
              le_mean =     -16.910084994892
             les_mean =     286.290795998125
             stat err =       0.000460313336
             autocorr =       1.247056373622
              std dev =       0.582942221466
             le_variance =       0.339821633568


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691008499489e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910084994892       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910084994899       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910084994899       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910084994958       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910084994969       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910084994879       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910084994792       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910084995121       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 1.123760e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910084994892       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910084994894       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910084994894       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910084994894       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910084994894       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910084994795       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910084994771       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910084994894       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 2.809400e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910084994892       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910084994892       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910084994892       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910084995042       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910084995623       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910084996649       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910084992707       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910084996409       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 7.023510e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196948 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6191e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.852
    reference variance = 0.236799
====================================================
  Execution time = 2.7922e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3851e-01
  Total weights = 2.0000e+06
  Execution time = 3.4618e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338333231640
                                         uncertainty =       0.004414041971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338333231640
                                         uncertainty =       0.004414041971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411407607
  error estimate for blocks of size 2^( 2) =       0.000423474394
  error estimate for blocks of size 2^( 3) =       0.000435946817
  error estimate for blocks of size 2^( 4) =       0.000448106184
  error estimate for blocks of size 2^( 5) =       0.000459912587
  error estimate for blocks of size 2^( 6) =       0.000469038453
  error estimate for blocks of size 2^( 7) =       0.000473014038

      target function =                  N/A
              le_mean =     -16.909171157787
             les_mean =     286.258581512959
             stat err =       0.000462517816
             autocorr =       1.263898782483
              std dev =       0.581818218060
             le_variance =       0.338512438866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338333230963
                                         uncertainty =       0.004414041970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338333230963
                                         uncertainty =       0.004414041970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411407607
  error estimate for blocks of size 2^( 2) =       0.000423474394
  error estimate for blocks of size 2^( 3) =       0.000435946816
  error estimate for blocks of size 2^( 4) =       0.000448106184
  error estimate for blocks of size 2^( 5) =       0.000459912587
  error estimate for blocks of size 2^( 6) =       0.000469038452
  error estimate for blocks of size 2^( 7) =       0.000473014038

      target function =                  N/A
              le_mean =     -16.909171157786
             les_mean =     286.258581512227
             stat err =       0.000462517815
             autocorr =       1.263898783087
              std dev =       0.581818217477
             le_variance =       0.338512438188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338333231302
                                         uncertainty =       0.004414041971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338333231302
                                         uncertainty =       0.004414041971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411407607
  error estimate for blocks of size 2^( 2) =       0.000423474394
  error estimate for blocks of size 2^( 3) =       0.000435946817
  error estimate for blocks of size 2^( 4) =       0.000448106184
  error estimate for blocks of size 2^( 5) =       0.000459912587
  error estimate for blocks of size 2^( 6) =       0.000469038452
  error estimate for blocks of size 2^( 7) =       0.000473014038

      target function =                  N/A
              le_mean =     -16.909171157787
             les_mean =     286.258581512593
             stat err =       0.000462517815
             autocorr =       1.263898782797
              std dev =       0.581818217768
             le_variance =       0.338512438527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338333231598
                                         uncertainty =       0.004414041971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338333231598
                                         uncertainty =       0.004414041971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411407607
  error estimate for blocks of size 2^( 2) =       0.000423474394
  error estimate for blocks of size 2^( 3) =       0.000435946817
  error estimate for blocks of size 2^( 4) =       0.000448106184
  error estimate for blocks of size 2^( 5) =       0.000459912587
  error estimate for blocks of size 2^( 6) =       0.000469038453
  error estimate for blocks of size 2^( 7) =       0.000473014038

      target function =                  N/A
              le_mean =     -16.909171157787
             les_mean =     286.258581512913
             stat err =       0.000462517815
             autocorr =       1.263898782526
              std dev =       0.581818218023
             le_variance =       0.338512438824


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909171157787        initial  <--
     2.4414e+05     2.4414e+06             1.1238e-09       -16.909171157786
     9.7656e+05     9.7656e+06             2.8094e-10       -16.909171157787
     3.9062e+06     3.9062e+07             7.0235e-11       -16.909171157787

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.3574
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1573e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8913
    reference variance = 0.457587
====================================================
  Execution time = 2.8539e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4430e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2207e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344322290608
                                         uncertainty =       0.007963040786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344322290608
                                         uncertainty =       0.007963040786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414911429
  error estimate for blocks of size 2^( 2) =       0.000426528025
  error estimate for blocks of size 2^( 3) =       0.000438211703
  error estimate for blocks of size 2^( 4) =       0.000449169489
  error estimate for blocks of size 2^( 5) =       0.000459026982
  error estimate for blocks of size 2^( 6) =       0.000465096909
  error estimate for blocks of size 2^( 7) =       0.000469781573

      target function =                  N/A
              le_mean =     -16.911044904724
             les_mean =     286.327742585167
             stat err =       0.000460768738
             autocorr =       1.233261619413
              std dev =       0.586773369976
             le_variance =       0.344302987713


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691104490472e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911044904724       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911044904724       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911044904725       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911044904724       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911044904725       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911044903606       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911044904531       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911044904716       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 1.013537e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911044904724       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911044904724       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911044904724       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911044904724       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911044904103       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911044904157       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911044904138       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911044914714       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 2.533847e-11

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911044904724       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911044904724       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911044904724       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911044909978       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911044906067       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911044893535       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911044975447       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911044908529       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+07 is 6.334723e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199614 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5766e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.7341
    reference variance = 0.702798
====================================================
  Execution time = 2.7567e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3138e-01
  Total weights = 2.0000e+06
  Execution time = 3.4664e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331400686711
                                         uncertainty =       0.002828990527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331400686711
                                         uncertainty =       0.002828990527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407049850
  error estimate for blocks of size 2^( 2) =       0.000418877967
  error estimate for blocks of size 2^( 3) =       0.000430915509
  error estimate for blocks of size 2^( 4) =       0.000442813901
  error estimate for blocks of size 2^( 5) =       0.000453184522
  error estimate for blocks of size 2^( 6) =       0.000460882826
  error estimate for blocks of size 2^( 7) =       0.000466762938

      target function =                  N/A
              le_mean =     -16.909827881719
             les_mean =     286.273657984883
             stat err =       0.000455911047
             autocorr =       1.254483725729
              std dev =       0.575655418804
             le_variance =       0.331379161198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331400686766
                                         uncertainty =       0.002828990528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331400686766
                                         uncertainty =       0.002828990528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407049850
  error estimate for blocks of size 2^( 2) =       0.000418877967
  error estimate for blocks of size 2^( 3) =       0.000430915509
  error estimate for blocks of size 2^( 4) =       0.000442813901
  error estimate for blocks of size 2^( 5) =       0.000453184522
  error estimate for blocks of size 2^( 6) =       0.000460882826
  error estimate for blocks of size 2^( 7) =       0.000466762938

      target function =                  N/A
              le_mean =     -16.909827881719
             les_mean =     286.273657984940
             stat err =       0.000455911047
             autocorr =       1.254483725648
              std dev =       0.575655418852
             le_variance =       0.331379161253

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331400686739
                                         uncertainty =       0.002828990527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331400686739
                                         uncertainty =       0.002828990527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407049850
  error estimate for blocks of size 2^( 2) =       0.000418877967
  error estimate for blocks of size 2^( 3) =       0.000430915509
  error estimate for blocks of size 2^( 4) =       0.000442813901
  error estimate for blocks of size 2^( 5) =       0.000453184522
  error estimate for blocks of size 2^( 6) =       0.000460882826
  error estimate for blocks of size 2^( 7) =       0.000466762938

      target function =                  N/A
              le_mean =     -16.909827881719
             les_mean =     286.273657984911
             stat err =       0.000455911047
             autocorr =       1.254483725684
              std dev =       0.575655418828
             le_variance =       0.331379161226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331400686715
                                         uncertainty =       0.002828990527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331400686715
                                         uncertainty =       0.002828990527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407049850
  error estimate for blocks of size 2^( 2) =       0.000418877967
  error estimate for blocks of size 2^( 3) =       0.000430915509
  error estimate for blocks of size 2^( 4) =       0.000442813901
  error estimate for blocks of size 2^( 5) =       0.000453184522
  error estimate for blocks of size 2^( 6) =       0.000460882826
  error estimate for blocks of size 2^( 7) =       0.000466762938

      target function =                  N/A
              le_mean =     -16.909827881719
             les_mean =     286.273657984886
             stat err =       0.000455911047
             autocorr =       1.254483725725
              std dev =       0.575655418807
             le_variance =       0.331379161201


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909827881719        initial
     2.4414e+06     2.4414e+07             1.0135e-10       -16.909827881719  <--
     9.7656e+06     9.7656e+07             2.5338e-11       -16.909827881719
     3.9062e+07     3.9062e+08             6.3347e-12       -16.909827881719

*****************************************************************************
Applying the update for shift_i =   2.4414e+06     and shift_s =   2.4414e+07
*****************************************************************************

  Execution time = 4.4947e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0722e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9342
    reference variance = 0.340112
====================================================
  Execution time = 2.8005e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.5666e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2306e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356726565270
                                         uncertainty =       0.010816286364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356726565270
                                         uncertainty =       0.010816286364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422292066
  error estimate for blocks of size 2^( 2) =       0.000434048984
  error estimate for blocks of size 2^( 3) =       0.000445860124
  error estimate for blocks of size 2^( 4) =       0.000456986651
  error estimate for blocks of size 2^( 5) =       0.000467301678
  error estimate for blocks of size 2^( 6) =       0.000475117945
  error estimate for blocks of size 2^( 7) =       0.000476261010

      target function =                  N/A
              le_mean =     -16.909648951953
             les_mean =     286.292888678798
             stat err =       0.000468916821
             autocorr =       1.233007673165
              std dev =       0.597211167720
             le_variance =       0.356661178850


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690964895195e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909648951953       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909648951954       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909648951955       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909648951955       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909648951669       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909648952192       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909648952396       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909648952017       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 3.607446e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909648951953       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909648951953       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909648951953       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909648952409       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909648954218       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909648950765       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909648950701       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909648949139       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 9.018622e-11

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909648951953       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909648951953       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909648951953       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909648946697       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909648957955       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909648951175       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909648965582       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909648949729       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 2.254659e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.202333 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5242e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8816
    reference variance = 0.242556
====================================================
  Execution time = 2.7454e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4149e-01
  Total weights = 2.0000e+06
  Execution time = 3.4586e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341565152911
                                         uncertainty =       0.006456076251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341565152911
                                         uncertainty =       0.006456076251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413212507
  error estimate for blocks of size 2^( 2) =       0.000424943428
  error estimate for blocks of size 2^( 3) =       0.000436706204
  error estimate for blocks of size 2^( 4) =       0.000448045701
  error estimate for blocks of size 2^( 5) =       0.000458726181
  error estimate for blocks of size 2^( 6) =       0.000465823480
  error estimate for blocks of size 2^( 7) =       0.000469799204

      target function =                  N/A
              le_mean =     -16.909615658834
             les_mean =     286.276590711374
             stat err =       0.000460598642
             autocorr =       1.242505695901
              std dev =       0.584370732181
             le_variance =       0.341489152630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341565152943
                                         uncertainty =       0.006456076253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341565152943
                                         uncertainty =       0.006456076253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413212507
  error estimate for blocks of size 2^( 2) =       0.000424943428
  error estimate for blocks of size 2^( 3) =       0.000436706204
  error estimate for blocks of size 2^( 4) =       0.000448045701
  error estimate for blocks of size 2^( 5) =       0.000458726181
  error estimate for blocks of size 2^( 6) =       0.000465823480
  error estimate for blocks of size 2^( 7) =       0.000469799204

      target function =                  N/A
              le_mean =     -16.909615658833
             les_mean =     286.276590711382
             stat err =       0.000460598642
             autocorr =       1.242505695828
              std dev =       0.584370732208
             le_variance =       0.341489152662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341565152927
                                         uncertainty =       0.006456076252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341565152927
                                         uncertainty =       0.006456076252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413212507
  error estimate for blocks of size 2^( 2) =       0.000424943428
  error estimate for blocks of size 2^( 3) =       0.000436706204
  error estimate for blocks of size 2^( 4) =       0.000448045701
  error estimate for blocks of size 2^( 5) =       0.000458726181
  error estimate for blocks of size 2^( 6) =       0.000465823480
  error estimate for blocks of size 2^( 7) =       0.000469799204

      target function =                  N/A
              le_mean =     -16.909615658834
             les_mean =     286.276590711378
             stat err =       0.000460598642
             autocorr =       1.242505695860
              std dev =       0.584370732195
             le_variance =       0.341489152646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341565152913
                                         uncertainty =       0.006456076251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341565152913
                                         uncertainty =       0.006456076251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413212507
  error estimate for blocks of size 2^( 2) =       0.000424943428
  error estimate for blocks of size 2^( 3) =       0.000436706204
  error estimate for blocks of size 2^( 4) =       0.000448045701
  error estimate for blocks of size 2^( 5) =       0.000458726181
  error estimate for blocks of size 2^( 6) =       0.000465823480
  error estimate for blocks of size 2^( 7) =       0.000469799204

      target function =                  N/A
              le_mean =     -16.909615658834
             les_mean =     286.276590711375
             stat err =       0.000460598642
             autocorr =       1.242505695900
              std dev =       0.584370732183
             le_variance =       0.341489152632


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909615658834        initial  <--
     6.1035e+05     6.1035e+06             3.6074e-10       -16.909615658833
     2.4414e+06     2.4414e+07             9.0186e-11       -16.909615658834
     9.7656e+06     9.7656e+07             2.2547e-11       -16.909615658834

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.8407
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0090e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9337
    reference variance = 0.442531
====================================================
  Execution time = 2.9146e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4133e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.3252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341439870000
                                         uncertainty =       0.004159543479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341439870000
                                         uncertainty =       0.004159543479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413118598
  error estimate for blocks of size 2^( 2) =       0.000424379185
  error estimate for blocks of size 2^( 3) =       0.000436469824
  error estimate for blocks of size 2^( 4) =       0.000447141973
  error estimate for blocks of size 2^( 5) =       0.000456203633
  error estimate for blocks of size 2^( 6) =       0.000465574095
  error estimate for blocks of size 2^( 7) =       0.000470070665

      target function =                  N/A
              le_mean =     -16.910230496638
             les_mean =     286.297229231370
             stat err =       0.000459747591
             autocorr =       1.238481235005
              std dev =       0.584237924664
             le_variance =       0.341333952616


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691023049664e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910230496638       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910230496638       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910230496638       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910230496638       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910230496895       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910230495694       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910230503754       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910230493770       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 3.287810e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910230496638       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910230496638       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910230496638       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910230491757       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910230496643       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910230496890       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910230497513       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910230497364       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 8.219566e-12

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910230496638       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910230496638       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910230496638       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910230513364       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910230513324       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910230527906       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910230524105       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910230599641       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 2.054785e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205015 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6478e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8657
    reference variance = 0.202614
====================================================
  Execution time = 2.7523e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4424e-01
  Total weights = 2.0000e+06
  Execution time = 3.4656e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344235602497
                                         uncertainty =       0.004945042211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344235602497
                                         uncertainty =       0.004945042211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414872221
  error estimate for blocks of size 2^( 2) =       0.000426902897
  error estimate for blocks of size 2^( 3) =       0.000438902827
  error estimate for blocks of size 2^( 4) =       0.000450394154
  error estimate for blocks of size 2^( 5) =       0.000460754579
  error estimate for blocks of size 2^( 6) =       0.000469693345
  error estimate for blocks of size 2^( 7) =       0.000473952035

      target function =                  N/A
              le_mean =     -16.910520381674
             les_mean =     286.309937326156
             stat err =       0.000463698528
             autocorr =       1.249230912715
              std dev =       0.586717921379
             le_variance =       0.344237919267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344235602490
                                         uncertainty =       0.004945042211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344235602490
                                         uncertainty =       0.004945042211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414872221
  error estimate for blocks of size 2^( 2) =       0.000426902897
  error estimate for blocks of size 2^( 3) =       0.000438902827
  error estimate for blocks of size 2^( 4) =       0.000450394154
  error estimate for blocks of size 2^( 5) =       0.000460754579
  error estimate for blocks of size 2^( 6) =       0.000469693345
  error estimate for blocks of size 2^( 7) =       0.000473952035

      target function =                  N/A
              le_mean =     -16.910520381674
             les_mean =     286.309937326152
             stat err =       0.000463698528
             autocorr =       1.249230912710
              std dev =       0.586717921373
             le_variance =       0.344237919260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344235602493
                                         uncertainty =       0.004945042211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344235602493
                                         uncertainty =       0.004945042211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414872221
  error estimate for blocks of size 2^( 2) =       0.000426902897
  error estimate for blocks of size 2^( 3) =       0.000438902827
  error estimate for blocks of size 2^( 4) =       0.000450394154
  error estimate for blocks of size 2^( 5) =       0.000460754579
  error estimate for blocks of size 2^( 6) =       0.000469693345
  error estimate for blocks of size 2^( 7) =       0.000473952035

      target function =                  N/A
              le_mean =     -16.910520381674
             les_mean =     286.309937326154
             stat err =       0.000463698528
             autocorr =       1.249230912719
              std dev =       0.586717921376
             le_variance =       0.344237919263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344235602496
                                         uncertainty =       0.004945042211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344235602496
                                         uncertainty =       0.004945042211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414872221
  error estimate for blocks of size 2^( 2) =       0.000426902897
  error estimate for blocks of size 2^( 3) =       0.000438902827
  error estimate for blocks of size 2^( 4) =       0.000450394154
  error estimate for blocks of size 2^( 5) =       0.000460754579
  error estimate for blocks of size 2^( 6) =       0.000469693345
  error estimate for blocks of size 2^( 7) =       0.000473952035

      target function =                  N/A
              le_mean =     -16.910520381674
             les_mean =     286.309937326156
             stat err =       0.000463698528
             autocorr =       1.249230912715
              std dev =       0.586717921378
             le_variance =       0.344237919267


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910520381674        initial
     6.1035e+06     6.1035e+07             3.2878e-11       -16.910520381674  <--
     2.4414e+07     2.4414e+08             8.2196e-12       -16.910520381674
     9.7656e+07     9.7656e+08             2.0548e-12       -16.910520381674

*****************************************************************************
Applying the update for shift_i =   6.1035e+06     and shift_s =   6.1035e+07
*****************************************************************************

  Execution time = 4.4983e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1469e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9529
    reference variance = 0.399174
====================================================
  Execution time = 2.8129e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4475e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2548e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344900664848
                                         uncertainty =       0.004239633367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344900664848
                                         uncertainty =       0.004239633367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415183610
  error estimate for blocks of size 2^( 2) =       0.000427281685
  error estimate for blocks of size 2^( 3) =       0.000439014922
  error estimate for blocks of size 2^( 4) =       0.000450930955
  error estimate for blocks of size 2^( 5) =       0.000463006180
  error estimate for blocks of size 2^( 6) =       0.000472990512
  error estimate for blocks of size 2^( 7) =       0.000478707141

      target function =                  N/A
              le_mean =     -16.910846666390
             les_mean =     286.321489661367
             stat err =       0.000466408697
             autocorr =       1.261981181810
              std dev =       0.587158291774
             le_variance =       0.344754859599


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691084666639e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910846666390       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910846666390       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910846666390       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910846666390       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910846666212       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910846666397       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910846666390       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910846666393       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.158370e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910846666390       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910846666390       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910846666390       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910846666338       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910846666390       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910846666765       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910846664334       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910846666141       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 2.895934e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910846666390       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910846666390       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910846666390       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910846666390       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910846668532       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910846668558       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910846662410       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910846668315       residual = 4.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 7.239849e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207669 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5391e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8822
    reference variance = 0.192039
====================================================
  Execution time = 2.7599e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4637e-01
  Total weights = 2.0000e+06
  Execution time = 3.4620e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346519917354
                                         uncertainty =       0.005552632482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346519917354
                                         uncertainty =       0.005552632482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416155894
  error estimate for blocks of size 2^( 2) =       0.000427897858
  error estimate for blocks of size 2^( 3) =       0.000440185759
  error estimate for blocks of size 2^( 4) =       0.000451830115
  error estimate for blocks of size 2^( 5) =       0.000462172335
  error estimate for blocks of size 2^( 6) =       0.000469315043
  error estimate for blocks of size 2^( 7) =       0.000473601972

      target function =                  N/A
              le_mean =     -16.910872555361
             les_mean =     286.323981866460
             stat err =       0.000464229866
             autocorr =       1.244382960148
              std dev =       0.588533309166
             le_variance =       0.346371455998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346519917300
                                         uncertainty =       0.005552632481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346519917300
                                         uncertainty =       0.005552632481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416155894
  error estimate for blocks of size 2^( 2) =       0.000427897858
  error estimate for blocks of size 2^( 3) =       0.000440185758
  error estimate for blocks of size 2^( 4) =       0.000451830115
  error estimate for blocks of size 2^( 5) =       0.000462172335
  error estimate for blocks of size 2^( 6) =       0.000469315043
  error estimate for blocks of size 2^( 7) =       0.000473601972

      target function =                  N/A
              le_mean =     -16.910872555360
             les_mean =     286.323981866391
             stat err =       0.000464229866
             autocorr =       1.244382960187
              std dev =       0.588533309120
             le_variance =       0.346371455944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346519917327
                                         uncertainty =       0.005552632482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346519917327
                                         uncertainty =       0.005552632482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416155894
  error estimate for blocks of size 2^( 2) =       0.000427897858
  error estimate for blocks of size 2^( 3) =       0.000440185759
  error estimate for blocks of size 2^( 4) =       0.000451830115
  error estimate for blocks of size 2^( 5) =       0.000462172335
  error estimate for blocks of size 2^( 6) =       0.000469315043
  error estimate for blocks of size 2^( 7) =       0.000473601972

      target function =                  N/A
              le_mean =     -16.910872555360
             les_mean =     286.323981866426
             stat err =       0.000464229866
             autocorr =       1.244382960167
              std dev =       0.588533309143
             le_variance =       0.346371455971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346519917351
                                         uncertainty =       0.005552632482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346519917351
                                         uncertainty =       0.005552632482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416155894
  error estimate for blocks of size 2^( 2) =       0.000427897858
  error estimate for blocks of size 2^( 3) =       0.000440185759
  error estimate for blocks of size 2^( 4) =       0.000451830115
  error estimate for blocks of size 2^( 5) =       0.000462172335
  error estimate for blocks of size 2^( 6) =       0.000469315043
  error estimate for blocks of size 2^( 7) =       0.000473601972

      target function =                  N/A
              le_mean =     -16.910872555361
             les_mean =     286.323981866456
             stat err =       0.000464229866
             autocorr =       1.244382960155
              std dev =       0.588533309163
             le_variance =       0.346371455994


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910872555361        initial  <--
     1.5259e+06     1.5259e+07             1.1584e-10       -16.910872555360
     6.1035e+06     6.1035e+07             2.8959e-11       -16.910872555360
     2.4414e+07     2.4414e+08             7.2398e-12       -16.910872555361

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.9462
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0345e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9006
    reference variance = 0.168128
====================================================
  Execution time = 2.7917e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3334e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2206e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333245347126
                                         uncertainty =       0.004200523618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333245347126
                                         uncertainty =       0.004200523618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408252896
  error estimate for blocks of size 2^( 2) =       0.000420044244
  error estimate for blocks of size 2^( 3) =       0.000431799348
  error estimate for blocks of size 2^( 4) =       0.000444421655
  error estimate for blocks of size 2^( 5) =       0.000455813006
  error estimate for blocks of size 2^( 6) =       0.000463937824
  error estimate for blocks of size 2^( 7) =       0.000467536053

      target function =                  N/A
              le_mean =     -16.911242056347
             les_mean =     286.323448575684
             stat err =       0.000457927135
             autocorr =       1.258155177239
              std dev =       0.577356782244
             le_variance =       0.333340854004


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691124205635e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911242056347       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911242056347       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911242056347       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911242056347       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911242056202       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911242072531       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911242050574       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911242051385       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 1.439976e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911242056347       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911242056347       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911242056347       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911242056347       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911242034962       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911242076906       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911242044107       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911242049189       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 3.599935e-12

solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911242056347       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911242056347       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911242056347       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911242056347       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911242056347       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911242006789       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911242176250       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911242225388       residual = 3.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+08 is 8.999303e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.210392 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5145e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8998
    reference variance = 0.243806
====================================================
  Execution time = 2.7453e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.5176e-01
  Total weights = 2.0000e+06
  Execution time = 3.4593e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351840955946
                                         uncertainty =       0.013225846731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351840955946
                                         uncertainty =       0.013225846731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419381232
  error estimate for blocks of size 2^( 2) =       0.000430882950
  error estimate for blocks of size 2^( 3) =       0.000442602460
  error estimate for blocks of size 2^( 4) =       0.000453788861
  error estimate for blocks of size 2^( 5) =       0.000463946760
  error estimate for blocks of size 2^( 6) =       0.000471376084
  error estimate for blocks of size 2^( 7) =       0.000474968622

      target function =                  N/A
              le_mean =     -16.911439853984
             les_mean =     286.348558994400
             stat err =       0.000466020082
             autocorr =       1.234784817615
              std dev =       0.593094625976
             le_variance =       0.351761235362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351840955938
                                         uncertainty =       0.013225846731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351840955938
                                         uncertainty =       0.013225846731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419381232
  error estimate for blocks of size 2^( 2) =       0.000430882950
  error estimate for blocks of size 2^( 3) =       0.000442602460
  error estimate for blocks of size 2^( 4) =       0.000453788861
  error estimate for blocks of size 2^( 5) =       0.000463946760
  error estimate for blocks of size 2^( 6) =       0.000471376084
  error estimate for blocks of size 2^( 7) =       0.000474968622

      target function =                  N/A
              le_mean =     -16.911439853984
             les_mean =     286.348558994391
             stat err =       0.000466020082
             autocorr =       1.234784817608
              std dev =       0.593094625970
             le_variance =       0.351761235355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351840955942
                                         uncertainty =       0.013225846731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351840955942
                                         uncertainty =       0.013225846731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419381232
  error estimate for blocks of size 2^( 2) =       0.000430882950
  error estimate for blocks of size 2^( 3) =       0.000442602460
  error estimate for blocks of size 2^( 4) =       0.000453788861
  error estimate for blocks of size 2^( 5) =       0.000463946760
  error estimate for blocks of size 2^( 6) =       0.000471376084
  error estimate for blocks of size 2^( 7) =       0.000474968622

      target function =                  N/A
              le_mean =     -16.911439853984
             les_mean =     286.348558994396
             stat err =       0.000466020082
             autocorr =       1.234784817609
              std dev =       0.593094625973
             le_variance =       0.351761235359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351840955945
                                         uncertainty =       0.013225846731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351840955945
                                         uncertainty =       0.013225846731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419381232
  error estimate for blocks of size 2^( 2) =       0.000430882950
  error estimate for blocks of size 2^( 3) =       0.000442602460
  error estimate for blocks of size 2^( 4) =       0.000453788861
  error estimate for blocks of size 2^( 5) =       0.000463946760
  error estimate for blocks of size 2^( 6) =       0.000471376084
  error estimate for blocks of size 2^( 7) =       0.000474968622

      target function =                  N/A
              le_mean =     -16.911439853984
             les_mean =     286.348558994400
             stat err =       0.000466020082
             autocorr =       1.234784817611
              std dev =       0.593094625976
             le_variance =       0.351761235362


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911439853984        initial  <--
     1.5259e+07     1.5259e+08             1.4400e-11       -16.911439853984
     6.1035e+07     6.1035e+08             3.5999e-12       -16.911439853984
     2.4414e+08     2.4414e+09             8.9993e-13       -16.911439853984

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.8536
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0006e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8637
    reference variance = 0.330757
====================================================
  Execution time = 2.8119e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3971e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1625e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339790731658
                                         uncertainty =       0.005180869887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339790731658
                                         uncertainty =       0.005180869887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412135212
  error estimate for blocks of size 2^( 2) =       0.000423798571
  error estimate for blocks of size 2^( 3) =       0.000436032419
  error estimate for blocks of size 2^( 4) =       0.000448477357
  error estimate for blocks of size 2^( 5) =       0.000459037132
  error estimate for blocks of size 2^( 6) =       0.000467917171
  error estimate for blocks of size 2^( 7) =       0.000471334784

      target function =                  N/A
              le_mean =     -16.909968051141
             les_mean =     286.286730186942
             stat err =       0.000461691611
             autocorr =       1.254944511703
              std dev =       0.582847206559
             le_variance =       0.339710866194


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690996805114e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909968051141       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909968051141       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909968051141       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909967984437       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909968021155       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909968091355       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909968037854       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909968146983       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+08 is 1.592898e-12

solving harmonic davidson linear method for identity shift 6.1035e+08, overlap shift 6.1035e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909968051141       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909968051141       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909968051141       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909968152546       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909968297356       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909968708942       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909968289009       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909968097773       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+08 is 3.985330e-13

solving harmonic davidson linear method for identity shift 2.4414e+09, overlap shift 2.4414e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909968051141       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909968051141       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909968051141       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909966275849       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909968051426       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909969026196       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909966475672       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909967480754       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+09 is 9.953760e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213110 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5289e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8364
    reference variance = 0.209469
====================================================
  Execution time = 2.7665e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4568e-01
  Total weights = 2.0000e+06
  Execution time = 3.4497e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345606533685
                                         uncertainty =       0.010896156075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345606533685
                                         uncertainty =       0.010896156075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415739690
  error estimate for blocks of size 2^( 2) =       0.000426944737
  error estimate for blocks of size 2^( 3) =       0.000438839448
  error estimate for blocks of size 2^( 4) =       0.000450221885
  error estimate for blocks of size 2^( 5) =       0.000460537907
  error estimate for blocks of size 2^( 6) =       0.000468441477
  error estimate for blocks of size 2^( 7) =       0.000471832137

      target function =                  N/A
              le_mean =     -16.910787548649
             les_mean =     286.320414322763
             stat err =       0.000462758351
             autocorr =       1.238983589751
              std dev =       0.587944708335
             le_variance =       0.345678980060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345606533685
                                         uncertainty =       0.010896156075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345606533685
                                         uncertainty =       0.010896156075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415739690
  error estimate for blocks of size 2^( 2) =       0.000426944737
  error estimate for blocks of size 2^( 3) =       0.000438839448
  error estimate for blocks of size 2^( 4) =       0.000450221885
  error estimate for blocks of size 2^( 5) =       0.000460537907
  error estimate for blocks of size 2^( 6) =       0.000468441477
  error estimate for blocks of size 2^( 7) =       0.000471832137

      target function =                  N/A
              le_mean =     -16.910787548649
             les_mean =     286.320414322763
             stat err =       0.000462758351
             autocorr =       1.238983589749
              std dev =       0.587944708336
             le_variance =       0.345678980060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345606533685
                                         uncertainty =       0.010896156075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345606533685
                                         uncertainty =       0.010896156075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415739690
  error estimate for blocks of size 2^( 2) =       0.000426944737
  error estimate for blocks of size 2^( 3) =       0.000438839448
  error estimate for blocks of size 2^( 4) =       0.000450221885
  error estimate for blocks of size 2^( 5) =       0.000460537907
  error estimate for blocks of size 2^( 6) =       0.000468441477
  error estimate for blocks of size 2^( 7) =       0.000471832137

      target function =                  N/A
              le_mean =     -16.910787548649
             les_mean =     286.320414322763
             stat err =       0.000462758351
             autocorr =       1.238983589748
              std dev =       0.587944708336
             le_variance =       0.345678980060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345606533685
                                         uncertainty =       0.010896156075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345606533685
                                         uncertainty =       0.010896156075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415739690
  error estimate for blocks of size 2^( 2) =       0.000426944737
  error estimate for blocks of size 2^( 3) =       0.000438839448
  error estimate for blocks of size 2^( 4) =       0.000450221885
  error estimate for blocks of size 2^( 5) =       0.000460537907
  error estimate for blocks of size 2^( 6) =       0.000468441477
  error estimate for blocks of size 2^( 7) =       0.000471832137

      target function =                  N/A
              le_mean =     -16.910787548649
             les_mean =     286.320414322763
             stat err =       0.000462758351
             autocorr =       1.238983589755
              std dev =       0.587944708336
             le_variance =       0.345678980060


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910787548649        initial  <--
     1.5259e+08     1.5259e+09             1.5929e-12       -16.910787548649
     6.1035e+08     6.1035e+09             3.9853e-13       -16.910787548649
     2.4414e+09     2.4414e+10             9.9538e-14       -16.910787548649

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0885
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0385e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.954
    reference variance = 0.261234
====================================================
  Execution time = 3.0044e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3961e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1209e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339686841402
                                         uncertainty =       0.004469970567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339686841402
                                         uncertainty =       0.004469970567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412071400
  error estimate for blocks of size 2^( 2) =       0.000423411992
  error estimate for blocks of size 2^( 3) =       0.000434692325
  error estimate for blocks of size 2^( 4) =       0.000446249456
  error estimate for blocks of size 2^( 5) =       0.000456196233
  error estimate for blocks of size 2^( 6) =       0.000461444683
  error estimate for blocks of size 2^( 7) =       0.000465801836

      target function =                  N/A
              le_mean =     -16.910635492233
             les_mean =     286.309198258253
             stat err =       0.000457423052
             autocorr =       1.232228215221
              std dev =       0.582756962115
             le_variance =       0.339605676894


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691063549223e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+09, overlap shift 1.5259e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910635492233       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910635492233       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910635492233       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910635699967       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910636521082       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910636833424       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910635264516       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910635321833       residual = 5.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+09 is 1.613190e-13

solving harmonic davidson linear method for identity shift 6.1035e+09, overlap shift 6.1035e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910635492233       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910635492233       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910635492233       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910635492233       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910635775035       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910638008170       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910635116275       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910636021143       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+09 is 4.033657e-14

solving harmonic davidson linear method for identity shift 2.4414e+10, overlap shift 2.4414e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910635492233       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910635492233       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910635492233       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910635492233       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910627563237       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910636500751       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910641850258       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910637212459       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+10 is 1.009038e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.215801 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7172e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8574
    reference variance = 0.295859
====================================================
  Execution time = 2.7444e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3284e-01
  Total weights = 2.0000e+06
  Execution time = 3.4582e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332818280472
                                         uncertainty =       0.004124778707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332818280472
                                         uncertainty =       0.004124778707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407945666
  error estimate for blocks of size 2^( 2) =       0.000419782853
  error estimate for blocks of size 2^( 3) =       0.000432012146
  error estimate for blocks of size 2^( 4) =       0.000443785103
  error estimate for blocks of size 2^( 5) =       0.000453544420
  error estimate for blocks of size 2^( 6) =       0.000461078234
  error estimate for blocks of size 2^( 7) =       0.000464541025

      target function =                  N/A
              le_mean =     -16.909677341393
             les_mean =     286.270026956977
             stat err =       0.000455737195
             autocorr =       1.248027925106
              std dev =       0.576922294063
             le_variance =       0.332839333387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332818280472
                                         uncertainty =       0.004124778707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332818280472
                                         uncertainty =       0.004124778707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407945666
  error estimate for blocks of size 2^( 2) =       0.000419782853
  error estimate for blocks of size 2^( 3) =       0.000432012146
  error estimate for blocks of size 2^( 4) =       0.000443785103
  error estimate for blocks of size 2^( 5) =       0.000453544420
  error estimate for blocks of size 2^( 6) =       0.000461078234
  error estimate for blocks of size 2^( 7) =       0.000464541025

      target function =                  N/A
              le_mean =     -16.909677341393
             les_mean =     286.270026956977
             stat err =       0.000455737195
             autocorr =       1.248027925104
              std dev =       0.576922294063
             le_variance =       0.332839333387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332818280472
                                         uncertainty =       0.004124778707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332818280472
                                         uncertainty =       0.004124778707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407945666
  error estimate for blocks of size 2^( 2) =       0.000419782853
  error estimate for blocks of size 2^( 3) =       0.000432012146
  error estimate for blocks of size 2^( 4) =       0.000443785103
  error estimate for blocks of size 2^( 5) =       0.000453544420
  error estimate for blocks of size 2^( 6) =       0.000461078234
  error estimate for blocks of size 2^( 7) =       0.000464541025

      target function =                  N/A
              le_mean =     -16.909677341393
             les_mean =     286.270026956977
             stat err =       0.000455737195
             autocorr =       1.248027925105
              std dev =       0.576922294063
             le_variance =       0.332839333387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332818280472
                                         uncertainty =       0.004124778707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332818280472
                                         uncertainty =       0.004124778707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407945666
  error estimate for blocks of size 2^( 2) =       0.000419782853
  error estimate for blocks of size 2^( 3) =       0.000432012146
  error estimate for blocks of size 2^( 4) =       0.000443785103
  error estimate for blocks of size 2^( 5) =       0.000453544420
  error estimate for blocks of size 2^( 6) =       0.000461078234
  error estimate for blocks of size 2^( 7) =       0.000464541025

      target function =                  N/A
              le_mean =     -16.909677341393
             les_mean =     286.270026956977
             stat err =       0.000455737195
             autocorr =       1.248027925106
              std dev =       0.576922294063
             le_variance =       0.332839333387


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909677341393        initial
     1.5259e+09     1.5259e+10             1.6132e-13       -16.909677341393
     6.1035e+09     6.1035e+10             4.0337e-14       -16.909677341393  <--
     2.4414e+10     2.4414e+11             1.0090e-14       -16.909677341393

*****************************************************************************
Applying the update for shift_i =   6.1035e+09     and shift_s =   6.1035e+10
*****************************************************************************

  Execution time = 4.4817e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1997e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8983
    reference variance = 0.152531
====================================================
  Execution time = 2.8199e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3811e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2182e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338120924126
                                         uncertainty =       0.004811112643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338120924126
                                         uncertainty =       0.004811112643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411161327
  error estimate for blocks of size 2^( 2) =       0.000422784086
  error estimate for blocks of size 2^( 3) =       0.000435528597
  error estimate for blocks of size 2^( 4) =       0.000447734491
  error estimate for blocks of size 2^( 5) =       0.000459128688
  error estimate for blocks of size 2^( 6) =       0.000468816575
  error estimate for blocks of size 2^( 7) =       0.000473941444

      target function =                  N/A
              le_mean =     -16.909492750383
             les_mean =     286.269052179398
             stat err =       0.000462405299
             autocorr =       1.264797760295
              std dev =       0.581469924585
             le_variance =       0.338107273197


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690949275038e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+09, overlap shift 1.5259e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909492750383       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909492750383       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909492750383       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909492750383       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909492750383       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909492750383       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909492351670       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909492781655       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+09 is 1.573814e-13

solving harmonic davidson linear method for identity shift 6.1035e+09, overlap shift 6.1035e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909492750383       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909492750383       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909492750383       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909493049026       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909492750383       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909492779339       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909492791134       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909492275156       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+09 is 3.937955e-14

solving harmonic davidson linear method for identity shift 2.4414e+10, overlap shift 2.4414e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909492750383       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909492750383       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909492750383       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909492750383       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909491584341       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909508194753       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909490189871       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909501012028       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909118344324       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909612749020       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909508675804       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909583194768       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909249494964       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909372894296       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909692530421       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909532314854       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909390316082       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.908581386604       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.912619476464       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.909620581715       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.910057640626       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.910813139390       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905640541767       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.909481448229       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.909753640946       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.909726570566       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.906709627468       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.908141843447       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.909133222150       residual = 1.21e-05           smallest_sin_value = 9.99e-01
davidson iteration   29:   krylov dim =  30   energy =     -16.906683499455       residual = 1.24e-03           smallest_sin_value = 9.98e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+10 is 9.862189e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.233349 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5443e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8914
    reference variance = 0.227455
====================================================
  Execution time = 2.7319e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3807e-01
  Total weights = 2.0000e+06
  Execution time = 3.4778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338063093188
                                         uncertainty =       0.004239649198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338063093188
                                         uncertainty =       0.004239649198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411139499
  error estimate for blocks of size 2^( 2) =       0.000423226252
  error estimate for blocks of size 2^( 3) =       0.000436286379
  error estimate for blocks of size 2^( 4) =       0.000448382380
  error estimate for blocks of size 2^( 5) =       0.000459298198
  error estimate for blocks of size 2^( 6) =       0.000468079396
  error estimate for blocks of size 2^( 7) =       0.000475082369

      target function =                  N/A
              le_mean =     -16.910928483332
             les_mean =     286.317573375413
             stat err =       0.000462710586
             autocorr =       1.266602861343
              std dev =       0.581439056204
             le_variance =       0.338071376079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338063093188
                                         uncertainty =       0.004239649198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338063093188
                                         uncertainty =       0.004239649198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411139499
  error estimate for blocks of size 2^( 2) =       0.000423226252
  error estimate for blocks of size 2^( 3) =       0.000436286379
  error estimate for blocks of size 2^( 4) =       0.000448382380
  error estimate for blocks of size 2^( 5) =       0.000459298198
  error estimate for blocks of size 2^( 6) =       0.000468079396
  error estimate for blocks of size 2^( 7) =       0.000475082369

      target function =                  N/A
              le_mean =     -16.910928483332
             les_mean =     286.317573375413
             stat err =       0.000462710586
             autocorr =       1.266602861343
              std dev =       0.581439056204
             le_variance =       0.338071376079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338063093188
                                         uncertainty =       0.004239649198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338063093188
                                         uncertainty =       0.004239649198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411139499
  error estimate for blocks of size 2^( 2) =       0.000423226252
  error estimate for blocks of size 2^( 3) =       0.000436286379
  error estimate for blocks of size 2^( 4) =       0.000448382380
  error estimate for blocks of size 2^( 5) =       0.000459298198
  error estimate for blocks of size 2^( 6) =       0.000468079396
  error estimate for blocks of size 2^( 7) =       0.000475082369

      target function =                  N/A
              le_mean =     -16.910928483332
             les_mean =     286.317573375413
             stat err =       0.000462710586
             autocorr =       1.266602861341
              std dev =       0.581439056204
             le_variance =       0.338071376079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338063093188
                                         uncertainty =       0.004239649198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338063093188
                                         uncertainty =       0.004239649198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411139499
  error estimate for blocks of size 2^( 2) =       0.000423226252
  error estimate for blocks of size 2^( 3) =       0.000436286379
  error estimate for blocks of size 2^( 4) =       0.000448382380
  error estimate for blocks of size 2^( 5) =       0.000459298198
  error estimate for blocks of size 2^( 6) =       0.000468079396
  error estimate for blocks of size 2^( 7) =       0.000475082369

      target function =                  N/A
              le_mean =     -16.910928483332
             les_mean =     286.317573375413
             stat err =       0.000462710586
             autocorr =       1.266602861341
              std dev =       0.581439056204
             le_variance =       0.338071376079


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910928483332        initial  <--
     1.5259e+09     1.5259e+10             1.5738e-13       -16.910928483332
     6.1035e+09     6.1035e+10             3.9380e-14       -16.910928483332
     2.4414e+10     2.4414e+11             9.8622e-15       -16.910928483332

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7957
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0246e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.0277
    reference variance = 0.468274
====================================================
  Execution time = 2.8258e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3940e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2021e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339483862146
                                         uncertainty =       0.004338489671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339483862146
                                         uncertainty =       0.004338489671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411948510
  error estimate for blocks of size 2^( 2) =       0.000423571177
  error estimate for blocks of size 2^( 3) =       0.000435812740
  error estimate for blocks of size 2^( 4) =       0.000448906632
  error estimate for blocks of size 2^( 5) =       0.000459502469
  error estimate for blocks of size 2^( 6) =       0.000468950897
  error estimate for blocks of size 2^( 7) =       0.000476477787

      target function =                  N/A
              le_mean =     -16.910557385995
             les_mean =     286.306354084534
             stat err =       0.000463459446
             autocorr =       1.265719889919
              std dev =       0.582583169338
             le_variance =       0.339403149196


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691055738600e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+10, overlap shift 1.5259e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910557385995       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910557385995       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910557385995       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910557385995       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910557542868       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910556476903       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910548769492       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910570759264       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910536859721       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910550579562       residual = 5.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+10 is 1.574114e-14

solving harmonic davidson linear method for identity shift 6.1035e+10, overlap shift 6.1035e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910557385995       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910557385995       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910557385995       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910557385995       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910568780190       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910581444205       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910577658089       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910627916499       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910611492953       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910541242062       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910576131841       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910443737368       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910209175526       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910638780110       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.911027753426       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.913141559674       residual = 8.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910903039438       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.913035628703       residual = 8.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906781774488       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.911752103985       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.914308961473       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.915079771132       residual = 2.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.903235929908       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.918254666615       residual = 7.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.908599289000       residual = 7.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.914208318732       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.905737771827       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.902023474859       residual = 9.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.917976543597       residual = 7.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.912310864100       residual = 3.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.915952868391       residual = 4.45e-03           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.919281164329       residual = 9.78e-03           smallest_sin_value = 9.96e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.54e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+10 is 3.753013e-15

solving harmonic davidson linear method for identity shift 2.4414e+11, overlap shift 2.4414e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910557385995       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910557385995       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910557385995       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910557385995       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910556928279       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910723569985       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911431353624       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909319265225       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911222149772       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911302460085       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.912180703262       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910147994077       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.911571649215       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905474339727       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.911023810173       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.920264056711       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906478544890       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.913043424085       residual = 8.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.898455276397       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.915257105871       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.927336119707       residual = 3.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.903286019548       residual = 7.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.921603197315       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.891306928966       residual = 4.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.900994609496       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.920326953064       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.905760883793       residual = 2.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.913874073130       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.902472455769       residual = 9.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.911293017166       residual = 6.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.909759911963       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.897342240337       residual = 2.47e-02           smallest_sin_value = 9.97e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.906571721962       residual = 2.42e-03           smallest_sin_value = 9.95e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.60e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+11 is 8.328442e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.295791 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5526e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8807
    reference variance = 0.232958
====================================================
  Execution time = 2.7742e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4677e-01
  Total weights = 2.0000e+06
  Execution time = 3.4741e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346850370213
                                         uncertainty =       0.014473031630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346850370213
                                         uncertainty =       0.014473031630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416395447
  error estimate for blocks of size 2^( 2) =       0.000427410919
  error estimate for blocks of size 2^( 3) =       0.000439145470
  error estimate for blocks of size 2^( 4) =       0.000450410171
  error estimate for blocks of size 2^( 5) =       0.000459340109
  error estimate for blocks of size 2^( 6) =       0.000465755184
  error estimate for blocks of size 2^( 7) =       0.000470480983

      target function =                  N/A
              le_mean =     -16.910392523330
             les_mean =     286.308145455988
             stat err =       0.000461496612
             autocorr =       1.228358371981
              std dev =       0.588872088212
             le_variance =       0.346770336275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346850370213
                                         uncertainty =       0.014473031630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346850370213
                                         uncertainty =       0.014473031630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416395447
  error estimate for blocks of size 2^( 2) =       0.000427410919
  error estimate for blocks of size 2^( 3) =       0.000439145470
  error estimate for blocks of size 2^( 4) =       0.000450410171
  error estimate for blocks of size 2^( 5) =       0.000459340109
  error estimate for blocks of size 2^( 6) =       0.000465755184
  error estimate for blocks of size 2^( 7) =       0.000470480983

      target function =                  N/A
              le_mean =     -16.910392523330
             les_mean =     286.308145455988
             stat err =       0.000461496612
             autocorr =       1.228358371976
              std dev =       0.588872088211
             le_variance =       0.346770336275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346850370213
                                         uncertainty =       0.014473031630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346850370213
                                         uncertainty =       0.014473031630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416395447
  error estimate for blocks of size 2^( 2) =       0.000427410919
  error estimate for blocks of size 2^( 3) =       0.000439145470
  error estimate for blocks of size 2^( 4) =       0.000450410171
  error estimate for blocks of size 2^( 5) =       0.000459340109
  error estimate for blocks of size 2^( 6) =       0.000465755184
  error estimate for blocks of size 2^( 7) =       0.000470480983

      target function =                  N/A
              le_mean =     -16.910392523330
             les_mean =     286.308145455988
             stat err =       0.000461496612
             autocorr =       1.228358371984
              std dev =       0.588872088212
             le_variance =       0.346770336275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346850370213
                                         uncertainty =       0.014473031630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346850370213
                                         uncertainty =       0.014473031630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416395447
  error estimate for blocks of size 2^( 2) =       0.000427410919
  error estimate for blocks of size 2^( 3) =       0.000439145470
  error estimate for blocks of size 2^( 4) =       0.000450410171
  error estimate for blocks of size 2^( 5) =       0.000459340109
  error estimate for blocks of size 2^( 6) =       0.000465755184
  error estimate for blocks of size 2^( 7) =       0.000470480983

      target function =                  N/A
              le_mean =     -16.910392523330
             les_mean =     286.308145455988
             stat err =       0.000461496612
             autocorr =       1.228358371981
              std dev =       0.588872088211
             le_variance =       0.346770336275


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910392523330        initial  <--
     1.5259e+10     1.5259e+11             1.5741e-14       -16.910392523330
     6.1035e+10     6.1035e+11             3.7530e-15       -16.910392523330
     2.4414e+11     2.4414e+12             8.3284e-16       -16.910392523330

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.1708
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0705e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8508
    reference variance = 0.431968
====================================================
  Execution time = 2.8234e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3975e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1676e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339837770247
                                         uncertainty =       0.005074210594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339837770247
                                         uncertainty =       0.005074210594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412156364
  error estimate for blocks of size 2^( 2) =       0.000423615609
  error estimate for blocks of size 2^( 3) =       0.000435029173
  error estimate for blocks of size 2^( 4) =       0.000446750819
  error estimate for blocks of size 2^( 5) =       0.000456519627
  error estimate for blocks of size 2^( 6) =       0.000463089794
  error estimate for blocks of size 2^( 7) =       0.000466264525

      target function =                  N/A
              le_mean =     -16.910596649067
             les_mean =     286.308024593622
             stat err =       0.000458156191
             autocorr =       1.235671700479
              std dev =       0.582877119188
             le_variance =       0.339745736073


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691059664907e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+11, overlap shift 1.5259e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910596649067       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910596649067       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910596649067       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910677146092       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910576234613       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910635208036       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910592484138       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910598323317       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910683385697       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910800448598       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910336369120       residual = 9.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910441700160       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910547277513       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909645032667       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910489356382       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.908948380421       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.903670786679       residual = 6.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.909166048906       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.922182806662       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.910480118409       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.919856848736       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.899191789074       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.919919442104       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.921514756027       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.921033104420       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.930908533666       residual = 5.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.927158964344       residual = 3.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.901346738095       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.907185812096       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.927379536183       residual = 4.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.922822940419       residual = 1.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.909634701261       residual = 1.02e-03           smallest_sin_value = 9.99e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+11 is 1.561576e-15

solving harmonic davidson linear method for identity shift 6.1035e+11, overlap shift 6.1035e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910596649067       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910596649067       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910596649067       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910596649067       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910865266045       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910246456983       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909243580675       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904125480277       residual = 5.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.917618505485       residual = 6.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908966296028       residual = 4.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904386273212       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.913486871498       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.902359400487       residual = 8.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.888421204622       residual = 6.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.915738470463       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.908765931187       residual = 6.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.947960268680       residual = 1.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.921075676653       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.931357617404       residual = 5.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.861807332490       residual = 3.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.954608824827       residual = 2.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.903280238304       residual = 7.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.877468387375       residual = 1.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.901347215503       residual = 2.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.982417867663       residual = 6.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.971305044392       residual = 4.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.891014042251       residual = 4.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906809795936       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.870253552880       residual = 3.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.836031585772       residual = 7.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.947323728024       residual = 1.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.911227318427       residual = 5.75e-03           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.921084987510       residual = 2.60e-02           smallest_sin_value = 9.98e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+11 is 3.071158e-16

solving harmonic davidson linear method for identity shift 2.4414e+12, overlap shift 2.4414e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910596649067       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910596649067       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.326241 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5436e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8564
    reference variance = 0.229733
====================================================
  Execution time = 2.8785e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4134e-01
  Total weights = 2.0000e+06
  Execution time = 3.7962e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341361143749
                                         uncertainty =       0.005418688301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341361143749
                                         uncertainty =       0.005418688301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413123831
  error estimate for blocks of size 2^( 2) =       0.000424616031
  error estimate for blocks of size 2^( 3) =       0.000437058142
  error estimate for blocks of size 2^( 4) =       0.000448505094
  error estimate for blocks of size 2^( 5) =       0.000458080891
  error estimate for blocks of size 2^( 6) =       0.000466338986
  error estimate for blocks of size 2^( 7) =       0.000469486007

      target function =                  N/A
              le_mean =     -16.910167217529
             les_mean =     286.295097754233
             stat err =       0.000460602745
             autocorr =       1.243061301278
              std dev =       0.584245325286
             le_variance =       0.341342600118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341361143749
                                         uncertainty =       0.005418688301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341361143749
                                         uncertainty =       0.005418688301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413123831
  error estimate for blocks of size 2^( 2) =       0.000424616031
  error estimate for blocks of size 2^( 3) =       0.000437058142
  error estimate for blocks of size 2^( 4) =       0.000448505094
  error estimate for blocks of size 2^( 5) =       0.000458080891
  error estimate for blocks of size 2^( 6) =       0.000466338986
  error estimate for blocks of size 2^( 7) =       0.000469486007

      target function =                  N/A
              le_mean =     -16.910167217529
             les_mean =     286.295097754233
             stat err =       0.000460602745
             autocorr =       1.243061301276
              std dev =       0.584245325286
             le_variance =       0.341342600118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341361143749
                                         uncertainty =       0.005418688301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341361143749
                                         uncertainty =       0.005418688301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413123831
  error estimate for blocks of size 2^( 2) =       0.000424616031
  error estimate for blocks of size 2^( 3) =       0.000437058142
  error estimate for blocks of size 2^( 4) =       0.000448505094
  error estimate for blocks of size 2^( 5) =       0.000458080891
  error estimate for blocks of size 2^( 6) =       0.000466338986
  error estimate for blocks of size 2^( 7) =       0.000469486007

      target function =                  N/A
              le_mean =     -16.910167217529
             les_mean =     286.295097754233
             stat err =       0.000460602745
             autocorr =       1.243061301275
              std dev =       0.584245325286
             le_variance =       0.341342600118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341361143749
                                         uncertainty =       0.005418688301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341361143749
                                         uncertainty =       0.005418688301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413123831
  error estimate for blocks of size 2^( 2) =       0.000424616031
  error estimate for blocks of size 2^( 3) =       0.000437058142
  error estimate for blocks of size 2^( 4) =       0.000448505094
  error estimate for blocks of size 2^( 5) =       0.000458080891
  error estimate for blocks of size 2^( 6) =       0.000466338986
  error estimate for blocks of size 2^( 7) =       0.000469486007

      target function =                  N/A
              le_mean =     -16.910167217529
             les_mean =     286.295097754233
             stat err =       0.000460602745
             autocorr =       1.243061301278
              std dev =       0.584245325286
             le_variance =       0.341342600118


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910167217529        initial  <--
     1.5259e+11     1.5259e+12             1.5616e-15       -16.910167217529
     6.1035e+11     6.1035e+12             3.0712e-16       -16.910167217529
     2.4414e+12     2.4414e+13             0.0000e+00       -16.910167217529

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.5084
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.1978e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9002
    reference variance = 0.241512
====================================================
  Execution time = 2.8467e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.4342e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1577e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343525072248
                                         uncertainty =       0.004157894489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343525072248
                                         uncertainty =       0.004157894489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414378516
  error estimate for blocks of size 2^( 2) =       0.000425577768
  error estimate for blocks of size 2^( 3) =       0.000436851630
  error estimate for blocks of size 2^( 4) =       0.000447598664
  error estimate for blocks of size 2^( 5) =       0.000455989650
  error estimate for blocks of size 2^( 6) =       0.000461169970
  error estimate for blocks of size 2^( 7) =       0.000463089027

      target function =                  N/A
              le_mean =     -16.911793380044
             les_mean =     286.352174266889
             stat err =       0.000456961828
             autocorr =       1.216089066410
              std dev =       0.586019717504
             le_variance =       0.343419109304


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691179338004e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+12, overlap shift 1.5259e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911793380044       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911793380044       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.1035e+12, overlap shift 6.1035e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911793380044       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911793380044       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+13, overlap shift 2.4414e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911793380044       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911793380044       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.327357 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5630e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.928
    reference variance = 0.194464
====================================================
  Execution time = 2.7862e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3802e-01
  Total weights = 2.0000e+06
  Execution time = 3.4744e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338032187887
                                         uncertainty =       0.004654436046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338032187887
                                         uncertainty =       0.004654436046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411106079
  error estimate for blocks of size 2^( 2) =       0.000422907421
  error estimate for blocks of size 2^( 3) =       0.000435223247
  error estimate for blocks of size 2^( 4) =       0.000447143823
  error estimate for blocks of size 2^( 5) =       0.000457938764
  error estimate for blocks of size 2^( 6) =       0.000468833880
  error estimate for blocks of size 2^( 7) =       0.000475755999

      target function =                  N/A
              le_mean =     -16.910639609437
             les_mean =     286.307748248400
             stat err =       0.000462418117
             autocorr =       1.265207863604
              std dev =       0.581391793160
             le_variance =       0.338016417154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338032187887
                                         uncertainty =       0.004654436046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338032187887
                                         uncertainty =       0.004654436046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411106079
  error estimate for blocks of size 2^( 2) =       0.000422907421
  error estimate for blocks of size 2^( 3) =       0.000435223247
  error estimate for blocks of size 2^( 4) =       0.000447143823
  error estimate for blocks of size 2^( 5) =       0.000457938764
  error estimate for blocks of size 2^( 6) =       0.000468833880
  error estimate for blocks of size 2^( 7) =       0.000475755999

      target function =                  N/A
              le_mean =     -16.910639609437
             les_mean =     286.307748248400
             stat err =       0.000462418117
             autocorr =       1.265207863604
              std dev =       0.581391793160
             le_variance =       0.338016417154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338032187887
                                         uncertainty =       0.004654436046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338032187887
                                         uncertainty =       0.004654436046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411106079
  error estimate for blocks of size 2^( 2) =       0.000422907421
  error estimate for blocks of size 2^( 3) =       0.000435223247
  error estimate for blocks of size 2^( 4) =       0.000447143823
  error estimate for blocks of size 2^( 5) =       0.000457938764
  error estimate for blocks of size 2^( 6) =       0.000468833880
  error estimate for blocks of size 2^( 7) =       0.000475755999

      target function =                  N/A
              le_mean =     -16.910639609437
             les_mean =     286.307748248400
             stat err =       0.000462418117
             autocorr =       1.265207863604
              std dev =       0.581391793160
             le_variance =       0.338016417154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338032187887
                                         uncertainty =       0.004654436046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338032187887
                                         uncertainty =       0.004654436046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411106079
  error estimate for blocks of size 2^( 2) =       0.000422907421
  error estimate for blocks of size 2^( 3) =       0.000435223247
  error estimate for blocks of size 2^( 4) =       0.000447143823
  error estimate for blocks of size 2^( 5) =       0.000457938764
  error estimate for blocks of size 2^( 6) =       0.000468833880
  error estimate for blocks of size 2^( 7) =       0.000475755999

      target function =                  N/A
              le_mean =     -16.910639609437
             les_mean =     286.307748248400
             stat err =       0.000462418117
             autocorr =       1.265207863604
              std dev =       0.581391793160
             le_variance =       0.338016417154


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910639609437        initial  <--
     1.5259e+12     1.5259e+13             0.0000e+00       -16.910639609437
     6.1035e+12     6.1035e+13             0.0000e+00       -16.910639609437
     2.4414e+13     2.4414e+14             0.0000e+00       -16.910639609437

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.2384
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0876e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9379
    reference variance = 0.732231
====================================================
  Execution time = 2.8155e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.2906e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1186e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329072052217
                                         uncertainty =       0.002895556067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329072052217
                                         uncertainty =       0.002895556067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405622372
  error estimate for blocks of size 2^( 2) =       0.000417166328
  error estimate for blocks of size 2^( 3) =       0.000429449669
  error estimate for blocks of size 2^( 4) =       0.000441047796
  error estimate for blocks of size 2^( 5) =       0.000449954193
  error estimate for blocks of size 2^( 6) =       0.000456811630
  error estimate for blocks of size 2^( 7) =       0.000463816944

      target function =                  N/A
              le_mean =     -16.910801200763
             les_mean =     286.304256104374
             stat err =       0.000452907641
             autocorr =       1.246738854869
              std dev =       0.573636659534
             le_variance =       0.329059017161


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691080120076e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+13, overlap shift 1.5259e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910801200763       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910801200763       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.1035e+13, overlap shift 6.1035e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910801200763       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910801200763       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+14, overlap shift 2.4414e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910801200763       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910801200763       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910801200763       residual = 1.50e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910801200763       residual = 5.91e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.899743435343       residual = 6.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910801200729       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.865323484552       residual = 2.27e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -18.946443232507       residual = 5.46e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.890949203923       residual = 3.40e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -19.754704224350       residual = 1.13e+03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -15.846839986718       residual = 1.48e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.341273659303       residual = 6.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -19.119548696211       residual = 6.23e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.862448232479       residual = 1.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -26.334188649202       residual = 1.10e+04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -19.334675618395       residual = 6.15e+02           smallest_sin_value = 1.00e+00
davidson iteration   16 stopping due to too large eigenvalue change
davidson solver did not converge after         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+14 is 3.412737e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.331512 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5282e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.931
    reference variance = 0.201493
====================================================
  Execution time = 2.7491e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3249e-01
  Total weights = 2.0000e+06
  Execution time = 3.4751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332559582597
                                         uncertainty =       0.003503383867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332559582597
                                         uncertainty =       0.003503383867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407732088
  error estimate for blocks of size 2^( 2) =       0.000419444670
  error estimate for blocks of size 2^( 3) =       0.000431236713
  error estimate for blocks of size 2^( 4) =       0.000442445510
  error estimate for blocks of size 2^( 5) =       0.000453226151
  error estimate for blocks of size 2^( 6) =       0.000460909092
  error estimate for blocks of size 2^( 7) =       0.000467640124

      target function =                  N/A
              le_mean =     -16.910402848492
             les_mean =     286.294215243569
             stat err =       0.000456055219
             autocorr =       1.251079988627
              std dev =       0.576620248973
             le_variance =       0.332490911525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332559582597
                                         uncertainty =       0.003503383867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332559582597
                                         uncertainty =       0.003503383867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407732088
  error estimate for blocks of size 2^( 2) =       0.000419444670
  error estimate for blocks of size 2^( 3) =       0.000431236713
  error estimate for blocks of size 2^( 4) =       0.000442445510
  error estimate for blocks of size 2^( 5) =       0.000453226151
  error estimate for blocks of size 2^( 6) =       0.000460909092
  error estimate for blocks of size 2^( 7) =       0.000467640124

      target function =                  N/A
              le_mean =     -16.910402848492
             les_mean =     286.294215243569
             stat err =       0.000456055219
             autocorr =       1.251079988627
              std dev =       0.576620248973
             le_variance =       0.332490911525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332559582597
                                         uncertainty =       0.003503383867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332559582597
                                         uncertainty =       0.003503383867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407732088
  error estimate for blocks of size 2^( 2) =       0.000419444670
  error estimate for blocks of size 2^( 3) =       0.000431236713
  error estimate for blocks of size 2^( 4) =       0.000442445510
  error estimate for blocks of size 2^( 5) =       0.000453226151
  error estimate for blocks of size 2^( 6) =       0.000460909092
  error estimate for blocks of size 2^( 7) =       0.000467640124

      target function =                  N/A
              le_mean =     -16.910402848492
             les_mean =     286.294215243569
             stat err =       0.000456055219
             autocorr =       1.251079988627
              std dev =       0.576620248973
             le_variance =       0.332490911525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332559582597
                                         uncertainty =       0.003503383867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332559582597
                                         uncertainty =       0.003503383867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407732088
  error estimate for blocks of size 2^( 2) =       0.000419444670
  error estimate for blocks of size 2^( 3) =       0.000431236713
  error estimate for blocks of size 2^( 4) =       0.000442445510
  error estimate for blocks of size 2^( 5) =       0.000453226151
  error estimate for blocks of size 2^( 6) =       0.000460909092
  error estimate for blocks of size 2^( 7) =       0.000467640124

      target function =                  N/A
              le_mean =     -16.910402848492
             les_mean =     286.294215243569
             stat err =       0.000456055219
             autocorr =       1.251079988627
              std dev =       0.576620248973
             le_variance =       0.332490911525


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910402848492        initial  <--
     1.5259e+13     1.5259e+14             0.0000e+00       -16.910402848492
     6.1035e+13     6.1035e+14             0.0000e+00       -16.910402848492
     2.4414e+14     2.4414e+15             3.4127e-19       -16.910402848492

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.8643
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0155e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.851
    reference variance = 0.39297
====================================================
  Execution time = 2.8138e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3975e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2130e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339682414239
                                         uncertainty =       0.004242802438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339682414239
                                         uncertainty =       0.004242802438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412156568
  error estimate for blocks of size 2^( 2) =       0.000423745769
  error estimate for blocks of size 2^( 3) =       0.000435482470
  error estimate for blocks of size 2^( 4) =       0.000447231068
  error estimate for blocks of size 2^( 5) =       0.000458163795
  error estimate for blocks of size 2^( 6) =       0.000468161249
  error estimate for blocks of size 2^( 7) =       0.000475432686

      target function =                  N/A
              le_mean =     -16.910116301711
             les_mean =     286.291779240829
             stat err =       0.000462247199
             autocorr =       1.257836308342
              std dev =       0.582877408487
             le_variance =       0.339746073324


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691011630171e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+14, overlap shift 1.5259e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910116301711       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910116301711       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.1035e+14, overlap shift 6.1035e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910116301711       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910116301711       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+15, overlap shift 2.4414e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910116301711       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910116301711       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.28e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.332577 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5356e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8706
    reference variance = 0.296808
====================================================
  Execution time = 2.7565e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3321e-01
  Total weights = 2.0000e+06
  Execution time = 3.4848e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333257013359
                                         uncertainty =       0.003413494767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333257013359
                                         uncertainty =       0.003413494767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408174119
  error estimate for blocks of size 2^( 2) =       0.000420036733
  error estimate for blocks of size 2^( 3) =       0.000432042227
  error estimate for blocks of size 2^( 4) =       0.000443290185
  error estimate for blocks of size 2^( 5) =       0.000453347378
  error estimate for blocks of size 2^( 6) =       0.000461831672
  error estimate for blocks of size 2^( 7) =       0.000466097041

      target function =                  N/A
              le_mean =     -16.911298284812
             les_mean =     286.325221734682
             stat err =       0.000456141569
             autocorr =       1.248844527690
              std dev =       0.577245375379
             le_variance =       0.333212223397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333257013359
                                         uncertainty =       0.003413494767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333257013359
                                         uncertainty =       0.003413494767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408174119
  error estimate for blocks of size 2^( 2) =       0.000420036733
  error estimate for blocks of size 2^( 3) =       0.000432042227
  error estimate for blocks of size 2^( 4) =       0.000443290185
  error estimate for blocks of size 2^( 5) =       0.000453347378
  error estimate for blocks of size 2^( 6) =       0.000461831672
  error estimate for blocks of size 2^( 7) =       0.000466097041

      target function =                  N/A
              le_mean =     -16.911298284812
             les_mean =     286.325221734682
             stat err =       0.000456141569
             autocorr =       1.248844527690
              std dev =       0.577245375379
             le_variance =       0.333212223397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333257013359
                                         uncertainty =       0.003413494767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333257013359
                                         uncertainty =       0.003413494767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408174119
  error estimate for blocks of size 2^( 2) =       0.000420036733
  error estimate for blocks of size 2^( 3) =       0.000432042227
  error estimate for blocks of size 2^( 4) =       0.000443290185
  error estimate for blocks of size 2^( 5) =       0.000453347378
  error estimate for blocks of size 2^( 6) =       0.000461831672
  error estimate for blocks of size 2^( 7) =       0.000466097041

      target function =                  N/A
              le_mean =     -16.911298284812
             les_mean =     286.325221734682
             stat err =       0.000456141569
             autocorr =       1.248844527690
              std dev =       0.577245375379
             le_variance =       0.333212223397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333257013359
                                         uncertainty =       0.003413494767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333257013359
                                         uncertainty =       0.003413494767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408174119
  error estimate for blocks of size 2^( 2) =       0.000420036733
  error estimate for blocks of size 2^( 3) =       0.000432042227
  error estimate for blocks of size 2^( 4) =       0.000443290185
  error estimate for blocks of size 2^( 5) =       0.000453347378
  error estimate for blocks of size 2^( 6) =       0.000461831672
  error estimate for blocks of size 2^( 7) =       0.000466097041

      target function =                  N/A
              le_mean =     -16.911298284812
             les_mean =     286.325221734682
             stat err =       0.000456141569
             autocorr =       1.248844527690
              std dev =       0.577245375379
             le_variance =       0.333212223397


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911298284812        initial  <--
     1.5259e+14     1.5259e+15             0.0000e+00       -16.911298284812
     6.1035e+14     6.1035e+15             0.0000e+00       -16.911298284812
     2.4414e+15     2.4414e+16             0.0000e+00       -16.911298284812

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0141
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0378e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9218
    reference variance = 0.230852
====================================================
  Execution time = 2.8209e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.5318e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.0966e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353286584042
                                         uncertainty =       0.009773387490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353286584042
                                         uncertainty =       0.009773387490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420225956
  error estimate for blocks of size 2^( 2) =       0.000431223212
  error estimate for blocks of size 2^( 3) =       0.000442701491
  error estimate for blocks of size 2^( 4) =       0.000452772041
  error estimate for blocks of size 2^( 5) =       0.000461633095
  error estimate for blocks of size 2^( 6) =       0.000467284899
  error estimate for blocks of size 2^( 7) =       0.000471060084

      target function =                  N/A
              le_mean =     -16.910175050787
             les_mean =     286.307199780690
             stat err =       0.000463187530
             autocorr =       1.214920802257
              std dev =       0.594289246924
             le_variance =       0.353179709009


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691017505079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+15, overlap shift 1.5259e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910175050787       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910175050787       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910175050787       residual = 5.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.514609669261       residual = 4.20e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -18.490841222848       residual = 3.75e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -21.432827325437       residual = 2.72e+03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -11.645268907008       residual = 3.77e+03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -13.142519472416       residual = 1.80e+03           smallest_sin_value = 1.00e+00
davidson iteration    8 stopping due to too large eigenvalue change
davidson solver did not converge after          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+15 is 5.182653e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+15, overlap shift 6.1035e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910175050787       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910175050787       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910175050787       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910175050787       residual = 5.21e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.993151598522       residual = 9.38e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =      -9.411857080941       residual = 1.39e+04           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+15 is 1.295663e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+16, overlap shift 2.4414e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910175050787       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910175050787       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910175050787       residual = 9.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+16 is 3.239158e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.334987 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5312e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9533
    reference variance = 0.262982
====================================================
  Execution time = 2.9548e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3515e-01
  Total weights = 2.0000e+06
  Execution time = 3.4794e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335200164726
                                         uncertainty =       0.004185792854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335200164726
                                         uncertainty =       0.004185792854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409358059
  error estimate for blocks of size 2^( 2) =       0.000421087520
  error estimate for blocks of size 2^( 3) =       0.000432812099
  error estimate for blocks of size 2^( 4) =       0.000443611558
  error estimate for blocks of size 2^( 5) =       0.000452727237
  error estimate for blocks of size 2^( 6) =       0.000460091738
  error estimate for blocks of size 2^( 7) =       0.000466834996

      target function =                  N/A
              le_mean =     -16.910364581378
             les_mean =     286.295578148669
             stat err =       0.000455816382
             autocorr =       1.239861487764
              std dev =       0.578919719051
             le_variance =       0.335148041106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335200164726
                                         uncertainty =       0.004185792854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335200164726
                                         uncertainty =       0.004185792854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409358059
  error estimate for blocks of size 2^( 2) =       0.000421087520
  error estimate for blocks of size 2^( 3) =       0.000432812099
  error estimate for blocks of size 2^( 4) =       0.000443611558
  error estimate for blocks of size 2^( 5) =       0.000452727237
  error estimate for blocks of size 2^( 6) =       0.000460091738
  error estimate for blocks of size 2^( 7) =       0.000466834996

      target function =                  N/A
              le_mean =     -16.910364581378
             les_mean =     286.295578148669
             stat err =       0.000455816382
             autocorr =       1.239861487764
              std dev =       0.578919719051
             le_variance =       0.335148041106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335200164726
                                         uncertainty =       0.004185792854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335200164726
                                         uncertainty =       0.004185792854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409358059
  error estimate for blocks of size 2^( 2) =       0.000421087520
  error estimate for blocks of size 2^( 3) =       0.000432812099
  error estimate for blocks of size 2^( 4) =       0.000443611558
  error estimate for blocks of size 2^( 5) =       0.000452727237
  error estimate for blocks of size 2^( 6) =       0.000460091738
  error estimate for blocks of size 2^( 7) =       0.000466834996

      target function =                  N/A
              le_mean =     -16.910364581378
             les_mean =     286.295578148669
             stat err =       0.000455816382
             autocorr =       1.239861487764
              std dev =       0.578919719051
             le_variance =       0.335148041106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335200164726
                                         uncertainty =       0.004185792854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335200164726
                                         uncertainty =       0.004185792854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409358059
  error estimate for blocks of size 2^( 2) =       0.000421087520
  error estimate for blocks of size 2^( 3) =       0.000432812099
  error estimate for blocks of size 2^( 4) =       0.000443611558
  error estimate for blocks of size 2^( 5) =       0.000452727237
  error estimate for blocks of size 2^( 6) =       0.000460091738
  error estimate for blocks of size 2^( 7) =       0.000466834996

      target function =                  N/A
              le_mean =     -16.910364581378
             les_mean =     286.295578148669
             stat err =       0.000455816382
             autocorr =       1.239861487764
              std dev =       0.578919719051
             le_variance =       0.335148041106


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910364581378        initial  <--
     1.5259e+15     1.5259e+16             5.1827e-20       -16.910364581378
     6.1035e+15     6.1035e+16             1.2957e-20       -16.910364581378
     2.4414e+16     2.4414e+17             3.2392e-21       -16.910364581378

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.9733
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2293e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.916
    reference variance = 0.543262
====================================================
  Execution time = 2.8299e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4156e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2423e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341523431745
                                         uncertainty =       0.004212771823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341523431745
                                         uncertainty =       0.004212771823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413252758
  error estimate for blocks of size 2^( 2) =       0.000424579378
  error estimate for blocks of size 2^( 3) =       0.000436194521
  error estimate for blocks of size 2^( 4) =       0.000446913785
  error estimate for blocks of size 2^( 5) =       0.000457480733
  error estimate for blocks of size 2^( 6) =       0.000463182715
  error estimate for blocks of size 2^( 7) =       0.000469280021

      target function =                  N/A
              le_mean =     -16.909870990708
             les_mean =     286.285292435279
             stat err =       0.000459214314
             autocorr =       1.234807651300
              std dev =       0.584427654767
             le_variance =       0.341555683656


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690987099071e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+16, overlap shift 1.5259e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909870990708       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909870990708       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+16, overlap shift 6.1035e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909870990708       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909870990708       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+17, overlap shift 2.4414e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909870990708       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909870990708       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.336122 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5547e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8738
    reference variance = 0.212099
====================================================
  Execution time = 2.7644e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3403e-01
  Total weights = 2.0000e+06
  Execution time = 3.4895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334077782636
                                         uncertainty =       0.003248355203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334077782636
                                         uncertainty =       0.003248355203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408677730
  error estimate for blocks of size 2^( 2) =       0.000420495374
  error estimate for blocks of size 2^( 3) =       0.000432664829
  error estimate for blocks of size 2^( 4) =       0.000443939569
  error estimate for blocks of size 2^( 5) =       0.000453394046
  error estimate for blocks of size 2^( 6) =       0.000458932142
  error estimate for blocks of size 2^( 7) =       0.000463168427

      target function =                  N/A
              le_mean =     -16.910405928473
             les_mean =     286.295863473252
             stat err =       0.000454858546
             autocorr =       1.238770264756
              std dev =       0.577957588877
             le_variance =       0.334034974541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334077782636
                                         uncertainty =       0.003248355203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334077782636
                                         uncertainty =       0.003248355203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408677730
  error estimate for blocks of size 2^( 2) =       0.000420495374
  error estimate for blocks of size 2^( 3) =       0.000432664829
  error estimate for blocks of size 2^( 4) =       0.000443939569
  error estimate for blocks of size 2^( 5) =       0.000453394046
  error estimate for blocks of size 2^( 6) =       0.000458932142
  error estimate for blocks of size 2^( 7) =       0.000463168427

      target function =                  N/A
              le_mean =     -16.910405928473
             les_mean =     286.295863473252
             stat err =       0.000454858546
             autocorr =       1.238770264756
              std dev =       0.577957588877
             le_variance =       0.334034974541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334077782636
                                         uncertainty =       0.003248355203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334077782636
                                         uncertainty =       0.003248355203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408677730
  error estimate for blocks of size 2^( 2) =       0.000420495374
  error estimate for blocks of size 2^( 3) =       0.000432664829
  error estimate for blocks of size 2^( 4) =       0.000443939569
  error estimate for blocks of size 2^( 5) =       0.000453394046
  error estimate for blocks of size 2^( 6) =       0.000458932142
  error estimate for blocks of size 2^( 7) =       0.000463168427

      target function =                  N/A
              le_mean =     -16.910405928473
             les_mean =     286.295863473252
             stat err =       0.000454858546
             autocorr =       1.238770264756
              std dev =       0.577957588877
             le_variance =       0.334034974541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334077782636
                                         uncertainty =       0.003248355203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334077782636
                                         uncertainty =       0.003248355203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408677730
  error estimate for blocks of size 2^( 2) =       0.000420495374
  error estimate for blocks of size 2^( 3) =       0.000432664829
  error estimate for blocks of size 2^( 4) =       0.000443939569
  error estimate for blocks of size 2^( 5) =       0.000453394046
  error estimate for blocks of size 2^( 6) =       0.000458932142
  error estimate for blocks of size 2^( 7) =       0.000463168427

      target function =                  N/A
              le_mean =     -16.910405928473
             les_mean =     286.295863473252
             stat err =       0.000454858546
             autocorr =       1.238770264756
              std dev =       0.577957588877
             le_variance =       0.334034974541


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910405928473        initial  <--
     1.5259e+16     1.5259e+17             0.0000e+00       -16.910405928473
     6.1035e+16     6.1035e+17             0.0000e+00       -16.910405928473
     2.4414e+17     2.4414e+18             0.0000e+00       -16.910405928473

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0836
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0638e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9113
    reference variance = 0.326421
====================================================
  Execution time = 2.8069e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.5390e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1333e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353967638458
                                         uncertainty =       0.011591697076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353967638458
                                         uncertainty =       0.011591697076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420654960
  error estimate for blocks of size 2^( 2) =       0.000432214663
  error estimate for blocks of size 2^( 3) =       0.000443493912
  error estimate for blocks of size 2^( 4) =       0.000455493182
  error estimate for blocks of size 2^( 5) =       0.000466479932
  error estimate for blocks of size 2^( 6) =       0.000475089144
  error estimate for blocks of size 2^( 7) =       0.000480437731

      target function =                  N/A
              le_mean =     -16.910025114952
             les_mean =     286.302850401958
             stat err =       0.000469374997
             autocorr =       1.245053103671
              std dev =       0.594895949399
             le_variance =       0.353901190611


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691002511495e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+17, overlap shift 1.5259e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910025114952       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910025114952       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+17, overlap shift 6.1035e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910025114952       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910025114952       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+18, overlap shift 2.4414e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910025114952       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910025114952       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.337242 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5207e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9445
    reference variance = 0.161606
====================================================
  Execution time = 2.7512e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3819e-01
  Total weights = 2.0000e+06
  Execution time = 3.4841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338164149812
                                         uncertainty =       0.004631945190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338164149812
                                         uncertainty =       0.004631945190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411210303
  error estimate for blocks of size 2^( 2) =       0.000422274881
  error estimate for blocks of size 2^( 3) =       0.000434648095
  error estimate for blocks of size 2^( 4) =       0.000446194936
  error estimate for blocks of size 2^( 5) =       0.000456489633
  error estimate for blocks of size 2^( 6) =       0.000462351454
  error estimate for blocks of size 2^( 7) =       0.000465781623

      target function =                  N/A
              le_mean =     -16.910681070103
             les_mean =     286.309321912843
             stat err =       0.000457704412
             autocorr =       1.238917025431
              std dev =       0.581539188009
             le_variance =       0.338187827190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338164149812
                                         uncertainty =       0.004631945190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338164149812
                                         uncertainty =       0.004631945190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411210303
  error estimate for blocks of size 2^( 2) =       0.000422274881
  error estimate for blocks of size 2^( 3) =       0.000434648095
  error estimate for blocks of size 2^( 4) =       0.000446194936
  error estimate for blocks of size 2^( 5) =       0.000456489633
  error estimate for blocks of size 2^( 6) =       0.000462351454
  error estimate for blocks of size 2^( 7) =       0.000465781623

      target function =                  N/A
              le_mean =     -16.910681070103
             les_mean =     286.309321912843
             stat err =       0.000457704412
             autocorr =       1.238917025431
              std dev =       0.581539188009
             le_variance =       0.338187827190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338164149812
                                         uncertainty =       0.004631945190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338164149812
                                         uncertainty =       0.004631945190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411210303
  error estimate for blocks of size 2^( 2) =       0.000422274881
  error estimate for blocks of size 2^( 3) =       0.000434648095
  error estimate for blocks of size 2^( 4) =       0.000446194936
  error estimate for blocks of size 2^( 5) =       0.000456489633
  error estimate for blocks of size 2^( 6) =       0.000462351454
  error estimate for blocks of size 2^( 7) =       0.000465781623

      target function =                  N/A
              le_mean =     -16.910681070103
             les_mean =     286.309321912843
             stat err =       0.000457704412
             autocorr =       1.238917025431
              std dev =       0.581539188009
             le_variance =       0.338187827190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338164149812
                                         uncertainty =       0.004631945190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338164149812
                                         uncertainty =       0.004631945190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411210303
  error estimate for blocks of size 2^( 2) =       0.000422274881
  error estimate for blocks of size 2^( 3) =       0.000434648095
  error estimate for blocks of size 2^( 4) =       0.000446194936
  error estimate for blocks of size 2^( 5) =       0.000456489633
  error estimate for blocks of size 2^( 6) =       0.000462351454
  error estimate for blocks of size 2^( 7) =       0.000465781623

      target function =                  N/A
              le_mean =     -16.910681070103
             les_mean =     286.309321912843
             stat err =       0.000457704412
             autocorr =       1.238917025431
              std dev =       0.581539188009
             le_variance =       0.338187827190


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910681070103        initial  <--
     1.5259e+17     1.5259e+18             0.0000e+00       -16.910681070103
     6.1035e+17     6.1035e+18             0.0000e+00       -16.910681070103
     2.4414e+18     2.4414e+19             0.0000e+00       -16.910681070103

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.9443
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0159e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.895
    reference variance = 0.234957
====================================================
  Execution time = 2.7943e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3262e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1396e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332693537871
                                         uncertainty =       0.002999779862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332693537871
                                         uncertainty =       0.002999779862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407809523
  error estimate for blocks of size 2^( 2) =       0.000419660984
  error estimate for blocks of size 2^( 3) =       0.000431747119
  error estimate for blocks of size 2^( 4) =       0.000442976045
  error estimate for blocks of size 2^( 5) =       0.000453818792
  error estimate for blocks of size 2^( 6) =       0.000460696433
  error estimate for blocks of size 2^( 7) =       0.000467367202

      target function =                  N/A
              le_mean =     -16.909191102751
             les_mean =     286.253360797016
             stat err =       0.000456214618
             autocorr =       1.251479291725
              std dev =       0.576729758171
             le_variance =       0.332617213960


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690919110275e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+18, overlap shift 1.5259e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909191102751       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909191102751       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+18 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.1035e+18, overlap shift 6.1035e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909191102751       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909191102751       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+19, overlap shift 2.4414e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909191102751       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909191102751       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+19 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.338333 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5088e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9092
    reference variance = 0.157121
====================================================
  Execution time = 2.7315e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4083e-01
  Total weights = 2.0000e+06
  Execution time = 3.5442e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340873573865
                                         uncertainty =       0.005513138719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340873573865
                                         uncertainty =       0.005513138719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412815489
  error estimate for blocks of size 2^( 2) =       0.000424469112
  error estimate for blocks of size 2^( 3) =       0.000436545994
  error estimate for blocks of size 2^( 4) =       0.000447183496
  error estimate for blocks of size 2^( 5) =       0.000456594379
  error estimate for blocks of size 2^( 6) =       0.000464456947
  error estimate for blocks of size 2^( 7) =       0.000467888605

      target function =                  N/A
              le_mean =     -16.910623402371
             les_mean =     286.310016941725
             stat err =       0.000459030857
             autocorr =       1.236436435006
              std dev =       0.583809262797
             le_variance =       0.340833255328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340873573865
                                         uncertainty =       0.005513138719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340873573865
                                         uncertainty =       0.005513138719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412815489
  error estimate for blocks of size 2^( 2) =       0.000424469112
  error estimate for blocks of size 2^( 3) =       0.000436545994
  error estimate for blocks of size 2^( 4) =       0.000447183496
  error estimate for blocks of size 2^( 5) =       0.000456594379
  error estimate for blocks of size 2^( 6) =       0.000464456947
  error estimate for blocks of size 2^( 7) =       0.000467888605

      target function =                  N/A
              le_mean =     -16.910623402371
             les_mean =     286.310016941725
             stat err =       0.000459030857
             autocorr =       1.236436435006
              std dev =       0.583809262797
             le_variance =       0.340833255328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340873573865
                                         uncertainty =       0.005513138719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340873573865
                                         uncertainty =       0.005513138719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412815489
  error estimate for blocks of size 2^( 2) =       0.000424469112
  error estimate for blocks of size 2^( 3) =       0.000436545994
  error estimate for blocks of size 2^( 4) =       0.000447183496
  error estimate for blocks of size 2^( 5) =       0.000456594379
  error estimate for blocks of size 2^( 6) =       0.000464456947
  error estimate for blocks of size 2^( 7) =       0.000467888605

      target function =                  N/A
              le_mean =     -16.910623402371
             les_mean =     286.310016941725
             stat err =       0.000459030857
             autocorr =       1.236436435006
              std dev =       0.583809262797
             le_variance =       0.340833255328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340873573865
                                         uncertainty =       0.005513138719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340873573865
                                         uncertainty =       0.005513138719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412815489
  error estimate for blocks of size 2^( 2) =       0.000424469112
  error estimate for blocks of size 2^( 3) =       0.000436545994
  error estimate for blocks of size 2^( 4) =       0.000447183496
  error estimate for blocks of size 2^( 5) =       0.000456594379
  error estimate for blocks of size 2^( 6) =       0.000464456947
  error estimate for blocks of size 2^( 7) =       0.000467888605

      target function =                  N/A
              le_mean =     -16.910623402371
             les_mean =     286.310016941725
             stat err =       0.000459030857
             autocorr =       1.236436435006
              std dev =       0.583809262797
             le_variance =       0.340833255328


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910623402371        initial  <--
     1.5259e+18     1.5259e+19             0.0000e+00       -16.910623402371
     6.1035e+18     6.1035e+19             0.0000e+00       -16.910623402371
     2.4414e+19     2.4414e+20             0.0000e+00       -16.910623402371

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.8019
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9898e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9342
    reference variance = 0.515861
====================================================
  Execution time = 3.0137e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3778e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1011e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337834584382
                                         uncertainty =       0.003288456088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337834584382
                                         uncertainty =       0.003288456088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410961540
  error estimate for blocks of size 2^( 2) =       0.000422787902
  error estimate for blocks of size 2^( 3) =       0.000434325851
  error estimate for blocks of size 2^( 4) =       0.000445878693
  error estimate for blocks of size 2^( 5) =       0.000456307915
  error estimate for blocks of size 2^( 6) =       0.000464495513
  error estimate for blocks of size 2^( 7) =       0.000471620621

      target function =                  N/A
              le_mean =     -16.910191172253
             les_mean =     286.292344087747
             stat err =       0.000459575686
             autocorr =       1.250580716195
              std dev =       0.581187383294
             le_variance =       0.337778774500


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691019117225e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+19, overlap shift 1.5259e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910191172253       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910191172253       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910191172253       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910191172254       residual = 6.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+19 is 4.976802e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+19, overlap shift 6.1035e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910191172253       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910191172253       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910191172253       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910191172326       residual = 3.72e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910191172268       residual = 1.01e+01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+19 is 1.244200e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+20, overlap shift 2.4414e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910191172253       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910191172253       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910191172253       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910191172268       residual = 9.15e-01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+20 is 3.110501e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.340158 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.7244e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9478
    reference variance = 0.394977
====================================================
  Execution time = 2.7394e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.5104e-01
  Total weights = 2.0000e+06
  Execution time = 3.4796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350993332129
                                         uncertainty =       0.017941031898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350993332129
                                         uncertainty =       0.017941031898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418950386
  error estimate for blocks of size 2^( 2) =       0.000430651608
  error estimate for blocks of size 2^( 3) =       0.000443480511
  error estimate for blocks of size 2^( 4) =       0.000455650550
  error estimate for blocks of size 2^( 5) =       0.000466263956
  error estimate for blocks of size 2^( 6) =       0.000473863716
  error estimate for blocks of size 2^( 7) =       0.000479651185

      target function =                  N/A
              le_mean =     -16.909874217190
             les_mean =     286.294884718334
             stat err =       0.000468857352
             autocorr =       1.252438096774
              std dev =       0.592485318517
             le_variance =       0.351038852658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350993332129
                                         uncertainty =       0.017941031898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350993332129
                                         uncertainty =       0.017941031898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418950386
  error estimate for blocks of size 2^( 2) =       0.000430651608
  error estimate for blocks of size 2^( 3) =       0.000443480511
  error estimate for blocks of size 2^( 4) =       0.000455650550
  error estimate for blocks of size 2^( 5) =       0.000466263956
  error estimate for blocks of size 2^( 6) =       0.000473863716
  error estimate for blocks of size 2^( 7) =       0.000479651185

      target function =                  N/A
              le_mean =     -16.909874217190
             les_mean =     286.294884718334
             stat err =       0.000468857352
             autocorr =       1.252438096774
              std dev =       0.592485318517
             le_variance =       0.351038852658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350993332129
                                         uncertainty =       0.017941031898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350993332129
                                         uncertainty =       0.017941031898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418950386
  error estimate for blocks of size 2^( 2) =       0.000430651608
  error estimate for blocks of size 2^( 3) =       0.000443480511
  error estimate for blocks of size 2^( 4) =       0.000455650550
  error estimate for blocks of size 2^( 5) =       0.000466263956
  error estimate for blocks of size 2^( 6) =       0.000473863716
  error estimate for blocks of size 2^( 7) =       0.000479651185

      target function =                  N/A
              le_mean =     -16.909874217190
             les_mean =     286.294884718334
             stat err =       0.000468857352
             autocorr =       1.252438096774
              std dev =       0.592485318517
             le_variance =       0.351038852658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350993332129
                                         uncertainty =       0.017941031898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350993332129
                                         uncertainty =       0.017941031898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418950386
  error estimate for blocks of size 2^( 2) =       0.000430651608
  error estimate for blocks of size 2^( 3) =       0.000443480511
  error estimate for blocks of size 2^( 4) =       0.000455650550
  error estimate for blocks of size 2^( 5) =       0.000466263956
  error estimate for blocks of size 2^( 6) =       0.000473863716
  error estimate for blocks of size 2^( 7) =       0.000479651185

      target function =                  N/A
              le_mean =     -16.909874217190
             les_mean =     286.294884718334
             stat err =       0.000468857352
             autocorr =       1.252438096774
              std dev =       0.592485318517
             le_variance =       0.351038852658


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909874217190        initial  <--
     1.5259e+19     1.5259e+20             4.9768e-24       -16.909874217190
     6.1035e+19     6.1035e+20             1.2442e-24       -16.909874217190
     2.4414e+20     2.4414e+21             3.1105e-25       -16.909874217190

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7961
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.2065e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9331
    reference variance = 0.800957
====================================================
  Execution time = 2.7925e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3726e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.2717e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337324168908
                                         uncertainty =       0.006613865613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337324168908
                                         uncertainty =       0.006613865613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410648617
  error estimate for blocks of size 2^( 2) =       0.000422130696
  error estimate for blocks of size 2^( 3) =       0.000434591157
  error estimate for blocks of size 2^( 4) =       0.000445813358
  error estimate for blocks of size 2^( 5) =       0.000453714962
  error estimate for blocks of size 2^( 6) =       0.000462589371
  error estimate for blocks of size 2^( 7) =       0.000467721148

      target function =                  N/A
              le_mean =     -16.910356034579
             les_mean =     286.297405620078
             stat err =       0.000457459710
             autocorr =       1.240980542402
              std dev =       0.580744842842
             le_variance =       0.337264572487


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691035603458e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+20, overlap shift 1.5259e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910356034579       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910356034579       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910356034579       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+20 is 4.477491e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+20, overlap shift 6.1035e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910356034579       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910356034579       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910356034579       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+20 is 1.119373e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+21, overlap shift 2.4414e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910356034579       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910356034579       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910356034579       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+21 is 2.798432e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.341581 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5202e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8726
    reference variance = 0.204723
====================================================
  Execution time = 2.7374e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3994e-01
  Total weights = 2.0000e+06
  Execution time = 3.4797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339928399034
                                         uncertainty =       0.004581197337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339928399034
                                         uncertainty =       0.004581197337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412272020
  error estimate for blocks of size 2^( 2) =       0.000424127266
  error estimate for blocks of size 2^( 3) =       0.000436135716
  error estimate for blocks of size 2^( 4) =       0.000449096831
  error estimate for blocks of size 2^( 5) =       0.000460323523
  error estimate for blocks of size 2^( 6) =       0.000469157551
  error estimate for blocks of size 2^( 7) =       0.000472554425

      target function =                  N/A
              le_mean =     -16.909941152591
             les_mean =     286.286046051122
             stat err =       0.000462783082
             autocorr =       1.260048397599
              std dev =       0.583040682117
             le_variance =       0.339936437004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339928399034
                                         uncertainty =       0.004581197337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339928399034
                                         uncertainty =       0.004581197337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412272020
  error estimate for blocks of size 2^( 2) =       0.000424127266
  error estimate for blocks of size 2^( 3) =       0.000436135716
  error estimate for blocks of size 2^( 4) =       0.000449096831
  error estimate for blocks of size 2^( 5) =       0.000460323523
  error estimate for blocks of size 2^( 6) =       0.000469157551
  error estimate for blocks of size 2^( 7) =       0.000472554425

      target function =                  N/A
              le_mean =     -16.909941152591
             les_mean =     286.286046051122
             stat err =       0.000462783082
             autocorr =       1.260048397599
              std dev =       0.583040682117
             le_variance =       0.339936437004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339928399034
                                         uncertainty =       0.004581197337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339928399034
                                         uncertainty =       0.004581197337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412272020
  error estimate for blocks of size 2^( 2) =       0.000424127266
  error estimate for blocks of size 2^( 3) =       0.000436135716
  error estimate for blocks of size 2^( 4) =       0.000449096831
  error estimate for blocks of size 2^( 5) =       0.000460323523
  error estimate for blocks of size 2^( 6) =       0.000469157551
  error estimate for blocks of size 2^( 7) =       0.000472554425

      target function =                  N/A
              le_mean =     -16.909941152591
             les_mean =     286.286046051122
             stat err =       0.000462783082
             autocorr =       1.260048397599
              std dev =       0.583040682117
             le_variance =       0.339936437004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339928399034
                                         uncertainty =       0.004581197337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339928399034
                                         uncertainty =       0.004581197337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412272020
  error estimate for blocks of size 2^( 2) =       0.000424127266
  error estimate for blocks of size 2^( 3) =       0.000436135716
  error estimate for blocks of size 2^( 4) =       0.000449096831
  error estimate for blocks of size 2^( 5) =       0.000460323523
  error estimate for blocks of size 2^( 6) =       0.000469157551
  error estimate for blocks of size 2^( 7) =       0.000472554425

      target function =                  N/A
              le_mean =     -16.909941152591
             les_mean =     286.286046051122
             stat err =       0.000462783082
             autocorr =       1.260048397599
              std dev =       0.583040682117
             le_variance =       0.339936437004


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909941152591        initial  <--
     1.5259e+20     1.5259e+21             4.4775e-25       -16.909941152591
     6.1035e+20     6.1035e+21             1.1194e-25       -16.909941152591
     2.4414e+21     2.4414e+22             2.7984e-26       -16.909941152591

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7160
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9926e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9323
    reference variance = 0.277247
====================================================
  Execution time = 2.7923e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4295e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.3467e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343085482094
                                         uncertainty =       0.008649489044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343085482094
                                         uncertainty =       0.008649489044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414092570
  error estimate for blocks of size 2^( 2) =       0.000425558708
  error estimate for blocks of size 2^( 3) =       0.000438011068
  error estimate for blocks of size 2^( 4) =       0.000449409130
  error estimate for blocks of size 2^( 5) =       0.000460124960
  error estimate for blocks of size 2^( 6) =       0.000467551012
  error estimate for blocks of size 2^( 7) =       0.000473674025

      target function =                  N/A
              le_mean =     -16.909776683833
             les_mean =     286.283492639456
             stat err =       0.000462689782
             autocorr =       1.248489630805
              std dev =       0.585615329227
             le_variance =       0.342945313826


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690977668383e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+21, overlap shift 1.5259e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909776683833       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909776683833       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+21, overlap shift 6.1035e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909776683833       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909776683833       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+22, overlap shift 2.4414e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909776683833       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909776683833       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.342713 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5275e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9534
    reference variance = 0.276428
====================================================
  Execution time = 2.7669e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3743e-01
  Total weights = 2.0000e+06
  Execution time = 3.4606e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337527331428
                                         uncertainty =       0.004857117617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337527331428
                                         uncertainty =       0.004857117617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410752267
  error estimate for blocks of size 2^( 2) =       0.000422375114
  error estimate for blocks of size 2^( 3) =       0.000434598218
  error estimate for blocks of size 2^( 4) =       0.000445694369
  error estimate for blocks of size 2^( 5) =       0.000454827602
  error estimate for blocks of size 2^( 6) =       0.000463318059
  error estimate for blocks of size 2^( 7) =       0.000465849998

      target function =                  N/A
              le_mean =     -16.910688300738
             les_mean =     286.308813486213
             stat err =       0.000457422507
             autocorr =       1.240152579916
              std dev =       0.580891427225
             le_variance =       0.337434850224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337527331428
                                         uncertainty =       0.004857117617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337527331428
                                         uncertainty =       0.004857117617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410752267
  error estimate for blocks of size 2^( 2) =       0.000422375114
  error estimate for blocks of size 2^( 3) =       0.000434598218
  error estimate for blocks of size 2^( 4) =       0.000445694369
  error estimate for blocks of size 2^( 5) =       0.000454827602
  error estimate for blocks of size 2^( 6) =       0.000463318059
  error estimate for blocks of size 2^( 7) =       0.000465849998

      target function =                  N/A
              le_mean =     -16.910688300738
             les_mean =     286.308813486213
             stat err =       0.000457422507
             autocorr =       1.240152579916
              std dev =       0.580891427225
             le_variance =       0.337434850224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337527331428
                                         uncertainty =       0.004857117617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337527331428
                                         uncertainty =       0.004857117617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410752267
  error estimate for blocks of size 2^( 2) =       0.000422375114
  error estimate for blocks of size 2^( 3) =       0.000434598218
  error estimate for blocks of size 2^( 4) =       0.000445694369
  error estimate for blocks of size 2^( 5) =       0.000454827602
  error estimate for blocks of size 2^( 6) =       0.000463318059
  error estimate for blocks of size 2^( 7) =       0.000465849998

      target function =                  N/A
              le_mean =     -16.910688300738
             les_mean =     286.308813486213
             stat err =       0.000457422507
             autocorr =       1.240152579916
              std dev =       0.580891427225
             le_variance =       0.337434850224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337527331428
                                         uncertainty =       0.004857117617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337527331428
                                         uncertainty =       0.004857117617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410752267
  error estimate for blocks of size 2^( 2) =       0.000422375114
  error estimate for blocks of size 2^( 3) =       0.000434598218
  error estimate for blocks of size 2^( 4) =       0.000445694369
  error estimate for blocks of size 2^( 5) =       0.000454827602
  error estimate for blocks of size 2^( 6) =       0.000463318059
  error estimate for blocks of size 2^( 7) =       0.000465849998

      target function =                  N/A
              le_mean =     -16.910688300738
             les_mean =     286.308813486213
             stat err =       0.000457422507
             autocorr =       1.240152579916
              std dev =       0.580891427225
             le_variance =       0.337434850224


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910688300738        initial  <--
     1.5259e+21     1.5259e+22             0.0000e+00       -16.910688300738
     6.1035e+21     6.1035e+22             0.0000e+00       -16.910688300738
     2.4414e+22     2.4414e+23             0.0000e+00       -16.910688300738

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0473
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0330e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8544
    reference variance = 0.35192
====================================================
  Execution time = 2.7915e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4037e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.3100e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340458079279
                                         uncertainty =       0.005056969509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340458079279
                                         uncertainty =       0.005056969509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412533777
  error estimate for blocks of size 2^( 2) =       0.000423511787
  error estimate for blocks of size 2^( 3) =       0.000435288427
  error estimate for blocks of size 2^( 4) =       0.000446816827
  error estimate for blocks of size 2^( 5) =       0.000456935610
  error estimate for blocks of size 2^( 6) =       0.000464871935
  error estimate for blocks of size 2^( 7) =       0.000467738567

      target function =                  N/A
              le_mean =     -16.909727230015
             les_mean =     286.279243058075
             stat err =       0.000459090735
             autocorr =       1.238448721766
              std dev =       0.583410862735
             le_variance =       0.340368234757


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690972723001e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+22, overlap shift 1.5259e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909727230015       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909727230015       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909727230015       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+22 is 3.695593e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+22, overlap shift 6.1035e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909727230015       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909727230015       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909727230015       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+22 is 9.238981e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+23, overlap shift 2.4414e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909727230015       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909727230015       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909727230015       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+23 is 2.309745e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.344119 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5230e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.957
    reference variance = 0.332868
====================================================
  Execution time = 2.7306e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3880e-01
  Total weights = 2.0000e+06
  Execution time = 3.4567e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338939157317
                                         uncertainty =       0.003328762323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338939157317
                                         uncertainty =       0.003328762323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411583874
  error estimate for blocks of size 2^( 2) =       0.000423267186
  error estimate for blocks of size 2^( 3) =       0.000435576864
  error estimate for blocks of size 2^( 4) =       0.000446931289
  error estimate for blocks of size 2^( 5) =       0.000457471165
  error estimate for blocks of size 2^( 6) =       0.000466201235
  error estimate for blocks of size 2^( 7) =       0.000471889012

      target function =                  N/A
              le_mean =     -16.910141505228
             les_mean =     286.291688128618
             stat err =       0.000460623175
             autocorr =       1.252491731645
              std dev =       0.582067497101
             le_variance =       0.338802571181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338939157317
                                         uncertainty =       0.003328762323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338939157317
                                         uncertainty =       0.003328762323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411583874
  error estimate for blocks of size 2^( 2) =       0.000423267186
  error estimate for blocks of size 2^( 3) =       0.000435576864
  error estimate for blocks of size 2^( 4) =       0.000446931289
  error estimate for blocks of size 2^( 5) =       0.000457471165
  error estimate for blocks of size 2^( 6) =       0.000466201235
  error estimate for blocks of size 2^( 7) =       0.000471889012

      target function =                  N/A
              le_mean =     -16.910141505228
             les_mean =     286.291688128618
             stat err =       0.000460623175
             autocorr =       1.252491731645
              std dev =       0.582067497101
             le_variance =       0.338802571181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338939157317
                                         uncertainty =       0.003328762323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338939157317
                                         uncertainty =       0.003328762323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411583874
  error estimate for blocks of size 2^( 2) =       0.000423267186
  error estimate for blocks of size 2^( 3) =       0.000435576864
  error estimate for blocks of size 2^( 4) =       0.000446931289
  error estimate for blocks of size 2^( 5) =       0.000457471165
  error estimate for blocks of size 2^( 6) =       0.000466201235
  error estimate for blocks of size 2^( 7) =       0.000471889012

      target function =                  N/A
              le_mean =     -16.910141505228
             les_mean =     286.291688128618
             stat err =       0.000460623175
             autocorr =       1.252491731645
              std dev =       0.582067497101
             le_variance =       0.338802571181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338939157317
                                         uncertainty =       0.003328762323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338939157317
                                         uncertainty =       0.003328762323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411583874
  error estimate for blocks of size 2^( 2) =       0.000423267186
  error estimate for blocks of size 2^( 3) =       0.000435576864
  error estimate for blocks of size 2^( 4) =       0.000446931289
  error estimate for blocks of size 2^( 5) =       0.000457471165
  error estimate for blocks of size 2^( 6) =       0.000466201235
  error estimate for blocks of size 2^( 7) =       0.000471889012

      target function =                  N/A
              le_mean =     -16.910141505228
             les_mean =     286.291688128618
             stat err =       0.000460623175
             autocorr =       1.252491731645
              std dev =       0.582067497101
             le_variance =       0.338802571181


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910141505228        initial  <--
     1.5259e+22     1.5259e+23             3.6956e-27       -16.910141505228
     6.1035e+22     6.1035e+23             9.2390e-28       -16.910141505228
     2.4414e+23     2.4414e+24             2.3097e-28       -16.910141505228

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.0546
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4292e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8901
    reference variance = 0.16645
====================================================
  Execution time = 2.7762e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4151e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1221e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341619512685
                                         uncertainty =       0.005458180770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341619512685
                                         uncertainty =       0.005458180770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413225260
  error estimate for blocks of size 2^( 2) =       0.000424723121
  error estimate for blocks of size 2^( 3) =       0.000436398621
  error estimate for blocks of size 2^( 4) =       0.000446930174
  error estimate for blocks of size 2^( 5) =       0.000456400644
  error estimate for blocks of size 2^( 6) =       0.000462845663
  error estimate for blocks of size 2^( 7) =       0.000467856516

      target function =                  N/A
              le_mean =     -16.910652542813
             les_mean =     286.311679484294
             stat err =       0.000458508249
             autocorr =       1.231177255006
              std dev =       0.584388767260
             le_variance =       0.341510231300


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691065254281e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+23, overlap shift 1.5259e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910652542813       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910652542813       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+23, overlap shift 6.1035e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910652542813       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910652542813       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+24, overlap shift 2.4414e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910652542813       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910652542813       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.345278 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4889e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9065
    reference variance = 0.227373
====================================================
  Execution time = 2.7377e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.5208e-01
  Total weights = 2.0000e+06
  Execution time = 3.4566e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352198107316
                                         uncertainty =       0.013100938840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352198107316
                                         uncertainty =       0.013100938840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419571737
  error estimate for blocks of size 2^( 2) =       0.000431080645
  error estimate for blocks of size 2^( 3) =       0.000442891184
  error estimate for blocks of size 2^( 4) =       0.000453542883
  error estimate for blocks of size 2^( 5) =       0.000463959327
  error estimate for blocks of size 2^( 6) =       0.000471070794
  error estimate for blocks of size 2^( 7) =       0.000475078628

      target function =                  N/A
              le_mean =     -16.910754922514
             les_mean =     286.325712758290
             stat err =       0.000465912908
             autocorr =       1.233096411633
              std dev =       0.593364040859
             le_variance =       0.352080884984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352198107316
                                         uncertainty =       0.013100938840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352198107316
                                         uncertainty =       0.013100938840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419571737
  error estimate for blocks of size 2^( 2) =       0.000431080645
  error estimate for blocks of size 2^( 3) =       0.000442891184
  error estimate for blocks of size 2^( 4) =       0.000453542883
  error estimate for blocks of size 2^( 5) =       0.000463959327
  error estimate for blocks of size 2^( 6) =       0.000471070794
  error estimate for blocks of size 2^( 7) =       0.000475078628

      target function =                  N/A
              le_mean =     -16.910754922514
             les_mean =     286.325712758290
             stat err =       0.000465912908
             autocorr =       1.233096411633
              std dev =       0.593364040859
             le_variance =       0.352080884984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352198107316
                                         uncertainty =       0.013100938840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352198107316
                                         uncertainty =       0.013100938840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419571737
  error estimate for blocks of size 2^( 2) =       0.000431080645
  error estimate for blocks of size 2^( 3) =       0.000442891184
  error estimate for blocks of size 2^( 4) =       0.000453542883
  error estimate for blocks of size 2^( 5) =       0.000463959327
  error estimate for blocks of size 2^( 6) =       0.000471070794
  error estimate for blocks of size 2^( 7) =       0.000475078628

      target function =                  N/A
              le_mean =     -16.910754922514
             les_mean =     286.325712758290
             stat err =       0.000465912908
             autocorr =       1.233096411633
              std dev =       0.593364040859
             le_variance =       0.352080884984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352198107316
                                         uncertainty =       0.013100938840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352198107316
                                         uncertainty =       0.013100938840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419571737
  error estimate for blocks of size 2^( 2) =       0.000431080645
  error estimate for blocks of size 2^( 3) =       0.000442891184
  error estimate for blocks of size 2^( 4) =       0.000453542883
  error estimate for blocks of size 2^( 5) =       0.000463959327
  error estimate for blocks of size 2^( 6) =       0.000471070794
  error estimate for blocks of size 2^( 7) =       0.000475078628

      target function =                  N/A
              le_mean =     -16.910754922514
             les_mean =     286.325712758290
             stat err =       0.000465912908
             autocorr =       1.233096411633
              std dev =       0.593364040859
             le_variance =       0.352080884984


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910754922514        initial  <--
     1.5259e+23     1.5259e+24             0.0000e+00       -16.910754922514
     6.1035e+23     6.1035e+24             0.0000e+00       -16.910754922514
     2.4414e+24     2.4414e+25             0.0000e+00       -16.910754922514

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.6812
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9577e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8913
    reference variance = 0.378267
====================================================
  Execution time = 2.7955e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4462e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1378e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344599722644
                                         uncertainty =       0.003709909023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344599722644
                                         uncertainty =       0.003709909023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415102234
  error estimate for blocks of size 2^( 2) =       0.000426635419
  error estimate for blocks of size 2^( 3) =       0.000439063935
  error estimate for blocks of size 2^( 4) =       0.000451608781
  error estimate for blocks of size 2^( 5) =       0.000463810908
  error estimate for blocks of size 2^( 6) =       0.000474606245
  error estimate for blocks of size 2^( 7) =       0.000478563942

      target function =                  N/A
              le_mean =     -16.910492234357
             les_mean =     286.309367165180
             stat err =       0.000467147469
             autocorr =       1.266478611027
              std dev =       0.587043209011
             le_variance =       0.344619729246


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691049223436e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+24, overlap shift 1.5259e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910492234357       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910492234357       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910492406372       residual = 7.11e+05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+24 is 2.639180e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+24, overlap shift 6.1035e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910492234357       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910492234357       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910493795412       residual = 2.85e+06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910492043661       residual = 3.40e+04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+24 is 6.597951e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+25, overlap shift 2.4414e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910492234357       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910492234357       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.346733 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5099e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8767
    reference variance = 0.200273
====================================================
  Execution time = 2.7357e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3777e-01
  Total weights = 2.0000e+06
  Execution time = 3.4631e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337863203927
                                         uncertainty =       0.004059453515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337863203927
                                         uncertainty =       0.004059453515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410959018
  error estimate for blocks of size 2^( 2) =       0.000422731901
  error estimate for blocks of size 2^( 3) =       0.000435282389
  error estimate for blocks of size 2^( 4) =       0.000447885252
  error estimate for blocks of size 2^( 5) =       0.000458552643
  error estimate for blocks of size 2^( 6) =       0.000465869360
  error estimate for blocks of size 2^( 7) =       0.000471075306

      target function =                  N/A
              le_mean =     -16.910000844745
             les_mean =     286.285903029248
             stat err =       0.000460845640
             autocorr =       1.257517209023
              std dev =       0.581183816752
             le_variance =       0.337774628854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337863203927
                                         uncertainty =       0.004059453515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337863203927
                                         uncertainty =       0.004059453515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410959018
  error estimate for blocks of size 2^( 2) =       0.000422731901
  error estimate for blocks of size 2^( 3) =       0.000435282389
  error estimate for blocks of size 2^( 4) =       0.000447885252
  error estimate for blocks of size 2^( 5) =       0.000458552643
  error estimate for blocks of size 2^( 6) =       0.000465869360
  error estimate for blocks of size 2^( 7) =       0.000471075306

      target function =                  N/A
              le_mean =     -16.910000844745
             les_mean =     286.285903029248
             stat err =       0.000460845640
             autocorr =       1.257517209023
              std dev =       0.581183816752
             le_variance =       0.337774628854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337863203927
                                         uncertainty =       0.004059453515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337863203927
                                         uncertainty =       0.004059453515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410959018
  error estimate for blocks of size 2^( 2) =       0.000422731901
  error estimate for blocks of size 2^( 3) =       0.000435282389
  error estimate for blocks of size 2^( 4) =       0.000447885252
  error estimate for blocks of size 2^( 5) =       0.000458552643
  error estimate for blocks of size 2^( 6) =       0.000465869360
  error estimate for blocks of size 2^( 7) =       0.000471075306

      target function =                  N/A
              le_mean =     -16.910000844745
             les_mean =     286.285903029248
             stat err =       0.000460845640
             autocorr =       1.257517209023
              std dev =       0.581183816752
             le_variance =       0.337774628854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337863203927
                                         uncertainty =       0.004059453515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337863203927
                                         uncertainty =       0.004059453515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410959018
  error estimate for blocks of size 2^( 2) =       0.000422731901
  error estimate for blocks of size 2^( 3) =       0.000435282389
  error estimate for blocks of size 2^( 4) =       0.000447885252
  error estimate for blocks of size 2^( 5) =       0.000458552643
  error estimate for blocks of size 2^( 6) =       0.000465869360
  error estimate for blocks of size 2^( 7) =       0.000471075306

      target function =                  N/A
              le_mean =     -16.910000844745
             les_mean =     286.285903029248
             stat err =       0.000460845640
             autocorr =       1.257517209023
              std dev =       0.581183816752
             le_variance =       0.337774628854


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910000844745        initial  <--
     1.5259e+24     1.5259e+25             2.6392e-29       -16.910000844745
     6.1035e+24     6.1035e+25             6.5980e-30       -16.910000844745
     2.4414e+25     2.4414e+26             0.0000e+00       -16.910000844745

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.6938
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9800e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 34504 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9219
    reference variance = 0.224736
====================================================
  Execution time = 2.7798e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3922e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.1724e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339250930805
                                         uncertainty =       0.004677427708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339250930805
                                         uncertainty =       0.004677427708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411838117
  error estimate for blocks of size 2^( 2) =       0.000423198413
  error estimate for blocks of size 2^( 3) =       0.000435012248
  error estimate for blocks of size 2^( 4) =       0.000446972904
  error estimate for blocks of size 2^( 5) =       0.000457986959
  error estimate for blocks of size 2^( 6) =       0.000466298155
  error estimate for blocks of size 2^( 7) =       0.000472534730

      target function =                  N/A
              le_mean =     -16.910034170740
             les_mean =     286.288476755594
             stat err =       0.000460948187
             autocorr =       1.252711726610
              std dev =       0.582427050883
             le_variance =       0.339221269601


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691003417074e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+25, overlap shift 1.5259e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910034170740       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910034170740       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.1035e+25, overlap shift 6.1035e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910034170740       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910034170740       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+26, overlap shift 2.4414e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910034170740       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910034170740       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.347878 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4975e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8338
    reference variance = 0.333662
====================================================
  Execution time = 2.7235e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.3048e-01
  Total weights = 2.0000e+06
  Execution time = 3.4657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330615418425
                                         uncertainty =       0.002901385206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330615418425
                                         uncertainty =       0.002901385206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406495572
  error estimate for blocks of size 2^( 2) =       0.000418196285
  error estimate for blocks of size 2^( 3) =       0.000430689074
  error estimate for blocks of size 2^( 4) =       0.000442670441
  error estimate for blocks of size 2^( 5) =       0.000452890542
  error estimate for blocks of size 2^( 6) =       0.000461270307
  error estimate for blocks of size 2^( 7) =       0.000467064876

      target function =                  N/A
              le_mean =     -16.909374122194
             les_mean =     286.257410339343
             stat err =       0.000455974042
             autocorr =       1.258254811892
              std dev =       0.574871551104
             le_variance =       0.330477300268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330615418425
                                         uncertainty =       0.002901385206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330615418425
                                         uncertainty =       0.002901385206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406495572
  error estimate for blocks of size 2^( 2) =       0.000418196285
  error estimate for blocks of size 2^( 3) =       0.000430689074
  error estimate for blocks of size 2^( 4) =       0.000442670441
  error estimate for blocks of size 2^( 5) =       0.000452890542
  error estimate for blocks of size 2^( 6) =       0.000461270307
  error estimate for blocks of size 2^( 7) =       0.000467064876

      target function =                  N/A
              le_mean =     -16.909374122194
             les_mean =     286.257410339343
             stat err =       0.000455974042
             autocorr =       1.258254811892
              std dev =       0.574871551104
             le_variance =       0.330477300268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330615418425
                                         uncertainty =       0.002901385206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330615418425
                                         uncertainty =       0.002901385206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406495572
  error estimate for blocks of size 2^( 2) =       0.000418196285
  error estimate for blocks of size 2^( 3) =       0.000430689074
  error estimate for blocks of size 2^( 4) =       0.000442670441
  error estimate for blocks of size 2^( 5) =       0.000452890542
  error estimate for blocks of size 2^( 6) =       0.000461270307
  error estimate for blocks of size 2^( 7) =       0.000467064876

      target function =                  N/A
              le_mean =     -16.909374122194
             les_mean =     286.257410339343
             stat err =       0.000455974042
             autocorr =       1.258254811892
              std dev =       0.574871551104
             le_variance =       0.330477300268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330615418425
                                         uncertainty =       0.002901385206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330615418425
                                         uncertainty =       0.002901385206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406495572
  error estimate for blocks of size 2^( 2) =       0.000418196285
  error estimate for blocks of size 2^( 3) =       0.000430689074
  error estimate for blocks of size 2^( 4) =       0.000442670441
  error estimate for blocks of size 2^( 5) =       0.000452890542
  error estimate for blocks of size 2^( 6) =       0.000461270307
  error estimate for blocks of size 2^( 7) =       0.000467064876

      target function =                  N/A
              le_mean =     -16.909374122194
             les_mean =     286.257410339343
             stat err =       0.000455974042
             autocorr =       1.258254811892
              std dev =       0.574871551104
             le_variance =       0.330477300268


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909374122194        initial  <--
     1.5259e+25     1.5259e+26             0.0000e+00       -16.909374122194
     6.1035e+25     6.1035e+26             0.0000e+00       -16.909374122194
     2.4414e+26     2.4414e+27             0.0000e+00       -16.909374122194

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.5547
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.103790e-01 1 1  ON 0
 uu_1                 1.452527e-01 1 1  ON 1
 uu_2                 4.714437e-02 1 1  ON 2
 uu_3                -1.665161e-02 1 1  ON 3
 uu_4                -6.730681e-02 1 1  ON 4
 uu_5                -1.046346e-01 1 1  ON 5
 uu_6                -1.336183e-01 1 1  ON 6
 uu_7                -1.483981e-01 1 1  ON 7
 uu_8                -1.420789e-01 1 1  ON 8
 uu_9                -1.136840e-01 1 1  ON 9
 ud_0                 4.381310e-01 1 1  ON 10
 ud_1                 1.811497e-01 1 1  ON 11
 ud_2                 6.688545e-02 1 1  ON 12
 ud_3                -2.369286e-03 1 1  ON 13
 ud_4                -5.865174e-02 1 1  ON 14
 ud_5                -1.017969e-01 1 1  ON 15
 ud_6                -1.313468e-01 1 1  ON 16
 ud_7                -1.519660e-01 1 1  ON 17
 ud_8                -1.563799e-01 1 1  ON 18
 ud_9                -1.462335e-01 1 1  ON 19
 eO_0                -7.499079e-01 1 1  ON 20
 eO_1                -4.329516e-01 1 1  ON 21
 eO_2                -1.089672e-02 1 1  ON 22
 eO_3                 3.130634e-01 1 1  ON 23
 eO_4                 5.356520e-01 1 1  ON 24
 eO_5                 4.901561e-01 1 1  ON 25
 eO_6                 2.521881e-01 1 1  ON 26
 eO_7                -5.286832e-02 1 1  ON 27
 eO_8                -2.396675e-01 1 1  ON 28
 eO_9                -1.015701e-01 1 1  ON 29
eH1_0                -2.694189e-01 1 1  ON 30
eH1_1                -1.627827e-01 1 1  ON 31
eH1_2                -1.193841e-01 1 1  ON 32
eH1_3                -6.625761e-02 1 1  ON 33
eH1_4                -6.679753e-03 1 1  ON 34
eH1_5                 3.776923e-02 1 1  ON 35
eH1_6                 1.096079e-01 1 1  ON 36
eH1_7                 1.752243e-01 1 1  ON 37
eH1_8                 2.049504e-01 1 1  ON 38
eH1_9                 9.470401e-02 1 1  ON 39
eH2_0                -2.669707e-01 1 1  ON 40
eH2_1                -1.607079e-01 1 1  ON 41
eH2_2                -1.171339e-01 1 1  ON 42
eH2_3                -6.377688e-02 1 1  ON 43
eH2_4                -4.015082e-03 1 1  ON 44
eH2_5                 3.958438e-02 1 1  ON 45
eH2_6                 1.105059e-01 1 1  ON 46
eH2_7                 1.732253e-01 1 1  ON 47
eH2_8                 2.094903e-01 1 1  ON 48
eH2_9                 9.005584e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9552e+01 secs
  Total Execution time = 3.2342e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
