Rank =    0  Free Memory = 86697 MB
Rank =    1  Free Memory = 86697 MB
Rank =    2  Free Memory = 86697 MB
Rank =    3  Free Memory = 86697 MB
Rank =    4  Free Memory = 86697 MB
Rank =    5  Free Memory = 86697 MB
Rank =    6  Free Memory = 86696 MB
Rank =    7  Free Memory = 86695 MB
Rank =    8  Free Memory = 86695 MB
Rank =    9  Free Memory = 86695 MB
Rank =   10  Free Memory = 86695 MB
Rank =   11  Free Memory = 86695 MB
Rank =   12  Free Memory = 86695 MB
Rank =   13  Free Memory = 86695 MB
Rank =   14  Free Memory = 86694 MB
Rank =   15  Free Memory = 86680 MB
Rank =   16  Free Memory = 86680 MB
Rank =   17  Free Memory = 86680 MB
Rank =   18  Free Memory = 86680 MB
Rank =   19  Free Memory = 86679 MB
Rank =   20  Free Memory = 86679 MB
Rank =   21  Free Memory = 86679 MB
Rank =   22  Free Memory = 86679 MB
Rank =   23  Free Memory = 86679 MB
Rank =   24  Free Memory = 86679 MB
Rank =   25  Free Memory = 86679 MB
Rank =   26  Free Memory = 86679 MB
Rank =   27  Free Memory = 86679 MB
Rank =   28  Free Memory = 86679 MB
Rank =   29  Free Memory = 86679 MB
Rank =   30  Free Memory = 86679 MB
Rank =   31  Free Memory = 86679 MB
Rank =   32  Free Memory = 74228 MB
Rank =   33  Free Memory = 74228 MB
Rank =   34  Free Memory = 74228 MB
Rank =   35  Free Memory = 74228 MB
Rank =   36  Free Memory = 74228 MB
Rank =   37  Free Memory = 74228 MB
Rank =   38  Free Memory = 74228 MB
Rank =   39  Free Memory = 74228 MB
Rank =   40  Free Memory = 74228 MB
Rank =   41  Free Memory = 74228 MB
Rank =   42  Free Memory = 74228 MB
Rank =   43  Free Memory = 74228 MB
Rank =   44  Free Memory = 74228 MB
Rank =   45  Free Memory = 74228 MB
Rank =   46  Free Memory = 74228 MB
Rank =   47  Free Memory = 74228 MB
Rank =   48  Free Memory = 74228 MB
Rank =   49  Free Memory = 74228 MB
Rank =   50  Free Memory = 74228 MB
Rank =   51  Free Memory = 74228 MB
Rank =   52  Free Memory = 74228 MB
Rank =   53  Free Memory = 74228 MB
Rank =   54  Free Memory = 74228 MB
Rank =   55  Free Memory = 74228 MB
Rank =   56  Free Memory = 74228 MB
Rank =   57  Free Memory = 74228 MB
Rank =   58  Free Memory = 74228 MB
Rank =   59  Free Memory = 74228 MB
Rank =   60  Free Memory = 74228 MB
Rank =   61  Free Memory = 74228 MB
Rank =   62  Free Memory = 74228 MB
Rank =   63  Free Memory = 74228 MB
Rank =   64  Free Memory = 75901 MB
Rank =   65  Free Memory = 75901 MB
Rank =   66  Free Memory = 75901 MB
Rank =   67  Free Memory = 75901 MB
Rank =   68  Free Memory = 75901 MB
Rank =   69  Free Memory = 75901 MB
Rank =   70  Free Memory = 75901 MB
Rank =   71  Free Memory = 75901 MB
Rank =   72  Free Memory = 75901 MB
Rank =   73  Free Memory = 75901 MB
Rank =   74  Free Memory = 75901 MB
Rank =   75  Free Memory = 75901 MB
Rank =   76  Free Memory = 75901 MB
Rank =   77  Free Memory = 75901 MB
Rank =   78  Free Memory = 75901 MB
Rank =   79  Free Memory = 75901 MB
Rank =   80  Free Memory = 75901 MB
Rank =   81  Free Memory = 75901 MB
Rank =   82  Free Memory = 75901 MB
Rank =   83  Free Memory = 75901 MB
Rank =   84  Free Memory = 75901 MB
Rank =   85  Free Memory = 75901 MB
Rank =   86  Free Memory = 75901 MB
Rank =   87  Free Memory = 75901 MB
Rank =   88  Free Memory = 75901 MB
Rank =   89  Free Memory = 75901 MB
Rank =   90  Free Memory = 75901 MB
Rank =   91  Free Memory = 75901 MB
Rank =   92  Free Memory = 75901 MB
Rank =   93  Free Memory = 75901 MB
Rank =   94  Free Memory = 75901 MB
Rank =   95  Free Memory = 75901 MB
Rank =   96  Free Memory = 78098 MB
Rank =   97  Free Memory = 78098 MB
Rank =   98  Free Memory = 78098 MB
Rank =   99  Free Memory = 78098 MB
Rank =  100  Free Memory = 78098 MB
Rank =  101  Free Memory = 78098 MB
Rank =  102  Free Memory = 78098 MB
Rank =  103  Free Memory = 78098 MB
Rank =  104  Free Memory = 78098 MB
Rank =  105  Free Memory = 78098 MB
Rank =  106  Free Memory = 78098 MB
Rank =  107  Free Memory = 78098 MB
Rank =  108  Free Memory = 78098 MB
Rank =  109  Free Memory = 78098 MB
Rank =  110  Free Memory = 78098 MB
Rank =  111  Free Memory = 78098 MB
Rank =  112  Free Memory = 78098 MB
Rank =  113  Free Memory = 78098 MB
Rank =  114  Free Memory = 78098 MB
Rank =  115  Free Memory = 78098 MB
Rank =  116  Free Memory = 78098 MB
Rank =  117  Free Memory = 78098 MB
Rank =  118  Free Memory = 78098 MB
Rank =  119  Free Memory = 78098 MB
Rank =  120  Free Memory = 78098 MB
Rank =  121  Free Memory = 78098 MB
Rank =  122  Free Memory = 78098 MB
Rank =  123  Free Memory = 78098 MB
Rank =  124  Free Memory = 78098 MB
Rank =  125  Free Memory = 78098 MB
Rank =  126  Free Memory = 78098 MB
Rank =  127  Free Memory = 78098 MB
  Input file(s): opt_h2o_1b1_gvptt_run003j.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run003j.xml

  Project = H2O
  date    = 2023-04-10 18:25:33 PDT
  host    = n0024.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 781

  Range of prime numbers to use as seeds over processors and threads = 5987-7109


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.098011e-01    1         1  ON     0
     uu_1                 1.428665e-01    1         1  ON     1
     uu_2                 4.144438e-02    1         1  ON     2
     uu_3                -2.064493e-02    1         1  ON     3
     uu_4                -6.555940e-02    1         1  ON     4
     uu_5                -9.944264e-02    1         1  ON     5
     uu_6                -1.260239e-01    1         1  ON     6
     uu_7                -1.383245e-01    1         1  ON     7
     uu_8                -1.303820e-01    1         1  ON     8
     uu_9                -9.996240e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.468371e-01    1         1  ON     0
     ud_1                 1.809923e-01    1         1  ON     1
     ud_2                 6.096122e-02    1         1  ON     2
     ud_3                -1.012007e-02    1         1  ON     3
     ud_4                -6.682822e-02    1         1  ON     4
     ud_5                -1.077120e-01    1         1  ON     5
     ud_6                -1.343622e-01    1         1  ON     6
     ud_7                -1.499599e-01    1         1  ON     7
     ud_8                -1.503533e-01    1         1  ON     8
     ud_9                -1.383543e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.564292e-01    1         1  ON     0
     eO_1                -4.360220e-01    1         1  ON     1
     eO_2                -1.913318e-02    1         1  ON     2
     eO_3                 2.975130e-01    1         1  ON     3
     eO_4                 5.204151e-01    1         1  ON     4
     eO_5                 4.792935e-01    1         1  ON     5
     eO_6                 2.486841e-01    1         1  ON     6
     eO_7                -4.872769e-02    1         1  ON     7
     eO_8                -2.127030e-01    1         1  ON     8
     eO_9                -7.334317e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.428983e-01    1         1  ON     0
     eH1_1                -1.405727e-01    1         1  ON     1
     eH1_2                -9.350645e-02    1         1  ON     2
     eH1_3                -3.911603e-02    1         1  ON     3
     eH1_4                 8.721498e-03    1         1  ON     4
     eH1_5                 4.211828e-02    1         1  ON     5
     eH1_6                 9.903702e-02    1         1  ON     6
     eH1_7                 1.509735e-01    1         1  ON     7
     eH1_8                 1.670556e-01    1         1  ON     8
     eH1_9                 5.258359e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.407511e-01    1         1  ON     0
     eH2_1                -1.390004e-01    1         1  ON     1
     eH2_2                -9.194492e-02    1         1  ON     2
     eH2_3                -3.764332e-02    1         1  ON     3
     eH2_4                 1.101621e-02    1         1  ON     4
     eH2_5                 4.615159e-02    1         1  ON     5
     eH2_6                 1.031960e-01    1         1  ON     6
     eH2_7                 1.544422e-01    1         1  ON     7
     eH2_8                 1.728208e-01    1         1  ON     8
     eH2_9                 3.834226e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 6.528458e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.6193e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8077
    reference variance = 0.239967
====================================================
  Execution time = 2.0545e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3898e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5466e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338971280189
                                         uncertainty =       0.004168235462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338971280189
                                         uncertainty =       0.004168235462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411694505
  error estimate for blocks of size 2^( 2) =       0.000424140653
  error estimate for blocks of size 2^( 3) =       0.000436903890
  error estimate for blocks of size 2^( 4) =       0.000448796358
  error estimate for blocks of size 2^( 5) =       0.000459030664
  error estimate for blocks of size 2^( 6) =       0.000467867724
  error estimate for blocks of size 2^( 7) =       0.000472005349

      target function =                  N/A
              le_mean =     -16.905864744581
             les_mean =     286.147247323522
             stat err =       0.000461925024
             autocorr =       1.258904652455
              std dev =       0.582223952573
             le_variance =       0.338984730950


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690586474458e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905864744581       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905867226949       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905868259020       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905866913365       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905866952835       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905869871150       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905868378280       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905868425355       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905868929927       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905868850120       residual = 7.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.251285e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905864744581       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905865679718       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905865778672       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905865659589       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905866087914       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905866025491       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905866084121       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905866040073       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905866022609       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.545623e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905864744581       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905865012286       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905865010750       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905865027515       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905865135519       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905865146660       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905865120645       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905865127248       residual = 8.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 6.506352e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101386 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6202e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.099434e-01                 1 1 ON  0
uu_1  1.429169e-01                 1 1 ON  1
uu_2  4.148328e-02                 1 1 ON  2
uu_3  -2.057665e-02                1 1 ON  3
uu_4  -6.555638e-02                1 1 ON  4
uu_5  -9.949210e-02                1 1 ON  5
uu_6  -1.261010e-01                1 1 ON  6
uu_7  -1.384415e-01                1 1 ON  7
uu_8  -1.305520e-01                1 1 ON  8
uu_9  -1.001203e-01                1 1 ON  9
ud_0  4.469845e-01                 1 1 ON  10
ud_1  1.810893e-01                 1 1 ON  11
ud_2  6.089763e-02                 1 1 ON  12
ud_3  -1.006356e-02                1 1 ON  13
ud_4  -6.680737e-02                1 1 ON  14
ud_5  -1.078387e-01                1 1 ON  15
ud_6  -1.343008e-01                1 1 ON  16
ud_7  -1.500095e-01                1 1 ON  17
ud_8  -1.505015e-01                1 1 ON  18
ud_9  -1.383999e-01                1 1 ON  19
eO_0  -7.564130e-01                1 1 ON  20
eO_1  -4.359337e-01                1 1 ON  21
eO_2  -1.923118e-02                1 1 ON  22
eO_3  2.974598e-01                 1 1 ON  23
eO_4  5.204995e-01                 1 1 ON  24
eO_5  4.794281e-01                 1 1 ON  25
eO_6  2.488011e-01                 1 1 ON  26
eO_7  -4.868608e-02                1 1 ON  27
eO_8  -2.128951e-01                1 1 ON  28
eO_9  -7.347339e-02                1 1 ON  29
eH1_0 -2.431161e-01                1 1 ON  30
eH1_1 -1.406656e-01                1 1 ON  31
eH1_2 -9.344295e-02                1 1 ON  32
eH1_3 -3.919314e-02                1 1 ON  33
eH1_4 8.636635e-03                 1 1 ON  34
eH1_5 4.211791e-02                 1 1 ON  35
eH1_6 9.904963e-02                 1 1 ON  36
eH1_7 1.509706e-01                 1 1 ON  37
eH1_8 1.671993e-01                 1 1 ON  38
eH1_9 5.279988e-02                 1 1 ON  39
eH2_0 -2.410057e-01                1 1 ON  40
eH2_1 -1.391390e-01                1 1 ON  41
eH2_2 -9.189666e-02                1 1 ON  42
eH2_3 -3.763983e-02                1 1 ON  43
eH2_4 1.101861e-02                 1 1 ON  44
eH2_5 4.615440e-02                 1 1 ON  45
eH2_6 1.031905e-01                 1 1 ON  46
eH2_7 1.544852e-01                 1 1 ON  47
eH2_8 1.729097e-01                 1 1 ON  48
eH2_9 3.851648e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9299
    reference variance = 0.357748
====================================================
  Execution time = 2.2689e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3500e-01
  Total weights = 2.0000e+06
  Execution time = 1.8745e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334901371885
                                         uncertainty =       0.003804099533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334901371885
                                         uncertainty =       0.003804099533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409190710
  error estimate for blocks of size 2^( 2) =       0.000421984869
  error estimate for blocks of size 2^( 3) =       0.000434496999
  error estimate for blocks of size 2^( 4) =       0.000447339583
  error estimate for blocks of size 2^( 5) =       0.000458481461
  error estimate for blocks of size 2^( 6) =       0.000466741729
  error estimate for blocks of size 2^( 7) =       0.000471194925

      target function =                  N/A
              le_mean =     -16.905403059603
             les_mean =     286.127526514267
             stat err =       0.000460939425
             autocorr =       1.268925662313
              std dev =       0.578683051477
             le_variance =       0.334874074066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335170203789
                                         uncertainty =       0.003809150815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335170203789
                                         uncertainty =       0.003809150815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409354855
  error estimate for blocks of size 2^( 2) =       0.000422132931
  error estimate for blocks of size 2^( 3) =       0.000434627899
  error estimate for blocks of size 2^( 4) =       0.000447458793
  error estimate for blocks of size 2^( 5) =       0.000458600972
  error estimate for blocks of size 2^( 6) =       0.000466865032
  error estimate for blocks of size 2^( 7) =       0.000471320407

      target function =                  N/A
              le_mean =     -16.905407618361
             les_mean =     286.127949369268
             stat err =       0.000461061301
             autocorr =       1.268578810684
              std dev =       0.578915187129
             le_variance =       0.335142793889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335152008251
                                         uncertainty =       0.003808440833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335152008251
                                         uncertainty =       0.003808440833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409343759
  error estimate for blocks of size 2^( 2) =       0.000422123911
  error estimate for blocks of size 2^( 3) =       0.000434622174
  error estimate for blocks of size 2^( 4) =       0.000447455897
  error estimate for blocks of size 2^( 5) =       0.000458596863
  error estimate for blocks of size 2^( 6) =       0.000466860196
  error estimate for blocks of size 2^( 7) =       0.000471311226

      target function =                  N/A
              le_mean =     -16.905406459387
             les_mean =     286.127892015846
             stat err =       0.000461056046
             autocorr =       1.268618659491
              std dev =       0.578899495888
             le_variance =       0.335124626340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334941314435
                                         uncertainty =       0.003804771736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334941314435
                                         uncertainty =       0.003804771736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409215106
  error estimate for blocks of size 2^( 2) =       0.000422006967
  error estimate for blocks of size 2^( 3) =       0.000434516935
  error estimate for blocks of size 2^( 4) =       0.000447358180
  error estimate for blocks of size 2^( 5) =       0.000458499769
  error estimate for blocks of size 2^( 6) =       0.000466760582
  error estimate for blocks of size 2^( 7) =       0.000471213152

      target function =                  N/A
              le_mean =     -16.905403398761
             les_mean =     286.127577912836
             stat err =       0.000460957921
             autocorr =       1.268876196688
              std dev =       0.578717552391
             le_variance =       0.334914005445


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905403059603        initial
     2.5000e-01     2.5000e+00             9.2513e-04       -16.905407618361  <--
     1.0000e+00     1.0000e+01             2.5456e-04       -16.905406459387
     4.0000e+00     4.0000e+01             6.5064e-05       -16.905403398761

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.2182e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.102486e-01 1 1  ON 0
 uu_1                 1.430571e-01 1 1  ON 1
 uu_2                 4.162116e-02 1 1  ON 2
 uu_3                -2.043054e-02 1 1  ON 3
 uu_4                -6.552889e-02 1 1  ON 4
 uu_5                -9.961104e-02 1 1  ON 5
 uu_6                -1.263093e-01 1 1  ON 6
 uu_7                -1.387351e-01 1 1  ON 7
 uu_8                -1.310119e-01 1 1  ON 8
 uu_9                -1.005775e-01 1 1  ON 9
 ud_0                 4.472404e-01 1 1  ON 10
 ud_1                 1.812492e-01 1 1  ON 11
 ud_2                 6.092125e-02 1 1  ON 12
 ud_3                -9.966046e-03 1 1  ON 13
 ud_4                -6.677340e-02 1 1  ON 14
 ud_5                -1.080022e-01 1 1  ON 15
 ud_6                -1.342866e-01 1 1  ON 16
 ud_7                -1.500840e-01 1 1  ON 17
 ud_8                -1.508566e-01 1 1  ON 18
 ud_9                -1.385343e-01 1 1  ON 19
 eO_0                -7.564082e-01 1 1  ON 20
 eO_1                -4.357976e-01 1 1  ON 21
 eO_2                -1.937725e-02 1 1  ON 22
 eO_3                 2.973475e-01 1 1  ON 23
 eO_4                 5.207322e-01 1 1  ON 24
 eO_5                 4.797896e-01 1 1  ON 25
 eO_6                 2.491443e-01 1 1  ON 26
 eO_7                -4.854341e-02 1 1  ON 27
 eO_8                -2.134501e-01 1 1  ON 28
 eO_9                -7.385531e-02 1 1  ON 29
eH1_0                -2.436934e-01 1 1  ON 30
eH1_1                -1.409205e-01 1 1  ON 31
eH1_2                -9.346142e-02 1 1  ON 32
eH1_3                -3.934507e-02 1 1  ON 33
eH1_4                 8.432026e-03 1 1  ON 34
eH1_5                 4.209881e-02 1 1  ON 35
eH1_6                 9.909309e-02 1 1  ON 36
eH1_7                 1.509762e-01 1 1  ON 37
eH1_8                 1.676261e-01 1 1  ON 38
eH1_9                 5.343385e-02 1 1  ON 39
eH2_0                -2.416762e-01 1 1  ON 40
eH2_1                -1.394266e-01 1 1  ON 41
eH2_2                -9.191158e-02 1 1  ON 42
eH2_3                -3.766381e-02 1 1  ON 43
eH2_4                 1.101387e-02 1 1  ON 44
eH2_5                 4.616657e-02 1 1  ON 45
eH2_6                 1.031787e-01 1 1  ON 46
eH2_7                 1.546101e-01 1 1  ON 47
eH2_8                 1.731726e-01 1 1  ON 48
eH2_9                 3.902659e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8392e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6869e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9264
    reference variance = 0.412558
====================================================
  Execution time = 2.0795e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3088e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6044e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330829522251
                                         uncertainty =       0.002969572959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330829522251
                                         uncertainty =       0.002969572959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406743647
  error estimate for blocks of size 2^( 2) =       0.000419724463
  error estimate for blocks of size 2^( 3) =       0.000432418063
  error estimate for blocks of size 2^( 4) =       0.000444896702
  error estimate for blocks of size 2^( 5) =       0.000456046525
  error estimate for blocks of size 2^( 6) =       0.000463175297
  error estimate for blocks of size 2^( 7) =       0.000468782926

      target function =                  N/A
              le_mean =     -16.906417342230
             les_mean =     286.157827972567
             stat err =       0.000458225363
             autocorr =       1.269160921257
              std dev =       0.575222381644
             le_variance =       0.330880788344


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690641734223e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906417342230       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906422614030       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906424422066       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906426119347       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906424121027       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906428482293       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906429134060       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906430117923       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906427999064       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906428280368       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906428036064       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906428471508       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906428618895       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906428620735       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.735352e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906417342230       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906420356505       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906422010127       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906422559627       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906420917512       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906422250215       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906422749877       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906422649622       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906422497143       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906422337969       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.199856e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906417342230       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906418453317       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906419362654       residual = 9.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906419289338       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906418778596       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906418893853       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906419093356       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906419101711       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906419074924       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.335356e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.106929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6413e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.102110e-01 1 1  ON 0
 uu_1                 1.431485e-01 1 1  ON 1
 uu_2                 4.163396e-02 1 1  ON 2
 uu_3                -2.053766e-02 1 1  ON 3
 uu_4                -6.570780e-02 1 1  ON 4
 uu_5                -9.987470e-02 1 1  ON 5
 uu_6                -1.264645e-01 1 1  ON 6
 uu_7                -1.390540e-01 1 1  ON 7
 uu_8                -1.310843e-01 1 1  ON 8
 uu_9                -1.005121e-01 1 1  ON 9
 ud_0                 4.471608e-01 1 1  ON 10
 ud_1                 1.814190e-01 1 1  ON 11
 ud_2                 6.084418e-02 1 1  ON 12
 ud_3                -1.003800e-02 1 1  ON 13
 ud_4                -6.676925e-02 1 1  ON 14
 ud_5                -1.078869e-01 1 1  ON 15
 ud_6                -1.345635e-01 1 1  ON 16
 ud_7                -1.505363e-01 1 1  ON 17
 ud_8                -1.507946e-01 1 1  ON 18
 ud_9                -1.381675e-01 1 1  ON 19
 eO_0                -7.565486e-01 1 1  ON 20
 eO_1                -4.356320e-01 1 1  ON 21
 eO_2                -1.931760e-02 1 1  ON 22
 eO_3                 2.971302e-01 1 1  ON 23
 eO_4                 5.205748e-01 1 1  ON 24
 eO_5                 4.801358e-01 1 1  ON 25
 eO_6                 2.496318e-01 1 1  ON 26
 eO_7                -4.827094e-02 1 1  ON 27
 eO_8                -2.138796e-01 1 1  ON 28
 eO_9                -7.421244e-02 1 1  ON 29
eH1_0                -2.442230e-01 1 1  ON 30
eH1_1                -1.413189e-01 1 1  ON 31
eH1_2                -9.389361e-02 1 1  ON 32
eH1_3                -3.968546e-02 1 1  ON 33
eH1_4                 8.210481e-03 1 1  ON 34
eH1_5                 4.204161e-02 1 1  ON 35
eH1_6                 9.896562e-02 1 1  ON 36
eH1_7                 1.513206e-01 1 1  ON 37
eH1_8                 1.682726e-01 1 1  ON 38
eH1_9                 5.435383e-02 1 1  ON 39
eH2_0                -2.423525e-01 1 1  ON 40
eH2_1                -1.393990e-01 1 1  ON 41
eH2_2                -9.189876e-02 1 1  ON 42
eH2_3                -3.756236e-02 1 1  ON 43
eH2_4                 1.094721e-02 1 1  ON 44
eH2_5                 4.581815e-02 1 1  ON 45
eH2_6                 1.027519e-01 1 1  ON 46
eH2_7                 1.545183e-01 1 1  ON 47
eH2_8                 1.738582e-01 1 1  ON 48
eH2_9                 3.976594e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9232
    reference variance = 0.1652
====================================================
  Execution time = 2.1085e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4474e-01
  Total weights = 2.0000e+06
  Execution time = 1.8705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344794923080
                                         uncertainty =       0.011292824586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344794923080
                                         uncertainty =       0.011292824586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415205143
  error estimate for blocks of size 2^( 2) =       0.000428025351
  error estimate for blocks of size 2^( 3) =       0.000441372219
  error estimate for blocks of size 2^( 4) =       0.000453162273
  error estimate for blocks of size 2^( 5) =       0.000463592079
  error estimate for blocks of size 2^( 6) =       0.000469893794
  error estimate for blocks of size 2^( 7) =       0.000474367499

      target function =                  N/A
              le_mean =     -16.906051650427
             les_mean =     286.159372856461
             stat err =       0.000465253911
             autocorr =       1.255609567166
              std dev =       0.587188744742
             le_variance =       0.344790621952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344812481245
                                         uncertainty =       0.011288329155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344812481245
                                         uncertainty =       0.011288329155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415215746
  error estimate for blocks of size 2^( 2) =       0.000428030437
  error estimate for blocks of size 2^( 3) =       0.000441370886
  error estimate for blocks of size 2^( 4) =       0.000453152976
  error estimate for blocks of size 2^( 5) =       0.000463581528
  error estimate for blocks of size 2^( 6) =       0.000469887691
  error estimate for blocks of size 2^( 7) =       0.000474352045

      target function =                  N/A
              le_mean =     -16.906050844256
             les_mean =     286.159363207068
             stat err =       0.000465243560
             autocorr =       1.255489578568
              std dev =       0.587203738837
             le_variance =       0.344808230904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344701669513
                                         uncertainty =       0.011280368929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344701669513
                                         uncertainty =       0.011280368929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415149052
  error estimate for blocks of size 2^( 2) =       0.000427964167
  error estimate for blocks of size 2^( 3) =       0.000441305045
  error estimate for blocks of size 2^( 4) =       0.000453088951
  error estimate for blocks of size 2^( 5) =       0.000463522863
  error estimate for blocks of size 2^( 6) =       0.000469834361
  error estimate for blocks of size 2^( 7) =       0.000474295301

      target function =                  N/A
              le_mean =     -16.906052148787
             les_mean =     286.159296555077
             stat err =       0.000465185369
             autocorr =       1.255578857790
              std dev =       0.587109419039
             le_variance =       0.344697469925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344740279318
                                         uncertainty =       0.011289098371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344740279318
                                         uncertainty =       0.011289098371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415172260
  error estimate for blocks of size 2^( 2) =       0.000427991846
  error estimate for blocks of size 2^( 3) =       0.000441337777
  error estimate for blocks of size 2^( 4) =       0.000453126707
  error estimate for blocks of size 2^( 5) =       0.000463558064
  error estimate for blocks of size 2^( 6) =       0.000469862375
  error estimate for blocks of size 2^( 7) =       0.000474333068

      target function =                  N/A
              le_mean =     -16.906051441706
             les_mean =     286.159311188040
             stat err =       0.000465220054
             autocorr =       1.255625704841
              std dev =       0.587142240688
             le_variance =       0.344736010800


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906051650427        initial
     6.2500e-02     6.2500e-01             3.7354e-03       -16.906050844256
     2.5000e-01     2.5000e+00             9.1999e-04       -16.906052148787  <--
     1.0000e+00     1.0000e+01             2.3354e-04       -16.906051441706

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0538e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.102110e-01 1 1  ON 0
 uu_1                 1.431485e-01 1 1  ON 1
 uu_2                 4.163396e-02 1 1  ON 2
 uu_3                -2.053766e-02 1 1  ON 3
 uu_4                -6.570780e-02 1 1  ON 4
 uu_5                -9.987470e-02 1 1  ON 5
 uu_6                -1.264645e-01 1 1  ON 6
 uu_7                -1.390540e-01 1 1  ON 7
 uu_8                -1.310843e-01 1 1  ON 8
 uu_9                -1.005121e-01 1 1  ON 9
 ud_0                 4.471608e-01 1 1  ON 10
 ud_1                 1.814190e-01 1 1  ON 11
 ud_2                 6.084418e-02 1 1  ON 12
 ud_3                -1.003800e-02 1 1  ON 13
 ud_4                -6.676925e-02 1 1  ON 14
 ud_5                -1.078869e-01 1 1  ON 15
 ud_6                -1.345635e-01 1 1  ON 16
 ud_7                -1.505363e-01 1 1  ON 17
 ud_8                -1.507946e-01 1 1  ON 18
 ud_9                -1.381675e-01 1 1  ON 19
 eO_0                -7.565486e-01 1 1  ON 20
 eO_1                -4.356320e-01 1 1  ON 21
 eO_2                -1.931760e-02 1 1  ON 22
 eO_3                 2.971302e-01 1 1  ON 23
 eO_4                 5.205748e-01 1 1  ON 24
 eO_5                 4.801358e-01 1 1  ON 25
 eO_6                 2.496318e-01 1 1  ON 26
 eO_7                -4.827094e-02 1 1  ON 27
 eO_8                -2.138796e-01 1 1  ON 28
 eO_9                -7.421244e-02 1 1  ON 29
eH1_0                -2.442230e-01 1 1  ON 30
eH1_1                -1.413189e-01 1 1  ON 31
eH1_2                -9.389361e-02 1 1  ON 32
eH1_3                -3.968546e-02 1 1  ON 33
eH1_4                 8.210481e-03 1 1  ON 34
eH1_5                 4.204161e-02 1 1  ON 35
eH1_6                 9.896562e-02 1 1  ON 36
eH1_7                 1.513206e-01 1 1  ON 37
eH1_8                 1.682726e-01 1 1  ON 38
eH1_9                 5.435383e-02 1 1  ON 39
eH2_0                -2.423525e-01 1 1  ON 40
eH2_1                -1.393990e-01 1 1  ON 41
eH2_2                -9.189876e-02 1 1  ON 42
eH2_3                -3.756236e-02 1 1  ON 43
eH2_4                 1.094721e-02 1 1  ON 44
eH2_5                 4.581815e-02 1 1  ON 45
eH2_6                 1.027519e-01 1 1  ON 46
eH2_7                 1.545183e-01 1 1  ON 47
eH2_8                 1.738582e-01 1 1  ON 48
eH2_9                 3.976594e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7321e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.988
    reference variance = 0.639963
====================================================
  Execution time = 2.0602e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3466e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5756e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334512705590
                                         uncertainty =       0.003299384849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334512705590
                                         uncertainty =       0.003299384849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409058551
  error estimate for blocks of size 2^( 2) =       0.000421468422
  error estimate for blocks of size 2^( 3) =       0.000434497990
  error estimate for blocks of size 2^( 4) =       0.000446771834
  error estimate for blocks of size 2^( 5) =       0.000458139223
  error estimate for blocks of size 2^( 6) =       0.000465187221
  error estimate for blocks of size 2^( 7) =       0.000472828464

      target function =                  N/A
              le_mean =     -16.906341801071
             les_mean =     286.159050723097
             stat err =       0.000460731685
             autocorr =       1.268601470121
              std dev =       0.578496150191
             le_variance =       0.334657795786


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690634180107e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906341801071       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906341690510       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906344491917       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906347483121       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906349275262       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906354341515       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906355023967       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906353884007       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906352698801       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906353344671       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906354579332       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906354616809       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906354179058       residual = 8.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.026016e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906341801071       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906341741612       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906343300453       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906344525790       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906345198436       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906347345420       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906347046129       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906346308844       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906346133943       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906346256998       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 7.567724e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906341801071       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906341780200       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906342360832       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906342682449       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906342939571       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906343481195       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906343497259       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906343336367       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906343300019       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.138293e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111304 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6190e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.104245e-01 1 1  ON 0
 uu_1                 1.433943e-01 1 1  ON 1
 uu_2                 4.201240e-02 1 1  ON 2
 uu_3                -2.020638e-02 1 1  ON 3
 uu_4                -6.549448e-02 1 1  ON 4
 uu_5                -9.999104e-02 1 1  ON 5
 uu_6                -1.269153e-01 1 1  ON 6
 uu_7                -1.395439e-01 1 1  ON 7
 uu_8                -1.316810e-01 1 1  ON 8
 uu_9                -1.009130e-01 1 1  ON 9
 ud_0                 4.475755e-01 1 1  ON 10
 ud_1                 1.814490e-01 1 1  ON 11
 ud_2                 6.098098e-02 1 1  ON 12
 ud_3                -1.002225e-02 1 1  ON 13
 ud_4                -6.678561e-02 1 1  ON 14
 ud_5                -1.077270e-01 1 1  ON 15
 ud_6                -1.343940e-01 1 1  ON 16
 ud_7                -1.501455e-01 1 1  ON 17
 ud_8                -1.509738e-01 1 1  ON 18
 ud_9                -1.388389e-01 1 1  ON 19
 eO_0                -7.564903e-01 1 1  ON 20
 eO_1                -4.355976e-01 1 1  ON 21
 eO_2                -1.952364e-02 1 1  ON 22
 eO_3                 2.972856e-01 1 1  ON 23
 eO_4                 5.208124e-01 1 1  ON 24
 eO_5                 4.806119e-01 1 1  ON 25
 eO_6                 2.499002e-01 1 1  ON 26
 eO_7                -4.795094e-02 1 1  ON 27
 eO_8                -2.145130e-01 1 1  ON 28
 eO_9                -7.480917e-02 1 1  ON 29
eH1_0                -2.446729e-01 1 1  ON 30
eH1_1                -1.417977e-01 1 1  ON 31
eH1_2                -9.428783e-02 1 1  ON 32
eH1_3                -3.999298e-02 1 1  ON 33
eH1_4                 8.168780e-03 1 1  ON 34
eH1_5                 4.195126e-02 1 1  ON 35
eH1_6                 9.908386e-02 1 1  ON 36
eH1_7                 1.518021e-01 1 1  ON 37
eH1_8                 1.688823e-01 1 1  ON 38
eH1_9                 5.489693e-02 1 1  ON 39
eH2_0                -2.430891e-01 1 1  ON 40
eH2_1                -1.396980e-01 1 1  ON 41
eH2_2                -9.197568e-02 1 1  ON 42
eH2_3                -3.772029e-02 1 1  ON 43
eH2_4                 1.093079e-02 1 1  ON 44
eH2_5                 4.575451e-02 1 1  ON 45
eH2_6                 1.025490e-01 1 1  ON 46
eH2_7                 1.546997e-01 1 1  ON 47
eH2_8                 1.744546e-01 1 1  ON 48
eH2_9                 4.052271e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8583
    reference variance = 0.970585
====================================================
  Execution time = 2.0685e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 4.2983e-01
  Total weights = 2.0000e+06
  Execution time = 1.8672e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429774408798
                                         uncertainty =       0.084567946531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429774408798
                                         uncertainty =       0.084567946531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463448796
  error estimate for blocks of size 2^( 2) =       0.000474643927
  error estimate for blocks of size 2^( 3) =       0.000486091034
  error estimate for blocks of size 2^( 4) =       0.000496744317
  error estimate for blocks of size 2^( 5) =       0.000507584941
  error estimate for blocks of size 2^( 6) =       0.000515272690
  error estimate for blocks of size 2^( 7) =       0.000519232419

      target function =                  N/A
              le_mean =     -16.905964291364
             les_mean =     286.241197978438
             stat err =       0.000509708592
             autocorr =       1.209596140156
              std dev =       0.655415572255
             le_variance =       0.429569572355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430214435897
                                         uncertainty =       0.084702683551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430214435897
                                         uncertainty =       0.084702683551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463685866
  error estimate for blocks of size 2^( 2) =       0.000474869648
  error estimate for blocks of size 2^( 3) =       0.000486297616
  error estimate for blocks of size 2^( 4) =       0.000496935112
  error estimate for blocks of size 2^( 5) =       0.000507771909
  error estimate for blocks of size 2^( 6) =       0.000515462235
  error estimate for blocks of size 2^( 7) =       0.000519399473

      target function =                  N/A
              le_mean =     -16.905968547091
             les_mean =     286.241781465589
             stat err =       0.000509892182
             autocorr =       1.209230214388
              std dev =       0.655750840913
             le_variance =       0.430009165358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430300700746
                                         uncertainty =       0.084734016119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430300700746
                                         uncertainty =       0.084734016119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463732355
  error estimate for blocks of size 2^( 2) =       0.000474915771
  error estimate for blocks of size 2^( 3) =       0.000486345357
  error estimate for blocks of size 2^( 4) =       0.000496986906
  error estimate for blocks of size 2^( 5) =       0.000507825823
  error estimate for blocks of size 2^( 6) =       0.000515519097
  error estimate for blocks of size 2^( 7) =       0.000519458920

      target function =                  N/A
              le_mean =     -16.905968884539
             les_mean =     286.241879103286
             stat err =       0.000509947686
             autocorr =       1.209251002571
              std dev =       0.655816585138
             le_variance =       0.430095393342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429906880554
                                         uncertainty =       0.084607238617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429906880554
                                         uncertainty =       0.084607238617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463520186
  error estimate for blocks of size 2^( 2) =       0.000474712386
  error estimate for blocks of size 2^( 3) =       0.000486155700
  error estimate for blocks of size 2^( 4) =       0.000496806605
  error estimate for blocks of size 2^( 5) =       0.000507646537
  error estimate for blocks of size 2^( 6) =       0.000515335185
  error estimate for blocks of size 2^( 7) =       0.000519291065

      target function =                  N/A
              le_mean =     -16.905964982552
             les_mean =     286.241353702959
             stat err =       0.000509769848
             autocorr =       1.209514232289
              std dev =       0.655516534139
             le_variance =       0.429701926529


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905964291364        initial
     6.2500e-02     6.2500e-01             3.0260e-03       -16.905968547091
     2.5000e-01     2.5000e+00             7.5677e-04       -16.905968884539  <--
     1.0000e+00     1.0000e+01             2.1383e-04       -16.905964982552

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0154e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.104245e-01 1 1  ON 0
 uu_1                 1.433943e-01 1 1  ON 1
 uu_2                 4.201240e-02 1 1  ON 2
 uu_3                -2.020638e-02 1 1  ON 3
 uu_4                -6.549448e-02 1 1  ON 4
 uu_5                -9.999104e-02 1 1  ON 5
 uu_6                -1.269153e-01 1 1  ON 6
 uu_7                -1.395439e-01 1 1  ON 7
 uu_8                -1.316810e-01 1 1  ON 8
 uu_9                -1.009130e-01 1 1  ON 9
 ud_0                 4.475755e-01 1 1  ON 10
 ud_1                 1.814490e-01 1 1  ON 11
 ud_2                 6.098098e-02 1 1  ON 12
 ud_3                -1.002225e-02 1 1  ON 13
 ud_4                -6.678561e-02 1 1  ON 14
 ud_5                -1.077270e-01 1 1  ON 15
 ud_6                -1.343940e-01 1 1  ON 16
 ud_7                -1.501455e-01 1 1  ON 17
 ud_8                -1.509738e-01 1 1  ON 18
 ud_9                -1.388389e-01 1 1  ON 19
 eO_0                -7.564903e-01 1 1  ON 20
 eO_1                -4.355976e-01 1 1  ON 21
 eO_2                -1.952364e-02 1 1  ON 22
 eO_3                 2.972856e-01 1 1  ON 23
 eO_4                 5.208124e-01 1 1  ON 24
 eO_5                 4.806119e-01 1 1  ON 25
 eO_6                 2.499002e-01 1 1  ON 26
 eO_7                -4.795094e-02 1 1  ON 27
 eO_8                -2.145130e-01 1 1  ON 28
 eO_9                -7.480917e-02 1 1  ON 29
eH1_0                -2.446729e-01 1 1  ON 30
eH1_1                -1.417977e-01 1 1  ON 31
eH1_2                -9.428783e-02 1 1  ON 32
eH1_3                -3.999298e-02 1 1  ON 33
eH1_4                 8.168780e-03 1 1  ON 34
eH1_5                 4.195126e-02 1 1  ON 35
eH1_6                 9.908386e-02 1 1  ON 36
eH1_7                 1.518021e-01 1 1  ON 37
eH1_8                 1.688823e-01 1 1  ON 38
eH1_9                 5.489693e-02 1 1  ON 39
eH2_0                -2.430891e-01 1 1  ON 40
eH2_1                -1.396980e-01 1 1  ON 41
eH2_2                -9.197568e-02 1 1  ON 42
eH2_3                -3.772029e-02 1 1  ON 43
eH2_4                 1.093079e-02 1 1  ON 44
eH2_5                 4.575451e-02 1 1  ON 45
eH2_6                 1.025490e-01 1 1  ON 46
eH2_7                 1.546997e-01 1 1  ON 47
eH2_8                 1.744546e-01 1 1  ON 48
eH2_9                 4.052271e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7021e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9715
    reference variance = 0.829146
====================================================
  Execution time = 2.1110e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3872e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5737e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338723612771
                                         uncertainty =       0.003801045499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338723612771
                                         uncertainty =       0.003801045499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411532972
  error estimate for blocks of size 2^( 2) =       0.000424395975
  error estimate for blocks of size 2^( 3) =       0.000437335591
  error estimate for blocks of size 2^( 4) =       0.000449665591
  error estimate for blocks of size 2^( 5) =       0.000460489227
  error estimate for blocks of size 2^( 6) =       0.000467283648
  error estimate for blocks of size 2^( 7) =       0.000473028611

      target function =                  N/A
              le_mean =     -16.905582120766
             les_mean =     286.137425447155
             stat err =       0.000462616769
             autocorr =       1.263669398025
              std dev =       0.581995510753
             le_variance =       0.338718774536


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690558212077e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905582120766       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905580885231       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905581758979       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905580464040       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905582241490       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905583816529       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905583166909       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905583561528       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905583697458       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905584648631       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905584696162       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905584534431       residual = 8.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.379267e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905582120766       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905581401804       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905581959369       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905582471826       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905581895473       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905582263510       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905582438533       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905582400134       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905582292964       residual = 9.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.420842e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905582120766       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905581851732       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905582070484       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905582345785       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905582147811       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905582196818       residual = 9.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905582204048       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905582219278       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.135544e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.115115 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6695e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.106404e-01 1 1  ON 0
 uu_1                 1.434944e-01 1 1  ON 1
 uu_2                 4.206658e-02 1 1  ON 2
 uu_3                -2.022600e-02 1 1  ON 3
 uu_4                -6.552780e-02 1 1  ON 4
 uu_5                -1.001286e-01 1 1  ON 5
 uu_6                -1.268935e-01 1 1  ON 6
 uu_7                -1.401131e-01 1 1  ON 7
 uu_8                -1.318798e-01 1 1  ON 8
 uu_9                -1.011331e-01 1 1  ON 9
 ud_0                 4.478126e-01 1 1  ON 10
 ud_1                 1.816614e-01 1 1  ON 11
 ud_2                 6.102238e-02 1 1  ON 12
 ud_3                -1.015822e-02 1 1  ON 13
 ud_4                -6.683552e-02 1 1  ON 14
 ud_5                -1.077964e-01 1 1  ON 15
 ud_6                -1.344373e-01 1 1  ON 16
 ud_7                -1.503540e-01 1 1  ON 17
 ud_8                -1.508601e-01 1 1  ON 18
 ud_9                -1.388967e-01 1 1  ON 19
 eO_0                -7.569032e-01 1 1  ON 20
 eO_1                -4.359766e-01 1 1  ON 21
 eO_2                -1.930059e-02 1 1  ON 22
 eO_3                 2.974921e-01 1 1  ON 23
 eO_4                 5.211140e-01 1 1  ON 24
 eO_5                 4.810023e-01 1 1  ON 25
 eO_6                 2.504700e-01 1 1  ON 26
 eO_7                -4.791585e-02 1 1  ON 27
 eO_8                -2.150148e-01 1 1  ON 28
 eO_9                -7.519438e-02 1 1  ON 29
eH1_0                -2.450585e-01 1 1  ON 30
eH1_1                -1.423179e-01 1 1  ON 31
eH1_2                -9.457280e-02 1 1  ON 32
eH1_3                -4.023455e-02 1 1  ON 33
eH1_4                 7.794633e-03 1 1  ON 34
eH1_5                 4.194705e-02 1 1  ON 35
eH1_6                 9.938389e-02 1 1  ON 36
eH1_7                 1.521852e-01 1 1  ON 37
eH1_8                 1.693211e-01 1 1  ON 38
eH1_9                 5.552921e-02 1 1  ON 39
eH2_0                -2.434198e-01 1 1  ON 40
eH2_1                -1.401644e-01 1 1  ON 41
eH2_2                -9.227710e-02 1 1  ON 42
eH2_3                -3.789382e-02 1 1  ON 43
eH2_4                 1.061295e-02 1 1  ON 44
eH2_5                 4.560237e-02 1 1  ON 45
eH2_6                 1.027799e-01 1 1  ON 46
eH2_7                 1.548317e-01 1 1  ON 47
eH2_8                 1.749810e-01 1 1  ON 48
eH2_9                 4.136480e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9375
    reference variance = 0.563046
====================================================
  Execution time = 2.0419e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3917e-01
  Total weights = 2.0000e+06
  Execution time = 1.8722e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338914582288
                                         uncertainty =       0.004891564229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338914582288
                                         uncertainty =       0.004891564229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411689509
  error estimate for blocks of size 2^( 2) =       0.000424441879
  error estimate for blocks of size 2^( 3) =       0.000436660758
  error estimate for blocks of size 2^( 4) =       0.000448426531
  error estimate for blocks of size 2^( 5) =       0.000459052690
  error estimate for blocks of size 2^( 6) =       0.000465273434
  error estimate for blocks of size 2^( 7) =       0.000469352633

      target function =                  N/A
              le_mean =     -16.906063244854
             les_mean =     286.153950772530
             stat err =       0.000460526322
             autocorr =       1.251322680680
              std dev =       0.582216886583
             le_variance =       0.338976503022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339371692307
                                         uncertainty =       0.004892813372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339371692307
                                         uncertainty =       0.004892813372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411967122
  error estimate for blocks of size 2^( 2) =       0.000424707240
  error estimate for blocks of size 2^( 3) =       0.000436906550
  error estimate for blocks of size 2^( 4) =       0.000448655265
  error estimate for blocks of size 2^( 5) =       0.000459278508
  error estimate for blocks of size 2^( 6) =       0.000465493716
  error estimate for blocks of size 2^( 7) =       0.000469570840

      target function =                  N/A
              le_mean =     -16.906059881661
             les_mean =     286.154294372391
             stat err =       0.000460749582
             autocorr =       1.250848709670
              std dev =       0.582609491698
             le_variance =       0.339433819816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339303773308
                                         uncertainty =       0.004890879204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339303773308
                                         uncertainty =       0.004890879204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411925920
  error estimate for blocks of size 2^( 2) =       0.000424665306
  error estimate for blocks of size 2^( 3) =       0.000436866682
  error estimate for blocks of size 2^( 4) =       0.000448621006
  error estimate for blocks of size 2^( 5) =       0.000459248183
  error estimate for blocks of size 2^( 6) =       0.000465466451
  error estimate for blocks of size 2^( 7) =       0.000469545135

      target function =                  N/A
              le_mean =     -16.906060279432
             les_mean =     286.154239928494
             stat err =       0.000460720194
             autocorr =       1.250939357539
              std dev =       0.582551222106
             le_variance =       0.339365926377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338963841629
                                         uncertainty =       0.004891262564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338963841629
                                         uncertainty =       0.004891262564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411719446
  error estimate for blocks of size 2^( 2) =       0.000424469918
  error estimate for blocks of size 2^( 3) =       0.000436686032
  error estimate for blocks of size 2^( 4) =       0.000448450303
  error estimate for blocks of size 2^( 5) =       0.000459077017
  error estimate for blocks of size 2^( 6) =       0.000465297712
  error estimate for blocks of size 2^( 7) =       0.000469377542

      target function =                  N/A
              le_mean =     -16.906062576437
             les_mean =     286.153977473833
             stat err =       0.000460550643
             autocorr =       1.251272865051
              std dev =       0.582259224865
             le_variance =       0.339025804941


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906063244854        initial  <--
     6.2500e-02     6.2500e-01             3.3793e-03       -16.906059881661
     2.5000e-01     2.5000e+00             8.4208e-04       -16.906060279432
     1.0000e+00     1.0000e+01             2.1355e-04       -16.906062576437

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8846
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.104245e-01 1 1  ON 0
 uu_1                 1.433943e-01 1 1  ON 1
 uu_2                 4.201240e-02 1 1  ON 2
 uu_3                -2.020638e-02 1 1  ON 3
 uu_4                -6.549448e-02 1 1  ON 4
 uu_5                -9.999104e-02 1 1  ON 5
 uu_6                -1.269153e-01 1 1  ON 6
 uu_7                -1.395439e-01 1 1  ON 7
 uu_8                -1.316810e-01 1 1  ON 8
 uu_9                -1.009130e-01 1 1  ON 9
 ud_0                 4.475755e-01 1 1  ON 10
 ud_1                 1.814490e-01 1 1  ON 11
 ud_2                 6.098098e-02 1 1  ON 12
 ud_3                -1.002225e-02 1 1  ON 13
 ud_4                -6.678561e-02 1 1  ON 14
 ud_5                -1.077270e-01 1 1  ON 15
 ud_6                -1.343940e-01 1 1  ON 16
 ud_7                -1.501455e-01 1 1  ON 17
 ud_8                -1.509738e-01 1 1  ON 18
 ud_9                -1.388389e-01 1 1  ON 19
 eO_0                -7.564903e-01 1 1  ON 20
 eO_1                -4.355976e-01 1 1  ON 21
 eO_2                -1.952364e-02 1 1  ON 22
 eO_3                 2.972856e-01 1 1  ON 23
 eO_4                 5.208124e-01 1 1  ON 24
 eO_5                 4.806119e-01 1 1  ON 25
 eO_6                 2.499002e-01 1 1  ON 26
 eO_7                -4.795094e-02 1 1  ON 27
 eO_8                -2.145130e-01 1 1  ON 28
 eO_9                -7.480917e-02 1 1  ON 29
eH1_0                -2.446729e-01 1 1  ON 30
eH1_1                -1.417977e-01 1 1  ON 31
eH1_2                -9.428783e-02 1 1  ON 32
eH1_3                -3.999298e-02 1 1  ON 33
eH1_4                 8.168780e-03 1 1  ON 34
eH1_5                 4.195126e-02 1 1  ON 35
eH1_6                 9.908386e-02 1 1  ON 36
eH1_7                 1.518021e-01 1 1  ON 37
eH1_8                 1.688823e-01 1 1  ON 38
eH1_9                 5.489693e-02 1 1  ON 39
eH2_0                -2.430891e-01 1 1  ON 40
eH2_1                -1.396980e-01 1 1  ON 41
eH2_2                -9.197568e-02 1 1  ON 42
eH2_3                -3.772029e-02 1 1  ON 43
eH2_4                 1.093079e-02 1 1  ON 44
eH2_5                 4.575451e-02 1 1  ON 45
eH2_6                 1.025490e-01 1 1  ON 46
eH2_7                 1.546997e-01 1 1  ON 47
eH2_8                 1.744546e-01 1 1  ON 48
eH2_9                 4.052271e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6745e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9457
    reference variance = 0.393256
====================================================
  Execution time = 2.0798e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3333e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5908e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333398327450
                                         uncertainty =       0.003123441566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333398327450
                                         uncertainty =       0.003123441566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408243899
  error estimate for blocks of size 2^( 2) =       0.000421247351
  error estimate for blocks of size 2^( 3) =       0.000434963131
  error estimate for blocks of size 2^( 4) =       0.000447999760
  error estimate for blocks of size 2^( 5) =       0.000459684703
  error estimate for blocks of size 2^( 6) =       0.000467627291
  error estimate for blocks of size 2^( 7) =       0.000476247918

      target function =                  N/A
              le_mean =     -16.905430903727
             les_mean =     286.126920036356
             stat err =       0.000462889918
             autocorr =       1.285630114409
              std dev =       0.577344058895
             le_variance =       0.333326162342


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690543090373e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905430903727       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905430990643       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905431000179       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905431872925       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905431487082       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905431542435       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905431557737       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905431594532       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905431692504       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.876221e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905430903727       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905430929132       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905430949816       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905431219333       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905431159112       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905431173597       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905431141430       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905431168036       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 9.721603e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905430903727       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905430910359       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905430917583       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905430988682       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905430979615       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905430980950       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905430978197       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905430974971       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.409123e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.118023 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6400e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.104466e-01 1 1  ON 0
 uu_1                 1.434320e-01 1 1  ON 1
 uu_2                 4.200262e-02 1 1  ON 2
 uu_3                -2.020904e-02 1 1  ON 3
 uu_4                -6.551834e-02 1 1  ON 4
 uu_5                -9.998821e-02 1 1  ON 5
 uu_6                -1.269044e-01 1 1  ON 6
 uu_7                -1.395876e-01 1 1  ON 7
 uu_8                -1.316799e-01 1 1  ON 8
 uu_9                -1.009391e-01 1 1  ON 9
 ud_0                 4.475675e-01 1 1  ON 10
 ud_1                 1.815138e-01 1 1  ON 11
 ud_2                 6.100098e-02 1 1  ON 12
 ud_3                -1.002046e-02 1 1  ON 13
 ud_4                -6.676621e-02 1 1  ON 14
 ud_5                -1.077282e-01 1 1  ON 15
 ud_6                -1.344296e-01 1 1  ON 16
 ud_7                -1.501406e-01 1 1  ON 17
 ud_8                -1.509629e-01 1 1  ON 18
 ud_9                -1.388666e-01 1 1  ON 19
 eO_0                -7.565210e-01 1 1  ON 20
 eO_1                -4.356303e-01 1 1  ON 21
 eO_2                -1.945608e-02 1 1  ON 22
 eO_3                 2.972873e-01 1 1  ON 23
 eO_4                 5.208364e-01 1 1  ON 24
 eO_5                 4.806174e-01 1 1  ON 25
 eO_6                 2.499602e-01 1 1  ON 26
 eO_7                -4.793251e-02 1 1  ON 27
 eO_8                -2.145561e-01 1 1  ON 28
 eO_9                -7.486755e-02 1 1  ON 29
eH1_0                -2.447466e-01 1 1  ON 30
eH1_1                -1.418660e-01 1 1  ON 31
eH1_2                -9.430238e-02 1 1  ON 32
eH1_3                -3.998555e-02 1 1  ON 33
eH1_4                 8.168743e-03 1 1  ON 34
eH1_5                 4.198103e-02 1 1  ON 35
eH1_6                 9.908980e-02 1 1  ON 36
eH1_7                 1.518083e-01 1 1  ON 37
eH1_8                 1.689278e-01 1 1  ON 38
eH1_9                 5.495926e-02 1 1  ON 39
eH2_0                -2.431054e-01 1 1  ON 40
eH2_1                -1.397357e-01 1 1  ON 41
eH2_2                -9.202228e-02 1 1  ON 42
eH2_3                -3.770271e-02 1 1  ON 43
eH2_4                 1.090066e-02 1 1  ON 44
eH2_5                 4.576141e-02 1 1  ON 45
eH2_6                 1.025140e-01 1 1  ON 46
eH2_7                 1.546943e-01 1 1  ON 47
eH2_8                 1.744979e-01 1 1  ON 48
eH2_9                 4.061993e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9283
    reference variance = 0.26445
====================================================
  Execution time = 2.0225e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4766e-01
  Total weights = 2.0000e+06
  Execution time = 1.8721e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347737688276
                                         uncertainty =       0.008941209520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347737688276
                                         uncertainty =       0.008941209520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416941239
  error estimate for blocks of size 2^( 2) =       0.000429488141
  error estimate for blocks of size 2^( 3) =       0.000442618130
  error estimate for blocks of size 2^( 4) =       0.000455051633
  error estimate for blocks of size 2^( 5) =       0.000466239365
  error estimate for blocks of size 2^( 6) =       0.000473862508
  error estimate for blocks of size 2^( 7) =       0.000479190883

      target function =                  N/A
              le_mean =     -16.906465826858
             les_mean =     286.176266575187
             stat err =       0.000468586097
             autocorr =       1.263074862325
              std dev =       0.589643955548
             le_variance =       0.347679994314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347723822230
                                         uncertainty =       0.008940678913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347723822230
                                         uncertainty =       0.008940678913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416932949
  error estimate for blocks of size 2^( 2) =       0.000429478116
  error estimate for blocks of size 2^( 3) =       0.000442605306
  error estimate for blocks of size 2^( 4) =       0.000455035972
  error estimate for blocks of size 2^( 5) =       0.000466222315
  error estimate for blocks of size 2^( 6) =       0.000473848457
  error estimate for blocks of size 2^( 7) =       0.000479175242

      target function =                  N/A
              le_mean =     -16.906467136867
             les_mean =     286.176297043260
             stat err =       0.000468570496
             autocorr =       1.263040991204
              std dev =       0.589632230390
             le_variance =       0.347666167115

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347699051506
                                         uncertainty =       0.008940123007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347699051506
                                         uncertainty =       0.008940123007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416918096
  error estimate for blocks of size 2^( 2) =       0.000429464734
  error estimate for blocks of size 2^( 3) =       0.000442593831
  error estimate for blocks of size 2^( 4) =       0.000455026032
  error estimate for blocks of size 2^( 5) =       0.000466213085
  error estimate for blocks of size 2^( 6) =       0.000473838555
  error estimate for blocks of size 2^( 7) =       0.000479165427

      target function =                  N/A
              le_mean =     -16.906466795302
             les_mean =     286.176260724438
             stat err =       0.000468560775
             autocorr =       1.263078570740
              std dev =       0.589611225824
             le_variance =       0.347641397618

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347730391220
                                         uncertainty =       0.008941017346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347730391220
                                         uncertainty =       0.008941017346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416936868
  error estimate for blocks of size 2^( 2) =       0.000429483790
  error estimate for blocks of size 2^( 3) =       0.000442613717
  error estimate for blocks of size 2^( 4) =       0.000455047076
  error estimate for blocks of size 2^( 5) =       0.000466234738
  error estimate for blocks of size 2^( 6) =       0.000473858235
  error estimate for blocks of size 2^( 7) =       0.000479186378

      target function =                  N/A
              le_mean =     -16.906465958957
             les_mean =     286.176263750940
             stat err =       0.000468581607
             autocorr =       1.263077141152
              std dev =       0.589637773048
             le_variance =       0.347672703406


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906465826858        initial
     6.2500e-01     6.2500e+00             3.8762e-04       -16.906467136867  <--
     2.5000e+00     2.5000e+01             9.7216e-05       -16.906466795302
     1.0000e+01     1.0000e+02             2.4091e-05       -16.906465958957

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.9666e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.105129e-01 1 1  ON 0
 uu_1                 1.435127e-01 1 1  ON 1
 uu_2                 4.199781e-02 1 1  ON 2
 uu_3                -2.021557e-02 1 1  ON 3
 uu_4                -6.556873e-02 1 1  ON 4
 uu_5                -9.999501e-02 1 1  ON 5
 uu_6                -1.268798e-01 1 1  ON 6
 uu_7                -1.397050e-01 1 1  ON 7
 uu_8                -1.316800e-01 1 1  ON 8
 uu_9                -1.010180e-01 1 1  ON 9
 ud_0                 4.476107e-01 1 1  ON 10
 ud_1                 1.816505e-01 1 1  ON 11
 ud_2                 6.105698e-02 1 1  ON 12
 ud_3                -1.000670e-02 1 1  ON 13
 ud_4                -6.673387e-02 1 1  ON 14
 ud_5                -1.077308e-01 1 1  ON 15
 ud_6                -1.345121e-01 1 1  ON 16
 ud_7                -1.501378e-01 1 1  ON 17
 ud_8                -1.509348e-01 1 1  ON 18
 ud_9                -1.389475e-01 1 1  ON 19
 eO_0                -7.566015e-01 1 1  ON 20
 eO_1                -4.356930e-01 1 1  ON 21
 eO_2                -1.930717e-02 1 1  ON 22
 eO_3                 2.973017e-01 1 1  ON 23
 eO_4                 5.209000e-01 1 1  ON 24
 eO_5                 4.806402e-01 1 1  ON 25
 eO_6                 2.501384e-01 1 1  ON 26
 eO_7                -4.787814e-02 1 1  ON 27
 eO_8                -2.146845e-01 1 1  ON 28
 eO_9                -7.504185e-02 1 1  ON 29
eH1_0                -2.449652e-01 1 1  ON 30
eH1_1                -1.420312e-01 1 1  ON 31
eH1_2                -9.436032e-02 1 1  ON 32
eH1_3                -3.998016e-02 1 1  ON 33
eH1_4                 8.165999e-03 1 1  ON 34
eH1_5                 4.206223e-02 1 1  ON 35
eH1_6                 9.910887e-02 1 1  ON 36
eH1_7                 1.518276e-01 1 1  ON 37
eH1_8                 1.690626e-01 1 1  ON 38
eH1_9                 5.514542e-02 1 1  ON 39
eH2_0                -2.431643e-01 1 1  ON 40
eH2_1                -1.398427e-01 1 1  ON 41
eH2_2                -9.213898e-02 1 1  ON 42
eH2_3                -3.767984e-02 1 1  ON 43
eH2_4                 1.082752e-02 1 1  ON 44
eH2_5                 4.577552e-02 1 1  ON 45
eH2_6                 1.024114e-01 1 1  ON 46
eH2_7                 1.546782e-01 1 1  ON 47
eH2_8                 1.746265e-01 1 1  ON 48
eH2_9                 4.091033e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6440e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.962
    reference variance = 0.384833
====================================================
  Execution time = 2.0935e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3816e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5553e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337943748302
                                         uncertainty =       0.003192013257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337943748302
                                         uncertainty =       0.003192013257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411194600
  error estimate for blocks of size 2^( 2) =       0.000423819211
  error estimate for blocks of size 2^( 3) =       0.000436454341
  error estimate for blocks of size 2^( 4) =       0.000448135354
  error estimate for blocks of size 2^( 5) =       0.000458858288
  error estimate for blocks of size 2^( 6) =       0.000466928903
  error estimate for blocks of size 2^( 7) =       0.000470495504

      target function =                  N/A
              le_mean =     -16.905954754905
             les_mean =     286.149468004774
             stat err =       0.000461104512
             autocorr =       1.257488256895
              std dev =       0.581516980788
             le_variance =       0.338161998944


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690595475491e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905954754905       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905955959603       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905956675686       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905956896731       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905955955244       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905958038561       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905959149150       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905958496912       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905958305865       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905958699013       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905958757746       residual = 2.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.367976e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905954754905       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905955162510       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905955426498       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905955505734       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905955183845       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905955810134       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905956024162       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905955845942       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905955863465       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.429409e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905954754905       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905954866682       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905954943491       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905954967882       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905954885037       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905955038045       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905955077653       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905955041266       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.521101e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121560 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6501e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.105457e-01 1 1  ON 0
 uu_1                 1.435185e-01 1 1  ON 1
 uu_2                 4.204115e-02 1 1  ON 2
 uu_3                -2.021980e-02 1 1  ON 3
 uu_4                -6.554692e-02 1 1  ON 4
 uu_5                -9.998520e-02 1 1  ON 5
 uu_6                -1.268973e-01 1 1  ON 6
 uu_7                -1.399110e-01 1 1  ON 7
 uu_8                -1.319046e-01 1 1  ON 8
 uu_9                -1.010747e-01 1 1  ON 9
 ud_0                 4.476531e-01 1 1  ON 10
 ud_1                 1.817722e-01 1 1  ON 11
 ud_2                 6.111071e-02 1 1  ON 12
 ud_3                -9.976277e-03 1 1  ON 13
 ud_4                -6.672160e-02 1 1  ON 14
 ud_5                -1.077427e-01 1 1  ON 15
 ud_6                -1.346337e-01 1 1  ON 16
 ud_7                -1.502461e-01 1 1  ON 17
 ud_8                -1.509522e-01 1 1  ON 18
 ud_9                -1.389710e-01 1 1  ON 19
 eO_0                -7.566547e-01 1 1  ON 20
 eO_1                -4.358032e-01 1 1  ON 21
 eO_2                -1.925224e-02 1 1  ON 22
 eO_3                 2.973581e-01 1 1  ON 23
 eO_4                 5.210290e-01 1 1  ON 24
 eO_5                 4.808193e-01 1 1  ON 25
 eO_6                 2.502738e-01 1 1  ON 26
 eO_7                -4.787569e-02 1 1  ON 27
 eO_8                -2.148610e-01 1 1  ON 28
 eO_9                -7.524095e-02 1 1  ON 29
eH1_0                -2.450404e-01 1 1  ON 30
eH1_1                -1.421302e-01 1 1  ON 31
eH1_2                -9.460022e-02 1 1  ON 32
eH1_3                -4.010830e-02 1 1  ON 33
eH1_4                 8.080364e-03 1 1  ON 34
eH1_5                 4.203023e-02 1 1  ON 35
eH1_6                 9.922682e-02 1 1  ON 36
eH1_7                 1.518660e-01 1 1  ON 37
eH1_8                 1.693021e-01 1 1  ON 38
eH1_9                 5.541004e-02 1 1  ON 39
eH2_0                -2.432955e-01 1 1  ON 40
eH2_1                -1.398872e-01 1 1  ON 41
eH2_2                -9.217700e-02 1 1  ON 42
eH2_3                -3.790199e-02 1 1  ON 43
eH2_4                 1.069678e-02 1 1  ON 44
eH2_5                 4.560293e-02 1 1  ON 45
eH2_6                 1.023741e-01 1 1  ON 46
eH2_7                 1.548040e-01 1 1  ON 47
eH2_8                 1.748587e-01 1 1  ON 48
eH2_9                 4.125327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8281
    reference variance = 0.806987
====================================================
  Execution time = 2.0761e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3677e-01
  Total weights = 2.0000e+06
  Execution time = 1.8829e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336828300649
                                         uncertainty =       0.004384464774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336828300649
                                         uncertainty =       0.004384464774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410356042
  error estimate for blocks of size 2^( 2) =       0.000423389757
  error estimate for blocks of size 2^( 3) =       0.000436314827
  error estimate for blocks of size 2^( 4) =       0.000449813902
  error estimate for blocks of size 2^( 5) =       0.000461027165
  error estimate for blocks of size 2^( 6) =       0.000470558168
  error estimate for blocks of size 2^( 7) =       0.000474372059

      target function =                  N/A
              le_mean =     -16.906398720933
             les_mean =     286.163101705544
             stat err =       0.000463942823
             autocorr =       1.278224852458
              std dev =       0.580331080305
             le_variance =       0.336784162768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336861708566
                                         uncertainty =       0.004387490705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336861708566
                                         uncertainty =       0.004387490705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410376278
  error estimate for blocks of size 2^( 2) =       0.000423409905
  error estimate for blocks of size 2^( 3) =       0.000436332510
  error estimate for blocks of size 2^( 4) =       0.000449827973
  error estimate for blocks of size 2^( 5) =       0.000461034984
  error estimate for blocks of size 2^( 6) =       0.000470562154
  error estimate for blocks of size 2^( 7) =       0.000474384147

      target function =                  N/A
              le_mean =     -16.906400901673
             les_mean =     286.163208658726
             stat err =       0.000463952315
             autocorr =       1.278151090687
              std dev =       0.580359697991
             le_variance =       0.336817379053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336807682136
                                         uncertainty =       0.004387396495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336807682136
                                         uncertainty =       0.004387396495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410343363
  error estimate for blocks of size 2^( 2) =       0.000423377820
  error estimate for blocks of size 2^( 3) =       0.000436302721
  error estimate for blocks of size 2^( 4) =       0.000449800758
  error estimate for blocks of size 2^( 5) =       0.000461011135
  error estimate for blocks of size 2^( 6) =       0.000470539839
  error estimate for blocks of size 2^( 7) =       0.000474357586

      target function =                  N/A
              le_mean =     -16.906400732509
             les_mean =     286.163148911136
             stat err =       0.000463927330
             autocorr =       1.278218465783
              std dev =       0.580313149376
             le_variance =       0.336763351339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336816620457
                                         uncertainty =       0.004384889510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336816620457
                                         uncertainty =       0.004384889510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410348907
  error estimate for blocks of size 2^( 2) =       0.000423382938
  error estimate for blocks of size 2^( 3) =       0.000436308239
  error estimate for blocks of size 2^( 4) =       0.000449807367
  error estimate for blocks of size 2^( 5) =       0.000461020507
  error estimate for blocks of size 2^( 6) =       0.000470551237
  error estimate for blocks of size 2^( 7) =       0.000474365702

      target function =                  N/A
              le_mean =     -16.906398978990
             les_mean =     286.163098719604
             stat err =       0.000463936203
             autocorr =       1.278232824309
              std dev =       0.580320989792
             le_variance =       0.336772451193


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906398720933        initial
     1.5625e-01     1.5625e+00             1.3680e-03       -16.906400901673  <--
     6.2500e-01     6.2500e+00             3.4294e-04       -16.906400732509
     2.5000e+00     2.5000e+01             8.5211e-05       -16.906398978990

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.1330e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.106346e-01 1 1  ON 0
 uu_1                 1.436025e-01 1 1  ON 1
 uu_2                 4.212119e-02 1 1  ON 2
 uu_3                -2.019037e-02 1 1  ON 3
 uu_4                -6.553208e-02 1 1  ON 4
 uu_5                -1.000102e-01 1 1  ON 5
 uu_6                -1.270467e-01 1 1  ON 6
 uu_7                -1.403671e-01 1 1  ON 7
 uu_8                -1.325362e-01 1 1  ON 8
 uu_9                -1.012812e-01 1 1  ON 9
 ud_0                 4.478200e-01 1 1  ON 10
 ud_1                 1.819933e-01 1 1  ON 11
 ud_2                 6.126684e-02 1 1  ON 12
 ud_3                -9.876944e-03 1 1  ON 13
 ud_4                -6.669378e-02 1 1  ON 14
 ud_5                -1.077809e-01 1 1  ON 15
 ud_6                -1.348635e-01 1 1  ON 16
 ud_7                -1.505111e-01 1 1  ON 17
 ud_8                -1.510541e-01 1 1  ON 18
 ud_9                -1.390664e-01 1 1  ON 19
 eO_0                -7.568525e-01 1 1  ON 20
 eO_1                -4.359838e-01 1 1  ON 21
 eO_2                -1.918951e-02 1 1  ON 22
 eO_3                 2.975718e-01 1 1  ON 23
 eO_4                 5.214155e-01 1 1  ON 24
 eO_5                 4.813185e-01 1 1  ON 25
 eO_6                 2.506756e-01 1 1  ON 26
 eO_7                -4.786670e-02 1 1  ON 27
 eO_8                -2.153989e-01 1 1  ON 28
 eO_9                -7.584190e-02 1 1  ON 29
eH1_0                -2.453524e-01 1 1  ON 30
eH1_1                -1.425090e-01 1 1  ON 31
eH1_2                -9.510126e-02 1 1  ON 32
eH1_3                -4.050170e-02 1 1  ON 33
eH1_4                 7.832577e-03 1 1  ON 34
eH1_5                 4.192307e-02 1 1  ON 35
eH1_6                 9.953235e-02 1 1  ON 36
eH1_7                 1.519990e-01 1 1  ON 37
eH1_8                 1.700189e-01 1 1  ON 38
eH1_9                 5.619810e-02 1 1  ON 39
eH2_0                -2.436450e-01 1 1  ON 40
eH2_1                -1.401625e-01 1 1  ON 41
eH2_2                -9.246014e-02 1 1  ON 42
eH2_3                -3.836927e-02 1 1  ON 43
eH2_4                 1.031510e-02 1 1  ON 44
eH2_5                 4.517871e-02 1 1  ON 45
eH2_6                 1.022554e-01 1 1  ON 46
eH2_7                 1.551634e-01 1 1  ON 47
eH2_8                 1.755482e-01 1 1  ON 48
eH2_9                 4.227831e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8343e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9082
    reference variance = 0.229359
====================================================
  Execution time = 2.1810e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3378e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5390e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333895873694
                                         uncertainty =       0.003262849705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333895873694
                                         uncertainty =       0.003262849705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408522696
  error estimate for blocks of size 2^( 2) =       0.000421632870
  error estimate for blocks of size 2^( 3) =       0.000435048158
  error estimate for blocks of size 2^( 4) =       0.000448270208
  error estimate for blocks of size 2^( 5) =       0.000460729109
  error estimate for blocks of size 2^( 6) =       0.000469315602
  error estimate for blocks of size 2^( 7) =       0.000475805097

      target function =                  N/A
              le_mean =     -16.905209113064
             les_mean =     286.119876576435
             stat err =       0.000463530004
             autocorr =       1.287429103068
              std dev =       0.577738337735
             le_variance =       0.333781586889


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690520911306e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905209113064       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905213544320       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905213690611       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905212912755       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905214388430       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905212015839       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905208736590       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905211409019       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905215649960       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905216170942       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905217525284       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905218120687       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905217483220       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905217589161       residual = 5.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 5.637413e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905209113064       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905211967387       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905212031249       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905211968072       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905212781472       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905210335397       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905210983833       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905211535057       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905211711915       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905212162151       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.377560e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905209113064       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905210290851       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905210451998       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905210749295       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905210758627       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905209887332       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905210278653       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905210279029       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905210299279       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.462990e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126103 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7362e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.108095e-01 1 1  ON 0
 uu_1                 1.435606e-01 1 1  ON 1
 uu_2                 4.199245e-02 1 1  ON 2
 uu_3                -2.032819e-02 1 1  ON 3
 uu_4                -6.556701e-02 1 1  ON 4
 uu_5                -1.000566e-01 1 1  ON 5
 uu_6                -1.271567e-01 1 1  ON 6
 uu_7                -1.402856e-01 1 1  ON 7
 uu_8                -1.328230e-01 1 1  ON 8
 uu_9                -1.017922e-01 1 1  ON 9
 ud_0                 4.482709e-01 1 1  ON 10
 ud_1                 1.823487e-01 1 1  ON 11
 ud_2                 6.146923e-02 1 1  ON 12
 ud_3                -9.818172e-03 1 1  ON 13
 ud_4                -6.669723e-02 1 1  ON 14
 ud_5                -1.076949e-01 1 1  ON 15
 ud_6                -1.348201e-01 1 1  ON 16
 ud_7                -1.505462e-01 1 1  ON 17
 ud_8                -1.513105e-01 1 1  ON 18
 ud_9                -1.396173e-01 1 1  ON 19
 eO_0                -7.573824e-01 1 1  ON 20
 eO_1                -4.362468e-01 1 1  ON 21
 eO_2                -1.919919e-02 1 1  ON 22
 eO_3                 2.979346e-01 1 1  ON 23
 eO_4                 5.217250e-01 1 1  ON 24
 eO_5                 4.814562e-01 1 1  ON 25
 eO_6                 2.518148e-01 1 1  ON 26
 eO_7                -4.738433e-02 1 1  ON 27
 eO_8                -2.160362e-01 1 1  ON 28
 eO_9                -7.669907e-02 1 1  ON 29
eH1_0                -2.462217e-01 1 1  ON 30
eH1_1                -1.431261e-01 1 1  ON 31
eH1_2                -9.527629e-02 1 1  ON 32
eH1_3                -4.052815e-02 1 1  ON 33
eH1_4                 7.784656e-03 1 1  ON 34
eH1_5                 4.157949e-02 1 1  ON 35
eH1_6                 9.904572e-02 1 1  ON 36
eH1_7                 1.522519e-01 1 1  ON 37
eH1_8                 1.708411e-01 1 1  ON 38
eH1_9                 5.749350e-02 1 1  ON 39
eH2_0                -2.445837e-01 1 1  ON 40
eH2_1                -1.407863e-01 1 1  ON 41
eH2_2                -9.298527e-02 1 1  ON 42
eH2_3                -3.865465e-02 1 1  ON 43
eH2_4                 9.727682e-03 1 1  ON 44
eH2_5                 4.508529e-02 1 1  ON 45
eH2_6                 1.022458e-01 1 1  ON 46
eH2_7                 1.556608e-01 1 1  ON 47
eH2_8                 1.766399e-01 1 1  ON 48
eH2_9                 4.365587e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8947
    reference variance = 0.258646
====================================================
  Execution time = 1.9905e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4242e-01
  Total weights = 2.0000e+06
  Execution time = 1.8672e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342127601944
                                         uncertainty =       0.004607300030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342127601944
                                         uncertainty =       0.004607300030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413635235
  error estimate for blocks of size 2^( 2) =       0.000426117906
  error estimate for blocks of size 2^( 3) =       0.000438588328
  error estimate for blocks of size 2^( 4) =       0.000450644141
  error estimate for blocks of size 2^( 5) =       0.000459934326
  error estimate for blocks of size 2^( 6) =       0.000465623810
  error estimate for blocks of size 2^( 7) =       0.000469829547

      target function =                  N/A
              le_mean =     -16.905853686770
             les_mean =     286.150076922657
             stat err =       0.000461507956
             autocorr =       1.244868080692
              std dev =       0.584968559209
             le_variance =       0.342188215263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342576138502
                                         uncertainty =       0.004617638987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342576138502
                                         uncertainty =       0.004617638987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413906176
  error estimate for blocks of size 2^( 2) =       0.000426380009
  error estimate for blocks of size 2^( 3) =       0.000438831188
  error estimate for blocks of size 2^( 4) =       0.000450869283
  error estimate for blocks of size 2^( 5) =       0.000460131851
  error estimate for blocks of size 2^( 6) =       0.000465789263
  error estimate for blocks of size 2^( 7) =       0.000469979172

      target function =                  N/A
              le_mean =     -16.905847948647
             les_mean =     286.150331336365
             stat err =       0.000461692392
             autocorr =       1.244232734882
              std dev =       0.585351727526
             le_variance =       0.342636644918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342597290689
                                         uncertainty =       0.004617751451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342597290689
                                         uncertainty =       0.004617751451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413918998
  error estimate for blocks of size 2^( 2) =       0.000426391970
  error estimate for blocks of size 2^( 3) =       0.000438843179
  error estimate for blocks of size 2^( 4) =       0.000450885242
  error estimate for blocks of size 2^( 5) =       0.000460151800
  error estimate for blocks of size 2^( 6) =       0.000465815763
  error estimate for blocks of size 2^( 7) =       0.000470005422

      target function =                  N/A
              le_mean =     -16.905848049941
             les_mean =     286.150355990013
             stat err =       0.000461714557
             autocorr =       1.244275110096
              std dev =       0.585369860562
             le_variance =       0.342657873655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342217911323
                                         uncertainty =       0.004609177016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342217911323
                                         uncertainty =       0.004609177016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413689819
  error estimate for blocks of size 2^( 2) =       0.000426170419
  error estimate for blocks of size 2^( 3) =       0.000438636791
  error estimate for blocks of size 2^( 4) =       0.000450690229
  error estimate for blocks of size 2^( 5) =       0.000459976007
  error estimate for blocks of size 2^( 6) =       0.000465660944
  error estimate for blocks of size 2^( 7) =       0.000469863935

      target function =                  N/A
              le_mean =     -16.905852328669
             les_mean =     286.150121319592
             stat err =       0.000461547779
             autocorr =       1.244754385518
              std dev =       0.585045752043
             le_variance =       0.342278531984


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905853686770        initial  <--
     3.9062e-02     3.9062e-01             5.6374e-03       -16.905847948647
     1.5625e-01     1.5625e+00             1.3776e-03       -16.905848049941
     6.2500e-01     6.2500e+00             3.4630e-04       -16.905852328669

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3620
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.106346e-01 1 1  ON 0
 uu_1                 1.436025e-01 1 1  ON 1
 uu_2                 4.212119e-02 1 1  ON 2
 uu_3                -2.019037e-02 1 1  ON 3
 uu_4                -6.553208e-02 1 1  ON 4
 uu_5                -1.000102e-01 1 1  ON 5
 uu_6                -1.270467e-01 1 1  ON 6
 uu_7                -1.403671e-01 1 1  ON 7
 uu_8                -1.325362e-01 1 1  ON 8
 uu_9                -1.012812e-01 1 1  ON 9
 ud_0                 4.478200e-01 1 1  ON 10
 ud_1                 1.819933e-01 1 1  ON 11
 ud_2                 6.126684e-02 1 1  ON 12
 ud_3                -9.876944e-03 1 1  ON 13
 ud_4                -6.669378e-02 1 1  ON 14
 ud_5                -1.077809e-01 1 1  ON 15
 ud_6                -1.348635e-01 1 1  ON 16
 ud_7                -1.505111e-01 1 1  ON 17
 ud_8                -1.510541e-01 1 1  ON 18
 ud_9                -1.390664e-01 1 1  ON 19
 eO_0                -7.568525e-01 1 1  ON 20
 eO_1                -4.359838e-01 1 1  ON 21
 eO_2                -1.918951e-02 1 1  ON 22
 eO_3                 2.975718e-01 1 1  ON 23
 eO_4                 5.214155e-01 1 1  ON 24
 eO_5                 4.813185e-01 1 1  ON 25
 eO_6                 2.506756e-01 1 1  ON 26
 eO_7                -4.786670e-02 1 1  ON 27
 eO_8                -2.153989e-01 1 1  ON 28
 eO_9                -7.584190e-02 1 1  ON 29
eH1_0                -2.453524e-01 1 1  ON 30
eH1_1                -1.425090e-01 1 1  ON 31
eH1_2                -9.510126e-02 1 1  ON 32
eH1_3                -4.050170e-02 1 1  ON 33
eH1_4                 7.832577e-03 1 1  ON 34
eH1_5                 4.192307e-02 1 1  ON 35
eH1_6                 9.953235e-02 1 1  ON 36
eH1_7                 1.519990e-01 1 1  ON 37
eH1_8                 1.700189e-01 1 1  ON 38
eH1_9                 5.619810e-02 1 1  ON 39
eH2_0                -2.436450e-01 1 1  ON 40
eH2_1                -1.401625e-01 1 1  ON 41
eH2_2                -9.246014e-02 1 1  ON 42
eH2_3                -3.836927e-02 1 1  ON 43
eH2_4                 1.031510e-02 1 1  ON 44
eH2_5                 4.517871e-02 1 1  ON 45
eH2_6                 1.022554e-01 1 1  ON 46
eH2_7                 1.551634e-01 1 1  ON 47
eH2_8                 1.755482e-01 1 1  ON 48
eH2_9                 4.227831e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6864e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9169
    reference variance = 0.155091
====================================================
  Execution time = 2.1040e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3693e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5534e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336930401268
                                         uncertainty =       0.003405933775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336930401268
                                         uncertainty =       0.003405933775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410448004
  error estimate for blocks of size 2^( 2) =       0.000423358842
  error estimate for blocks of size 2^( 3) =       0.000436068213
  error estimate for blocks of size 2^( 4) =       0.000448056425
  error estimate for blocks of size 2^( 5) =       0.000458185441
  error estimate for blocks of size 2^( 6) =       0.000464843221
  error estimate for blocks of size 2^( 7) =       0.000469203465

      target function =                  N/A
              le_mean =     -16.907130613436
             les_mean =     286.188000539865
             stat err =       0.000460072138
             autocorr =       1.256422108225
              std dev =       0.580461134387
             le_variance =       0.336935128533


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690713061344e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907130613436       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907131257332       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907131667697       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907133057200       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907133755359       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907134022895       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907133767882       residual = 8.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907134021315       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907133784012       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 4.851497e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907130613436       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907130832862       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907130991858       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907131486025       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907131626437       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907131732192       residual = 7.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907131634032       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907131706501       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.221595e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907130613436       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907130673770       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907130720760       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907130856062       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907130900709       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907130917902       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907130892904       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907130910876       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.067322e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.128872 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6604e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.105751e-01 1 1  ON 0
 uu_1                 1.436400e-01 1 1  ON 1
 uu_2                 4.216077e-02 1 1  ON 2
 uu_3                -2.017573e-02 1 1  ON 3
 uu_4                -6.553859e-02 1 1  ON 4
 uu_5                -1.000375e-01 1 1  ON 5
 uu_6                -1.270960e-01 1 1  ON 6
 uu_7                -1.404015e-01 1 1  ON 7
 uu_8                -1.325874e-01 1 1  ON 8
 uu_9                -1.013245e-01 1 1  ON 9
 ud_0                 4.478134e-01 1 1  ON 10
 ud_1                 1.819616e-01 1 1  ON 11
 ud_2                 6.130588e-02 1 1  ON 12
 ud_3                -9.875221e-03 1 1  ON 13
 ud_4                -6.666185e-02 1 1  ON 14
 ud_5                -1.077191e-01 1 1  ON 15
 ud_6                -1.348173e-01 1 1  ON 16
 ud_7                -1.505078e-01 1 1  ON 17
 ud_8                -1.511096e-01 1 1  ON 18
 ud_9                -1.391044e-01 1 1  ON 19
 eO_0                -7.569142e-01 1 1  ON 20
 eO_1                -4.358952e-01 1 1  ON 21
 eO_2                -1.924097e-02 1 1  ON 22
 eO_3                 2.975352e-01 1 1  ON 23
 eO_4                 5.214373e-01 1 1  ON 24
 eO_5                 4.813900e-01 1 1  ON 25
 eO_6                 2.507874e-01 1 1  ON 26
 eO_7                -4.782545e-02 1 1  ON 27
 eO_8                -2.154947e-01 1 1  ON 28
 eO_9                -7.591937e-02 1 1  ON 29
eH1_0                -2.454578e-01 1 1  ON 30
eH1_1                -1.425090e-01 1 1  ON 31
eH1_2                -9.512104e-02 1 1  ON 32
eH1_3                -4.057703e-02 1 1  ON 33
eH1_4                 7.801738e-03 1 1  ON 34
eH1_5                 4.190824e-02 1 1  ON 35
eH1_6                 9.951468e-02 1 1  ON 36
eH1_7                 1.520127e-01 1 1  ON 37
eH1_8                 1.701410e-01 1 1  ON 38
eH1_9                 5.631584e-02 1 1  ON 39
eH2_0                -2.436758e-01 1 1  ON 40
eH2_1                -1.401571e-01 1 1  ON 41
eH2_2                -9.252117e-02 1 1  ON 42
eH2_3                -3.834874e-02 1 1  ON 43
eH2_4                 1.028751e-02 1 1  ON 44
eH2_5                 4.511449e-02 1 1  ON 45
eH2_6                 1.022399e-01 1 1  ON 46
eH2_7                 1.551698e-01 1 1  ON 47
eH2_8                 1.756048e-01 1 1  ON 48
eH2_9                 4.237594e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9257
    reference variance = 0.239021
====================================================
  Execution time = 2.0431e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4363e-01
  Total weights = 2.0000e+06
  Execution time = 1.8630e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343582695628
                                         uncertainty =       0.004199901526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343582695628
                                         uncertainty =       0.004199901526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414524005
  error estimate for blocks of size 2^( 2) =       0.000426959183
  error estimate for blocks of size 2^( 3) =       0.000439596994
  error estimate for blocks of size 2^( 4) =       0.000452679866
  error estimate for blocks of size 2^( 5) =       0.000462318244
  error estimate for blocks of size 2^( 6) =       0.000471051545
  error estimate for blocks of size 2^( 7) =       0.000475916116

      target function =                  N/A
              le_mean =     -16.906649619585
             les_mean =     286.178461489122
             stat err =       0.000465491443
             autocorr =       1.261025973813
              std dev =       0.586225469881
             le_variance =       0.343660301538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343490833350
                                         uncertainty =       0.004199827631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343490833350
                                         uncertainty =       0.004199827631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414468576
  error estimate for blocks of size 2^( 2) =       0.000426903863
  error estimate for blocks of size 2^( 3) =       0.000439540787
  error estimate for blocks of size 2^( 4) =       0.000452622635
  error estimate for blocks of size 2^( 5) =       0.000462264185
  error estimate for blocks of size 2^( 6) =       0.000470998676
  error estimate for blocks of size 2^( 7) =       0.000475872171

      target function =                  N/A
              le_mean =     -16.906648241568
             les_mean =     286.178322993310
             stat err =       0.000465439417
             autocorr =       1.261081346873
              std dev =       0.586147081366
             le_variance =       0.343568400994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343515717529
                                         uncertainty =       0.004199818178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343515717529
                                         uncertainty =       0.004199818178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414483590
  error estimate for blocks of size 2^( 2) =       0.000426919249
  error estimate for blocks of size 2^( 3) =       0.000439556668
  error estimate for blocks of size 2^( 4) =       0.000452638809
  error estimate for blocks of size 2^( 5) =       0.000462279507
  error estimate for blocks of size 2^( 6) =       0.000471014194
  error estimate for blocks of size 2^( 7) =       0.000475886175

      target function =                  N/A
              le_mean =     -16.906648322002
             les_mean =     286.178350603985
             stat err =       0.000465454671
             autocorr =       1.261072645958
              std dev =       0.586168313660
             le_variance =       0.343593291939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343573531312
                                         uncertainty =       0.004199894849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343573531312
                                         uncertainty =       0.004199894849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414518476
  error estimate for blocks of size 2^( 2) =       0.000426953713
  error estimate for blocks of size 2^( 3) =       0.000439591457
  error estimate for blocks of size 2^( 4) =       0.000452674213
  error estimate for blocks of size 2^( 5) =       0.000462312929
  error estimate for blocks of size 2^( 6) =       0.000471046444
  error estimate for blocks of size 2^( 7) =       0.000475912128

      target function =                  N/A
              le_mean =     -16.906649412316
             les_mean =     286.178445312490
             stat err =       0.000465486429
             autocorr =       1.261032449622
              std dev =       0.586217650161
             le_variance =       0.343651133361


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906649619585        initial  <--
     3.9062e-01     3.9062e+00             4.8515e-04       -16.906648241568
     1.5625e+00     1.5625e+01             1.2216e-04       -16.906648322002
     6.2500e+00     6.2500e+01             3.0673e-05       -16.906649412316

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8391
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.106346e-01 1 1  ON 0
 uu_1                 1.436025e-01 1 1  ON 1
 uu_2                 4.212119e-02 1 1  ON 2
 uu_3                -2.019037e-02 1 1  ON 3
 uu_4                -6.553208e-02 1 1  ON 4
 uu_5                -1.000102e-01 1 1  ON 5
 uu_6                -1.270467e-01 1 1  ON 6
 uu_7                -1.403671e-01 1 1  ON 7
 uu_8                -1.325362e-01 1 1  ON 8
 uu_9                -1.012812e-01 1 1  ON 9
 ud_0                 4.478200e-01 1 1  ON 10
 ud_1                 1.819933e-01 1 1  ON 11
 ud_2                 6.126684e-02 1 1  ON 12
 ud_3                -9.876944e-03 1 1  ON 13
 ud_4                -6.669378e-02 1 1  ON 14
 ud_5                -1.077809e-01 1 1  ON 15
 ud_6                -1.348635e-01 1 1  ON 16
 ud_7                -1.505111e-01 1 1  ON 17
 ud_8                -1.510541e-01 1 1  ON 18
 ud_9                -1.390664e-01 1 1  ON 19
 eO_0                -7.568525e-01 1 1  ON 20
 eO_1                -4.359838e-01 1 1  ON 21
 eO_2                -1.918951e-02 1 1  ON 22
 eO_3                 2.975718e-01 1 1  ON 23
 eO_4                 5.214155e-01 1 1  ON 24
 eO_5                 4.813185e-01 1 1  ON 25
 eO_6                 2.506756e-01 1 1  ON 26
 eO_7                -4.786670e-02 1 1  ON 27
 eO_8                -2.153989e-01 1 1  ON 28
 eO_9                -7.584190e-02 1 1  ON 29
eH1_0                -2.453524e-01 1 1  ON 30
eH1_1                -1.425090e-01 1 1  ON 31
eH1_2                -9.510126e-02 1 1  ON 32
eH1_3                -4.050170e-02 1 1  ON 33
eH1_4                 7.832577e-03 1 1  ON 34
eH1_5                 4.192307e-02 1 1  ON 35
eH1_6                 9.953235e-02 1 1  ON 36
eH1_7                 1.519990e-01 1 1  ON 37
eH1_8                 1.700189e-01 1 1  ON 38
eH1_9                 5.619810e-02 1 1  ON 39
eH2_0                -2.436450e-01 1 1  ON 40
eH2_1                -1.401625e-01 1 1  ON 41
eH2_2                -9.246014e-02 1 1  ON 42
eH2_3                -3.836927e-02 1 1  ON 43
eH2_4                 1.031510e-02 1 1  ON 44
eH2_5                 4.517871e-02 1 1  ON 45
eH2_6                 1.022554e-01 1 1  ON 46
eH2_7                 1.551634e-01 1 1  ON 47
eH2_8                 1.755482e-01 1 1  ON 48
eH2_9                 4.227831e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6750e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9147
    reference variance = 0.234948
====================================================
  Execution time = 2.0632e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3100e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5946e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330953294465
                                         uncertainty =       0.002607278203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330953294465
                                         uncertainty =       0.002607278203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406819603
  error estimate for blocks of size 2^( 2) =       0.000419543915
  error estimate for blocks of size 2^( 3) =       0.000432952597
  error estimate for blocks of size 2^( 4) =       0.000445481154
  error estimate for blocks of size 2^( 5) =       0.000455202456
  error estimate for blocks of size 2^( 6) =       0.000462475265
  error estimate for blocks of size 2^( 7) =       0.000467632410

      target function =                  N/A
              le_mean =     -16.906416815722
             les_mean =     286.157933760310
             stat err =       0.000457697821
             autocorr =       1.265767516117
              std dev =       0.575329800098
             le_variance =       0.331004378881


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690641681572e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906416815722       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906416886847       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906416718641       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906416758607       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906416566836       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906416549982       residual = 8.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906416618233       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906416620381       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 5.315663e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906416815722       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906416834043       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906416790019       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906416801422       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906416753590       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906416747331       residual = 7.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906416763421       residual = 9.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.352830e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906416815722       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906416820337       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906416809198       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906416812142       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906416800216       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906416798527       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906416802455       residual = 9.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 3.405628e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131302 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6237e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.106333e-01 1 1  ON 0
 uu_1                 1.436052e-01 1 1  ON 1
 uu_2                 4.212202e-02 1 1  ON 2
 uu_3                -2.019026e-02 1 1  ON 3
 uu_4                -6.553282e-02 1 1  ON 4
 uu_5                -1.000100e-01 1 1  ON 5
 uu_6                -1.270491e-01 1 1  ON 6
 uu_7                -1.403611e-01 1 1  ON 7
 uu_8                -1.325385e-01 1 1  ON 8
 uu_9                -1.012931e-01 1 1  ON 9
 ud_0                 4.478182e-01 1 1  ON 10
 ud_1                 1.819982e-01 1 1  ON 11
 ud_2                 6.127722e-02 1 1  ON 12
 ud_3                -9.874380e-03 1 1  ON 13
 ud_4                -6.669076e-02 1 1  ON 14
 ud_5                -1.077786e-01 1 1  ON 15
 ud_6                -1.348619e-01 1 1  ON 16
 ud_7                -1.505131e-01 1 1  ON 17
 ud_8                -1.510635e-01 1 1  ON 18
 ud_9                -1.390749e-01 1 1  ON 19
 eO_0                -7.568609e-01 1 1  ON 20
 eO_1                -4.359761e-01 1 1  ON 21
 eO_2                -1.919258e-02 1 1  ON 22
 eO_3                 2.975733e-01 1 1  ON 23
 eO_4                 5.214225e-01 1 1  ON 24
 eO_5                 4.813213e-01 1 1  ON 25
 eO_6                 2.506856e-01 1 1  ON 26
 eO_7                -4.786279e-02 1 1  ON 27
 eO_8                -2.154098e-01 1 1  ON 28
 eO_9                -7.585089e-02 1 1  ON 29
eH1_0                -2.453584e-01 1 1  ON 30
eH1_1                -1.425225e-01 1 1  ON 31
eH1_2                -9.510305e-02 1 1  ON 32
eH1_3                -4.050287e-02 1 1  ON 33
eH1_4                 7.828587e-03 1 1  ON 34
eH1_5                 4.192909e-02 1 1  ON 35
eH1_6                 9.953422e-02 1 1  ON 36
eH1_7                 1.519991e-01 1 1  ON 37
eH1_8                 1.700261e-01 1 1  ON 38
eH1_9                 5.620836e-02 1 1  ON 39
eH2_0                -2.436484e-01 1 1  ON 40
eH2_1                -1.401637e-01 1 1  ON 41
eH2_2                -9.246340e-02 1 1  ON 42
eH2_3                -3.836722e-02 1 1  ON 43
eH2_4                 1.031603e-02 1 1  ON 44
eH2_5                 4.516585e-02 1 1  ON 45
eH2_6                 1.022506e-01 1 1  ON 46
eH2_7                 1.551679e-01 1 1  ON 47
eH2_8                 1.755559e-01 1 1  ON 48
eH2_9                 4.228872e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9499
    reference variance = 0.229948
====================================================
  Execution time = 1.9928e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3669e-01
  Total weights = 2.0000e+06
  Execution time = 1.8955e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336754453552
                                         uncertainty =       0.003293322587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336754453552
                                         uncertainty =       0.003293322587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410305094
  error estimate for blocks of size 2^( 2) =       0.000422709879
  error estimate for blocks of size 2^( 3) =       0.000436105460
  error estimate for blocks of size 2^( 4) =       0.000448148567
  error estimate for blocks of size 2^( 5) =       0.000459153204
  error estimate for blocks of size 2^( 6) =       0.000468396658
  error estimate for blocks of size 2^( 7) =       0.000476174118

      target function =                  N/A
              le_mean =     -16.905834552717
             les_mean =     286.143942295047
             stat err =       0.000462968137
             autocorr =       1.273175838497
              std dev =       0.580259027991
             le_variance =       0.336700539565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336727575261
                                         uncertainty =       0.003293056956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336727575261
                                         uncertainty =       0.003293056956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410288719
  error estimate for blocks of size 2^( 2) =       0.000422694151
  error estimate for blocks of size 2^( 3) =       0.000436089930
  error estimate for blocks of size 2^( 4) =       0.000448133282
  error estimate for blocks of size 2^( 5) =       0.000459138633
  error estimate for blocks of size 2^( 6) =       0.000468382927
  error estimate for blocks of size 2^( 7) =       0.000476160323

      target function =                  N/A
              le_mean =     -16.905834275837
             les_mean =     286.143906060021
             stat err =       0.000462953791
             autocorr =       1.273198555945
              std dev =       0.580235871264
             le_variance =       0.336673666302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336738180439
                                         uncertainty =       0.003293161164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336738180439
                                         uncertainty =       0.003293161164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410295180
  error estimate for blocks of size 2^( 2) =       0.000422700393
  error estimate for blocks of size 2^( 3) =       0.000436096157
  error estimate for blocks of size 2^( 4) =       0.000448139437
  error estimate for blocks of size 2^( 5) =       0.000459144496
  error estimate for blocks of size 2^( 6) =       0.000468388375
  error estimate for blocks of size 2^( 7) =       0.000476165814

      target function =                  N/A
              le_mean =     -16.905834407961
             les_mean =     286.143921130459
             stat err =       0.000462959531
             autocorr =       1.273190026199
              std dev =       0.580245008078
             le_variance =       0.336684269399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336752372954
                                         uncertainty =       0.003293301998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336752372954
                                         uncertainty =       0.003293301998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410303826
  error estimate for blocks of size 2^( 2) =       0.000422708666
  error estimate for blocks of size 2^( 3) =       0.000436104271
  error estimate for blocks of size 2^( 4) =       0.000448147401
  error estimate for blocks of size 2^( 5) =       0.000459152092
  error estimate for blocks of size 2^( 6) =       0.000468395599
  error estimate for blocks of size 2^( 7) =       0.000476173056

      target function =                  N/A
              le_mean =     -16.905834534195
             les_mean =     286.143939588556
             stat err =       0.000462967037
             autocorr =       1.273177653207
              std dev =       0.580257235490
             le_variance =       0.336698459338


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905834552717        initial  <--
     3.9062e+00     3.9062e+01             5.3157e-05       -16.905834275837
     1.5625e+01     1.5625e+02             1.3528e-05       -16.905834407961
     6.2500e+01     6.2500e+02             3.4056e-06       -16.905834534195

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5182
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.106346e-01 1 1  ON 0
 uu_1                 1.436025e-01 1 1  ON 1
 uu_2                 4.212119e-02 1 1  ON 2
 uu_3                -2.019037e-02 1 1  ON 3
 uu_4                -6.553208e-02 1 1  ON 4
 uu_5                -1.000102e-01 1 1  ON 5
 uu_6                -1.270467e-01 1 1  ON 6
 uu_7                -1.403671e-01 1 1  ON 7
 uu_8                -1.325362e-01 1 1  ON 8
 uu_9                -1.012812e-01 1 1  ON 9
 ud_0                 4.478200e-01 1 1  ON 10
 ud_1                 1.819933e-01 1 1  ON 11
 ud_2                 6.126684e-02 1 1  ON 12
 ud_3                -9.876944e-03 1 1  ON 13
 ud_4                -6.669378e-02 1 1  ON 14
 ud_5                -1.077809e-01 1 1  ON 15
 ud_6                -1.348635e-01 1 1  ON 16
 ud_7                -1.505111e-01 1 1  ON 17
 ud_8                -1.510541e-01 1 1  ON 18
 ud_9                -1.390664e-01 1 1  ON 19
 eO_0                -7.568525e-01 1 1  ON 20
 eO_1                -4.359838e-01 1 1  ON 21
 eO_2                -1.918951e-02 1 1  ON 22
 eO_3                 2.975718e-01 1 1  ON 23
 eO_4                 5.214155e-01 1 1  ON 24
 eO_5                 4.813185e-01 1 1  ON 25
 eO_6                 2.506756e-01 1 1  ON 26
 eO_7                -4.786670e-02 1 1  ON 27
 eO_8                -2.153989e-01 1 1  ON 28
 eO_9                -7.584190e-02 1 1  ON 29
eH1_0                -2.453524e-01 1 1  ON 30
eH1_1                -1.425090e-01 1 1  ON 31
eH1_2                -9.510126e-02 1 1  ON 32
eH1_3                -4.050170e-02 1 1  ON 33
eH1_4                 7.832577e-03 1 1  ON 34
eH1_5                 4.192307e-02 1 1  ON 35
eH1_6                 9.953235e-02 1 1  ON 36
eH1_7                 1.519990e-01 1 1  ON 37
eH1_8                 1.700189e-01 1 1  ON 38
eH1_9                 5.619810e-02 1 1  ON 39
eH2_0                -2.436450e-01 1 1  ON 40
eH2_1                -1.401625e-01 1 1  ON 41
eH2_2                -9.246014e-02 1 1  ON 42
eH2_3                -3.836927e-02 1 1  ON 43
eH2_4                 1.031510e-02 1 1  ON 44
eH2_5                 4.517871e-02 1 1  ON 45
eH2_6                 1.022554e-01 1 1  ON 46
eH2_7                 1.551634e-01 1 1  ON 47
eH2_8                 1.755482e-01 1 1  ON 48
eH2_9                 4.227831e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5839e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8922
    reference variance = 0.296116
====================================================
  Execution time = 2.0814e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4168e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5195e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341701346040
                                         uncertainty =       0.004507251567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341701346040
                                         uncertainty =       0.004507251567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413329399
  error estimate for blocks of size 2^( 2) =       0.000426324903
  error estimate for blocks of size 2^( 3) =       0.000439387702
  error estimate for blocks of size 2^( 4) =       0.000451067497
  error estimate for blocks of size 2^( 5) =       0.000462061378
  error estimate for blocks of size 2^( 6) =       0.000468042646
  error estimate for blocks of size 2^( 7) =       0.000472226168

      target function =                  N/A
              le_mean =     -16.906054797103
             les_mean =     286.156371016313
             stat err =       0.000463349422
             autocorr =       1.256679869470
              std dev =       0.584536042090
             le_variance =       0.341682384502


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690605479710e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906054797103       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906054784694       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906054810643       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906054802271       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906054811548       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906054813079       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906054819908       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906054818022       residual = 7.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 6.470281e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906054797103       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906054793989       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906054800502       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906054798388       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906054800707       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906054801082       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906054802782       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906054802309       residual = 7.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.617915e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906054797103       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906054796324       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906054797954       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906054797424       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906054798004       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906054798097       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906054798521       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906054798402       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 4.045009e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133958 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6344e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.106341e-01 1 1  ON 0
 uu_1                 1.436029e-01 1 1  ON 1
 uu_2                 4.212182e-02 1 1  ON 2
 uu_3                -2.019043e-02 1 1  ON 3
 uu_4                -6.553185e-02 1 1  ON 4
 uu_5                -1.000102e-01 1 1  ON 5
 uu_6                -1.270470e-01 1 1  ON 6
 uu_7                -1.403673e-01 1 1  ON 7
 uu_8                -1.325371e-01 1 1  ON 8
 uu_9                -1.012820e-01 1 1  ON 9
 ud_0                 4.478215e-01 1 1  ON 10
 ud_1                 1.819925e-01 1 1  ON 11
 ud_2                 6.126683e-02 1 1  ON 12
 ud_3                -9.876616e-03 1 1  ON 13
 ud_4                -6.669370e-02 1 1  ON 14
 ud_5                -1.077806e-01 1 1  ON 15
 ud_6                -1.348629e-01 1 1  ON 16
 ud_7                -1.505109e-01 1 1  ON 17
 ud_8                -1.510553e-01 1 1  ON 18
 ud_9                -1.390675e-01 1 1  ON 19
 eO_0                -7.568530e-01 1 1  ON 20
 eO_1                -4.359836e-01 1 1  ON 21
 eO_2                -1.918922e-02 1 1  ON 22
 eO_3                 2.975717e-01 1 1  ON 23
 eO_4                 5.214154e-01 1 1  ON 24
 eO_5                 4.813191e-01 1 1  ON 25
 eO_6                 2.506772e-01 1 1  ON 26
 eO_7                -4.786646e-02 1 1  ON 27
 eO_8                -2.154001e-01 1 1  ON 28
 eO_9                -7.584283e-02 1 1  ON 29
eH1_0                -2.453534e-01 1 1  ON 30
eH1_1                -1.425104e-01 1 1  ON 31
eH1_2                -9.510030e-02 1 1  ON 32
eH1_3                -4.050249e-02 1 1  ON 33
eH1_4                 7.832583e-03 1 1  ON 34
eH1_5                 4.192315e-02 1 1  ON 35
eH1_6                 9.953222e-02 1 1  ON 36
eH1_7                 1.519994e-01 1 1  ON 37
eH1_8                 1.700197e-01 1 1  ON 38
eH1_9                 5.619926e-02 1 1  ON 39
eH2_0                -2.436459e-01 1 1  ON 40
eH2_1                -1.401622e-01 1 1  ON 41
eH2_2                -9.246123e-02 1 1  ON 42
eH2_3                -3.836904e-02 1 1  ON 43
eH2_4                 1.031458e-02 1 1  ON 44
eH2_5                 4.517820e-02 1 1  ON 45
eH2_6                 1.022549e-01 1 1  ON 46
eH2_7                 1.551637e-01 1 1  ON 47
eH2_8                 1.755493e-01 1 1  ON 48
eH2_9                 4.227967e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9807
    reference variance = 0.723009
====================================================
  Execution time = 2.0105e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5987e-01
  Total weights = 2.0000e+06
  Execution time = 1.8684e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359875207318
                                         uncertainty =       0.018259622511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359875207318
                                         uncertainty =       0.018259622511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424184272
  error estimate for blocks of size 2^( 2) =       0.000436744264
  error estimate for blocks of size 2^( 3) =       0.000449926175
  error estimate for blocks of size 2^( 4) =       0.000462236737
  error estimate for blocks of size 2^( 5) =       0.000472729812
  error estimate for blocks of size 2^( 6) =       0.000482586565
  error estimate for blocks of size 2^( 7) =       0.000487244507

      target function =                  N/A
              le_mean =     -16.905661457107
             les_mean =     286.161253715981
             stat err =       0.000476199405
             autocorr =       1.260284438681
              std dev =       0.599887150735
             le_variance =       0.359864593617

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359879662901
                                         uncertainty =       0.018259668940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359879662901
                                         uncertainty =       0.018259668940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424186900
  error estimate for blocks of size 2^( 2) =       0.000436746710
  error estimate for blocks of size 2^( 3) =       0.000449928464
  error estimate for blocks of size 2^( 4) =       0.000462238894
  error estimate for blocks of size 2^( 5) =       0.000472731952
  error estimate for blocks of size 2^( 6) =       0.000482588716
  error estimate for blocks of size 2^( 7) =       0.000487246640

      target function =                  N/A
              le_mean =     -16.905661463546
             les_mean =     286.161258392712
             stat err =       0.000476201551
             autocorr =       1.260280178165
              std dev =       0.599890867247
             le_variance =       0.359869052606

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359877459961
                                         uncertainty =       0.018259646041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359877459961
                                         uncertainty =       0.018259646041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424185601
  error estimate for blocks of size 2^( 2) =       0.000436745501
  error estimate for blocks of size 2^( 3) =       0.000449927333
  error estimate for blocks of size 2^( 4) =       0.000462237828
  error estimate for blocks of size 2^( 5) =       0.000472730894
  error estimate for blocks of size 2^( 6) =       0.000482587653
  error estimate for blocks of size 2^( 7) =       0.000487245585

      target function =                  N/A
              le_mean =     -16.905661460307
             les_mean =     286.161256078557
             stat err =       0.000476200490
             autocorr =       1.260282285918
              std dev =       0.599889029722
             le_variance =       0.359866847980

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359875489652
                                         uncertainty =       0.018259625462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359875489652
                                         uncertainty =       0.018259625462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424184439
  error estimate for blocks of size 2^( 2) =       0.000436744419
  error estimate for blocks of size 2^( 3) =       0.000449926320
  error estimate for blocks of size 2^( 4) =       0.000462236874
  error estimate for blocks of size 2^( 5) =       0.000472729948
  error estimate for blocks of size 2^( 6) =       0.000482586701
  error estimate for blocks of size 2^( 7) =       0.000487244642

      target function =                  N/A
              le_mean =     -16.905661457503
             les_mean =     286.161254011931
             stat err =       0.000476199541
             autocorr =       1.260284168875
              std dev =       0.599887386237
             le_variance =       0.359864876166


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905661457107        initial
     3.9062e+01     3.9062e+02             6.4703e-06       -16.905661463546  <--
     1.5625e+02     1.5625e+03             1.6179e-06       -16.905661460307
     6.2500e+02     6.2500e+03             4.0450e-07       -16.905661457503

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 2.9542e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.106326e-01 1 1  ON 0
 uu_1                 1.436044e-01 1 1  ON 1
 uu_2                 4.212368e-02 1 1  ON 2
 uu_3                -2.019059e-02 1 1  ON 3
 uu_4                -6.553118e-02 1 1  ON 4
 uu_5                -1.000101e-01 1 1  ON 5
 uu_6                -1.270481e-01 1 1  ON 6
 uu_7                -1.403679e-01 1 1  ON 7
 uu_8                -1.325400e-01 1 1  ON 8
 uu_9                -1.012841e-01 1 1  ON 9
 ud_0                 4.478260e-01 1 1  ON 10
 ud_1                 1.819904e-01 1 1  ON 11
 ud_2                 6.126680e-02 1 1  ON 12
 ud_3                -9.875640e-03 1 1  ON 13
 ud_4                -6.669344e-02 1 1  ON 14
 ud_5                -1.077795e-01 1 1  ON 15
 ud_6                -1.348609e-01 1 1  ON 16
 ud_7                -1.505101e-01 1 1  ON 17
 ud_8                -1.510587e-01 1 1  ON 18
 ud_9                -1.390709e-01 1 1  ON 19
 eO_0                -7.568545e-01 1 1  ON 20
 eO_1                -4.359830e-01 1 1  ON 21
 eO_2                -1.918838e-02 1 1  ON 22
 eO_3                 2.975713e-01 1 1  ON 23
 eO_4                 5.214152e-01 1 1  ON 24
 eO_5                 4.813212e-01 1 1  ON 25
 eO_6                 2.506820e-01 1 1  ON 26
 eO_7                -4.786577e-02 1 1  ON 27
 eO_8                -2.154039e-01 1 1  ON 28
 eO_9                -7.584561e-02 1 1  ON 29
eH1_0                -2.453566e-01 1 1  ON 30
eH1_1                -1.425146e-01 1 1  ON 31
eH1_2                -9.509743e-02 1 1  ON 32
eH1_3                -4.050486e-02 1 1  ON 33
eH1_4                 7.832594e-03 1 1  ON 34
eH1_5                 4.192341e-02 1 1  ON 35
eH1_6                 9.953186e-02 1 1  ON 36
eH1_7                 1.520006e-01 1 1  ON 37
eH1_8                 1.700222e-01 1 1  ON 38
eH1_9                 5.620274e-02 1 1  ON 39
eH2_0                -2.436486e-01 1 1  ON 40
eH2_1                -1.401613e-01 1 1  ON 41
eH2_2                -9.246448e-02 1 1  ON 42
eH2_3                -3.836836e-02 1 1  ON 43
eH2_4                 1.031304e-02 1 1  ON 44
eH2_5                 4.517668e-02 1 1  ON 45
eH2_6                 1.022537e-01 1 1  ON 46
eH2_7                 1.551648e-01 1 1  ON 47
eH2_8                 1.755523e-01 1 1  ON 48
eH2_9                 4.228376e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5932e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8921
    reference variance = 0.345952
====================================================
  Execution time = 2.0676e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3300e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6015e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333053622446
                                         uncertainty =       0.002995170755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333053622446
                                         uncertainty =       0.002995170755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408043634
  error estimate for blocks of size 2^( 2) =       0.000420566733
  error estimate for blocks of size 2^( 3) =       0.000433403962
  error estimate for blocks of size 2^( 4) =       0.000445086555
  error estimate for blocks of size 2^( 5) =       0.000453680423
  error estimate for blocks of size 2^( 6) =       0.000461230065
  error estimate for blocks of size 2^( 7) =       0.000465647155

      target function =                  N/A
              le_mean =     -16.906829306281
             les_mean =     286.173876240254
             stat err =       0.000456411050
             autocorr =       1.251120344040
              std dev =       0.577060841715
             le_variance =       0.332999215041


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690682930628e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906829306281       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906829310726       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906829330319       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906829310637       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906829282377       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906829286291       residual = 9.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906829284295       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906829293637       residual = 7.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.474676e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906829306281       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906829307403       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906829312276       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906829307145       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906829299694       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906829300483       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906829299840       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906829301997       residual = 6.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 6.212290e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906829306281       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906829306562       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906829307779       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906829306482       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906829304595       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906829304779       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906829304609       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906829305136       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.554711e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136580 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6290e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.106352e-01 1 1  ON 0
 uu_1                 1.436025e-01 1 1  ON 1
 uu_2                 4.212468e-02 1 1  ON 2
 uu_3                -2.019193e-02 1 1  ON 3
 uu_4                -6.552664e-02 1 1  ON 4
 uu_5                -1.000083e-01 1 1  ON 5
 uu_6                -1.270470e-01 1 1  ON 6
 uu_7                -1.403676e-01 1 1  ON 7
 uu_8                -1.325450e-01 1 1  ON 8
 uu_9                -1.012891e-01 1 1  ON 9
 ud_0                 4.478305e-01 1 1  ON 10
 ud_1                 1.819922e-01 1 1  ON 11
 ud_2                 6.127151e-02 1 1  ON 12
 ud_3                -9.874102e-03 1 1  ON 13
 ud_4                -6.669193e-02 1 1  ON 14
 ud_5                -1.077796e-01 1 1  ON 15
 ud_6                -1.348598e-01 1 1  ON 16
 ud_7                -1.505114e-01 1 1  ON 17
 ud_8                -1.510649e-01 1 1  ON 18
 ud_9                -1.390758e-01 1 1  ON 19
 eO_0                -7.568569e-01 1 1  ON 20
 eO_1                -4.359794e-01 1 1  ON 21
 eO_2                -1.918740e-02 1 1  ON 22
 eO_3                 2.975712e-01 1 1  ON 23
 eO_4                 5.214156e-01 1 1  ON 24
 eO_5                 4.813240e-01 1 1  ON 25
 eO_6                 2.506860e-01 1 1  ON 26
 eO_7                -4.786471e-02 1 1  ON 27
 eO_8                -2.154096e-01 1 1  ON 28
 eO_9                -7.584968e-02 1 1  ON 29
eH1_0                -2.453584e-01 1 1  ON 30
eH1_1                -1.425174e-01 1 1  ON 31
eH1_2                -9.509675e-02 1 1  ON 32
eH1_3                -4.050893e-02 1 1  ON 33
eH1_4                 7.832024e-03 1 1  ON 34
eH1_5                 4.192362e-02 1 1  ON 35
eH1_6                 9.953069e-02 1 1  ON 36
eH1_7                 1.520016e-01 1 1  ON 37
eH1_8                 1.700265e-01 1 1  ON 38
eH1_9                 5.620668e-02 1 1  ON 39
eH2_0                -2.436519e-01 1 1  ON 40
eH2_1                -1.401604e-01 1 1  ON 41
eH2_2                -9.246625e-02 1 1  ON 42
eH2_3                -3.836824e-02 1 1  ON 43
eH2_4                 1.031141e-02 1 1  ON 44
eH2_5                 4.517505e-02 1 1  ON 45
eH2_6                 1.022539e-01 1 1  ON 46
eH2_7                 1.551646e-01 1 1  ON 47
eH2_8                 1.755555e-01 1 1  ON 48
eH2_9                 4.228813e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9211
    reference variance = 0.225076
====================================================
  Execution time = 2.0366e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3588e-01
  Total weights = 2.0000e+06
  Execution time = 1.8527e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335873038785
                                         uncertainty =       0.003496093894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335873038785
                                         uncertainty =       0.003496093894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409805018
  error estimate for blocks of size 2^( 2) =       0.000422843337
  error estimate for blocks of size 2^( 3) =       0.000436101098
  error estimate for blocks of size 2^( 4) =       0.000448316276
  error estimate for blocks of size 2^( 5) =       0.000459199342
  error estimate for blocks of size 2^( 6) =       0.000467544219
  error estimate for blocks of size 2^( 7) =       0.000474166954

      target function =                  N/A
              le_mean =     -16.906032465341
             les_mean =     286.149813856660
             stat err =       0.000462306698
             autocorr =       1.272640754993
              std dev =       0.579551814273
             le_variance =       0.335880305427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335875882660
                                         uncertainty =       0.003496143977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335875882660
                                         uncertainty =       0.003496143977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409806752
  error estimate for blocks of size 2^( 2) =       0.000422844936
  error estimate for blocks of size 2^( 3) =       0.000436102558
  error estimate for blocks of size 2^( 4) =       0.000448317634
  error estimate for blocks of size 2^( 5) =       0.000459200473
  error estimate for blocks of size 2^( 6) =       0.000467545298
  error estimate for blocks of size 2^( 7) =       0.000474168149

      target function =                  N/A
              le_mean =     -16.906032482867
             les_mean =     286.149817291248
             stat err =       0.000462307889
             autocorr =       1.272636543433
              std dev =       0.579554266170
             le_variance =       0.335883147436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335874413833
                                         uncertainty =       0.003496119409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335874413833
                                         uncertainty =       0.003496119409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409805856
  error estimate for blocks of size 2^( 2) =       0.000422844111
  error estimate for blocks of size 2^( 3) =       0.000436101807
  error estimate for blocks of size 2^( 4) =       0.000448316937
  error estimate for blocks of size 2^( 5) =       0.000459199887
  error estimate for blocks of size 2^( 6) =       0.000467544736
  error estimate for blocks of size 2^( 7) =       0.000474167524

      target function =                  N/A
              le_mean =     -16.906032474125
             les_mean =     286.149815527749
             stat err =       0.000462307271
             autocorr =       1.272638704316
              std dev =       0.579552999758
             le_variance =       0.335881679528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335873208764
                                         uncertainty =       0.003496097099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335873208764
                                         uncertainty =       0.003496097099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409805122
  error estimate for blocks of size 2^( 2) =       0.000422843432
  error estimate for blocks of size 2^( 3) =       0.000436101185
  error estimate for blocks of size 2^( 4) =       0.000448316358
  error estimate for blocks of size 2^( 5) =       0.000459199409
  error estimate for blocks of size 2^( 6) =       0.000467544282
  error estimate for blocks of size 2^( 7) =       0.000474167024

      target function =                  N/A
              le_mean =     -16.906032466407
             les_mean =     286.149814062560
             stat err =       0.000462306768
             autocorr =       1.272640500468
              std dev =       0.579551960818
             le_variance =       0.335880475288


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906032465341        initial
     9.7656e+00     9.7656e+01             2.4747e-05       -16.906032482867  <--
     3.9062e+01     3.9062e+02             6.2123e-06       -16.906032474125
     1.5625e+02     1.5625e+03             1.5547e-06       -16.906032466407

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 2.9749e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.106428e-01 1 1  ON 0
 uu_1                 1.435970e-01 1 1  ON 1
 uu_2                 4.212757e-02 1 1  ON 2
 uu_3                -2.019565e-02 1 1  ON 3
 uu_4                -6.551348e-02 1 1  ON 4
 uu_5                -1.000027e-01 1 1  ON 5
 uu_6                -1.270437e-01 1 1  ON 6
 uu_7                -1.403667e-01 1 1  ON 7
 uu_8                -1.325596e-01 1 1  ON 8
 uu_9                -1.013040e-01 1 1  ON 9
 ud_0                 4.478436e-01 1 1  ON 10
 ud_1                 1.819977e-01 1 1  ON 11
 ud_2                 6.128520e-02 1 1  ON 12
 ud_3                -9.869283e-03 1 1  ON 13
 ud_4                -6.668742e-02 1 1  ON 14
 ud_5                -1.077796e-01 1 1  ON 15
 ud_6                -1.348565e-01 1 1  ON 16
 ud_7                -1.505150e-01 1 1  ON 17
 ud_8                -1.510834e-01 1 1  ON 18
 ud_9                -1.390904e-01 1 1  ON 19
 eO_0                -7.568641e-01 1 1  ON 20
 eO_1                -4.359687e-01 1 1  ON 21
 eO_2                -1.918434e-02 1 1  ON 22
 eO_3                 2.975707e-01 1 1  ON 23
 eO_4                 5.214169e-01 1 1  ON 24
 eO_5                 4.813323e-01 1 1  ON 25
 eO_6                 2.506977e-01 1 1  ON 26
 eO_7                -4.786154e-02 1 1  ON 27
 eO_8                -2.154268e-01 1 1  ON 28
 eO_9                -7.586190e-02 1 1  ON 29
eH1_0                -2.453639e-01 1 1  ON 30
eH1_1                -1.425257e-01 1 1  ON 31
eH1_2                -9.509494e-02 1 1  ON 32
eH1_3                -4.052094e-02 1 1  ON 33
eH1_4                 7.830208e-03 1 1  ON 34
eH1_5                 4.192423e-02 1 1  ON 35
eH1_6                 9.952722e-02 1 1  ON 36
eH1_7                 1.520046e-01 1 1  ON 37
eH1_8                 1.700391e-01 1 1  ON 38
eH1_9                 5.621849e-02 1 1  ON 39
eH2_0                -2.436618e-01 1 1  ON 40
eH2_1                -1.401579e-01 1 1  ON 41
eH2_2                -9.247141e-02 1 1  ON 42
eH2_3                -3.836796e-02 1 1  ON 43
eH2_4                 1.030664e-02 1 1  ON 44
eH2_5                 4.517020e-02 1 1  ON 45
eH2_6                 1.022544e-01 1 1  ON 46
eH2_7                 1.551640e-01 1 1  ON 47
eH2_8                 1.755653e-01 1 1  ON 48
eH2_9                 4.230122e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6228e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9064
    reference variance = 0.238752
====================================================
  Execution time = 2.2856e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4706e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5093e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347044241913
                                         uncertainty =       0.011445773037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347044241913
                                         uncertainty =       0.011445773037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416571135
  error estimate for blocks of size 2^( 2) =       0.000429670304
  error estimate for blocks of size 2^( 3) =       0.000442804927
  error estimate for blocks of size 2^( 4) =       0.000455184235
  error estimate for blocks of size 2^( 5) =       0.000467005027
  error estimate for blocks of size 2^( 6) =       0.000474634737
  error estimate for blocks of size 2^( 7) =       0.000481321500

      target function =                  N/A
              le_mean =     -16.905906547568
             les_mean =     286.156739042892
             stat err =       0.000469536375
             autocorr =       1.270457489236
              std dev =       0.589120549064
             le_variance =       0.347063021330


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690590654757e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905906547568       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905906618707       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905906803641       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905907006176       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905907145278       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905907213882       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905907157610       residual = 7.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 9.210585e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905906547568       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905906566644       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905906614524       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905906667585       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905906705695       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905906721972       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905906714340       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.319430e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905906547568       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905906552425       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905906564506       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905906577924       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905906587724       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905906591687       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905906590234       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 5.808385e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138866 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8375e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.106427e-01 1 1  ON 0
 uu_1                 1.436035e-01 1 1  ON 1
 uu_2                 4.213021e-02 1 1  ON 2
 uu_3                -2.019765e-02 1 1  ON 3
 uu_4                -6.551270e-02 1 1  ON 4
 uu_5                -1.000104e-01 1 1  ON 5
 uu_6                -1.270547e-01 1 1  ON 6
 uu_7                -1.403645e-01 1 1  ON 7
 uu_8                -1.325685e-01 1 1  ON 8
 uu_9                -1.013095e-01 1 1  ON 9
 ud_0                 4.478494e-01 1 1  ON 10
 ud_1                 1.819979e-01 1 1  ON 11
 ud_2                 6.128819e-02 1 1  ON 12
 ud_3                -9.867954e-03 1 1  ON 13
 ud_4                -6.667803e-02 1 1  ON 14
 ud_5                -1.077809e-01 1 1  ON 15
 ud_6                -1.348448e-01 1 1  ON 16
 ud_7                -1.505192e-01 1 1  ON 17
 ud_8                -1.510964e-01 1 1  ON 18
 ud_9                -1.390986e-01 1 1  ON 19
 eO_0                -7.568712e-01 1 1  ON 20
 eO_1                -4.359623e-01 1 1  ON 21
 eO_2                -1.919349e-02 1 1  ON 22
 eO_3                 2.975775e-01 1 1  ON 23
 eO_4                 5.214271e-01 1 1  ON 24
 eO_5                 4.813417e-01 1 1  ON 25
 eO_6                 2.507017e-01 1 1  ON 26
 eO_7                -4.785696e-02 1 1  ON 27
 eO_8                -2.154387e-01 1 1  ON 28
 eO_9                -7.587364e-02 1 1  ON 29
eH1_0                -2.453781e-01 1 1  ON 30
eH1_1                -1.425299e-01 1 1  ON 31
eH1_2                -9.510906e-02 1 1  ON 32
eH1_3                -4.052954e-02 1 1  ON 33
eH1_4                 7.814201e-03 1 1  ON 34
eH1_5                 4.191939e-02 1 1  ON 35
eH1_6                 9.952892e-02 1 1  ON 36
eH1_7                 1.520169e-01 1 1  ON 37
eH1_8                 1.700598e-01 1 1  ON 38
eH1_9                 5.624168e-02 1 1  ON 39
eH2_0                -2.436671e-01 1 1  ON 40
eH2_1                -1.401597e-01 1 1  ON 41
eH2_2                -9.248608e-02 1 1  ON 42
eH2_3                -3.837107e-02 1 1  ON 43
eH2_4                 1.028582e-02 1 1  ON 44
eH2_5                 4.517370e-02 1 1  ON 45
eH2_6                 1.022658e-01 1 1  ON 46
eH2_7                 1.551686e-01 1 1  ON 47
eH2_8                 1.755723e-01 1 1  ON 48
eH2_9                 4.231859e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9274
    reference variance = 0.195945
====================================================
  Execution time = 2.0283e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3651e-01
  Total weights = 2.0000e+06
  Execution time = 1.8522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336034015997
                                         uncertainty =       0.003702178786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336034015997
                                         uncertainty =       0.003702178786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410187867
  error estimate for blocks of size 2^( 2) =       0.000423279344
  error estimate for blocks of size 2^( 3) =       0.000436836793
  error estimate for blocks of size 2^( 4) =       0.000450198531
  error estimate for blocks of size 2^( 5) =       0.000460576370
  error estimate for blocks of size 2^( 6) =       0.000471353073
  error estimate for blocks of size 2^( 7) =       0.000478547723

      target function =                  N/A
              le_mean =     -16.905798339348
             les_mean =     286.142525494797
             stat err =       0.000465168924
             autocorr =       1.286043823031
              std dev =       0.580093244526
             le_variance =       0.336508172345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336057809939
                                         uncertainty =       0.003702456668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336057809939
                                         uncertainty =       0.003702456668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410202402
  error estimate for blocks of size 2^( 2) =       0.000423293152
  error estimate for blocks of size 2^( 3) =       0.000436849827
  error estimate for blocks of size 2^( 4) =       0.000450210921
  error estimate for blocks of size 2^( 5) =       0.000460587513
  error estimate for blocks of size 2^( 6) =       0.000471364101
  error estimate for blocks of size 2^( 7) =       0.000478557316

      target function =                  N/A
              le_mean =     -16.905798181893
             les_mean =     286.142544020644
             stat err =       0.000465179963
             autocorr =       1.286013712980
              std dev =       0.580113800926
             le_variance =       0.336532022025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336047255473
                                         uncertainty =       0.003702335180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336047255473
                                         uncertainty =       0.003702335180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410195954
  error estimate for blocks of size 2^( 2) =       0.000423287033
  error estimate for blocks of size 2^( 3) =       0.000436844061
  error estimate for blocks of size 2^( 4) =       0.000450205447
  error estimate for blocks of size 2^( 5) =       0.000460582605
  error estimate for blocks of size 2^( 6) =       0.000471359279
  error estimate for blocks of size 2^( 7) =       0.000478553187

      target function =                  N/A
              le_mean =     -16.905798239537
             les_mean =     286.142535388661
             stat err =       0.000465175129
             autocorr =       1.286027424888
              std dev =       0.580104681053
             le_variance =       0.336521440979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336035712043
                                         uncertainty =       0.003702198946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336035712043
                                         uncertainty =       0.003702198946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410188903
  error estimate for blocks of size 2^( 2) =       0.000423280329
  error estimate for blocks of size 2^( 3) =       0.000436837724
  error estimate for blocks of size 2^( 4) =       0.000450199417
  error estimate for blocks of size 2^( 5) =       0.000460577169
  error estimate for blocks of size 2^( 6) =       0.000471353870
  error estimate for blocks of size 2^( 7) =       0.000478548427

      target function =                  N/A
              le_mean =     -16.905798325815
             les_mean =     286.142526736938
             stat err =       0.000465169721
             autocorr =       1.286041730588
              std dev =       0.580094709569
             le_variance =       0.336509872070


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905798339348        initial  <--
     2.4414e+00     2.4414e+01             9.2106e-05       -16.905798181893
     9.7656e+00     9.7656e+01             2.3194e-05       -16.905798239537
     3.9062e+01     3.9062e+02             5.8084e-06       -16.905798325815

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6745
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.106428e-01 1 1  ON 0
 uu_1                 1.435970e-01 1 1  ON 1
 uu_2                 4.212757e-02 1 1  ON 2
 uu_3                -2.019565e-02 1 1  ON 3
 uu_4                -6.551348e-02 1 1  ON 4
 uu_5                -1.000027e-01 1 1  ON 5
 uu_6                -1.270437e-01 1 1  ON 6
 uu_7                -1.403667e-01 1 1  ON 7
 uu_8                -1.325596e-01 1 1  ON 8
 uu_9                -1.013040e-01 1 1  ON 9
 ud_0                 4.478436e-01 1 1  ON 10
 ud_1                 1.819977e-01 1 1  ON 11
 ud_2                 6.128520e-02 1 1  ON 12
 ud_3                -9.869283e-03 1 1  ON 13
 ud_4                -6.668742e-02 1 1  ON 14
 ud_5                -1.077796e-01 1 1  ON 15
 ud_6                -1.348565e-01 1 1  ON 16
 ud_7                -1.505150e-01 1 1  ON 17
 ud_8                -1.510834e-01 1 1  ON 18
 ud_9                -1.390904e-01 1 1  ON 19
 eO_0                -7.568641e-01 1 1  ON 20
 eO_1                -4.359687e-01 1 1  ON 21
 eO_2                -1.918434e-02 1 1  ON 22
 eO_3                 2.975707e-01 1 1  ON 23
 eO_4                 5.214169e-01 1 1  ON 24
 eO_5                 4.813323e-01 1 1  ON 25
 eO_6                 2.506977e-01 1 1  ON 26
 eO_7                -4.786154e-02 1 1  ON 27
 eO_8                -2.154268e-01 1 1  ON 28
 eO_9                -7.586190e-02 1 1  ON 29
eH1_0                -2.453639e-01 1 1  ON 30
eH1_1                -1.425257e-01 1 1  ON 31
eH1_2                -9.509494e-02 1 1  ON 32
eH1_3                -4.052094e-02 1 1  ON 33
eH1_4                 7.830208e-03 1 1  ON 34
eH1_5                 4.192423e-02 1 1  ON 35
eH1_6                 9.952722e-02 1 1  ON 36
eH1_7                 1.520046e-01 1 1  ON 37
eH1_8                 1.700391e-01 1 1  ON 38
eH1_9                 5.621849e-02 1 1  ON 39
eH2_0                -2.436618e-01 1 1  ON 40
eH2_1                -1.401579e-01 1 1  ON 41
eH2_2                -9.247141e-02 1 1  ON 42
eH2_3                -3.836796e-02 1 1  ON 43
eH2_4                 1.030664e-02 1 1  ON 44
eH2_5                 4.517020e-02 1 1  ON 45
eH2_6                 1.022544e-01 1 1  ON 46
eH2_7                 1.551640e-01 1 1  ON 47
eH2_8                 1.755653e-01 1 1  ON 48
eH2_9                 4.230122e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8467e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8458
    reference variance = 0.242126
====================================================
  Execution time = 2.0872e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3617e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4887e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336165301685
                                         uncertainty =       0.003570808411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336165301685
                                         uncertainty =       0.003570808411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409984681
  error estimate for blocks of size 2^( 2) =       0.000423136753
  error estimate for blocks of size 2^( 3) =       0.000436407635
  error estimate for blocks of size 2^( 4) =       0.000449393105
  error estimate for blocks of size 2^( 5) =       0.000461584281
  error estimate for blocks of size 2^( 6) =       0.000471449116
  error estimate for blocks of size 2^( 7) =       0.000477267395

      target function =                  N/A
              le_mean =     -16.905470540833
             les_mean =     286.131108915948
             stat err =       0.000464923474
             autocorr =       1.285960681114
              std dev =       0.579805896022
             le_variance =       0.336174877061


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690547054083e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905470540833       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905470557327       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905470579026       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905470590638       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905470594314       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905470592421       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905470581715       residual = 9.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 9.747861e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905470540833       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905470544989       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905470550468       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905470553384       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905470554313       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905470553877       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905470551204       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.442758e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905470540833       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905470541874       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905470543247       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905470543977       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905470544210       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905470544103       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905470543435       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 6.110539e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141151 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6371e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.106439e-01 1 1  ON 0
 uu_1                 1.435972e-01 1 1  ON 1
 uu_2                 4.212659e-02 1 1  ON 2
 uu_3                -2.019627e-02 1 1  ON 3
 uu_4                -6.551317e-02 1 1  ON 4
 uu_5                -1.000031e-01 1 1  ON 5
 uu_6                -1.270448e-01 1 1  ON 6
 uu_7                -1.403668e-01 1 1  ON 7
 uu_8                -1.325594e-01 1 1  ON 8
 uu_9                -1.013048e-01 1 1  ON 9
 ud_0                 4.478442e-01 1 1  ON 10
 ud_1                 1.819987e-01 1 1  ON 11
 ud_2                 6.128573e-02 1 1  ON 12
 ud_3                -9.869711e-03 1 1  ON 13
 ud_4                -6.668713e-02 1 1  ON 14
 ud_5                -1.077804e-01 1 1  ON 15
 ud_6                -1.348558e-01 1 1  ON 16
 ud_7                -1.505155e-01 1 1  ON 17
 ud_8                -1.510840e-01 1 1  ON 18
 ud_9                -1.390909e-01 1 1  ON 19
 eO_0                -7.568650e-01 1 1  ON 20
 eO_1                -4.359687e-01 1 1  ON 21
 eO_2                -1.918363e-02 1 1  ON 22
 eO_3                 2.975715e-01 1 1  ON 23
 eO_4                 5.214172e-01 1 1  ON 24
 eO_5                 4.813325e-01 1 1  ON 25
 eO_6                 2.506982e-01 1 1  ON 26
 eO_7                -4.786094e-02 1 1  ON 27
 eO_8                -2.154278e-01 1 1  ON 28
 eO_9                -7.586322e-02 1 1  ON 29
eH1_0                -2.453651e-01 1 1  ON 30
eH1_1                -1.425281e-01 1 1  ON 31
eH1_2                -9.509533e-02 1 1  ON 32
eH1_3                -4.052156e-02 1 1  ON 33
eH1_4                 7.830463e-03 1 1  ON 34
eH1_5                 4.192378e-02 1 1  ON 35
eH1_6                 9.952739e-02 1 1  ON 36
eH1_7                 1.520053e-01 1 1  ON 37
eH1_8                 1.700410e-01 1 1  ON 38
eH1_9                 5.622052e-02 1 1  ON 39
eH2_0                -2.436623e-01 1 1  ON 40
eH2_1                -1.401597e-01 1 1  ON 41
eH2_2                -9.247236e-02 1 1  ON 42
eH2_3                -3.836745e-02 1 1  ON 43
eH2_4                 1.030685e-02 1 1  ON 44
eH2_5                 4.516953e-02 1 1  ON 45
eH2_6                 1.022536e-01 1 1  ON 46
eH2_7                 1.551639e-01 1 1  ON 47
eH2_8                 1.755669e-01 1 1  ON 48
eH2_9                 4.230352e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.958
    reference variance = 0.371328
====================================================
  Execution time = 2.0280e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3921e-01
  Total weights = 2.0000e+06
  Execution time = 1.8772e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339252345045
                                         uncertainty =       0.003867221609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339252345045
                                         uncertainty =       0.003867221609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411829339
  error estimate for blocks of size 2^( 2) =       0.000424502991
  error estimate for blocks of size 2^( 3) =       0.000437130680
  error estimate for blocks of size 2^( 4) =       0.000448970998
  error estimate for blocks of size 2^( 5) =       0.000460709545
  error estimate for blocks of size 2^( 6) =       0.000469691128
  error estimate for blocks of size 2^( 7) =       0.000474541025

      target function =                  N/A
              le_mean =     -16.905979176434
             les_mean =     286.151338553736
             stat err =       0.000463478174
             autocorr =       1.266554867631
              std dev =       0.582414636941
             le_variance =       0.339206809323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339254671469
                                         uncertainty =       0.003867255213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339254671469
                                         uncertainty =       0.003867255213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411830750
  error estimate for blocks of size 2^( 2) =       0.000424504341
  error estimate for blocks of size 2^( 3) =       0.000437131949
  error estimate for blocks of size 2^( 4) =       0.000448972210
  error estimate for blocks of size 2^( 5) =       0.000460710771
  error estimate for blocks of size 2^( 6) =       0.000469692228
  error estimate for blocks of size 2^( 7) =       0.000474541904

      target function =                  N/A
              le_mean =     -16.905979178247
             les_mean =     286.151340939679
             stat err =       0.000463479278
             autocorr =       1.266552223191
              std dev =       0.582416632634
             le_variance =       0.339209133969

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339253507414
                                         uncertainty =       0.003867238536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339253507414
                                         uncertainty =       0.003867238536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411830044
  error estimate for blocks of size 2^( 2) =       0.000424503666
  error estimate for blocks of size 2^( 3) =       0.000437131314
  error estimate for blocks of size 2^( 4) =       0.000448971603
  error estimate for blocks of size 2^( 5) =       0.000460710157
  error estimate for blocks of size 2^( 6) =       0.000469691677
  error estimate for blocks of size 2^( 7) =       0.000474541462

      target function =                  N/A
              le_mean =     -16.905979177348
             les_mean =     286.151339746109
             stat err =       0.000463478725
             autocorr =       1.266553541079
              std dev =       0.582415634058
             le_variance =       0.339207970795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339252490288
                                         uncertainty =       0.003867223728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339252490288
                                         uncertainty =       0.003867223728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411829427
  error estimate for blocks of size 2^( 2) =       0.000424503076
  error estimate for blocks of size 2^( 3) =       0.000437130759
  error estimate for blocks of size 2^( 4) =       0.000448971074
  error estimate for blocks of size 2^( 5) =       0.000460709622
  error estimate for blocks of size 2^( 6) =       0.000469691196
  error estimate for blocks of size 2^( 7) =       0.000474541079

      target function =                  N/A
              le_mean =     -16.905979176545
             les_mean =     286.151338702621
             stat err =       0.000463478243
             autocorr =       1.266554701671
              std dev =       0.582414761535
             le_variance =       0.339206954454


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905979176434        initial
     2.4414e+01     2.4414e+02             9.7479e-06       -16.905979178247  <--
     9.7656e+01     9.7656e+02             2.4428e-06       -16.905979177348
     3.9062e+02     3.9062e+03             6.1105e-07       -16.905979176545

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 2.9690e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.106473e-01 1 1  ON 0
 uu_1                 1.435975e-01 1 1  ON 1
 uu_2                 4.212369e-02 1 1  ON 2
 uu_3                -2.019816e-02 1 1  ON 3
 uu_4                -6.551223e-02 1 1  ON 4
 uu_5                -1.000043e-01 1 1  ON 5
 uu_6                -1.270481e-01 1 1  ON 6
 uu_7                -1.403671e-01 1 1  ON 7
 uu_8                -1.325589e-01 1 1  ON 8
 uu_9                -1.013070e-01 1 1  ON 9
 ud_0                 4.478460e-01 1 1  ON 10
 ud_1                 1.820015e-01 1 1  ON 11
 ud_2                 6.128734e-02 1 1  ON 12
 ud_3                -9.870969e-03 1 1  ON 13
 ud_4                -6.668627e-02 1 1  ON 14
 ud_5                -1.077829e-01 1 1  ON 15
 ud_6                -1.348534e-01 1 1  ON 16
 ud_7                -1.505169e-01 1 1  ON 17
 ud_8                -1.510856e-01 1 1  ON 18
 ud_9                -1.390921e-01 1 1  ON 19
 eO_0                -7.568675e-01 1 1  ON 20
 eO_1                -4.359686e-01 1 1  ON 21
 eO_2                -1.918152e-02 1 1  ON 22
 eO_3                 2.975740e-01 1 1  ON 23
 eO_4                 5.214183e-01 1 1  ON 24
 eO_5                 4.813332e-01 1 1  ON 25
 eO_6                 2.506999e-01 1 1  ON 26
 eO_7                -4.785914e-02 1 1  ON 27
 eO_8                -2.154308e-01 1 1  ON 28
 eO_9                -7.586717e-02 1 1  ON 29
eH1_0                -2.453688e-01 1 1  ON 30
eH1_1                -1.425354e-01 1 1  ON 31
eH1_2                -9.509653e-02 1 1  ON 32
eH1_3                -4.052342e-02 1 1  ON 33
eH1_4                 7.831232e-03 1 1  ON 34
eH1_5                 4.192245e-02 1 1  ON 35
eH1_6                 9.952791e-02 1 1  ON 36
eH1_7                 1.520073e-01 1 1  ON 37
eH1_8                 1.700464e-01 1 1  ON 38
eH1_9                 5.622659e-02 1 1  ON 39
eH2_0                -2.436639e-01 1 1  ON 40
eH2_1                -1.401649e-01 1 1  ON 41
eH2_2                -9.247520e-02 1 1  ON 42
eH2_3                -3.836598e-02 1 1  ON 43
eH2_4                 1.030752e-02 1 1  ON 44
eH2_5                 4.516752e-02 1 1  ON 45
eH2_6                 1.022509e-01 1 1  ON 46
eH2_7                 1.551634e-01 1 1  ON 47
eH2_8                 1.755716e-01 1 1  ON 48
eH2_9                 4.231042e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6162e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9193
    reference variance = 0.343935
====================================================
  Execution time = 2.0776e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3320e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5461e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333225398775
                                         uncertainty =       0.002322355310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333225398775
                                         uncertainty =       0.002322355310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408165741
  error estimate for blocks of size 2^( 2) =       0.000420888151
  error estimate for blocks of size 2^( 3) =       0.000434333653
  error estimate for blocks of size 2^( 4) =       0.000444984843
  error estimate for blocks of size 2^( 5) =       0.000453783014
  error estimate for blocks of size 2^( 6) =       0.000460983657
  error estimate for blocks of size 2^( 7) =       0.000465454146

      target function =                  N/A
              le_mean =     -16.906025163525
             les_mean =     286.146885207323
             stat err =       0.000456301415
             autocorr =       1.249771255301
              std dev =       0.577233526554
             le_variance =       0.333198544178


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602516353e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906025163525       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906025173026       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906025120893       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906025140229       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906025193707       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906025191328       residual = 6.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906025224843       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906025230547       residual = 5.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.098195e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906025163525       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906025165944       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906025152475       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906025156985       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906025169220       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906025169349       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906025178583       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906025179229       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 7.798965e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906025163525       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906025164133       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906025160737       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906025161843       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906025164825       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906025164902       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906025167268       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906025167381       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 1.953147e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143851 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6332e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.106474e-01 1 1  ON 0
 uu_1                 1.435993e-01 1 1  ON 1
 uu_2                 4.212751e-02 1 1  ON 2
 uu_3                -2.019771e-02 1 1  ON 3
 uu_4                -6.551562e-02 1 1  ON 4
 uu_5                -1.000035e-01 1 1  ON 5
 uu_6                -1.270437e-01 1 1  ON 6
 uu_7                -1.403688e-01 1 1  ON 7
 uu_8                -1.325659e-01 1 1  ON 8
 uu_9                -1.013120e-01 1 1  ON 9
 ud_0                 4.478514e-01 1 1  ON 10
 ud_1                 1.820056e-01 1 1  ON 11
 ud_2                 6.128924e-02 1 1  ON 12
 ud_3                -9.868005e-03 1 1  ON 13
 ud_4                -6.668331e-02 1 1  ON 14
 ud_5                -1.077842e-01 1 1  ON 15
 ud_6                -1.348528e-01 1 1  ON 16
 ud_7                -1.505175e-01 1 1  ON 17
 ud_8                -1.510903e-01 1 1  ON 18
 ud_9                -1.390986e-01 1 1  ON 19
 eO_0                -7.568701e-01 1 1  ON 20
 eO_1                -4.359695e-01 1 1  ON 21
 eO_2                -1.918321e-02 1 1  ON 22
 eO_3                 2.975785e-01 1 1  ON 23
 eO_4                 5.214261e-01 1 1  ON 24
 eO_5                 4.813322e-01 1 1  ON 25
 eO_6                 2.507070e-01 1 1  ON 26
 eO_7                -4.785755e-02 1 1  ON 27
 eO_8                -2.154385e-01 1 1  ON 28
 eO_9                -7.587338e-02 1 1  ON 29
eH1_0                -2.453748e-01 1 1  ON 30
eH1_1                -1.425424e-01 1 1  ON 31
eH1_2                -9.510162e-02 1 1  ON 32
eH1_3                -4.052401e-02 1 1  ON 33
eH1_4                 7.826825e-03 1 1  ON 34
eH1_5                 4.192520e-02 1 1  ON 35
eH1_6                 9.953093e-02 1 1  ON 36
eH1_7                 1.520132e-01 1 1  ON 37
eH1_8                 1.700516e-01 1 1  ON 38
eH1_9                 5.623193e-02 1 1  ON 39
eH2_0                -2.436635e-01 1 1  ON 40
eH2_1                -1.401700e-01 1 1  ON 41
eH2_2                -9.247441e-02 1 1  ON 42
eH2_3                -3.836689e-02 1 1  ON 43
eH2_4                 1.030786e-02 1 1  ON 44
eH2_5                 4.516654e-02 1 1  ON 45
eH2_6                 1.022492e-01 1 1  ON 46
eH2_7                 1.551609e-01 1 1  ON 47
eH2_8                 1.755744e-01 1 1  ON 48
eH2_9                 4.231719e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.0423
    reference variance = 2.35562
====================================================
  Execution time = 2.1306e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3369e-01
  Total weights = 2.0000e+06
  Execution time = 1.8719e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333600087772
                                         uncertainty =       0.002713126030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333600087772
                                         uncertainty =       0.002713126030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408467844
  error estimate for blocks of size 2^( 2) =       0.000421049422
  error estimate for blocks of size 2^( 3) =       0.000434707269
  error estimate for blocks of size 2^( 4) =       0.000446791364
  error estimate for blocks of size 2^( 5) =       0.000456137959
  error estimate for blocks of size 2^( 6) =       0.000462545846
  error estimate for blocks of size 2^( 7) =       0.000469036647

      target function =                  N/A
              le_mean =     -16.906982961214
             les_mean =     286.179764643195
             stat err =       0.000458627954
             autocorr =       1.260681261764
              std dev =       0.577660764870
             le_variance =       0.333691959271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333605869732
                                         uncertainty =       0.002713155680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333605869732
                                         uncertainty =       0.002713155680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408471379
  error estimate for blocks of size 2^( 2) =       0.000421052474
  error estimate for blocks of size 2^( 3) =       0.000434709758
  error estimate for blocks of size 2^( 4) =       0.000446793435
  error estimate for blocks of size 2^( 5) =       0.000456140124
  error estimate for blocks of size 2^( 6) =       0.000462548251
  error estimate for blocks of size 2^( 7) =       0.000469038767

      target function =                  N/A
              le_mean =     -16.906982852656
             les_mean =     286.179766747497
             stat err =       0.000458630144
             autocorr =       1.260671485386
              std dev =       0.577665763522
             le_variance =       0.333697734345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333602997644
                                         uncertainty =       0.002713140957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333602997644
                                         uncertainty =       0.002713140957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408469623
  error estimate for blocks of size 2^( 2) =       0.000421050955
  error estimate for blocks of size 2^( 3) =       0.000434708514
  error estimate for blocks of size 2^( 4) =       0.000446792401
  error estimate for blocks of size 2^( 5) =       0.000456139050
  error estimate for blocks of size 2^( 6) =       0.000462547065
  error estimate for blocks of size 2^( 7) =       0.000469037717

      target function =                  N/A
              le_mean =     -16.906982905242
             les_mean =     286.179765657098
             stat err =       0.000458629058
             autocorr =       1.260676351155
              std dev =       0.577663280639
             le_variance =       0.333694865799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333600451644
                                         uncertainty =       0.002713127897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333600451644
                                         uncertainty =       0.002713127897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408468067
  error estimate for blocks of size 2^( 2) =       0.000421049614
  error estimate for blocks of size 2^( 3) =       0.000434707424
  error estimate for blocks of size 2^( 4) =       0.000446791494
  error estimate for blocks of size 2^( 5) =       0.000456138095
  error estimate for blocks of size 2^( 6) =       0.000462545998
  error estimate for blocks of size 2^( 7) =       0.000469036780

      target function =                  N/A
              le_mean =     -16.906982954115
             les_mean =     286.179764766622
             stat err =       0.000458628092
             autocorr =       1.260680647287
              std dev =       0.577661079465
             le_variance =       0.333692322728


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906982961214        initial  <--
     6.1035e+00     6.1035e+01             3.0982e-05       -16.906982852656
     2.4414e+01     2.4414e+02             7.7990e-06       -16.906982905242
     9.7656e+01     9.7656e+02             1.9531e-06       -16.906982954115

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8094
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.106473e-01 1 1  ON 0
 uu_1                 1.435975e-01 1 1  ON 1
 uu_2                 4.212369e-02 1 1  ON 2
 uu_3                -2.019816e-02 1 1  ON 3
 uu_4                -6.551223e-02 1 1  ON 4
 uu_5                -1.000043e-01 1 1  ON 5
 uu_6                -1.270481e-01 1 1  ON 6
 uu_7                -1.403671e-01 1 1  ON 7
 uu_8                -1.325589e-01 1 1  ON 8
 uu_9                -1.013070e-01 1 1  ON 9
 ud_0                 4.478460e-01 1 1  ON 10
 ud_1                 1.820015e-01 1 1  ON 11
 ud_2                 6.128734e-02 1 1  ON 12
 ud_3                -9.870969e-03 1 1  ON 13
 ud_4                -6.668627e-02 1 1  ON 14
 ud_5                -1.077829e-01 1 1  ON 15
 ud_6                -1.348534e-01 1 1  ON 16
 ud_7                -1.505169e-01 1 1  ON 17
 ud_8                -1.510856e-01 1 1  ON 18
 ud_9                -1.390921e-01 1 1  ON 19
 eO_0                -7.568675e-01 1 1  ON 20
 eO_1                -4.359686e-01 1 1  ON 21
 eO_2                -1.918152e-02 1 1  ON 22
 eO_3                 2.975740e-01 1 1  ON 23
 eO_4                 5.214183e-01 1 1  ON 24
 eO_5                 4.813332e-01 1 1  ON 25
 eO_6                 2.506999e-01 1 1  ON 26
 eO_7                -4.785914e-02 1 1  ON 27
 eO_8                -2.154308e-01 1 1  ON 28
 eO_9                -7.586717e-02 1 1  ON 29
eH1_0                -2.453688e-01 1 1  ON 30
eH1_1                -1.425354e-01 1 1  ON 31
eH1_2                -9.509653e-02 1 1  ON 32
eH1_3                -4.052342e-02 1 1  ON 33
eH1_4                 7.831232e-03 1 1  ON 34
eH1_5                 4.192245e-02 1 1  ON 35
eH1_6                 9.952791e-02 1 1  ON 36
eH1_7                 1.520073e-01 1 1  ON 37
eH1_8                 1.700464e-01 1 1  ON 38
eH1_9                 5.622659e-02 1 1  ON 39
eH2_0                -2.436639e-01 1 1  ON 40
eH2_1                -1.401649e-01 1 1  ON 41
eH2_2                -9.247520e-02 1 1  ON 42
eH2_3                -3.836598e-02 1 1  ON 43
eH2_4                 1.030752e-02 1 1  ON 44
eH2_5                 4.516752e-02 1 1  ON 45
eH2_6                 1.022509e-01 1 1  ON 46
eH2_7                 1.551634e-01 1 1  ON 47
eH2_8                 1.755716e-01 1 1  ON 48
eH2_9                 4.231042e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7565e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9552
    reference variance = 0.341552
====================================================
  Execution time = 2.1008e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4672e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4583e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346704666645
                                         uncertainty =       0.005605756882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346704666645
                                         uncertainty =       0.005605756882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416366639
  error estimate for blocks of size 2^( 2) =       0.000429291323
  error estimate for blocks of size 2^( 3) =       0.000441938200
  error estimate for blocks of size 2^( 4) =       0.000454806609
  error estimate for blocks of size 2^( 5) =       0.000465066854
  error estimate for blocks of size 2^( 6) =       0.000471512425
  error estimate for blocks of size 2^( 7) =       0.000474775748

      target function =                  N/A
              le_mean =     -16.905521946791
             les_mean =     286.143394476459
             stat err =       0.000466540409
             autocorr =       1.255528807087
              std dev =       0.588831347990
             le_variance =       0.346722356375


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690552194679e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905521946791       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905521955755       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905521963270       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905521983332       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905521990189       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905521985031       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905521984381       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905521984311       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 4.074722e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905521946791       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905521949039       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905521950917       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905521955940       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905521957678       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905521956400       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905521956235       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905521956213       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.018867e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905521946791       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905521947354       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905521947823       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905521949079       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905521949515       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905521949196       residual = 9.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905521949155       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905521949149       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.547284e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146506 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6477e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.106471e-01 1 1  ON 0
 uu_1                 1.435982e-01 1 1  ON 1
 uu_2                 4.212374e-02 1 1  ON 2
 uu_3                -2.019840e-02 1 1  ON 3
 uu_4                -6.551222e-02 1 1  ON 4
 uu_5                -1.000049e-01 1 1  ON 5
 uu_6                -1.270489e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325588e-01 1 1  ON 8
 uu_9                -1.013069e-01 1 1  ON 9
 ud_0                 4.478459e-01 1 1  ON 10
 ud_1                 1.820013e-01 1 1  ON 11
 ud_2                 6.128742e-02 1 1  ON 12
 ud_3                -9.871225e-03 1 1  ON 13
 ud_4                -6.668628e-02 1 1  ON 14
 ud_5                -1.077830e-01 1 1  ON 15
 ud_6                -1.348532e-01 1 1  ON 16
 ud_7                -1.505169e-01 1 1  ON 17
 ud_8                -1.510856e-01 1 1  ON 18
 ud_9                -1.390920e-01 1 1  ON 19
 eO_0                -7.568678e-01 1 1  ON 20
 eO_1                -4.359689e-01 1 1  ON 21
 eO_2                -1.918172e-02 1 1  ON 22
 eO_3                 2.975742e-01 1 1  ON 23
 eO_4                 5.214189e-01 1 1  ON 24
 eO_5                 4.813334e-01 1 1  ON 25
 eO_6                 2.507001e-01 1 1  ON 26
 eO_7                -4.785871e-02 1 1  ON 27
 eO_8                -2.154312e-01 1 1  ON 28
 eO_9                -7.586762e-02 1 1  ON 29
eH1_0                -2.453695e-01 1 1  ON 30
eH1_1                -1.425357e-01 1 1  ON 31
eH1_2                -9.509683e-02 1 1  ON 32
eH1_3                -4.052371e-02 1 1  ON 33
eH1_4                 7.831304e-03 1 1  ON 34
eH1_5                 4.192219e-02 1 1  ON 35
eH1_6                 9.952769e-02 1 1  ON 36
eH1_7                 1.520074e-01 1 1  ON 37
eH1_8                 1.700471e-01 1 1  ON 38
eH1_9                 5.622761e-02 1 1  ON 39
eH2_0                -2.436643e-01 1 1  ON 40
eH2_1                -1.401651e-01 1 1  ON 41
eH2_2                -9.247569e-02 1 1  ON 42
eH2_3                -3.836628e-02 1 1  ON 43
eH2_4                 1.030716e-02 1 1  ON 44
eH2_5                 4.516753e-02 1 1  ON 45
eH2_6                 1.022511e-01 1 1  ON 46
eH2_7                 1.551634e-01 1 1  ON 47
eH2_8                 1.755722e-01 1 1  ON 48
eH2_9                 4.231136e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.0341
    reference variance = 0.691775
====================================================
  Execution time = 2.0392e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5006e-01
  Total weights = 2.0000e+06
  Execution time = 1.8724e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350113436847
                                         uncertainty =       0.016256811315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350113436847
                                         uncertainty =       0.016256811315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418366324
  error estimate for blocks of size 2^( 2) =       0.000430844649
  error estimate for blocks of size 2^( 3) =       0.000443984050
  error estimate for blocks of size 2^( 4) =       0.000456013401
  error estimate for blocks of size 2^( 5) =       0.000467311668
  error estimate for blocks of size 2^( 6) =       0.000473453279
  error estimate for blocks of size 2^( 7) =       0.000478484298

      target function =                  N/A
              le_mean =     -16.906267424165
             les_mean =     286.171938803831
             stat err =       0.000468815661
             autocorr =       1.255714141827
              std dev =       0.591659328911
             le_variance =       0.350060761488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350113719046
                                         uncertainty =       0.016256877028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350113719046
                                         uncertainty =       0.016256877028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418366492
  error estimate for blocks of size 2^( 2) =       0.000430844816
  error estimate for blocks of size 2^( 3) =       0.000443984206
  error estimate for blocks of size 2^( 4) =       0.000456013520
  error estimate for blocks of size 2^( 5) =       0.000467311793
  error estimate for blocks of size 2^( 6) =       0.000473453299
  error estimate for blocks of size 2^( 7) =       0.000478484269

      target function =                  N/A
              le_mean =     -16.906267424086
             les_mean =     286.171939083685
             stat err =       0.000468815720
             autocorr =       1.255713442491
              std dev =       0.591659567667
             le_variance =       0.350061044012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350113579034
                                         uncertainty =       0.016256844377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350113579034
                                         uncertainty =       0.016256844377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418366409
  error estimate for blocks of size 2^( 2) =       0.000430844733
  error estimate for blocks of size 2^( 3) =       0.000443984128
  error estimate for blocks of size 2^( 4) =       0.000456013461
  error estimate for blocks of size 2^( 5) =       0.000467311731
  error estimate for blocks of size 2^( 6) =       0.000473453289
  error estimate for blocks of size 2^( 7) =       0.000478484284

      target function =                  N/A
              le_mean =     -16.906267424159
             les_mean =     286.171938945991
             stat err =       0.000468815691
             autocorr =       1.255713790415
              std dev =       0.591659449210
             le_variance =       0.350060903839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350113454650
                                         uncertainty =       0.016256815454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350113454650
                                         uncertainty =       0.016256815454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418366334
  error estimate for blocks of size 2^( 2) =       0.000430844659
  error estimate for blocks of size 2^( 3) =       0.000443984060
  error estimate for blocks of size 2^( 4) =       0.000456013409
  error estimate for blocks of size 2^( 5) =       0.000467311675
  error estimate for blocks of size 2^( 6) =       0.000473453280
  error estimate for blocks of size 2^( 7) =       0.000478484296

      target function =                  N/A
              le_mean =     -16.906267424165
             les_mean =     286.171938821648
             stat err =       0.000468815665
             autocorr =       1.255714097854
              std dev =       0.591659343974
             le_variance =       0.350060779311


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906267424165        initial  <--
     6.1035e+01     6.1035e+02             4.0747e-06       -16.906267424086
     2.4414e+02     2.4414e+03             1.0189e-06       -16.906267424159
     9.7656e+02     9.7656e+03             2.5473e-07       -16.906267424165

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8972
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.106473e-01 1 1  ON 0
 uu_1                 1.435975e-01 1 1  ON 1
 uu_2                 4.212369e-02 1 1  ON 2
 uu_3                -2.019816e-02 1 1  ON 3
 uu_4                -6.551223e-02 1 1  ON 4
 uu_5                -1.000043e-01 1 1  ON 5
 uu_6                -1.270481e-01 1 1  ON 6
 uu_7                -1.403671e-01 1 1  ON 7
 uu_8                -1.325589e-01 1 1  ON 8
 uu_9                -1.013070e-01 1 1  ON 9
 ud_0                 4.478460e-01 1 1  ON 10
 ud_1                 1.820015e-01 1 1  ON 11
 ud_2                 6.128734e-02 1 1  ON 12
 ud_3                -9.870969e-03 1 1  ON 13
 ud_4                -6.668627e-02 1 1  ON 14
 ud_5                -1.077829e-01 1 1  ON 15
 ud_6                -1.348534e-01 1 1  ON 16
 ud_7                -1.505169e-01 1 1  ON 17
 ud_8                -1.510856e-01 1 1  ON 18
 ud_9                -1.390921e-01 1 1  ON 19
 eO_0                -7.568675e-01 1 1  ON 20
 eO_1                -4.359686e-01 1 1  ON 21
 eO_2                -1.918152e-02 1 1  ON 22
 eO_3                 2.975740e-01 1 1  ON 23
 eO_4                 5.214183e-01 1 1  ON 24
 eO_5                 4.813332e-01 1 1  ON 25
 eO_6                 2.506999e-01 1 1  ON 26
 eO_7                -4.785914e-02 1 1  ON 27
 eO_8                -2.154308e-01 1 1  ON 28
 eO_9                -7.586717e-02 1 1  ON 29
eH1_0                -2.453688e-01 1 1  ON 30
eH1_1                -1.425354e-01 1 1  ON 31
eH1_2                -9.509653e-02 1 1  ON 32
eH1_3                -4.052342e-02 1 1  ON 33
eH1_4                 7.831232e-03 1 1  ON 34
eH1_5                 4.192245e-02 1 1  ON 35
eH1_6                 9.952791e-02 1 1  ON 36
eH1_7                 1.520073e-01 1 1  ON 37
eH1_8                 1.700464e-01 1 1  ON 38
eH1_9                 5.622659e-02 1 1  ON 39
eH2_0                -2.436639e-01 1 1  ON 40
eH2_1                -1.401649e-01 1 1  ON 41
eH2_2                -9.247520e-02 1 1  ON 42
eH2_3                -3.836598e-02 1 1  ON 43
eH2_4                 1.030752e-02 1 1  ON 44
eH2_5                 4.516752e-02 1 1  ON 45
eH2_6                 1.022509e-01 1 1  ON 46
eH2_7                 1.551634e-01 1 1  ON 47
eH2_8                 1.755716e-01 1 1  ON 48
eH2_9                 4.231042e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6450e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.0209
    reference variance = 0.415694
====================================================
  Execution time = 2.0539e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4120e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4965e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341239092984
                                         uncertainty =       0.004279523481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341239092984
                                         uncertainty =       0.004279523481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413038444
  error estimate for blocks of size 2^( 2) =       0.000425323372
  error estimate for blocks of size 2^( 3) =       0.000438359155
  error estimate for blocks of size 2^( 4) =       0.000449811369
  error estimate for blocks of size 2^( 5) =       0.000460643893
  error estimate for blocks of size 2^( 6) =       0.000467693794
  error estimate for blocks of size 2^( 7) =       0.000473213661

      target function =                  N/A
              le_mean =     -16.905903125446
             les_mean =     286.150761828249
             stat err =       0.000462840679
             autocorr =       1.255689010566
              std dev =       0.584124568807
             le_variance =       0.341201511884


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690590312545e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905903125446       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905903126308       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905903127516       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905903128079       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905903127912       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905903127666       residual = 9.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905903127928       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905903127835       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 4.638531e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905903125446       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905903125661       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905903125964       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905903126104       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905903126063       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905903126001       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905903126067       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905903126041       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 1.159664e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905903125446       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905903125500       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905903125575       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905903125611       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905903125602       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905903125581       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905903125596       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905903125595       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.899179e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149079 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6046e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.106473e-01 1 1  ON 0
 uu_1                 1.435975e-01 1 1  ON 1
 uu_2                 4.212374e-02 1 1  ON 2
 uu_3                -2.019818e-02 1 1  ON 3
 uu_4                -6.551221e-02 1 1  ON 4
 uu_5                -1.000043e-01 1 1  ON 5
 uu_6                -1.270481e-01 1 1  ON 6
 uu_7                -1.403671e-01 1 1  ON 7
 uu_8                -1.325590e-01 1 1  ON 8
 uu_9                -1.013071e-01 1 1  ON 9
 ud_0                 4.478461e-01 1 1  ON 10
 ud_1                 1.820015e-01 1 1  ON 11
 ud_2                 6.128737e-02 1 1  ON 12
 ud_3                -9.870931e-03 1 1  ON 13
 ud_4                -6.668624e-02 1 1  ON 14
 ud_5                -1.077829e-01 1 1  ON 15
 ud_6                -1.348534e-01 1 1  ON 16
 ud_7                -1.505168e-01 1 1  ON 17
 ud_8                -1.510856e-01 1 1  ON 18
 ud_9                -1.390923e-01 1 1  ON 19
 eO_0                -7.568675e-01 1 1  ON 20
 eO_1                -4.359686e-01 1 1  ON 21
 eO_2                -1.918152e-02 1 1  ON 22
 eO_3                 2.975740e-01 1 1  ON 23
 eO_4                 5.214183e-01 1 1  ON 24
 eO_5                 4.813332e-01 1 1  ON 25
 eO_6                 2.506999e-01 1 1  ON 26
 eO_7                -4.785911e-02 1 1  ON 27
 eO_8                -2.154309e-01 1 1  ON 28
 eO_9                -7.586724e-02 1 1  ON 29
eH1_0                -2.453688e-01 1 1  ON 30
eH1_1                -1.425354e-01 1 1  ON 31
eH1_2                -9.509652e-02 1 1  ON 32
eH1_3                -4.052343e-02 1 1  ON 33
eH1_4                 7.831247e-03 1 1  ON 34
eH1_5                 4.192247e-02 1 1  ON 35
eH1_6                 9.952786e-02 1 1  ON 36
eH1_7                 1.520073e-01 1 1  ON 37
eH1_8                 1.700465e-01 1 1  ON 38
eH1_9                 5.622663e-02 1 1  ON 39
eH2_0                -2.436640e-01 1 1  ON 40
eH2_1                -1.401649e-01 1 1  ON 41
eH2_2                -9.247526e-02 1 1  ON 42
eH2_3                -3.836601e-02 1 1  ON 43
eH2_4                 1.030753e-02 1 1  ON 44
eH2_5                 4.516750e-02 1 1  ON 45
eH2_6                 1.022509e-01 1 1  ON 46
eH2_7                 1.551634e-01 1 1  ON 47
eH2_8                 1.755716e-01 1 1  ON 48
eH2_9                 4.231052e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8869
    reference variance = 0.296229
====================================================
  Execution time = 2.0904e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5573e-01
  Total weights = 2.0000e+06
  Execution time = 1.8685e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355798145488
                                         uncertainty =       0.018205463194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355798145488
                                         uncertainty =       0.018205463194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421740763
  error estimate for blocks of size 2^( 2) =       0.000434204850
  error estimate for blocks of size 2^( 3) =       0.000447058321
  error estimate for blocks of size 2^( 4) =       0.000458519160
  error estimate for blocks of size 2^( 5) =       0.000468321485
  error estimate for blocks of size 2^( 6) =       0.000476391963
  error estimate for blocks of size 2^( 7) =       0.000482225599

      target function =                  N/A
              le_mean =     -16.906645038716
             les_mean =     286.190376829837
             stat err =       0.000471364552
             autocorr =       1.249173259356
              std dev =       0.596431507028
             le_variance =       0.355730542576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355798127598
                                         uncertainty =       0.018205458132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355798127598
                                         uncertainty =       0.018205458132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421740753
  error estimate for blocks of size 2^( 2) =       0.000434204839
  error estimate for blocks of size 2^( 3) =       0.000447058310
  error estimate for blocks of size 2^( 4) =       0.000458519148
  error estimate for blocks of size 2^( 5) =       0.000468321474
  error estimate for blocks of size 2^( 6) =       0.000476391950
  error estimate for blocks of size 2^( 7) =       0.000482225581

      target function =                  N/A
              le_mean =     -16.906645038938
             les_mean =     286.190376819476
             stat err =       0.000471364538
             autocorr =       1.249173250704
              std dev =       0.596431492047
             le_variance =       0.355730524706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355798136527
                                         uncertainty =       0.018205460660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355798136527
                                         uncertainty =       0.018205460660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421740758
  error estimate for blocks of size 2^( 2) =       0.000434204844
  error estimate for blocks of size 2^( 3) =       0.000447058315
  error estimate for blocks of size 2^( 4) =       0.000458519154
  error estimate for blocks of size 2^( 5) =       0.000468321479
  error estimate for blocks of size 2^( 6) =       0.000476391957
  error estimate for blocks of size 2^( 7) =       0.000482225590

      target function =                  N/A
              le_mean =     -16.906645038827
             les_mean =     286.190376824641
             stat err =       0.000471364545
             autocorr =       1.249173255043
              std dev =       0.596431499524
             le_variance =       0.355730533624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355798144367
                                         uncertainty =       0.018205462878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355798144367
                                         uncertainty =       0.018205462878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421740762
  error estimate for blocks of size 2^( 2) =       0.000434204849
  error estimate for blocks of size 2^( 3) =       0.000447058321
  error estimate for blocks of size 2^( 4) =       0.000458519159
  error estimate for blocks of size 2^( 5) =       0.000468321484
  error estimate for blocks of size 2^( 6) =       0.000476391962
  error estimate for blocks of size 2^( 7) =       0.000482225598

      target function =                  N/A
              le_mean =     -16.906645038729
             les_mean =     286.190376829186
             stat err =       0.000471364551
             autocorr =       1.249173258812
              std dev =       0.596431506089
             le_variance =       0.355730541456


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906645038716        initial
     6.1035e+02     6.1035e+03             4.6385e-07       -16.906645038938  <--
     2.4414e+03     2.4414e+04             1.1597e-07       -16.906645038827
     9.7656e+03     9.7656e+04             2.8992e-08       -16.906645038729

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 3.0393e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.106474e-01 1 1  ON 0
 uu_1                 1.435976e-01 1 1  ON 1
 uu_2                 4.212387e-02 1 1  ON 2
 uu_3                -2.019823e-02 1 1  ON 3
 uu_4                -6.551214e-02 1 1  ON 4
 uu_5                -1.000043e-01 1 1  ON 5
 uu_6                -1.270481e-01 1 1  ON 6
 uu_7                -1.403671e-01 1 1  ON 7
 uu_8                -1.325592e-01 1 1  ON 8
 uu_9                -1.013073e-01 1 1  ON 9
 ud_0                 4.478462e-01 1 1  ON 10
 ud_1                 1.820016e-01 1 1  ON 11
 ud_2                 6.128746e-02 1 1  ON 12
 ud_3                -9.870818e-03 1 1  ON 13
 ud_4                -6.668615e-02 1 1  ON 14
 ud_5                -1.077829e-01 1 1  ON 15
 ud_6                -1.348533e-01 1 1  ON 16
 ud_7                -1.505167e-01 1 1  ON 17
 ud_8                -1.510858e-01 1 1  ON 18
 ud_9                -1.390926e-01 1 1  ON 19
 eO_0                -7.568676e-01 1 1  ON 20
 eO_1                -4.359686e-01 1 1  ON 21
 eO_2                -1.918152e-02 1 1  ON 22
 eO_3                 2.975743e-01 1 1  ON 23
 eO_4                 5.214184e-01 1 1  ON 24
 eO_5                 4.813332e-01 1 1  ON 25
 eO_6                 2.507001e-01 1 1  ON 26
 eO_7                -4.785901e-02 1 1  ON 27
 eO_8                -2.154311e-01 1 1  ON 28
 eO_9                -7.586745e-02 1 1  ON 29
eH1_0                -2.453691e-01 1 1  ON 30
eH1_1                -1.425354e-01 1 1  ON 31
eH1_2                -9.509651e-02 1 1  ON 32
eH1_3                -4.052346e-02 1 1  ON 33
eH1_4                 7.831291e-03 1 1  ON 34
eH1_5                 4.192255e-02 1 1  ON 35
eH1_6                 9.952772e-02 1 1  ON 36
eH1_7                 1.520073e-01 1 1  ON 37
eH1_8                 1.700466e-01 1 1  ON 38
eH1_9                 5.622674e-02 1 1  ON 39
eH2_0                -2.436642e-01 1 1  ON 40
eH2_1                -1.401649e-01 1 1  ON 41
eH2_2                -9.247543e-02 1 1  ON 42
eH2_3                -3.836611e-02 1 1  ON 43
eH2_4                 1.030758e-02 1 1  ON 44
eH2_5                 4.516743e-02 1 1  ON 45
eH2_6                 1.022509e-01 1 1  ON 46
eH2_7                 1.551634e-01 1 1  ON 47
eH2_8                 1.755719e-01 1 1  ON 48
eH2_9                 4.231080e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6804e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9892
    reference variance = 0.387415
====================================================
  Execution time = 2.2051e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.7545e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5667e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375608202297
                                         uncertainty =       0.033003614630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375608202297
                                         uncertainty =       0.033003614630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433273735
  error estimate for blocks of size 2^( 2) =       0.000445485248
  error estimate for blocks of size 2^( 3) =       0.000457667739
  error estimate for blocks of size 2^( 4) =       0.000469593825
  error estimate for blocks of size 2^( 5) =       0.000479120469
  error estimate for blocks of size 2^( 6) =       0.000488545774
  error estimate for blocks of size 2^( 7) =       0.000493063058

      target function =                  N/A
              le_mean =     -16.905407931918
             les_mean =     286.168269414870
             stat err =       0.000482580782
             autocorr =       1.240552990698
              std dev =       0.612741591577
             le_variance =       0.375452258048


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690540793192e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905407931918       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905407932208       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905407938388       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905407946166       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905407948462       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905407950311       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905407949297       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905407949188       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 2.118805e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905407931918       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905407931990       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905407933537       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905407935484       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905407936061       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905407936524       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905407936271       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905407936242       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 5.297970e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905407931918       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905407931936       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905407932323       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905407932810       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905407932954       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905407933070       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905407933007       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905407933001       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 1.324553e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151718 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7628e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.106474e-01 1 1  ON 0
 uu_1                 1.435977e-01 1 1  ON 1
 uu_2                 4.212387e-02 1 1  ON 2
 uu_3                -2.019840e-02 1 1  ON 3
 uu_4                -6.551220e-02 1 1  ON 4
 uu_5                -1.000045e-01 1 1  ON 5
 uu_6                -1.270482e-01 1 1  ON 6
 uu_7                -1.403671e-01 1 1  ON 7
 uu_8                -1.325591e-01 1 1  ON 8
 uu_9                -1.013073e-01 1 1  ON 9
 ud_0                 4.478464e-01 1 1  ON 10
 ud_1                 1.820013e-01 1 1  ON 11
 ud_2                 6.128750e-02 1 1  ON 12
 ud_3                -9.870953e-03 1 1  ON 13
 ud_4                -6.668611e-02 1 1  ON 14
 ud_5                -1.077830e-01 1 1  ON 15
 ud_6                -1.348533e-01 1 1  ON 16
 ud_7                -1.505167e-01 1 1  ON 17
 ud_8                -1.510858e-01 1 1  ON 18
 ud_9                -1.390925e-01 1 1  ON 19
 eO_0                -7.568676e-01 1 1  ON 20
 eO_1                -4.359687e-01 1 1  ON 21
 eO_2                -1.918154e-02 1 1  ON 22
 eO_3                 2.975742e-01 1 1  ON 23
 eO_4                 5.214186e-01 1 1  ON 24
 eO_5                 4.813333e-01 1 1  ON 25
 eO_6                 2.507003e-01 1 1  ON 26
 eO_7                -4.785883e-02 1 1  ON 27
 eO_8                -2.154313e-01 1 1  ON 28
 eO_9                -7.586760e-02 1 1  ON 29
eH1_0                -2.453696e-01 1 1  ON 30
eH1_1                -1.425356e-01 1 1  ON 31
eH1_2                -9.509639e-02 1 1  ON 32
eH1_3                -4.052372e-02 1 1  ON 33
eH1_4                 7.831240e-03 1 1  ON 34
eH1_5                 4.192257e-02 1 1  ON 35
eH1_6                 9.952781e-02 1 1  ON 36
eH1_7                 1.520074e-01 1 1  ON 37
eH1_8                 1.700469e-01 1 1  ON 38
eH1_9                 5.622707e-02 1 1  ON 39
eH2_0                -2.436642e-01 1 1  ON 40
eH2_1                -1.401650e-01 1 1  ON 41
eH2_2                -9.247557e-02 1 1  ON 42
eH2_3                -3.836607e-02 1 1  ON 43
eH2_4                 1.030745e-02 1 1  ON 44
eH2_5                 4.516733e-02 1 1  ON 45
eH2_6                 1.022507e-01 1 1  ON 46
eH2_7                 1.551635e-01 1 1  ON 47
eH2_8                 1.755721e-01 1 1  ON 48
eH2_9                 4.231113e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.975
    reference variance = 0.274002
====================================================
  Execution time = 2.2854e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3734e-01
  Total weights = 2.0000e+06
  Execution time = 1.8721e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337387451524
                                         uncertainty =       0.003216770856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337387451524
                                         uncertainty =       0.003216770856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410694305
  error estimate for blocks of size 2^( 2) =       0.000423698213
  error estimate for blocks of size 2^( 3) =       0.000437209288
  error estimate for blocks of size 2^( 4) =       0.000449728152
  error estimate for blocks of size 2^( 5) =       0.000461133215
  error estimate for blocks of size 2^( 6) =       0.000471416629
  error estimate for blocks of size 2^( 7) =       0.000477053422

      target function =                  N/A
              le_mean =     -16.905860364605
             les_mean =     286.145454122347
             stat err =       0.000464832854
             autocorr =       1.281021068552
              std dev =       0.580809455417
             le_variance =       0.337339623502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337388505989
                                         uncertainty =       0.003216789074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337388505989
                                         uncertainty =       0.003216789074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410694946
  error estimate for blocks of size 2^( 2) =       0.000423698830
  error estimate for blocks of size 2^( 3) =       0.000437209891
  error estimate for blocks of size 2^( 4) =       0.000449728733
  error estimate for blocks of size 2^( 5) =       0.000461133802
  error estimate for blocks of size 2^( 6) =       0.000471417205
  error estimate for blocks of size 2^( 7) =       0.000477053974

      target function =                  N/A
              le_mean =     -16.905860364995
             les_mean =     286.145455189966
             stat err =       0.000464833429
             autocorr =       1.281020229858
              std dev =       0.580810363150
             le_variance =       0.337340677942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337387979984
                                         uncertainty =       0.003216779992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337387979984
                                         uncertainty =       0.003216779992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410694626
  error estimate for blocks of size 2^( 2) =       0.000423698522
  error estimate for blocks of size 2^( 3) =       0.000437209590
  error estimate for blocks of size 2^( 4) =       0.000449728443
  error estimate for blocks of size 2^( 5) =       0.000461133509
  error estimate for blocks of size 2^( 6) =       0.000471416918
  error estimate for blocks of size 2^( 7) =       0.000477053699

      target function =                  N/A
              le_mean =     -16.905860364798
             les_mean =     286.145454657326
             stat err =       0.000464833142
             autocorr =       1.281020648381
              std dev =       0.580809910340
             le_variance =       0.337340151949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337387517618
                                         uncertainty =       0.003216771999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337387517618
                                         uncertainty =       0.003216771999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410694345
  error estimate for blocks of size 2^( 2) =       0.000423698252
  error estimate for blocks of size 2^( 3) =       0.000437209326
  error estimate for blocks of size 2^( 4) =       0.000449728189
  error estimate for blocks of size 2^( 5) =       0.000461133252
  error estimate for blocks of size 2^( 6) =       0.000471416665
  error estimate for blocks of size 2^( 7) =       0.000477053456

      target function =                  N/A
              le_mean =     -16.905860364629
             les_mean =     286.145454189250
             stat err =       0.000464832890
             autocorr =       1.281021016010
              std dev =       0.580809512314
             le_variance =       0.337339689594


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905860364605        initial
     1.5259e+02     1.5259e+03             2.1188e-06       -16.905860364995  <--
     6.1035e+02     6.1035e+03             5.2980e-07       -16.905860364798
     2.4414e+03     2.4414e+04             1.3246e-07       -16.905860364629

*****************************************************************************
Applying the update for shift_i =   1.5259e+02     and shift_s =   1.5259e+03
*****************************************************************************

  Execution time = 3.2357e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.106476e-01 1 1  ON 0
 uu_1                 1.435979e-01 1 1  ON 1
 uu_2                 4.212389e-02 1 1  ON 2
 uu_3                -2.019889e-02 1 1  ON 3
 uu_4                -6.551238e-02 1 1  ON 4
 uu_5                -1.000051e-01 1 1  ON 5
 uu_6                -1.270484e-01 1 1  ON 6
 uu_7                -1.403672e-01 1 1  ON 7
 uu_8                -1.325591e-01 1 1  ON 8
 uu_9                -1.013072e-01 1 1  ON 9
 ud_0                 4.478471e-01 1 1  ON 10
 ud_1                 1.820005e-01 1 1  ON 11
 ud_2                 6.128761e-02 1 1  ON 12
 ud_3                -9.871355e-03 1 1  ON 13
 ud_4                -6.668601e-02 1 1  ON 14
 ud_5                -1.077835e-01 1 1  ON 15
 ud_6                -1.348532e-01 1 1  ON 16
 ud_7                -1.505168e-01 1 1  ON 17
 ud_8                -1.510857e-01 1 1  ON 18
 ud_9                -1.390922e-01 1 1  ON 19
 eO_0                -7.568678e-01 1 1  ON 20
 eO_1                -4.359690e-01 1 1  ON 21
 eO_2                -1.918162e-02 1 1  ON 22
 eO_3                 2.975739e-01 1 1  ON 23
 eO_4                 5.214193e-01 1 1  ON 24
 eO_5                 4.813334e-01 1 1  ON 25
 eO_6                 2.507008e-01 1 1  ON 26
 eO_7                -4.785827e-02 1 1  ON 27
 eO_8                -2.154319e-01 1 1  ON 28
 eO_9                -7.586805e-02 1 1  ON 29
eH1_0                -2.453712e-01 1 1  ON 30
eH1_1                -1.425362e-01 1 1  ON 31
eH1_2                -9.509605e-02 1 1  ON 32
eH1_3                -4.052447e-02 1 1  ON 33
eH1_4                 7.831087e-03 1 1  ON 34
eH1_5                 4.192263e-02 1 1  ON 35
eH1_6                 9.952805e-02 1 1  ON 36
eH1_7                 1.520078e-01 1 1  ON 37
eH1_8                 1.700478e-01 1 1  ON 38
eH1_9                 5.622807e-02 1 1  ON 39
eH2_0                -2.436644e-01 1 1  ON 40
eH2_1                -1.401654e-01 1 1  ON 41
eH2_2                -9.247598e-02 1 1  ON 42
eH2_3                -3.836597e-02 1 1  ON 43
eH2_4                 1.030705e-02 1 1  ON 44
eH2_5                 4.516701e-02 1 1  ON 45
eH2_6                 1.022503e-01 1 1  ON 46
eH2_7                 1.551637e-01 1 1  ON 47
eH2_8                 1.755729e-01 1 1  ON 48
eH2_9                 4.231210e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0127e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6931e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.918
    reference variance = 0.228556
====================================================
  Execution time = 2.1432e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3298e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5585e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333041303247
                                         uncertainty =       0.002871713871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333041303247
                                         uncertainty =       0.002871713871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408032774
  error estimate for blocks of size 2^( 2) =       0.000420744749
  error estimate for blocks of size 2^( 3) =       0.000433607366
  error estimate for blocks of size 2^( 4) =       0.000445991379
  error estimate for blocks of size 2^( 5) =       0.000455697708
  error estimate for blocks of size 2^( 6) =       0.000462722811
  error estimate for blocks of size 2^( 7) =       0.000465572604

      target function =                  N/A
              le_mean =     -16.906990921839
             les_mean =     286.179323353767
             stat err =       0.000457496126
             autocorr =       1.257143185198
              std dev =       0.577045482720
             le_variance =       0.332981489128


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690699092184e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906990921839       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906990932753       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906990943147       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906990953914       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906990958623       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906990954609       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906990956780       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906990957554       residual = 8.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 6.529479e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906990921839       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906990924574       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906990927189       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906990929888       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906990931079       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906990930078       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906990930611       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906990930810       residual = 8.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.632831e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906990921839       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906990922523       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906990923178       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906990923853       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906990924151       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906990923901       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906990924033       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906990924083       residual = 8.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 4.082363e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154375 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7002e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.106472e-01 1 1  ON 0
 uu_1                 1.435980e-01 1 1  ON 1
 uu_2                 4.212462e-02 1 1  ON 2
 uu_3                -2.019851e-02 1 1  ON 3
 uu_4                -6.551212e-02 1 1  ON 4
 uu_5                -1.000045e-01 1 1  ON 5
 uu_6                -1.270481e-01 1 1  ON 6
 uu_7                -1.403670e-01 1 1  ON 7
 uu_8                -1.325600e-01 1 1  ON 8
 uu_9                -1.013085e-01 1 1  ON 9
 ud_0                 4.478476e-01 1 1  ON 10
 ud_1                 1.820010e-01 1 1  ON 11
 ud_2                 6.128854e-02 1 1  ON 12
 ud_3                -9.870600e-03 1 1  ON 13
 ud_4                -6.668561e-02 1 1  ON 14
 ud_5                -1.077827e-01 1 1  ON 15
 ud_6                -1.348527e-01 1 1  ON 16
 ud_7                -1.505171e-01 1 1  ON 17
 ud_8                -1.510873e-01 1 1  ON 18
 ud_9                -1.390938e-01 1 1  ON 19
 eO_0                -7.568678e-01 1 1  ON 20
 eO_1                -4.359681e-01 1 1  ON 21
 eO_2                -1.918239e-02 1 1  ON 22
 eO_3                 2.975741e-01 1 1  ON 23
 eO_4                 5.214195e-01 1 1  ON 24
 eO_5                 4.813340e-01 1 1  ON 25
 eO_6                 2.507020e-01 1 1  ON 26
 eO_7                -4.785788e-02 1 1  ON 27
 eO_8                -2.154332e-01 1 1  ON 28
 eO_9                -7.586923e-02 1 1  ON 29
eH1_0                -2.453722e-01 1 1  ON 30
eH1_1                -1.425371e-01 1 1  ON 31
eH1_2                -9.509573e-02 1 1  ON 32
eH1_3                -4.052462e-02 1 1  ON 33
eH1_4                 7.831122e-03 1 1  ON 34
eH1_5                 4.192317e-02 1 1  ON 35
eH1_6                 9.952768e-02 1 1  ON 36
eH1_7                 1.520075e-01 1 1  ON 37
eH1_8                 1.700485e-01 1 1  ON 38
eH1_9                 5.622913e-02 1 1  ON 39
eH2_0                -2.436649e-01 1 1  ON 40
eH2_1                -1.401667e-01 1 1  ON 41
eH2_2                -9.247648e-02 1 1  ON 42
eH2_3                -3.836603e-02 1 1  ON 43
eH2_4                 1.030753e-02 1 1  ON 44
eH2_5                 4.516775e-02 1 1  ON 45
eH2_6                 1.022500e-01 1 1  ON 46
eH2_7                 1.551638e-01 1 1  ON 47
eH2_8                 1.755736e-01 1 1  ON 48
eH2_9                 4.231298e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9125
    reference variance = 0.177647
====================================================
  Execution time = 2.0753e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3774e-01
  Total weights = 2.0000e+06
  Execution time = 1.8807e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337100303490
                                         uncertainty =       0.003882738221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337100303490
                                         uncertainty =       0.003882738221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410940271
  error estimate for blocks of size 2^( 2) =       0.000423367850
  error estimate for blocks of size 2^( 3) =       0.000436840056
  error estimate for blocks of size 2^( 4) =       0.000448905821
  error estimate for blocks of size 2^( 5) =       0.000458970084
  error estimate for blocks of size 2^( 6) =       0.000465915987
  error estimate for blocks of size 2^( 7) =       0.000469298456

      target function =                  N/A
              le_mean =     -16.906356118959
             les_mean =     286.162620864498
             stat err =       0.000460772587
             autocorr =       1.257233259299
              std dev =       0.581157304283
             le_variance =       0.337743812321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337097148355
                                         uncertainty =       0.003882689871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337097148355
                                         uncertainty =       0.003882689871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410938360
  error estimate for blocks of size 2^( 2) =       0.000423366006
  error estimate for blocks of size 2^( 3) =       0.000436838239
  error estimate for blocks of size 2^( 4) =       0.000448904015
  error estimate for blocks of size 2^( 5) =       0.000458968337
  error estimate for blocks of size 2^( 6) =       0.000465914262
  error estimate for blocks of size 2^( 7) =       0.000469296823

      target function =                  N/A
              le_mean =     -16.906356126066
             les_mean =     286.162617964024
             stat err =       0.000460770859
             autocorr =       1.257235521815
              std dev =       0.581154602089
             le_variance =       0.337740671530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337098715620
                                         uncertainty =       0.003882713897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337098715620
                                         uncertainty =       0.003882713897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410939309
  error estimate for blocks of size 2^( 2) =       0.000423366922
  error estimate for blocks of size 2^( 3) =       0.000436839142
  error estimate for blocks of size 2^( 4) =       0.000448904913
  error estimate for blocks of size 2^( 5) =       0.000458969205
  error estimate for blocks of size 2^( 6) =       0.000465915119
  error estimate for blocks of size 2^( 7) =       0.000469297634

      target function =                  N/A
              le_mean =     -16.906356122530
             les_mean =     286.162619404589
             stat err =       0.000460771718
             autocorr =       1.257234399683
              std dev =       0.581155944339
             le_variance =       0.337742231640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337100104671
                                         uncertainty =       0.003882735176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337100104671
                                         uncertainty =       0.003882735176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410940150
  error estimate for blocks of size 2^( 2) =       0.000423367734
  error estimate for blocks of size 2^( 3) =       0.000436839942
  error estimate for blocks of size 2^( 4) =       0.000448905707
  error estimate for blocks of size 2^( 5) =       0.000458969974
  error estimate for blocks of size 2^( 6) =       0.000465915878
  error estimate for blocks of size 2^( 7) =       0.000469298353

      target function =                  N/A
              le_mean =     -16.906356119404
             les_mean =     286.162620681634
             stat err =       0.000460772478
             autocorr =       1.257233402140
              std dev =       0.581157134002
             le_variance =       0.337743614401


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906356118959        initial
     3.8147e+01     3.8147e+02             6.5295e-06       -16.906356126066  <--
     1.5259e+02     1.5259e+03             1.6328e-06       -16.906356122530
     6.1035e+02     6.1035e+03             4.0824e-07       -16.906356119404

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 3.0296e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.106458e-01 1 1  ON 0
 uu_1                 1.435983e-01 1 1  ON 1
 uu_2                 4.212676e-02 1 1  ON 2
 uu_3                -2.019735e-02 1 1  ON 3
 uu_4                -6.551135e-02 1 1  ON 4
 uu_5                -1.000026e-01 1 1  ON 5
 uu_6                -1.270472e-01 1 1  ON 6
 uu_7                -1.403665e-01 1 1  ON 7
 uu_8                -1.325627e-01 1 1  ON 8
 uu_9                -1.013122e-01 1 1  ON 9
 ud_0                 4.478489e-01 1 1  ON 10
 ud_1                 1.820025e-01 1 1  ON 11
 ud_2                 6.129133e-02 1 1  ON 12
 ud_3                -9.868336e-03 1 1  ON 13
 ud_4                -6.668441e-02 1 1  ON 14
 ud_5                -1.077801e-01 1 1  ON 15
 ud_6                -1.348512e-01 1 1  ON 16
 ud_7                -1.505179e-01 1 1  ON 17
 ud_8                -1.510922e-01 1 1  ON 18
 ud_9                -1.390987e-01 1 1  ON 19
 eO_0                -7.568680e-01 1 1  ON 20
 eO_1                -4.359654e-01 1 1  ON 21
 eO_2                -1.918467e-02 1 1  ON 22
 eO_3                 2.975745e-01 1 1  ON 23
 eO_4                 5.214204e-01 1 1  ON 24
 eO_5                 4.813358e-01 1 1  ON 25
 eO_6                 2.507058e-01 1 1  ON 26
 eO_7                -4.785670e-02 1 1  ON 27
 eO_8                -2.154372e-01 1 1  ON 28
 eO_9                -7.587278e-02 1 1  ON 29
eH1_0                -2.453752e-01 1 1  ON 30
eH1_1                -1.425397e-01 1 1  ON 31
eH1_2                -9.509479e-02 1 1  ON 32
eH1_3                -4.052506e-02 1 1  ON 33
eH1_4                 7.831232e-03 1 1  ON 34
eH1_5                 4.192479e-02 1 1  ON 35
eH1_6                 9.952656e-02 1 1  ON 36
eH1_7                 1.520069e-01 1 1  ON 37
eH1_8                 1.700507e-01 1 1  ON 38
eH1_9                 5.623231e-02 1 1  ON 39
eH2_0                -2.436664e-01 1 1  ON 40
eH2_1                -1.401703e-01 1 1  ON 41
eH2_2                -9.247796e-02 1 1  ON 42
eH2_3                -3.836621e-02 1 1  ON 43
eH2_4                 1.030894e-02 1 1  ON 44
eH2_5                 4.516999e-02 1 1  ON 45
eH2_6                 1.022488e-01 1 1  ON 46
eH2_7                 1.551641e-01 1 1  ON 47
eH2_8                 1.755759e-01 1 1  ON 48
eH2_9                 4.231561e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7603e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6930e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9589
    reference variance = 0.198905
====================================================
  Execution time = 2.1059e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4106e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6679e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341055555923
                                         uncertainty =       0.004447815336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341055555923
                                         uncertainty =       0.004447815336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412950081
  error estimate for blocks of size 2^( 2) =       0.000425404541
  error estimate for blocks of size 2^( 3) =       0.000438645722
  error estimate for blocks of size 2^( 4) =       0.000450649199
  error estimate for blocks of size 2^( 5) =       0.000460342709
  error estimate for blocks of size 2^( 6) =       0.000469068642
  error estimate for blocks of size 2^( 7) =       0.000472849784

      target function =                  N/A
              le_mean =     -16.906187625705
             les_mean =     286.160235403218
             stat err =       0.000463227584
             autocorr =       1.258327575996
              std dev =       0.583999604632
             le_variance =       0.341055538210


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690618762570e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906187625705       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906187649355       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906187596198       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906187637980       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906187643473       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906187645743       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906187634675       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906187636750       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.566647e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906187625705       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906187631697       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906187618124       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906187628878       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906187629956       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906187630399       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906187627585       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906187628226       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 6.417116e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906187625705       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906187627208       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906187623796       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906187626505       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906187626755       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906187626858       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906187626151       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906187626319       residual = 4.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.604290e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157013 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6738e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.106432e-01 1 1  ON 0
 uu_1                 1.436000e-01 1 1  ON 1
 uu_2                 4.212933e-02 1 1  ON 2
 uu_3                -2.019947e-02 1 1  ON 3
 uu_4                -6.550829e-02 1 1  ON 4
 uu_5                -1.000045e-01 1 1  ON 5
 uu_6                -1.270454e-01 1 1  ON 6
 uu_7                -1.403699e-01 1 1  ON 7
 uu_8                -1.325644e-01 1 1  ON 8
 uu_9                -1.013149e-01 1 1  ON 9
 ud_0                 4.478518e-01 1 1  ON 10
 ud_1                 1.820026e-01 1 1  ON 11
 ud_2                 6.129117e-02 1 1  ON 12
 ud_3                -9.866552e-03 1 1  ON 13
 ud_4                -6.668170e-02 1 1  ON 14
 ud_5                -1.077793e-01 1 1  ON 15
 ud_6                -1.348505e-01 1 1  ON 16
 ud_7                -1.505186e-01 1 1  ON 17
 ud_8                -1.510965e-01 1 1  ON 18
 ud_9                -1.391013e-01 1 1  ON 19
 eO_0                -7.568685e-01 1 1  ON 20
 eO_1                -4.359644e-01 1 1  ON 21
 eO_2                -1.918495e-02 1 1  ON 22
 eO_3                 2.975763e-01 1 1  ON 23
 eO_4                 5.214196e-01 1 1  ON 24
 eO_5                 4.813384e-01 1 1  ON 25
 eO_6                 2.507089e-01 1 1  ON 26
 eO_7                -4.785667e-02 1 1  ON 27
 eO_8                -2.154406e-01 1 1  ON 28
 eO_9                -7.587615e-02 1 1  ON 29
eH1_0                -2.453797e-01 1 1  ON 30
eH1_1                -1.425416e-01 1 1  ON 31
eH1_2                -9.509595e-02 1 1  ON 32
eH1_3                -4.052724e-02 1 1  ON 33
eH1_4                 7.831641e-03 1 1  ON 34
eH1_5                 4.192175e-02 1 1  ON 35
eH1_6                 9.952714e-02 1 1  ON 36
eH1_7                 1.520103e-01 1 1  ON 37
eH1_8                 1.700548e-01 1 1  ON 38
eH1_9                 5.623651e-02 1 1  ON 39
eH2_0                -2.436685e-01 1 1  ON 40
eH2_1                -1.401727e-01 1 1  ON 41
eH2_2                -9.248130e-02 1 1  ON 42
eH2_3                -3.836626e-02 1 1  ON 43
eH2_4                 1.030803e-02 1 1  ON 44
eH2_5                 4.516973e-02 1 1  ON 45
eH2_6                 1.022476e-01 1 1  ON 46
eH2_7                 1.551637e-01 1 1  ON 47
eH2_8                 1.755789e-01 1 1  ON 48
eH2_9                 4.232202e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9768
    reference variance = 0.720535
====================================================
  Execution time = 2.0223e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4571e-01
  Total weights = 2.0000e+06
  Execution time = 1.8699e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345746115219
                                         uncertainty =       0.009181030591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345746115219
                                         uncertainty =       0.009181030591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415760186
  error estimate for blocks of size 2^( 2) =       0.000428718879
  error estimate for blocks of size 2^( 3) =       0.000442085168
  error estimate for blocks of size 2^( 4) =       0.000454581989
  error estimate for blocks of size 2^( 5) =       0.000465957661
  error estimate for blocks of size 2^( 6) =       0.000474536718
  error estimate for blocks of size 2^( 7) =       0.000480927971

      target function =                  N/A
              le_mean =     -16.905831342823
             les_mean =     286.152846284272
             stat err =       0.000469001085
             autocorr =       1.272512031785
              std dev =       0.587973694263
             le_variance =       0.345713065146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345750186160
                                         uncertainty =       0.009179347790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345750186160
                                         uncertainty =       0.009179347790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415762637
  error estimate for blocks of size 2^( 2) =       0.000428720928
  error estimate for blocks of size 2^( 3) =       0.000442086928
  error estimate for blocks of size 2^( 4) =       0.000454583488
  error estimate for blocks of size 2^( 5) =       0.000465958948
  error estimate for blocks of size 2^( 6) =       0.000474537907
  error estimate for blocks of size 2^( 7) =       0.000480928883

      target function =                  N/A
              le_mean =     -16.905831287033
             les_mean =     286.152848473178
             stat err =       0.000469002306
             autocorr =       1.272503659895
              std dev =       0.587977159784
             le_variance =       0.345717140428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345748246850
                                         uncertainty =       0.009180150784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345748246850
                                         uncertainty =       0.009180150784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415761469
  error estimate for blocks of size 2^( 2) =       0.000428719953
  error estimate for blocks of size 2^( 3) =       0.000442086093
  error estimate for blocks of size 2^( 4) =       0.000454582780
  error estimate for blocks of size 2^( 5) =       0.000465958342
  error estimate for blocks of size 2^( 6) =       0.000474537350
  error estimate for blocks of size 2^( 7) =       0.000480928458

      target function =                  N/A
              le_mean =     -16.905831313128
             les_mean =     286.152847414041
             stat err =       0.000469001732
             autocorr =       1.272507692446
              std dev =       0.587975508812
             le_variance =       0.345715198963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345746384408
                                         uncertainty =       0.009180919337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345746384408
                                         uncertainty =       0.009180919337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415760348
  error estimate for blocks of size 2^( 2) =       0.000428719015
  error estimate for blocks of size 2^( 3) =       0.000442085285
  error estimate for blocks of size 2^( 4) =       0.000454582089
  error estimate for blocks of size 2^( 5) =       0.000465957748
  error estimate for blocks of size 2^( 6) =       0.000474536798
  error estimate for blocks of size 2^( 7) =       0.000480928032

      target function =                  N/A
              le_mean =     -16.905831339022
             les_mean =     286.152846425222
             stat err =       0.000469001167
             autocorr =       1.272511484583
              std dev =       0.587973923408
             le_variance =       0.345713334608


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905831342823        initial  <--
     9.5367e+00     9.5367e+01             2.5666e-05       -16.905831287033
     3.8147e+01     3.8147e+02             6.4171e-06       -16.905831313128
     1.5259e+02     1.5259e+03             1.6043e-06       -16.905831339022

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7131
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.106458e-01 1 1  ON 0
 uu_1                 1.435983e-01 1 1  ON 1
 uu_2                 4.212676e-02 1 1  ON 2
 uu_3                -2.019735e-02 1 1  ON 3
 uu_4                -6.551135e-02 1 1  ON 4
 uu_5                -1.000026e-01 1 1  ON 5
 uu_6                -1.270472e-01 1 1  ON 6
 uu_7                -1.403665e-01 1 1  ON 7
 uu_8                -1.325627e-01 1 1  ON 8
 uu_9                -1.013122e-01 1 1  ON 9
 ud_0                 4.478489e-01 1 1  ON 10
 ud_1                 1.820025e-01 1 1  ON 11
 ud_2                 6.129133e-02 1 1  ON 12
 ud_3                -9.868336e-03 1 1  ON 13
 ud_4                -6.668441e-02 1 1  ON 14
 ud_5                -1.077801e-01 1 1  ON 15
 ud_6                -1.348512e-01 1 1  ON 16
 ud_7                -1.505179e-01 1 1  ON 17
 ud_8                -1.510922e-01 1 1  ON 18
 ud_9                -1.390987e-01 1 1  ON 19
 eO_0                -7.568680e-01 1 1  ON 20
 eO_1                -4.359654e-01 1 1  ON 21
 eO_2                -1.918467e-02 1 1  ON 22
 eO_3                 2.975745e-01 1 1  ON 23
 eO_4                 5.214204e-01 1 1  ON 24
 eO_5                 4.813358e-01 1 1  ON 25
 eO_6                 2.507058e-01 1 1  ON 26
 eO_7                -4.785670e-02 1 1  ON 27
 eO_8                -2.154372e-01 1 1  ON 28
 eO_9                -7.587278e-02 1 1  ON 29
eH1_0                -2.453752e-01 1 1  ON 30
eH1_1                -1.425397e-01 1 1  ON 31
eH1_2                -9.509479e-02 1 1  ON 32
eH1_3                -4.052506e-02 1 1  ON 33
eH1_4                 7.831232e-03 1 1  ON 34
eH1_5                 4.192479e-02 1 1  ON 35
eH1_6                 9.952656e-02 1 1  ON 36
eH1_7                 1.520069e-01 1 1  ON 37
eH1_8                 1.700507e-01 1 1  ON 38
eH1_9                 5.623231e-02 1 1  ON 39
eH2_0                -2.436664e-01 1 1  ON 40
eH2_1                -1.401703e-01 1 1  ON 41
eH2_2                -9.247796e-02 1 1  ON 42
eH2_3                -3.836621e-02 1 1  ON 43
eH2_4                 1.030894e-02 1 1  ON 44
eH2_5                 4.516999e-02 1 1  ON 45
eH2_6                 1.022488e-01 1 1  ON 46
eH2_7                 1.551641e-01 1 1  ON 47
eH2_8                 1.755759e-01 1 1  ON 48
eH2_9                 4.231561e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6731e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6932e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8158
    reference variance = 0.332286
====================================================
  Execution time = 2.1375e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3377e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4847e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333828845954
                                         uncertainty =       0.003517287553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333828845954
                                         uncertainty =       0.003517287553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408517715
  error estimate for blocks of size 2^( 2) =       0.000421345428
  error estimate for blocks of size 2^( 3) =       0.000434491525
  error estimate for blocks of size 2^( 4) =       0.000446129593
  error estimate for blocks of size 2^( 5) =       0.000456239698
  error estimate for blocks of size 2^( 6) =       0.000464851632
  error estimate for blocks of size 2^( 7) =       0.000471021110

      target function =                  N/A
              le_mean =     -16.905539363520
             les_mean =     286.131034452075
             stat err =       0.000459560508
             autocorr =       1.265504265360
              std dev =       0.577731293443
             le_variance =       0.333773447423


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690553936352e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905539363520       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905539367730       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905539369539       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905539372074       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905539371774       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905539372038       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905539370495       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905539371020       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.282801e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905539363520       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905539364574       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905539365027       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905539365660       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905539365585       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905539365651       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905539365263       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905539365392       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 5.710214e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905539363520       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905539363784       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905539363897       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905539364055       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905539364037       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905539364053       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905539363956       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905539363988       residual = 5.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.427755e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159682 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6871e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.106458e-01 1 1  ON 0
 uu_1                 1.435985e-01 1 1  ON 1
 uu_2                 4.212680e-02 1 1  ON 2
 uu_3                -2.019737e-02 1 1  ON 3
 uu_4                -6.551121e-02 1 1  ON 4
 uu_5                -1.000024e-01 1 1  ON 5
 uu_6                -1.270474e-01 1 1  ON 6
 uu_7                -1.403665e-01 1 1  ON 7
 uu_8                -1.325630e-01 1 1  ON 8
 uu_9                -1.013125e-01 1 1  ON 9
 ud_0                 4.478493e-01 1 1  ON 10
 ud_1                 1.820023e-01 1 1  ON 11
 ud_2                 6.129154e-02 1 1  ON 12
 ud_3                -9.868281e-03 1 1  ON 13
 ud_4                -6.668392e-02 1 1  ON 14
 ud_5                -1.077802e-01 1 1  ON 15
 ud_6                -1.348511e-01 1 1  ON 16
 ud_7                -1.505181e-01 1 1  ON 17
 ud_8                -1.510925e-01 1 1  ON 18
 ud_9                -1.390989e-01 1 1  ON 19
 eO_0                -7.568682e-01 1 1  ON 20
 eO_1                -4.359651e-01 1 1  ON 21
 eO_2                -1.918475e-02 1 1  ON 22
 eO_3                 2.975744e-01 1 1  ON 23
 eO_4                 5.214206e-01 1 1  ON 24
 eO_5                 4.813360e-01 1 1  ON 25
 eO_6                 2.507061e-01 1 1  ON 26
 eO_7                -4.785652e-02 1 1  ON 27
 eO_8                -2.154375e-01 1 1  ON 28
 eO_9                -7.587319e-02 1 1  ON 29
eH1_0                -2.453758e-01 1 1  ON 30
eH1_1                -1.425398e-01 1 1  ON 31
eH1_2                -9.509464e-02 1 1  ON 32
eH1_3                -4.052534e-02 1 1  ON 33
eH1_4                 7.831364e-03 1 1  ON 34
eH1_5                 4.192454e-02 1 1  ON 35
eH1_6                 9.952644e-02 1 1  ON 36
eH1_7                 1.520071e-01 1 1  ON 37
eH1_8                 1.700511e-01 1 1  ON 38
eH1_9                 5.623274e-02 1 1  ON 39
eH2_0                -2.436665e-01 1 1  ON 40
eH2_1                -1.401704e-01 1 1  ON 41
eH2_2                -9.247824e-02 1 1  ON 42
eH2_3                -3.836640e-02 1 1  ON 43
eH2_4                 1.030872e-02 1 1  ON 44
eH2_5                 4.517000e-02 1 1  ON 45
eH2_6                 1.022488e-01 1 1  ON 46
eH2_7                 1.551640e-01 1 1  ON 47
eH2_8                 1.755763e-01 1 1  ON 48
eH2_9                 4.231612e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8725
    reference variance = 0.148577
====================================================
  Execution time = 2.0300e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3427e-01
  Total weights = 2.0000e+06
  Execution time = 1.8719e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334298186152
                                         uncertainty =       0.003478604563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334298186152
                                         uncertainty =       0.003478604563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408820457
  error estimate for blocks of size 2^( 2) =       0.000421981903
  error estimate for blocks of size 2^( 3) =       0.000435470252
  error estimate for blocks of size 2^( 4) =       0.000447833914
  error estimate for blocks of size 2^( 5) =       0.000457973714
  error estimate for blocks of size 2^( 6) =       0.000465200259
  error estimate for blocks of size 2^( 7) =       0.000469470336

      target function =                  N/A
              le_mean =     -16.905685505713
             les_mean =     286.136470582511
             stat err =       0.000460119556
             autocorr =       1.266706927425
              std dev =       0.578159434389
             le_variance =       0.334268331573

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334299500560
                                         uncertainty =       0.003478630024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334299500560
                                         uncertainty =       0.003478630024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408821259
  error estimate for blocks of size 2^( 2) =       0.000421982676
  error estimate for blocks of size 2^( 3) =       0.000435471004
  error estimate for blocks of size 2^( 4) =       0.000447834627
  error estimate for blocks of size 2^( 5) =       0.000457974388
  error estimate for blocks of size 2^( 6) =       0.000465200882
  error estimate for blocks of size 2^( 7) =       0.000469470926

      target function =                  N/A
              le_mean =     -16.905685520996
             les_mean =     286.136472412070
             stat err =       0.000460120206
             autocorr =       1.266705532528
              std dev =       0.578160569726
             le_variance =       0.334269644386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334298846138
                                         uncertainty =       0.003478617343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334298846138
                                         uncertainty =       0.003478617343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408820860
  error estimate for blocks of size 2^( 2) =       0.000421982291
  error estimate for blocks of size 2^( 3) =       0.000435470630
  error estimate for blocks of size 2^( 4) =       0.000447834272
  error estimate for blocks of size 2^( 5) =       0.000457974053
  error estimate for blocks of size 2^( 6) =       0.000465200572
  error estimate for blocks of size 2^( 7) =       0.000469470633

      target function =                  N/A
              le_mean =     -16.905685513386
             les_mean =     286.136471501148
             stat err =       0.000460119882
             autocorr =       1.266706227296
              std dev =       0.578160004461
             le_variance =       0.334268990759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334298268734
                                         uncertainty =       0.003478606162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334298268734
                                         uncertainty =       0.003478606162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408820507
  error estimate for blocks of size 2^( 2) =       0.000421981952
  error estimate for blocks of size 2^( 3) =       0.000435470299
  error estimate for blocks of size 2^( 4) =       0.000447833958
  error estimate for blocks of size 2^( 5) =       0.000457973757
  error estimate for blocks of size 2^( 6) =       0.000465200298
  error estimate for blocks of size 2^( 7) =       0.000469470374

      target function =                  N/A
              le_mean =     -16.905685506673
             les_mean =     286.136470697447
             stat err =       0.000460119597
             autocorr =       1.266706839826
              std dev =       0.578159505721
             le_variance =       0.334268414055


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905685505713        initial
     9.5367e+01     9.5367e+02             2.2828e-06       -16.905685520996  <--
     3.8147e+02     3.8147e+03             5.7102e-07       -16.905685513386
     1.5259e+03     1.5259e+04             1.4278e-07       -16.905685506673

*****************************************************************************
Applying the update for shift_i =   9.5367e+01     and shift_s =   9.5367e+02
*****************************************************************************

  Execution time = 2.9817e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.106457e-01 1 1  ON 0
 uu_1                 1.435991e-01 1 1  ON 1
 uu_2                 4.212690e-02 1 1  ON 2
 uu_3                -2.019742e-02 1 1  ON 3
 uu_4                -6.551082e-02 1 1  ON 4
 uu_5                -1.000019e-01 1 1  ON 5
 uu_6                -1.270479e-01 1 1  ON 6
 uu_7                -1.403665e-01 1 1  ON 7
 uu_8                -1.325640e-01 1 1  ON 8
 uu_9                -1.013136e-01 1 1  ON 9
 ud_0                 4.478507e-01 1 1  ON 10
 ud_1                 1.820016e-01 1 1  ON 11
 ud_2                 6.129217e-02 1 1  ON 12
 ud_3                -9.868113e-03 1 1  ON 13
 ud_4                -6.668246e-02 1 1  ON 14
 ud_5                -1.077808e-01 1 1  ON 15
 ud_6                -1.348509e-01 1 1  ON 16
 ud_7                -1.505188e-01 1 1  ON 17
 ud_8                -1.510934e-01 1 1  ON 18
 ud_9                -1.390996e-01 1 1  ON 19
 eO_0                -7.568688e-01 1 1  ON 20
 eO_1                -4.359642e-01 1 1  ON 21
 eO_2                -1.918500e-02 1 1  ON 22
 eO_3                 2.975742e-01 1 1  ON 23
 eO_4                 5.214213e-01 1 1  ON 24
 eO_5                 4.813366e-01 1 1  ON 25
 eO_6                 2.507071e-01 1 1  ON 26
 eO_7                -4.785598e-02 1 1  ON 27
 eO_8                -2.154386e-01 1 1  ON 28
 eO_9                -7.587440e-02 1 1  ON 29
eH1_0                -2.453775e-01 1 1  ON 30
eH1_1                -1.425402e-01 1 1  ON 31
eH1_2                -9.509419e-02 1 1  ON 32
eH1_3                -4.052620e-02 1 1  ON 33
eH1_4                 7.831758e-03 1 1  ON 34
eH1_5                 4.192380e-02 1 1  ON 35
eH1_6                 9.952605e-02 1 1  ON 36
eH1_7                 1.520079e-01 1 1  ON 37
eH1_8                 1.700523e-01 1 1  ON 38
eH1_9                 5.623405e-02 1 1  ON 39
eH2_0                -2.436668e-01 1 1  ON 40
eH2_1                -1.401706e-01 1 1  ON 41
eH2_2                -9.247910e-02 1 1  ON 42
eH2_3                -3.836698e-02 1 1  ON 43
eH2_4                 1.030804e-02 1 1  ON 44
eH2_5                 4.517002e-02 1 1  ON 45
eH2_6                 1.022487e-01 1 1  ON 46
eH2_7                 1.551639e-01 1 1  ON 47
eH2_8                 1.755775e-01 1 1  ON 48
eH2_9                 4.231765e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6763e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9002
    reference variance = 0.567385
====================================================
  Execution time = 2.0381e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4582e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4400e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345804470567
                                         uncertainty =       0.006452079272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345804470567
                                         uncertainty =       0.006452079272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415824223
  error estimate for blocks of size 2^( 2) =       0.000428449428
  error estimate for blocks of size 2^( 3) =       0.000441027325
  error estimate for blocks of size 2^( 4) =       0.000453571963
  error estimate for blocks of size 2^( 5) =       0.000465641772
  error estimate for blocks of size 2^( 6) =       0.000474256432
  error estimate for blocks of size 2^( 7) =       0.000478843377

      target function =                  N/A
              le_mean =     -16.905764801985
             les_mean =     286.150702935222
             stat err =       0.000468078386
             autocorr =       1.267119594960
              std dev =       0.588064255079
             le_variance =       0.345819568101


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690576480198e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905764801985       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905764825663       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905764840561       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905764844307       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905764845827       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905764837857       residual = 8.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905764848081       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905764851761       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 9.851253e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905764801985       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905764807940       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905764811694       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905764812632       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905764813034       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905764811049       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905764813560       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905764814475       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.463522e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905764801985       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905764803476       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905764804416       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905764804651       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905764804753       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905764804257       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905764804882       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905764805110       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 6.159256e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162318 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5832e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.106448e-01 1 1  ON 0
 uu_1                 1.435994e-01 1 1  ON 1
 uu_2                 4.212750e-02 1 1  ON 2
 uu_3                -2.019697e-02 1 1  ON 3
 uu_4                -6.551044e-02 1 1  ON 4
 uu_5                -1.000028e-01 1 1  ON 5
 uu_6                -1.270490e-01 1 1  ON 6
 uu_7                -1.403667e-01 1 1  ON 7
 uu_8                -1.325647e-01 1 1  ON 8
 uu_9                -1.013139e-01 1 1  ON 9
 ud_0                 4.478520e-01 1 1  ON 10
 ud_1                 1.820015e-01 1 1  ON 11
 ud_2                 6.129248e-02 1 1  ON 12
 ud_3                -9.868139e-03 1 1  ON 13
 ud_4                -6.668186e-02 1 1  ON 14
 ud_5                -1.077823e-01 1 1  ON 15
 ud_6                -1.348496e-01 1 1  ON 16
 ud_7                -1.505182e-01 1 1  ON 17
 ud_8                -1.510936e-01 1 1  ON 18
 ud_9                -1.391003e-01 1 1  ON 19
 eO_0                -7.568696e-01 1 1  ON 20
 eO_1                -4.359639e-01 1 1  ON 21
 eO_2                -1.918529e-02 1 1  ON 22
 eO_3                 2.975735e-01 1 1  ON 23
 eO_4                 5.214222e-01 1 1  ON 24
 eO_5                 4.813382e-01 1 1  ON 25
 eO_6                 2.507082e-01 1 1  ON 26
 eO_7                -4.785561e-02 1 1  ON 27
 eO_8                -2.154396e-01 1 1  ON 28
 eO_9                -7.587569e-02 1 1  ON 29
eH1_0                -2.453786e-01 1 1  ON 30
eH1_1                -1.425426e-01 1 1  ON 31
eH1_2                -9.509372e-02 1 1  ON 32
eH1_3                -4.052605e-02 1 1  ON 33
eH1_4                 7.830605e-03 1 1  ON 34
eH1_5                 4.192408e-02 1 1  ON 35
eH1_6                 9.952576e-02 1 1  ON 36
eH1_7                 1.520087e-01 1 1  ON 37
eH1_8                 1.700539e-01 1 1  ON 38
eH1_9                 5.623563e-02 1 1  ON 39
eH2_0                -2.436681e-01 1 1  ON 40
eH2_1                -1.401716e-01 1 1  ON 41
eH2_2                -9.248112e-02 1 1  ON 42
eH2_3                -3.836705e-02 1 1  ON 43
eH2_4                 1.030736e-02 1 1  ON 44
eH2_5                 4.517010e-02 1 1  ON 45
eH2_6                 1.022490e-01 1 1  ON 46
eH2_7                 1.551642e-01 1 1  ON 47
eH2_8                 1.755790e-01 1 1  ON 48
eH2_9                 4.232011e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9225
    reference variance = 0.290183
====================================================
  Execution time = 2.0196e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4100e-01
  Total weights = 2.0000e+06
  Execution time = 1.8752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341092580364
                                         uncertainty =       0.004298447574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341092580364
                                         uncertainty =       0.004298447574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412916705
  error estimate for blocks of size 2^( 2) =       0.000425870242
  error estimate for blocks of size 2^( 3) =       0.000439122753
  error estimate for blocks of size 2^( 4) =       0.000451504300
  error estimate for blocks of size 2^( 5) =       0.000462380693
  error estimate for blocks of size 2^( 6) =       0.000470028579
  error estimate for blocks of size 2^( 7) =       0.000473106687

      target function =                  N/A
              le_mean =     -16.906065911550
             les_mean =     286.156064845540
             stat err =       0.000464255065
             autocorr =       1.264120269085
              std dev =       0.583952404187
             le_variance =       0.341000410355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341095048298
                                         uncertainty =       0.004298486053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341095048298
                                         uncertainty =       0.004298486053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412918199
  error estimate for blocks of size 2^( 2) =       0.000425871637
  error estimate for blocks of size 2^( 3) =       0.000439124086
  error estimate for blocks of size 2^( 4) =       0.000451505590
  error estimate for blocks of size 2^( 5) =       0.000462381954
  error estimate for blocks of size 2^( 6) =       0.000470029890
  error estimate for blocks of size 2^( 7) =       0.000473107631

      target function =                  N/A
              le_mean =     -16.906065951948
             les_mean =     286.156068678506
             stat err =       0.000464256266
             autocorr =       1.264117664730
              std dev =       0.583954516543
             le_variance =       0.341002877391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341093828944
                                         uncertainty =       0.004298467072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341093828944
                                         uncertainty =       0.004298467072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412917461
  error estimate for blocks of size 2^( 2) =       0.000425870948
  error estimate for blocks of size 2^( 3) =       0.000439123428
  error estimate for blocks of size 2^( 4) =       0.000451504953
  error estimate for blocks of size 2^( 5) =       0.000462381331
  error estimate for blocks of size 2^( 6) =       0.000470029242
  error estimate for blocks of size 2^( 7) =       0.000473107165

      target function =                  N/A
              le_mean =     -16.906065931780
             les_mean =     286.156066777677
             stat err =       0.000464255673
             autocorr =       1.264118954311
              std dev =       0.583953472873
             le_variance =       0.341001658480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341092736855
                                         uncertainty =       0.004298450019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341092736855
                                         uncertainty =       0.004298450019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412916800
  error estimate for blocks of size 2^( 2) =       0.000425870331
  error estimate for blocks of size 2^( 3) =       0.000439122838
  error estimate for blocks of size 2^( 4) =       0.000451504382
  error estimate for blocks of size 2^( 5) =       0.000462380773
  error estimate for blocks of size 2^( 6) =       0.000470028662
  error estimate for blocks of size 2^( 7) =       0.000473106747

      target function =                  N/A
              le_mean =     -16.906065914075
             les_mean =     286.156065087335
             stat err =       0.000464255141
             autocorr =       1.264120104342
              std dev =       0.583952538131
             le_variance =       0.341000566790


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906065911550        initial
     2.3842e+01     2.3842e+02             9.8513e-06       -16.906065951948  <--
     9.5367e+01     9.5367e+02             2.4635e-06       -16.906065931780
     3.8147e+02     3.8147e+03             6.1593e-07       -16.906065914075

*****************************************************************************
Applying the update for shift_i =   2.3842e+01     and shift_s =   2.3842e+02
*****************************************************************************

  Execution time = 2.9686e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436003e-01 1 1  ON 1
 uu_2                 4.212925e-02 1 1  ON 2
 uu_3                -2.019562e-02 1 1  ON 3
 uu_4                -6.550934e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270521e-01 1 1  ON 6
 uu_7                -1.403674e-01 1 1  ON 7
 uu_8                -1.325665e-01 1 1  ON 8
 uu_9                -1.013147e-01 1 1  ON 9
 ud_0                 4.478559e-01 1 1  ON 10
 ud_1                 1.820010e-01 1 1  ON 11
 ud_2                 6.129341e-02 1 1  ON 12
 ud_3                -9.868191e-03 1 1  ON 13
 ud_4                -6.668008e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348458e-01 1 1  ON 16
 ud_7                -1.505164e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391025e-01 1 1  ON 19
 eO_0                -7.568720e-01 1 1  ON 20
 eO_1                -4.359628e-01 1 1  ON 21
 eO_2                -1.918614e-02 1 1  ON 22
 eO_3                 2.975711e-01 1 1  ON 23
 eO_4                 5.214252e-01 1 1  ON 24
 eO_5                 4.813432e-01 1 1  ON 25
 eO_6                 2.507116e-01 1 1  ON 26
 eO_7                -4.785452e-02 1 1  ON 27
 eO_8                -2.154426e-01 1 1  ON 28
 eO_9                -7.587956e-02 1 1  ON 29
eH1_0                -2.453818e-01 1 1  ON 30
eH1_1                -1.425497e-01 1 1  ON 31
eH1_2                -9.509235e-02 1 1  ON 32
eH1_3                -4.052561e-02 1 1  ON 33
eH1_4                 7.827172e-03 1 1  ON 34
eH1_5                 4.192492e-02 1 1  ON 35
eH1_6                 9.952488e-02 1 1  ON 36
eH1_7                 1.520109e-01 1 1  ON 37
eH1_8                 1.700589e-01 1 1  ON 38
eH1_9                 5.624036e-02 1 1  ON 39
eH2_0                -2.436719e-01 1 1  ON 40
eH2_1                -1.401746e-01 1 1  ON 41
eH2_2                -9.248712e-02 1 1  ON 42
eH2_3                -3.836728e-02 1 1  ON 43
eH2_4                 1.030536e-02 1 1  ON 44
eH2_5                 4.517034e-02 1 1  ON 45
eH2_6                 1.022502e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755836e-01 1 1  ON 48
eH2_9                 4.232750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5750e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8878
    reference variance = 0.262232
====================================================
  Execution time = 2.0699e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4401e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5560e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344074810532
                                         uncertainty =       0.004667085146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344074810532
                                         uncertainty =       0.004667085146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414735762
  error estimate for blocks of size 2^( 2) =       0.000427184185
  error estimate for blocks of size 2^( 3) =       0.000440438499
  error estimate for blocks of size 2^( 4) =       0.000452452830
  error estimate for blocks of size 2^( 5) =       0.000462536177
  error estimate for blocks of size 2^( 6) =       0.000469350524
  error estimate for blocks of size 2^( 7) =       0.000474522167

      target function =                  N/A
              le_mean =     -16.906358283497
             les_mean =     286.168961742653
             stat err =       0.000464715424
             autocorr =       1.255541880530
              std dev =       0.586524939532
             le_variance =       0.344011504693


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690635828350e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906358283497       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906358352577       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906358385843       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906358354240       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906358422981       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906358511818       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906358489341       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906358486076       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 4.443989e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906358283497       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906358301289       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906358309913       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906358301466       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906358318319       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906358341439       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906358336104       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906358335445       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 1.113130e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906358283497       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906358287979       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906358290156       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906358288009       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906358292197       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906358298035       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906358296724       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906358296569       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.784147e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165065 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6266e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.106372e-01 1 1  ON 0
 uu_1                 1.436015e-01 1 1  ON 1
 uu_2                 4.213288e-02 1 1  ON 2
 uu_3                -2.019271e-02 1 1  ON 3
 uu_4                -6.550846e-02 1 1  ON 4
 uu_5                -1.000068e-01 1 1  ON 5
 uu_6                -1.270570e-01 1 1  ON 6
 uu_7                -1.403677e-01 1 1  ON 7
 uu_8                -1.325689e-01 1 1  ON 8
 uu_9                -1.013180e-01 1 1  ON 9
 ud_0                 4.478557e-01 1 1  ON 10
 ud_1                 1.819972e-01 1 1  ON 11
 ud_2                 6.129499e-02 1 1  ON 12
 ud_3                -9.867791e-03 1 1  ON 13
 ud_4                -6.668313e-02 1 1  ON 14
 ud_5                -1.077855e-01 1 1  ON 15
 ud_6                -1.348442e-01 1 1  ON 16
 ud_7                -1.505173e-01 1 1  ON 17
 ud_8                -1.510920e-01 1 1  ON 18
 ud_9                -1.391018e-01 1 1  ON 19
 eO_0                -7.568756e-01 1 1  ON 20
 eO_1                -4.359607e-01 1 1  ON 21
 eO_2                -1.918608e-02 1 1  ON 22
 eO_3                 2.975673e-01 1 1  ON 23
 eO_4                 5.214278e-01 1 1  ON 24
 eO_5                 4.813477e-01 1 1  ON 25
 eO_6                 2.507149e-01 1 1  ON 26
 eO_7                -4.785145e-02 1 1  ON 27
 eO_8                -2.154457e-01 1 1  ON 28
 eO_9                -7.588394e-02 1 1  ON 29
eH1_0                -2.453875e-01 1 1  ON 30
eH1_1                -1.425588e-01 1 1  ON 31
eH1_2                -9.509515e-02 1 1  ON 32
eH1_3                -4.052598e-02 1 1  ON 33
eH1_4                 7.822843e-03 1 1  ON 34
eH1_5                 4.192443e-02 1 1  ON 35
eH1_6                 9.952314e-02 1 1  ON 36
eH1_7                 1.520140e-01 1 1  ON 37
eH1_8                 1.700700e-01 1 1  ON 38
eH1_9                 5.625009e-02 1 1  ON 39
eH2_0                -2.436727e-01 1 1  ON 40
eH2_1                -1.401770e-01 1 1  ON 41
eH2_2                -9.248579e-02 1 1  ON 42
eH2_3                -3.836327e-02 1 1  ON 43
eH2_4                 1.029833e-02 1 1  ON 44
eH2_5                 4.516490e-02 1 1  ON 45
eH2_6                 1.022485e-01 1 1  ON 46
eH2_7                 1.551641e-01 1 1  ON 47
eH2_8                 1.755876e-01 1 1  ON 48
eH2_9                 4.233549e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8622
    reference variance = 0.318511
====================================================
  Execution time = 2.2407e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4238e-01
  Total weights = 2.0000e+06
  Execution time = 1.8735e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342374085988
                                         uncertainty =       0.006312473910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342374085988
                                         uncertainty =       0.006312473910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413750574
  error estimate for blocks of size 2^( 2) =       0.000426190515
  error estimate for blocks of size 2^( 3) =       0.000438760544
  error estimate for blocks of size 2^( 4) =       0.000451307372
  error estimate for blocks of size 2^( 5) =       0.000461632136
  error estimate for blocks of size 2^( 6) =       0.000469631415
  error estimate for blocks of size 2^( 7) =       0.000474673811

      target function =                  N/A
              le_mean =     -16.906129478090
             les_mean =     286.159592834366
             stat err =       0.000464311184
             autocorr =       1.259334408177
              std dev =       0.585131673738
             le_variance =       0.342379075611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342363164387
                                         uncertainty =       0.006312438358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342363164387
                                         uncertainty =       0.006312438358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413743980
  error estimate for blocks of size 2^( 2) =       0.000426184177
  error estimate for blocks of size 2^( 3) =       0.000438754646
  error estimate for blocks of size 2^( 4) =       0.000451301417
  error estimate for blocks of size 2^( 5) =       0.000461626617
  error estimate for blocks of size 2^( 6) =       0.000469626047
  error estimate for blocks of size 2^( 7) =       0.000474668507

      target function =                  N/A
              le_mean =     -16.906129294340
             les_mean =     286.159575707121
             stat err =       0.000464305647
             autocorr =       1.259344518352
              std dev =       0.585122347342
             le_variance =       0.342368161359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342368559842
                                         uncertainty =       0.006312458277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342368559842
                                         uncertainty =       0.006312458277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413747238
  error estimate for blocks of size 2^( 2) =       0.000426187309
  error estimate for blocks of size 2^( 3) =       0.000438757566
  error estimate for blocks of size 2^( 4) =       0.000451304359
  error estimate for blocks of size 2^( 5) =       0.000461629355
  error estimate for blocks of size 2^( 6) =       0.000469628717
  error estimate for blocks of size 2^( 7) =       0.000474671154

      target function =                  N/A
              le_mean =     -16.906129380320
             les_mean =     286.159584006045
             stat err =       0.000464308396
             autocorr =       1.259339599072
              std dev =       0.585126954707
             le_variance =       0.342373553124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342373392495
                                         uncertainty =       0.006312472032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342373392495
                                         uncertainty =       0.006312472032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413750156
  error estimate for blocks of size 2^( 2) =       0.000426190113
  error estimate for blocks of size 2^( 3) =       0.000438760170
  error estimate for blocks of size 2^( 4) =       0.000451306994
  error estimate for blocks of size 2^( 5) =       0.000461631787
  error estimate for blocks of size 2^( 6) =       0.000469631077
  error estimate for blocks of size 2^( 7) =       0.000474673478

      target function =                  N/A
              le_mean =     -16.906129465555
             les_mean =     286.159591717491
             stat err =       0.000464310834
             autocorr =       1.259335061314
              std dev =       0.585131081532
             le_variance =       0.342378382574


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906129478090        initial  <--
     5.9605e+00     5.9605e+01             4.4440e-05       -16.906129294340
     2.3842e+01     2.3842e+02             1.1131e-05       -16.906129380320
     9.5367e+01     9.5367e+02             2.7841e-06       -16.906129465555

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.9065
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436003e-01 1 1  ON 1
 uu_2                 4.212925e-02 1 1  ON 2
 uu_3                -2.019562e-02 1 1  ON 3
 uu_4                -6.550934e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270521e-01 1 1  ON 6
 uu_7                -1.403674e-01 1 1  ON 7
 uu_8                -1.325665e-01 1 1  ON 8
 uu_9                -1.013147e-01 1 1  ON 9
 ud_0                 4.478559e-01 1 1  ON 10
 ud_1                 1.820010e-01 1 1  ON 11
 ud_2                 6.129341e-02 1 1  ON 12
 ud_3                -9.868191e-03 1 1  ON 13
 ud_4                -6.668008e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348458e-01 1 1  ON 16
 ud_7                -1.505164e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391025e-01 1 1  ON 19
 eO_0                -7.568720e-01 1 1  ON 20
 eO_1                -4.359628e-01 1 1  ON 21
 eO_2                -1.918614e-02 1 1  ON 22
 eO_3                 2.975711e-01 1 1  ON 23
 eO_4                 5.214252e-01 1 1  ON 24
 eO_5                 4.813432e-01 1 1  ON 25
 eO_6                 2.507116e-01 1 1  ON 26
 eO_7                -4.785452e-02 1 1  ON 27
 eO_8                -2.154426e-01 1 1  ON 28
 eO_9                -7.587956e-02 1 1  ON 29
eH1_0                -2.453818e-01 1 1  ON 30
eH1_1                -1.425497e-01 1 1  ON 31
eH1_2                -9.509235e-02 1 1  ON 32
eH1_3                -4.052561e-02 1 1  ON 33
eH1_4                 7.827172e-03 1 1  ON 34
eH1_5                 4.192492e-02 1 1  ON 35
eH1_6                 9.952488e-02 1 1  ON 36
eH1_7                 1.520109e-01 1 1  ON 37
eH1_8                 1.700589e-01 1 1  ON 38
eH1_9                 5.624036e-02 1 1  ON 39
eH2_0                -2.436719e-01 1 1  ON 40
eH2_1                -1.401746e-01 1 1  ON 41
eH2_2                -9.248712e-02 1 1  ON 42
eH2_3                -3.836728e-02 1 1  ON 43
eH2_4                 1.030536e-02 1 1  ON 44
eH2_5                 4.517034e-02 1 1  ON 45
eH2_6                 1.022502e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755836e-01 1 1  ON 48
eH2_9                 4.232750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8337e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8805
    reference variance = 0.166989
====================================================
  Execution time = 2.0709e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3938e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339382201257
                                         uncertainty =       0.004106206291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339382201257
                                         uncertainty =       0.004106206291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411935006
  error estimate for blocks of size 2^( 2) =       0.000424756542
  error estimate for blocks of size 2^( 3) =       0.000438048911
  error estimate for blocks of size 2^( 4) =       0.000450209221
  error estimate for blocks of size 2^( 5) =       0.000460616653
  error estimate for blocks of size 2^( 6) =       0.000469569029
  error estimate for blocks of size 2^( 7) =       0.000473793152

      target function =                  N/A
              le_mean =     -16.906367747470
             les_mean =     286.164651141066
             stat err =       0.000463547014
             autocorr =       1.266281250119
              std dev =       0.582564072055
             le_variance =       0.339380898049


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690636774747e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906367747470       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906367759427       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906367761939       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906367767147       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906367775196       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906367780722       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906367779402       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906367779158       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 3.558977e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906367747470       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906367750465       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906367751094       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906367752400       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906367754402       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906367755804       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906367755476       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906367755416       residual = 5.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 8.901600e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906367747470       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906367748219       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906367748377       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906367748704       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906367749203       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906367749555       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906367749473       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906367749458       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.225660e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167679 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6246e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.106415e-01 1 1  ON 0
 uu_1                 1.436007e-01 1 1  ON 1
 uu_2                 4.212953e-02 1 1  ON 2
 uu_3                -2.019558e-02 1 1  ON 3
 uu_4                -6.550895e-02 1 1  ON 4
 uu_5                -1.000047e-01 1 1  ON 5
 uu_6                -1.270519e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325674e-01 1 1  ON 8
 uu_9                -1.013155e-01 1 1  ON 9
 ud_0                 4.478565e-01 1 1  ON 10
 ud_1                 1.820008e-01 1 1  ON 11
 ud_2                 6.129367e-02 1 1  ON 12
 ud_3                -9.868102e-03 1 1  ON 13
 ud_4                -6.668001e-02 1 1  ON 14
 ud_5                -1.077871e-01 1 1  ON 15
 ud_6                -1.348458e-01 1 1  ON 16
 ud_7                -1.505160e-01 1 1  ON 17
 ud_8                -1.510945e-01 1 1  ON 18
 ud_9                -1.391030e-01 1 1  ON 19
 eO_0                -7.568724e-01 1 1  ON 20
 eO_1                -4.359623e-01 1 1  ON 21
 eO_2                -1.918686e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214257e-01 1 1  ON 24
 eO_5                 4.813435e-01 1 1  ON 25
 eO_6                 2.507123e-01 1 1  ON 26
 eO_7                -4.785421e-02 1 1  ON 27
 eO_8                -2.154433e-01 1 1  ON 28
 eO_9                -7.588022e-02 1 1  ON 29
eH1_0                -2.453826e-01 1 1  ON 30
eH1_1                -1.425500e-01 1 1  ON 31
eH1_2                -9.509250e-02 1 1  ON 32
eH1_3                -4.052595e-02 1 1  ON 33
eH1_4                 7.827292e-03 1 1  ON 34
eH1_5                 4.192528e-02 1 1  ON 35
eH1_6                 9.952441e-02 1 1  ON 36
eH1_7                 1.520110e-01 1 1  ON 37
eH1_8                 1.700595e-01 1 1  ON 38
eH1_9                 5.624105e-02 1 1  ON 39
eH2_0                -2.436723e-01 1 1  ON 40
eH2_1                -1.401749e-01 1 1  ON 41
eH2_2                -9.248738e-02 1 1  ON 42
eH2_3                -3.836694e-02 1 1  ON 43
eH2_4                 1.030534e-02 1 1  ON 44
eH2_5                 4.516976e-02 1 1  ON 45
eH2_6                 1.022506e-01 1 1  ON 46
eH2_7                 1.551651e-01 1 1  ON 47
eH2_8                 1.755838e-01 1 1  ON 48
eH2_9                 4.232804e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8762
    reference variance = 0.191386
====================================================
  Execution time = 2.0716e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3645e-01
  Total weights = 2.0000e+06
  Execution time = 1.8663e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336459790711
                                         uncertainty =       0.004099750854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336459790711
                                         uncertainty =       0.004099750854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410152576
  error estimate for blocks of size 2^( 2) =       0.000422967951
  error estimate for blocks of size 2^( 3) =       0.000436024696
  error estimate for blocks of size 2^( 4) =       0.000448135826
  error estimate for blocks of size 2^( 5) =       0.000459705742
  error estimate for blocks of size 2^( 6) =       0.000468138450
  error estimate for blocks of size 2^( 7) =       0.000474506302

      target function =                  N/A
              le_mean =     -16.906383226775
             les_mean =     286.162243914109
             stat err =       0.000462621580
             autocorr =       1.272216099631
              std dev =       0.580043336113
             le_variance =       0.336450271769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336460656485
                                         uncertainty =       0.004099741493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336460656485
                                         uncertainty =       0.004099741493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410153104
  error estimate for blocks of size 2^( 2) =       0.000422968443
  error estimate for blocks of size 2^( 3) =       0.000436025130
  error estimate for blocks of size 2^( 4) =       0.000448136226
  error estimate for blocks of size 2^( 5) =       0.000459706119
  error estimate for blocks of size 2^( 6) =       0.000468138802
  error estimate for blocks of size 2^( 7) =       0.000474506583

      target function =                  N/A
              le_mean =     -16.906383212068
             les_mean =     286.162244282807
             stat err =       0.000462621933
             autocorr =       1.272214764640
              std dev =       0.580044082573
             le_variance =       0.336451137728

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336460227260
                                         uncertainty =       0.004099746172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336460227260
                                         uncertainty =       0.004099746172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410152842
  error estimate for blocks of size 2^( 2) =       0.000422968199
  error estimate for blocks of size 2^( 3) =       0.000436024915
  error estimate for blocks of size 2^( 4) =       0.000448136028
  error estimate for blocks of size 2^( 5) =       0.000459705932
  error estimate for blocks of size 2^( 6) =       0.000468138628
  error estimate for blocks of size 2^( 7) =       0.000474506444

      target function =                  N/A
              le_mean =     -16.906383219380
             les_mean =     286.162244100715
             stat err =       0.000462621758
             autocorr =       1.272215428424
              std dev =       0.580043712499
             le_variance =       0.336450708410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336459845387
                                         uncertainty =       0.004099750269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336459845387
                                         uncertainty =       0.004099750269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410152610
  error estimate for blocks of size 2^( 2) =       0.000422967982
  error estimate for blocks of size 2^( 3) =       0.000436024724
  error estimate for blocks of size 2^( 4) =       0.000448135851
  error estimate for blocks of size 2^( 5) =       0.000459705766
  error estimate for blocks of size 2^( 6) =       0.000468138472
  error estimate for blocks of size 2^( 7) =       0.000474506320

      target function =                  N/A
              le_mean =     -16.906383225848
             les_mean =     286.162243937468
             stat err =       0.000462621602
             autocorr =       1.272216015613
              std dev =       0.580043383254
             le_variance =       0.336450326457


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906383226775        initial  <--
     5.9605e+01     5.9605e+02             3.5590e-06       -16.906383212068
     2.3842e+02     2.3842e+03             8.9016e-07       -16.906383219380
     9.5367e+02     9.5367e+03             2.2257e-07       -16.906383225848

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1937
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436003e-01 1 1  ON 1
 uu_2                 4.212925e-02 1 1  ON 2
 uu_3                -2.019562e-02 1 1  ON 3
 uu_4                -6.550934e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270521e-01 1 1  ON 6
 uu_7                -1.403674e-01 1 1  ON 7
 uu_8                -1.325665e-01 1 1  ON 8
 uu_9                -1.013147e-01 1 1  ON 9
 ud_0                 4.478559e-01 1 1  ON 10
 ud_1                 1.820010e-01 1 1  ON 11
 ud_2                 6.129341e-02 1 1  ON 12
 ud_3                -9.868191e-03 1 1  ON 13
 ud_4                -6.668008e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348458e-01 1 1  ON 16
 ud_7                -1.505164e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391025e-01 1 1  ON 19
 eO_0                -7.568720e-01 1 1  ON 20
 eO_1                -4.359628e-01 1 1  ON 21
 eO_2                -1.918614e-02 1 1  ON 22
 eO_3                 2.975711e-01 1 1  ON 23
 eO_4                 5.214252e-01 1 1  ON 24
 eO_5                 4.813432e-01 1 1  ON 25
 eO_6                 2.507116e-01 1 1  ON 26
 eO_7                -4.785452e-02 1 1  ON 27
 eO_8                -2.154426e-01 1 1  ON 28
 eO_9                -7.587956e-02 1 1  ON 29
eH1_0                -2.453818e-01 1 1  ON 30
eH1_1                -1.425497e-01 1 1  ON 31
eH1_2                -9.509235e-02 1 1  ON 32
eH1_3                -4.052561e-02 1 1  ON 33
eH1_4                 7.827172e-03 1 1  ON 34
eH1_5                 4.192492e-02 1 1  ON 35
eH1_6                 9.952488e-02 1 1  ON 36
eH1_7                 1.520109e-01 1 1  ON 37
eH1_8                 1.700589e-01 1 1  ON 38
eH1_9                 5.624036e-02 1 1  ON 39
eH2_0                -2.436719e-01 1 1  ON 40
eH2_1                -1.401746e-01 1 1  ON 41
eH2_2                -9.248712e-02 1 1  ON 42
eH2_3                -3.836728e-02 1 1  ON 43
eH2_4                 1.030536e-02 1 1  ON 44
eH2_5                 4.517034e-02 1 1  ON 45
eH2_6                 1.022502e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755836e-01 1 1  ON 48
eH2_9                 4.232750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6610e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8892
    reference variance = 0.315657
====================================================
  Execution time = 2.1433e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3956e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4799e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339428841026
                                         uncertainty =       0.003720663269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339428841026
                                         uncertainty =       0.003720663269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412041937
  error estimate for blocks of size 2^( 2) =       0.000424627027
  error estimate for blocks of size 2^( 3) =       0.000437487023
  error estimate for blocks of size 2^( 4) =       0.000449780587
  error estimate for blocks of size 2^( 5) =       0.000460233319
  error estimate for blocks of size 2^( 6) =       0.000468634578
  error estimate for blocks of size 2^( 7) =       0.000475965245

      target function =                  N/A
              le_mean =     -16.905599989379
             les_mean =     286.138867946763
             stat err =       0.000463653432
             autocorr =       1.266205274528
              std dev =       0.582715295536
             le_variance =       0.339557115652


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690559998938e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905599989379       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905599989619       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905599989633       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905599989722       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905599989010       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905599989035       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905599989127       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905599989283       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 3.526654e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905599989379       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905599989439       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905599989442       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905599989465       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905599989286       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905599989294       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905599989314       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905599989355       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 8.816793e-08

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905599989379       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905599989394       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905599989395       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905599989398       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905599989356       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905599989358       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905599989365       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905599989366       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.204208e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170339 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6924e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436003e-01 1 1  ON 1
 uu_2                 4.212930e-02 1 1  ON 2
 uu_3                -2.019562e-02 1 1  ON 3
 uu_4                -6.550935e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270521e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325666e-01 1 1  ON 8
 uu_9                -1.013147e-01 1 1  ON 9
 ud_0                 4.478559e-01 1 1  ON 10
 ud_1                 1.820010e-01 1 1  ON 11
 ud_2                 6.129344e-02 1 1  ON 12
 ud_3                -9.868195e-03 1 1  ON 13
 ud_4                -6.668007e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348458e-01 1 1  ON 16
 ud_7                -1.505164e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391025e-01 1 1  ON 19
 eO_0                -7.568720e-01 1 1  ON 20
 eO_1                -4.359628e-01 1 1  ON 21
 eO_2                -1.918621e-02 1 1  ON 22
 eO_3                 2.975712e-01 1 1  ON 23
 eO_4                 5.214252e-01 1 1  ON 24
 eO_5                 4.813432e-01 1 1  ON 25
 eO_6                 2.507116e-01 1 1  ON 26
 eO_7                -4.785451e-02 1 1  ON 27
 eO_8                -2.154427e-01 1 1  ON 28
 eO_9                -7.587961e-02 1 1  ON 29
eH1_0                -2.453819e-01 1 1  ON 30
eH1_1                -1.425497e-01 1 1  ON 31
eH1_2                -9.509236e-02 1 1  ON 32
eH1_3                -4.052567e-02 1 1  ON 33
eH1_4                 7.827171e-03 1 1  ON 34
eH1_5                 4.192493e-02 1 1  ON 35
eH1_6                 9.952485e-02 1 1  ON 36
eH1_7                 1.520109e-01 1 1  ON 37
eH1_8                 1.700589e-01 1 1  ON 38
eH1_9                 5.624045e-02 1 1  ON 39
eH2_0                -2.436719e-01 1 1  ON 40
eH2_1                -1.401746e-01 1 1  ON 41
eH2_2                -9.248713e-02 1 1  ON 42
eH2_3                -3.836726e-02 1 1  ON 43
eH2_4                 1.030538e-02 1 1  ON 44
eH2_5                 4.517029e-02 1 1  ON 45
eH2_6                 1.022501e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755836e-01 1 1  ON 48
eH2_9                 4.232758e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.7721
    reference variance = 0.641044
====================================================
  Execution time = 2.0159e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3904e-01
  Total weights = 2.0000e+06
  Execution time = 1.8775e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338733268827
                                         uncertainty =       0.005742194617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338733268827
                                         uncertainty =       0.005742194617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411731100
  error estimate for blocks of size 2^( 2) =       0.000424285471
  error estimate for blocks of size 2^( 3) =       0.000436485910
  error estimate for blocks of size 2^( 4) =       0.000448390254
  error estimate for blocks of size 2^( 5) =       0.000458595435
  error estimate for blocks of size 2^( 6) =       0.000465738549
  error estimate for blocks of size 2^( 7) =       0.000469290268

      target function =                  N/A
              le_mean =     -16.906323169809
             les_mean =     286.162807949848
             stat err =       0.000460503627
             autocorr =       1.250946581748
              std dev =       0.582275705604
             le_variance =       0.339044997337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338733168074
                                         uncertainty =       0.005742193770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338733168074
                                         uncertainty =       0.005742193770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411731039
  error estimate for blocks of size 2^( 2) =       0.000424285413
  error estimate for blocks of size 2^( 3) =       0.000436485852
  error estimate for blocks of size 2^( 4) =       0.000448390196
  error estimate for blocks of size 2^( 5) =       0.000458595380
  error estimate for blocks of size 2^( 6) =       0.000465738494
  error estimate for blocks of size 2^( 7) =       0.000469290217

      target function =                  N/A
              le_mean =     -16.906323170811
             les_mean =     286.162807883515
             stat err =       0.000460503572
             autocorr =       1.250946653442
              std dev =       0.582275619550
             le_variance =       0.339044897122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338733218414
                                         uncertainty =       0.005742194193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338733218414
                                         uncertainty =       0.005742194193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411731070
  error estimate for blocks of size 2^( 2) =       0.000424285442
  error estimate for blocks of size 2^( 3) =       0.000436485881
  error estimate for blocks of size 2^( 4) =       0.000448390225
  error estimate for blocks of size 2^( 5) =       0.000458595408
  error estimate for blocks of size 2^( 6) =       0.000465738522
  error estimate for blocks of size 2^( 7) =       0.000469290242

      target function =                  N/A
              le_mean =     -16.906323170311
             les_mean =     286.162807916655
             stat err =       0.000460503599
             autocorr =       1.250946617643
              std dev =       0.582275662546
             le_variance =       0.339044947193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338733262524
                                         uncertainty =       0.005742194564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338733262524
                                         uncertainty =       0.005742194564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411731096
  error estimate for blocks of size 2^( 2) =       0.000424285468
  error estimate for blocks of size 2^( 3) =       0.000436485907
  error estimate for blocks of size 2^( 4) =       0.000448390251
  error estimate for blocks of size 2^( 5) =       0.000458595432
  error estimate for blocks of size 2^( 6) =       0.000465738546
  error estimate for blocks of size 2^( 7) =       0.000469290264

      target function =                  N/A
              le_mean =     -16.906323169872
             les_mean =     286.162807945698
             stat err =       0.000460503623
             autocorr =       1.250946586238
              std dev =       0.582275700221
             le_variance =       0.339044991068


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906323169809        initial
     5.9605e+02     5.9605e+03             3.5267e-07       -16.906323170811  <--
     2.3842e+03     2.3842e+04             8.8168e-08       -16.906323170311
     9.5367e+03     9.5367e+04             2.2042e-08       -16.906323169872

*****************************************************************************
Applying the update for shift_i =   5.9605e+02     and shift_s =   5.9605e+03
*****************************************************************************

  Execution time = 2.9696e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212943e-02 1 1  ON 2
 uu_3                -2.019562e-02 1 1  ON 3
 uu_4                -6.550938e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325667e-01 1 1  ON 8
 uu_9                -1.013149e-01 1 1  ON 9
 ud_0                 4.478560e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129355e-02 1 1  ON 12
 ud_3                -9.868205e-03 1 1  ON 13
 ud_4                -6.668004e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348458e-01 1 1  ON 16
 ud_7                -1.505163e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391026e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359628e-01 1 1  ON 21
 eO_2                -1.918643e-02 1 1  ON 22
 eO_3                 2.975713e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813432e-01 1 1  ON 25
 eO_6                 2.507118e-01 1 1  ON 26
 eO_7                -4.785450e-02 1 1  ON 27
 eO_8                -2.154429e-01 1 1  ON 28
 eO_9                -7.587977e-02 1 1  ON 29
eH1_0                -2.453819e-01 1 1  ON 30
eH1_1                -1.425498e-01 1 1  ON 31
eH1_2                -9.509241e-02 1 1  ON 32
eH1_3                -4.052584e-02 1 1  ON 33
eH1_4                 7.827168e-03 1 1  ON 34
eH1_5                 4.192496e-02 1 1  ON 35
eH1_6                 9.952476e-02 1 1  ON 36
eH1_7                 1.520109e-01 1 1  ON 37
eH1_8                 1.700591e-01 1 1  ON 38
eH1_9                 5.624072e-02 1 1  ON 39
eH2_0                -2.436720e-01 1 1  ON 40
eH2_1                -1.401747e-01 1 1  ON 41
eH2_2                -9.248715e-02 1 1  ON 42
eH2_3                -3.836720e-02 1 1  ON 43
eH2_4                 1.030544e-02 1 1  ON 44
eH2_5                 4.517015e-02 1 1  ON 45
eH2_6                 1.022499e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755838e-01 1 1  ON 48
eH2_9                 4.232782e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6798e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8681
    reference variance = 0.359139
====================================================
  Execution time = 2.0529e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3819e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5810e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338097649530
                                         uncertainty =       0.003457708528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338097649530
                                         uncertainty =       0.003457708528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411214543
  error estimate for blocks of size 2^( 2) =       0.000423926410
  error estimate for blocks of size 2^( 3) =       0.000437608844
  error estimate for blocks of size 2^( 4) =       0.000450266673
  error estimate for blocks of size 2^( 5) =       0.000461525469
  error estimate for blocks of size 2^( 6) =       0.000468478775
  error estimate for blocks of size 2^( 7) =       0.000472036515

      target function =                  N/A
              le_mean =     -16.906896085275
             les_mean =     286.181329869230
             stat err =       0.000463076858
             autocorr =       1.268145910347
              std dev =       0.581545183132
             le_variance =       0.338194800024


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690689608528e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906896085275       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906896086052       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906896086356       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906896088171       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906896084691       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906896083715       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906896085558       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906896085639       residual = 6.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.339995e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906896085275       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906896085470       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906896085546       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906896086000       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906896085128       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906896084884       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906896085344       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906896085362       residual = 6.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 3.350069e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906896085275       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906896085324       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906896085343       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906896085456       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906896085238       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906896085177       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906896085293       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906896085300       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 8.375225e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173017 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6121e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436005e-01 1 1  ON 1
 uu_2                 4.212950e-02 1 1  ON 2
 uu_3                -2.019554e-02 1 1  ON 3
 uu_4                -6.550953e-02 1 1  ON 4
 uu_5                -1.000057e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403674e-01 1 1  ON 7
 uu_8                -1.325666e-01 1 1  ON 8
 uu_9                -1.013150e-01 1 1  ON 9
 ud_0                 4.478559e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129368e-02 1 1  ON 12
 ud_3                -9.868053e-03 1 1  ON 13
 ud_4                -6.667986e-02 1 1  ON 14
 ud_5                -1.077868e-01 1 1  ON 15
 ud_6                -1.348457e-01 1 1  ON 16
 ud_7                -1.505165e-01 1 1  ON 17
 ud_8                -1.510947e-01 1 1  ON 18
 ud_9                -1.391027e-01 1 1  ON 19
 eO_0                -7.568722e-01 1 1  ON 20
 eO_1                -4.359626e-01 1 1  ON 21
 eO_2                -1.918643e-02 1 1  ON 22
 eO_3                 2.975713e-01 1 1  ON 23
 eO_4                 5.214257e-01 1 1  ON 24
 eO_5                 4.813432e-01 1 1  ON 25
 eO_6                 2.507121e-01 1 1  ON 26
 eO_7                -4.785444e-02 1 1  ON 27
 eO_8                -2.154432e-01 1 1  ON 28
 eO_9                -7.587998e-02 1 1  ON 29
eH1_0                -2.453822e-01 1 1  ON 30
eH1_1                -1.425501e-01 1 1  ON 31
eH1_2                -9.509233e-02 1 1  ON 32
eH1_3                -4.052598e-02 1 1  ON 33
eH1_4                 7.827256e-03 1 1  ON 34
eH1_5                 4.192492e-02 1 1  ON 35
eH1_6                 9.952469e-02 1 1  ON 36
eH1_7                 1.520108e-01 1 1  ON 37
eH1_8                 1.700593e-01 1 1  ON 38
eH1_9                 5.624100e-02 1 1  ON 39
eH2_0                -2.436722e-01 1 1  ON 40
eH2_1                -1.401750e-01 1 1  ON 41
eH2_2                -9.248716e-02 1 1  ON 42
eH2_3                -3.836726e-02 1 1  ON 43
eH2_4                 1.030527e-02 1 1  ON 44
eH2_5                 4.517002e-02 1 1  ON 45
eH2_6                 1.022500e-01 1 1  ON 46
eH2_7                 1.551651e-01 1 1  ON 47
eH2_8                 1.755841e-01 1 1  ON 48
eH2_9                 4.232816e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.7789
    reference variance = 0.419073
====================================================
  Execution time = 2.0786e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3740e-01
  Total weights = 2.0000e+06
  Execution time = 1.8633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337450131992
                                         uncertainty =       0.003986313318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337450131992
                                         uncertainty =       0.003986313318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410732249
  error estimate for blocks of size 2^( 2) =       0.000423343579
  error estimate for blocks of size 2^( 3) =       0.000436946198
  error estimate for blocks of size 2^( 4) =       0.000449208863
  error estimate for blocks of size 2^( 5) =       0.000460558667
  error estimate for blocks of size 2^( 6) =       0.000467511610
  error estimate for blocks of size 2^( 7) =       0.000474182037

      target function =                  N/A
              le_mean =     -16.906603885495
             les_mean =     286.170656733484
             stat err =       0.000462865294
             autocorr =       1.269964644524
              std dev =       0.580863117404
             le_variance =       0.337401961160

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337449235604
                                         uncertainty =       0.003986302831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337449235604
                                         uncertainty =       0.003986302831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410731704
  error estimate for blocks of size 2^( 2) =       0.000423343053
  error estimate for blocks of size 2^( 3) =       0.000436945693
  error estimate for blocks of size 2^( 4) =       0.000449208379
  error estimate for blocks of size 2^( 5) =       0.000460558200
  error estimate for blocks of size 2^( 6) =       0.000467511150
  error estimate for blocks of size 2^( 7) =       0.000474181561

      target function =                  N/A
              le_mean =     -16.906603884228
             les_mean =     286.170655794403
             stat err =       0.000462864822
             autocorr =       1.269965426705
              std dev =       0.580862345922
             le_variance =       0.337401064910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337449683106
                                         uncertainty =       0.003986308064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337449683106
                                         uncertainty =       0.003986308064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410731976
  error estimate for blocks of size 2^( 2) =       0.000423343316
  error estimate for blocks of size 2^( 3) =       0.000436945945
  error estimate for blocks of size 2^( 4) =       0.000449208620
  error estimate for blocks of size 2^( 5) =       0.000460558433
  error estimate for blocks of size 2^( 6) =       0.000467511380
  error estimate for blocks of size 2^( 7) =       0.000474181798

      target function =                  N/A
              le_mean =     -16.906603884856
             les_mean =     286.170656263075
             stat err =       0.000462865058
             autocorr =       1.269965036215
              std dev =       0.580862731067
             le_variance =       0.337401512343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337450075859
                                         uncertainty =       0.003986312661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337450075859
                                         uncertainty =       0.003986312661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410732215
  error estimate for blocks of size 2^( 2) =       0.000423343546
  error estimate for blocks of size 2^( 3) =       0.000436946166
  error estimate for blocks of size 2^( 4) =       0.000449208833
  error estimate for blocks of size 2^( 5) =       0.000460558638
  error estimate for blocks of size 2^( 6) =       0.000467511582
  error estimate for blocks of size 2^( 7) =       0.000474182007

      target function =                  N/A
              le_mean =     -16.906603885415
             les_mean =     286.170656674652
             stat err =       0.000462865265
             autocorr =       1.269964693496
              std dev =       0.580863069092
             le_variance =       0.337401905035


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906603885495        initial  <--
     1.4901e+02     1.4901e+03             1.3400e-06       -16.906603884228
     5.9605e+02     5.9605e+03             3.3501e-07       -16.906603884856
     2.3842e+03     2.3842e+04             8.3752e-08       -16.906603885415

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2498
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212943e-02 1 1  ON 2
 uu_3                -2.019562e-02 1 1  ON 3
 uu_4                -6.550938e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325667e-01 1 1  ON 8
 uu_9                -1.013149e-01 1 1  ON 9
 ud_0                 4.478560e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129355e-02 1 1  ON 12
 ud_3                -9.868205e-03 1 1  ON 13
 ud_4                -6.668004e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348458e-01 1 1  ON 16
 ud_7                -1.505163e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391026e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359628e-01 1 1  ON 21
 eO_2                -1.918643e-02 1 1  ON 22
 eO_3                 2.975713e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813432e-01 1 1  ON 25
 eO_6                 2.507118e-01 1 1  ON 26
 eO_7                -4.785450e-02 1 1  ON 27
 eO_8                -2.154429e-01 1 1  ON 28
 eO_9                -7.587977e-02 1 1  ON 29
eH1_0                -2.453819e-01 1 1  ON 30
eH1_1                -1.425498e-01 1 1  ON 31
eH1_2                -9.509241e-02 1 1  ON 32
eH1_3                -4.052584e-02 1 1  ON 33
eH1_4                 7.827168e-03 1 1  ON 34
eH1_5                 4.192496e-02 1 1  ON 35
eH1_6                 9.952476e-02 1 1  ON 36
eH1_7                 1.520109e-01 1 1  ON 37
eH1_8                 1.700591e-01 1 1  ON 38
eH1_9                 5.624072e-02 1 1  ON 39
eH2_0                -2.436720e-01 1 1  ON 40
eH2_1                -1.401747e-01 1 1  ON 41
eH2_2                -9.248715e-02 1 1  ON 42
eH2_3                -3.836720e-02 1 1  ON 43
eH2_4                 1.030544e-02 1 1  ON 44
eH2_5                 4.517015e-02 1 1  ON 45
eH2_6                 1.022499e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755838e-01 1 1  ON 48
eH2_9                 4.232782e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6560e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.916
    reference variance = 0.261307
====================================================
  Execution time = 2.1913e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4644e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6028e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346515714461
                                         uncertainty =       0.006756032063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346515714461
                                         uncertainty =       0.006756032063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416196060
  error estimate for blocks of size 2^( 2) =       0.000428872200
  error estimate for blocks of size 2^( 3) =       0.000441994322
  error estimate for blocks of size 2^( 4) =       0.000454731682
  error estimate for blocks of size 2^( 5) =       0.000466376615
  error estimate for blocks of size 2^( 6) =       0.000473984230
  error estimate for blocks of size 2^( 7) =       0.000479268502

      target function =                  N/A
              le_mean =     -16.906195405589
             les_mean =     286.165881238654
             stat err =       0.000468590257
             autocorr =       1.267624374177
              std dev =       0.588590111985
             le_variance =       0.346438319926


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690619540559e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906195405589       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906195405671       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906195405630       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906195405802       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906195405818       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906195405954       residual = 8.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906195405747       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906195405796       residual = 3.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.590897e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906195405589       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906195405609       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906195405599       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906195405642       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906195405642       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906195405681       residual = 8.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906195405628       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906195405644       residual = 3.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 3.977264e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906195405589       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906195405594       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906195405591       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906195405602       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906195405601       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906195405611       residual = 8.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906195405600       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906195405600       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 9.943174e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175696 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7527e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212942e-02 1 1  ON 2
 uu_3                -2.019562e-02 1 1  ON 3
 uu_4                -6.550939e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325667e-01 1 1  ON 8
 uu_9                -1.013149e-01 1 1  ON 9
 ud_0                 4.478560e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129355e-02 1 1  ON 12
 ud_3                -9.868203e-03 1 1  ON 13
 ud_4                -6.668004e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348459e-01 1 1  ON 16
 ud_7                -1.505164e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391026e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359628e-01 1 1  ON 21
 eO_2                -1.918643e-02 1 1  ON 22
 eO_3                 2.975713e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813433e-01 1 1  ON 25
 eO_6                 2.507118e-01 1 1  ON 26
 eO_7                -4.785449e-02 1 1  ON 27
 eO_8                -2.154429e-01 1 1  ON 28
 eO_9                -7.587979e-02 1 1  ON 29
eH1_0                -2.453820e-01 1 1  ON 30
eH1_1                -1.425499e-01 1 1  ON 31
eH1_2                -9.509242e-02 1 1  ON 32
eH1_3                -4.052586e-02 1 1  ON 33
eH1_4                 7.827169e-03 1 1  ON 34
eH1_5                 4.192495e-02 1 1  ON 35
eH1_6                 9.952476e-02 1 1  ON 36
eH1_7                 1.520109e-01 1 1  ON 37
eH1_8                 1.700591e-01 1 1  ON 38
eH1_9                 5.624075e-02 1 1  ON 39
eH2_0                -2.436720e-01 1 1  ON 40
eH2_1                -1.401747e-01 1 1  ON 41
eH2_2                -9.248716e-02 1 1  ON 42
eH2_3                -3.836720e-02 1 1  ON 43
eH2_4                 1.030542e-02 1 1  ON 44
eH2_5                 4.517014e-02 1 1  ON 45
eH2_6                 1.022499e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755838e-01 1 1  ON 48
eH2_9                 4.232786e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8973
    reference variance = 0.337446
====================================================
  Execution time = 2.0575e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4455e-01
  Total weights = 2.0000e+06
  Execution time = 1.8757e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344576880515
                                         uncertainty =       0.007287014211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344576880515
                                         uncertainty =       0.007287014211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415058910
  error estimate for blocks of size 2^( 2) =       0.000427832509
  error estimate for blocks of size 2^( 3) =       0.000441261577
  error estimate for blocks of size 2^( 4) =       0.000454389177
  error estimate for blocks of size 2^( 5) =       0.000465543853
  error estimate for blocks of size 2^( 6) =       0.000473941281
  error estimate for blocks of size 2^( 7) =       0.000480978399

      target function =                  N/A
              le_mean =     -16.905413099228
             les_mean =     286.137539680333
             stat err =       0.000468713177
             autocorr =       1.275248569800
              std dev =       0.586981939293
             le_variance =       0.344547797056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344576827657
                                         uncertainty =       0.007287013290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344576827657
                                         uncertainty =       0.007287013290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415058878
  error estimate for blocks of size 2^( 2) =       0.000427832478
  error estimate for blocks of size 2^( 3) =       0.000441261547
  error estimate for blocks of size 2^( 4) =       0.000454389148
  error estimate for blocks of size 2^( 5) =       0.000465543822
  error estimate for blocks of size 2^( 6) =       0.000473941250
  error estimate for blocks of size 2^( 7) =       0.000480978370

      target function =                  N/A
              le_mean =     -16.905413098771
             les_mean =     286.137539612007
             stat err =       0.000468713147
             autocorr =       1.275248602324
              std dev =       0.586981894258
             le_variance =       0.344547744187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344576854076
                                         uncertainty =       0.007287013751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344576854076
                                         uncertainty =       0.007287013751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415058894
  error estimate for blocks of size 2^( 2) =       0.000427832494
  error estimate for blocks of size 2^( 3) =       0.000441261562
  error estimate for blocks of size 2^( 4) =       0.000454389162
  error estimate for blocks of size 2^( 5) =       0.000465543838
  error estimate for blocks of size 2^( 6) =       0.000473941265
  error estimate for blocks of size 2^( 7) =       0.000480978384

      target function =                  N/A
              le_mean =     -16.905413098999
             les_mean =     286.137539646158
             stat err =       0.000468713162
             autocorr =       1.275248586074
              std dev =       0.586981916767
             le_variance =       0.344547770612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344576877210
                                         uncertainty =       0.007287014154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344576877210
                                         uncertainty =       0.007287014154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415058908
  error estimate for blocks of size 2^( 2) =       0.000427832507
  error estimate for blocks of size 2^( 3) =       0.000441261575
  error estimate for blocks of size 2^( 4) =       0.000454389175
  error estimate for blocks of size 2^( 5) =       0.000465543851
  error estimate for blocks of size 2^( 6) =       0.000473941279
  error estimate for blocks of size 2^( 7) =       0.000480978397

      target function =                  N/A
              le_mean =     -16.905413099199
             les_mean =     286.137539676060
             stat err =       0.000468713176
             autocorr =       1.275248571828
              std dev =       0.586981936477
             le_variance =       0.344547793750


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905413099228        initial  <--
     1.4901e+03     1.4901e+04             1.5909e-07       -16.905413098771
     5.9605e+03     5.9605e+04             3.9773e-08       -16.905413098999
     2.3842e+04     2.3842e+05             9.9432e-09       -16.905413099199

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1014
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212943e-02 1 1  ON 2
 uu_3                -2.019562e-02 1 1  ON 3
 uu_4                -6.550938e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325667e-01 1 1  ON 8
 uu_9                -1.013149e-01 1 1  ON 9
 ud_0                 4.478560e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129355e-02 1 1  ON 12
 ud_3                -9.868205e-03 1 1  ON 13
 ud_4                -6.668004e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348458e-01 1 1  ON 16
 ud_7                -1.505163e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391026e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359628e-01 1 1  ON 21
 eO_2                -1.918643e-02 1 1  ON 22
 eO_3                 2.975713e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813432e-01 1 1  ON 25
 eO_6                 2.507118e-01 1 1  ON 26
 eO_7                -4.785450e-02 1 1  ON 27
 eO_8                -2.154429e-01 1 1  ON 28
 eO_9                -7.587977e-02 1 1  ON 29
eH1_0                -2.453819e-01 1 1  ON 30
eH1_1                -1.425498e-01 1 1  ON 31
eH1_2                -9.509241e-02 1 1  ON 32
eH1_3                -4.052584e-02 1 1  ON 33
eH1_4                 7.827168e-03 1 1  ON 34
eH1_5                 4.192496e-02 1 1  ON 35
eH1_6                 9.952476e-02 1 1  ON 36
eH1_7                 1.520109e-01 1 1  ON 37
eH1_8                 1.700591e-01 1 1  ON 38
eH1_9                 5.624072e-02 1 1  ON 39
eH2_0                -2.436720e-01 1 1  ON 40
eH2_1                -1.401747e-01 1 1  ON 41
eH2_2                -9.248715e-02 1 1  ON 42
eH2_3                -3.836720e-02 1 1  ON 43
eH2_4                 1.030544e-02 1 1  ON 44
eH2_5                 4.517015e-02 1 1  ON 45
eH2_6                 1.022499e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755838e-01 1 1  ON 48
eH2_9                 4.232782e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7820e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9319
    reference variance = 0.344259
====================================================
  Execution time = 2.0756e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4169e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5517e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341404972032
                                         uncertainty =       0.006634529048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341404972032
                                         uncertainty =       0.006634529048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413333908
  error estimate for blocks of size 2^( 2) =       0.000425758805
  error estimate for blocks of size 2^( 3) =       0.000439052615
  error estimate for blocks of size 2^( 4) =       0.000451645890
  error estimate for blocks of size 2^( 5) =       0.000463249226
  error estimate for blocks of size 2^( 6) =       0.000471320821
  error estimate for blocks of size 2^( 7) =       0.000473161346

      target function =                  N/A
              le_mean =     -16.905876511450
             les_mean =     286.150350288049
             stat err =       0.000464844321
             autocorr =       1.264774177998
              std dev =       0.584542418061
             le_variance =       0.341689838513


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690587651145e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905876511450       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905876511419       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905876511433       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905876511469       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905876511479       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905876511478       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905876511478       residual = 9.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.591989e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905876511450       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905876511442       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905876511446       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905876511454       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905876511411       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905876511445       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905876511477       residual = 9.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.979977e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905876511450       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905876511448       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905876511449       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905876511446       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905876511586       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905876511442       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905876511371       residual = 9.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 9.949946e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177959 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6318e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212943e-02 1 1  ON 2
 uu_3                -2.019562e-02 1 1  ON 3
 uu_4                -6.550938e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325667e-01 1 1  ON 8
 uu_9                -1.013149e-01 1 1  ON 9
 ud_0                 4.478560e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129355e-02 1 1  ON 12
 ud_3                -9.868205e-03 1 1  ON 13
 ud_4                -6.668004e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348458e-01 1 1  ON 16
 ud_7                -1.505163e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391026e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359628e-01 1 1  ON 21
 eO_2                -1.918643e-02 1 1  ON 22
 eO_3                 2.975713e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813432e-01 1 1  ON 25
 eO_6                 2.507118e-01 1 1  ON 26
 eO_7                -4.785450e-02 1 1  ON 27
 eO_8                -2.154429e-01 1 1  ON 28
 eO_9                -7.587977e-02 1 1  ON 29
eH1_0                -2.453819e-01 1 1  ON 30
eH1_1                -1.425498e-01 1 1  ON 31
eH1_2                -9.509241e-02 1 1  ON 32
eH1_3                -4.052584e-02 1 1  ON 33
eH1_4                 7.827169e-03 1 1  ON 34
eH1_5                 4.192496e-02 1 1  ON 35
eH1_6                 9.952476e-02 1 1  ON 36
eH1_7                 1.520109e-01 1 1  ON 37
eH1_8                 1.700591e-01 1 1  ON 38
eH1_9                 5.624072e-02 1 1  ON 39
eH2_0                -2.436720e-01 1 1  ON 40
eH2_1                -1.401747e-01 1 1  ON 41
eH2_2                -9.248716e-02 1 1  ON 42
eH2_3                -3.836720e-02 1 1  ON 43
eH2_4                 1.030544e-02 1 1  ON 44
eH2_5                 4.517015e-02 1 1  ON 45
eH2_6                 1.022499e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755838e-01 1 1  ON 48
eH2_9                 4.232782e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.0621
    reference variance = 0.730343
====================================================
  Execution time = 2.0094e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3825e-01
  Total weights = 2.0000e+06
  Execution time = 1.8711e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338243276498
                                         uncertainty =       0.003136348633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338243276498
                                         uncertainty =       0.003136348633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411247950
  error estimate for blocks of size 2^( 2) =       0.000423907436
  error estimate for blocks of size 2^( 3) =       0.000436756863
  error estimate for blocks of size 2^( 4) =       0.000448897870
  error estimate for blocks of size 2^( 5) =       0.000459276073
  error estimate for blocks of size 2^( 6) =       0.000467930845
  error estimate for blocks of size 2^( 7) =       0.000473151764

      target function =                  N/A
              le_mean =     -16.905767607687
             les_mean =     286.143227988415
             stat err =       0.000462314138
             autocorr =       1.263766555444
              std dev =       0.581592428108
             le_variance =       0.338249752432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338243277109
                                         uncertainty =       0.003136348686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338243277109
                                         uncertainty =       0.003136348686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411247950
  error estimate for blocks of size 2^( 2) =       0.000423907437
  error estimate for blocks of size 2^( 3) =       0.000436756863
  error estimate for blocks of size 2^( 4) =       0.000448897870
  error estimate for blocks of size 2^( 5) =       0.000459276073
  error estimate for blocks of size 2^( 6) =       0.000467930845
  error estimate for blocks of size 2^( 7) =       0.000473151764

      target function =                  N/A
              le_mean =     -16.905767607697
             les_mean =     286.143227989379
             stat err =       0.000462314138
             autocorr =       1.263766554757
              std dev =       0.581592428634
             le_variance =       0.338249753045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338243276804
                                         uncertainty =       0.003136348659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338243276804
                                         uncertainty =       0.003136348659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411247950
  error estimate for blocks of size 2^( 2) =       0.000423907437
  error estimate for blocks of size 2^( 3) =       0.000436756863
  error estimate for blocks of size 2^( 4) =       0.000448897870
  error estimate for blocks of size 2^( 5) =       0.000459276073
  error estimate for blocks of size 2^( 6) =       0.000467930845
  error estimate for blocks of size 2^( 7) =       0.000473151764

      target function =                  N/A
              le_mean =     -16.905767607692
             les_mean =     286.143227988897
             stat err =       0.000462314138
             autocorr =       1.263766555101
              std dev =       0.581592428371
             le_variance =       0.338249752738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338243276537
                                         uncertainty =       0.003136348636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338243276537
                                         uncertainty =       0.003136348636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411247950
  error estimate for blocks of size 2^( 2) =       0.000423907436
  error estimate for blocks of size 2^( 3) =       0.000436756863
  error estimate for blocks of size 2^( 4) =       0.000448897870
  error estimate for blocks of size 2^( 5) =       0.000459276073
  error estimate for blocks of size 2^( 6) =       0.000467930845
  error estimate for blocks of size 2^( 7) =       0.000473151764

      target function =                  N/A
              le_mean =     -16.905767607687
             les_mean =     286.143227988475
             stat err =       0.000462314138
             autocorr =       1.263766555404
              std dev =       0.581592428141
             le_variance =       0.338249752470


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905767607687        initial
     1.4901e+04     1.4901e+05             1.5920e-08       -16.905767607697  <--
     5.9605e+04     5.9605e+05             3.9800e-09       -16.905767607692
     2.3842e+05     2.3842e+06             9.9499e-10       -16.905767607687

*****************************************************************************
Applying the update for shift_i =   1.4901e+04     and shift_s =   1.4901e+05
*****************************************************************************

  Execution time = 2.9705e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212943e-02 1 1  ON 2
 uu_3                -2.019562e-02 1 1  ON 3
 uu_4                -6.550938e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325667e-01 1 1  ON 8
 uu_9                -1.013149e-01 1 1  ON 9
 ud_0                 4.478560e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129355e-02 1 1  ON 12
 ud_3                -9.868204e-03 1 1  ON 13
 ud_4                -6.668004e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348458e-01 1 1  ON 16
 ud_7                -1.505163e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391026e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359628e-01 1 1  ON 21
 eO_2                -1.918643e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813433e-01 1 1  ON 25
 eO_6                 2.507118e-01 1 1  ON 26
 eO_7                -4.785450e-02 1 1  ON 27
 eO_8                -2.154429e-01 1 1  ON 28
 eO_9                -7.587978e-02 1 1  ON 29
eH1_0                -2.453820e-01 1 1  ON 30
eH1_1                -1.425498e-01 1 1  ON 31
eH1_2                -9.509241e-02 1 1  ON 32
eH1_3                -4.052584e-02 1 1  ON 33
eH1_4                 7.827170e-03 1 1  ON 34
eH1_5                 4.192496e-02 1 1  ON 35
eH1_6                 9.952476e-02 1 1  ON 36
eH1_7                 1.520109e-01 1 1  ON 37
eH1_8                 1.700591e-01 1 1  ON 38
eH1_9                 5.624073e-02 1 1  ON 39
eH2_0                -2.436720e-01 1 1  ON 40
eH2_1                -1.401747e-01 1 1  ON 41
eH2_2                -9.248716e-02 1 1  ON 42
eH2_3                -3.836720e-02 1 1  ON 43
eH2_4                 1.030544e-02 1 1  ON 44
eH2_5                 4.517015e-02 1 1  ON 45
eH2_6                 1.022500e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755838e-01 1 1  ON 48
eH2_9                 4.232784e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6248e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8776
    reference variance = 0.250822
====================================================
  Execution time = 2.2881e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4221e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4894e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342073948331
                                         uncertainty =       0.006046514275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342073948331
                                         uncertainty =       0.006046514275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413648635
  error estimate for blocks of size 2^( 2) =       0.000426278376
  error estimate for blocks of size 2^( 3) =       0.000438870415
  error estimate for blocks of size 2^( 4) =       0.000450696187
  error estimate for blocks of size 2^( 5) =       0.000460113392
  error estimate for blocks of size 2^( 6) =       0.000467851819
  error estimate for blocks of size 2^( 7) =       0.000469400576

      target function =                  N/A
              le_mean =     -16.906622605109
             les_mean =     286.176098127497
             stat err =       0.000462015493
             autocorr =       1.247526809566
              std dev =       0.584987510137
             le_variance =       0.342210387017


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690662260511e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906622605109       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906622604926       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906622605010       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906622605016       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906622605157       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906622605194       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906622605154       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906622605181       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 5.514901e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906622605109       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906622605063       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906622605084       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906622605086       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906622605118       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906622605144       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906622605120       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906622605120       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.378786e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906622605109       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906622605098       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906622605103       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906622605103       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906622605112       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906622605108       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906622605113       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906622605146       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.447003e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180580 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8381e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212943e-02 1 1  ON 2
 uu_3                -2.019562e-02 1 1  ON 3
 uu_4                -6.550938e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325667e-01 1 1  ON 8
 uu_9                -1.013149e-01 1 1  ON 9
 ud_0                 4.478560e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129355e-02 1 1  ON 12
 ud_3                -9.868201e-03 1 1  ON 13
 ud_4                -6.668004e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348458e-01 1 1  ON 16
 ud_7                -1.505163e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391026e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359628e-01 1 1  ON 21
 eO_2                -1.918643e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813433e-01 1 1  ON 25
 eO_6                 2.507119e-01 1 1  ON 26
 eO_7                -4.785449e-02 1 1  ON 27
 eO_8                -2.154429e-01 1 1  ON 28
 eO_9                -7.587979e-02 1 1  ON 29
eH1_0                -2.453820e-01 1 1  ON 30
eH1_1                -1.425498e-01 1 1  ON 31
eH1_2                -9.509241e-02 1 1  ON 32
eH1_3                -4.052585e-02 1 1  ON 33
eH1_4                 7.827157e-03 1 1  ON 34
eH1_5                 4.192496e-02 1 1  ON 35
eH1_6                 9.952476e-02 1 1  ON 36
eH1_7                 1.520109e-01 1 1  ON 37
eH1_8                 1.700591e-01 1 1  ON 38
eH1_9                 5.624074e-02 1 1  ON 39
eH2_0                -2.436720e-01 1 1  ON 40
eH2_1                -1.401747e-01 1 1  ON 41
eH2_2                -9.248716e-02 1 1  ON 42
eH2_3                -3.836720e-02 1 1  ON 43
eH2_4                 1.030544e-02 1 1  ON 44
eH2_5                 4.517014e-02 1 1  ON 45
eH2_6                 1.022499e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755838e-01 1 1  ON 48
eH2_9                 4.232785e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9236
    reference variance = 0.233119
====================================================
  Execution time = 2.0614e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3772e-01
  Total weights = 2.0000e+06
  Execution time = 1.8715e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337698226068
                                         uncertainty =       0.005445386792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337698226068
                                         uncertainty =       0.005445386792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410925299
  error estimate for blocks of size 2^( 2) =       0.000423550070
  error estimate for blocks of size 2^( 3) =       0.000436712736
  error estimate for blocks of size 2^( 4) =       0.000448915017
  error estimate for blocks of size 2^( 5) =       0.000459232763
  error estimate for blocks of size 2^( 6) =       0.000467282804
  error estimate for blocks of size 2^( 7) =       0.000472069450

      target function =                  N/A
              le_mean =     -16.905838784364
             les_mean =     286.145104037158
             stat err =       0.000461875008
             autocorr =       1.263348494820
              std dev =       0.581136131307
             le_variance =       0.337719203111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337698260748
                                         uncertainty =       0.005445386754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337698260748
                                         uncertainty =       0.005445386754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410925320
  error estimate for blocks of size 2^( 2) =       0.000423550090
  error estimate for blocks of size 2^( 3) =       0.000436712754
  error estimate for blocks of size 2^( 4) =       0.000448915034
  error estimate for blocks of size 2^( 5) =       0.000459232780
  error estimate for blocks of size 2^( 6) =       0.000467282820
  error estimate for blocks of size 2^( 7) =       0.000472069466

      target function =                  N/A
              le_mean =     -16.905838784108
             les_mean =     286.145104063175
             stat err =       0.000461875025
             autocorr =       1.263348456692
              std dev =       0.581136161140
             le_variance =       0.337719237784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337698243409
                                         uncertainty =       0.005445386773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337698243409
                                         uncertainty =       0.005445386773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410925310
  error estimate for blocks of size 2^( 2) =       0.000423550080
  error estimate for blocks of size 2^( 3) =       0.000436712745
  error estimate for blocks of size 2^( 4) =       0.000448915026
  error estimate for blocks of size 2^( 5) =       0.000459232771
  error estimate for blocks of size 2^( 6) =       0.000467282812
  error estimate for blocks of size 2^( 7) =       0.000472069458

      target function =                  N/A
              le_mean =     -16.905838784236
             les_mean =     286.145104050167
             stat err =       0.000461875017
             autocorr =       1.263348475754
              std dev =       0.581136146225
             le_variance =       0.337719220449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337698228236
                                         uncertainty =       0.005445386790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337698228236
                                         uncertainty =       0.005445386790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410925301
  error estimate for blocks of size 2^( 2) =       0.000423550072
  error estimate for blocks of size 2^( 3) =       0.000436712737
  error estimate for blocks of size 2^( 4) =       0.000448915018
  error estimate for blocks of size 2^( 5) =       0.000459232764
  error estimate for blocks of size 2^( 6) =       0.000467282805
  error estimate for blocks of size 2^( 7) =       0.000472069451

      target function =                  N/A
              le_mean =     -16.905838784348
             les_mean =     286.145104038784
             stat err =       0.000461875010
             autocorr =       1.263348492435
              std dev =       0.581136133172
             le_variance =       0.337719205278


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905838784364        initial  <--
     3.7253e+03     3.7253e+04             5.5149e-08       -16.905838784108
     1.4901e+04     1.4901e+05             1.3788e-08       -16.905838784236
     5.9605e+04     5.9605e+05             3.4470e-09       -16.905838784348

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1156
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212943e-02 1 1  ON 2
 uu_3                -2.019562e-02 1 1  ON 3
 uu_4                -6.550938e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325667e-01 1 1  ON 8
 uu_9                -1.013149e-01 1 1  ON 9
 ud_0                 4.478560e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129355e-02 1 1  ON 12
 ud_3                -9.868204e-03 1 1  ON 13
 ud_4                -6.668004e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348458e-01 1 1  ON 16
 ud_7                -1.505163e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391026e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359628e-01 1 1  ON 21
 eO_2                -1.918643e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813433e-01 1 1  ON 25
 eO_6                 2.507118e-01 1 1  ON 26
 eO_7                -4.785450e-02 1 1  ON 27
 eO_8                -2.154429e-01 1 1  ON 28
 eO_9                -7.587978e-02 1 1  ON 29
eH1_0                -2.453820e-01 1 1  ON 30
eH1_1                -1.425498e-01 1 1  ON 31
eH1_2                -9.509241e-02 1 1  ON 32
eH1_3                -4.052584e-02 1 1  ON 33
eH1_4                 7.827170e-03 1 1  ON 34
eH1_5                 4.192496e-02 1 1  ON 35
eH1_6                 9.952476e-02 1 1  ON 36
eH1_7                 1.520109e-01 1 1  ON 37
eH1_8                 1.700591e-01 1 1  ON 38
eH1_9                 5.624073e-02 1 1  ON 39
eH2_0                -2.436720e-01 1 1  ON 40
eH2_1                -1.401747e-01 1 1  ON 41
eH2_2                -9.248716e-02 1 1  ON 42
eH2_3                -3.836720e-02 1 1  ON 43
eH2_4                 1.030544e-02 1 1  ON 44
eH2_5                 4.517015e-02 1 1  ON 45
eH2_6                 1.022500e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755838e-01 1 1  ON 48
eH2_9                 4.232784e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8783e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.7999
    reference variance = 0.567315
====================================================
  Execution time = 2.0823e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4813e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6738e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348015778943
                                         uncertainty =       0.010960344187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348015778943
                                         uncertainty =       0.010960344187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417211262
  error estimate for blocks of size 2^( 2) =       0.000429849409
  error estimate for blocks of size 2^( 3) =       0.000442403814
  error estimate for blocks of size 2^( 4) =       0.000454082197
  error estimate for blocks of size 2^( 5) =       0.000464239040
  error estimate for blocks of size 2^( 6) =       0.000471607129
  error estimate for blocks of size 2^( 7) =       0.000474792180

      target function =                  N/A
              le_mean =     -16.906458422789
             les_mean =     286.176466702399
             stat err =       0.000466180137
             autocorr =       1.248519939429
              std dev =       0.590025825676
             le_variance =       0.348130474965


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690645842279e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906458422789       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906458422792       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906458422785       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906458422766       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906458422733       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906458422735       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906458422725       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906458422748       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 6.622109e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906458422789       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906458422790       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906458422788       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906458422787       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906458422760       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906458422765       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906458422853       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906458422588       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.655540e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906458422789       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906458422789       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906458422789       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906458422788       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906458422810       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906458425465       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906458422912       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906458422662       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 4.138870e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183235 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6508e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212943e-02 1 1  ON 2
 uu_3                -2.019562e-02 1 1  ON 3
 uu_4                -6.550938e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325667e-01 1 1  ON 8
 uu_9                -1.013149e-01 1 1  ON 9
 ud_0                 4.478560e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129355e-02 1 1  ON 12
 ud_3                -9.868204e-03 1 1  ON 13
 ud_4                -6.668004e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348458e-01 1 1  ON 16
 ud_7                -1.505163e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391026e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359628e-01 1 1  ON 21
 eO_2                -1.918643e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813433e-01 1 1  ON 25
 eO_6                 2.507118e-01 1 1  ON 26
 eO_7                -4.785450e-02 1 1  ON 27
 eO_8                -2.154429e-01 1 1  ON 28
 eO_9                -7.587978e-02 1 1  ON 29
eH1_0                -2.453820e-01 1 1  ON 30
eH1_1                -1.425498e-01 1 1  ON 31
eH1_2                -9.509241e-02 1 1  ON 32
eH1_3                -4.052584e-02 1 1  ON 33
eH1_4                 7.827169e-03 1 1  ON 34
eH1_5                 4.192496e-02 1 1  ON 35
eH1_6                 9.952476e-02 1 1  ON 36
eH1_7                 1.520109e-01 1 1  ON 37
eH1_8                 1.700591e-01 1 1  ON 38
eH1_9                 5.624073e-02 1 1  ON 39
eH2_0                -2.436720e-01 1 1  ON 40
eH2_1                -1.401747e-01 1 1  ON 41
eH2_2                -9.248716e-02 1 1  ON 42
eH2_3                -3.836720e-02 1 1  ON 43
eH2_4                 1.030544e-02 1 1  ON 44
eH2_5                 4.517015e-02 1 1  ON 45
eH2_6                 1.022500e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755838e-01 1 1  ON 48
eH2_9                 4.232784e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.941
    reference variance = 0.841079
====================================================
  Execution time = 2.0801e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4651e-01
  Total weights = 2.0000e+06
  Execution time = 1.8605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346482824158
                                         uncertainty =       0.008065859390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346482824158
                                         uncertainty =       0.008065859390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416237460
  error estimate for blocks of size 2^( 2) =       0.000428142503
  error estimate for blocks of size 2^( 3) =       0.000441471056
  error estimate for blocks of size 2^( 4) =       0.000453767548
  error estimate for blocks of size 2^( 5) =       0.000462506275
  error estimate for blocks of size 2^( 6) =       0.000470999937
  error estimate for blocks of size 2^( 7) =       0.000473670935

      target function =                  N/A
              le_mean =     -16.906789699117
             les_mean =     286.186045002929
             stat err =       0.000465236174
             autocorr =       1.249293917112
              std dev =       0.588648660926
             le_variance =       0.346507246010

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346482827786
                                         uncertainty =       0.008065859271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346482827786
                                         uncertainty =       0.008065859271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416237462
  error estimate for blocks of size 2^( 2) =       0.000428142505
  error estimate for blocks of size 2^( 3) =       0.000441471058
  error estimate for blocks of size 2^( 4) =       0.000453767550
  error estimate for blocks of size 2^( 5) =       0.000462506277
  error estimate for blocks of size 2^( 6) =       0.000470999938
  error estimate for blocks of size 2^( 7) =       0.000473670937

      target function =                  N/A
              le_mean =     -16.906789699127
             les_mean =     286.186045006892
             stat err =       0.000465236175
             autocorr =       1.249293913551
              std dev =       0.588648664007
             le_variance =       0.346507249637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346482825972
                                         uncertainty =       0.008065859330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346482825972
                                         uncertainty =       0.008065859330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416237461
  error estimate for blocks of size 2^( 2) =       0.000428142504
  error estimate for blocks of size 2^( 3) =       0.000441471057
  error estimate for blocks of size 2^( 4) =       0.000453767549
  error estimate for blocks of size 2^( 5) =       0.000462506276
  error estimate for blocks of size 2^( 6) =       0.000470999938
  error estimate for blocks of size 2^( 7) =       0.000473670936

      target function =                  N/A
              le_mean =     -16.906789699122
             les_mean =     286.186045004911
             stat err =       0.000465236175
             autocorr =       1.249293915324
              std dev =       0.588648662466
             le_variance =       0.346507247823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346482824384
                                         uncertainty =       0.008065859382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346482824384
                                         uncertainty =       0.008065859382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416237460
  error estimate for blocks of size 2^( 2) =       0.000428142503
  error estimate for blocks of size 2^( 3) =       0.000441471056
  error estimate for blocks of size 2^( 4) =       0.000453767548
  error estimate for blocks of size 2^( 5) =       0.000462506275
  error estimate for blocks of size 2^( 6) =       0.000470999937
  error estimate for blocks of size 2^( 7) =       0.000473670935

      target function =                  N/A
              le_mean =     -16.906789699118
             les_mean =     286.186045003177
             stat err =       0.000465236174
             autocorr =       1.249293916887
              std dev =       0.588648661118
             le_variance =       0.346507246236


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906789699117        initial
     3.7253e+04     3.7253e+05             6.6221e-09       -16.906789699127  <--
     1.4901e+05     1.4901e+06             1.6555e-09       -16.906789699122
     5.9605e+05     5.9605e+06             4.1389e-10       -16.906789699118

*****************************************************************************
Applying the update for shift_i =   3.7253e+04     and shift_s =   3.7253e+05
*****************************************************************************

  Execution time = 3.0247e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212943e-02 1 1  ON 2
 uu_3                -2.019562e-02 1 1  ON 3
 uu_4                -6.550938e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325667e-01 1 1  ON 8
 uu_9                -1.013149e-01 1 1  ON 9
 ud_0                 4.478560e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129356e-02 1 1  ON 12
 ud_3                -9.868204e-03 1 1  ON 13
 ud_4                -6.668004e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348458e-01 1 1  ON 16
 ud_7                -1.505163e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391026e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359628e-01 1 1  ON 21
 eO_2                -1.918643e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813433e-01 1 1  ON 25
 eO_6                 2.507118e-01 1 1  ON 26
 eO_7                -4.785450e-02 1 1  ON 27
 eO_8                -2.154429e-01 1 1  ON 28
 eO_9                -7.587978e-02 1 1  ON 29
eH1_0                -2.453820e-01 1 1  ON 30
eH1_1                -1.425498e-01 1 1  ON 31
eH1_2                -9.509241e-02 1 1  ON 32
eH1_3                -4.052584e-02 1 1  ON 33
eH1_4                 7.827167e-03 1 1  ON 34
eH1_5                 4.192496e-02 1 1  ON 35
eH1_6                 9.952476e-02 1 1  ON 36
eH1_7                 1.520109e-01 1 1  ON 37
eH1_8                 1.700591e-01 1 1  ON 38
eH1_9                 5.624073e-02 1 1  ON 39
eH2_0                -2.436720e-01 1 1  ON 40
eH2_1                -1.401747e-01 1 1  ON 41
eH2_2                -9.248716e-02 1 1  ON 42
eH2_3                -3.836720e-02 1 1  ON 43
eH2_4                 1.030544e-02 1 1  ON 44
eH2_5                 4.517015e-02 1 1  ON 45
eH2_6                 1.022500e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755838e-01 1 1  ON 48
eH2_9                 4.232784e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7339e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8795
    reference variance = 0.25784
====================================================
  Execution time = 2.1106e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4103e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5202e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341049632541
                                         uncertainty =       0.005069857104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341049632541
                                         uncertainty =       0.005069857104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412937438
  error estimate for blocks of size 2^( 2) =       0.000425471788
  error estimate for blocks of size 2^( 3) =       0.000438607369
  error estimate for blocks of size 2^( 4) =       0.000450320984
  error estimate for blocks of size 2^( 5) =       0.000459683943
  error estimate for blocks of size 2^( 6) =       0.000465518874
  error estimate for blocks of size 2^( 7) =       0.000471226627

      target function =                  N/A
              le_mean =     -16.906448866309
             les_mean =     286.169047754407
             stat err =       0.000461687607
             autocorr =       1.250051528306
              std dev =       0.583981725567
             le_variance =       0.341034655797


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690644886631e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906448866309       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906448866361       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906448866456       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906448866475       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906448866498       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906448866503       residual = 9.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906448866487       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906448866501       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.473844e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906448866309       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906448866322       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906448866346       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906448866351       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906448866354       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906448866320       residual = 9.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906448866353       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906448866313       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 6.184615e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906448866309       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906448866312       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906448866318       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906448866307       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906448866320       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906448866377       residual = 9.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906448866328       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906448866375       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.546154e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185904 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6637e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212943e-02 1 1  ON 2
 uu_3                -2.019562e-02 1 1  ON 3
 uu_4                -6.550937e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325667e-01 1 1  ON 8
 uu_9                -1.013149e-01 1 1  ON 9
 ud_0                 4.478560e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129356e-02 1 1  ON 12
 ud_3                -9.868203e-03 1 1  ON 13
 ud_4                -6.668004e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348458e-01 1 1  ON 16
 ud_7                -1.505163e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391026e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359628e-01 1 1  ON 21
 eO_2                -1.918643e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813433e-01 1 1  ON 25
 eO_6                 2.507118e-01 1 1  ON 26
 eO_7                -4.785449e-02 1 1  ON 27
 eO_8                -2.154429e-01 1 1  ON 28
 eO_9                -7.587979e-02 1 1  ON 29
eH1_0                -2.453820e-01 1 1  ON 30
eH1_1                -1.425498e-01 1 1  ON 31
eH1_2                -9.509241e-02 1 1  ON 32
eH1_3                -4.052584e-02 1 1  ON 33
eH1_4                 7.827166e-03 1 1  ON 34
eH1_5                 4.192496e-02 1 1  ON 35
eH1_6                 9.952476e-02 1 1  ON 36
eH1_7                 1.520109e-01 1 1  ON 37
eH1_8                 1.700591e-01 1 1  ON 38
eH1_9                 5.624074e-02 1 1  ON 39
eH2_0                -2.436720e-01 1 1  ON 40
eH2_1                -1.401747e-01 1 1  ON 41
eH2_2                -9.248716e-02 1 1  ON 42
eH2_3                -3.836720e-02 1 1  ON 43
eH2_4                 1.030543e-02 1 1  ON 44
eH2_5                 4.517015e-02 1 1  ON 45
eH2_6                 1.022500e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755838e-01 1 1  ON 48
eH2_9                 4.232785e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9642
    reference variance = 0.288949
====================================================
  Execution time = 2.0315e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4029e-01
  Total weights = 2.0000e+06
  Execution time = 1.8697e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340391708263
                                         uncertainty =       0.005053877678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340391708263
                                         uncertainty =       0.005053877678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412484022
  error estimate for blocks of size 2^( 2) =       0.000425041610
  error estimate for blocks of size 2^( 3) =       0.000437398019
  error estimate for blocks of size 2^( 4) =       0.000449224035
  error estimate for blocks of size 2^( 5) =       0.000459108776
  error estimate for blocks of size 2^( 6) =       0.000467475357
  error estimate for blocks of size 2^( 7) =       0.000471617967

      target function =                  N/A
              le_mean =     -16.906976093974
             les_mean =     286.186126608188
             stat err =       0.000461856534
             autocorr =       1.253718181489
              std dev =       0.583340497589
             le_variance =       0.340286136128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340391705720
                                         uncertainty =       0.005053877596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340391705720
                                         uncertainty =       0.005053877596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412484020
  error estimate for blocks of size 2^( 2) =       0.000425041609
  error estimate for blocks of size 2^( 3) =       0.000437398017
  error estimate for blocks of size 2^( 4) =       0.000449224034
  error estimate for blocks of size 2^( 5) =       0.000459108775
  error estimate for blocks of size 2^( 6) =       0.000467475356
  error estimate for blocks of size 2^( 7) =       0.000471617966

      target function =                  N/A
              le_mean =     -16.906976094016
             les_mean =     286.186126607068
             stat err =       0.000461856533
             autocorr =       1.253718185706
              std dev =       0.583340495406
             le_variance =       0.340286133581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340391706991
                                         uncertainty =       0.005053877637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340391706991
                                         uncertainty =       0.005053877637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412484021
  error estimate for blocks of size 2^( 2) =       0.000425041610
  error estimate for blocks of size 2^( 3) =       0.000437398018
  error estimate for blocks of size 2^( 4) =       0.000449224035
  error estimate for blocks of size 2^( 5) =       0.000459108776
  error estimate for blocks of size 2^( 6) =       0.000467475356
  error estimate for blocks of size 2^( 7) =       0.000471617967

      target function =                  N/A
              le_mean =     -16.906976093995
             les_mean =     286.186126607628
             stat err =       0.000461856533
             autocorr =       1.253718183597
              std dev =       0.583340496498
             le_variance =       0.340286134854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340391708104
                                         uncertainty =       0.005053877673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340391708104
                                         uncertainty =       0.005053877673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412484021
  error estimate for blocks of size 2^( 2) =       0.000425041610
  error estimate for blocks of size 2^( 3) =       0.000437398019
  error estimate for blocks of size 2^( 4) =       0.000449224035
  error estimate for blocks of size 2^( 5) =       0.000459108776
  error estimate for blocks of size 2^( 6) =       0.000467475357
  error estimate for blocks of size 2^( 7) =       0.000471617967

      target function =                  N/A
              le_mean =     -16.906976093976
             les_mean =     286.186126608118
             stat err =       0.000461856534
             autocorr =       1.253718181748
              std dev =       0.583340497453
             le_variance =       0.340286135969


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906976093974        initial
     9.3132e+03     9.3132e+04             2.4738e-08       -16.906976094016  <--
     3.7253e+04     3.7253e+05             6.1846e-09       -16.906976093995
     1.4901e+05     1.4901e+06             1.5462e-09       -16.906976093976

*****************************************************************************
Applying the update for shift_i =   9.3132e+03     and shift_s =   9.3132e+04
*****************************************************************************

  Execution time = 2.9875e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212944e-02 1 1  ON 2
 uu_3                -2.019562e-02 1 1  ON 3
 uu_4                -6.550936e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325667e-01 1 1  ON 8
 uu_9                -1.013149e-01 1 1  ON 9
 ud_0                 4.478560e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129357e-02 1 1  ON 12
 ud_3                -9.868200e-03 1 1  ON 13
 ud_4                -6.668005e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348458e-01 1 1  ON 16
 ud_7                -1.505163e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391026e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359628e-01 1 1  ON 21
 eO_2                -1.918644e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813433e-01 1 1  ON 25
 eO_6                 2.507119e-01 1 1  ON 26
 eO_7                -4.785449e-02 1 1  ON 27
 eO_8                -2.154429e-01 1 1  ON 28
 eO_9                -7.587980e-02 1 1  ON 29
eH1_0                -2.453820e-01 1 1  ON 30
eH1_1                -1.425499e-01 1 1  ON 31
eH1_2                -9.509241e-02 1 1  ON 32
eH1_3                -4.052584e-02 1 1  ON 33
eH1_4                 7.827161e-03 1 1  ON 34
eH1_5                 4.192497e-02 1 1  ON 35
eH1_6                 9.952476e-02 1 1  ON 36
eH1_7                 1.520109e-01 1 1  ON 37
eH1_8                 1.700591e-01 1 1  ON 38
eH1_9                 5.624075e-02 1 1  ON 39
eH2_0                -2.436720e-01 1 1  ON 40
eH2_1                -1.401747e-01 1 1  ON 41
eH2_2                -9.248717e-02 1 1  ON 42
eH2_3                -3.836721e-02 1 1  ON 43
eH2_4                 1.030543e-02 1 1  ON 44
eH2_5                 4.517015e-02 1 1  ON 45
eH2_6                 1.022500e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755838e-01 1 1  ON 48
eH2_9                 4.232787e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6577e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8517
    reference variance = 0.312228
====================================================
  Execution time = 2.0807e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5146e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351566315614
                                         uncertainty =       0.009693676369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351566315614
                                         uncertainty =       0.009693676369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419201491
  error estimate for blocks of size 2^( 2) =       0.000431861188
  error estimate for blocks of size 2^( 3) =       0.000445098798
  error estimate for blocks of size 2^( 4) =       0.000456365540
  error estimate for blocks of size 2^( 5) =       0.000467064466
  error estimate for blocks of size 2^( 6) =       0.000476067060
  error estimate for blocks of size 2^( 7) =       0.000480454442

      target function =                  N/A
              le_mean =     -16.906260872035
             les_mean =     286.173116277409
             stat err =       0.000469987877
             autocorr =       1.256977993346
              std dev =       0.592840433711
             le_variance =       0.351459779842


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690626087203e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906260872035       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906260872321       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906260872145       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906260872453       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906260872430       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906260872456       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906260872501       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906260872458       residual = 5.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 9.581140e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906260872035       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906260872106       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906260872062       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906260872138       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906260872139       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906260872140       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906260872153       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906260872142       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.395328e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906260872035       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906260872053       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906260872042       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906260872064       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906260872019       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906260872044       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906260872050       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906260872069       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 5.988346e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188495 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6382e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212944e-02 1 1  ON 2
 uu_3                -2.019562e-02 1 1  ON 3
 uu_4                -6.550935e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325667e-01 1 1  ON 8
 uu_9                -1.013149e-01 1 1  ON 9
 ud_0                 4.478560e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129357e-02 1 1  ON 12
 ud_3                -9.868198e-03 1 1  ON 13
 ud_4                -6.668004e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348459e-01 1 1  ON 16
 ud_7                -1.505164e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391026e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359628e-01 1 1  ON 21
 eO_2                -1.918645e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813433e-01 1 1  ON 25
 eO_6                 2.507119e-01 1 1  ON 26
 eO_7                -4.785449e-02 1 1  ON 27
 eO_8                -2.154429e-01 1 1  ON 28
 eO_9                -7.587981e-02 1 1  ON 29
eH1_0                -2.453820e-01 1 1  ON 30
eH1_1                -1.425499e-01 1 1  ON 31
eH1_2                -9.509242e-02 1 1  ON 32
eH1_3                -4.052586e-02 1 1  ON 33
eH1_4                 7.827166e-03 1 1  ON 34
eH1_5                 4.192497e-02 1 1  ON 35
eH1_6                 9.952477e-02 1 1  ON 36
eH1_7                 1.520109e-01 1 1  ON 37
eH1_8                 1.700591e-01 1 1  ON 38
eH1_9                 5.624077e-02 1 1  ON 39
eH2_0                -2.436720e-01 1 1  ON 40
eH2_1                -1.401747e-01 1 1  ON 41
eH2_2                -9.248719e-02 1 1  ON 42
eH2_3                -3.836719e-02 1 1  ON 43
eH2_4                 1.030543e-02 1 1  ON 44
eH2_5                 4.517014e-02 1 1  ON 45
eH2_6                 1.022499e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755838e-01 1 1  ON 48
eH2_9                 4.232789e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8107
    reference variance = 0.374565
====================================================
  Execution time = 2.0523e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3511e-01
  Total weights = 2.0000e+06
  Execution time = 1.8710e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335142422750
                                         uncertainty =       0.003779376644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335142422750
                                         uncertainty =       0.003779376644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409333276
  error estimate for blocks of size 2^( 2) =       0.000422256035
  error estimate for blocks of size 2^( 3) =       0.000435931369
  error estimate for blocks of size 2^( 4) =       0.000448643051
  error estimate for blocks of size 2^( 5) =       0.000457322985
  error estimate for blocks of size 2^( 6) =       0.000466480886
  error estimate for blocks of size 2^( 7) =       0.000472426492

      target function =                  N/A
              le_mean =     -16.906850183377
             les_mean =     286.176690416513
             stat err =       0.000461218354
             autocorr =       1.269577044620
              std dev =       0.578884669782
             le_variance =       0.335107460909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335142433791
                                         uncertainty =       0.003779376527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335142433791
                                         uncertainty =       0.003779376527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409333282
  error estimate for blocks of size 2^( 2) =       0.000422256041
  error estimate for blocks of size 2^( 3) =       0.000435931374
  error estimate for blocks of size 2^( 4) =       0.000448643056
  error estimate for blocks of size 2^( 5) =       0.000457322990
  error estimate for blocks of size 2^( 6) =       0.000466480891
  error estimate for blocks of size 2^( 7) =       0.000472426496

      target function =                  N/A
              le_mean =     -16.906850183460
             les_mean =     286.176690430342
             stat err =       0.000461218358
             autocorr =       1.269577026549
              std dev =       0.578884679309
             le_variance =       0.335107471939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335142428271
                                         uncertainty =       0.003779376585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335142428271
                                         uncertainty =       0.003779376585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409333279
  error estimate for blocks of size 2^( 2) =       0.000422256038
  error estimate for blocks of size 2^( 3) =       0.000435931372
  error estimate for blocks of size 2^( 4) =       0.000448643054
  error estimate for blocks of size 2^( 5) =       0.000457322988
  error estimate for blocks of size 2^( 6) =       0.000466480888
  error estimate for blocks of size 2^( 7) =       0.000472426494

      target function =                  N/A
              le_mean =     -16.906850183418
             les_mean =     286.176690423427
             stat err =       0.000461218356
             autocorr =       1.269577035585
              std dev =       0.578884674546
             le_variance =       0.335107466424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335142423440
                                         uncertainty =       0.003779376636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335142423440
                                         uncertainty =       0.003779376636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409333276
  error estimate for blocks of size 2^( 2) =       0.000422256036
  error estimate for blocks of size 2^( 3) =       0.000435931369
  error estimate for blocks of size 2^( 4) =       0.000448643052
  error estimate for blocks of size 2^( 5) =       0.000457322986
  error estimate for blocks of size 2^( 6) =       0.000466480886
  error estimate for blocks of size 2^( 7) =       0.000472426493

      target function =                  N/A
              le_mean =     -16.906850183382
             les_mean =     286.176690417377
             stat err =       0.000461218354
             autocorr =       1.269577043491
              std dev =       0.578884670378
             le_variance =       0.335107461598


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906850183377        initial
     2.3283e+03     2.3283e+04             9.5811e-08       -16.906850183460  <--
     9.3132e+03     9.3132e+04             2.3953e-08       -16.906850183418
     3.7253e+04     3.7253e+05             5.9883e-09       -16.906850183382

*****************************************************************************
Applying the update for shift_i =   2.3283e+03     and shift_s =   2.3283e+04
*****************************************************************************

  Execution time = 3.0030e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436003e-01 1 1  ON 1
 uu_2                 4.212944e-02 1 1  ON 2
 uu_3                -2.019563e-02 1 1  ON 3
 uu_4                -6.550932e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270521e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325668e-01 1 1  ON 8
 uu_9                -1.013150e-01 1 1  ON 9
 ud_0                 4.478561e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129358e-02 1 1  ON 12
 ud_3                -9.868189e-03 1 1  ON 13
 ud_4                -6.668002e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348459e-01 1 1  ON 16
 ud_7                -1.505164e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391026e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359627e-01 1 1  ON 21
 eO_2                -1.918645e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813433e-01 1 1  ON 25
 eO_6                 2.507119e-01 1 1  ON 26
 eO_7                -4.785448e-02 1 1  ON 27
 eO_8                -2.154430e-01 1 1  ON 28
 eO_9                -7.587986e-02 1 1  ON 29
eH1_0                -2.453821e-01 1 1  ON 30
eH1_1                -1.425499e-01 1 1  ON 31
eH1_2                -9.509245e-02 1 1  ON 32
eH1_3                -4.052590e-02 1 1  ON 33
eH1_4                 7.827182e-03 1 1  ON 34
eH1_5                 4.192495e-02 1 1  ON 35
eH1_6                 9.952480e-02 1 1  ON 36
eH1_7                 1.520109e-01 1 1  ON 37
eH1_8                 1.700591e-01 1 1  ON 38
eH1_9                 5.624082e-02 1 1  ON 39
eH2_0                -2.436721e-01 1 1  ON 40
eH2_1                -1.401747e-01 1 1  ON 41
eH2_2                -9.248723e-02 1 1  ON 42
eH2_3                -3.836716e-02 1 1  ON 43
eH2_4                 1.030542e-02 1 1  ON 44
eH2_5                 4.517011e-02 1 1  ON 45
eH2_6                 1.022499e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755839e-01 1 1  ON 48
eH2_9                 4.232795e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6499e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8303
    reference variance = 0.210749
====================================================
  Execution time = 2.0387e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3720e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4928e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337149754279
                                         uncertainty =       0.004570997610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337149754279
                                         uncertainty =       0.004570997610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410610586
  error estimate for blocks of size 2^( 2) =       0.000423222614
  error estimate for blocks of size 2^( 3) =       0.000436355549
  error estimate for blocks of size 2^( 4) =       0.000448675093
  error estimate for blocks of size 2^( 5) =       0.000459175649
  error estimate for blocks of size 2^( 6) =       0.000466701829
  error estimate for blocks of size 2^( 7) =       0.000469935726

      target function =                  N/A
              le_mean =     -16.905598743358
             les_mean =     286.136470809188
             stat err =       0.000461122074
             autocorr =       1.261163932311
              std dev =       0.580691059310
             le_variance =       0.337202106362


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690559874336e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905598743358       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905598744643       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905598746642       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905598746051       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905598746269       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905598747196       residual = 6.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905598746817       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905598746846       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 4.155028e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905598743358       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905598743679       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905598744179       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905598744032       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905598744086       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905598744319       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905598744223       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905598744230       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 1.039267e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905598743358       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905598743438       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905598743563       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905598743526       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905598743538       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905598743594       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905598743577       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905598743599       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.598487e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191154 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5890e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212943e-02 1 1  ON 2
 uu_3                -2.019563e-02 1 1  ON 3
 uu_4                -6.550934e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325668e-01 1 1  ON 8
 uu_9                -1.013150e-01 1 1  ON 9
 ud_0                 4.478562e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129358e-02 1 1  ON 12
 ud_3                -9.868200e-03 1 1  ON 13
 ud_4                -6.667998e-02 1 1  ON 14
 ud_5                -1.077871e-01 1 1  ON 15
 ud_6                -1.348459e-01 1 1  ON 16
 ud_7                -1.505164e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391027e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359627e-01 1 1  ON 21
 eO_2                -1.918644e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813433e-01 1 1  ON 25
 eO_6                 2.507120e-01 1 1  ON 26
 eO_7                -4.785445e-02 1 1  ON 27
 eO_8                -2.154430e-01 1 1  ON 28
 eO_9                -7.587991e-02 1 1  ON 29
eH1_0                -2.453822e-01 1 1  ON 30
eH1_1                -1.425499e-01 1 1  ON 31
eH1_2                -9.509244e-02 1 1  ON 32
eH1_3                -4.052594e-02 1 1  ON 33
eH1_4                 7.827186e-03 1 1  ON 34
eH1_5                 4.192495e-02 1 1  ON 35
eH1_6                 9.952478e-02 1 1  ON 36
eH1_7                 1.520110e-01 1 1  ON 37
eH1_8                 1.700592e-01 1 1  ON 38
eH1_9                 5.624090e-02 1 1  ON 39
eH2_0                -2.436721e-01 1 1  ON 40
eH2_1                -1.401748e-01 1 1  ON 41
eH2_2                -9.248731e-02 1 1  ON 42
eH2_3                -3.836718e-02 1 1  ON 43
eH2_4                 1.030535e-02 1 1  ON 44
eH2_5                 4.517012e-02 1 1  ON 45
eH2_6                 1.022499e-01 1 1  ON 46
eH2_7                 1.551650e-01 1 1  ON 47
eH2_8                 1.755839e-01 1 1  ON 48
eH2_9                 4.232805e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8992
    reference variance = 0.189955
====================================================
  Execution time = 2.0199e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3036e-01
  Total weights = 2.0000e+06
  Execution time = 1.8635e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330483734180
                                         uncertainty =       0.002963524729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330483734180
                                         uncertainty =       0.002963524729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406423057
  error estimate for blocks of size 2^( 2) =       0.000419466721
  error estimate for blocks of size 2^( 3) =       0.000432370208
  error estimate for blocks of size 2^( 4) =       0.000444900749
  error estimate for blocks of size 2^( 5) =       0.000455498541
  error estimate for blocks of size 2^( 6) =       0.000463563748
  error estimate for blocks of size 2^( 7) =       0.000468425145

      target function =                  N/A
              le_mean =     -16.906844994461
             les_mean =     286.171766903696
             stat err =       0.000458097046
             autocorr =       1.270452132867
              std dev =       0.574768998936
             le_variance =       0.330359402138

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330484179215
                                         uncertainty =       0.002963527854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330484179215
                                         uncertainty =       0.002963527854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406423330
  error estimate for blocks of size 2^( 2) =       0.000419466979
  error estimate for blocks of size 2^( 3) =       0.000432370451
  error estimate for blocks of size 2^( 4) =       0.000444900983
  error estimate for blocks of size 2^( 5) =       0.000455498766
  error estimate for blocks of size 2^( 6) =       0.000463563966
  error estimate for blocks of size 2^( 7) =       0.000468425369

      target function =                  N/A
              le_mean =     -16.906844993800
             les_mean =     286.171767326157
             stat err =       0.000458097271
             autocorr =       1.270451670774
              std dev =       0.574769385886
             le_variance =       0.330359846952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330483956810
                                         uncertainty =       0.002963526292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330483956810
                                         uncertainty =       0.002963526292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406423194
  error estimate for blocks of size 2^( 2) =       0.000419466850
  error estimate for blocks of size 2^( 3) =       0.000432370330
  error estimate for blocks of size 2^( 4) =       0.000444900866
  error estimate for blocks of size 2^( 5) =       0.000455498654
  error estimate for blocks of size 2^( 6) =       0.000463563857
  error estimate for blocks of size 2^( 7) =       0.000468425257

      target function =                  N/A
              le_mean =     -16.906844994130
             les_mean =     286.171767115030
             stat err =       0.000458097159
             autocorr =       1.270451901707
              std dev =       0.574769192509
             le_variance =       0.330359624658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330483762012
                                         uncertainty =       0.002963524924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330483762012
                                         uncertainty =       0.002963524924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406423074
  error estimate for blocks of size 2^( 2) =       0.000419466737
  error estimate for blocks of size 2^( 3) =       0.000432370224
  error estimate for blocks of size 2^( 4) =       0.000444900764
  error estimate for blocks of size 2^( 5) =       0.000455498555
  error estimate for blocks of size 2^( 6) =       0.000463563762
  error estimate for blocks of size 2^( 7) =       0.000468425159

      target function =                  N/A
              le_mean =     -16.906844994420
             les_mean =     286.171766930116
             stat err =       0.000458097060
             autocorr =       1.270452103962
              std dev =       0.574769023136
             le_variance =       0.330359429956


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906844994461        initial  <--
     5.8208e+02     5.8208e+03             4.1550e-07       -16.906844993800
     2.3283e+03     2.3283e+04             1.0393e-07       -16.906844994130
     9.3132e+03     9.3132e+04             2.5985e-08       -16.906844994420

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6670
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436003e-01 1 1  ON 1
 uu_2                 4.212944e-02 1 1  ON 2
 uu_3                -2.019563e-02 1 1  ON 3
 uu_4                -6.550932e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270521e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325668e-01 1 1  ON 8
 uu_9                -1.013150e-01 1 1  ON 9
 ud_0                 4.478561e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129358e-02 1 1  ON 12
 ud_3                -9.868189e-03 1 1  ON 13
 ud_4                -6.668002e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348459e-01 1 1  ON 16
 ud_7                -1.505164e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391026e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359627e-01 1 1  ON 21
 eO_2                -1.918645e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813433e-01 1 1  ON 25
 eO_6                 2.507119e-01 1 1  ON 26
 eO_7                -4.785448e-02 1 1  ON 27
 eO_8                -2.154430e-01 1 1  ON 28
 eO_9                -7.587986e-02 1 1  ON 29
eH1_0                -2.453821e-01 1 1  ON 30
eH1_1                -1.425499e-01 1 1  ON 31
eH1_2                -9.509245e-02 1 1  ON 32
eH1_3                -4.052590e-02 1 1  ON 33
eH1_4                 7.827182e-03 1 1  ON 34
eH1_5                 4.192495e-02 1 1  ON 35
eH1_6                 9.952480e-02 1 1  ON 36
eH1_7                 1.520109e-01 1 1  ON 37
eH1_8                 1.700591e-01 1 1  ON 38
eH1_9                 5.624082e-02 1 1  ON 39
eH2_0                -2.436721e-01 1 1  ON 40
eH2_1                -1.401747e-01 1 1  ON 41
eH2_2                -9.248723e-02 1 1  ON 42
eH2_3                -3.836716e-02 1 1  ON 43
eH2_4                 1.030542e-02 1 1  ON 44
eH2_5                 4.517011e-02 1 1  ON 45
eH2_6                 1.022499e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755839e-01 1 1  ON 48
eH2_9                 4.232795e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5610e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8894
    reference variance = 0.146935
====================================================
  Execution time = 2.2359e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5627e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4731e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356333853001
                                         uncertainty =       0.018464156474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356333853001
                                         uncertainty =       0.018464156474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422060100
  error estimate for blocks of size 2^( 2) =       0.000434497664
  error estimate for blocks of size 2^( 3) =       0.000447906156
  error estimate for blocks of size 2^( 4) =       0.000459241794
  error estimate for blocks of size 2^( 5) =       0.000469742504
  error estimate for blocks of size 2^( 6) =       0.000477161779
  error estimate for blocks of size 2^( 7) =       0.000481101670

      target function =                  N/A
              le_mean =     -16.905848430978
             les_mean =     286.163980448771
             stat err =       0.000471811937
             autocorr =       1.249652477149
              std dev =       0.596883117283
             le_variance =       0.356269455697


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690584843098e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905848430978       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905848431060       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905848431031       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905848431048       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905848431053       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905848431101       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905848431108       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905848431097       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 3.783319e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905848430978       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905848430999       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905848430992       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905848430996       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905848430997       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905848430999       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905848431013       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905848431010       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 9.458311e-09

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905848430978       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905848430983       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905848430982       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905848430983       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905848430936       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905848431002       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905848430930       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905848431009       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.364579e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.193773 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7843e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436003e-01 1 1  ON 1
 uu_2                 4.212944e-02 1 1  ON 2
 uu_3                -2.019563e-02 1 1  ON 3
 uu_4                -6.550932e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270521e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325668e-01 1 1  ON 8
 uu_9                -1.013150e-01 1 1  ON 9
 ud_0                 4.478561e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129358e-02 1 1  ON 12
 ud_3                -9.868188e-03 1 1  ON 13
 ud_4                -6.668002e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348459e-01 1 1  ON 16
 ud_7                -1.505164e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391026e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359627e-01 1 1  ON 21
 eO_2                -1.918645e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813433e-01 1 1  ON 25
 eO_6                 2.507119e-01 1 1  ON 26
 eO_7                -4.785447e-02 1 1  ON 27
 eO_8                -2.154430e-01 1 1  ON 28
 eO_9                -7.587986e-02 1 1  ON 29
eH1_0                -2.453821e-01 1 1  ON 30
eH1_1                -1.425499e-01 1 1  ON 31
eH1_2                -9.509245e-02 1 1  ON 32
eH1_3                -4.052591e-02 1 1  ON 33
eH1_4                 7.827179e-03 1 1  ON 34
eH1_5                 4.192495e-02 1 1  ON 35
eH1_6                 9.952480e-02 1 1  ON 36
eH1_7                 1.520110e-01 1 1  ON 37
eH1_8                 1.700591e-01 1 1  ON 38
eH1_9                 5.624083e-02 1 1  ON 39
eH2_0                -2.436721e-01 1 1  ON 40
eH2_1                -1.401747e-01 1 1  ON 41
eH2_2                -9.248723e-02 1 1  ON 42
eH2_3                -3.836716e-02 1 1  ON 43
eH2_4                 1.030541e-02 1 1  ON 44
eH2_5                 4.517012e-02 1 1  ON 45
eH2_6                 1.022499e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755839e-01 1 1  ON 48
eH2_9                 4.232796e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.907
    reference variance = 0.435162
====================================================
  Execution time = 2.0231e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3457e-01
  Total weights = 2.0000e+06
  Execution time = 1.8509e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334554122620
                                         uncertainty =       0.002848552934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334554122620
                                         uncertainty =       0.002848552934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409002776
  error estimate for blocks of size 2^( 2) =       0.000421659704
  error estimate for blocks of size 2^( 3) =       0.000434276197
  error estimate for blocks of size 2^( 4) =       0.000446721037
  error estimate for blocks of size 2^( 5) =       0.000457008269
  error estimate for blocks of size 2^( 6) =       0.000465959592
  error estimate for blocks of size 2^( 7) =       0.000468544887

      target function =                  N/A
              le_mean =     -16.906075322399
             les_mean =     286.149949180470
             stat err =       0.000459558446
             autocorr =       1.262493045327
              std dev =       0.578417272510
             le_variance =       0.334566541138

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334554132738
                                         uncertainty =       0.002848553136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334554132738
                                         uncertainty =       0.002848553136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409002782
  error estimate for blocks of size 2^( 2) =       0.000421659710
  error estimate for blocks of size 2^( 3) =       0.000434276202
  error estimate for blocks of size 2^( 4) =       0.000446721043
  error estimate for blocks of size 2^( 5) =       0.000457008274
  error estimate for blocks of size 2^( 6) =       0.000465959597
  error estimate for blocks of size 2^( 7) =       0.000468544892

      target function =                  N/A
              le_mean =     -16.906075322501
             les_mean =     286.149949194013
             stat err =       0.000459558451
             autocorr =       1.262493034538
              std dev =       0.578417281235
             le_variance =       0.334566551232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334554127679
                                         uncertainty =       0.002848553035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334554127679
                                         uncertainty =       0.002848553035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409002779
  error estimate for blocks of size 2^( 2) =       0.000421659707
  error estimate for blocks of size 2^( 3) =       0.000434276200
  error estimate for blocks of size 2^( 4) =       0.000446721040
  error estimate for blocks of size 2^( 5) =       0.000457008272
  error estimate for blocks of size 2^( 6) =       0.000465959595
  error estimate for blocks of size 2^( 7) =       0.000468544890

      target function =                  N/A
              le_mean =     -16.906075322450
             les_mean =     286.149949187242
             stat err =       0.000459558449
             autocorr =       1.262493039938
              std dev =       0.578417276873
             le_variance =       0.334566546185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334554123252
                                         uncertainty =       0.002848552946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334554123252
                                         uncertainty =       0.002848552946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409002776
  error estimate for blocks of size 2^( 2) =       0.000421659705
  error estimate for blocks of size 2^( 3) =       0.000434276197
  error estimate for blocks of size 2^( 4) =       0.000446721038
  error estimate for blocks of size 2^( 5) =       0.000457008269
  error estimate for blocks of size 2^( 6) =       0.000465959592
  error estimate for blocks of size 2^( 7) =       0.000468544888

      target function =                  N/A
              le_mean =     -16.906075322405
             les_mean =     286.149949181316
             stat err =       0.000459558447
             autocorr =       1.262493044660
              std dev =       0.578417273055
             le_variance =       0.334566541768


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906075322399        initial
     5.8208e+03     5.8208e+04             3.7833e-08       -16.906075322501  <--
     2.3283e+04     2.3283e+05             9.4583e-09       -16.906075322450
     9.3132e+04     9.3132e+05             2.3646e-09       -16.906075322405

*****************************************************************************
Applying the update for shift_i =   5.8208e+03     and shift_s =   5.8208e+04
*****************************************************************************

  Execution time = 2.9571e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436003e-01 1 1  ON 1
 uu_2                 4.212945e-02 1 1  ON 2
 uu_3                -2.019563e-02 1 1  ON 3
 uu_4                -6.550933e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325668e-01 1 1  ON 8
 uu_9                -1.013150e-01 1 1  ON 9
 ud_0                 4.478561e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129359e-02 1 1  ON 12
 ud_3                -9.868184e-03 1 1  ON 13
 ud_4                -6.668002e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348459e-01 1 1  ON 16
 ud_7                -1.505164e-01 1 1  ON 17
 ud_8                -1.510945e-01 1 1  ON 18
 ud_9                -1.391027e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359628e-01 1 1  ON 21
 eO_2                -1.918644e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813433e-01 1 1  ON 25
 eO_6                 2.507119e-01 1 1  ON 26
 eO_7                -4.785447e-02 1 1  ON 27
 eO_8                -2.154430e-01 1 1  ON 28
 eO_9                -7.587988e-02 1 1  ON 29
eH1_0                -2.453821e-01 1 1  ON 30
eH1_1                -1.425499e-01 1 1  ON 31
eH1_2                -9.509243e-02 1 1  ON 32
eH1_3                -4.052593e-02 1 1  ON 33
eH1_4                 7.827169e-03 1 1  ON 34
eH1_5                 4.192494e-02 1 1  ON 35
eH1_6                 9.952479e-02 1 1  ON 36
eH1_7                 1.520110e-01 1 1  ON 37
eH1_8                 1.700592e-01 1 1  ON 38
eH1_9                 5.624086e-02 1 1  ON 39
eH2_0                -2.436721e-01 1 1  ON 40
eH2_1                -1.401748e-01 1 1  ON 41
eH2_2                -9.248723e-02 1 1  ON 42
eH2_3                -3.836716e-02 1 1  ON 43
eH2_4                 1.030540e-02 1 1  ON 44
eH2_5                 4.517012e-02 1 1  ON 45
eH2_6                 1.022499e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755839e-01 1 1  ON 48
eH2_9                 4.232798e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7848e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8834
    reference variance = 0.284804
====================================================
  Execution time = 2.1005e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3742e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6701e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337426789633
                                         uncertainty =       0.003115522995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337426789633
                                         uncertainty =       0.003115522995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410746150
  error estimate for blocks of size 2^( 2) =       0.000422782001
  error estimate for blocks of size 2^( 3) =       0.000435629017
  error estimate for blocks of size 2^( 4) =       0.000447663515
  error estimate for blocks of size 2^( 5) =       0.000456810627
  error estimate for blocks of size 2^( 6) =       0.000463753030
  error estimate for blocks of size 2^( 7) =       0.000469102190

      target function =                  N/A
              le_mean =     -16.905764312835
             les_mean =     286.142291631575
             stat err =       0.000459332341
             autocorr =       1.250567235100
              std dev =       0.580882775760
             le_variance =       0.337424799175


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690576431283e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905764312835       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905764312884       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905764313182       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905764313280       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905764313378       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905764313769       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905764313739       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905764313730       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 1.426651e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905764312835       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905764312847       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905764312922       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905764312946       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905764312971       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905764313077       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905764313063       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905764313055       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 3.566650e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905764312835       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905764312838       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905764312856       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905764312862       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905764312865       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905764312879       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905764312894       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905764312874       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 8.916639e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196404 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6686e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212946e-02 1 1  ON 2
 uu_3                -2.019563e-02 1 1  ON 3
 uu_4                -6.550931e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270521e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325668e-01 1 1  ON 8
 uu_9                -1.013150e-01 1 1  ON 9
 ud_0                 4.478561e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129361e-02 1 1  ON 12
 ud_3                -9.868164e-03 1 1  ON 13
 ud_4                -6.668000e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348459e-01 1 1  ON 16
 ud_7                -1.505164e-01 1 1  ON 17
 ud_8                -1.510945e-01 1 1  ON 18
 ud_9                -1.391027e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359627e-01 1 1  ON 21
 eO_2                -1.918644e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813433e-01 1 1  ON 25
 eO_6                 2.507120e-01 1 1  ON 26
 eO_7                -4.785445e-02 1 1  ON 27
 eO_8                -2.154430e-01 1 1  ON 28
 eO_9                -7.587991e-02 1 1  ON 29
eH1_0                -2.453821e-01 1 1  ON 30
eH1_1                -1.425499e-01 1 1  ON 31
eH1_2                -9.509243e-02 1 1  ON 32
eH1_3                -4.052595e-02 1 1  ON 33
eH1_4                 7.827173e-03 1 1  ON 34
eH1_5                 4.192494e-02 1 1  ON 35
eH1_6                 9.952479e-02 1 1  ON 36
eH1_7                 1.520110e-01 1 1  ON 37
eH1_8                 1.700592e-01 1 1  ON 38
eH1_9                 5.624088e-02 1 1  ON 39
eH2_0                -2.436721e-01 1 1  ON 40
eH2_1                -1.401748e-01 1 1  ON 41
eH2_2                -9.248724e-02 1 1  ON 42
eH2_3                -3.836715e-02 1 1  ON 43
eH2_4                 1.030539e-02 1 1  ON 44
eH2_5                 4.517013e-02 1 1  ON 45
eH2_6                 1.022499e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755839e-01 1 1  ON 48
eH2_9                 4.232802e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9791
    reference variance = 0.289114
====================================================
  Execution time = 2.0622e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4501e-01
  Total weights = 2.0000e+06
  Execution time = 1.8542e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345082957943
                                         uncertainty =       0.006867256388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345082957943
                                         uncertainty =       0.006867256388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415339390
  error estimate for blocks of size 2^( 2) =       0.000427761639
  error estimate for blocks of size 2^( 3) =       0.000440077252
  error estimate for blocks of size 2^( 4) =       0.000452247620
  error estimate for blocks of size 2^( 5) =       0.000462985216
  error estimate for blocks of size 2^( 6) =       0.000470705128
  error estimate for blocks of size 2^( 7) =       0.000478106796

      target function =                  N/A
              le_mean =     -16.906197137614
             les_mean =     286.164515100610
             stat err =       0.000466011190
             autocorr =       1.258886134005
              std dev =       0.587378597895
             le_variance =       0.345013617265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345082877171
                                         uncertainty =       0.006867256508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345082877171
                                         uncertainty =       0.006867256508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415339341
  error estimate for blocks of size 2^( 2) =       0.000427761592
  error estimate for blocks of size 2^( 3) =       0.000440077206
  error estimate for blocks of size 2^( 4) =       0.000452247576
  error estimate for blocks of size 2^( 5) =       0.000462985174
  error estimate for blocks of size 2^( 6) =       0.000470705089
  error estimate for blocks of size 2^( 7) =       0.000478106757

      target function =                  N/A
              le_mean =     -16.906197137338
             les_mean =     286.164515010494
             stat err =       0.000466011149
             autocorr =       1.258886207026
              std dev =       0.587378529119
             le_variance =       0.345013536470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345082917546
                                         uncertainty =       0.006867256448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345082917546
                                         uncertainty =       0.006867256448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415339365
  error estimate for blocks of size 2^( 2) =       0.000427761616
  error estimate for blocks of size 2^( 3) =       0.000440077229
  error estimate for blocks of size 2^( 4) =       0.000452247598
  error estimate for blocks of size 2^( 5) =       0.000462985195
  error estimate for blocks of size 2^( 6) =       0.000470705109
  error estimate for blocks of size 2^( 7) =       0.000478106777

      target function =                  N/A
              le_mean =     -16.906197137476
             les_mean =     286.164515055539
             stat err =       0.000466011170
             autocorr =       1.258886170533
              std dev =       0.587378563497
             le_variance =       0.345013576856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345082952893
                                         uncertainty =       0.006867256395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345082952893
                                         uncertainty =       0.006867256395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415339387
  error estimate for blocks of size 2^( 2) =       0.000427761636
  error estimate for blocks of size 2^( 3) =       0.000440077249
  error estimate for blocks of size 2^( 4) =       0.000452247617
  error estimate for blocks of size 2^( 5) =       0.000462985214
  error estimate for blocks of size 2^( 6) =       0.000470705126
  error estimate for blocks of size 2^( 7) =       0.000478106794

      target function =                  N/A
              le_mean =     -16.906197137596
             les_mean =     286.164515094975
             stat err =       0.000466011188
             autocorr =       1.258886138582
              std dev =       0.587378593594
             le_variance =       0.345013612213


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906197137614        initial  <--
     1.4552e+03     1.4552e+04             1.4267e-07       -16.906197137338
     5.8208e+03     5.8208e+04             3.5666e-08       -16.906197137476
     2.3283e+04     2.3283e+05             8.9166e-09       -16.906197137596

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9821
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436003e-01 1 1  ON 1
 uu_2                 4.212945e-02 1 1  ON 2
 uu_3                -2.019563e-02 1 1  ON 3
 uu_4                -6.550933e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325668e-01 1 1  ON 8
 uu_9                -1.013150e-01 1 1  ON 9
 ud_0                 4.478561e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129359e-02 1 1  ON 12
 ud_3                -9.868184e-03 1 1  ON 13
 ud_4                -6.668002e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348459e-01 1 1  ON 16
 ud_7                -1.505164e-01 1 1  ON 17
 ud_8                -1.510945e-01 1 1  ON 18
 ud_9                -1.391027e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359628e-01 1 1  ON 21
 eO_2                -1.918644e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813433e-01 1 1  ON 25
 eO_6                 2.507119e-01 1 1  ON 26
 eO_7                -4.785447e-02 1 1  ON 27
 eO_8                -2.154430e-01 1 1  ON 28
 eO_9                -7.587988e-02 1 1  ON 29
eH1_0                -2.453821e-01 1 1  ON 30
eH1_1                -1.425499e-01 1 1  ON 31
eH1_2                -9.509243e-02 1 1  ON 32
eH1_3                -4.052593e-02 1 1  ON 33
eH1_4                 7.827169e-03 1 1  ON 34
eH1_5                 4.192494e-02 1 1  ON 35
eH1_6                 9.952479e-02 1 1  ON 36
eH1_7                 1.520110e-01 1 1  ON 37
eH1_8                 1.700592e-01 1 1  ON 38
eH1_9                 5.624086e-02 1 1  ON 39
eH2_0                -2.436721e-01 1 1  ON 40
eH2_1                -1.401748e-01 1 1  ON 41
eH2_2                -9.248723e-02 1 1  ON 42
eH2_3                -3.836716e-02 1 1  ON 43
eH2_4                 1.030540e-02 1 1  ON 44
eH2_5                 4.517012e-02 1 1  ON 45
eH2_6                 1.022499e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755839e-01 1 1  ON 48
eH2_9                 4.232798e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6905e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9517
    reference variance = 0.360587
====================================================
  Execution time = 2.0369e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4098e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5561e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341024387926
                                         uncertainty =       0.004943253195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341024387926
                                         uncertainty =       0.004943253195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412904866
  error estimate for blocks of size 2^( 2) =       0.000425433374
  error estimate for blocks of size 2^( 3) =       0.000438759083
  error estimate for blocks of size 2^( 4) =       0.000451503723
  error estimate for blocks of size 2^( 5) =       0.000461651754
  error estimate for blocks of size 2^( 6) =       0.000468665409
  error estimate for blocks of size 2^( 7) =       0.000471959038

      target function =                  N/A
              le_mean =     -16.906224673353
             les_mean =     286.161413391786
             stat err =       0.000463444981
             autocorr =       1.259784801317
              std dev =       0.583935661166
             le_variance =       0.340980856381


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690622467335e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906224673353       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906224673404       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906224673445       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906224673366       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906224673419       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906224673427       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906224673441       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906224673437       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 1.537651e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906224673353       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906224673366       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906224673376       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906224673357       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906224673401       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906224673318       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906224673338       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906224673369       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 3.844159e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906224673353       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906224673356       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906224673359       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906224673354       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906224673378       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906224673320       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906224673379       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906224673273       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 9.610418e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199039 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5936e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436003e-01 1 1  ON 1
 uu_2                 4.212945e-02 1 1  ON 2
 uu_3                -2.019563e-02 1 1  ON 3
 uu_4                -6.550933e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325668e-01 1 1  ON 8
 uu_9                -1.013150e-01 1 1  ON 9
 ud_0                 4.478561e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129359e-02 1 1  ON 12
 ud_3                -9.868183e-03 1 1  ON 13
 ud_4                -6.668002e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348459e-01 1 1  ON 16
 ud_7                -1.505164e-01 1 1  ON 17
 ud_8                -1.510945e-01 1 1  ON 18
 ud_9                -1.391027e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359628e-01 1 1  ON 21
 eO_2                -1.918644e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813433e-01 1 1  ON 25
 eO_6                 2.507119e-01 1 1  ON 26
 eO_7                -4.785446e-02 1 1  ON 27
 eO_8                -2.154430e-01 1 1  ON 28
 eO_9                -7.587989e-02 1 1  ON 29
eH1_0                -2.453821e-01 1 1  ON 30
eH1_1                -1.425499e-01 1 1  ON 31
eH1_2                -9.509244e-02 1 1  ON 32
eH1_3                -4.052593e-02 1 1  ON 33
eH1_4                 7.827169e-03 1 1  ON 34
eH1_5                 4.192494e-02 1 1  ON 35
eH1_6                 9.952479e-02 1 1  ON 36
eH1_7                 1.520110e-01 1 1  ON 37
eH1_8                 1.700592e-01 1 1  ON 38
eH1_9                 5.624086e-02 1 1  ON 39
eH2_0                -2.436721e-01 1 1  ON 40
eH2_1                -1.401748e-01 1 1  ON 41
eH2_2                -9.248723e-02 1 1  ON 42
eH2_3                -3.836716e-02 1 1  ON 43
eH2_4                 1.030540e-02 1 1  ON 44
eH2_5                 4.517012e-02 1 1  ON 45
eH2_6                 1.022499e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755839e-01 1 1  ON 48
eH2_9                 4.232799e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8906
    reference variance = 0.173427
====================================================
  Execution time = 2.0285e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4977e-01
  Total weights = 2.0000e+06
  Execution time = 1.8566e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349838315885
                                         uncertainty =       0.012791313659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349838315885
                                         uncertainty =       0.012791313659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418190713
  error estimate for blocks of size 2^( 2) =       0.000430843699
  error estimate for blocks of size 2^( 3) =       0.000443808762
  error estimate for blocks of size 2^( 4) =       0.000456758750
  error estimate for blocks of size 2^( 5) =       0.000467868219
  error estimate for blocks of size 2^( 6) =       0.000475290615
  error estimate for blocks of size 2^( 7) =       0.000481696192

      target function =                  N/A
              le_mean =     -16.906490819766
             les_mean =     286.179198608906
             stat err =       0.000470403444
             autocorr =       1.265296239311
              std dev =       0.591410978044
             le_variance =       0.349766944951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349838314472
                                         uncertainty =       0.012791312941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349838314472
                                         uncertainty =       0.012791312941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418190712
  error estimate for blocks of size 2^( 2) =       0.000430843698
  error estimate for blocks of size 2^( 3) =       0.000443808761
  error estimate for blocks of size 2^( 4) =       0.000456758749
  error estimate for blocks of size 2^( 5) =       0.000467868218
  error estimate for blocks of size 2^( 6) =       0.000475290614
  error estimate for blocks of size 2^( 7) =       0.000481696190

      target function =                  N/A
              le_mean =     -16.906490819848
             les_mean =     286.179198610257
             stat err =       0.000470403443
             autocorr =       1.265296238228
              std dev =       0.591410976853
             le_variance =       0.349766943542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349838315179
                                         uncertainty =       0.012791313300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349838315179
                                         uncertainty =       0.012791313300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418190713
  error estimate for blocks of size 2^( 2) =       0.000430843698
  error estimate for blocks of size 2^( 3) =       0.000443808761
  error estimate for blocks of size 2^( 4) =       0.000456758750
  error estimate for blocks of size 2^( 5) =       0.000467868218
  error estimate for blocks of size 2^( 6) =       0.000475290614
  error estimate for blocks of size 2^( 7) =       0.000481696191

      target function =                  N/A
              le_mean =     -16.906490819807
             les_mean =     286.179198609581
             stat err =       0.000470403443
             autocorr =       1.265296238782
              std dev =       0.591410977448
             le_variance =       0.349766944246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349838315797
                                         uncertainty =       0.012791313614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349838315797
                                         uncertainty =       0.012791313614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418190713
  error estimate for blocks of size 2^( 2) =       0.000430843699
  error estimate for blocks of size 2^( 3) =       0.000443808762
  error estimate for blocks of size 2^( 4) =       0.000456758750
  error estimate for blocks of size 2^( 5) =       0.000467868219
  error estimate for blocks of size 2^( 6) =       0.000475290615
  error estimate for blocks of size 2^( 7) =       0.000481696192

      target function =                  N/A
              le_mean =     -16.906490819771
             les_mean =     286.179198608990
             stat err =       0.000470403444
             autocorr =       1.265296239248
              std dev =       0.591410977969
             le_variance =       0.349766944863


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906490819766        initial
     1.4552e+04     1.4552e+05             1.5377e-08       -16.906490819848  <--
     5.8208e+04     5.8208e+05             3.8442e-09       -16.906490819807
     2.3283e+05     2.3283e+06             9.6104e-10       -16.906490819771

*****************************************************************************
Applying the update for shift_i =   1.4552e+04     and shift_s =   1.4552e+05
*****************************************************************************

  Execution time = 2.9671e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436003e-01 1 1  ON 1
 uu_2                 4.212945e-02 1 1  ON 2
 uu_3                -2.019563e-02 1 1  ON 3
 uu_4                -6.550932e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325668e-01 1 1  ON 8
 uu_9                -1.013150e-01 1 1  ON 9
 ud_0                 4.478561e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129359e-02 1 1  ON 12
 ud_3                -9.868182e-03 1 1  ON 13
 ud_4                -6.668002e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348459e-01 1 1  ON 16
 ud_7                -1.505164e-01 1 1  ON 17
 ud_8                -1.510945e-01 1 1  ON 18
 ud_9                -1.391027e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359628e-01 1 1  ON 21
 eO_2                -1.918644e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813433e-01 1 1  ON 25
 eO_6                 2.507120e-01 1 1  ON 26
 eO_7                -4.785446e-02 1 1  ON 27
 eO_8                -2.154430e-01 1 1  ON 28
 eO_9                -7.587989e-02 1 1  ON 29
eH1_0                -2.453821e-01 1 1  ON 30
eH1_1                -1.425499e-01 1 1  ON 31
eH1_2                -9.509244e-02 1 1  ON 32
eH1_3                -4.052595e-02 1 1  ON 33
eH1_4                 7.827168e-03 1 1  ON 34
eH1_5                 4.192494e-02 1 1  ON 35
eH1_6                 9.952478e-02 1 1  ON 36
eH1_7                 1.520110e-01 1 1  ON 37
eH1_8                 1.700592e-01 1 1  ON 38
eH1_9                 5.624087e-02 1 1  ON 39
eH2_0                -2.436721e-01 1 1  ON 40
eH2_1                -1.401748e-01 1 1  ON 41
eH2_2                -9.248724e-02 1 1  ON 42
eH2_3                -3.836716e-02 1 1  ON 43
eH2_4                 1.030539e-02 1 1  ON 44
eH2_5                 4.517012e-02 1 1  ON 45
eH2_6                 1.022499e-01 1 1  ON 46
eH2_7                 1.551649e-01 1 1  ON 47
eH2_8                 1.755839e-01 1 1  ON 48
eH2_9                 4.232800e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5865e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8863
    reference variance = 0.228751
====================================================
  Execution time = 2.1177e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3443e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5727e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334535613847
                                         uncertainty =       0.003041792416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334535613847
                                         uncertainty =       0.003041792416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408916510
  error estimate for blocks of size 2^( 2) =       0.000421895365
  error estimate for blocks of size 2^( 3) =       0.000434932148
  error estimate for blocks of size 2^( 4) =       0.000446742535
  error estimate for blocks of size 2^( 5) =       0.000457675145
  error estimate for blocks of size 2^( 6) =       0.000466464959
  error estimate for blocks of size 2^( 7) =       0.000472380188

      target function =                  N/A
              le_mean =     -16.905653067704
             les_mean =     286.135530903072
             stat err =       0.000460815707
             autocorr =       1.269946001654
              std dev =       0.578295274685
             le_variance =       0.334425424723


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690565306770e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905653067704       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905653067786       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905653067739       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905653067657       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905653067732       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905653067704       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905653067741       residual = 6.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 5.377784e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905653067704       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905653067724       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905653067713       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905653067692       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905653067710       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905653067708       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905653067702       residual = 6.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 1.344456e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905653067704       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905653067709       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905653067706       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905653067701       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905653067678       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905653067684       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905653067729       residual = 6.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 3.361148e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201314 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6760e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436003e-01 1 1  ON 1
 uu_2                 4.212945e-02 1 1  ON 2
 uu_3                -2.019562e-02 1 1  ON 3
 uu_4                -6.550932e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325668e-01 1 1  ON 8
 uu_9                -1.013150e-01 1 1  ON 9
 ud_0                 4.478561e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129359e-02 1 1  ON 12
 ud_3                -9.868179e-03 1 1  ON 13
 ud_4                -6.668002e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348459e-01 1 1  ON 16
 ud_7                -1.505164e-01 1 1  ON 17
 ud_8                -1.510945e-01 1 1  ON 18
 ud_9                -1.391027e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359628e-01 1 1  ON 21
 eO_2                -1.918644e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813433e-01 1 1  ON 25
 eO_6                 2.507120e-01 1 1  ON 26
 eO_7                -4.785445e-02 1 1  ON 27
 eO_8                -2.154430e-01 1 1  ON 28
 eO_9                -7.587990e-02 1 1  ON 29
eH1_0                -2.453821e-01 1 1  ON 30
eH1_1                -1.425499e-01 1 1  ON 31
eH1_2                -9.509244e-02 1 1  ON 32
eH1_3                -4.052595e-02 1 1  ON 33
eH1_4                 7.827166e-03 1 1  ON 34
eH1_5                 4.192494e-02 1 1  ON 35
eH1_6                 9.952478e-02 1 1  ON 36
eH1_7                 1.520110e-01 1 1  ON 37
eH1_8                 1.700592e-01 1 1  ON 38
eH1_9                 5.624088e-02 1 1  ON 39
eH2_0                -2.436721e-01 1 1  ON 40
eH2_1                -1.401748e-01 1 1  ON 41
eH2_2                -9.248725e-02 1 1  ON 42
eH2_3                -3.836716e-02 1 1  ON 43
eH2_4                 1.030539e-02 1 1  ON 44
eH2_5                 4.517012e-02 1 1  ON 45
eH2_6                 1.022499e-01 1 1  ON 46
eH2_7                 1.551650e-01 1 1  ON 47
eH2_8                 1.755839e-01 1 1  ON 48
eH2_9                 4.232801e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8176
    reference variance = 0.324188
====================================================
  Execution time = 2.1423e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4398e-01
  Total weights = 2.0000e+06
  Execution time = 1.8552e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344000610348
                                         uncertainty =       0.009493900265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344000610348
                                         uncertainty =       0.009493900265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414719809
  error estimate for blocks of size 2^( 2) =       0.000427486987
  error estimate for blocks of size 2^( 3) =       0.000439931610
  error estimate for blocks of size 2^( 4) =       0.000451248485
  error estimate for blocks of size 2^( 5) =       0.000460742104
  error estimate for blocks of size 2^( 6) =       0.000467014973
  error estimate for blocks of size 2^( 7) =       0.000474503507

      target function =                  N/A
              le_mean =     -16.905273266653
             les_mean =     286.132249088814
             stat err =       0.000463377267
             autocorr =       1.248417614652
              std dev =       0.586502379026
             le_variance =       0.343985040603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344000641367
                                         uncertainty =       0.009493902350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344000641367
                                         uncertainty =       0.009493902350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414719828
  error estimate for blocks of size 2^( 2) =       0.000427487005
  error estimate for blocks of size 2^( 3) =       0.000439931626
  error estimate for blocks of size 2^( 4) =       0.000451248501
  error estimate for blocks of size 2^( 5) =       0.000460742119
  error estimate for blocks of size 2^( 6) =       0.000467014988
  error estimate for blocks of size 2^( 7) =       0.000474503523

      target function =                  N/A
              le_mean =     -16.905273266807
             les_mean =     286.132249125070
             stat err =       0.000463377283
             autocorr =       1.248417586051
              std dev =       0.586502405476
             le_variance =       0.343985071629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344000625859
                                         uncertainty =       0.009493901308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344000625859
                                         uncertainty =       0.009493901308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414719819
  error estimate for blocks of size 2^( 2) =       0.000427486996
  error estimate for blocks of size 2^( 3) =       0.000439931618
  error estimate for blocks of size 2^( 4) =       0.000451248493
  error estimate for blocks of size 2^( 5) =       0.000460742111
  error estimate for blocks of size 2^( 6) =       0.000467014981
  error estimate for blocks of size 2^( 7) =       0.000474503515

      target function =                  N/A
              le_mean =     -16.905273266730
             les_mean =     286.132249106943
             stat err =       0.000463377275
             autocorr =       1.248417600350
              std dev =       0.586502392252
             le_variance =       0.343985056117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344000612287
                                         uncertainty =       0.009493900396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344000612287
                                         uncertainty =       0.009493900396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414719811
  error estimate for blocks of size 2^( 2) =       0.000427486989
  error estimate for blocks of size 2^( 3) =       0.000439931611
  error estimate for blocks of size 2^( 4) =       0.000451248486
  error estimate for blocks of size 2^( 5) =       0.000460742105
  error estimate for blocks of size 2^( 6) =       0.000467014974
  error estimate for blocks of size 2^( 7) =       0.000474503508

      target function =                  N/A
              le_mean =     -16.905273266662
             les_mean =     286.132249091081
             stat err =       0.000463377268
             autocorr =       1.248417612859
              std dev =       0.586502380679
             le_variance =       0.343985042542


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905273266653        initial
     3.6380e+03     3.6380e+04             5.3778e-08       -16.905273266807  <--
     1.4552e+04     1.4552e+05             1.3445e-08       -16.905273266730
     5.8208e+04     5.8208e+05             3.3611e-09       -16.905273266662

*****************************************************************************
Applying the update for shift_i =   3.6380e+03     and shift_s =   3.6380e+04
*****************************************************************************

  Execution time = 3.0798e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436003e-01 1 1  ON 1
 uu_2                 4.212945e-02 1 1  ON 2
 uu_3                -2.019562e-02 1 1  ON 3
 uu_4                -6.550932e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325668e-01 1 1  ON 8
 uu_9                -1.013150e-01 1 1  ON 9
 ud_0                 4.478561e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129361e-02 1 1  ON 12
 ud_3                -9.868171e-03 1 1  ON 13
 ud_4                -6.668002e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348459e-01 1 1  ON 16
 ud_7                -1.505164e-01 1 1  ON 17
 ud_8                -1.510945e-01 1 1  ON 18
 ud_9                -1.391027e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359627e-01 1 1  ON 21
 eO_2                -1.918645e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813433e-01 1 1  ON 25
 eO_6                 2.507120e-01 1 1  ON 26
 eO_7                -4.785444e-02 1 1  ON 27
 eO_8                -2.154430e-01 1 1  ON 28
 eO_9                -7.587993e-02 1 1  ON 29
eH1_0                -2.453822e-01 1 1  ON 30
eH1_1                -1.425499e-01 1 1  ON 31
eH1_2                -9.509246e-02 1 1  ON 32
eH1_3                -4.052595e-02 1 1  ON 33
eH1_4                 7.827157e-03 1 1  ON 34
eH1_5                 4.192494e-02 1 1  ON 35
eH1_6                 9.952478e-02 1 1  ON 36
eH1_7                 1.520110e-01 1 1  ON 37
eH1_8                 1.700592e-01 1 1  ON 38
eH1_9                 5.624092e-02 1 1  ON 39
eH2_0                -2.436721e-01 1 1  ON 40
eH2_1                -1.401748e-01 1 1  ON 41
eH2_2                -9.248728e-02 1 1  ON 42
eH2_3                -3.836716e-02 1 1  ON 43
eH2_4                 1.030539e-02 1 1  ON 44
eH2_5                 4.517010e-02 1 1  ON 45
eH2_6                 1.022499e-01 1 1  ON 46
eH2_7                 1.551650e-01 1 1  ON 47
eH2_8                 1.755839e-01 1 1  ON 48
eH2_9                 4.232805e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8042e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.909
    reference variance = 0.204381
====================================================
  Execution time = 2.0850e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4439e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5563e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344411064161
                                         uncertainty =       0.004156841939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344411064161
                                         uncertainty =       0.004156841939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414963024
  error estimate for blocks of size 2^( 2) =       0.000428096697
  error estimate for blocks of size 2^( 3) =       0.000441735489
  error estimate for blocks of size 2^( 4) =       0.000454721481
  error estimate for blocks of size 2^( 5) =       0.000466531332
  error estimate for blocks of size 2^( 6) =       0.000474654322
  error estimate for blocks of size 2^( 7) =       0.000482999855

      target function =                  N/A
              le_mean =     -16.905610417861
             les_mean =     286.144052050657
             stat err =       0.000469726748
             autocorr =       1.281361828220
              std dev =       0.586846336229
             le_variance =       0.344388622345


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690561041786e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905610417861       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905610417480       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905610417223       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905610417637       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905610417954       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905610417532       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905610417548       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905610417542       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 2.655631e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905610417861       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905610417766       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905610417702       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905610417805       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905610417885       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905610417780       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905610417781       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905610417782       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 6.639426e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905610417861       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905610417838       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905610417822       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905610417848       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905610417867       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905610417836       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905610417853       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905610417850       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 1.659878e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203951 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6417e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212945e-02 1 1  ON 2
 uu_3                -2.019563e-02 1 1  ON 3
 uu_4                -6.550931e-02 1 1  ON 4
 uu_5                -1.000054e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325669e-01 1 1  ON 8
 uu_9                -1.013150e-01 1 1  ON 9
 ud_0                 4.478562e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129360e-02 1 1  ON 12
 ud_3                -9.868167e-03 1 1  ON 13
 ud_4                -6.668001e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348459e-01 1 1  ON 16
 ud_7                -1.505164e-01 1 1  ON 17
 ud_8                -1.510945e-01 1 1  ON 18
 ud_9                -1.391027e-01 1 1  ON 19
 eO_0                -7.568721e-01 1 1  ON 20
 eO_1                -4.359627e-01 1 1  ON 21
 eO_2                -1.918646e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813434e-01 1 1  ON 25
 eO_6                 2.507120e-01 1 1  ON 26
 eO_7                -4.785442e-02 1 1  ON 27
 eO_8                -2.154431e-01 1 1  ON 28
 eO_9                -7.587997e-02 1 1  ON 29
eH1_0                -2.453822e-01 1 1  ON 30
eH1_1                -1.425499e-01 1 1  ON 31
eH1_2                -9.509246e-02 1 1  ON 32
eH1_3                -4.052598e-02 1 1  ON 33
eH1_4                 7.827174e-03 1 1  ON 34
eH1_5                 4.192495e-02 1 1  ON 35
eH1_6                 9.952475e-02 1 1  ON 36
eH1_7                 1.520110e-01 1 1  ON 37
eH1_8                 1.700593e-01 1 1  ON 38
eH1_9                 5.624098e-02 1 1  ON 39
eH2_0                -2.436721e-01 1 1  ON 40
eH2_1                -1.401748e-01 1 1  ON 41
eH2_2                -9.248730e-02 1 1  ON 42
eH2_3                -3.836715e-02 1 1  ON 43
eH2_4                 1.030539e-02 1 1  ON 44
eH2_5                 4.517010e-02 1 1  ON 45
eH2_6                 1.022499e-01 1 1  ON 46
eH2_7                 1.551650e-01 1 1  ON 47
eH2_8                 1.755840e-01 1 1  ON 48
eH2_9                 4.232811e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9389
    reference variance = 0.231056
====================================================
  Execution time = 2.0587e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4390e-01
  Total weights = 2.0000e+06
  Execution time = 1.8611e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343930505400
                                         uncertainty =       0.003921894210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343930505400
                                         uncertainty =       0.003921894210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414667223
  error estimate for blocks of size 2^( 2) =       0.000427122959
  error estimate for blocks of size 2^( 3) =       0.000440347300
  error estimate for blocks of size 2^( 4) =       0.000452608434
  error estimate for blocks of size 2^( 5) =       0.000462375220
  error estimate for blocks of size 2^( 6) =       0.000468414533
  error estimate for blocks of size 2^( 7) =       0.000471363411

      target function =                  N/A
              le_mean =     -16.906387210739
             les_mean =     286.169826159398
             stat err =       0.000463690399
             autocorr =       1.250422532654
              std dev =       0.586428010861
             le_variance =       0.343897811922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343930666962
                                         uncertainty =       0.003921895935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343930666962
                                         uncertainty =       0.003921895935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414667321
  error estimate for blocks of size 2^( 2) =       0.000427123052
  error estimate for blocks of size 2^( 3) =       0.000440347390
  error estimate for blocks of size 2^( 4) =       0.000452608519
  error estimate for blocks of size 2^( 5) =       0.000462375301
  error estimate for blocks of size 2^( 6) =       0.000468414611
  error estimate for blocks of size 2^( 7) =       0.000471363485

      target function =                  N/A
              le_mean =     -16.906387211088
             les_mean =     286.169826332838
             stat err =       0.000463690479
             autocorr =       1.250422375081
              std dev =       0.586428148653
             le_variance =       0.343897973533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343930586214
                                         uncertainty =       0.003921895073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343930586214
                                         uncertainty =       0.003921895073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414667272
  error estimate for blocks of size 2^( 2) =       0.000427123006
  error estimate for blocks of size 2^( 3) =       0.000440347345
  error estimate for blocks of size 2^( 4) =       0.000452608477
  error estimate for blocks of size 2^( 5) =       0.000462375261
  error estimate for blocks of size 2^( 6) =       0.000468414572
  error estimate for blocks of size 2^( 7) =       0.000471363448

      target function =                  N/A
              le_mean =     -16.906387210914
             les_mean =     286.169826246152
             stat err =       0.000463690439
             autocorr =       1.250422453838
              std dev =       0.586428079786
             le_variance =       0.343897892761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343930515503
                                         uncertainty =       0.003921894318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343930515503
                                         uncertainty =       0.003921894318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414667229
  error estimate for blocks of size 2^( 2) =       0.000427122965
  error estimate for blocks of size 2^( 3) =       0.000440347306
  error estimate for blocks of size 2^( 4) =       0.000452608439
  error estimate for blocks of size 2^( 5) =       0.000462375225
  error estimate for blocks of size 2^( 6) =       0.000468414537
  error estimate for blocks of size 2^( 7) =       0.000471363416

      target function =                  N/A
              le_mean =     -16.906387210760
             les_mean =     286.169826170243
             stat err =       0.000463690404
             autocorr =       1.250422522799
              std dev =       0.586428019477
             le_variance =       0.343897822028


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906387210739        initial
     9.0949e+02     9.0949e+03             2.6556e-07       -16.906387211088  <--
     3.6380e+03     3.6380e+04             6.6394e-08       -16.906387210914
     1.4552e+04     1.4552e+05             1.6599e-08       -16.906387210760

*****************************************************************************
Applying the update for shift_i =   9.0949e+02     and shift_s =   9.0949e+03
*****************************************************************************

  Execution time = 2.9980e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212945e-02 1 1  ON 2
 uu_3                -2.019565e-02 1 1  ON 3
 uu_4                -6.550926e-02 1 1  ON 4
 uu_5                -1.000053e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325669e-01 1 1  ON 8
 uu_9                -1.013151e-01 1 1  ON 9
 ud_0                 4.478563e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129357e-02 1 1  ON 12
 ud_3                -9.868157e-03 1 1  ON 13
 ud_4                -6.667998e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348459e-01 1 1  ON 16
 ud_7                -1.505165e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391027e-01 1 1  ON 19
 eO_0                -7.568722e-01 1 1  ON 20
 eO_1                -4.359627e-01 1 1  ON 21
 eO_2                -1.918651e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813435e-01 1 1  ON 25
 eO_6                 2.507121e-01 1 1  ON 26
 eO_7                -4.785435e-02 1 1  ON 27
 eO_8                -2.154432e-01 1 1  ON 28
 eO_9                -7.588007e-02 1 1  ON 29
eH1_0                -2.453824e-01 1 1  ON 30
eH1_1                -1.425500e-01 1 1  ON 31
eH1_2                -9.509246e-02 1 1  ON 32
eH1_3                -4.052606e-02 1 1  ON 33
eH1_4                 7.827223e-03 1 1  ON 34
eH1_5                 4.192498e-02 1 1  ON 35
eH1_6                 9.952467e-02 1 1  ON 36
eH1_7                 1.520110e-01 1 1  ON 37
eH1_8                 1.700594e-01 1 1  ON 38
eH1_9                 5.624115e-02 1 1  ON 39
eH2_0                -2.436722e-01 1 1  ON 40
eH2_1                -1.401750e-01 1 1  ON 41
eH2_2                -9.248736e-02 1 1  ON 42
eH2_3                -3.836713e-02 1 1  ON 43
eH2_4                 1.030539e-02 1 1  ON 44
eH2_5                 4.517010e-02 1 1  ON 45
eH2_6                 1.022498e-01 1 1  ON 46
eH2_7                 1.551650e-01 1 1  ON 47
eH2_8                 1.755841e-01 1 1  ON 48
eH2_9                 4.232828e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7196e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9061
    reference variance = 0.653934
====================================================
  Execution time = 2.1396e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3893e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4478e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338936296862
                                         uncertainty =       0.004883820132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338936296862
                                         uncertainty =       0.004883820132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411661940
  error estimate for blocks of size 2^( 2) =       0.000424637737
  error estimate for blocks of size 2^( 3) =       0.000438139904
  error estimate for blocks of size 2^( 4) =       0.000451070041
  error estimate for blocks of size 2^( 5) =       0.000461871682
  error estimate for blocks of size 2^( 6) =       0.000468765724
  error estimate for blocks of size 2^( 7) =       0.000471057274

      target function =                  N/A
              le_mean =     -16.906033686118
             les_mean =     286.152905933104
             stat err =       0.000463191180
             autocorr =       1.266015809734
              std dev =       0.582177899295
             le_variance =       0.338931106427


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690603368612e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906033686118       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906033686925       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906033688551       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906033688334       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906033687254       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906033686483       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906033687173       residual = 8.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+02 is 9.951481e-07

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906033686118       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906033686319       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906033686727       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906033686672       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906033686402       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906033686209       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906033686383       residual = 7.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 2.488110e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906033686118       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906033686168       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906033686270       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906033686256       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906033686188       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906033686138       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906033686185       residual = 7.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 6.220424e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206168 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6854e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.106418e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212947e-02 1 1  ON 2
 uu_3                -2.019567e-02 1 1  ON 3
 uu_4                -6.550920e-02 1 1  ON 4
 uu_5                -1.000052e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403674e-01 1 1  ON 7
 uu_8                -1.325670e-01 1 1  ON 8
 uu_9                -1.013153e-01 1 1  ON 9
 ud_0                 4.478564e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129363e-02 1 1  ON 12
 ud_3                -9.868092e-03 1 1  ON 13
 ud_4                -6.667993e-02 1 1  ON 14
 ud_5                -1.077871e-01 1 1  ON 15
 ud_6                -1.348458e-01 1 1  ON 16
 ud_7                -1.505165e-01 1 1  ON 17
 ud_8                -1.510945e-01 1 1  ON 18
 ud_9                -1.391028e-01 1 1  ON 19
 eO_0                -7.568723e-01 1 1  ON 20
 eO_1                -4.359626e-01 1 1  ON 21
 eO_2                -1.918661e-02 1 1  ON 22
 eO_3                 2.975713e-01 1 1  ON 23
 eO_4                 5.214257e-01 1 1  ON 24
 eO_5                 4.813436e-01 1 1  ON 25
 eO_6                 2.507122e-01 1 1  ON 26
 eO_7                -4.785425e-02 1 1  ON 27
 eO_8                -2.154433e-01 1 1  ON 28
 eO_9                -7.588022e-02 1 1  ON 29
eH1_0                -2.453826e-01 1 1  ON 30
eH1_1                -1.425501e-01 1 1  ON 31
eH1_2                -9.509248e-02 1 1  ON 32
eH1_3                -4.052611e-02 1 1  ON 33
eH1_4                 7.827152e-03 1 1  ON 34
eH1_5                 4.192495e-02 1 1  ON 35
eH1_6                 9.952469e-02 1 1  ON 36
eH1_7                 1.520111e-01 1 1  ON 37
eH1_8                 1.700596e-01 1 1  ON 38
eH1_9                 5.624131e-02 1 1  ON 39
eH2_0                -2.436724e-01 1 1  ON 40
eH2_1                -1.401750e-01 1 1  ON 41
eH2_2                -9.248744e-02 1 1  ON 42
eH2_3                -3.836710e-02 1 1  ON 43
eH2_4                 1.030523e-02 1 1  ON 44
eH2_5                 4.517006e-02 1 1  ON 45
eH2_6                 1.022497e-01 1 1  ON 46
eH2_7                 1.551650e-01 1 1  ON 47
eH2_8                 1.755843e-01 1 1  ON 48
eH2_9                 4.232853e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.881
    reference variance = 0.285834
====================================================
  Execution time = 2.2161e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4431e-01
  Total weights = 2.0000e+06
  Execution time = 1.8557e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344395737442
                                         uncertainty =       0.004165777251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344395737442
                                         uncertainty =       0.004165777251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414917781
  error estimate for blocks of size 2^( 2) =       0.000427651060
  error estimate for blocks of size 2^( 3) =       0.000439730000
  error estimate for blocks of size 2^( 4) =       0.000452076993
  error estimate for blocks of size 2^( 5) =       0.000462001338
  error estimate for blocks of size 2^( 6) =       0.000470264431
  error estimate for blocks of size 2^( 7) =       0.000474248796

      target function =                  N/A
              le_mean =     -16.906669877450
             les_mean =     286.179799702512
             stat err =       0.000464647889
             autocorr =       1.254075966243
              std dev =       0.586782352819
             le_variance =       0.344313529580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344395906718
                                         uncertainty =       0.004165779281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344395906718
                                         uncertainty =       0.004165779281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414917883
  error estimate for blocks of size 2^( 2) =       0.000427651156
  error estimate for blocks of size 2^( 3) =       0.000439730092
  error estimate for blocks of size 2^( 4) =       0.000452077081
  error estimate for blocks of size 2^( 5) =       0.000462001420
  error estimate for blocks of size 2^( 6) =       0.000470264512
  error estimate for blocks of size 2^( 7) =       0.000474248878

      target function =                  N/A
              le_mean =     -16.906669876056
             les_mean =     286.179799824919
             stat err =       0.000464647973
             autocorr =       1.254075798154
              std dev =       0.586782497312
             le_variance =       0.344313699152

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344395822219
                                         uncertainty =       0.004165778267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344395822219
                                         uncertainty =       0.004165778267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414917832
  error estimate for blocks of size 2^( 2) =       0.000427651108
  error estimate for blocks of size 2^( 3) =       0.000439730046
  error estimate for blocks of size 2^( 4) =       0.000452077037
  error estimate for blocks of size 2^( 5) =       0.000462001379
  error estimate for blocks of size 2^( 6) =       0.000470264471
  error estimate for blocks of size 2^( 7) =       0.000474248837

      target function =                  N/A
              le_mean =     -16.906669876752
             les_mean =     286.179799763822
             stat err =       0.000464647931
             autocorr =       1.254075882078
              std dev =       0.586782425184
             le_variance =       0.344313614504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344395748043
                                         uncertainty =       0.004165777378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344395748043
                                         uncertainty =       0.004165777378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414917787
  error estimate for blocks of size 2^( 2) =       0.000427651066
  error estimate for blocks of size 2^( 3) =       0.000439730005
  error estimate for blocks of size 2^( 4) =       0.000452076998
  error estimate for blocks of size 2^( 5) =       0.000462001343
  error estimate for blocks of size 2^( 6) =       0.000470264436
  error estimate for blocks of size 2^( 7) =       0.000474248802

      target function =                  N/A
              le_mean =     -16.906669877363
             les_mean =     286.179799710177
             stat err =       0.000464647895
             autocorr =       1.254075955718
              std dev =       0.586782361868
             le_variance =       0.344313540199


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906669877450        initial  <--
     2.2737e+02     2.2737e+03             9.9515e-07       -16.906669876056
     9.0949e+02     9.0949e+03             2.4881e-07       -16.906669876752
     3.6380e+03     3.6380e+04             6.2204e-08       -16.906669877363

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.5493
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212945e-02 1 1  ON 2
 uu_3                -2.019565e-02 1 1  ON 3
 uu_4                -6.550926e-02 1 1  ON 4
 uu_5                -1.000053e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325669e-01 1 1  ON 8
 uu_9                -1.013151e-01 1 1  ON 9
 ud_0                 4.478563e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129357e-02 1 1  ON 12
 ud_3                -9.868157e-03 1 1  ON 13
 ud_4                -6.667998e-02 1 1  ON 14
 ud_5                -1.077870e-01 1 1  ON 15
 ud_6                -1.348459e-01 1 1  ON 16
 ud_7                -1.505165e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391027e-01 1 1  ON 19
 eO_0                -7.568722e-01 1 1  ON 20
 eO_1                -4.359627e-01 1 1  ON 21
 eO_2                -1.918651e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214255e-01 1 1  ON 24
 eO_5                 4.813435e-01 1 1  ON 25
 eO_6                 2.507121e-01 1 1  ON 26
 eO_7                -4.785435e-02 1 1  ON 27
 eO_8                -2.154432e-01 1 1  ON 28
 eO_9                -7.588007e-02 1 1  ON 29
eH1_0                -2.453824e-01 1 1  ON 30
eH1_1                -1.425500e-01 1 1  ON 31
eH1_2                -9.509246e-02 1 1  ON 32
eH1_3                -4.052606e-02 1 1  ON 33
eH1_4                 7.827223e-03 1 1  ON 34
eH1_5                 4.192498e-02 1 1  ON 35
eH1_6                 9.952467e-02 1 1  ON 36
eH1_7                 1.520110e-01 1 1  ON 37
eH1_8                 1.700594e-01 1 1  ON 38
eH1_9                 5.624115e-02 1 1  ON 39
eH2_0                -2.436722e-01 1 1  ON 40
eH2_1                -1.401750e-01 1 1  ON 41
eH2_2                -9.248736e-02 1 1  ON 42
eH2_3                -3.836713e-02 1 1  ON 43
eH2_4                 1.030539e-02 1 1  ON 44
eH2_5                 4.517010e-02 1 1  ON 45
eH2_6                 1.022498e-01 1 1  ON 46
eH2_7                 1.551650e-01 1 1  ON 47
eH2_8                 1.755841e-01 1 1  ON 48
eH2_9                 4.232828e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8649e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8545
    reference variance = 0.157954
====================================================
  Execution time = 2.0499e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3685e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5196e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336924387400
                                         uncertainty =       0.002726750798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336924387400
                                         uncertainty =       0.002726750798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410398621
  error estimate for blocks of size 2^( 2) =       0.000423298677
  error estimate for blocks of size 2^( 3) =       0.000436480799
  error estimate for blocks of size 2^( 4) =       0.000449449390
  error estimate for blocks of size 2^( 5) =       0.000460873330
  error estimate for blocks of size 2^( 6) =       0.000469924471
  error estimate for blocks of size 2^( 7) =       0.000475441596

      target function =                  N/A
              le_mean =     -16.906166565112
             les_mean =     286.155321814698
             stat err =       0.000463922197
             autocorr =       1.277846005031
              std dev =       0.580391295439
             le_variance =       0.336854055822


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690616656511e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906166565112       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906166565160       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906166565244       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906166565254       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906166565435       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906166565268       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906166565319       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906166565314       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 1.080544e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906166565112       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906166565124       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906166565145       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906166565142       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906166565188       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906166565150       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906166565159       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906166565167       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 2.701364e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906166565112       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906166565115       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906166565120       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906166565107       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906166565132       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906166565077       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906166565078       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906166565142       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 6.753412e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208834 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6029e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212945e-02 1 1  ON 2
 uu_3                -2.019565e-02 1 1  ON 3
 uu_4                -6.550927e-02 1 1  ON 4
 uu_5                -1.000053e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325669e-01 1 1  ON 8
 uu_9                -1.013151e-01 1 1  ON 9
 ud_0                 4.478563e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129357e-02 1 1  ON 12
 ud_3                -9.868151e-03 1 1  ON 13
 ud_4                -6.667998e-02 1 1  ON 14
 ud_5                -1.077871e-01 1 1  ON 15
 ud_6                -1.348459e-01 1 1  ON 16
 ud_7                -1.505165e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391027e-01 1 1  ON 19
 eO_0                -7.568722e-01 1 1  ON 20
 eO_1                -4.359627e-01 1 1  ON 21
 eO_2                -1.918651e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214256e-01 1 1  ON 24
 eO_5                 4.813435e-01 1 1  ON 25
 eO_6                 2.507122e-01 1 1  ON 26
 eO_7                -4.785434e-02 1 1  ON 27
 eO_8                -2.154432e-01 1 1  ON 28
 eO_9                -7.588009e-02 1 1  ON 29
eH1_0                -2.453824e-01 1 1  ON 30
eH1_1                -1.425500e-01 1 1  ON 31
eH1_2                -9.509247e-02 1 1  ON 32
eH1_3                -4.052607e-02 1 1  ON 33
eH1_4                 7.827227e-03 1 1  ON 34
eH1_5                 4.192499e-02 1 1  ON 35
eH1_6                 9.952466e-02 1 1  ON 36
eH1_7                 1.520110e-01 1 1  ON 37
eH1_8                 1.700594e-01 1 1  ON 38
eH1_9                 5.624117e-02 1 1  ON 39
eH2_0                -2.436722e-01 1 1  ON 40
eH2_1                -1.401750e-01 1 1  ON 41
eH2_2                -9.248737e-02 1 1  ON 42
eH2_3                -3.836712e-02 1 1  ON 43
eH2_4                 1.030539e-02 1 1  ON 44
eH2_5                 4.517009e-02 1 1  ON 45
eH2_6                 1.022498e-01 1 1  ON 46
eH2_7                 1.551650e-01 1 1  ON 47
eH2_8                 1.755841e-01 1 1  ON 48
eH2_9                 4.232831e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.867
    reference variance = 0.164212
====================================================
  Execution time = 2.0456e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3784e-01
  Total weights = 2.0000e+06
  Execution time = 1.8537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337720500110
                                         uncertainty =       0.004028920609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337720500110
                                         uncertainty =       0.004028920609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410999255
  error estimate for blocks of size 2^( 2) =       0.000423547845
  error estimate for blocks of size 2^( 3) =       0.000436757980
  error estimate for blocks of size 2^( 4) =       0.000448975804
  error estimate for blocks of size 2^( 5) =       0.000459837061
  error estimate for blocks of size 2^( 6) =       0.000466209751
  error estimate for blocks of size 2^( 7) =       0.000471753148

      target function =                  N/A
              le_mean =     -16.905515463211
             les_mean =     286.134293683164
             stat err =       0.000461693941
             autocorr =       1.261903895082
              std dev =       0.581240720539
             le_variance =       0.337840775213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337720534646
                                         uncertainty =       0.004028921040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337720534646
                                         uncertainty =       0.004028921040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410999276
  error estimate for blocks of size 2^( 2) =       0.000423547864
  error estimate for blocks of size 2^( 3) =       0.000436757997
  error estimate for blocks of size 2^( 4) =       0.000448975821
  error estimate for blocks of size 2^( 5) =       0.000459837076
  error estimate for blocks of size 2^( 6) =       0.000466209766
  error estimate for blocks of size 2^( 7) =       0.000471753161

      target function =                  N/A
              le_mean =     -16.905515463649
             les_mean =     286.134293732497
             stat err =       0.000461693956
             autocorr =       1.261903849085
              std dev =       0.581240750238
             le_variance =       0.337840809737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337720517380
                                         uncertainty =       0.004028920825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337720517380
                                         uncertainty =       0.004028920825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410999265
  error estimate for blocks of size 2^( 2) =       0.000423547855
  error estimate for blocks of size 2^( 3) =       0.000436757988
  error estimate for blocks of size 2^( 4) =       0.000448975813
  error estimate for blocks of size 2^( 5) =       0.000459837069
  error estimate for blocks of size 2^( 6) =       0.000466209758
  error estimate for blocks of size 2^( 7) =       0.000471753155

      target function =                  N/A
              le_mean =     -16.905515463430
             les_mean =     286.134293707834
             stat err =       0.000461693949
             autocorr =       1.261903872085
              std dev =       0.581240735391
             le_variance =       0.337840792477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337720502269
                                         uncertainty =       0.004028920636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337720502269
                                         uncertainty =       0.004028920636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410999256
  error estimate for blocks of size 2^( 2) =       0.000423547846
  error estimate for blocks of size 2^( 3) =       0.000436757981
  error estimate for blocks of size 2^( 4) =       0.000448975805
  error estimate for blocks of size 2^( 5) =       0.000459837062
  error estimate for blocks of size 2^( 6) =       0.000466209752
  error estimate for blocks of size 2^( 7) =       0.000471753149

      target function =                  N/A
              le_mean =     -16.905515463239
             les_mean =     286.134293686247
             stat err =       0.000461693942
             autocorr =       1.261903892213
              std dev =       0.581240722396
             le_variance =       0.337840777371


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905515463211        initial
     2.2737e+03     2.2737e+04             1.0805e-07       -16.905515463649  <--
     9.0949e+03     9.0949e+04             2.7014e-08       -16.905515463430
     3.6380e+04     3.6380e+05             6.7534e-09       -16.905515463239

*****************************************************************************
Applying the update for shift_i =   2.2737e+03     and shift_s =   2.2737e+04
*****************************************************************************

  Execution time = 2.9818e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212944e-02 1 1  ON 2
 uu_3                -2.019564e-02 1 1  ON 3
 uu_4                -6.550931e-02 1 1  ON 4
 uu_5                -1.000053e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325670e-01 1 1  ON 8
 uu_9                -1.013152e-01 1 1  ON 9
 ud_0                 4.478563e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129358e-02 1 1  ON 12
 ud_3                -9.868132e-03 1 1  ON 13
 ud_4                -6.667997e-02 1 1  ON 14
 ud_5                -1.077871e-01 1 1  ON 15
 ud_6                -1.348458e-01 1 1  ON 16
 ud_7                -1.505165e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391027e-01 1 1  ON 19
 eO_0                -7.568722e-01 1 1  ON 20
 eO_1                -4.359627e-01 1 1  ON 21
 eO_2                -1.918653e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214256e-01 1 1  ON 24
 eO_5                 4.813435e-01 1 1  ON 25
 eO_6                 2.507122e-01 1 1  ON 26
 eO_7                -4.785432e-02 1 1  ON 27
 eO_8                -2.154432e-01 1 1  ON 28
 eO_9                -7.588014e-02 1 1  ON 29
eH1_0                -2.453825e-01 1 1  ON 30
eH1_1                -1.425501e-01 1 1  ON 31
eH1_2                -9.509249e-02 1 1  ON 32
eH1_3                -4.052610e-02 1 1  ON 33
eH1_4                 7.827239e-03 1 1  ON 34
eH1_5                 4.192502e-02 1 1  ON 35
eH1_6                 9.952463e-02 1 1  ON 36
eH1_7                 1.520110e-01 1 1  ON 37
eH1_8                 1.700595e-01 1 1  ON 38
eH1_9                 5.624123e-02 1 1  ON 39
eH2_0                -2.436723e-01 1 1  ON 40
eH2_1                -1.401750e-01 1 1  ON 41
eH2_2                -9.248742e-02 1 1  ON 42
eH2_3                -3.836711e-02 1 1  ON 43
eH2_4                 1.030538e-02 1 1  ON 44
eH2_5                 4.517008e-02 1 1  ON 45
eH2_6                 1.022498e-01 1 1  ON 46
eH2_7                 1.551650e-01 1 1  ON 47
eH2_8                 1.755841e-01 1 1  ON 48
eH2_9                 4.232839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6189e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8218
    reference variance = 0.333544
====================================================
  Execution time = 2.1361e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4955e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5497e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349650470684
                                         uncertainty =       0.010980746907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349650470684
                                         uncertainty =       0.010980746907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418059454
  error estimate for blocks of size 2^( 2) =       0.000430762187
  error estimate for blocks of size 2^( 3) =       0.000443930572
  error estimate for blocks of size 2^( 4) =       0.000456990418
  error estimate for blocks of size 2^( 5) =       0.000467969400
  error estimate for blocks of size 2^( 6) =       0.000475049366
  error estimate for blocks of size 2^( 7) =       0.000480686310

      target function =                  N/A
              le_mean =     -16.905479731637
             les_mean =     286.144792196920
             stat err =       0.000470173873
             autocorr =       1.264855420906
              std dev =       0.591225350369
             le_variance =       0.349547414919


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690547973164e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905479731637       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905479732336       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905479733368       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905479733995       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905479733488       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905479733146       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905479733465       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905479733351       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+02 is 4.200098e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905479731637       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905479731812       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905479732070       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905479732226       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905479732098       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905479732013       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905479732090       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905479732065       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 1.050041e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905479731637       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905479731680       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905479731745       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905479731785       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905479731750       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905479731732       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905479731750       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905479731744       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 2.625112e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211480 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6921e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212945e-02 1 1  ON 2
 uu_3                -2.019566e-02 1 1  ON 3
 uu_4                -6.550933e-02 1 1  ON 4
 uu_5                -1.000053e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325670e-01 1 1  ON 8
 uu_9                -1.013152e-01 1 1  ON 9
 ud_0                 4.478563e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129357e-02 1 1  ON 12
 ud_3                -9.868119e-03 1 1  ON 13
 ud_4                -6.667998e-02 1 1  ON 14
 ud_5                -1.077871e-01 1 1  ON 15
 ud_6                -1.348459e-01 1 1  ON 16
 ud_7                -1.505165e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391027e-01 1 1  ON 19
 eO_0                -7.568723e-01 1 1  ON 20
 eO_1                -4.359627e-01 1 1  ON 21
 eO_2                -1.918653e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214256e-01 1 1  ON 24
 eO_5                 4.813435e-01 1 1  ON 25
 eO_6                 2.507123e-01 1 1  ON 26
 eO_7                -4.785428e-02 1 1  ON 27
 eO_8                -2.154433e-01 1 1  ON 28
 eO_9                -7.588019e-02 1 1  ON 29
eH1_0                -2.453825e-01 1 1  ON 30
eH1_1                -1.425501e-01 1 1  ON 31
eH1_2                -9.509248e-02 1 1  ON 32
eH1_3                -4.052617e-02 1 1  ON 33
eH1_4                 7.827260e-03 1 1  ON 34
eH1_5                 4.192498e-02 1 1  ON 35
eH1_6                 9.952461e-02 1 1  ON 36
eH1_7                 1.520111e-01 1 1  ON 37
eH1_8                 1.700596e-01 1 1  ON 38
eH1_9                 5.624133e-02 1 1  ON 39
eH2_0                -2.436723e-01 1 1  ON 40
eH2_1                -1.401750e-01 1 1  ON 41
eH2_2                -9.248749e-02 1 1  ON 42
eH2_3                -3.836713e-02 1 1  ON 43
eH2_4                 1.030537e-02 1 1  ON 44
eH2_5                 4.517011e-02 1 1  ON 45
eH2_6                 1.022499e-01 1 1  ON 46
eH2_7                 1.551650e-01 1 1  ON 47
eH2_8                 1.755842e-01 1 1  ON 48
eH2_9                 4.232847e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8848
    reference variance = 0.22999
====================================================
  Execution time = 2.0229e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3899e-01
  Total weights = 2.0000e+06
  Execution time = 1.8593e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339042831928
                                         uncertainty =       0.005137455263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339042831928
                                         uncertainty =       0.005137455263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411694958
  error estimate for blocks of size 2^( 2) =       0.000424015007
  error estimate for blocks of size 2^( 3) =       0.000436983925
  error estimate for blocks of size 2^( 4) =       0.000449596033
  error estimate for blocks of size 2^( 5) =       0.000458767573
  error estimate for blocks of size 2^( 6) =       0.000467235787
  error estimate for blocks of size 2^( 7) =       0.000469364153

      target function =                  N/A
              le_mean =     -16.906470368826
             les_mean =     286.167725638580
             stat err =       0.000461240887
             autocorr =       1.255175636895
              std dev =       0.582224592484
             le_variance =       0.338985476093

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339042695900
                                         uncertainty =       0.005137453341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339042695900
                                         uncertainty =       0.005137453341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411694875
  error estimate for blocks of size 2^( 2) =       0.000424014928
  error estimate for blocks of size 2^( 3) =       0.000436983849
  error estimate for blocks of size 2^( 4) =       0.000449595960
  error estimate for blocks of size 2^( 5) =       0.000458767497
  error estimate for blocks of size 2^( 6) =       0.000467235713
  error estimate for blocks of size 2^( 7) =       0.000469364083

      target function =                  N/A
              le_mean =     -16.906470368579
             les_mean =     286.167725494253
             stat err =       0.000461240813
             autocorr =       1.255175741923
              std dev =       0.582224475687
             le_variance =       0.338985340089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339042763858
                                         uncertainty =       0.005137454301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339042763858
                                         uncertainty =       0.005137454301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411694916
  error estimate for blocks of size 2^( 2) =       0.000424014967
  error estimate for blocks of size 2^( 3) =       0.000436983887
  error estimate for blocks of size 2^( 4) =       0.000449595997
  error estimate for blocks of size 2^( 5) =       0.000458767535
  error estimate for blocks of size 2^( 6) =       0.000467235750
  error estimate for blocks of size 2^( 7) =       0.000469364118

      target function =                  N/A
              le_mean =     -16.906470368702
             les_mean =     286.167725566356
             stat err =       0.000461240850
             autocorr =       1.255175689449
              std dev =       0.582224534037
             le_variance =       0.338985408035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339042823418
                                         uncertainty =       0.005137455142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339042823418
                                         uncertainty =       0.005137455142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411694952
  error estimate for blocks of size 2^( 2) =       0.000424015002
  error estimate for blocks of size 2^( 3) =       0.000436983920
  error estimate for blocks of size 2^( 4) =       0.000449596029
  error estimate for blocks of size 2^( 5) =       0.000458767568
  error estimate for blocks of size 2^( 6) =       0.000467235783
  error estimate for blocks of size 2^( 7) =       0.000469364148

      target function =                  N/A
              le_mean =     -16.906470368810
             les_mean =     286.167725629550
             stat err =       0.000461240882
             autocorr =       1.255175643462
              std dev =       0.582224585176
             le_variance =       0.338985467584


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906470368826        initial  <--
     5.6843e+02     5.6843e+03             4.2001e-07       -16.906470368579
     2.2737e+03     2.2737e+04             1.0500e-07       -16.906470368702
     9.0949e+03     9.0949e+04             2.6251e-08       -16.906470368810

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6163
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.106420e-01 1 1  ON 0
 uu_1                 1.436004e-01 1 1  ON 1
 uu_2                 4.212944e-02 1 1  ON 2
 uu_3                -2.019564e-02 1 1  ON 3
 uu_4                -6.550931e-02 1 1  ON 4
 uu_5                -1.000053e-01 1 1  ON 5
 uu_6                -1.270522e-01 1 1  ON 6
 uu_7                -1.403675e-01 1 1  ON 7
 uu_8                -1.325670e-01 1 1  ON 8
 uu_9                -1.013152e-01 1 1  ON 9
 ud_0                 4.478563e-01 1 1  ON 10
 ud_1                 1.820011e-01 1 1  ON 11
 ud_2                 6.129358e-02 1 1  ON 12
 ud_3                -9.868132e-03 1 1  ON 13
 ud_4                -6.667997e-02 1 1  ON 14
 ud_5                -1.077871e-01 1 1  ON 15
 ud_6                -1.348458e-01 1 1  ON 16
 ud_7                -1.505165e-01 1 1  ON 17
 ud_8                -1.510944e-01 1 1  ON 18
 ud_9                -1.391027e-01 1 1  ON 19
 eO_0                -7.568722e-01 1 1  ON 20
 eO_1                -4.359627e-01 1 1  ON 21
 eO_2                -1.918653e-02 1 1  ON 22
 eO_3                 2.975714e-01 1 1  ON 23
 eO_4                 5.214256e-01 1 1  ON 24
 eO_5                 4.813435e-01 1 1  ON 25
 eO_6                 2.507122e-01 1 1  ON 26
 eO_7                -4.785432e-02 1 1  ON 27
 eO_8                -2.154432e-01 1 1  ON 28
 eO_9                -7.588014e-02 1 1  ON 29
eH1_0                -2.453825e-01 1 1  ON 30
eH1_1                -1.425501e-01 1 1  ON 31
eH1_2                -9.509249e-02 1 1  ON 32
eH1_3                -4.052610e-02 1 1  ON 33
eH1_4                 7.827239e-03 1 1  ON 34
eH1_5                 4.192502e-02 1 1  ON 35
eH1_6                 9.952463e-02 1 1  ON 36
eH1_7                 1.520110e-01 1 1  ON 37
eH1_8                 1.700595e-01 1 1  ON 38
eH1_9                 5.624123e-02 1 1  ON 39
eH2_0                -2.436723e-01 1 1  ON 40
eH2_1                -1.401750e-01 1 1  ON 41
eH2_2                -9.248742e-02 1 1  ON 42
eH2_3                -3.836711e-02 1 1  ON 43
eH2_4                 1.030538e-02 1 1  ON 44
eH2_5                 4.517008e-02 1 1  ON 45
eH2_6                 1.022498e-01 1 1  ON 46
eH2_7                 1.551650e-01 1 1  ON 47
eH2_8                 1.755841e-01 1 1  ON 48
eH2_9                 4.232839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6788e+01 secs
  Total Execution time = 2.2888e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
