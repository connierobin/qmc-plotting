Rank =    0  Free Memory = 74821 MB
Rank =    1  Free Memory = 74821 MB
Rank =    2  Free Memory = 74821 MB
Rank =    3  Free Memory = 74821 MB
Rank =    4  Free Memory = 74820 MB
Rank =    5  Free Memory = 74820 MB
Rank =    6  Free Memory = 74820 MB
Rank =    7  Free Memory = 74820 MB
Rank =    8  Free Memory = 74820 MB
Rank =    9  Free Memory = 74820 MB
Rank =   10  Free Memory = 74820 MB
Rank =   11  Free Memory = 74820 MB
Rank =   12  Free Memory = 74820 MB
Rank =   13  Free Memory = 74820 MB
Rank =   14  Free Memory = 74819 MB
Rank =   15  Free Memory = 74809 MB
Rank =   16  Free Memory = 74805 MB
Rank =   17  Free Memory = 74805 MB
Rank =   18  Free Memory = 74805 MB
Rank =   19  Free Memory = 74805 MB
Rank =   20  Free Memory = 74805 MB
Rank =   21  Free Memory = 74805 MB
Rank =   22  Free Memory = 74805 MB
Rank =   23  Free Memory = 74805 MB
Rank =   24  Free Memory = 74805 MB
Rank =   25  Free Memory = 74805 MB
Rank =   26  Free Memory = 74805 MB
Rank =   27  Free Memory = 74805 MB
Rank =   28  Free Memory = 74805 MB
Rank =   29  Free Memory = 74805 MB
Rank =   30  Free Memory = 74805 MB
Rank =   31  Free Memory = 74805 MB
Rank =   32  Free Memory = 74854 MB
Rank =   33  Free Memory = 74854 MB
Rank =   34  Free Memory = 74854 MB
Rank =   35  Free Memory = 74854 MB
Rank =   36  Free Memory = 74854 MB
Rank =   37  Free Memory = 74854 MB
Rank =   38  Free Memory = 74854 MB
Rank =   39  Free Memory = 74854 MB
Rank =   40  Free Memory = 74854 MB
Rank =   41  Free Memory = 74854 MB
Rank =   42  Free Memory = 74854 MB
Rank =   43  Free Memory = 74854 MB
Rank =   44  Free Memory = 74854 MB
Rank =   45  Free Memory = 74854 MB
Rank =   46  Free Memory = 74853 MB
Rank =   47  Free Memory = 74853 MB
Rank =   48  Free Memory = 74853 MB
Rank =   49  Free Memory = 74853 MB
Rank =   50  Free Memory = 74853 MB
Rank =   51  Free Memory = 74853 MB
Rank =   52  Free Memory = 74853 MB
Rank =   53  Free Memory = 74853 MB
Rank =   54  Free Memory = 74853 MB
Rank =   55  Free Memory = 74853 MB
Rank =   56  Free Memory = 74853 MB
Rank =   57  Free Memory = 74853 MB
Rank =   58  Free Memory = 74853 MB
Rank =   59  Free Memory = 74853 MB
Rank =   60  Free Memory = 74853 MB
Rank =   61  Free Memory = 74853 MB
Rank =   62  Free Memory = 74853 MB
Rank =   63  Free Memory = 74853 MB
Rank =   64  Free Memory = 68656 MB
Rank =   65  Free Memory = 68656 MB
Rank =   66  Free Memory = 68656 MB
Rank =   67  Free Memory = 68656 MB
Rank =   68  Free Memory = 68656 MB
Rank =   69  Free Memory = 68656 MB
Rank =   70  Free Memory = 68656 MB
Rank =   71  Free Memory = 68656 MB
Rank =   72  Free Memory = 68656 MB
Rank =   73  Free Memory = 68656 MB
Rank =   74  Free Memory = 68656 MB
Rank =   75  Free Memory = 68656 MB
Rank =   76  Free Memory = 68656 MB
Rank =   77  Free Memory = 68656 MB
Rank =   78  Free Memory = 68656 MB
Rank =   79  Free Memory = 68656 MB
Rank =   80  Free Memory = 68656 MB
Rank =   81  Free Memory = 68656 MB
Rank =   82  Free Memory = 68656 MB
Rank =   83  Free Memory = 68656 MB
Rank =   84  Free Memory = 68656 MB
Rank =   85  Free Memory = 68656 MB
Rank =   86  Free Memory = 68656 MB
Rank =   87  Free Memory = 68656 MB
Rank =   88  Free Memory = 68656 MB
Rank =   89  Free Memory = 68656 MB
Rank =   90  Free Memory = 68656 MB
Rank =   91  Free Memory = 68656 MB
Rank =   92  Free Memory = 68656 MB
Rank =   93  Free Memory = 68656 MB
Rank =   94  Free Memory = 68656 MB
Rank =   95  Free Memory = 68656 MB
Rank =   96  Free Memory = 88058 MB
Rank =   97  Free Memory = 88058 MB
Rank =   98  Free Memory = 88058 MB
Rank =   99  Free Memory = 88058 MB
Rank =  100  Free Memory = 88058 MB
Rank =  101  Free Memory = 88058 MB
Rank =  102  Free Memory = 88058 MB
Rank =  103  Free Memory = 88058 MB
Rank =  104  Free Memory = 88058 MB
Rank =  105  Free Memory = 88058 MB
Rank =  106  Free Memory = 88058 MB
Rank =  107  Free Memory = 88058 MB
Rank =  108  Free Memory = 88058 MB
Rank =  109  Free Memory = 88058 MB
Rank =  110  Free Memory = 88057 MB
Rank =  111  Free Memory = 88057 MB
Rank =  112  Free Memory = 88057 MB
Rank =  113  Free Memory = 88057 MB
Rank =  114  Free Memory = 88057 MB
Rank =  115  Free Memory = 88057 MB
Rank =  116  Free Memory = 88057 MB
Rank =  117  Free Memory = 88057 MB
Rank =  118  Free Memory = 88057 MB
Rank =  119  Free Memory = 88057 MB
Rank =  120  Free Memory = 88057 MB
Rank =  121  Free Memory = 88057 MB
Rank =  122  Free Memory = 88057 MB
Rank =  123  Free Memory = 88057 MB
Rank =  124  Free Memory = 88057 MB
Rank =  125  Free Memory = 88057 MB
Rank =  126  Free Memory = 88057 MB
Rank =  127  Free Memory = 88057 MB
  Input file(s): opt_h2o_gs_lmcombci_run001a.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_lmcombci_run001a.xml

  Project = H2O
  date    = 2023-04-11 20:36:56 PDT
  host    = n0050.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 856

  Range of prime numbers to use as seeds over processors and threads = 6659-7789


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.061949e-01    1         1 OFF
     uu_1                 4.539117e-02    1         1 OFF
     uu_2                -4.680481e-02    1         1 OFF
     uu_3                -9.936272e-02    1         1 OFF
     uu_4                -1.304449e-01    1         1 OFF
     uu_5                -1.356413e-01    1         1 OFF
     uu_6                -1.130357e-01    1         1 OFF
     uu_7                -3.972344e-02    1         1 OFF
     uu_8                 9.988696e-02    1         1 OFF
     uu_9                 1.208933e-01    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.495801e-01    1         1 OFF
     ud_1                 9.178565e-02    1         1 OFF
     ud_2                -1.648758e-02    1         1 OFF
     ud_3                -7.596335e-02    1         1 OFF
     ud_4                -1.217524e-01    1         1 OFF
     ud_5                -1.523214e-01    1         1 OFF
     ud_6                -1.544624e-01    1         1 OFF
     ud_7                -1.100034e-01    1         1 OFF
     ud_8                 4.463187e-03    1         1 OFF
     ud_9                 9.258159e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.504332e-01    1         1 OFF
     eO_1                -4.354966e-01    1         1 OFF
     eO_2                -3.598301e-02    1         1 OFF
     eO_3                 2.081612e-01    1         1 OFF
     eO_4                 2.891481e-01    1         1 OFF
     eO_5                 3.052708e-01    1         1 OFF
     eO_6                 2.501148e-01    1         1 OFF
     eO_7                 1.121837e-01    1         1 OFF
     eO_8                 2.793060e-02    1         1 OFF
     eO_9                 1.846823e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.820113e-01    1         1 OFF
     eH1_1                -1.027126e-01    1         1 OFF
     eH1_2                -6.202978e-02    1         1 OFF
     eH1_3                -2.594624e-02    1         1 OFF
     eH1_4                 1.931583e-02    1         1 OFF
     eH1_5                 3.552903e-02    1         1 OFF
     eH1_6                 7.728065e-02    1         1 OFF
     eH1_7                 1.103061e-01    1         1 OFF
     eH1_8                 9.073801e-02    1         1 OFF
     eH1_9                 2.428776e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.835289e-01    1         1 OFF
     eH2_1                -1.038380e-01    1         1 OFF
     eH2_2                -6.350521e-02    1         1 OFF
     eH2_3                -2.706107e-02    1         1 OFF
     eH2_4                 1.856801e-02    1         1 OFF
     eH2_5                 3.504988e-02    1         1 OFF
     eH2_6                 7.827831e-02    1         1 OFF
     eH2_7                 1.134121e-01    1         1 OFF
     eH2_8                 9.397367e-02    1         1 OFF
     eH2_9                 2.639279e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.955546e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.3789e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2495
    reference variance = 0.326527
====================================================
  Execution time = 1.4058e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.7198e+01
  VMC Evar = 4.5808e-01
  Total weights = 1.953926458e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5159e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430710676073
                                         uncertainty =       0.003200904147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430710676073
                                         uncertainty =       0.003200904147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464048383
  error estimate for blocks of size 2^( 2) =       0.000476474632
  error estimate for blocks of size 2^( 3) =       0.000486450506
  error estimate for blocks of size 2^( 4) =       0.000494477390
  error estimate for blocks of size 2^( 5) =       0.000499263695
  error estimate for blocks of size 2^( 6) =       0.000501688061
  error estimate for blocks of size 2^( 7) =       0.000503415792

      target function =                  N/A
              le_mean =     -17.197500887376
             les_mean =     296.212116546270
             stat err =       0.000499711235
             autocorr =       1.159609326683
              std dev =       0.656263516664
             le_variance =       0.430681803304


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.719750088738e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.197500887599       residual = 4.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.207303182731       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.207677875310       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.207678593532       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.207678427316       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.207678382466       residual = 6.11e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.189417e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.197500887599       residual = 4.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.201750310576       residual = 8.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.201835008946       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.201834547455       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.201834439527       residual = 4.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 4.711813e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.197500887599       residual = 4.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.198801509101       residual = 7.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.198822306514       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.198822494879       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.198822430950       residual = 5.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.504972e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251067 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6830e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001 -6.185653e-02                3 1 ON  0
ci_002 -4.724328e-02                3 1 ON  1
ci_003 -3.484068e-02                3 1 ON  2
ci_004 3.378397e-02                 3 1 ON  3
ci_005 3.394570e-02                 3 1 ON  4
ci_006 -3.232021e-02                3 1 ON  5
ci_007 -3.179792e-02                3 1 ON  6
ci_008 -2.851566e-02                3 1 ON  7
ci_009 -2.704016e-02                3 1 ON  8
ci_010 -2.725344e-02                3 1 ON  9
ci_011 -2.635001e-02                3 1 ON  10
ci_012 -2.657755e-02                3 1 ON  11
ci_013 -2.574337e-02                3 1 ON  12
ci_014 2.399992e-02                 3 1 ON  13
ci_015 2.356664e-02                 3 1 ON  14
ci_016 2.306744e-02                 3 1 ON  15
ci_017 2.333122e-02                 3 1 ON  16
ci_018 2.242736e-02                 3 1 ON  17
ci_019 2.195427e-02                 3 1 ON  18
ci_020 2.247179e-02                 3 1 ON  19
ci_021 2.235550e-02                 3 1 ON  20
ci_022 1.958263e-02                 3 1 ON  21
ci_023 2.027265e-02                 3 1 ON  22
ci_024 2.054824e-02                 3 1 ON  23
ci_025 2.035022e-02                 3 1 ON  24
ci_026 1.987310e-02                 3 1 ON  25
ci_027 1.956368e-02                 3 1 ON  26
ci_028 -1.946629e-02                3 1 ON  27
ci_029 -1.962447e-02                3 1 ON  28
ci_030 -1.796158e-02                3 1 ON  29
ci_031 -1.803335e-02                3 1 ON  30
ci_032 -1.743371e-02                3 1 ON  31
ci_033 1.702288e-02                 3 1 ON  32
ci_034 1.699283e-02                 3 1 ON  33
ci_035 -1.429717e-02                3 1 ON  34
ci_036 -1.654011e-02                3 1 ON  35
ci_037 -1.650630e-02                3 1 ON  36
ci_038 1.298989e-02                 3 1 ON  37
ci_039 1.317897e-02                 3 1 ON  38
ci_040 -1.270884e-02                3 1 ON  39
ci_041 1.481653e-02                 3 1 ON  40
ci_042 1.453105e-02                 3 1 ON  41
ci_043 -1.255482e-02                3 1 ON  42
ci_044 -1.598332e-02                3 1 ON  43
ci_045 -1.163690e-02                3 1 ON  44
ci_046 1.315634e-02                 3 1 ON  45
ci_047 1.289238e-02                 3 1 ON  46
ci_048 -1.365730e-02                3 1 ON  47
ci_049 -1.341425e-02                3 1 ON  48
ci_050 1.188948e-02                 3 1 ON  49
ci_051 1.254362e-02                 3 1 ON  50
ci_052 -1.110809e-02                3 1 ON  51
ci_053 -1.152362e-02                3 1 ON  52
ci_054 -1.038892e-02                3 1 ON  53
ci_055 -1.042310e-02                3 1 ON  54
ci_056 1.047922e-02                 3 1 ON  55
ci_057 1.026667e-02                 3 1 ON  56
ci_058 -1.126111e-02                3 1 ON  57
ci_059 -1.134997e-02                3 1 ON  58
ci_060 1.165211e-02                 3 1 ON  59
ci_061 1.129937e-02                 3 1 ON  60
ci_062 -9.609929e-03                3 1 ON  61
ci_063 -9.688549e-03                3 1 ON  62
ci_064 -8.263038e-03                3 1 ON  63
ci_065 -8.550290e-03                3 1 ON  64
ci_066 9.311063e-03                 3 1 ON  65
ci_067 9.133357e-03                 3 1 ON  66
ci_068 -8.960334e-03                3 1 ON  67
ci_069 -8.723575e-03                3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2373
    reference variance = 0.296812
====================================================
  Execution time = 1.3380e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7205e+01
  VMC Evar = 3.9897e-01
  Total weights = 1.9548e+06
  Execution time = 1.8234e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0442419
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.306492422493
                                         uncertainty =       1.812383935448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.306492422493
                                         uncertainty =       1.812383935448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001074603263
  error estimate for blocks of size 2^( 2) =       0.001079756623
  error estimate for blocks of size 2^( 3) =       0.001084815879
  error estimate for blocks of size 2^( 4) =       0.001088318610
  error estimate for blocks of size 2^( 5) =       0.001091607619
  error estimate for blocks of size 2^( 6) =       0.001092883544
  error estimate for blocks of size 2^( 7) =       0.001093384856

      target function =                  N/A
              le_mean =     -17.206299477733
             les_mean =     311.694165684752
             stat err =       0.001091548657
             autocorr =       1.031786615466
              std dev =       1.519718508127
             le_variance =       2.309544343944

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0115064
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.412043897901
                                         uncertainty =       0.067844883173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.412043897901
                                         uncertainty =       0.067844883173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000453887205
  error estimate for blocks of size 2^( 2) =       0.000462859875
  error estimate for blocks of size 2^( 3) =       0.000470900291
  error estimate for blocks of size 2^( 4) =       0.000476176736
  error estimate for blocks of size 2^( 5) =       0.000480920727
  error estimate for blocks of size 2^( 6) =       0.000483210403
  error estimate for blocks of size 2^( 7) =       0.000483115748

      target function =                  N/A
              le_mean =     -17.207026792123
             les_mean =     296.807033088952
             stat err =       0.000480855904
             autocorr =       1.122364766050
              std dev =       0.641893440937
             le_variance =       0.412027189518

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0412382
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351676782556
                                         uncertainty =       0.006019720307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351676782556
                                         uncertainty =       0.006019720307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419273853
  error estimate for blocks of size 2^( 2) =       0.000429207748
  error estimate for blocks of size 2^( 3) =       0.000438283752
  error estimate for blocks of size 2^( 4) =       0.000444493557
  error estimate for blocks of size 2^( 5) =       0.000449941510
  error estimate for blocks of size 2^( 6) =       0.000452403599
  error estimate for blocks of size 2^( 7) =       0.000453243283

      target function =                  N/A
              le_mean =     -17.205922021547
             les_mean =     296.469581650159
             stat err =       0.000450020487
             autocorr =       1.152043855002
              std dev =       0.592942769123
             le_variance =       0.351581127456

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.177267
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512959563896
                                         uncertainty =       0.080462614518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512959563896
                                         uncertainty =       0.080462614518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506374309
  error estimate for blocks of size 2^( 2) =       0.000517121600
  error estimate for blocks of size 2^( 3) =       0.000526459782
  error estimate for blocks of size 2^( 4) =       0.000533004140
  error estimate for blocks of size 2^( 5) =       0.000539292383
  error estimate for blocks of size 2^( 6) =       0.000540758914
  error estimate for blocks of size 2^( 7) =       0.000541366522

      target function =                  N/A
              le_mean =     -17.205036919305
             les_mean =     359.775499230888
             stat err =       0.000538605490
             autocorr =       1.131353237962
              std dev =       0.716121415678
             le_variance =       0.512829881992


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.206299477733        initial
     2.5000e-01     2.5000e+00             1.1894e-02       -17.207026792123  <--
     1.0000e+00     1.0000e+01             4.7118e-03       -17.205922021547
     4.0000e+00     4.0000e+01             1.5050e-03       -17.205036919305

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.2593e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001                -5.451653e-02 3 1  ON 0
ci_002                -4.066646e-02 3 1  ON 1
ci_003                -3.160368e-02 3 1  ON 2
ci_004                 2.948460e-02 3 1  ON 3
ci_005                 2.985043e-02 3 1  ON 4
ci_006                -2.765150e-02 3 1  ON 5
ci_007                -2.644606e-02 3 1  ON 6
ci_008                -2.443530e-02 3 1  ON 7
ci_009                -2.364570e-02 3 1  ON 8
ci_010                -2.409497e-02 3 1  ON 9
ci_011                -2.270420e-02 3 1  ON 10
ci_012                -2.320760e-02 3 1  ON 11
ci_013                -2.376142e-02 3 1  ON 12
ci_014                 1.996598e-02 3 1  ON 13
ci_015                 1.895851e-02 3 1  ON 14
ci_016                 1.981258e-02 3 1  ON 15
ci_017                 2.038111e-02 3 1  ON 16
ci_018                 1.862622e-02 3 1  ON 17
ci_019                 1.768977e-02 3 1  ON 18
ci_020                 1.907197e-02 3 1  ON 19
ci_021                 1.876559e-02 3 1  ON 20
ci_022                 1.617055e-02 3 1  ON 21
ci_023                 1.762503e-02 3 1  ON 22
ci_024                 1.795621e-02 3 1  ON 23
ci_025                 1.748049e-02 3 1  ON 24
ci_026                 1.714504e-02 3 1  ON 25
ci_027                 1.652403e-02 3 1  ON 26
ci_028                -1.704661e-02 3 1  ON 27
ci_029                -1.743521e-02 3 1  ON 28
ci_030                -1.508660e-02 3 1  ON 29
ci_031                -1.519351e-02 3 1  ON 30
ci_032                -1.573599e-02 3 1  ON 31
ci_033                 1.478111e-02 3 1  ON 32
ci_034                 1.470950e-02 3 1  ON 33
ci_035                -9.817835e-03 3 1  ON 34
ci_036                -1.414950e-02 3 1  ON 35
ci_037                -1.401181e-02 3 1  ON 36
ci_038                 7.633612e-03 3 1  ON 37
ci_039                 7.984071e-03 3 1  ON 38
ci_040                -8.286707e-03 3 1  ON 39
ci_041                 1.248689e-02 3 1  ON 40
ci_042                 1.190309e-02 3 1  ON 41
ci_043                -8.216357e-03 3 1  ON 42
ci_044                -1.581098e-02 3 1  ON 43
ci_045                -6.936862e-03 3 1  ON 44
ci_046                 1.038331e-02 3 1  ON 45
ci_047                 9.793624e-03 3 1  ON 46
ci_048                -1.270318e-02 3 1  ON 47
ci_049                -1.205038e-02 3 1  ON 48
ci_050                 9.683207e-03 3 1  ON 49
ci_051                 1.100969e-02 3 1  ON 50
ci_052                -8.960753e-03 3 1  ON 51
ci_053                -9.817550e-03 3 1  ON 52
ci_054                -7.302980e-03 3 1  ON 53
ci_055                -7.362525e-03 3 1  ON 54
ci_056                 7.851707e-03 3 1  ON 55
ci_057                 7.333281e-03 3 1  ON 56
ci_058                -9.531409e-03 3 1  ON 57
ci_059                -9.734442e-03 3 1  ON 58
ci_060                 1.113858e-02 3 1  ON 59
ci_061                 1.028232e-02 3 1  ON 60
ci_062                -7.002581e-03 3 1  ON 61
ci_063                -7.216386e-03 3 1  ON 62
ci_064                -5.591563e-03 3 1  ON 63
ci_065                -6.207060e-03 3 1  ON 64
ci_066                 7.484611e-03 3 1  ON 65
ci_067                 7.048339e-03 3 1  ON 66
ci_068                -7.541423e-03 3 1  ON 67
ci_069                -6.976890e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9642e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7243e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2314
    reference variance = 0.332563
====================================================
  Execution time = 1.3722e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.5753e-01
  Total weights = 1.955392889e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4939e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337967888206
                                         uncertainty =       0.002828233504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337967888206
                                         uncertainty =       0.002828233504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411038458
  error estimate for blocks of size 2^( 2) =       0.000421218501
  error estimate for blocks of size 2^( 3) =       0.000430238740
  error estimate for blocks of size 2^( 4) =       0.000436391505
  error estimate for blocks of size 2^( 5) =       0.000439279514
  error estimate for blocks of size 2^( 6) =       0.000441672836
  error estimate for blocks of size 2^( 7) =       0.000441588906

      target function =                  N/A
              le_mean =     -17.212335698731
             les_mean =     296.622030843590
             stat err =       0.000439733191
             autocorr =       1.144494154769
              std dev =       0.581296161590
             le_variance =       0.337905227479


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721233569873e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212335698825       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215480096032       residual = 5.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215649634438       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215656468102       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215655221736       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215655581663       residual = 1.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.141606e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212335698825       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214400640009       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214458700848       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214458987152       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214458592174       residual = 5.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 6.727314e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212335698825       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213205629219       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213218257498       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213218574763       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213218523022       residual = 1.41e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.573441e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256332 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6228e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -4.778922e-02 3 1  ON 0
ci_002                -3.497039e-02 3 1  ON 1
ci_003                -2.956574e-02 3 1  ON 2
ci_004                 2.572396e-02 3 1  ON 3
ci_005                 2.603115e-02 3 1  ON 4
ci_006                -2.327186e-02 3 1  ON 5
ci_007                -2.238815e-02 3 1  ON 6
ci_008                -2.077064e-02 3 1  ON 7
ci_009                -2.088244e-02 3 1  ON 8
ci_010                -2.089875e-02 3 1  ON 9
ci_011                -1.970305e-02 3 1  ON 10
ci_012                -1.992761e-02 3 1  ON 11
ci_013                -2.228503e-02 3 1  ON 12
ci_014                 1.702192e-02 3 1  ON 13
ci_015                 1.627176e-02 3 1  ON 14
ci_016                 1.757514e-02 3 1  ON 15
ci_017                 1.812777e-02 3 1  ON 16
ci_018                 1.517373e-02 3 1  ON 17
ci_019                 1.472815e-02 3 1  ON 18
ci_020                 1.556771e-02 3 1  ON 19
ci_021                 1.594890e-02 3 1  ON 20
ci_022                 1.383094e-02 3 1  ON 21
ci_023                 1.485368e-02 3 1  ON 22
ci_024                 1.487705e-02 3 1  ON 23
ci_025                 1.516827e-02 3 1  ON 24
ci_026                 1.369436e-02 3 1  ON 25
ci_027                 1.361803e-02 3 1  ON 26
ci_028                -1.506458e-02 3 1  ON 27
ci_029                -1.562545e-02 3 1  ON 28
ci_030                -1.265954e-02 3 1  ON 29
ci_031                -1.229195e-02 3 1  ON 30
ci_032                -1.387835e-02 3 1  ON 31
ci_033                 1.279724e-02 3 1  ON 32
ci_034                 1.308615e-02 3 1  ON 33
ci_035                -6.468922e-03 3 1  ON 34
ci_036                -1.207669e-02 3 1  ON 35
ci_037                -1.194689e-02 3 1  ON 36
ci_038                 3.533996e-03 3 1  ON 37
ci_039                 4.130527e-03 3 1  ON 38
ci_040                -5.541251e-03 3 1  ON 39
ci_041                 1.090664e-02 3 1  ON 40
ci_042                 1.039458e-02 3 1  ON 41
ci_043                -5.217738e-03 3 1  ON 42
ci_044                -1.534595e-02 3 1  ON 43
ci_045                -3.749798e-03 3 1  ON 44
ci_046                 7.971878e-03 3 1  ON 45
ci_047                 7.214922e-03 3 1  ON 46
ci_048                -1.180827e-02 3 1  ON 47
ci_049                -1.159440e-02 3 1  ON 48
ci_050                 8.445775e-03 3 1  ON 49
ci_051                 8.990443e-03 3 1  ON 50
ci_052                -7.629988e-03 3 1  ON 51
ci_053                -8.107744e-03 3 1  ON 52
ci_054                -4.780478e-03 3 1  ON 53
ci_055                -4.890976e-03 3 1  ON 54
ci_056                 6.199603e-03 3 1  ON 55
ci_057                 5.534735e-03 3 1  ON 56
ci_058                -7.980481e-03 3 1  ON 57
ci_059                -8.585305e-03 3 1  ON 58
ci_060                 9.977522e-03 3 1  ON 59
ci_061                 8.969775e-03 3 1  ON 60
ci_062                -4.653324e-03 3 1  ON 61
ci_063                -5.156351e-03 3 1  ON 62
ci_064                -3.936288e-03 3 1  ON 63
ci_065                -4.829599e-03 3 1  ON 64
ci_066                 6.555600e-03 3 1  ON 65
ci_067                 5.920691e-03 3 1  ON 66
ci_068                -6.188970e-03 3 1  ON 67
ci_069                -5.667839e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2065
    reference variance = 0.255891
====================================================
  Execution time = 1.3322e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2736e-01
  Total weights = 1.9561e+06
  Execution time = 1.8155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363749215451
                                         uncertainty =       0.018087697460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363749215451
                                         uncertainty =       0.018087697460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426464116
  error estimate for blocks of size 2^( 2) =       0.000436703540
  error estimate for blocks of size 2^( 3) =       0.000444690330
  error estimate for blocks of size 2^( 4) =       0.000451246939
  error estimate for blocks of size 2^( 5) =       0.000454260234
  error estimate for blocks of size 2^( 6) =       0.000456056004
  error estimate for blocks of size 2^( 7) =       0.000458174516

      target function =                  N/A
              le_mean =     -17.216444452663
             les_mean =     297.034048367972
             stat err =       0.000454934423
             autocorr =       1.137974709803
              std dev =       0.603111336862
             le_variance =       0.363743284651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302572003390
                                         uncertainty =       0.002608564559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302572003390
                                         uncertainty =       0.002608564559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388936558
  error estimate for blocks of size 2^( 2) =       0.000399045210
  error estimate for blocks of size 2^( 3) =       0.000407239551
  error estimate for blocks of size 2^( 4) =       0.000414062447
  error estimate for blocks of size 2^( 5) =       0.000417282061
  error estimate for blocks of size 2^( 6) =       0.000419240303
  error estimate for blocks of size 2^( 7) =       0.000420833216

      target function =                  N/A
              le_mean =     -17.215745530597
             les_mean =     296.725145739417
             stat err =       0.000417854507
             autocorr =       1.154230771164
              std dev =       0.550039355261
             le_variance =       0.302543292335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300451412564
                                         uncertainty =       0.002762989460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300451412564
                                         uncertainty =       0.002762989460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387560599
  error estimate for blocks of size 2^( 2) =       0.000397855085
  error estimate for blocks of size 2^( 3) =       0.000406310430
  error estimate for blocks of size 2^( 4) =       0.000413319468
  error estimate for blocks of size 2^( 5) =       0.000416602577
  error estimate for blocks of size 2^( 6) =       0.000418554651
  error estimate for blocks of size 2^( 7) =       0.000419960866

      target function =                  N/A
              le_mean =     -17.216638602265
             les_mean =     296.926697095529
             stat err =       0.000417109390
             autocorr =       1.158299044013
              std dev =       0.548093454996
             le_variance =       0.300406435410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343075522750
                                         uncertainty =       0.010047060878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343075522750
                                         uncertainty =       0.010047060878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414158029
  error estimate for blocks of size 2^( 2) =       0.000424189250
  error estimate for blocks of size 2^( 3) =       0.000432023723
  error estimate for blocks of size 2^( 4) =       0.000438624965
  error estimate for blocks of size 2^( 5) =       0.000441912972
  error estimate for blocks of size 2^( 6) =       0.000443912884
  error estimate for blocks of size 2^( 7) =       0.000445321601

      target function =                  N/A
              le_mean =     -17.215614574569
             les_mean =     297.406499457453
             stat err =       0.000442443106
             autocorr =       1.141254998906
              std dev =       0.585707902150
             le_variance =       0.343053746641


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216444452663        initial
     6.2500e-02     6.2500e-01             1.1416e-02       -17.215745530597
     2.5000e-01     2.5000e+00             6.7273e-03       -17.216638602265  <--
     1.0000e+00     1.0000e+01             2.5734e-03       -17.215614574569

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.2502e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -4.778922e-02 3 1  ON 0
ci_002                -3.497039e-02 3 1  ON 1
ci_003                -2.956574e-02 3 1  ON 2
ci_004                 2.572396e-02 3 1  ON 3
ci_005                 2.603115e-02 3 1  ON 4
ci_006                -2.327186e-02 3 1  ON 5
ci_007                -2.238815e-02 3 1  ON 6
ci_008                -2.077064e-02 3 1  ON 7
ci_009                -2.088244e-02 3 1  ON 8
ci_010                -2.089875e-02 3 1  ON 9
ci_011                -1.970305e-02 3 1  ON 10
ci_012                -1.992761e-02 3 1  ON 11
ci_013                -2.228503e-02 3 1  ON 12
ci_014                 1.702192e-02 3 1  ON 13
ci_015                 1.627176e-02 3 1  ON 14
ci_016                 1.757514e-02 3 1  ON 15
ci_017                 1.812777e-02 3 1  ON 16
ci_018                 1.517373e-02 3 1  ON 17
ci_019                 1.472815e-02 3 1  ON 18
ci_020                 1.556771e-02 3 1  ON 19
ci_021                 1.594890e-02 3 1  ON 20
ci_022                 1.383094e-02 3 1  ON 21
ci_023                 1.485368e-02 3 1  ON 22
ci_024                 1.487705e-02 3 1  ON 23
ci_025                 1.516827e-02 3 1  ON 24
ci_026                 1.369436e-02 3 1  ON 25
ci_027                 1.361803e-02 3 1  ON 26
ci_028                -1.506458e-02 3 1  ON 27
ci_029                -1.562545e-02 3 1  ON 28
ci_030                -1.265954e-02 3 1  ON 29
ci_031                -1.229195e-02 3 1  ON 30
ci_032                -1.387835e-02 3 1  ON 31
ci_033                 1.279724e-02 3 1  ON 32
ci_034                 1.308615e-02 3 1  ON 33
ci_035                -6.468922e-03 3 1  ON 34
ci_036                -1.207669e-02 3 1  ON 35
ci_037                -1.194689e-02 3 1  ON 36
ci_038                 3.533996e-03 3 1  ON 37
ci_039                 4.130527e-03 3 1  ON 38
ci_040                -5.541251e-03 3 1  ON 39
ci_041                 1.090664e-02 3 1  ON 40
ci_042                 1.039458e-02 3 1  ON 41
ci_043                -5.217738e-03 3 1  ON 42
ci_044                -1.534595e-02 3 1  ON 43
ci_045                -3.749798e-03 3 1  ON 44
ci_046                 7.971878e-03 3 1  ON 45
ci_047                 7.214922e-03 3 1  ON 46
ci_048                -1.180827e-02 3 1  ON 47
ci_049                -1.159440e-02 3 1  ON 48
ci_050                 8.445775e-03 3 1  ON 49
ci_051                 8.990443e-03 3 1  ON 50
ci_052                -7.629988e-03 3 1  ON 51
ci_053                -8.107744e-03 3 1  ON 52
ci_054                -4.780478e-03 3 1  ON 53
ci_055                -4.890976e-03 3 1  ON 54
ci_056                 6.199603e-03 3 1  ON 55
ci_057                 5.534735e-03 3 1  ON 56
ci_058                -7.980481e-03 3 1  ON 57
ci_059                -8.585305e-03 3 1  ON 58
ci_060                 9.977522e-03 3 1  ON 59
ci_061                 8.969775e-03 3 1  ON 60
ci_062                -4.653324e-03 3 1  ON 61
ci_063                -5.156351e-03 3 1  ON 62
ci_064                -3.936288e-03 3 1  ON 63
ci_065                -4.829599e-03 3 1  ON 64
ci_066                 6.555600e-03 3 1  ON 65
ci_067                 5.920691e-03 3 1  ON 66
ci_068                -6.188970e-03 3 1  ON 67
ci_069                -5.667839e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8890e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7231e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2238
    reference variance = 0.267323
====================================================
  Execution time = 1.4022e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2677e-01
  Total weights = 1.956236232e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4595e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310403628057
                                         uncertainty =       0.001890713437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310403628057
                                         uncertainty =       0.001890713437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393939808
  error estimate for blocks of size 2^( 2) =       0.000403747725
  error estimate for blocks of size 2^( 3) =       0.000412213462
  error estimate for blocks of size 2^( 4) =       0.000418998122
  error estimate for blocks of size 2^( 5) =       0.000422833074
  error estimate for blocks of size 2^( 6) =       0.000424882802
  error estimate for blocks of size 2^( 7) =       0.000427906765

      target function =                  N/A
              le_mean =     -17.214906803217
             les_mean =     296.679782373472
             stat err =       0.000423655191
             autocorr =       1.156552429497
              std dev =       0.557115019777
             le_variance =       0.310377145262


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721490680322e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214906803281       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215640543503       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215673819559       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215674285591       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215674233939       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 4.556041e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214906803281       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215376068533       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215389034416       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215389349555       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215389461471       residual = 4.10e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 2.645036e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214906803281       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215098973538       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215103923390       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215104280923       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 9.954308e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.257840 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6487e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -4.514418e-02 3 1  ON 0
ci_002                -3.247184e-02 3 1  ON 1
ci_003                -2.779756e-02 3 1  ON 2
ci_004                 2.331448e-02 3 1  ON 3
ci_005                 2.397985e-02 3 1  ON 4
ci_006                -2.149965e-02 3 1  ON 5
ci_007                -2.076951e-02 3 1  ON 6
ci_008                -1.900187e-02 3 1  ON 7
ci_009                -1.904006e-02 3 1  ON 8
ci_010                -1.977532e-02 3 1  ON 9
ci_011                -1.819652e-02 3 1  ON 10
ci_012                -1.875650e-02 3 1  ON 11
ci_013                -2.020309e-02 3 1  ON 12
ci_014                 1.488348e-02 3 1  ON 13
ci_015                 1.466574e-02 3 1  ON 14
ci_016                 1.709493e-02 3 1  ON 15
ci_017                 1.733014e-02 3 1  ON 16
ci_018                 1.405266e-02 3 1  ON 17
ci_019                 1.393050e-02 3 1  ON 18
ci_020                 1.418863e-02 3 1  ON 19
ci_021                 1.435934e-02 3 1  ON 20
ci_022                 1.281142e-02 3 1  ON 21
ci_023                 1.281909e-02 3 1  ON 22
ci_024                 1.363378e-02 3 1  ON 23
ci_025                 1.334916e-02 3 1  ON 24
ci_026                 1.249488e-02 3 1  ON 25
ci_027                 1.254532e-02 3 1  ON 26
ci_028                -1.441914e-02 3 1  ON 27
ci_029                -1.449949e-02 3 1  ON 28
ci_030                -1.210968e-02 3 1  ON 29
ci_031                -1.158594e-02 3 1  ON 30
ci_032                -1.429573e-02 3 1  ON 31
ci_033                 1.215959e-02 3 1  ON 32
ci_034                 1.142554e-02 3 1  ON 33
ci_035                -5.129165e-03 3 1  ON 34
ci_036                -1.115772e-02 3 1  ON 35
ci_037                -1.117210e-02 3 1  ON 36
ci_038                 2.241718e-03 3 1  ON 37
ci_039                 2.529283e-03 3 1  ON 38
ci_040                -4.593171e-03 3 1  ON 39
ci_041                 1.007341e-02 3 1  ON 40
ci_042                 9.816741e-03 3 1  ON 41
ci_043                -3.820959e-03 3 1  ON 42
ci_044                -1.618637e-02 3 1  ON 43
ci_045                -2.500401e-03 3 1  ON 44
ci_046                 6.836578e-03 3 1  ON 45
ci_047                 6.735599e-03 3 1  ON 46
ci_048                -1.120716e-02 3 1  ON 47
ci_049                -1.135870e-02 3 1  ON 48
ci_050                 8.080123e-03 3 1  ON 49
ci_051                 7.641057e-03 3 1  ON 50
ci_052                -7.376698e-03 3 1  ON 51
ci_053                -7.183345e-03 3 1  ON 52
ci_054                -3.374280e-03 3 1  ON 53
ci_055                -4.200311e-03 3 1  ON 54
ci_056                 5.191678e-03 3 1  ON 55
ci_057                 5.012940e-03 3 1  ON 56
ci_058                -7.583883e-03 3 1  ON 57
ci_059                -7.473721e-03 3 1  ON 58
ci_060                 9.366329e-03 3 1  ON 59
ci_061                 8.506842e-03 3 1  ON 60
ci_062                -3.796367e-03 3 1  ON 61
ci_063                -3.950264e-03 3 1  ON 62
ci_064                -3.524877e-03 3 1  ON 63
ci_065                -4.306058e-03 3 1  ON 64
ci_066                 5.744339e-03 3 1  ON 65
ci_067                 6.072615e-03 3 1  ON 66
ci_068                -5.661549e-03 3 1  ON 67
ci_069                -5.435158e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2547
    reference variance = 0.197386
====================================================
  Execution time = 1.3545e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1975e-01
  Total weights = 1.9565e+06
  Execution time = 1.8164e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00105135
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.673992599970
                                         uncertainty =       0.357701857147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.673992599970
                                         uncertainty =       0.357701857147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000579735127
  error estimate for blocks of size 2^( 2) =       0.000586435622
  error estimate for blocks of size 2^( 3) =       0.000592639398
  error estimate for blocks of size 2^( 4) =       0.000596779237
  error estimate for blocks of size 2^( 5) =       0.000598556772
  error estimate for blocks of size 2^( 6) =       0.000600993532
  error estimate for blocks of size 2^( 7) =       0.000601153501

      target function =                  N/A
              le_mean =     -17.215464005352
             les_mean =     297.092840341816
             stat err =       0.000599370761
             autocorr =       1.068887194140
              std dev =       0.819869279313
             le_variance =       0.672185635161

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0143269
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305300549476
                                         uncertainty =       0.003474735174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305300549476
                                         uncertainty =       0.003474735174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390677721
  error estimate for blocks of size 2^( 2) =       0.000400296856
  error estimate for blocks of size 2^( 3) =       0.000409490587
  error estimate for blocks of size 2^( 4) =       0.000415697036
  error estimate for blocks of size 2^( 5) =       0.000418856174
  error estimate for blocks of size 2^( 6) =       0.000421489236
  error estimate for blocks of size 2^( 7) =       0.000423563474

      target function =                  N/A
              le_mean =     -17.215685366771
             les_mean =     297.442773701380
             stat err =       0.000419901480
             autocorr =       1.155200906536
              std dev =       0.552501730896
             le_variance =       0.305258162643

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00102729
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300297858080
                                         uncertainty =       0.001902658837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300297858080
                                         uncertainty =       0.001902658837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387463020
  error estimate for blocks of size 2^( 2) =       0.000397269271
  error estimate for blocks of size 2^( 3) =       0.000406611406
  error estimate for blocks of size 2^( 4) =       0.000413069509
  error estimate for blocks of size 2^( 5) =       0.000416193943
  error estimate for blocks of size 2^( 6) =       0.000418876500
  error estimate for blocks of size 2^( 7) =       0.000421209249

      target function =                  N/A
              le_mean =     -17.215906392109
             les_mean =     296.746130162063
             stat err =       0.000417337300
             autocorr =       1.160149313630
              std dev =       0.547955457273
             le_variance =       0.300255183155

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00740505
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316944105958
                                         uncertainty =       0.007072055667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316944105958
                                         uncertainty =       0.007072055667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398039632
  error estimate for blocks of size 2^( 2) =       0.000407545293
  error estimate for blocks of size 2^( 3) =       0.000416487894
  error estimate for blocks of size 2^( 4) =       0.000422728420
  error estimate for blocks of size 2^( 5) =       0.000425786730
  error estimate for blocks of size 2^( 6) =       0.000428246385
  error estimate for blocks of size 2^( 7) =       0.000430695547

      target function =                  N/A
              le_mean =     -17.215775135613
             les_mean =     296.715714464541
             stat err =       0.000426864270
             autocorr =       1.150077156341
              std dev =       0.562913045927
             le_variance =       0.316871097275


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215464005352        initial
     6.2500e-02     6.2500e-01             4.5560e-03       -17.215685366771
     2.5000e-01     2.5000e+00             2.6450e-03       -17.215906392109  <--
     1.0000e+00     1.0000e+01             9.9543e-04       -17.215775135613

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.2742e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -4.514418e-02 3 1  ON 0
ci_002                -3.247184e-02 3 1  ON 1
ci_003                -2.779756e-02 3 1  ON 2
ci_004                 2.331448e-02 3 1  ON 3
ci_005                 2.397985e-02 3 1  ON 4
ci_006                -2.149965e-02 3 1  ON 5
ci_007                -2.076951e-02 3 1  ON 6
ci_008                -1.900187e-02 3 1  ON 7
ci_009                -1.904006e-02 3 1  ON 8
ci_010                -1.977532e-02 3 1  ON 9
ci_011                -1.819652e-02 3 1  ON 10
ci_012                -1.875650e-02 3 1  ON 11
ci_013                -2.020309e-02 3 1  ON 12
ci_014                 1.488348e-02 3 1  ON 13
ci_015                 1.466574e-02 3 1  ON 14
ci_016                 1.709493e-02 3 1  ON 15
ci_017                 1.733014e-02 3 1  ON 16
ci_018                 1.405266e-02 3 1  ON 17
ci_019                 1.393050e-02 3 1  ON 18
ci_020                 1.418863e-02 3 1  ON 19
ci_021                 1.435934e-02 3 1  ON 20
ci_022                 1.281142e-02 3 1  ON 21
ci_023                 1.281909e-02 3 1  ON 22
ci_024                 1.363378e-02 3 1  ON 23
ci_025                 1.334916e-02 3 1  ON 24
ci_026                 1.249488e-02 3 1  ON 25
ci_027                 1.254532e-02 3 1  ON 26
ci_028                -1.441914e-02 3 1  ON 27
ci_029                -1.449949e-02 3 1  ON 28
ci_030                -1.210968e-02 3 1  ON 29
ci_031                -1.158594e-02 3 1  ON 30
ci_032                -1.429573e-02 3 1  ON 31
ci_033                 1.215959e-02 3 1  ON 32
ci_034                 1.142554e-02 3 1  ON 33
ci_035                -5.129165e-03 3 1  ON 34
ci_036                -1.115772e-02 3 1  ON 35
ci_037                -1.117210e-02 3 1  ON 36
ci_038                 2.241718e-03 3 1  ON 37
ci_039                 2.529283e-03 3 1  ON 38
ci_040                -4.593171e-03 3 1  ON 39
ci_041                 1.007341e-02 3 1  ON 40
ci_042                 9.816741e-03 3 1  ON 41
ci_043                -3.820959e-03 3 1  ON 42
ci_044                -1.618637e-02 3 1  ON 43
ci_045                -2.500401e-03 3 1  ON 44
ci_046                 6.836578e-03 3 1  ON 45
ci_047                 6.735599e-03 3 1  ON 46
ci_048                -1.120716e-02 3 1  ON 47
ci_049                -1.135870e-02 3 1  ON 48
ci_050                 8.080123e-03 3 1  ON 49
ci_051                 7.641057e-03 3 1  ON 50
ci_052                -7.376698e-03 3 1  ON 51
ci_053                -7.183345e-03 3 1  ON 52
ci_054                -3.374280e-03 3 1  ON 53
ci_055                -4.200311e-03 3 1  ON 54
ci_056                 5.191678e-03 3 1  ON 55
ci_057                 5.012940e-03 3 1  ON 56
ci_058                -7.583883e-03 3 1  ON 57
ci_059                -7.473721e-03 3 1  ON 58
ci_060                 9.366329e-03 3 1  ON 59
ci_061                 8.506842e-03 3 1  ON 60
ci_062                -3.796367e-03 3 1  ON 61
ci_063                -3.950264e-03 3 1  ON 62
ci_064                -3.524877e-03 3 1  ON 63
ci_065                -4.306058e-03 3 1  ON 64
ci_066                 5.744339e-03 3 1  ON 65
ci_067                 6.072615e-03 3 1  ON 66
ci_068                -5.661549e-03 3 1  ON 67
ci_069                -5.435158e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9375e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7234e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1974
    reference variance = 0.230371
====================================================
  Execution time = 1.4197e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1916e-01
  Total weights = 1.956409254e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4993e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304090921102
                                         uncertainty =       0.001683621714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304090921102
                                         uncertainty =       0.001683621714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389849520
  error estimate for blocks of size 2^( 2) =       0.000400216172
  error estimate for blocks of size 2^( 3) =       0.000408975234
  error estimate for blocks of size 2^( 4) =       0.000415801398
  error estimate for blocks of size 2^( 5) =       0.000419912486
  error estimate for blocks of size 2^( 6) =       0.000423167351
  error estimate for blocks of size 2^( 7) =       0.000421739808

      target function =                  N/A
              le_mean =     -17.215964946148
             les_mean =     296.708610002519
             stat err =       0.000420155261
             autocorr =       1.161517089246
              std dev =       0.551330478243
             le_variance =       0.303965296240


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721596494615e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215964946180       residual = 7.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216169531544       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216182128852       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216183202339       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216183444747       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 4.227347e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215964946180       residual = 7.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216092143168       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216097072090       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216097101913       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216097104289       residual = 3.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 2.435357e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215964946180       residual = 7.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216015559367       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216016872717       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216016909373       residual = 1.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 9.097842e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.262583 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6708e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -4.270883e-02 3 1  ON 0
ci_002                -3.154004e-02 3 1  ON 1
ci_003                -2.732202e-02 3 1  ON 2
ci_004                 2.242821e-02 3 1  ON 3
ci_005                 2.259669e-02 3 1  ON 4
ci_006                -2.021602e-02 3 1  ON 5
ci_007                -1.979032e-02 3 1  ON 6
ci_008                -1.851673e-02 3 1  ON 7
ci_009                -1.784717e-02 3 1  ON 8
ci_010                -1.857793e-02 3 1  ON 9
ci_011                -1.756429e-02 3 1  ON 10
ci_012                -1.750050e-02 3 1  ON 11
ci_013                -1.990460e-02 3 1  ON 12
ci_014                 1.476433e-02 3 1  ON 13
ci_015                 1.422319e-02 3 1  ON 14
ci_016                 1.699528e-02 3 1  ON 15
ci_017                 1.670010e-02 3 1  ON 16
ci_018                 1.328739e-02 3 1  ON 17
ci_019                 1.287770e-02 3 1  ON 18
ci_020                 1.371527e-02 3 1  ON 19
ci_021                 1.354868e-02 3 1  ON 20
ci_022                 1.200825e-02 3 1  ON 21
ci_023                 1.159271e-02 3 1  ON 22
ci_024                 1.285409e-02 3 1  ON 23
ci_025                 1.240222e-02 3 1  ON 24
ci_026                 1.158679e-02 3 1  ON 25
ci_027                 1.197045e-02 3 1  ON 26
ci_028                -1.414579e-02 3 1  ON 27
ci_029                -1.472591e-02 3 1  ON 28
ci_030                -1.193228e-02 3 1  ON 29
ci_031                -1.079875e-02 3 1  ON 30
ci_032                -1.426480e-02 3 1  ON 31
ci_033                 1.157684e-02 3 1  ON 32
ci_034                 1.090464e-02 3 1  ON 33
ci_035                -4.730904e-03 3 1  ON 34
ci_036                -1.066711e-02 3 1  ON 35
ci_037                -1.073584e-02 3 1  ON 36
ci_038                 1.872068e-03 3 1  ON 37
ci_039                 2.319353e-03 3 1  ON 38
ci_040                -4.235917e-03 3 1  ON 39
ci_041                 9.882196e-03 3 1  ON 40
ci_042                 9.706855e-03 3 1  ON 41
ci_043                -3.202250e-03 3 1  ON 42
ci_044                -1.651394e-02 3 1  ON 43
ci_045                -2.080677e-03 3 1  ON 44
ci_046                 5.818272e-03 3 1  ON 45
ci_047                 6.257692e-03 3 1  ON 46
ci_048                -1.151150e-02 3 1  ON 47
ci_049                -1.136507e-02 3 1  ON 48
ci_050                 8.128682e-03 3 1  ON 49
ci_051                 7.751887e-03 3 1  ON 50
ci_052                -7.008906e-03 3 1  ON 51
ci_053                -6.879517e-03 3 1  ON 52
ci_054                -3.043782e-03 3 1  ON 53
ci_055                -3.569972e-03 3 1  ON 54
ci_056                 4.555876e-03 3 1  ON 55
ci_057                 4.739134e-03 3 1  ON 56
ci_058                -7.098722e-03 3 1  ON 57
ci_059                -6.697242e-03 3 1  ON 58
ci_060                 8.763677e-03 3 1  ON 59
ci_061                 8.447512e-03 3 1  ON 60
ci_062                -3.528538e-03 3 1  ON 61
ci_063                -3.161004e-03 3 1  ON 62
ci_064                -3.388108e-03 3 1  ON 63
ci_065                -3.812922e-03 3 1  ON 64
ci_066                 5.551154e-03 3 1  ON 65
ci_067                 5.911126e-03 3 1  ON 66
ci_068                -4.795853e-03 3 1  ON 67
ci_069                -4.606792e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.3333
    reference variance = 0.362217
====================================================
  Execution time = 1.4153e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2141e-01
  Total weights = 1.9560e+06
  Execution time = 1.8222e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309404586149
                                         uncertainty =       0.002684480612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309404586149
                                         uncertainty =       0.002684480612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393374689
  error estimate for blocks of size 2^( 2) =       0.000402908774
  error estimate for blocks of size 2^( 3) =       0.000411320525
  error estimate for blocks of size 2^( 4) =       0.000417875332
  error estimate for blocks of size 2^( 5) =       0.000422605632
  error estimate for blocks of size 2^( 6) =       0.000424332061
  error estimate for blocks of size 2^( 7) =       0.000426052801

      target function =                  N/A
              le_mean =     -17.216145375328
             les_mean =     296.740181446580
             stat err =       0.000422716457
             autocorr =       1.154743394216
              std dev =       0.556315819919
             le_variance =       0.309487291492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303967604348
                                         uncertainty =       0.002631609750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303967604348
                                         uncertainty =       0.002631609750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389900733
  error estimate for blocks of size 2^( 2) =       0.000399597161
  error estimate for blocks of size 2^( 3) =       0.000408223736
  error estimate for blocks of size 2^( 4) =       0.000414998743
  error estimate for blocks of size 2^( 5) =       0.000419730811
  error estimate for blocks of size 2^( 6) =       0.000421579759
  error estimate for blocks of size 2^( 7) =       0.000423049609

      target function =                  N/A
              le_mean =     -17.216100036777
             les_mean =     296.767659315905
             stat err =       0.000419839731
             autocorr =       1.159468533536
              std dev =       0.551402903938
             le_variance =       0.304045162472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314830848397
                                         uncertainty =       0.012060390946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314830848397
                                         uncertainty =       0.012060390946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396800557
  error estimate for blocks of size 2^( 2) =       0.000406348967
  error estimate for blocks of size 2^( 3) =       0.000414887314
  error estimate for blocks of size 2^( 4) =       0.000421574226
  error estimate for blocks of size 2^( 5) =       0.000426084943
  error estimate for blocks of size 2^( 6) =       0.000427935095
  error estimate for blocks of size 2^( 7) =       0.000429183706

      target function =                  N/A
              le_mean =     -17.216234557941
             les_mean =     297.911598297936
             stat err =       0.000426194492
             autocorr =       1.153642160967
              std dev =       0.561160729678
             le_variance =       0.314901364533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307522422988
                                         uncertainty =       0.002650912558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307522422988
                                         uncertainty =       0.002650912558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392175860
  error estimate for blocks of size 2^( 2) =       0.000401741428
  error estimate for blocks of size 2^( 3) =       0.000410197525
  error estimate for blocks of size 2^( 4) =       0.000416817346
  error estimate for blocks of size 2^( 5) =       0.000421542504
  error estimate for blocks of size 2^( 6) =       0.000423317191
  error estimate for blocks of size 2^( 7) =       0.000424969999

      target function =                  N/A
              le_mean =     -17.216099963624
             les_mean =     296.721569115838
             stat err =       0.000421661760
             autocorr =       1.156023650439
              std dev =       0.554620420126
             le_variance =       0.307603810421


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216145375328        initial
     6.2500e-02     6.2500e-01             4.2273e-03       -17.216100036777
     2.5000e-01     2.5000e+00             2.4354e-03       -17.216234557941  <--
     1.0000e+00     1.0000e+01             9.0978e-04       -17.216099963624

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.3340e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -4.270883e-02 3 1  ON 0
ci_002                -3.154004e-02 3 1  ON 1
ci_003                -2.732202e-02 3 1  ON 2
ci_004                 2.242821e-02 3 1  ON 3
ci_005                 2.259669e-02 3 1  ON 4
ci_006                -2.021602e-02 3 1  ON 5
ci_007                -1.979032e-02 3 1  ON 6
ci_008                -1.851673e-02 3 1  ON 7
ci_009                -1.784717e-02 3 1  ON 8
ci_010                -1.857793e-02 3 1  ON 9
ci_011                -1.756429e-02 3 1  ON 10
ci_012                -1.750050e-02 3 1  ON 11
ci_013                -1.990460e-02 3 1  ON 12
ci_014                 1.476433e-02 3 1  ON 13
ci_015                 1.422319e-02 3 1  ON 14
ci_016                 1.699528e-02 3 1  ON 15
ci_017                 1.670010e-02 3 1  ON 16
ci_018                 1.328739e-02 3 1  ON 17
ci_019                 1.287770e-02 3 1  ON 18
ci_020                 1.371527e-02 3 1  ON 19
ci_021                 1.354868e-02 3 1  ON 20
ci_022                 1.200825e-02 3 1  ON 21
ci_023                 1.159271e-02 3 1  ON 22
ci_024                 1.285409e-02 3 1  ON 23
ci_025                 1.240222e-02 3 1  ON 24
ci_026                 1.158679e-02 3 1  ON 25
ci_027                 1.197045e-02 3 1  ON 26
ci_028                -1.414579e-02 3 1  ON 27
ci_029                -1.472591e-02 3 1  ON 28
ci_030                -1.193228e-02 3 1  ON 29
ci_031                -1.079875e-02 3 1  ON 30
ci_032                -1.426480e-02 3 1  ON 31
ci_033                 1.157684e-02 3 1  ON 32
ci_034                 1.090464e-02 3 1  ON 33
ci_035                -4.730904e-03 3 1  ON 34
ci_036                -1.066711e-02 3 1  ON 35
ci_037                -1.073584e-02 3 1  ON 36
ci_038                 1.872068e-03 3 1  ON 37
ci_039                 2.319353e-03 3 1  ON 38
ci_040                -4.235917e-03 3 1  ON 39
ci_041                 9.882196e-03 3 1  ON 40
ci_042                 9.706855e-03 3 1  ON 41
ci_043                -3.202250e-03 3 1  ON 42
ci_044                -1.651394e-02 3 1  ON 43
ci_045                -2.080677e-03 3 1  ON 44
ci_046                 5.818272e-03 3 1  ON 45
ci_047                 6.257692e-03 3 1  ON 46
ci_048                -1.151150e-02 3 1  ON 47
ci_049                -1.136507e-02 3 1  ON 48
ci_050                 8.128682e-03 3 1  ON 49
ci_051                 7.751887e-03 3 1  ON 50
ci_052                -7.008906e-03 3 1  ON 51
ci_053                -6.879517e-03 3 1  ON 52
ci_054                -3.043782e-03 3 1  ON 53
ci_055                -3.569972e-03 3 1  ON 54
ci_056                 4.555876e-03 3 1  ON 55
ci_057                 4.739134e-03 3 1  ON 56
ci_058                -7.098722e-03 3 1  ON 57
ci_059                -6.697242e-03 3 1  ON 58
ci_060                 8.763677e-03 3 1  ON 59
ci_061                 8.447512e-03 3 1  ON 60
ci_062                -3.528538e-03 3 1  ON 61
ci_063                -3.161004e-03 3 1  ON 62
ci_064                -3.388108e-03 3 1  ON 63
ci_065                -3.812922e-03 3 1  ON 64
ci_066                 5.551154e-03 3 1  ON 65
ci_067                 5.911126e-03 3 1  ON 66
ci_068                -4.795853e-03 3 1  ON 67
ci_069                -4.606792e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0479e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7242e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1737
    reference variance = 0.224638
====================================================
  Execution time = 1.3810e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3522e-01
  Total weights = 1.956455155e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4706e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302445568759
                                         uncertainty =       0.001875003058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302445568759
                                         uncertainty =       0.001875003058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388831624
  error estimate for blocks of size 2^( 2) =       0.000398927753
  error estimate for blocks of size 2^( 3) =       0.000408080841
  error estimate for blocks of size 2^( 4) =       0.000414702634
  error estimate for blocks of size 2^( 5) =       0.000419026709
  error estimate for blocks of size 2^( 6) =       0.000422089738
  error estimate for blocks of size 2^( 7) =       0.000422406798

      target function =                  N/A
              le_mean =     -17.216526874488
             les_mean =     296.744018390653
             stat err =       0.000419556470
             autocorr =       1.164280669771
              std dev =       0.549890955980
             le_variance =       0.302380063468


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721652687449e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216526874549       residual = 4.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216630609499       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216627031901       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216627614963       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216627952835       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 2.751266e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216526874549       residual = 4.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216590241975       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216589149376       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216589623344       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216589704294       residual = 2.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.518528e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216526874549       residual = 4.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216551660494       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216552342937       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216552429609       residual = 8.92e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 5.555549e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.267403 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6293e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -4.129352e-02 3 1  ON 0
ci_002                -3.019625e-02 3 1  ON 1
ci_003                -2.647952e-02 3 1  ON 2
ci_004                 2.168210e-02 3 1  ON 3
ci_005                 2.107816e-02 3 1  ON 4
ci_006                -1.949552e-02 3 1  ON 5
ci_007                -1.921287e-02 3 1  ON 6
ci_008                -1.838326e-02 3 1  ON 7
ci_009                -1.765978e-02 3 1  ON 8
ci_010                -1.771016e-02 3 1  ON 9
ci_011                -1.705331e-02 3 1  ON 10
ci_012                -1.697848e-02 3 1  ON 11
ci_013                -1.950841e-02 3 1  ON 12
ci_014                 1.431117e-02 3 1  ON 13
ci_015                 1.436566e-02 3 1  ON 14
ci_016                 1.690530e-02 3 1  ON 15
ci_017                 1.584256e-02 3 1  ON 16
ci_018                 1.315762e-02 3 1  ON 17
ci_019                 1.310002e-02 3 1  ON 18
ci_020                 1.396700e-02 3 1  ON 19
ci_021                 1.388683e-02 3 1  ON 20
ci_022                 1.220179e-02 3 1  ON 21
ci_023                 1.113701e-02 3 1  ON 22
ci_024                 1.201115e-02 3 1  ON 23
ci_025                 1.152900e-02 3 1  ON 24
ci_026                 1.158824e-02 3 1  ON 25
ci_027                 1.147689e-02 3 1  ON 26
ci_028                -1.401377e-02 3 1  ON 27
ci_029                -1.482739e-02 3 1  ON 28
ci_030                -1.140156e-02 3 1  ON 29
ci_031                -1.108053e-02 3 1  ON 30
ci_032                -1.389143e-02 3 1  ON 31
ci_033                 1.035369e-02 3 1  ON 32
ci_034                 1.073376e-02 3 1  ON 33
ci_035                -5.040564e-03 3 1  ON 34
ci_036                -1.096826e-02 3 1  ON 35
ci_037                -1.036204e-02 3 1  ON 36
ci_038                 1.560876e-03 3 1  ON 37
ci_039                 2.249291e-03 3 1  ON 38
ci_040                -3.975243e-03 3 1  ON 39
ci_041                 9.218254e-03 3 1  ON 40
ci_042                 1.011450e-02 3 1  ON 41
ci_043                -2.842052e-03 3 1  ON 42
ci_044                -1.503012e-02 3 1  ON 43
ci_045                -1.678972e-03 3 1  ON 44
ci_046                 6.506376e-03 3 1  ON 45
ci_047                 6.042189e-03 3 1  ON 46
ci_048                -1.181893e-02 3 1  ON 47
ci_049                -1.123247e-02 3 1  ON 48
ci_050                 7.505264e-03 3 1  ON 49
ci_051                 7.341061e-03 3 1  ON 50
ci_052                -6.906576e-03 3 1  ON 51
ci_053                -6.881626e-03 3 1  ON 52
ci_054                -3.401678e-03 3 1  ON 53
ci_055                -3.132427e-03 3 1  ON 54
ci_056                 4.142760e-03 3 1  ON 55
ci_057                 4.901552e-03 3 1  ON 56
ci_058                -6.535484e-03 3 1  ON 57
ci_059                -6.282958e-03 3 1  ON 58
ci_060                 8.375783e-03 3 1  ON 59
ci_061                 8.620540e-03 3 1  ON 60
ci_062                -3.154077e-03 3 1  ON 61
ci_063                -3.065681e-03 3 1  ON 62
ci_064                -2.883811e-03 3 1  ON 63
ci_065                -4.028261e-03 3 1  ON 64
ci_066                 5.864483e-03 3 1  ON 65
ci_067                 5.495804e-03 3 1  ON 66
ci_068                -4.473792e-03 3 1  ON 67
ci_069                -4.678421e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1371
    reference variance = 0.225024
====================================================
  Execution time = 1.3755e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2416e-01
  Total weights = 1.9565e+06
  Execution time = 1.8189e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0628701
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308074354292
                                         uncertainty =       0.005476079199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308074354292
                                         uncertainty =       0.005476079199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392404560
  error estimate for blocks of size 2^( 2) =       0.000402270265
  error estimate for blocks of size 2^( 3) =       0.000411339758
  error estimate for blocks of size 2^( 4) =       0.000418053009
  error estimate for blocks of size 2^( 5) =       0.000422269714
  error estimate for blocks of size 2^( 6) =       0.000424761597
  error estimate for blocks of size 2^( 7) =       0.000425967843

      target function =                  N/A
              le_mean =     -17.216582295275
             les_mean =     296.868033469302
             stat err =       0.000422763041
             autocorr =       1.160715903637
              std dev =       0.554943850738
             le_variance =       0.307962677472

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.189062
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304599482549
                                         uncertainty =       0.005359844858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304599482549
                                         uncertainty =       0.005359844858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390188479
  error estimate for blocks of size 2^( 2) =       0.000400191754
  error estimate for blocks of size 2^( 3) =       0.000409448770
  error estimate for blocks of size 2^( 4) =       0.000416305127
  error estimate for blocks of size 2^( 5) =       0.000420595929
  error estimate for blocks of size 2^( 6) =       0.000423196990
  error estimate for blocks of size 2^( 7) =       0.000424358931

      target function =                  N/A
              le_mean =     -17.216581435973
             les_mean =     296.735955996536
             stat err =       0.000421114244
             autocorr =       1.164798975241
              std dev =       0.551809839016
             le_variance =       0.304494098434

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0606387
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304155660043
                                         uncertainty =       0.005359191722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304155660043
                                         uncertainty =       0.005359191722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389904668
  error estimate for blocks of size 2^( 2) =       0.000399948967
  error estimate for blocks of size 2^( 3) =       0.000409243699
  error estimate for blocks of size 2^( 4) =       0.000416130233
  error estimate for blocks of size 2^( 5) =       0.000420435660
  error estimate for blocks of size 2^( 6) =       0.000423068795
  error estimate for blocks of size 2^( 7) =       0.000424229105

      target function =                  N/A
              le_mean =     -17.216611226058
             les_mean =     296.758265033499
             stat err =       0.000420965948
             autocorr =       1.165673880265
              std dev =       0.551408469921
             le_variance =       0.304051300701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307490149103
                                         uncertainty =       0.005507484223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307490149103
                                         uncertainty =       0.005507484223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392032551
  error estimate for blocks of size 2^( 2) =       0.000401924543
  error estimate for blocks of size 2^( 3) =       0.000411043334
  error estimate for blocks of size 2^( 4) =       0.000417789717
  error estimate for blocks of size 2^( 5) =       0.000421998122
  error estimate for blocks of size 2^( 6) =       0.000424473370
  error estimate for blocks of size 2^( 7) =       0.000425677143

      target function =                  N/A
              le_mean =     -17.216547957089
             les_mean =     296.887246216139
             stat err =       0.000422484588
             autocorr =       1.161388399435
              std dev =       0.554417751031
             le_variance =       0.307379042658


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216582295275        initial
     6.2500e-02     6.2500e-01             2.7513e-03       -17.216581435973
     2.5000e-01     2.5000e+00             1.5185e-03       -17.216611226058  <--
     1.0000e+00     1.0000e+01             5.5555e-04       -17.216547957089

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.2957e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -4.129352e-02 3 1  ON 0
ci_002                -3.019625e-02 3 1  ON 1
ci_003                -2.647952e-02 3 1  ON 2
ci_004                 2.168210e-02 3 1  ON 3
ci_005                 2.107816e-02 3 1  ON 4
ci_006                -1.949552e-02 3 1  ON 5
ci_007                -1.921287e-02 3 1  ON 6
ci_008                -1.838326e-02 3 1  ON 7
ci_009                -1.765978e-02 3 1  ON 8
ci_010                -1.771016e-02 3 1  ON 9
ci_011                -1.705331e-02 3 1  ON 10
ci_012                -1.697848e-02 3 1  ON 11
ci_013                -1.950841e-02 3 1  ON 12
ci_014                 1.431117e-02 3 1  ON 13
ci_015                 1.436566e-02 3 1  ON 14
ci_016                 1.690530e-02 3 1  ON 15
ci_017                 1.584256e-02 3 1  ON 16
ci_018                 1.315762e-02 3 1  ON 17
ci_019                 1.310002e-02 3 1  ON 18
ci_020                 1.396700e-02 3 1  ON 19
ci_021                 1.388683e-02 3 1  ON 20
ci_022                 1.220179e-02 3 1  ON 21
ci_023                 1.113701e-02 3 1  ON 22
ci_024                 1.201115e-02 3 1  ON 23
ci_025                 1.152900e-02 3 1  ON 24
ci_026                 1.158824e-02 3 1  ON 25
ci_027                 1.147689e-02 3 1  ON 26
ci_028                -1.401377e-02 3 1  ON 27
ci_029                -1.482739e-02 3 1  ON 28
ci_030                -1.140156e-02 3 1  ON 29
ci_031                -1.108053e-02 3 1  ON 30
ci_032                -1.389143e-02 3 1  ON 31
ci_033                 1.035369e-02 3 1  ON 32
ci_034                 1.073376e-02 3 1  ON 33
ci_035                -5.040564e-03 3 1  ON 34
ci_036                -1.096826e-02 3 1  ON 35
ci_037                -1.036204e-02 3 1  ON 36
ci_038                 1.560876e-03 3 1  ON 37
ci_039                 2.249291e-03 3 1  ON 38
ci_040                -3.975243e-03 3 1  ON 39
ci_041                 9.218254e-03 3 1  ON 40
ci_042                 1.011450e-02 3 1  ON 41
ci_043                -2.842052e-03 3 1  ON 42
ci_044                -1.503012e-02 3 1  ON 43
ci_045                -1.678972e-03 3 1  ON 44
ci_046                 6.506376e-03 3 1  ON 45
ci_047                 6.042189e-03 3 1  ON 46
ci_048                -1.181893e-02 3 1  ON 47
ci_049                -1.123247e-02 3 1  ON 48
ci_050                 7.505264e-03 3 1  ON 49
ci_051                 7.341061e-03 3 1  ON 50
ci_052                -6.906576e-03 3 1  ON 51
ci_053                -6.881626e-03 3 1  ON 52
ci_054                -3.401678e-03 3 1  ON 53
ci_055                -3.132427e-03 3 1  ON 54
ci_056                 4.142760e-03 3 1  ON 55
ci_057                 4.901552e-03 3 1  ON 56
ci_058                -6.535484e-03 3 1  ON 57
ci_059                -6.282958e-03 3 1  ON 58
ci_060                 8.375783e-03 3 1  ON 59
ci_061                 8.620540e-03 3 1  ON 60
ci_062                -3.154077e-03 3 1  ON 61
ci_063                -3.065681e-03 3 1  ON 62
ci_064                -2.883811e-03 3 1  ON 63
ci_065                -4.028261e-03 3 1  ON 64
ci_066                 5.864483e-03 3 1  ON 65
ci_067                 5.495804e-03 3 1  ON 66
ci_068                -4.473792e-03 3 1  ON 67
ci_069                -4.678421e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9272e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1677
    reference variance = 0.231162
====================================================
  Execution time = 1.4051e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1435e-01
  Total weights = 1.956350838e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301174889379
                                         uncertainty =       0.002285527515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301174889379
                                         uncertainty =       0.002285527515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388008178
  error estimate for blocks of size 2^( 2) =       0.000397827019
  error estimate for blocks of size 2^( 3) =       0.000406499360
  error estimate for blocks of size 2^( 4) =       0.000412893760
  error estimate for blocks of size 2^( 5) =       0.000416740182
  error estimate for blocks of size 2^( 6) =       0.000420255287
  error estimate for blocks of size 2^( 7) =       0.000423153186

      target function =                  N/A
              le_mean =     -17.216127973270
             les_mean =     296.709416938932
             stat err =       0.000418260604
             autocorr =       1.162016142053
              std dev =       0.548726427899
             le_variance =       0.301100692675


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721612797327e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216127973341       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216163490518       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216166155892       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216165651779       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216165667660       residual = 1.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.418924e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216127973341       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216150586144       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216151036594       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216150691114       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 8.945682e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216127973341       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216137190576       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216136870456       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216136832244       residual = 3.48e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.600958e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.271971 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6538e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -4.084842e-02 3 1  ON 0
ci_002                -3.057864e-02 3 1  ON 1
ci_003                -2.596329e-02 3 1  ON 2
ci_004                 2.130299e-02 3 1  ON 3
ci_005                 2.097486e-02 3 1  ON 4
ci_006                -1.940961e-02 3 1  ON 5
ci_007                -1.877334e-02 3 1  ON 6
ci_008                -1.815155e-02 3 1  ON 7
ci_009                -1.719519e-02 3 1  ON 8
ci_010                -1.750885e-02 3 1  ON 9
ci_011                -1.681731e-02 3 1  ON 10
ci_012                -1.659933e-02 3 1  ON 11
ci_013                -1.950010e-02 3 1  ON 12
ci_014                 1.418477e-02 3 1  ON 13
ci_015                 1.404293e-02 3 1  ON 14
ci_016                 1.674653e-02 3 1  ON 15
ci_017                 1.583584e-02 3 1  ON 16
ci_018                 1.265234e-02 3 1  ON 17
ci_019                 1.324653e-02 3 1  ON 18
ci_020                 1.330981e-02 3 1  ON 19
ci_021                 1.333442e-02 3 1  ON 20
ci_022                 1.130722e-02 3 1  ON 21
ci_023                 1.182476e-02 3 1  ON 22
ci_024                 1.259087e-02 3 1  ON 23
ci_025                 1.105505e-02 3 1  ON 24
ci_026                 1.108023e-02 3 1  ON 25
ci_027                 1.155655e-02 3 1  ON 26
ci_028                -1.392138e-02 3 1  ON 27
ci_029                -1.461338e-02 3 1  ON 28
ci_030                -1.177396e-02 3 1  ON 29
ci_031                -1.106250e-02 3 1  ON 30
ci_032                -1.376163e-02 3 1  ON 31
ci_033                 1.025118e-02 3 1  ON 32
ci_034                 1.061622e-02 3 1  ON 33
ci_035                -4.507779e-03 3 1  ON 34
ci_036                -1.069948e-02 3 1  ON 35
ci_037                -1.044329e-02 3 1  ON 36
ci_038                 1.605746e-03 3 1  ON 37
ci_039                 2.050119e-03 3 1  ON 38
ci_040                -4.068947e-03 3 1  ON 39
ci_041                 9.556365e-03 3 1  ON 40
ci_042                 9.941920e-03 3 1  ON 41
ci_043                -2.947005e-03 3 1  ON 42
ci_044                -1.506539e-02 3 1  ON 43
ci_045                -1.762662e-03 3 1  ON 44
ci_046                 6.031878e-03 3 1  ON 45
ci_047                 5.881194e-03 3 1  ON 46
ci_048                -1.171986e-02 3 1  ON 47
ci_049                -1.114117e-02 3 1  ON 48
ci_050                 7.607441e-03 3 1  ON 49
ci_051                 7.082298e-03 3 1  ON 50
ci_052                -6.710923e-03 3 1  ON 51
ci_053                -6.949178e-03 3 1  ON 52
ci_054                -3.212032e-03 3 1  ON 53
ci_055                -3.298906e-03 3 1  ON 54
ci_056                 4.494115e-03 3 1  ON 55
ci_057                 4.926343e-03 3 1  ON 56
ci_058                -6.503962e-03 3 1  ON 57
ci_059                -6.455227e-03 3 1  ON 58
ci_060                 8.127506e-03 3 1  ON 59
ci_061                 8.261780e-03 3 1  ON 60
ci_062                -3.488640e-03 3 1  ON 61
ci_063                -3.050735e-03 3 1  ON 62
ci_064                -3.196790e-03 3 1  ON 63
ci_065                -4.313481e-03 3 1  ON 64
ci_066                 5.578797e-03 3 1  ON 65
ci_067                 5.960403e-03 3 1  ON 66
ci_068                -4.805865e-03 3 1  ON 67
ci_069                -4.295895e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1839
    reference variance = 0.146241
====================================================
  Execution time = 1.3435e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1980e-01
  Total weights = 1.9567e+06
  Execution time = 1.8162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303617523223
                                         uncertainty =       0.002247970301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303617523223
                                         uncertainty =       0.002247970301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389579004
  error estimate for blocks of size 2^( 2) =       0.000399406853
  error estimate for blocks of size 2^( 3) =       0.000408259103
  error estimate for blocks of size 2^( 4) =       0.000414561571
  error estimate for blocks of size 2^( 5) =       0.000418647516
  error estimate for blocks of size 2^( 6) =       0.000420523883
  error estimate for blocks of size 2^( 7) =       0.000421209365

      target function =                  N/A
              le_mean =     -17.216675240161
             les_mean =     296.735519157175
             stat err =       0.000418735584
             autocorr =       1.155283713575
              std dev =       0.550947910982
             le_variance =       0.303543600615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302878777594
                                         uncertainty =       0.002255743434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302878777594
                                         uncertainty =       0.002255743434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389104547
  error estimate for blocks of size 2^( 2) =       0.000398966249
  error estimate for blocks of size 2^( 3) =       0.000407875870
  error estimate for blocks of size 2^( 4) =       0.000414255868
  error estimate for blocks of size 2^( 5) =       0.000418353664
  error estimate for blocks of size 2^( 6) =       0.000420241274
  error estimate for blocks of size 2^( 7) =       0.000420935173

      target function =                  N/A
              le_mean =     -17.216657573669
             les_mean =     296.799910472450
             stat err =       0.000418446495
             autocorr =       1.156504312256
              std dev =       0.550276927753
             le_variance =       0.302804697218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310086165693
                                         uncertainty =       0.006945548826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310086165693
                                         uncertainty =       0.006945548826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393703965
  error estimate for blocks of size 2^( 2) =       0.000403491050
  error estimate for blocks of size 2^( 3) =       0.000412335195
  error estimate for blocks of size 2^( 4) =       0.000418638163
  error estimate for blocks of size 2^( 5) =       0.000422530660
  error estimate for blocks of size 2^( 6) =       0.000424512217
  error estimate for blocks of size 2^( 7) =       0.000424992134

      target function =                  N/A
              le_mean =     -17.216696219714
             les_mean =     298.346472453596
             stat err =       0.000422668294
             autocorr =       1.152549967896
              std dev =       0.556781487287
             le_variance =       0.310005624586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303341238407
                                         uncertainty =       0.002244557837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303341238407
                                         uncertainty =       0.002244557837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389401716
  error estimate for blocks of size 2^( 2) =       0.000399238967
  error estimate for blocks of size 2^( 3) =       0.000408103095
  error estimate for blocks of size 2^( 4) =       0.000414426527
  error estimate for blocks of size 2^( 5) =       0.000418517556
  error estimate for blocks of size 2^( 6) =       0.000420404992
  error estimate for blocks of size 2^( 7) =       0.000421087496

      target function =                  N/A
              le_mean =     -17.216660872531
             les_mean =     296.745027546003
             stat err =       0.000418609143
             autocorr =       1.155637686514
              std dev =       0.550697188202
             le_variance =       0.303267393093


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216675240161        initial
     6.2500e-02     6.2500e-01             1.4189e-03       -17.216657573669
     2.5000e-01     2.5000e+00             8.9457e-04       -17.216696219714  <--
     1.0000e+00     1.0000e+01             3.6010e-04       -17.216660872531

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.2641e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -4.084842e-02 3 1  ON 0
ci_002                -3.057864e-02 3 1  ON 1
ci_003                -2.596329e-02 3 1  ON 2
ci_004                 2.130299e-02 3 1  ON 3
ci_005                 2.097486e-02 3 1  ON 4
ci_006                -1.940961e-02 3 1  ON 5
ci_007                -1.877334e-02 3 1  ON 6
ci_008                -1.815155e-02 3 1  ON 7
ci_009                -1.719519e-02 3 1  ON 8
ci_010                -1.750885e-02 3 1  ON 9
ci_011                -1.681731e-02 3 1  ON 10
ci_012                -1.659933e-02 3 1  ON 11
ci_013                -1.950010e-02 3 1  ON 12
ci_014                 1.418477e-02 3 1  ON 13
ci_015                 1.404293e-02 3 1  ON 14
ci_016                 1.674653e-02 3 1  ON 15
ci_017                 1.583584e-02 3 1  ON 16
ci_018                 1.265234e-02 3 1  ON 17
ci_019                 1.324653e-02 3 1  ON 18
ci_020                 1.330981e-02 3 1  ON 19
ci_021                 1.333442e-02 3 1  ON 20
ci_022                 1.130722e-02 3 1  ON 21
ci_023                 1.182476e-02 3 1  ON 22
ci_024                 1.259087e-02 3 1  ON 23
ci_025                 1.105505e-02 3 1  ON 24
ci_026                 1.108023e-02 3 1  ON 25
ci_027                 1.155655e-02 3 1  ON 26
ci_028                -1.392138e-02 3 1  ON 27
ci_029                -1.461338e-02 3 1  ON 28
ci_030                -1.177396e-02 3 1  ON 29
ci_031                -1.106250e-02 3 1  ON 30
ci_032                -1.376163e-02 3 1  ON 31
ci_033                 1.025118e-02 3 1  ON 32
ci_034                 1.061622e-02 3 1  ON 33
ci_035                -4.507779e-03 3 1  ON 34
ci_036                -1.069948e-02 3 1  ON 35
ci_037                -1.044329e-02 3 1  ON 36
ci_038                 1.605746e-03 3 1  ON 37
ci_039                 2.050119e-03 3 1  ON 38
ci_040                -4.068947e-03 3 1  ON 39
ci_041                 9.556365e-03 3 1  ON 40
ci_042                 9.941920e-03 3 1  ON 41
ci_043                -2.947005e-03 3 1  ON 42
ci_044                -1.506539e-02 3 1  ON 43
ci_045                -1.762662e-03 3 1  ON 44
ci_046                 6.031878e-03 3 1  ON 45
ci_047                 5.881194e-03 3 1  ON 46
ci_048                -1.171986e-02 3 1  ON 47
ci_049                -1.114117e-02 3 1  ON 48
ci_050                 7.607441e-03 3 1  ON 49
ci_051                 7.082298e-03 3 1  ON 50
ci_052                -6.710923e-03 3 1  ON 51
ci_053                -6.949178e-03 3 1  ON 52
ci_054                -3.212032e-03 3 1  ON 53
ci_055                -3.298906e-03 3 1  ON 54
ci_056                 4.494115e-03 3 1  ON 55
ci_057                 4.926343e-03 3 1  ON 56
ci_058                -6.503962e-03 3 1  ON 57
ci_059                -6.455227e-03 3 1  ON 58
ci_060                 8.127506e-03 3 1  ON 59
ci_061                 8.261780e-03 3 1  ON 60
ci_062                -3.488640e-03 3 1  ON 61
ci_063                -3.050735e-03 3 1  ON 62
ci_064                -3.196790e-03 3 1  ON 63
ci_065                -4.313481e-03 3 1  ON 64
ci_066                 5.578797e-03 3 1  ON 65
ci_067                 5.960403e-03 3 1  ON 66
ci_068                -4.805865e-03 3 1  ON 67
ci_069                -4.295895e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9629e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.19
    reference variance = 0.379803
====================================================
  Execution time = 1.3973e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1617e-01
  Total weights = 1.956764981e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4732e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300800099975
                                         uncertainty =       0.001724213423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300800099975
                                         uncertainty =       0.001724213423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387990285
  error estimate for blocks of size 2^( 2) =       0.000397999829
  error estimate for blocks of size 2^( 3) =       0.000406899908
  error estimate for blocks of size 2^( 4) =       0.000413869547
  error estimate for blocks of size 2^( 5) =       0.000418090857
  error estimate for blocks of size 2^( 6) =       0.000419645998
  error estimate for blocks of size 2^( 7) =       0.000420654034

      target function =                  N/A
              le_mean =     -17.216596323593
             les_mean =     296.727362021071
             stat err =       0.000418065109
             autocorr =       1.161037222841
              std dev =       0.548701123794
             le_variance =       0.301072923253


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721659632359e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216596323617       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216612651338       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216615049876       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216615072021       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216615253336       residual = 5.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.181340e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216596323617       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216606722741       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216607746420       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216607751088       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 7.754196e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216596323617       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216600563998       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216600806619       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216600844401       residual = 1.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.259344e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.276489 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6458e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -4.071723e-02 3 1  ON 0
ci_002                -3.014560e-02 3 1  ON 1
ci_003                -2.595955e-02 3 1  ON 2
ci_004                 2.105274e-02 3 1  ON 3
ci_005                 2.095873e-02 3 1  ON 4
ci_006                -1.974685e-02 3 1  ON 5
ci_007                -1.886853e-02 3 1  ON 6
ci_008                -1.798245e-02 3 1  ON 7
ci_009                -1.760751e-02 3 1  ON 8
ci_010                -1.744012e-02 3 1  ON 9
ci_011                -1.652101e-02 3 1  ON 10
ci_012                -1.672684e-02 3 1  ON 11
ci_013                -1.941557e-02 3 1  ON 12
ci_014                 1.440143e-02 3 1  ON 13
ci_015                 1.403634e-02 3 1  ON 14
ci_016                 1.633233e-02 3 1  ON 15
ci_017                 1.614388e-02 3 1  ON 16
ci_018                 1.267762e-02 3 1  ON 17
ci_019                 1.321316e-02 3 1  ON 18
ci_020                 1.272442e-02 3 1  ON 19
ci_021                 1.310964e-02 3 1  ON 20
ci_022                 1.107350e-02 3 1  ON 21
ci_023                 1.154561e-02 3 1  ON 22
ci_024                 1.236198e-02 3 1  ON 23
ci_025                 1.129945e-02 3 1  ON 24
ci_026                 1.109730e-02 3 1  ON 25
ci_027                 1.094170e-02 3 1  ON 26
ci_028                -1.378521e-02 3 1  ON 27
ci_029                -1.469821e-02 3 1  ON 28
ci_030                -1.173949e-02 3 1  ON 29
ci_031                -1.134529e-02 3 1  ON 30
ci_032                -1.349361e-02 3 1  ON 31
ci_033                 1.008153e-02 3 1  ON 32
ci_034                 1.074603e-02 3 1  ON 33
ci_035                -4.458686e-03 3 1  ON 34
ci_036                -1.044292e-02 3 1  ON 35
ci_037                -1.018010e-02 3 1  ON 36
ci_038                 1.500125e-03 3 1  ON 37
ci_039                 1.901610e-03 3 1  ON 38
ci_040                -3.814162e-03 3 1  ON 39
ci_041                 9.449036e-03 3 1  ON 40
ci_042                 9.872850e-03 3 1  ON 41
ci_043                -2.904721e-03 3 1  ON 42
ci_044                -1.500218e-02 3 1  ON 43
ci_045                -1.914101e-03 3 1  ON 44
ci_046                 6.087066e-03 3 1  ON 45
ci_047                 5.355310e-03 3 1  ON 46
ci_048                -1.185792e-02 3 1  ON 47
ci_049                -1.105446e-02 3 1  ON 48
ci_050                 7.830959e-03 3 1  ON 49
ci_051                 7.336894e-03 3 1  ON 50
ci_052                -6.625490e-03 3 1  ON 51
ci_053                -7.048570e-03 3 1  ON 52
ci_054                -3.369922e-03 3 1  ON 53
ci_055                -3.147715e-03 3 1  ON 54
ci_056                 4.505040e-03 3 1  ON 55
ci_057                 5.286831e-03 3 1  ON 56
ci_058                -7.279382e-03 3 1  ON 57
ci_059                -6.505999e-03 3 1  ON 58
ci_060                 7.799136e-03 3 1  ON 59
ci_061                 8.476975e-03 3 1  ON 60
ci_062                -3.142135e-03 3 1  ON 61
ci_063                -3.583459e-03 3 1  ON 62
ci_064                -3.036201e-03 3 1  ON 63
ci_065                -4.269181e-03 3 1  ON 64
ci_066                 5.694857e-03 3 1  ON 65
ci_067                 5.642710e-03 3 1  ON 66
ci_068                -4.821198e-03 3 1  ON 67
ci_069                -4.269673e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.3006
    reference variance = 0.221405
====================================================
  Execution time = 1.5587e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1564e-01
  Total weights = 1.9569e+06
  Execution time = 1.8359e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301990232367
                                         uncertainty =       0.002186597051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301990232367
                                         uncertainty =       0.002186597051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388601548
  error estimate for blocks of size 2^( 2) =       0.000398395536
  error estimate for blocks of size 2^( 3) =       0.000407399615
  error estimate for blocks of size 2^( 4) =       0.000413730995
  error estimate for blocks of size 2^( 5) =       0.000418017341
  error estimate for blocks of size 2^( 6) =       0.000421022789
  error estimate for blocks of size 2^( 7) =       0.000423684089

      target function =                  N/A
              le_mean =     -17.217077142926
             les_mean =     296.916106562507
             stat err =       0.000419113803
             autocorr =       1.163201289587
              std dev =       0.549565580224
             le_variance =       0.302022326967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302258207434
                                         uncertainty =       0.002188121811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302258207434
                                         uncertainty =       0.002188121811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388772862
  error estimate for blocks of size 2^( 2) =       0.000398555114
  error estimate for blocks of size 2^( 3) =       0.000407550593
  error estimate for blocks of size 2^( 4) =       0.000413894760
  error estimate for blocks of size 2^( 5) =       0.000418198201
  error estimate for blocks of size 2^( 6) =       0.000421206496
  error estimate for blocks of size 2^( 7) =       0.000423848107

      target function =                  N/A
              le_mean =     -17.217074297866
             les_mean =     296.746870953179
             stat err =       0.000419286891
             autocorr =       1.163136502412
              std dev =       0.549807853955
             le_variance =       0.302288676271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302417768076
                                         uncertainty =       0.002190850391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302417768076
                                         uncertainty =       0.002190850391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388875207
  error estimate for blocks of size 2^( 2) =       0.000398656108
  error estimate for blocks of size 2^( 3) =       0.000407648643
  error estimate for blocks of size 2^( 4) =       0.000413993416
  error estimate for blocks of size 2^( 5) =       0.000418301119
  error estimate for blocks of size 2^( 6) =       0.000421312255
  error estimate for blocks of size 2^( 7) =       0.000423953188

      target function =                  N/A
              le_mean =     -17.217081631714
             les_mean =     296.744930299714
             stat err =       0.000419389995
             autocorr =       1.163096156542
              std dev =       0.549952591477
             le_variance =       0.302447852872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301991609585
                                         uncertainty =       0.002188064346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301991609585
                                         uncertainty =       0.002188064346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388602171
  error estimate for blocks of size 2^( 2) =       0.000398392275
  error estimate for blocks of size 2^( 3) =       0.000407394099
  error estimate for blocks of size 2^( 4) =       0.000413731350
  error estimate for blocks of size 2^( 5) =       0.000418021960
  error estimate for blocks of size 2^( 6) =       0.000421032216
  error estimate for blocks of size 2^( 7) =       0.000423685223

      target function =                  N/A
              le_mean =     -17.217071866007
             les_mean =     296.753265491317
             stat err =       0.000419117687
             autocorr =       1.163219121568
              std dev =       0.549566460791
             le_variance =       0.302023294827


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217077142926        initial
     6.2500e-02     6.2500e-01             1.1813e-03       -17.217074297866
     2.5000e-01     2.5000e+00             7.7542e-04       -17.217081631714  <--
     1.0000e+00     1.0000e+01             3.2593e-04       -17.217071866007

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.4786e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -4.071723e-02 3 1  ON 0
ci_002                -3.014560e-02 3 1  ON 1
ci_003                -2.595955e-02 3 1  ON 2
ci_004                 2.105274e-02 3 1  ON 3
ci_005                 2.095873e-02 3 1  ON 4
ci_006                -1.974685e-02 3 1  ON 5
ci_007                -1.886853e-02 3 1  ON 6
ci_008                -1.798245e-02 3 1  ON 7
ci_009                -1.760751e-02 3 1  ON 8
ci_010                -1.744012e-02 3 1  ON 9
ci_011                -1.652101e-02 3 1  ON 10
ci_012                -1.672684e-02 3 1  ON 11
ci_013                -1.941557e-02 3 1  ON 12
ci_014                 1.440143e-02 3 1  ON 13
ci_015                 1.403634e-02 3 1  ON 14
ci_016                 1.633233e-02 3 1  ON 15
ci_017                 1.614388e-02 3 1  ON 16
ci_018                 1.267762e-02 3 1  ON 17
ci_019                 1.321316e-02 3 1  ON 18
ci_020                 1.272442e-02 3 1  ON 19
ci_021                 1.310964e-02 3 1  ON 20
ci_022                 1.107350e-02 3 1  ON 21
ci_023                 1.154561e-02 3 1  ON 22
ci_024                 1.236198e-02 3 1  ON 23
ci_025                 1.129945e-02 3 1  ON 24
ci_026                 1.109730e-02 3 1  ON 25
ci_027                 1.094170e-02 3 1  ON 26
ci_028                -1.378521e-02 3 1  ON 27
ci_029                -1.469821e-02 3 1  ON 28
ci_030                -1.173949e-02 3 1  ON 29
ci_031                -1.134529e-02 3 1  ON 30
ci_032                -1.349361e-02 3 1  ON 31
ci_033                 1.008153e-02 3 1  ON 32
ci_034                 1.074603e-02 3 1  ON 33
ci_035                -4.458686e-03 3 1  ON 34
ci_036                -1.044292e-02 3 1  ON 35
ci_037                -1.018010e-02 3 1  ON 36
ci_038                 1.500125e-03 3 1  ON 37
ci_039                 1.901610e-03 3 1  ON 38
ci_040                -3.814162e-03 3 1  ON 39
ci_041                 9.449036e-03 3 1  ON 40
ci_042                 9.872850e-03 3 1  ON 41
ci_043                -2.904721e-03 3 1  ON 42
ci_044                -1.500218e-02 3 1  ON 43
ci_045                -1.914101e-03 3 1  ON 44
ci_046                 6.087066e-03 3 1  ON 45
ci_047                 5.355310e-03 3 1  ON 46
ci_048                -1.185792e-02 3 1  ON 47
ci_049                -1.105446e-02 3 1  ON 48
ci_050                 7.830959e-03 3 1  ON 49
ci_051                 7.336894e-03 3 1  ON 50
ci_052                -6.625490e-03 3 1  ON 51
ci_053                -7.048570e-03 3 1  ON 52
ci_054                -3.369922e-03 3 1  ON 53
ci_055                -3.147715e-03 3 1  ON 54
ci_056                 4.505040e-03 3 1  ON 55
ci_057                 5.286831e-03 3 1  ON 56
ci_058                -7.279382e-03 3 1  ON 57
ci_059                -6.505999e-03 3 1  ON 58
ci_060                 7.799136e-03 3 1  ON 59
ci_061                 8.476975e-03 3 1  ON 60
ci_062                -3.142135e-03 3 1  ON 61
ci_063                -3.583459e-03 3 1  ON 62
ci_064                -3.036201e-03 3 1  ON 63
ci_065                -4.269181e-03 3 1  ON 64
ci_066                 5.694857e-03 3 1  ON 65
ci_067                 5.642710e-03 3 1  ON 66
ci_068                -4.821198e-03 3 1  ON 67
ci_069                -4.269673e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1276e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2519
    reference variance = 0.463092
====================================================
  Execution time = 1.3704e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0857e-01
  Total weights = 1.956506162e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4739e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294803585049
                                         uncertainty =       0.001692697316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294803585049
                                         uncertainty =       0.001692697316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383968077
  error estimate for blocks of size 2^( 2) =       0.000394105549
  error estimate for blocks of size 2^( 3) =       0.000403123791
  error estimate for blocks of size 2^( 4) =       0.000409328254
  error estimate for blocks of size 2^( 5) =       0.000413788673
  error estimate for blocks of size 2^( 6) =       0.000415239356
  error estimate for blocks of size 2^( 7) =       0.000415298388

      target function =                  N/A
              le_mean =     -17.216347261042
             les_mean =     296.711183230562
             stat err =       0.000413413668
             autocorr =       1.159256192480
              std dev =       0.543012861581
             le_variance =       0.294862967843


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721634726104e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216347261129       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216354336200       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216353600800       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216353606365       residual = 9.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.046663e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216347261129       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216351683401       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216351166876       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216351101912       residual = 8.73e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.931392e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216347261129       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216349030178       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216348809078       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216348774749       residual = 1.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.332137e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.277772 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6182e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -4.068412e-02 3 1  ON 0
ci_002                -3.009240e-02 3 1  ON 1
ci_003                -2.599303e-02 3 1  ON 2
ci_004                 2.129726e-02 3 1  ON 3
ci_005                 2.044463e-02 3 1  ON 4
ci_006                -1.976987e-02 3 1  ON 5
ci_007                -1.849278e-02 3 1  ON 6
ci_008                -1.764063e-02 3 1  ON 7
ci_009                -1.756229e-02 3 1  ON 8
ci_010                -1.798366e-02 3 1  ON 9
ci_011                -1.660048e-02 3 1  ON 10
ci_012                -1.638631e-02 3 1  ON 11
ci_013                -1.921666e-02 3 1  ON 12
ci_014                 1.424760e-02 3 1  ON 13
ci_015                 1.392695e-02 3 1  ON 14
ci_016                 1.613302e-02 3 1  ON 15
ci_017                 1.630779e-02 3 1  ON 16
ci_018                 1.267472e-02 3 1  ON 17
ci_019                 1.286023e-02 3 1  ON 18
ci_020                 1.331756e-02 3 1  ON 19
ci_021                 1.302925e-02 3 1  ON 20
ci_022                 1.114310e-02 3 1  ON 21
ci_023                 1.119885e-02 3 1  ON 22
ci_024                 1.210298e-02 3 1  ON 23
ci_025                 1.110674e-02 3 1  ON 24
ci_026                 1.114055e-02 3 1  ON 25
ci_027                 1.099631e-02 3 1  ON 26
ci_028                -1.400087e-02 3 1  ON 27
ci_029                -1.423042e-02 3 1  ON 28
ci_030                -1.158549e-02 3 1  ON 29
ci_031                -1.125226e-02 3 1  ON 30
ci_032                -1.350348e-02 3 1  ON 31
ci_033                 1.058479e-02 3 1  ON 32
ci_034                 1.017603e-02 3 1  ON 33
ci_035                -4.687665e-03 3 1  ON 34
ci_036                -1.028854e-02 3 1  ON 35
ci_037                -1.043167e-02 3 1  ON 36
ci_038                 1.491961e-03 3 1  ON 37
ci_039                 1.830697e-03 3 1  ON 38
ci_040                -3.913398e-03 3 1  ON 39
ci_041                 9.444935e-03 3 1  ON 40
ci_042                 9.740657e-03 3 1  ON 41
ci_043                -3.146481e-03 3 1  ON 42
ci_044                -1.537413e-02 3 1  ON 43
ci_045                -1.695898e-03 3 1  ON 44
ci_046                 6.024104e-03 3 1  ON 45
ci_047                 5.539638e-03 3 1  ON 46
ci_048                -1.173490e-02 3 1  ON 47
ci_049                -1.104317e-02 3 1  ON 48
ci_050                 7.861968e-03 3 1  ON 49
ci_051                 7.375540e-03 3 1  ON 50
ci_052                -6.446497e-03 3 1  ON 51
ci_053                -6.666080e-03 3 1  ON 52
ci_054                -3.172493e-03 3 1  ON 53
ci_055                -3.272193e-03 3 1  ON 54
ci_056                 4.658868e-03 3 1  ON 55
ci_057                 4.759255e-03 3 1  ON 56
ci_058                -6.840397e-03 3 1  ON 57
ci_059                -6.846184e-03 3 1  ON 58
ci_060                 7.658295e-03 3 1  ON 59
ci_061                 8.396882e-03 3 1  ON 60
ci_062                -3.101315e-03 3 1  ON 61
ci_063                -3.551450e-03 3 1  ON 62
ci_064                -3.102171e-03 3 1  ON 63
ci_065                -4.307809e-03 3 1  ON 64
ci_066                 5.530899e-03 3 1  ON 65
ci_067                 5.469145e-03 3 1  ON 66
ci_068                -4.536343e-03 3 1  ON 67
ci_069                -4.862416e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2159
    reference variance = 0.180588
====================================================
  Execution time = 1.3502e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1709e-01
  Total weights = 1.9566e+06
  Execution time = 1.8096e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299808352683
                                         uncertainty =       0.002165806711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299808352683
                                         uncertainty =       0.002165806711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387189349
  error estimate for blocks of size 2^( 2) =       0.000397425178
  error estimate for blocks of size 2^( 3) =       0.000406791609
  error estimate for blocks of size 2^( 4) =       0.000413092001
  error estimate for blocks of size 2^( 5) =       0.000416205599
  error estimate for blocks of size 2^( 6) =       0.000418611126
  error estimate for blocks of size 2^( 7) =       0.000419355242

      target function =                  N/A
              le_mean =     -17.216958523781
             les_mean =     296.746180207508
             stat err =       0.000416815992
             autocorr =       1.158889269679
              std dev =       0.547568429092
             le_variance =       0.299831184539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299414385892
                                         uncertainty =       0.002313909283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299414385892
                                         uncertainty =       0.002313909283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386932809
  error estimate for blocks of size 2^( 2) =       0.000397182463
  error estimate for blocks of size 2^( 3) =       0.000406578930
  error estimate for blocks of size 2^( 4) =       0.000412906590
  error estimate for blocks of size 2^( 5) =       0.000416042752
  error estimate for blocks of size 2^( 6) =       0.000418407724
  error estimate for blocks of size 2^( 7) =       0.000419104618

      target function =                  N/A
              le_mean =     -17.216955254791
             les_mean =     296.741295033929
             stat err =       0.000416615421
             autocorr =       1.159309966066
              std dev =       0.547205626759
             le_variance =       0.299433997957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299518345015
                                         uncertainty =       0.002407334255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299518345015
                                         uncertainty =       0.002407334255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386999051
  error estimate for blocks of size 2^( 2) =       0.000397245669
  error estimate for blocks of size 2^( 3) =       0.000406664660
  error estimate for blocks of size 2^( 4) =       0.000412983480
  error estimate for blocks of size 2^( 5) =       0.000416118753
  error estimate for blocks of size 2^( 6) =       0.000418448278
  error estimate for blocks of size 2^( 7) =       0.000419117235

      target function =                  N/A
              le_mean =     -17.216957140920
             les_mean =     296.934892845844
             stat err =       0.000416666937
             autocorr =       1.159199752555
              std dev =       0.547299306179
             le_variance =       0.299536530544

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299644728839
                                         uncertainty =       0.002200400511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299644728839
                                         uncertainty =       0.002200400511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387083153
  error estimate for blocks of size 2^( 2) =       0.000397323889
  error estimate for blocks of size 2^( 3) =       0.000406697001
  error estimate for blocks of size 2^( 4) =       0.000413006778
  error estimate for blocks of size 2^( 5) =       0.000416120372
  error estimate for blocks of size 2^( 6) =       0.000418521462
  error estimate for blocks of size 2^( 7) =       0.000419244502

      target function =                  N/A
              le_mean =     -17.216953122043
             les_mean =     296.759596260772
             stat err =       0.000416723279
             autocorr =       1.159009466584
              std dev =       0.547418244564
             le_variance =       0.299666734481


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216958523781        initial  <--
     6.2500e-02     6.2500e-01             1.0467e-03       -17.216955254791
     2.5000e-01     2.5000e+00             5.9314e-04       -17.216957140920
     1.0000e+00     1.0000e+01             2.3321e-04       -17.216953122043

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6329
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -4.071723e-02 3 1  ON 0
ci_002                -3.014560e-02 3 1  ON 1
ci_003                -2.595955e-02 3 1  ON 2
ci_004                 2.105274e-02 3 1  ON 3
ci_005                 2.095873e-02 3 1  ON 4
ci_006                -1.974685e-02 3 1  ON 5
ci_007                -1.886853e-02 3 1  ON 6
ci_008                -1.798245e-02 3 1  ON 7
ci_009                -1.760751e-02 3 1  ON 8
ci_010                -1.744012e-02 3 1  ON 9
ci_011                -1.652101e-02 3 1  ON 10
ci_012                -1.672684e-02 3 1  ON 11
ci_013                -1.941557e-02 3 1  ON 12
ci_014                 1.440143e-02 3 1  ON 13
ci_015                 1.403634e-02 3 1  ON 14
ci_016                 1.633233e-02 3 1  ON 15
ci_017                 1.614388e-02 3 1  ON 16
ci_018                 1.267762e-02 3 1  ON 17
ci_019                 1.321316e-02 3 1  ON 18
ci_020                 1.272442e-02 3 1  ON 19
ci_021                 1.310964e-02 3 1  ON 20
ci_022                 1.107350e-02 3 1  ON 21
ci_023                 1.154561e-02 3 1  ON 22
ci_024                 1.236198e-02 3 1  ON 23
ci_025                 1.129945e-02 3 1  ON 24
ci_026                 1.109730e-02 3 1  ON 25
ci_027                 1.094170e-02 3 1  ON 26
ci_028                -1.378521e-02 3 1  ON 27
ci_029                -1.469821e-02 3 1  ON 28
ci_030                -1.173949e-02 3 1  ON 29
ci_031                -1.134529e-02 3 1  ON 30
ci_032                -1.349361e-02 3 1  ON 31
ci_033                 1.008153e-02 3 1  ON 32
ci_034                 1.074603e-02 3 1  ON 33
ci_035                -4.458686e-03 3 1  ON 34
ci_036                -1.044292e-02 3 1  ON 35
ci_037                -1.018010e-02 3 1  ON 36
ci_038                 1.500125e-03 3 1  ON 37
ci_039                 1.901610e-03 3 1  ON 38
ci_040                -3.814162e-03 3 1  ON 39
ci_041                 9.449036e-03 3 1  ON 40
ci_042                 9.872850e-03 3 1  ON 41
ci_043                -2.904721e-03 3 1  ON 42
ci_044                -1.500218e-02 3 1  ON 43
ci_045                -1.914101e-03 3 1  ON 44
ci_046                 6.087066e-03 3 1  ON 45
ci_047                 5.355310e-03 3 1  ON 46
ci_048                -1.185792e-02 3 1  ON 47
ci_049                -1.105446e-02 3 1  ON 48
ci_050                 7.830959e-03 3 1  ON 49
ci_051                 7.336894e-03 3 1  ON 50
ci_052                -6.625490e-03 3 1  ON 51
ci_053                -7.048570e-03 3 1  ON 52
ci_054                -3.369922e-03 3 1  ON 53
ci_055                -3.147715e-03 3 1  ON 54
ci_056                 4.505040e-03 3 1  ON 55
ci_057                 5.286831e-03 3 1  ON 56
ci_058                -7.279382e-03 3 1  ON 57
ci_059                -6.505999e-03 3 1  ON 58
ci_060                 7.799136e-03 3 1  ON 59
ci_061                 8.476975e-03 3 1  ON 60
ci_062                -3.142135e-03 3 1  ON 61
ci_063                -3.583459e-03 3 1  ON 62
ci_064                -3.036201e-03 3 1  ON 63
ci_065                -4.269181e-03 3 1  ON 64
ci_066                 5.694857e-03 3 1  ON 65
ci_067                 5.642710e-03 3 1  ON 66
ci_068                -4.821198e-03 3 1  ON 67
ci_069                -4.269673e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8871e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2282
    reference variance = 0.170048
====================================================
  Execution time = 1.4037e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1696e-01
  Total weights = 1.956509786e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4826e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303969975451
                                         uncertainty =       0.002181090473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303969975451
                                         uncertainty =       0.002181090473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389798308
  error estimate for blocks of size 2^( 2) =       0.000399361843
  error estimate for blocks of size 2^( 3) =       0.000408662682
  error estimate for blocks of size 2^( 4) =       0.000414583999
  error estimate for blocks of size 2^( 5) =       0.000418803189
  error estimate for blocks of size 2^( 6) =       0.000420004625
  error estimate for blocks of size 2^( 7) =       0.000421057728

      target function =                  N/A
              le_mean =     -17.216601083768
             les_mean =     296.728313386187
             stat err =       0.000418612385
             autocorr =       1.153305192729
              std dev =       0.551258053590
             le_variance =       0.303885441648


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660108377e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216601083796       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216603960947       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216603746288       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216603787527       residual = 3.87e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 3.593380e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216601083796       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216601990059       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216601925718       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 1.062549e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216601083796       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216601326109       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216601309713       residual = 9.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 2.793722e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.278905 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6524e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -4.068032e-02 3 1  ON 0
ci_002                -3.015660e-02 3 1  ON 1
ci_003                -2.585329e-02 3 1  ON 2
ci_004                 2.103882e-02 3 1  ON 3
ci_005                 2.100674e-02 3 1  ON 4
ci_006                -1.969767e-02 3 1  ON 5
ci_007                -1.882390e-02 3 1  ON 6
ci_008                -1.803455e-02 3 1  ON 7
ci_009                -1.754828e-02 3 1  ON 8
ci_010                -1.739720e-02 3 1  ON 9
ci_011                -1.651775e-02 3 1  ON 10
ci_012                -1.672513e-02 3 1  ON 11
ci_013                -1.941219e-02 3 1  ON 12
ci_014                 1.430092e-02 3 1  ON 13
ci_015                 1.402977e-02 3 1  ON 14
ci_016                 1.639213e-02 3 1  ON 15
ci_017                 1.609564e-02 3 1  ON 16
ci_018                 1.269139e-02 3 1  ON 17
ci_019                 1.315155e-02 3 1  ON 18
ci_020                 1.271121e-02 3 1  ON 19
ci_021                 1.313008e-02 3 1  ON 20
ci_022                 1.114112e-02 3 1  ON 21
ci_023                 1.159709e-02 3 1  ON 22
ci_024                 1.234708e-02 3 1  ON 23
ci_025                 1.131121e-02 3 1  ON 24
ci_026                 1.114466e-02 3 1  ON 25
ci_027                 1.096106e-02 3 1  ON 26
ci_028                -1.380862e-02 3 1  ON 27
ci_029                -1.461280e-02 3 1  ON 28
ci_030                -1.167817e-02 3 1  ON 29
ci_031                -1.128724e-02 3 1  ON 30
ci_032                -1.351496e-02 3 1  ON 31
ci_033                 1.009010e-02 3 1  ON 32
ci_034                 1.067033e-02 3 1  ON 33
ci_035                -4.470141e-03 3 1  ON 34
ci_036                -1.040069e-02 3 1  ON 35
ci_037                -1.020506e-02 3 1  ON 36
ci_038                 1.511837e-03 3 1  ON 37
ci_039                 1.910091e-03 3 1  ON 38
ci_040                -3.823962e-03 3 1  ON 39
ci_041                 9.476962e-03 3 1  ON 40
ci_042                 9.873075e-03 3 1  ON 41
ci_043                -2.941692e-03 3 1  ON 42
ci_044                -1.498781e-02 3 1  ON 43
ci_045                -1.907039e-03 3 1  ON 44
ci_046                 6.054359e-03 3 1  ON 45
ci_047                 5.410650e-03 3 1  ON 46
ci_048                -1.186316e-02 3 1  ON 47
ci_049                -1.110838e-02 3 1  ON 48
ci_050                 7.812377e-03 3 1  ON 49
ci_051                 7.385846e-03 3 1  ON 50
ci_052                -6.585505e-03 3 1  ON 51
ci_053                -7.031085e-03 3 1  ON 52
ci_054                -3.310208e-03 3 1  ON 53
ci_055                -3.096252e-03 3 1  ON 54
ci_056                 4.495122e-03 3 1  ON 55
ci_057                 5.222549e-03 3 1  ON 56
ci_058                -7.231655e-03 3 1  ON 57
ci_059                -6.534131e-03 3 1  ON 58
ci_060                 7.784527e-03 3 1  ON 59
ci_061                 8.514604e-03 3 1  ON 60
ci_062                -3.068123e-03 3 1  ON 61
ci_063                -3.549484e-03 3 1  ON 62
ci_064                -3.038469e-03 3 1  ON 63
ci_065                -4.250606e-03 3 1  ON 64
ci_066                 5.635866e-03 3 1  ON 65
ci_067                 5.627613e-03 3 1  ON 66
ci_068                -4.854518e-03 3 1  ON 67
ci_069                -4.324023e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2765
    reference variance = 0.223801
====================================================
  Execution time = 1.3238e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2106e-01
  Total weights = 1.9565e+06
  Execution time = 1.8172e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306250282378
                                         uncertainty =       0.003124614314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306250282378
                                         uncertainty =       0.003124614314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391330268
  error estimate for blocks of size 2^( 2) =       0.000401105696
  error estimate for blocks of size 2^( 3) =       0.000409950826
  error estimate for blocks of size 2^( 4) =       0.000416901814
  error estimate for blocks of size 2^( 5) =       0.000421734015
  error estimate for blocks of size 2^( 6) =       0.000422460766
  error estimate for blocks of size 2^( 7) =       0.000425167043

      target function =                  N/A
              le_mean =     -17.217513972726
             les_mean =     296.764392834645
             stat err =       0.000421565910
             autocorr =       1.160497174234
              std dev =       0.553424572213
             le_variance =       0.306278757129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306150070285
                                         uncertainty =       0.003117496329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306150070285
                                         uncertainty =       0.003117496329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391266363
  error estimate for blocks of size 2^( 2) =       0.000401044216
  error estimate for blocks of size 2^( 3) =       0.000409896140
  error estimate for blocks of size 2^( 4) =       0.000416844852
  error estimate for blocks of size 2^( 5) =       0.000421684161
  error estimate for blocks of size 2^( 6) =       0.000422414518
  error estimate for blocks of size 2^( 7) =       0.000425107739

      target function =                  N/A
              le_mean =     -17.217512741656
             les_mean =     296.766105458952
             stat err =       0.000421512817
             autocorr =       1.160583903029
              std dev =       0.553334197738
             le_variance =       0.306178734387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306184864238
                                         uncertainty =       0.003119762974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306184864238
                                         uncertainty =       0.003119762974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391288573
  error estimate for blocks of size 2^( 2) =       0.000401065172
  error estimate for blocks of size 2^( 3) =       0.000409914343
  error estimate for blocks of size 2^( 4) =       0.000416864398
  error estimate for blocks of size 2^( 5) =       0.000421700983
  error estimate for blocks of size 2^( 6) =       0.000422429929
  error estimate for blocks of size 2^( 7) =       0.000425128402

      target function =                  N/A
              le_mean =     -17.217512270562
             les_mean =     296.763927034943
             stat err =       0.000421530928
             autocorr =       1.160551879702
              std dev =       0.553365606594
             le_variance =       0.306213494561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306240399667
                                         uncertainty =       0.003123926673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306240399667
                                         uncertainty =       0.003123926673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391323969
  error estimate for blocks of size 2^( 2) =       0.000401099573
  error estimate for blocks of size 2^( 3) =       0.000409945263
  error estimate for blocks of size 2^( 4) =       0.000416896137
  error estimate for blocks of size 2^( 5) =       0.000421728909
  error estimate for blocks of size 2^( 6) =       0.000422455955
  error estimate for blocks of size 2^( 7) =       0.000425161185

      target function =                  N/A
              le_mean =     -17.217513693596
             les_mean =     296.764257936031
             stat err =       0.000421560546
             autocorr =       1.160505007097
              std dev =       0.553415663999
             le_variance =       0.306268897160


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217513972726        initial  <--
     6.2500e-01     6.2500e+00             3.5934e-04       -17.217512741656
     2.5000e+00     2.5000e+01             1.0625e-04       -17.217512270562
     1.0000e+01     1.0000e+02             2.7937e-05       -17.217513693596

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.4301
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -4.071723e-02 3 1  ON 0
ci_002                -3.014560e-02 3 1  ON 1
ci_003                -2.595955e-02 3 1  ON 2
ci_004                 2.105274e-02 3 1  ON 3
ci_005                 2.095873e-02 3 1  ON 4
ci_006                -1.974685e-02 3 1  ON 5
ci_007                -1.886853e-02 3 1  ON 6
ci_008                -1.798245e-02 3 1  ON 7
ci_009                -1.760751e-02 3 1  ON 8
ci_010                -1.744012e-02 3 1  ON 9
ci_011                -1.652101e-02 3 1  ON 10
ci_012                -1.672684e-02 3 1  ON 11
ci_013                -1.941557e-02 3 1  ON 12
ci_014                 1.440143e-02 3 1  ON 13
ci_015                 1.403634e-02 3 1  ON 14
ci_016                 1.633233e-02 3 1  ON 15
ci_017                 1.614388e-02 3 1  ON 16
ci_018                 1.267762e-02 3 1  ON 17
ci_019                 1.321316e-02 3 1  ON 18
ci_020                 1.272442e-02 3 1  ON 19
ci_021                 1.310964e-02 3 1  ON 20
ci_022                 1.107350e-02 3 1  ON 21
ci_023                 1.154561e-02 3 1  ON 22
ci_024                 1.236198e-02 3 1  ON 23
ci_025                 1.129945e-02 3 1  ON 24
ci_026                 1.109730e-02 3 1  ON 25
ci_027                 1.094170e-02 3 1  ON 26
ci_028                -1.378521e-02 3 1  ON 27
ci_029                -1.469821e-02 3 1  ON 28
ci_030                -1.173949e-02 3 1  ON 29
ci_031                -1.134529e-02 3 1  ON 30
ci_032                -1.349361e-02 3 1  ON 31
ci_033                 1.008153e-02 3 1  ON 32
ci_034                 1.074603e-02 3 1  ON 33
ci_035                -4.458686e-03 3 1  ON 34
ci_036                -1.044292e-02 3 1  ON 35
ci_037                -1.018010e-02 3 1  ON 36
ci_038                 1.500125e-03 3 1  ON 37
ci_039                 1.901610e-03 3 1  ON 38
ci_040                -3.814162e-03 3 1  ON 39
ci_041                 9.449036e-03 3 1  ON 40
ci_042                 9.872850e-03 3 1  ON 41
ci_043                -2.904721e-03 3 1  ON 42
ci_044                -1.500218e-02 3 1  ON 43
ci_045                -1.914101e-03 3 1  ON 44
ci_046                 6.087066e-03 3 1  ON 45
ci_047                 5.355310e-03 3 1  ON 46
ci_048                -1.185792e-02 3 1  ON 47
ci_049                -1.105446e-02 3 1  ON 48
ci_050                 7.830959e-03 3 1  ON 49
ci_051                 7.336894e-03 3 1  ON 50
ci_052                -6.625490e-03 3 1  ON 51
ci_053                -7.048570e-03 3 1  ON 52
ci_054                -3.369922e-03 3 1  ON 53
ci_055                -3.147715e-03 3 1  ON 54
ci_056                 4.505040e-03 3 1  ON 55
ci_057                 5.286831e-03 3 1  ON 56
ci_058                -7.279382e-03 3 1  ON 57
ci_059                -6.505999e-03 3 1  ON 58
ci_060                 7.799136e-03 3 1  ON 59
ci_061                 8.476975e-03 3 1  ON 60
ci_062                -3.142135e-03 3 1  ON 61
ci_063                -3.583459e-03 3 1  ON 62
ci_064                -3.036201e-03 3 1  ON 63
ci_065                -4.269181e-03 3 1  ON 64
ci_066                 5.694857e-03 3 1  ON 65
ci_067                 5.642710e-03 3 1  ON 66
ci_068                -4.821198e-03 3 1  ON 67
ci_069                -4.269673e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8972e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1769
    reference variance = 0.230358
====================================================
  Execution time = 1.3696e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1849e-01
  Total weights = 1.956775234e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301306587305
                                         uncertainty =       0.002585138801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301306587305
                                         uncertainty =       0.002585138801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388097073
  error estimate for blocks of size 2^( 2) =       0.000398036851
  error estimate for blocks of size 2^( 3) =       0.000407356876
  error estimate for blocks of size 2^( 4) =       0.000414399909
  error estimate for blocks of size 2^( 5) =       0.000418255235
  error estimate for blocks of size 2^( 6) =       0.000417493047
  error estimate for blocks of size 2^( 7) =       0.000417105787

      target function =                  N/A
              le_mean =     -17.216720456501
             les_mean =     296.733955295556
             stat err =       0.000416813495
             autocorr =       1.153460716203
              std dev =       0.548852143853
             le_variance =       0.301238675812


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721672045650e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216720456546       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216721217251       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216721211550       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216721202992       residual = 1.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 6.164020e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216720456546       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216720652290       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216720653031       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216720650885       residual = 2.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 1.602941e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216720456546       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216720505842       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216720506172       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216720505637       residual = 2.13e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 4.048023e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.280171 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6170e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -4.072017e-02 3 1  ON 0
ci_002                -3.013590e-02 3 1  ON 1
ci_003                -2.594969e-02 3 1  ON 2
ci_004                 2.104706e-02 3 1  ON 3
ci_005                 2.095851e-02 3 1  ON 4
ci_006                -1.974931e-02 3 1  ON 5
ci_007                -1.887199e-02 3 1  ON 6
ci_008                -1.797836e-02 3 1  ON 7
ci_009                -1.760148e-02 3 1  ON 8
ci_010                -1.743526e-02 3 1  ON 9
ci_011                -1.652249e-02 3 1  ON 10
ci_012                -1.672639e-02 3 1  ON 11
ci_013                -1.940403e-02 3 1  ON 12
ci_014                 1.438904e-02 3 1  ON 13
ci_015                 1.403058e-02 3 1  ON 14
ci_016                 1.633124e-02 3 1  ON 15
ci_017                 1.615062e-02 3 1  ON 16
ci_018                 1.268342e-02 3 1  ON 17
ci_019                 1.321233e-02 3 1  ON 18
ci_020                 1.272721e-02 3 1  ON 19
ci_021                 1.311377e-02 3 1  ON 20
ci_022                 1.106690e-02 3 1  ON 21
ci_023                 1.154642e-02 3 1  ON 22
ci_024                 1.236840e-02 3 1  ON 23
ci_025                 1.130565e-02 3 1  ON 24
ci_026                 1.109760e-02 3 1  ON 25
ci_027                 1.093993e-02 3 1  ON 26
ci_028                -1.378230e-02 3 1  ON 27
ci_029                -1.469449e-02 3 1  ON 28
ci_030                -1.172836e-02 3 1  ON 29
ci_031                -1.134346e-02 3 1  ON 30
ci_032                -1.350104e-02 3 1  ON 31
ci_033                 1.008024e-02 3 1  ON 32
ci_034                 1.073575e-02 3 1  ON 33
ci_035                -4.466621e-03 3 1  ON 34
ci_036                -1.044283e-02 3 1  ON 35
ci_037                -1.018097e-02 3 1  ON 36
ci_038                 1.505294e-03 3 1  ON 37
ci_039                 1.904243e-03 3 1  ON 38
ci_040                -3.816548e-03 3 1  ON 39
ci_041                 9.444864e-03 3 1  ON 40
ci_042                 9.877374e-03 3 1  ON 41
ci_043                -2.905361e-03 3 1  ON 42
ci_044                -1.500734e-02 3 1  ON 43
ci_045                -1.912771e-03 3 1  ON 44
ci_046                 6.094663e-03 3 1  ON 45
ci_047                 5.360632e-03 3 1  ON 46
ci_048                -1.185628e-02 3 1  ON 47
ci_049                -1.106427e-02 3 1  ON 48
ci_050                 7.824913e-03 3 1  ON 49
ci_051                 7.337489e-03 3 1  ON 50
ci_052                -6.626518e-03 3 1  ON 51
ci_053                -7.041027e-03 3 1  ON 52
ci_054                -3.369728e-03 3 1  ON 53
ci_055                -3.140738e-03 3 1  ON 54
ci_056                 4.521069e-03 3 1  ON 55
ci_057                 5.277395e-03 3 1  ON 56
ci_058                -7.279638e-03 3 1  ON 57
ci_059                -6.511718e-03 3 1  ON 58
ci_060                 7.804669e-03 3 1  ON 59
ci_061                 8.477777e-03 3 1  ON 60
ci_062                -3.132434e-03 3 1  ON 61
ci_063                -3.574300e-03 3 1  ON 62
ci_064                -3.038115e-03 3 1  ON 63
ci_065                -4.264143e-03 3 1  ON 64
ci_066                 5.690473e-03 3 1  ON 65
ci_067                 5.641728e-03 3 1  ON 66
ci_068                -4.829133e-03 3 1  ON 67
ci_069                -4.272627e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.3673
    reference variance = 0.485113
====================================================
  Execution time = 1.3202e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1466e-01
  Total weights = 1.9566e+06
  Execution time = 1.8209e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299444664339
                                         uncertainty =       0.002340671445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299444664339
                                         uncertainty =       0.002340671445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386917972
  error estimate for blocks of size 2^( 2) =       0.000396881504
  error estimate for blocks of size 2^( 3) =       0.000406359943
  error estimate for blocks of size 2^( 4) =       0.000413246690
  error estimate for blocks of size 2^( 5) =       0.000417874620
  error estimate for blocks of size 2^( 6) =       0.000420745536
  error estimate for blocks of size 2^( 7) =       0.000422325137

      target function =                  N/A
              le_mean =     -17.216921095751
             les_mean =     296.737045256457
             stat err =       0.000418547996
             autocorr =       1.170180153862
              std dev =       0.547184643375
             le_variance =       0.299411033945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299423469909
                                         uncertainty =       0.002342527396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299423469909
                                         uncertainty =       0.002342527396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386904267
  error estimate for blocks of size 2^( 2) =       0.000396868642
  error estimate for blocks of size 2^( 3) =       0.000406348594
  error estimate for blocks of size 2^( 4) =       0.000413236819
  error estimate for blocks of size 2^( 5) =       0.000417866351
  error estimate for blocks of size 2^( 6) =       0.000420737361
  error estimate for blocks of size 2^( 7) =       0.000422314096

      target function =                  N/A
              le_mean =     -17.216921468781
             les_mean =     296.737017569736
             stat err =       0.000418538657
             autocorr =       1.170210827347
              std dev =       0.547165262379
             le_variance =       0.299389824355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299433409075
                                         uncertainty =       0.002341633367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299433409075
                                         uncertainty =       0.002341633367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386910694
  error estimate for blocks of size 2^( 2) =       0.000396874656
  error estimate for blocks of size 2^( 3) =       0.000406353864
  error estimate for blocks of size 2^( 4) =       0.000413241369
  error estimate for blocks of size 2^( 5) =       0.000417870122
  error estimate for blocks of size 2^( 6) =       0.000420741082
  error estimate for blocks of size 2^( 7) =       0.000422319203

      target function =                  N/A
              le_mean =     -17.216921263376
             les_mean =     296.737023961533
             stat err =       0.000418542944
             autocorr =       1.170195923529
              std dev =       0.547174351570
             le_variance =       0.299399771016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299443208228
                                         uncertainty =       0.002340792078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299443208228
                                         uncertainty =       0.002340792078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386917030
  error estimate for blocks of size 2^( 2) =       0.000396880616
  error estimate for blocks of size 2^( 3) =       0.000406359151
  error estimate for blocks of size 2^( 4) =       0.000413245993
  error estimate for blocks of size 2^( 5) =       0.000417874026
  error estimate for blocks of size 2^( 6) =       0.000420744947
  error estimate for blocks of size 2^( 7) =       0.000422324360

      target function =                  N/A
              le_mean =     -17.216921114016
             les_mean =     296.737041317164
             stat err =       0.000418547332
             autocorr =       1.170182133860
              std dev =       0.547183311958
             le_variance =       0.299409576885


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216921095751        initial
     6.2500e+00     6.2500e+01             6.1640e-05       -17.216921468781  <--
     2.5000e+01     2.5000e+02             1.6029e-05       -17.216921263376
     1.0000e+02     1.0000e+03             4.0480e-06       -17.216921114016

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.2378e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -4.072862e-02 3 1  ON 0
ci_002                -3.010776e-02 3 1  ON 1
ci_003                -2.592100e-02 3 1  ON 2
ci_004                 2.103043e-02 3 1  ON 3
ci_005                 2.095777e-02 3 1  ON 4
ci_006                -1.975642e-02 3 1  ON 5
ci_007                -1.888212e-02 3 1  ON 6
ci_008                -1.796664e-02 3 1  ON 7
ci_009                -1.758415e-02 3 1  ON 8
ci_010                -1.742104e-02 3 1  ON 9
ci_011                -1.652680e-02 3 1  ON 10
ci_012                -1.672504e-02 3 1  ON 11
ci_013                -1.937032e-02 3 1  ON 12
ci_014                 1.435324e-02 3 1  ON 13
ci_015                 1.401392e-02 3 1  ON 14
ci_016                 1.632805e-02 3 1  ON 15
ci_017                 1.617031e-02 3 1  ON 16
ci_018                 1.270013e-02 3 1  ON 17
ci_019                 1.320998e-02 3 1  ON 18
ci_020                 1.273541e-02 3 1  ON 19
ci_021                 1.312583e-02 3 1  ON 20
ci_022                 1.104787e-02 3 1  ON 21
ci_023                 1.154869e-02 3 1  ON 22
ci_024                 1.238718e-02 3 1  ON 23
ci_025                 1.132382e-02 3 1  ON 24
ci_026                 1.109847e-02 3 1  ON 25
ci_027                 1.093487e-02 3 1  ON 26
ci_028                -1.377384e-02 3 1  ON 27
ci_029                -1.468368e-02 3 1  ON 28
ci_030                -1.169617e-02 3 1  ON 29
ci_031                -1.133813e-02 3 1  ON 30
ci_032                -1.352241e-02 3 1  ON 31
ci_033                 1.007658e-02 3 1  ON 32
ci_034                 1.070605e-02 3 1  ON 33
ci_035                -4.489027e-03 3 1  ON 34
ci_036                -1.044259e-02 3 1  ON 35
ci_037                -1.018349e-02 3 1  ON 36
ci_038                 1.519871e-03 3 1  ON 37
ci_039                 1.911658e-03 3 1  ON 38
ci_040                -3.823236e-03 3 1  ON 39
ci_041                 9.432874e-03 3 1  ON 40
ci_042                 9.890421e-03 3 1  ON 41
ci_043                -2.907201e-03 3 1  ON 42
ci_044                -1.502256e-02 3 1  ON 43
ci_045                -1.909028e-03 3 1  ON 44
ci_046                 6.116540e-03 3 1  ON 45
ci_047                 5.375995e-03 3 1  ON 46
ci_048                -1.185151e-02 3 1  ON 47
ci_049                -1.109302e-02 3 1  ON 48
ci_050                 7.807746e-03 3 1  ON 49
ci_051                 7.339188e-03 3 1  ON 50
ci_052                -6.629451e-03 3 1  ON 51
ci_053                -7.019503e-03 3 1  ON 52
ci_054                -3.369217e-03 3 1  ON 53
ci_055                -3.120780e-03 3 1  ON 54
ci_056                 4.566680e-03 3 1  ON 55
ci_057                 5.250521e-03 3 1  ON 56
ci_058                -7.280403e-03 3 1  ON 57
ci_059                -6.528170e-03 3 1  ON 58
ci_060                 7.820662e-03 3 1  ON 59
ci_061                 8.480130e-03 3 1  ON 60
ci_062                -3.104590e-03 3 1  ON 61
ci_063                -3.547990e-03 3 1  ON 62
ci_064                -3.043416e-03 3 1  ON 63
ci_065                -4.250120e-03 3 1  ON 64
ci_066                 5.678019e-03 3 1  ON 65
ci_067                 5.638928e-03 3 1  ON 66
ci_068                -4.852151e-03 3 1  ON 67
ci_069                -4.281234e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8660e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7230e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2371
    reference variance = 0.252662
====================================================
  Execution time = 1.3889e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1146e-01
  Total weights = 1.956979356e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4756e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298013466748
                                         uncertainty =       0.001956273652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298013466748
                                         uncertainty =       0.001956273652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385973353
  error estimate for blocks of size 2^( 2) =       0.000396270204
  error estimate for blocks of size 2^( 3) =       0.000405375726
  error estimate for blocks of size 2^( 4) =       0.000412037109
  error estimate for blocks of size 2^( 5) =       0.000416399756
  error estimate for blocks of size 2^( 6) =       0.000418393872
  error estimate for blocks of size 2^( 7) =       0.000421076188

      target function =                  N/A
              le_mean =     -17.216399053492
             les_mean =     296.715854749551
             stat err =       0.000416976731
             autocorr =       1.167102487666
              std dev =       0.545848751086
             le_variance =       0.297950859062


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721639905349e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216399053541       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216400100661       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216400180985       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216400210350       residual = 8.88e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 2.290074e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216399053541       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216399345779       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216399349949       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216399356871       residual = 9.07e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 6.215099e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216399053541       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216399128790       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216399128368       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216399130317       residual = 9.29e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 1.588333e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.281491 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6370e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -4.070709e-02 3 1  ON 0
ci_002                -3.006902e-02 3 1  ON 1
ci_003                -2.587282e-02 3 1  ON 2
ci_004                 2.104854e-02 3 1  ON 3
ci_005                 2.096018e-02 3 1  ON 4
ci_006                -1.974250e-02 3 1  ON 5
ci_007                -1.887201e-02 3 1  ON 6
ci_008                -1.802665e-02 3 1  ON 7
ci_009                -1.757519e-02 3 1  ON 8
ci_010                -1.741036e-02 3 1  ON 9
ci_011                -1.657315e-02 3 1  ON 10
ci_012                -1.674321e-02 3 1  ON 11
ci_013                -1.941472e-02 3 1  ON 12
ci_014                 1.433019e-02 3 1  ON 13
ci_015                 1.400124e-02 3 1  ON 14
ci_016                 1.633614e-02 3 1  ON 15
ci_017                 1.619368e-02 3 1  ON 16
ci_018                 1.270450e-02 3 1  ON 17
ci_019                 1.316883e-02 3 1  ON 18
ci_020                 1.270078e-02 3 1  ON 19
ci_021                 1.314597e-02 3 1  ON 20
ci_022                 1.106632e-02 3 1  ON 21
ci_023                 1.159518e-02 3 1  ON 22
ci_024                 1.232503e-02 3 1  ON 23
ci_025                 1.132743e-02 3 1  ON 24
ci_026                 1.111172e-02 3 1  ON 25
ci_027                 1.093462e-02 3 1  ON 26
ci_028                -1.376514e-02 3 1  ON 27
ci_029                -1.466189e-02 3 1  ON 28
ci_030                -1.166764e-02 3 1  ON 29
ci_031                -1.131972e-02 3 1  ON 30
ci_032                -1.355799e-02 3 1  ON 31
ci_033                 1.009860e-02 3 1  ON 32
ci_034                 1.065620e-02 3 1  ON 33
ci_035                -4.482325e-03 3 1  ON 34
ci_036                -1.045701e-02 3 1  ON 35
ci_037                -1.021087e-02 3 1  ON 36
ci_038                 1.541424e-03 3 1  ON 37
ci_039                 1.896757e-03 3 1  ON 38
ci_040                -3.816943e-03 3 1  ON 39
ci_041                 9.419559e-03 3 1  ON 40
ci_042                 9.906146e-03 3 1  ON 41
ci_043                -2.925768e-03 3 1  ON 42
ci_044                -1.502163e-02 3 1  ON 43
ci_045                -1.910704e-03 3 1  ON 44
ci_046                 6.071708e-03 3 1  ON 45
ci_047                 5.388180e-03 3 1  ON 46
ci_048                -1.184088e-02 3 1  ON 47
ci_049                -1.111200e-02 3 1  ON 48
ci_050                 7.786336e-03 3 1  ON 49
ci_051                 7.327226e-03 3 1  ON 50
ci_052                -6.634636e-03 3 1  ON 51
ci_053                -7.029345e-03 3 1  ON 52
ci_054                -3.339700e-03 3 1  ON 53
ci_055                -3.094789e-03 3 1  ON 54
ci_056                 4.553493e-03 3 1  ON 55
ci_057                 5.204583e-03 3 1  ON 56
ci_058                -7.219179e-03 3 1  ON 57
ci_059                -6.531740e-03 3 1  ON 58
ci_060                 7.841164e-03 3 1  ON 59
ci_061                 8.488469e-03 3 1  ON 60
ci_062                -3.106600e-03 3 1  ON 61
ci_063                -3.523383e-03 3 1  ON 62
ci_064                -3.039355e-03 3 1  ON 63
ci_065                -4.265772e-03 3 1  ON 64
ci_066                 5.648813e-03 3 1  ON 65
ci_067                 5.624920e-03 3 1  ON 66
ci_068                -4.857438e-03 3 1  ON 67
ci_069                -4.275770e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1696
    reference variance = 0.247617
====================================================
  Execution time = 1.3365e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1508e-01
  Total weights = 1.9566e+06
  Execution time = 1.8144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299602373844
                                         uncertainty =       0.001835737230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299602373844
                                         uncertainty =       0.001835737230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386994352
  error estimate for blocks of size 2^( 2) =       0.000397128138
  error estimate for blocks of size 2^( 3) =       0.000405647539
  error estimate for blocks of size 2^( 4) =       0.000412348983
  error estimate for blocks of size 2^( 5) =       0.000417121930
  error estimate for blocks of size 2^( 6) =       0.000419232828
  error estimate for blocks of size 2^( 7) =       0.000419552115

      target function =                  N/A
              le_mean =     -17.215986392902
             les_mean =     296.705553572185
             stat err =       0.000417063964
             autocorr =       1.161438132277
              std dev =       0.547292660539
             le_variance =       0.299529256280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299584787689
                                         uncertainty =       0.001841926482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299584787689
                                         uncertainty =       0.001841926482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386982793
  error estimate for blocks of size 2^( 2) =       0.000397114075
  error estimate for blocks of size 2^( 3) =       0.000405631925
  error estimate for blocks of size 2^( 4) =       0.000412335557
  error estimate for blocks of size 2^( 5) =       0.000417112001
  error estimate for blocks of size 2^( 6) =       0.000419230331
  error estimate for blocks of size 2^( 7) =       0.000419542884

      target function =                  N/A
              le_mean =     -17.215988803154
             les_mean =     296.705523049500
             stat err =       0.000417055193
             autocorr =       1.161458664137
              std dev =       0.547276313863
             le_variance =       0.299511363715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299589016906
                                         uncertainty =       0.001838993779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299589016906
                                         uncertainty =       0.001838993779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386985617
  error estimate for blocks of size 2^( 2) =       0.000397117899
  error estimate for blocks of size 2^( 3) =       0.000405636554
  error estimate for blocks of size 2^( 4) =       0.000412339076
  error estimate for blocks of size 2^( 5) =       0.000417114194
  error estimate for blocks of size 2^( 6) =       0.000419228932
  error estimate for blocks of size 2^( 7) =       0.000419544634

      target function =                  N/A
              le_mean =     -17.215987472762
             les_mean =     296.705255621767
             stat err =       0.000417056709
             autocorr =       1.161450152766
              std dev =       0.547280308246
             le_variance =       0.299515735794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299600171586
                                         uncertainty =       0.001836135505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299600171586
                                         uncertainty =       0.001836135505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386992916
  error estimate for blocks of size 2^( 2) =       0.000397126498
  error estimate for blocks of size 2^( 3) =       0.000405645810
  error estimate for blocks of size 2^( 4) =       0.000412347360
  error estimate for blocks of size 2^( 5) =       0.000417120570
  error estimate for blocks of size 2^( 6) =       0.000419231854
  error estimate for blocks of size 2^( 7) =       0.000419550702

      target function =                  N/A
              le_mean =     -17.215986456366
             les_mean =     296.705683996605
             stat err =       0.000417062621
             autocorr =       1.161439273094
              std dev =       0.547290629923
             le_variance =       0.299527033602


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215986392902        initial
     1.5625e+00     1.5625e+01             2.2901e-04       -17.215988803154  <--
     6.2500e+00     6.2500e+01             6.2151e-05       -17.215987472762
     2.5000e+01     2.5000e+02             1.5883e-05       -17.215986456366

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.2522e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -4.064409e-02 3 1  ON 0
ci_002                -2.996744e-02 3 1  ON 1
ci_003                -2.574331e-02 3 1  ON 2
ci_004                 2.110150e-02 3 1  ON 3
ci_005                 2.096897e-02 3 1  ON 4
ci_006                -1.970724e-02 3 1  ON 5
ci_007                -1.884541e-02 3 1  ON 6
ci_008                -1.817948e-02 3 1  ON 7
ci_009                -1.755165e-02 3 1  ON 8
ci_010                -1.738041e-02 3 1  ON 9
ci_011                -1.669263e-02 3 1  ON 10
ci_012                -1.678845e-02 3 1  ON 11
ci_013                -1.953346e-02 3 1  ON 12
ci_014                 1.427438e-02 3 1  ON 13
ci_015                 1.396882e-02 3 1  ON 14
ci_016                 1.635934e-02 3 1  ON 15
ci_017                 1.625710e-02 3 1  ON 16
ci_018                 1.271523e-02 3 1  ON 17
ci_019                 1.306261e-02 3 1  ON 18
ci_020                 1.260833e-02 3 1  ON 19
ci_021                 1.319853e-02 3 1  ON 20
ci_022                 1.111227e-02 3 1  ON 21
ci_023                 1.171570e-02 3 1  ON 22
ci_024                 1.215818e-02 3 1  ON 23
ci_025                 1.133782e-02 3 1  ON 24
ci_026                 1.114727e-02 3 1  ON 25
ci_027                 1.093427e-02 3 1  ON 26
ci_028                -1.374211e-02 3 1  ON 27
ci_029                -1.460340e-02 3 1  ON 28
ci_030                -1.159324e-02 3 1  ON 29
ci_031                -1.127106e-02 3 1  ON 30
ci_032                -1.364390e-02 3 1  ON 31
ci_033                 1.015826e-02 3 1  ON 32
ci_034                 1.052971e-02 3 1  ON 33
ci_035                -4.467013e-03 3 1  ON 34
ci_036                -1.049552e-02 3 1  ON 35
ci_037                -1.028348e-02 3 1  ON 36
ci_038                 1.593260e-03 3 1  ON 37
ci_039                 1.861063e-03 3 1  ON 38
ci_040                -3.800931e-03 3 1  ON 39
ci_041                 9.385649e-03 3 1  ON 40
ci_042                 9.946981e-03 3 1  ON 41
ci_043                -2.970803e-03 3 1  ON 42
ci_044                -1.502135e-02 3 1  ON 43
ci_045                -1.914077e-03 3 1  ON 44
ci_046                 5.954088e-03 3 1  ON 45
ci_047                 5.419901e-03 3 1  ON 46
ci_048                -1.181203e-02 3 1  ON 47
ci_049                -1.116331e-02 3 1  ON 48
ci_050                 7.733692e-03 3 1  ON 49
ci_051                 7.297804e-03 3 1  ON 50
ci_052                -6.648033e-03 3 1  ON 51
ci_053                -7.054363e-03 3 1  ON 52
ci_054                -3.265084e-03 3 1  ON 53
ci_055                -3.028969e-03 3 1  ON 54
ci_056                 4.516830e-03 3 1  ON 55
ci_057                 5.091117e-03 3 1  ON 56
ci_058                -7.065712e-03 3 1  ON 57
ci_059                -6.540885e-03 3 1  ON 58
ci_060                 7.893733e-03 3 1  ON 59
ci_061                 8.511655e-03 3 1  ON 60
ci_062                -3.111088e-03 3 1  ON 61
ci_063                -3.457070e-03 3 1  ON 62
ci_064                -3.028783e-03 3 1  ON 63
ci_065                -4.302530e-03 3 1  ON 64
ci_066                 5.582108e-03 3 1  ON 65
ci_067                 5.591603e-03 3 1  ON 66
ci_068                -4.870797e-03 3 1  ON 67
ci_069                -4.262227e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8938e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2035
    reference variance = 0.164028
====================================================
  Execution time = 1.3811e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1365e-01
  Total weights = 1.956477725e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4795e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298994707870
                                         uncertainty =       0.001799344769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298994707870
                                         uncertainty =       0.001799344769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386616777
  error estimate for blocks of size 2^( 2) =       0.000396866135
  error estimate for blocks of size 2^( 3) =       0.000405899666
  error estimate for blocks of size 2^( 4) =       0.000412343145
  error estimate for blocks of size 2^( 5) =       0.000416687991
  error estimate for blocks of size 2^( 6) =       0.000420330149
  error estimate for blocks of size 2^( 7) =       0.000417367357

      target function =                  N/A
              le_mean =     -17.216838760463
             les_mean =     296.733183028346
             stat err =       0.000416682161
             autocorr =       1.161578122022
              std dev =       0.546758689009
             le_variance =       0.298945064007


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721683876046e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216838760504       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216847973408       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216849064450       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216849116610       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 6.714525e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216838760504       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216841930469       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216842265004       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216842267764       residual = 4.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 2.137209e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216838760504       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216839635294       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216839724712       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216839724095       residual = 5.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 5.733099e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.282993 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6296e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -4.054175e-02 3 1  ON 0
ci_002                -3.011693e-02 3 1  ON 1
ci_003                -2.562388e-02 3 1  ON 2
ci_004                 2.116890e-02 3 1  ON 3
ci_005                 2.118269e-02 3 1  ON 4
ci_006                -1.950766e-02 3 1  ON 5
ci_007                -1.901648e-02 3 1  ON 6
ci_008                -1.810792e-02 3 1  ON 7
ci_009                -1.761443e-02 3 1  ON 8
ci_010                -1.751330e-02 3 1  ON 9
ci_011                -1.651590e-02 3 1  ON 10
ci_012                -1.666455e-02 3 1  ON 11
ci_013                -1.953009e-02 3 1  ON 12
ci_014                 1.421644e-02 3 1  ON 13
ci_015                 1.393096e-02 3 1  ON 14
ci_016                 1.641905e-02 3 1  ON 15
ci_017                 1.623507e-02 3 1  ON 16
ci_018                 1.268292e-02 3 1  ON 17
ci_019                 1.298162e-02 3 1  ON 18
ci_020                 1.256881e-02 3 1  ON 19
ci_021                 1.323429e-02 3 1  ON 20
ci_022                 1.114442e-02 3 1  ON 21
ci_023                 1.162769e-02 3 1  ON 22
ci_024                 1.201034e-02 3 1  ON 23
ci_025                 1.127230e-02 3 1  ON 24
ci_026                 1.113269e-02 3 1  ON 25
ci_027                 1.098338e-02 3 1  ON 26
ci_028                -1.375671e-02 3 1  ON 27
ci_029                -1.473130e-02 3 1  ON 28
ci_030                -1.151881e-02 3 1  ON 29
ci_031                -1.119286e-02 3 1  ON 30
ci_032                -1.370505e-02 3 1  ON 31
ci_033                 1.021614e-02 3 1  ON 32
ci_034                 1.045533e-02 3 1  ON 33
ci_035                -4.574599e-03 3 1  ON 34
ci_036                -1.055197e-02 3 1  ON 35
ci_037                -1.019636e-02 3 1  ON 36
ci_038                 1.560434e-03 3 1  ON 37
ci_039                 1.869041e-03 3 1  ON 38
ci_040                -3.840139e-03 3 1  ON 39
ci_041                 9.469595e-03 3 1  ON 40
ci_042                 9.998797e-03 3 1  ON 41
ci_043                -2.872477e-03 3 1  ON 42
ci_044                -1.518239e-02 3 1  ON 43
ci_045                -1.848319e-03 3 1  ON 44
ci_046                 5.847470e-03 3 1  ON 45
ci_047                 5.489670e-03 3 1  ON 46
ci_048                -1.186893e-02 3 1  ON 47
ci_049                -1.129822e-02 3 1  ON 48
ci_050                 7.768596e-03 3 1  ON 49
ci_051                 7.306649e-03 3 1  ON 50
ci_052                -6.498509e-03 3 1  ON 51
ci_053                -7.042543e-03 3 1  ON 52
ci_054                -3.236757e-03 3 1  ON 53
ci_055                -2.993990e-03 3 1  ON 54
ci_056                 4.414619e-03 3 1  ON 55
ci_057                 5.060847e-03 3 1  ON 56
ci_058                -6.919042e-03 3 1  ON 57
ci_059                -6.480191e-03 3 1  ON 58
ci_060                 7.941431e-03 3 1  ON 59
ci_061                 8.590969e-03 3 1  ON 60
ci_062                -3.162512e-03 3 1  ON 61
ci_063                -3.427959e-03 3 1  ON 62
ci_064                -3.024434e-03 3 1  ON 63
ci_065                -4.137879e-03 3 1  ON 64
ci_066                 5.591633e-03 3 1  ON 65
ci_067                 5.780149e-03 3 1  ON 66
ci_068                -4.837673e-03 3 1  ON 67
ci_069                -4.394652e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2348
    reference variance = 0.382408
====================================================
  Execution time = 1.3920e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1681e-01
  Total weights = 1.9567e+06
  Execution time = 1.8138e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301535147958
                                         uncertainty =       0.002420850447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301535147958
                                         uncertainty =       0.002420850447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388290281
  error estimate for blocks of size 2^( 2) =       0.000398125793
  error estimate for blocks of size 2^( 3) =       0.000407231090
  error estimate for blocks of size 2^( 4) =       0.000414509441
  error estimate for blocks of size 2^( 5) =       0.000419178515
  error estimate for blocks of size 2^( 6) =       0.000420903984
  error estimate for blocks of size 2^( 7) =       0.000423109840

      target function =                  N/A
              le_mean =     -17.216250540659
             les_mean =     296.716496894754
             stat err =       0.000419425445
             autocorr =       1.166800233246
              std dev =       0.549125381800
             le_variance =       0.301538684937

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301178237562
                                         uncertainty =       0.002425952047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301178237562
                                         uncertainty =       0.002425952047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388060778
  error estimate for blocks of size 2^( 2) =       0.000397898918
  error estimate for blocks of size 2^( 3) =       0.000407022622
  error estimate for blocks of size 2^( 4) =       0.000414287581
  error estimate for blocks of size 2^( 5) =       0.000418970939
  error estimate for blocks of size 2^( 6) =       0.000420726866
  error estimate for blocks of size 2^( 7) =       0.000422916038

      target function =                  N/A
              le_mean =     -17.216250402856
             les_mean =     296.722104866356
             stat err =       0.000419225356
             autocorr =       1.167066450573
              std dev =       0.548800814777
             le_variance =       0.301182334300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301239475977
                                         uncertainty =       0.002422830206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301239475977
                                         uncertainty =       0.002422830206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388100109
  error estimate for blocks of size 2^( 2) =       0.000397938319
  error estimate for blocks of size 2^( 3) =       0.000407052166
  error estimate for blocks of size 2^( 4) =       0.000414325569
  error estimate for blocks of size 2^( 5) =       0.000419011246
  error estimate for blocks of size 2^( 6) =       0.000420749982
  error estimate for blocks of size 2^( 7) =       0.000422954127

      target function =                  N/A
              le_mean =     -17.216250719582
             les_mean =     296.716209791180
             stat err =       0.000419260231
             autocorr =       1.167024056085
              std dev =       0.548856438036
             le_variance =       0.301243389573

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301487677556
                                         uncertainty =       0.002420910869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301487677556
                                         uncertainty =       0.002420910869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388259751
  error estimate for blocks of size 2^( 2) =       0.000398096822
  error estimate for blocks of size 2^( 3) =       0.000407203127
  error estimate for blocks of size 2^( 4) =       0.000414480284
  error estimate for blocks of size 2^( 5) =       0.000419151833
  error estimate for blocks of size 2^( 6) =       0.000420880248
  error estimate for blocks of size 2^( 7) =       0.000423086566

      target function =                  N/A
              le_mean =     -17.216250460476
             les_mean =     296.726969940954
             stat err =       0.000419399732
             autocorr =       1.166840661250
              std dev =       0.549082205664
             le_variance =       0.301491268577


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216250540659        initial
     3.9062e-01     3.9062e+00             6.7145e-04       -17.216250402856
     1.5625e+00     1.5625e+01             2.1372e-04       -17.216250719582  <--
     6.2500e+00     6.2500e+01             5.7331e-05       -17.216250460476

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.3238e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -4.054175e-02 3 1  ON 0
ci_002                -3.011693e-02 3 1  ON 1
ci_003                -2.562388e-02 3 1  ON 2
ci_004                 2.116890e-02 3 1  ON 3
ci_005                 2.118269e-02 3 1  ON 4
ci_006                -1.950766e-02 3 1  ON 5
ci_007                -1.901648e-02 3 1  ON 6
ci_008                -1.810792e-02 3 1  ON 7
ci_009                -1.761443e-02 3 1  ON 8
ci_010                -1.751330e-02 3 1  ON 9
ci_011                -1.651590e-02 3 1  ON 10
ci_012                -1.666455e-02 3 1  ON 11
ci_013                -1.953009e-02 3 1  ON 12
ci_014                 1.421644e-02 3 1  ON 13
ci_015                 1.393096e-02 3 1  ON 14
ci_016                 1.641905e-02 3 1  ON 15
ci_017                 1.623507e-02 3 1  ON 16
ci_018                 1.268292e-02 3 1  ON 17
ci_019                 1.298162e-02 3 1  ON 18
ci_020                 1.256881e-02 3 1  ON 19
ci_021                 1.323429e-02 3 1  ON 20
ci_022                 1.114442e-02 3 1  ON 21
ci_023                 1.162769e-02 3 1  ON 22
ci_024                 1.201034e-02 3 1  ON 23
ci_025                 1.127230e-02 3 1  ON 24
ci_026                 1.113269e-02 3 1  ON 25
ci_027                 1.098338e-02 3 1  ON 26
ci_028                -1.375671e-02 3 1  ON 27
ci_029                -1.473130e-02 3 1  ON 28
ci_030                -1.151881e-02 3 1  ON 29
ci_031                -1.119286e-02 3 1  ON 30
ci_032                -1.370505e-02 3 1  ON 31
ci_033                 1.021614e-02 3 1  ON 32
ci_034                 1.045533e-02 3 1  ON 33
ci_035                -4.574599e-03 3 1  ON 34
ci_036                -1.055197e-02 3 1  ON 35
ci_037                -1.019636e-02 3 1  ON 36
ci_038                 1.560434e-03 3 1  ON 37
ci_039                 1.869041e-03 3 1  ON 38
ci_040                -3.840139e-03 3 1  ON 39
ci_041                 9.469595e-03 3 1  ON 40
ci_042                 9.998797e-03 3 1  ON 41
ci_043                -2.872477e-03 3 1  ON 42
ci_044                -1.518239e-02 3 1  ON 43
ci_045                -1.848319e-03 3 1  ON 44
ci_046                 5.847470e-03 3 1  ON 45
ci_047                 5.489670e-03 3 1  ON 46
ci_048                -1.186893e-02 3 1  ON 47
ci_049                -1.129822e-02 3 1  ON 48
ci_050                 7.768596e-03 3 1  ON 49
ci_051                 7.306649e-03 3 1  ON 50
ci_052                -6.498509e-03 3 1  ON 51
ci_053                -7.042543e-03 3 1  ON 52
ci_054                -3.236757e-03 3 1  ON 53
ci_055                -2.993990e-03 3 1  ON 54
ci_056                 4.414619e-03 3 1  ON 55
ci_057                 5.060847e-03 3 1  ON 56
ci_058                -6.919042e-03 3 1  ON 57
ci_059                -6.480191e-03 3 1  ON 58
ci_060                 7.941431e-03 3 1  ON 59
ci_061                 8.590969e-03 3 1  ON 60
ci_062                -3.162512e-03 3 1  ON 61
ci_063                -3.427959e-03 3 1  ON 62
ci_064                -3.024434e-03 3 1  ON 63
ci_065                -4.137879e-03 3 1  ON 64
ci_066                 5.591633e-03 3 1  ON 65
ci_067                 5.780149e-03 3 1  ON 66
ci_068                -4.837673e-03 3 1  ON 67
ci_069                -4.394652e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9684e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2744
    reference variance = 0.469493
====================================================
  Execution time = 1.3879e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5306e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1591e-01
  Total weights = 1.956316842e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4968e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301146974934
                                         uncertainty =       0.001987544722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301146974934
                                         uncertainty =       0.001987544722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387989320
  error estimate for blocks of size 2^( 2) =       0.000398048526
  error estimate for blocks of size 2^( 3) =       0.000407321172
  error estimate for blocks of size 2^( 4) =       0.000414174525
  error estimate for blocks of size 2^( 5) =       0.000418751690
  error estimate for blocks of size 2^( 6) =       0.000421304602
  error estimate for blocks of size 2^( 7) =       0.000423564676

      target function =                  N/A
              le_mean =     -17.216677941826
             les_mean =     296.729908508841
             stat err =       0.000419448873
             autocorr =       1.168741651010
              std dev =       0.548699758591
             le_variance =       0.301071425077


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721667794183e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216677941876       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216684345594       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216684965706       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216684874953       residual = 5.21e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 5.572920e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216677941876       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216680214657       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216680238227       residual = 7.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.958870e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216677941876       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216678576671       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216678560129       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216678568805       residual = 1.87e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 5.427385e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.284165 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6381e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -4.047742e-02 3 1  ON 0
ci_002                -3.002441e-02 3 1  ON 1
ci_003                -2.572867e-02 3 1  ON 2
ci_004                 2.121949e-02 3 1  ON 3
ci_005                 2.130331e-02 3 1  ON 4
ci_006                -1.939218e-02 3 1  ON 5
ci_007                -1.904113e-02 3 1  ON 6
ci_008                -1.806625e-02 3 1  ON 7
ci_009                -1.778964e-02 3 1  ON 8
ci_010                -1.748342e-02 3 1  ON 9
ci_011                -1.648244e-02 3 1  ON 10
ci_012                -1.658271e-02 3 1  ON 11
ci_013                -1.944811e-02 3 1  ON 12
ci_014                 1.418330e-02 3 1  ON 13
ci_015                 1.388003e-02 3 1  ON 14
ci_016                 1.642380e-02 3 1  ON 15
ci_017                 1.616909e-02 3 1  ON 16
ci_018                 1.269971e-02 3 1  ON 17
ci_019                 1.292496e-02 3 1  ON 18
ci_020                 1.259458e-02 3 1  ON 19
ci_021                 1.311306e-02 3 1  ON 20
ci_022                 1.131638e-02 3 1  ON 21
ci_023                 1.161902e-02 3 1  ON 22
ci_024                 1.200008e-02 3 1  ON 23
ci_025                 1.130205e-02 3 1  ON 24
ci_026                 1.107549e-02 3 1  ON 25
ci_027                 1.101609e-02 3 1  ON 26
ci_028                -1.381295e-02 3 1  ON 27
ci_029                -1.474304e-02 3 1  ON 28
ci_030                -1.145547e-02 3 1  ON 29
ci_031                -1.110477e-02 3 1  ON 30
ci_032                -1.373325e-02 3 1  ON 31
ci_033                 1.027140e-02 3 1  ON 32
ci_034                 1.036827e-02 3 1  ON 33
ci_035                -4.619978e-03 3 1  ON 34
ci_036                -1.046754e-02 3 1  ON 35
ci_037                -1.016429e-02 3 1  ON 36
ci_038                 1.566095e-03 3 1  ON 37
ci_039                 1.797414e-03 3 1  ON 38
ci_040                -3.800206e-03 3 1  ON 39
ci_041                 9.473262e-03 3 1  ON 40
ci_042                 9.865956e-03 3 1  ON 41
ci_043                -2.911883e-03 3 1  ON 42
ci_044                -1.509300e-02 3 1  ON 43
ci_045                -1.753597e-03 3 1  ON 44
ci_046                 5.865255e-03 3 1  ON 45
ci_047                 5.470263e-03 3 1  ON 46
ci_048                -1.181341e-02 3 1  ON 47
ci_049                -1.147309e-02 3 1  ON 48
ci_050                 7.645350e-03 3 1  ON 49
ci_051                 7.244098e-03 3 1  ON 50
ci_052                -6.502883e-03 3 1  ON 51
ci_053                -7.031158e-03 3 1  ON 52
ci_054                -3.079293e-03 3 1  ON 53
ci_055                -2.995028e-03 3 1  ON 54
ci_056                 4.430791e-03 3 1  ON 55
ci_057                 4.977410e-03 3 1  ON 56
ci_058                -6.895673e-03 3 1  ON 57
ci_059                -6.568970e-03 3 1  ON 58
ci_060                 8.137318e-03 3 1  ON 59
ci_061                 8.497844e-03 3 1  ON 60
ci_062                -3.105717e-03 3 1  ON 61
ci_063                -3.376579e-03 3 1  ON 62
ci_064                -3.136419e-03 3 1  ON 63
ci_065                -4.175939e-03 3 1  ON 64
ci_066                 5.581879e-03 3 1  ON 65
ci_067                 5.800687e-03 3 1  ON 66
ci_068                -4.842628e-03 3 1  ON 67
ci_069                -4.489367e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2519
    reference variance = 0.205945
====================================================
  Execution time = 1.3534e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1666e-01
  Total weights = 1.9566e+06
  Execution time = 1.8145e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302903741241
                                         uncertainty =       0.002360792071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302903741241
                                         uncertainty =       0.002360792071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389098932
  error estimate for blocks of size 2^( 2) =       0.000399309033
  error estimate for blocks of size 2^( 3) =       0.000408723000
  error estimate for blocks of size 2^( 4) =       0.000415625894
  error estimate for blocks of size 2^( 5) =       0.000420091656
  error estimate for blocks of size 2^( 6) =       0.000422573874
  error estimate for blocks of size 2^( 7) =       0.000424372420

      target function =                  N/A
              le_mean =     -17.216558786764
             les_mean =     296.728329217522
             stat err =       0.000420665961
             autocorr =       1.168838924688
              std dev =       0.550268986565
             le_variance =       0.302795957576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302639406434
                                         uncertainty =       0.002372459001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302639406434
                                         uncertainty =       0.002372459001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388928952
  error estimate for blocks of size 2^( 2) =       0.000399136263
  error estimate for blocks of size 2^( 3) =       0.000408551169
  error estimate for blocks of size 2^( 4) =       0.000415449264
  error estimate for blocks of size 2^( 5) =       0.000419942122
  error estimate for blocks of size 2^( 6) =       0.000422445333
  error estimate for blocks of size 2^( 7) =       0.000424231520

      target function =                  N/A
              le_mean =     -17.216561448400
             les_mean =     296.727333725331
             stat err =       0.000420517060
             autocorr =       1.169032786814
              std dev =       0.550028598473
             le_variance =       0.302531459138

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302691759885
                                         uncertainty =       0.002368969577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302691759885
                                         uncertainty =       0.002368969577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388962626
  error estimate for blocks of size 2^( 2) =       0.000399169845
  error estimate for blocks of size 2^( 3) =       0.000408584486
  error estimate for blocks of size 2^( 4) =       0.000415483512
  error estimate for blocks of size 2^( 5) =       0.000419970452
  error estimate for blocks of size 2^( 6) =       0.000422467351
  error estimate for blocks of size 2^( 7) =       0.000424258802

      target function =                  N/A
              le_mean =     -17.216559157913
             les_mean =     296.726336250157
             stat err =       0.000420545029
             autocorr =       1.168985865963
              std dev =       0.550076221336
             le_variance =       0.302583849279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302867558207
                                         uncertainty =       0.002361816327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302867558207
                                         uncertainty =       0.002361816327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389075677
  error estimate for blocks of size 2^( 2) =       0.000399285130
  error estimate for blocks of size 2^( 3) =       0.000408698841
  error estimate for blocks of size 2^( 4) =       0.000415601051
  error estimate for blocks of size 2^( 5) =       0.000420070878
  error estimate for blocks of size 2^( 6) =       0.000422554241
  error estimate for blocks of size 2^( 7) =       0.000424352102

      target function =                  N/A
              le_mean =     -17.216558235526
             les_mean =     296.727295738297
             stat err =       0.000420644568
             autocorr =       1.168859757502
              std dev =       0.550236098820
             le_variance =       0.302759764444


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216558786764        initial
     3.9062e-01     3.9062e+00             5.5729e-04       -17.216561448400  <--
     1.5625e+00     1.5625e+01             1.9589e-04       -17.216559157913
     6.2500e+00     6.2500e+01             5.4274e-05       -17.216558235526

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.2709e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -4.035153e-02 3 1  ON 0
ci_002                -2.985021e-02 3 1  ON 1
ci_003                -2.593448e-02 3 1  ON 2
ci_004                 2.131824e-02 3 1  ON 3
ci_005                 2.155383e-02 3 1  ON 4
ci_006                -1.916184e-02 3 1  ON 5
ci_007                -1.909583e-02 3 1  ON 6
ci_008                -1.799609e-02 3 1  ON 7
ci_009                -1.808864e-02 3 1  ON 8
ci_010                -1.741897e-02 3 1  ON 9
ci_011                -1.642247e-02 3 1  ON 10
ci_012                -1.643428e-02 3 1  ON 11
ci_013                -1.928098e-02 3 1  ON 12
ci_014                 1.411719e-02 3 1  ON 13
ci_015                 1.377995e-02 3 1  ON 14
ci_016                 1.643857e-02 3 1  ON 15
ci_017                 1.604434e-02 3 1  ON 16
ci_018                 1.273333e-02 3 1  ON 17
ci_019                 1.282413e-02 3 1  ON 18
ci_020                 1.264337e-02 3 1  ON 19
ci_021                 1.286279e-02 3 1  ON 20
ci_022                 1.162507e-02 3 1  ON 21
ci_023                 1.159386e-02 3 1  ON 22
ci_024                 1.197240e-02 3 1  ON 23
ci_025                 1.136791e-02 3 1  ON 24
ci_026                 1.097917e-02 3 1  ON 25
ci_027                 1.108386e-02 3 1  ON 26
ci_028                -1.392819e-02 3 1  ON 27
ci_029                -1.476663e-02 3 1  ON 28
ci_030                -1.133811e-02 3 1  ON 29
ci_031                -1.094063e-02 3 1  ON 30
ci_032                -1.377924e-02 3 1  ON 31
ci_033                 1.038288e-02 3 1  ON 32
ci_034                 1.020408e-02 3 1  ON 33
ci_035                -4.687824e-03 3 1  ON 34
ci_036                -1.030198e-02 3 1  ON 35
ci_037                -1.010553e-02 3 1  ON 36
ci_038                 1.577783e-03 3 1  ON 37
ci_039                 1.693053e-03 3 1  ON 38
ci_040                -3.740543e-03 3 1  ON 39
ci_041                 9.489666e-03 3 1  ON 40
ci_042                 9.625494e-03 3 1  ON 41
ci_043                -2.970811e-03 3 1  ON 42
ci_044                -1.490207e-02 3 1  ON 43
ci_045                -1.611536e-03 3 1  ON 44
ci_046                 5.903185e-03 3 1  ON 45
ci_047                 5.433763e-03 3 1  ON 46
ci_048                -1.168526e-02 3 1  ON 47
ci_049                -1.183987e-02 3 1  ON 48
ci_050                 7.452242e-03 3 1  ON 49
ci_051                 7.148975e-03 3 1  ON 50
ci_052                -6.512312e-03 3 1  ON 51
ci_053                -7.010446e-03 3 1  ON 52
ci_054                -2.812165e-03 3 1  ON 53
ci_055                -2.998787e-03 3 1  ON 54
ci_056                 4.454274e-03 3 1  ON 55
ci_057                 4.845335e-03 3 1  ON 56
ci_058                -6.854712e-03 3 1  ON 57
ci_059                -6.722676e-03 3 1  ON 58
ci_060                 8.498723e-03 3 1  ON 59
ci_061                 8.320620e-03 3 1  ON 60
ci_062                -3.010132e-03 3 1  ON 61
ci_063                -3.292537e-03 3 1  ON 62
ci_064                -3.282017e-03 3 1  ON 63
ci_065                -4.223712e-03 3 1  ON 64
ci_066                 5.566694e-03 3 1  ON 65
ci_067                 5.836178e-03 3 1  ON 66
ci_068                -4.854989e-03 3 1  ON 67
ci_069                -4.657936e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9220e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7230e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1958
    reference variance = 0.246119
====================================================
  Execution time = 1.3472e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1668e-01
  Total weights = 1.956658801e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5027e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301348504691
                                         uncertainty =       0.001881975687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301348504691
                                         uncertainty =       0.001881975687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388146914
  error estimate for blocks of size 2^( 2) =       0.000398080538
  error estimate for blocks of size 2^( 3) =       0.000407175564
  error estimate for blocks of size 2^( 4) =       0.000414741568
  error estimate for blocks of size 2^( 5) =       0.000419125006
  error estimate for blocks of size 2^( 6) =       0.000424188625
  error estimate for blocks of size 2^( 7) =       0.000425777051

      target function =                  N/A
              le_mean =     -17.216874613343
             les_mean =     296.737446919215
             stat err =       0.000420958062
             autocorr =       1.176211410903
              std dev =       0.548922630050
             le_variance =       0.301316053782


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721687461334e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216874613379       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216898205687       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216896628195       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216897233839       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216897214404       residual = 4.06e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 1.450301e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216874613379       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216887347991       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216886766346       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216886952669       residual = 6.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 6.579921e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216874613379       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216879095989       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216879073407       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 2.063300e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.285465 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.5980e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -4.040018e-02 3 1  ON 0
ci_002                -2.958296e-02 3 1  ON 1
ci_003                -2.550650e-02 3 1  ON 2
ci_004                 2.134761e-02 3 1  ON 3
ci_005                 2.185727e-02 3 1  ON 4
ci_006                -1.933028e-02 3 1  ON 5
ci_007                -1.919980e-02 3 1  ON 6
ci_008                -1.832115e-02 3 1  ON 7
ci_009                -1.767407e-02 3 1  ON 8
ci_010                -1.757470e-02 3 1  ON 9
ci_011                -1.653662e-02 3 1  ON 10
ci_012                -1.657702e-02 3 1  ON 11
ci_013                -1.961584e-02 3 1  ON 12
ci_014                 1.418688e-02 3 1  ON 13
ci_015                 1.391195e-02 3 1  ON 14
ci_016                 1.674767e-02 3 1  ON 15
ci_017                 1.592315e-02 3 1  ON 16
ci_018                 1.265319e-02 3 1  ON 17
ci_019                 1.263265e-02 3 1  ON 18
ci_020                 1.284472e-02 3 1  ON 19
ci_021                 1.300666e-02 3 1  ON 20
ci_022                 1.159735e-02 3 1  ON 21
ci_023                 1.113687e-02 3 1  ON 22
ci_024                 1.189252e-02 3 1  ON 23
ci_025                 1.168385e-02 3 1  ON 24
ci_026                 1.085393e-02 3 1  ON 25
ci_027                 1.124349e-02 3 1  ON 26
ci_028                -1.424611e-02 3 1  ON 27
ci_029                -1.476278e-02 3 1  ON 28
ci_030                -1.137376e-02 3 1  ON 29
ci_031                -1.106049e-02 3 1  ON 30
ci_032                -1.357191e-02 3 1  ON 31
ci_033                 1.023098e-02 3 1  ON 32
ci_034                 1.022584e-02 3 1  ON 33
ci_035                -4.756260e-03 3 1  ON 34
ci_036                -1.009353e-02 3 1  ON 35
ci_037                -1.013973e-02 3 1  ON 36
ci_038                 1.704228e-03 3 1  ON 37
ci_039                 1.664966e-03 3 1  ON 38
ci_040                -3.684742e-03 3 1  ON 39
ci_041                 9.477373e-03 3 1  ON 40
ci_042                 9.523190e-03 3 1  ON 41
ci_043                -3.187942e-03 3 1  ON 42
ci_044                -1.556007e-02 3 1  ON 43
ci_045                -1.589039e-03 3 1  ON 44
ci_046                 5.769085e-03 3 1  ON 45
ci_047                 5.452802e-03 3 1  ON 46
ci_048                -1.195925e-02 3 1  ON 47
ci_049                -1.173555e-02 3 1  ON 48
ci_050                 7.548961e-03 3 1  ON 49
ci_051                 7.155213e-03 3 1  ON 50
ci_052                -6.574688e-03 3 1  ON 51
ci_053                -6.905971e-03 3 1  ON 52
ci_054                -2.968925e-03 3 1  ON 53
ci_055                -3.006296e-03 3 1  ON 54
ci_056                 4.586121e-03 3 1  ON 55
ci_057                 4.982385e-03 3 1  ON 56
ci_058                -6.981194e-03 3 1  ON 57
ci_059                -6.394213e-03 3 1  ON 58
ci_060                 8.444160e-03 3 1  ON 59
ci_061                 8.522232e-03 3 1  ON 60
ci_062                -3.085323e-03 3 1  ON 61
ci_063                -3.149235e-03 3 1  ON 62
ci_064                -2.968531e-03 3 1  ON 63
ci_065                -4.263341e-03 3 1  ON 64
ci_066                 5.884843e-03 3 1  ON 65
ci_067                 5.842600e-03 3 1  ON 66
ci_068                -4.975222e-03 3 1  ON 67
ci_069                -4.551451e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2848
    reference variance = 0.240751
====================================================
  Execution time = 1.3468e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1931e-01
  Total weights = 1.9566e+06
  Execution time = 1.8152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306031419504
                                         uncertainty =       0.002685749249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306031419504
                                         uncertainty =       0.002685749249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391201058
  error estimate for blocks of size 2^( 2) =       0.000400989463
  error estimate for blocks of size 2^( 3) =       0.000409807493
  error estimate for blocks of size 2^( 4) =       0.000416286142
  error estimate for blocks of size 2^( 5) =       0.000420410985
  error estimate for blocks of size 2^( 6) =       0.000422526680
  error estimate for blocks of size 2^( 7) =       0.000421768775

      target function =                  N/A
              le_mean =     -17.216584195358
             les_mean =     297.020168941070
             stat err =       0.000420248145
             autocorr =       1.154015306435
              std dev =       0.553241842066
             le_variance =       0.306076535812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305912047560
                                         uncertainty =       0.002398751456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305912047560
                                         uncertainty =       0.002398751456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391125312
  error estimate for blocks of size 2^( 2) =       0.000400912081
  error estimate for blocks of size 2^( 3) =       0.000409692588
  error estimate for blocks of size 2^( 4) =       0.000416199966
  error estimate for blocks of size 2^( 5) =       0.000420286958
  error estimate for blocks of size 2^( 6) =       0.000422335857
  error estimate for blocks of size 2^( 7) =       0.000421462958

      target function =                  N/A
              le_mean =     -17.216592502392
             les_mean =     296.733050319781
             stat err =       0.000420071435
             autocorr =       1.153491649180
              std dev =       0.553134721056
             le_variance =       0.305958019638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305948752488
                                         uncertainty =       0.002398462298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305948752488
                                         uncertainty =       0.002398462298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391148863
  error estimate for blocks of size 2^( 2) =       0.000400938818
  error estimate for blocks of size 2^( 3) =       0.000409718155
  error estimate for blocks of size 2^( 4) =       0.000416227165
  error estimate for blocks of size 2^( 5) =       0.000420312035
  error estimate for blocks of size 2^( 6) =       0.000422366638
  error estimate for blocks of size 2^( 7) =       0.000421497468

      target function =                  N/A
              le_mean =     -17.216591816733
             les_mean =     296.735483626882
             stat err =       0.000420100826
             autocorr =       1.153514152807
              std dev =       0.553168026950
             le_variance =       0.305994866040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305380431755
                                         uncertainty =       0.002409787716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305380431755
                                         uncertainty =       0.002409787716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390785026
  error estimate for blocks of size 2^( 2) =       0.000400583662
  error estimate for blocks of size 2^( 3) =       0.000409381247
  error estimate for blocks of size 2^( 4) =       0.000415891425
  error estimate for blocks of size 2^( 5) =       0.000419981112
  error estimate for blocks of size 2^( 6) =       0.000422054621
  error estimate for blocks of size 2^( 7) =       0.000421144712

      target function =                  N/A
              le_mean =     -17.216595490364
             les_mean =     296.734264065125
             stat err =       0.000419767967
             autocorr =       1.153832482427
              std dev =       0.552653483518
             le_variance =       0.305425872845


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216584195358        initial
     9.7656e-02     9.7656e-01             1.4503e-03       -17.216592502392
     3.9062e-01     3.9062e+00             6.5799e-04       -17.216591816733
     1.5625e+00     1.5625e+01             2.0633e-04       -17.216595490364  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.2651e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -4.036914e-02 3 1  ON 0
ci_002                -2.975981e-02 3 1  ON 1
ci_003                -2.579610e-02 3 1  ON 2
ci_004                 2.132715e-02 3 1  ON 3
ci_005                 2.165332e-02 3 1  ON 4
ci_006                -1.921979e-02 3 1  ON 5
ci_007                -1.913080e-02 3 1  ON 6
ci_008                -1.811452e-02 3 1  ON 7
ci_009                -1.793751e-02 3 1  ON 8
ci_010                -1.746614e-02 3 1  ON 9
ci_011                -1.646689e-02 3 1  ON 10
ci_012                -1.648443e-02 3 1  ON 11
ci_013                -1.938595e-02 3 1  ON 12
ci_014                 1.414133e-02 3 1  ON 13
ci_015                 1.382549e-02 3 1  ON 14
ci_016                 1.654153e-02 3 1  ON 15
ci_017                 1.600352e-02 3 1  ON 16
ci_018                 1.270547e-02 3 1  ON 17
ci_019                 1.275616e-02 3 1  ON 18
ci_020                 1.271279e-02 3 1  ON 19
ci_021                 1.290835e-02 3 1  ON 20
ci_022                 1.161607e-02 3 1  ON 21
ci_023                 1.143171e-02 3 1  ON 22
ci_024                 1.194722e-02 3 1  ON 23
ci_025                 1.146998e-02 3 1  ON 24
ci_026                 1.093686e-02 3 1  ON 25
ci_027                 1.114042e-02 3 1  ON 26
ci_028                -1.403421e-02 3 1  ON 27
ci_029                -1.476327e-02 3 1  ON 28
ci_030                -1.134945e-02 3 1  ON 29
ci_031                -1.098364e-02 3 1  ON 30
ci_032                -1.370262e-02 3 1  ON 31
ci_033                 1.033249e-02 3 1  ON 32
ci_034                 1.021377e-02 3 1  ON 33
ci_035                -4.715849e-03 3 1  ON 34
ci_036                -1.023002e-02 3 1  ON 35
ci_037                -1.011796e-02 3 1  ON 36
ci_038                 1.629114e-03 3 1  ON 37
ci_039                 1.682555e-03 3 1  ON 38
ci_040                -3.715771e-03 3 1  ON 39
ci_041                 9.484294e-03 3 1  ON 40
ci_042                 9.588904e-03 3 1  ON 41
ci_043                -3.057062e-03 3 1  ON 42
ci_044                -1.510840e-02 3 1  ON 43
ci_045                -1.602046e-03 3 1  ON 44
ci_046                 5.855322e-03 3 1  ON 45
ci_047                 5.440672e-03 3 1  ON 46
ci_048                -1.177287e-02 3 1  ON 47
ci_049                -1.180597e-02 3 1  ON 48
ci_050                 7.488635e-03 3 1  ON 49
ci_051                 7.152481e-03 3 1  ON 50
ci_052                -6.536391e-03 3 1  ON 51
ci_053                -6.970562e-03 3 1  ON 52
ci_054                -2.870707e-03 3 1  ON 53
ci_055                -3.001602e-03 3 1  ON 54
ci_056                 4.504375e-03 3 1  ON 55
ci_057                 4.897316e-03 3 1  ON 56
ci_058                -6.901826e-03 3 1  ON 57
ci_059                -6.602057e-03 3 1  ON 58
ci_060                 8.478995e-03 3 1  ON 59
ci_061                 8.389904e-03 3 1  ON 60
ci_062                -3.038778e-03 3 1  ON 61
ci_063                -3.240292e-03 3 1  ON 62
ci_064                -3.144735e-03 3 1  ON 63
ci_065                -4.240304e-03 3 1  ON 64
ci_066                 5.690922e-03 3 1  ON 65
ci_067                 5.839950e-03 3 1  ON 66
ci_068                -4.894821e-03 3 1  ON 67
ci_069                -4.617762e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8742e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7231e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.206
    reference variance = 0.365081
====================================================
  Execution time = 1.6179e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1864e-01
  Total weights = 1.956694145e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4882e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301518958705
                                         uncertainty =       0.002337451200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301518958705
                                         uncertainty =       0.002337451200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388276875
  error estimate for blocks of size 2^( 2) =       0.000398611023
  error estimate for blocks of size 2^( 3) =       0.000407635801
  error estimate for blocks of size 2^( 4) =       0.000413957379
  error estimate for blocks of size 2^( 5) =       0.000418272039
  error estimate for blocks of size 2^( 6) =       0.000419481518
  error estimate for blocks of size 2^( 7) =       0.000420427209

      target function =                  N/A
              le_mean =     -17.216755887623
             les_mean =     296.735318511152
             stat err =       0.000418034536
             autocorr =       1.159154362859
              std dev =       0.549106422723
             le_variance =       0.301517863475


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721675588762e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216755887669       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216750276928       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216750246926       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216750362687       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 8.557765e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216755887669       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216753893796       residual = 9.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216753834661       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216753834343       residual = 1.75e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 3.218815e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216755887669       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216755330493       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216755307585       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216755304354       residual = 3.79e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 9.209221e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.286716 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8673e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -4.037132e-02 3 1  ON 0
ci_002                -2.975572e-02 3 1  ON 1
ci_003                -2.588031e-02 3 1  ON 2
ci_004                 2.124416e-02 3 1  ON 3
ci_005                 2.148298e-02 3 1  ON 4
ci_006                -1.934170e-02 3 1  ON 5
ci_007                -1.913911e-02 3 1  ON 6
ci_008                -1.812386e-02 3 1  ON 7
ci_009                -1.797840e-02 3 1  ON 8
ci_010                -1.752780e-02 3 1  ON 9
ci_011                -1.656627e-02 3 1  ON 10
ci_012                -1.631750e-02 3 1  ON 11
ci_013                -1.941779e-02 3 1  ON 12
ci_014                 1.411447e-02 3 1  ON 13
ci_015                 1.380451e-02 3 1  ON 14
ci_016                 1.666413e-02 3 1  ON 15
ci_017                 1.613850e-02 3 1  ON 16
ci_018                 1.266454e-02 3 1  ON 17
ci_019                 1.274628e-02 3 1  ON 18
ci_020                 1.279193e-02 3 1  ON 19
ci_021                 1.292945e-02 3 1  ON 20
ci_022                 1.150212e-02 3 1  ON 21
ci_023                 1.146801e-02 3 1  ON 22
ci_024                 1.190723e-02 3 1  ON 23
ci_025                 1.145667e-02 3 1  ON 24
ci_026                 1.092133e-02 3 1  ON 25
ci_027                 1.116056e-02 3 1  ON 26
ci_028                -1.403738e-02 3 1  ON 27
ci_029                -1.492723e-02 3 1  ON 28
ci_030                -1.122158e-02 3 1  ON 29
ci_031                -1.103006e-02 3 1  ON 30
ci_032                -1.373977e-02 3 1  ON 31
ci_033                 1.024420e-02 3 1  ON 32
ci_034                 1.028024e-02 3 1  ON 33
ci_035                -4.637971e-03 3 1  ON 34
ci_036                -1.019257e-02 3 1  ON 35
ci_037                -1.026789e-02 3 1  ON 36
ci_038                 1.687886e-03 3 1  ON 37
ci_039                 1.661644e-03 3 1  ON 38
ci_040                -3.801605e-03 3 1  ON 39
ci_041                 9.446376e-03 3 1  ON 40
ci_042                 9.705335e-03 3 1  ON 41
ci_043                -3.088375e-03 3 1  ON 42
ci_044                -1.506496e-02 3 1  ON 43
ci_045                -1.678911e-03 3 1  ON 44
ci_046                 5.857459e-03 3 1  ON 45
ci_047                 5.623943e-03 3 1  ON 46
ci_048                -1.179756e-02 3 1  ON 47
ci_049                -1.192448e-02 3 1  ON 48
ci_050                 7.397979e-03 3 1  ON 49
ci_051                 7.336650e-03 3 1  ON 50
ci_052                -6.489538e-03 3 1  ON 51
ci_053                -7.292444e-03 3 1  ON 52
ci_054                -2.873479e-03 3 1  ON 53
ci_055                -3.066019e-03 3 1  ON 54
ci_056                 4.509413e-03 3 1  ON 55
ci_057                 4.862387e-03 3 1  ON 56
ci_058                -6.831438e-03 3 1  ON 57
ci_059                -6.576149e-03 3 1  ON 58
ci_060                 8.419088e-03 3 1  ON 59
ci_061                 8.498654e-03 3 1  ON 60
ci_062                -3.010456e-03 3 1  ON 61
ci_063                -3.217481e-03 3 1  ON 62
ci_064                -3.103169e-03 3 1  ON 63
ci_065                -4.234901e-03 3 1  ON 64
ci_066                 5.757377e-03 3 1  ON 65
ci_067                 5.780797e-03 3 1  ON 66
ci_068                -4.912961e-03 3 1  ON 67
ci_069                -4.542158e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1247
    reference variance = 0.24321
====================================================
  Execution time = 1.3831e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2596e-01
  Total weights = 1.9569e+06
  Execution time = 1.8243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304964089108
                                         uncertainty =       0.004080582862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304964089108
                                         uncertainty =       0.004080582862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390492981
  error estimate for blocks of size 2^( 2) =       0.000400515050
  error estimate for blocks of size 2^( 3) =       0.000408944297
  error estimate for blocks of size 2^( 4) =       0.000415559913
  error estimate for blocks of size 2^( 5) =       0.000420376964
  error estimate for blocks of size 2^( 6) =       0.000421150273
  error estimate for blocks of size 2^( 7) =       0.000421072998

      target function =                  N/A
              le_mean =     -17.216186348338
             les_mean =     296.722669568503
             stat err =       0.000419540037
             autocorr =       1.154304426207
              std dev =       0.552240469505
             le_variance =       0.304969536159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305332400317
                                         uncertainty =       0.004299122672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305332400317
                                         uncertainty =       0.004299122672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390727967
  error estimate for blocks of size 2^( 2) =       0.000400736856
  error estimate for blocks of size 2^( 3) =       0.000409154995
  error estimate for blocks of size 2^( 4) =       0.000415762019
  error estimate for blocks of size 2^( 5) =       0.000420597998
  error estimate for blocks of size 2^( 6) =       0.000421353331
  error estimate for blocks of size 2^( 7) =       0.000421286311

      target function =                  N/A
              le_mean =     -17.216175579839
             les_mean =     296.730640099294
             stat err =       0.000419749915
             autocorr =       1.154070228195
              std dev =       0.552572789979
             le_variance =       0.305336688225

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305206328994
                                         uncertainty =       0.004221823270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305206328994
                                         uncertainty =       0.004221823270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390647481
  error estimate for blocks of size 2^( 2) =       0.000400660334
  error estimate for blocks of size 2^( 3) =       0.000409080812
  error estimate for blocks of size 2^( 4) =       0.000415689960
  error estimate for blocks of size 2^( 5) =       0.000420519305
  error estimate for blocks of size 2^( 6) =       0.000421280269
  error estimate for blocks of size 2^( 7) =       0.000421211085

      target function =                  N/A
              le_mean =     -17.216176394101
             les_mean =     296.723344126310
             stat err =       0.000419675155
             autocorr =       1.154134600851
              std dev =       0.552458966018
             le_variance =       0.305210909134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304990767111
                                         uncertainty =       0.004098614771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304990767111
                                         uncertainty =       0.004098614771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390509980
  error estimate for blocks of size 2^( 2) =       0.000400530804
  error estimate for blocks of size 2^( 3) =       0.000408958890
  error estimate for blocks of size 2^( 4) =       0.000415573501
  error estimate for blocks of size 2^( 5) =       0.000420392138
  error estimate for blocks of size 2^( 6) =       0.000421164074
  error estimate for blocks of size 2^( 7) =       0.000421087707

      target function =                  N/A
              le_mean =     -17.216184132659
             les_mean =     296.722932539361
             stat err =       0.000419554355
             autocorr =       1.154282713645
              std dev =       0.552264510553
             le_variance =       0.304996089617


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216186348338        initial  <--
     3.9062e-01     3.9062e+00             8.5578e-04       -17.216175579839
     1.5625e+00     1.5625e+01             3.2188e-04       -17.216176394101
     6.2500e+00     6.2500e+01             9.2092e-05       -17.216184132659

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0633
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -4.036914e-02 3 1  ON 0
ci_002                -2.975981e-02 3 1  ON 1
ci_003                -2.579610e-02 3 1  ON 2
ci_004                 2.132715e-02 3 1  ON 3
ci_005                 2.165332e-02 3 1  ON 4
ci_006                -1.921979e-02 3 1  ON 5
ci_007                -1.913080e-02 3 1  ON 6
ci_008                -1.811452e-02 3 1  ON 7
ci_009                -1.793751e-02 3 1  ON 8
ci_010                -1.746614e-02 3 1  ON 9
ci_011                -1.646689e-02 3 1  ON 10
ci_012                -1.648443e-02 3 1  ON 11
ci_013                -1.938595e-02 3 1  ON 12
ci_014                 1.414133e-02 3 1  ON 13
ci_015                 1.382549e-02 3 1  ON 14
ci_016                 1.654153e-02 3 1  ON 15
ci_017                 1.600352e-02 3 1  ON 16
ci_018                 1.270547e-02 3 1  ON 17
ci_019                 1.275616e-02 3 1  ON 18
ci_020                 1.271279e-02 3 1  ON 19
ci_021                 1.290835e-02 3 1  ON 20
ci_022                 1.161607e-02 3 1  ON 21
ci_023                 1.143171e-02 3 1  ON 22
ci_024                 1.194722e-02 3 1  ON 23
ci_025                 1.146998e-02 3 1  ON 24
ci_026                 1.093686e-02 3 1  ON 25
ci_027                 1.114042e-02 3 1  ON 26
ci_028                -1.403421e-02 3 1  ON 27
ci_029                -1.476327e-02 3 1  ON 28
ci_030                -1.134945e-02 3 1  ON 29
ci_031                -1.098364e-02 3 1  ON 30
ci_032                -1.370262e-02 3 1  ON 31
ci_033                 1.033249e-02 3 1  ON 32
ci_034                 1.021377e-02 3 1  ON 33
ci_035                -4.715849e-03 3 1  ON 34
ci_036                -1.023002e-02 3 1  ON 35
ci_037                -1.011796e-02 3 1  ON 36
ci_038                 1.629114e-03 3 1  ON 37
ci_039                 1.682555e-03 3 1  ON 38
ci_040                -3.715771e-03 3 1  ON 39
ci_041                 9.484294e-03 3 1  ON 40
ci_042                 9.588904e-03 3 1  ON 41
ci_043                -3.057062e-03 3 1  ON 42
ci_044                -1.510840e-02 3 1  ON 43
ci_045                -1.602046e-03 3 1  ON 44
ci_046                 5.855322e-03 3 1  ON 45
ci_047                 5.440672e-03 3 1  ON 46
ci_048                -1.177287e-02 3 1  ON 47
ci_049                -1.180597e-02 3 1  ON 48
ci_050                 7.488635e-03 3 1  ON 49
ci_051                 7.152481e-03 3 1  ON 50
ci_052                -6.536391e-03 3 1  ON 51
ci_053                -6.970562e-03 3 1  ON 52
ci_054                -2.870707e-03 3 1  ON 53
ci_055                -3.001602e-03 3 1  ON 54
ci_056                 4.504375e-03 3 1  ON 55
ci_057                 4.897316e-03 3 1  ON 56
ci_058                -6.901826e-03 3 1  ON 57
ci_059                -6.602057e-03 3 1  ON 58
ci_060                 8.478995e-03 3 1  ON 59
ci_061                 8.389904e-03 3 1  ON 60
ci_062                -3.038778e-03 3 1  ON 61
ci_063                -3.240292e-03 3 1  ON 62
ci_064                -3.144735e-03 3 1  ON 63
ci_065                -4.240304e-03 3 1  ON 64
ci_066                 5.690922e-03 3 1  ON 65
ci_067                 5.839950e-03 3 1  ON 66
ci_068                -4.894821e-03 3 1  ON 67
ci_069                -4.617762e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1891e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2049
    reference variance = 0.132011
====================================================
  Execution time = 1.4784e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1754e-01
  Total weights = 1.956531631e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5015e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302233147707
                                         uncertainty =       0.002224467000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302233147707
                                         uncertainty =       0.002224467000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388689417
  error estimate for blocks of size 2^( 2) =       0.000399012378
  error estimate for blocks of size 2^( 3) =       0.000408337983
  error estimate for blocks of size 2^( 4) =       0.000415062688
  error estimate for blocks of size 2^( 5) =       0.000419981232
  error estimate for blocks of size 2^( 6) =       0.000422188484
  error estimate for blocks of size 2^( 7) =       0.000424457466

      target function =                  N/A
              le_mean =     -17.216482627375
             les_mean =     296.724813514692
             stat err =       0.000420422467
             autocorr =       1.169947574404
              std dev =       0.549689844870
             le_variance =       0.302158925554


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721648262738e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216482627426       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216483080672       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216483075675       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216483068654       residual = 3.87e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 1.114760e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216482627426       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216482746187       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216482737571       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216482735730       residual = 4.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 2.911225e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216482627426       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216482657478       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216482654813       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216482654329       residual = 5.31e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 7.360250e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.287996 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7291e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -4.037848e-02 3 1  ON 0
ci_002                -2.976736e-02 3 1  ON 1
ci_003                -2.579686e-02 3 1  ON 2
ci_004                 2.131766e-02 3 1  ON 3
ci_005                 2.164963e-02 3 1  ON 4
ci_006                -1.922911e-02 3 1  ON 5
ci_007                -1.912615e-02 3 1  ON 6
ci_008                -1.809752e-02 3 1  ON 7
ci_009                -1.794301e-02 3 1  ON 8
ci_010                -1.747209e-02 3 1  ON 9
ci_011                -1.644853e-02 3 1  ON 10
ci_012                -1.645532e-02 3 1  ON 11
ci_013                -1.939220e-02 3 1  ON 12
ci_014                 1.413383e-02 3 1  ON 13
ci_015                 1.381789e-02 3 1  ON 14
ci_016                 1.655391e-02 3 1  ON 15
ci_017                 1.600876e-02 3 1  ON 16
ci_018                 1.271079e-02 3 1  ON 17
ci_019                 1.275571e-02 3 1  ON 18
ci_020                 1.274020e-02 3 1  ON 19
ci_021                 1.290832e-02 3 1  ON 20
ci_022                 1.161893e-02 3 1  ON 21
ci_023                 1.142200e-02 3 1  ON 22
ci_024                 1.194669e-02 3 1  ON 23
ci_025                 1.145939e-02 3 1  ON 24
ci_026                 1.094452e-02 3 1  ON 25
ci_027                 1.113571e-02 3 1  ON 26
ci_028                -1.404311e-02 3 1  ON 27
ci_029                -1.476731e-02 3 1  ON 28
ci_030                -1.135443e-02 3 1  ON 29
ci_031                -1.097642e-02 3 1  ON 30
ci_032                -1.370949e-02 3 1  ON 31
ci_033                 1.033587e-02 3 1  ON 32
ci_034                 1.021257e-02 3 1  ON 33
ci_035                -4.732095e-03 3 1  ON 34
ci_036                -1.024077e-02 3 1  ON 35
ci_037                -1.011302e-02 3 1  ON 36
ci_038                 1.644043e-03 3 1  ON 37
ci_039                 1.682867e-03 3 1  ON 38
ci_040                -3.728888e-03 3 1  ON 39
ci_041                 9.478279e-03 3 1  ON 40
ci_042                 9.596109e-03 3 1  ON 41
ci_043                -3.051575e-03 3 1  ON 42
ci_044                -1.510351e-02 3 1  ON 43
ci_045                -1.598450e-03 3 1  ON 44
ci_046                 5.835712e-03 3 1  ON 45
ci_047                 5.445793e-03 3 1  ON 46
ci_048                -1.178048e-02 3 1  ON 47
ci_049                -1.180479e-02 3 1  ON 48
ci_050                 7.498205e-03 3 1  ON 49
ci_051                 7.176839e-03 3 1  ON 50
ci_052                -6.526693e-03 3 1  ON 51
ci_053                -6.955512e-03 3 1  ON 52
ci_054                -2.869692e-03 3 1  ON 53
ci_055                -3.006061e-03 3 1  ON 54
ci_056                 4.499493e-03 3 1  ON 55
ci_057                 4.891508e-03 3 1  ON 56
ci_058                -6.910986e-03 3 1  ON 57
ci_059                -6.605838e-03 3 1  ON 58
ci_060                 8.493732e-03 3 1  ON 59
ci_061                 8.379883e-03 3 1  ON 60
ci_062                -3.040657e-03 3 1  ON 61
ci_063                -3.239079e-03 3 1  ON 62
ci_064                -3.148626e-03 3 1  ON 63
ci_065                -4.244222e-03 3 1  ON 64
ci_066                 5.694915e-03 3 1  ON 65
ci_067                 5.836606e-03 3 1  ON 66
ci_068                -4.899347e-03 3 1  ON 67
ci_069                -4.613188e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1745
    reference variance = 0.748848
====================================================
  Execution time = 1.4169e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1352e-01
  Total weights = 1.9567e+06
  Execution time = 1.8158e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300047616013
                                         uncertainty =       0.001882339949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300047616013
                                         uncertainty =       0.001882339949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387291205
  error estimate for blocks of size 2^( 2) =       0.000397368708
  error estimate for blocks of size 2^( 3) =       0.000406654650
  error estimate for blocks of size 2^( 4) =       0.000414106378
  error estimate for blocks of size 2^( 5) =       0.000417985986
  error estimate for blocks of size 2^( 6) =       0.000419526600
  error estimate for blocks of size 2^( 7) =       0.000419827917

      target function =                  N/A
              le_mean =     -17.216310541844
             les_mean =     296.714895892663
             stat err =       0.000417861720
             autocorr =       1.164098973315
              std dev =       0.547712474579
             le_variance =       0.299988954809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300013379703
                                         uncertainty =       0.001882651688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300013379703
                                         uncertainty =       0.001882651688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387269107
  error estimate for blocks of size 2^( 2) =       0.000397346251
  error estimate for blocks of size 2^( 3) =       0.000406631654
  error estimate for blocks of size 2^( 4) =       0.000414082810
  error estimate for blocks of size 2^( 5) =       0.000417964805
  error estimate for blocks of size 2^( 6) =       0.000419508800
  error estimate for blocks of size 2^( 7) =       0.000419806254

      target function =                  N/A
              le_mean =     -17.216311335498
             les_mean =     296.715218699654
             stat err =       0.000417840667
             autocorr =       1.164114515192
              std dev =       0.547681223668
             le_variance =       0.299954722759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300029750176
                                         uncertainty =       0.001882497847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300029750176
                                         uncertainty =       0.001882497847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387279673
  error estimate for blocks of size 2^( 2) =       0.000397356960
  error estimate for blocks of size 2^( 3) =       0.000406642577
  error estimate for blocks of size 2^( 4) =       0.000414093980
  error estimate for blocks of size 2^( 5) =       0.000417974840
  error estimate for blocks of size 2^( 6) =       0.000419517248
  error estimate for blocks of size 2^( 7) =       0.000419816536

      target function =                  N/A
              le_mean =     -17.216310902502
             les_mean =     296.714886219000
             stat err =       0.000417850651
             autocorr =       1.164106622744
              std dev =       0.547696166570
             le_variance =       0.299971090876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300045312286
                                         uncertainty =       0.001882359126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300045312286
                                         uncertainty =       0.001882359126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387289718
  error estimate for blocks of size 2^( 2) =       0.000397367192
  error estimate for blocks of size 2^( 3) =       0.000406653092
  error estimate for blocks of size 2^( 4) =       0.000414104780
  error estimate for blocks of size 2^( 5) =       0.000417984546
  error estimate for blocks of size 2^( 6) =       0.000419525391
  error estimate for blocks of size 2^( 7) =       0.000419826448

      target function =                  N/A
              le_mean =     -17.216310578321
             les_mean =     296.714884385560
             stat err =       0.000417860291
             autocorr =       1.164099950556
              std dev =       0.547710371760
             le_variance =       0.299986651333


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216310541844        initial
     3.9062e+00     3.9062e+01             1.1148e-04       -17.216311335498  <--
     1.5625e+01     1.5625e+02             2.9112e-05       -17.216310902502
     6.2500e+01     6.2500e+02             7.3602e-06       -17.216310578321

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 2.3318e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -4.040490e-02 3 1  ON 0
ci_002                -2.978844e-02 3 1  ON 1
ci_003                -2.579832e-02 3 1  ON 2
ci_004                 2.129034e-02 3 1  ON 3
ci_005                 2.163884e-02 3 1  ON 4
ci_006                -1.925556e-02 3 1  ON 5
ci_007                -1.911253e-02 3 1  ON 6
ci_008                -1.805016e-02 3 1  ON 7
ci_009                -1.795825e-02 3 1  ON 8
ci_010                -1.748896e-02 3 1  ON 9
ci_011                -1.639671e-02 3 1  ON 10
ci_012                -1.637296e-02 3 1  ON 11
ci_013                -1.941017e-02 3 1  ON 12
ci_014                 1.411266e-02 3 1  ON 13
ci_015                 1.379639e-02 3 1  ON 14
ci_016                 1.658907e-02 3 1  ON 15
ci_017                 1.602355e-02 3 1  ON 16
ci_018                 1.272575e-02 3 1  ON 17
ci_019                 1.275446e-02 3 1  ON 18
ci_020                 1.281851e-02 3 1  ON 19
ci_021                 1.290830e-02 3 1  ON 20
ci_022                 1.162717e-02 3 1  ON 21
ci_023                 1.139456e-02 3 1  ON 22
ci_024                 1.194515e-02 3 1  ON 23
ci_025                 1.142879e-02 3 1  ON 24
ci_026                 1.096627e-02 3 1  ON 25
ci_027                 1.112234e-02 3 1  ON 26
ci_028                -1.406836e-02 3 1  ON 27
ci_029                -1.477898e-02 3 1  ON 28
ci_030                -1.136862e-02 3 1  ON 29
ci_031                -1.095580e-02 3 1  ON 30
ci_032                -1.372857e-02 3 1  ON 31
ci_033                 1.034555e-02 3 1  ON 32
ci_034                 1.020933e-02 3 1  ON 33
ci_035                -4.776395e-03 3 1  ON 34
ci_036                -1.027152e-02 3 1  ON 35
ci_037                -1.009884e-02 3 1  ON 36
ci_038                 1.684693e-03 3 1  ON 37
ci_039                 1.683719e-03 3 1  ON 38
ci_040                -3.764269e-03 3 1  ON 39
ci_041                 9.461228e-03 3 1  ON 40
ci_042                 9.616394e-03 3 1  ON 41
ci_043                -3.036442e-03 3 1  ON 42
ci_044                -1.508924e-02 3 1  ON 43
ci_045                -1.588561e-03 3 1  ON 44
ci_046                 5.780557e-03 3 1  ON 45
ci_047                 5.460141e-03 3 1  ON 46
ci_048                -1.180236e-02 3 1  ON 47
ci_049                -1.180143e-02 3 1  ON 48
ci_050                 7.524459e-03 3 1  ON 49
ci_051                 7.243744e-03 3 1  ON 50
ci_052                -6.499522e-03 3 1  ON 51
ci_053                -6.913711e-03 3 1  ON 52
ci_054                -2.866825e-03 3 1  ON 53
ci_055                -3.018471e-03 3 1  ON 54
ci_056                 4.486029e-03 3 1  ON 55
ci_057                 4.875491e-03 3 1  ON 56
ci_058                -6.936462e-03 3 1  ON 57
ci_059                -6.616436e-03 3 1  ON 58
ci_060                 8.535602e-03 3 1  ON 59
ci_061                 8.351712e-03 3 1  ON 60
ci_062                -3.045825e-03 3 1  ON 61
ci_063                -3.235719e-03 3 1  ON 62
ci_064                -3.158864e-03 3 1  ON 63
ci_065                -4.254529e-03 3 1  ON 64
ci_066                 5.705919e-03 3 1  ON 65
ci_067                 5.827529e-03 3 1  ON 66
ci_068                -4.912296e-03 3 1  ON 67
ci_069                -4.600277e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0631e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2168
    reference variance = 0.27045
====================================================
  Execution time = 1.3998e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1942e-01
  Total weights = 1.956599543e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4881e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299901883381
                                         uncertainty =       0.001926468070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299901883381
                                         uncertainty =       0.001926468070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387229802
  error estimate for blocks of size 2^( 2) =       0.000397481340
  error estimate for blocks of size 2^( 3) =       0.000407038359
  error estimate for blocks of size 2^( 4) =       0.000414066939
  error estimate for blocks of size 2^( 5) =       0.000418578505
  error estimate for blocks of size 2^( 6) =       0.000422126092
  error estimate for blocks of size 2^( 7) =       0.000425336656

      target function =                  N/A
              le_mean =     -17.215729704284
             les_mean =     296.700766982698
             stat err =       0.000420027048
             autocorr =       1.176567822152
              std dev =       0.547625638213
             le_variance =       0.299893839628


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721572970428e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215729704318       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215730128282       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215729963857       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 2.921665e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215729704318       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215729830254       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215729860005       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215729860571       residual = 1.85e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 8.906708e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215729704318       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215729737357       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215729751626       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215729752378       residual = 2.55e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 2.355170e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.289217 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6491e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -4.036970e-02 3 1  ON 0
ci_002                -2.981331e-02 3 1  ON 1
ci_003                -2.580433e-02 3 1  ON 2
ci_004                 2.135679e-02 3 1  ON 3
ci_005                 2.159099e-02 3 1  ON 4
ci_006                -1.920799e-02 3 1  ON 5
ci_007                -1.905793e-02 3 1  ON 6
ci_008                -1.803054e-02 3 1  ON 7
ci_009                -1.794230e-02 3 1  ON 8
ci_010                -1.747414e-02 3 1  ON 9
ci_011                -1.642147e-02 3 1  ON 10
ci_012                -1.640524e-02 3 1  ON 11
ci_013                -1.939381e-02 3 1  ON 12
ci_014                 1.409976e-02 3 1  ON 13
ci_015                 1.375293e-02 3 1  ON 14
ci_016                 1.658966e-02 3 1  ON 15
ci_017                 1.602766e-02 3 1  ON 16
ci_018                 1.269193e-02 3 1  ON 17
ci_019                 1.276961e-02 3 1  ON 18
ci_020                 1.282816e-02 3 1  ON 19
ci_021                 1.291412e-02 3 1  ON 20
ci_022                 1.161282e-02 3 1  ON 21
ci_023                 1.136003e-02 3 1  ON 22
ci_024                 1.191007e-02 3 1  ON 23
ci_025                 1.139039e-02 3 1  ON 24
ci_026                 1.102024e-02 3 1  ON 25
ci_027                 1.106711e-02 3 1  ON 26
ci_028                -1.408529e-02 3 1  ON 27
ci_029                -1.476718e-02 3 1  ON 28
ci_030                -1.134167e-02 3 1  ON 29
ci_031                -1.095577e-02 3 1  ON 30
ci_032                -1.376595e-02 3 1  ON 31
ci_033                 1.035643e-02 3 1  ON 32
ci_034                 1.018769e-02 3 1  ON 33
ci_035                -4.776257e-03 3 1  ON 34
ci_036                -1.030934e-02 3 1  ON 35
ci_037                -1.014741e-02 3 1  ON 36
ci_038                 1.664306e-03 3 1  ON 37
ci_039                 1.705922e-03 3 1  ON 38
ci_040                -3.777839e-03 3 1  ON 39
ci_041                 9.429079e-03 3 1  ON 40
ci_042                 9.617992e-03 3 1  ON 41
ci_043                -3.033261e-03 3 1  ON 42
ci_044                -1.504898e-02 3 1  ON 43
ci_045                -1.548689e-03 3 1  ON 44
ci_046                 5.775267e-03 3 1  ON 45
ci_047                 5.516344e-03 3 1  ON 46
ci_048                -1.179955e-02 3 1  ON 47
ci_049                -1.183309e-02 3 1  ON 48
ci_050                 7.495445e-03 3 1  ON 49
ci_051                 7.193907e-03 3 1  ON 50
ci_052                -6.448440e-03 3 1  ON 51
ci_053                -6.840288e-03 3 1  ON 52
ci_054                -2.920143e-03 3 1  ON 53
ci_055                -2.967836e-03 3 1  ON 54
ci_056                 4.482995e-03 3 1  ON 55
ci_057                 4.895432e-03 3 1  ON 56
ci_058                -6.874219e-03 3 1  ON 57
ci_059                -6.527369e-03 3 1  ON 58
ci_060                 8.555649e-03 3 1  ON 59
ci_061                 8.410463e-03 3 1  ON 60
ci_062                -3.053462e-03 3 1  ON 61
ci_063                -3.232431e-03 3 1  ON 62
ci_064                -3.124463e-03 3 1  ON 63
ci_065                -4.198752e-03 3 1  ON 64
ci_066                 5.688033e-03 3 1  ON 65
ci_067                 5.865239e-03 3 1  ON 66
ci_068                -4.899815e-03 3 1  ON 67
ci_069                -4.638842e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2454
    reference variance = 0.226841
====================================================
  Execution time = 1.3452e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2180e-01
  Total weights = 1.9566e+06
  Execution time = 1.8088e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303606295095
                                         uncertainty =       0.002552804553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303606295095
                                         uncertainty =       0.002552804553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389696478
  error estimate for blocks of size 2^( 2) =       0.000400021254
  error estimate for blocks of size 2^( 3) =       0.000408945477
  error estimate for blocks of size 2^( 4) =       0.000415636136
  error estimate for blocks of size 2^( 5) =       0.000419635897
  error estimate for blocks of size 2^( 6) =       0.000421847627
  error estimate for blocks of size 2^( 7) =       0.000422029269

      target function =                  N/A
              le_mean =     -17.217569959633
             les_mean =     296.767003490752
             stat err =       0.000419787232
             autocorr =       1.160394042070
              std dev =       0.551114043925
             le_variance =       0.303726689411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303158877983
                                         uncertainty =       0.002521019084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303158877983
                                         uncertainty =       0.002521019084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389409207
  error estimate for blocks of size 2^( 2) =       0.000399749775
  error estimate for blocks of size 2^( 3) =       0.000408688179
  error estimate for blocks of size 2^( 4) =       0.000415394448
  error estimate for blocks of size 2^( 5) =       0.000419397696
  error estimate for blocks of size 2^( 6) =       0.000421614454
  error estimate for blocks of size 2^( 7) =       0.000421804766

      target function =                  N/A
              le_mean =     -17.217568904976
             les_mean =     296.766447642762
             stat err =       0.000419552841
             autocorr =       1.160809362629
              std dev =       0.550707781156
             le_variance =       0.303279060226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303329162002
                                         uncertainty =       0.002533496792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303329162002
                                         uncertainty =       0.002533496792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389518574
  error estimate for blocks of size 2^( 2) =       0.000399853148
  error estimate for blocks of size 2^( 3) =       0.000408786249
  error estimate for blocks of size 2^( 4) =       0.000415486454
  error estimate for blocks of size 2^( 5) =       0.000419488336
  error estimate for blocks of size 2^( 6) =       0.000421702782
  error estimate for blocks of size 2^( 7) =       0.000421889270

      target function =                  N/A
              le_mean =     -17.217568867199
             les_mean =     296.766412518804
             stat err =       0.000419641710
             autocorr =       1.160649138919
              std dev =       0.550862450323
             le_variance =       0.303449439176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303568651458
                                         uncertainty =       0.002550206959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303568651458
                                         uncertainty =       0.002550206959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389672318
  error estimate for blocks of size 2^( 2) =       0.000399998374
  error estimate for blocks of size 2^( 3) =       0.000408923778
  error estimate for blocks of size 2^( 4) =       0.000415615605
  error estimate for blocks of size 2^( 5) =       0.000419615537
  error estimate for blocks of size 2^( 6) =       0.000421827719
  error estimate for blocks of size 2^( 7) =       0.000422009891

      target function =                  N/A
              le_mean =     -17.217569726978
             les_mean =     296.766726079131
             stat err =       0.000419767188
             autocorr =       1.160427108964
              std dev =       0.551079877230
             le_variance =       0.303689031088


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217569959633        initial  <--
     9.7656e-01     9.7656e+00             2.9217e-04       -17.217568904976
     3.9062e+00     3.9062e+01             8.9067e-05       -17.217568867199
     1.5625e+01     1.5625e+02             2.3552e-05       -17.217569726978

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6080
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -4.040490e-02 3 1  ON 0
ci_002                -2.978844e-02 3 1  ON 1
ci_003                -2.579832e-02 3 1  ON 2
ci_004                 2.129034e-02 3 1  ON 3
ci_005                 2.163884e-02 3 1  ON 4
ci_006                -1.925556e-02 3 1  ON 5
ci_007                -1.911253e-02 3 1  ON 6
ci_008                -1.805016e-02 3 1  ON 7
ci_009                -1.795825e-02 3 1  ON 8
ci_010                -1.748896e-02 3 1  ON 9
ci_011                -1.639671e-02 3 1  ON 10
ci_012                -1.637296e-02 3 1  ON 11
ci_013                -1.941017e-02 3 1  ON 12
ci_014                 1.411266e-02 3 1  ON 13
ci_015                 1.379639e-02 3 1  ON 14
ci_016                 1.658907e-02 3 1  ON 15
ci_017                 1.602355e-02 3 1  ON 16
ci_018                 1.272575e-02 3 1  ON 17
ci_019                 1.275446e-02 3 1  ON 18
ci_020                 1.281851e-02 3 1  ON 19
ci_021                 1.290830e-02 3 1  ON 20
ci_022                 1.162717e-02 3 1  ON 21
ci_023                 1.139456e-02 3 1  ON 22
ci_024                 1.194515e-02 3 1  ON 23
ci_025                 1.142879e-02 3 1  ON 24
ci_026                 1.096627e-02 3 1  ON 25
ci_027                 1.112234e-02 3 1  ON 26
ci_028                -1.406836e-02 3 1  ON 27
ci_029                -1.477898e-02 3 1  ON 28
ci_030                -1.136862e-02 3 1  ON 29
ci_031                -1.095580e-02 3 1  ON 30
ci_032                -1.372857e-02 3 1  ON 31
ci_033                 1.034555e-02 3 1  ON 32
ci_034                 1.020933e-02 3 1  ON 33
ci_035                -4.776395e-03 3 1  ON 34
ci_036                -1.027152e-02 3 1  ON 35
ci_037                -1.009884e-02 3 1  ON 36
ci_038                 1.684693e-03 3 1  ON 37
ci_039                 1.683719e-03 3 1  ON 38
ci_040                -3.764269e-03 3 1  ON 39
ci_041                 9.461228e-03 3 1  ON 40
ci_042                 9.616394e-03 3 1  ON 41
ci_043                -3.036442e-03 3 1  ON 42
ci_044                -1.508924e-02 3 1  ON 43
ci_045                -1.588561e-03 3 1  ON 44
ci_046                 5.780557e-03 3 1  ON 45
ci_047                 5.460141e-03 3 1  ON 46
ci_048                -1.180236e-02 3 1  ON 47
ci_049                -1.180143e-02 3 1  ON 48
ci_050                 7.524459e-03 3 1  ON 49
ci_051                 7.243744e-03 3 1  ON 50
ci_052                -6.499522e-03 3 1  ON 51
ci_053                -6.913711e-03 3 1  ON 52
ci_054                -2.866825e-03 3 1  ON 53
ci_055                -3.018471e-03 3 1  ON 54
ci_056                 4.486029e-03 3 1  ON 55
ci_057                 4.875491e-03 3 1  ON 56
ci_058                -6.936462e-03 3 1  ON 57
ci_059                -6.616436e-03 3 1  ON 58
ci_060                 8.535602e-03 3 1  ON 59
ci_061                 8.351712e-03 3 1  ON 60
ci_062                -3.045825e-03 3 1  ON 61
ci_063                -3.235719e-03 3 1  ON 62
ci_064                -3.158864e-03 3 1  ON 63
ci_065                -4.254529e-03 3 1  ON 64
ci_066                 5.705919e-03 3 1  ON 65
ci_067                 5.827529e-03 3 1  ON 66
ci_068                -4.912296e-03 3 1  ON 67
ci_069                -4.600277e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9150e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2384
    reference variance = 0.216967
====================================================
  Execution time = 1.3782e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1604e-01
  Total weights = 1.956716061e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5021e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300168559095
                                         uncertainty =       0.002107122883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300168559095
                                         uncertainty =       0.002107122883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387524845
  error estimate for blocks of size 2^( 2) =       0.000397129778
  error estimate for blocks of size 2^( 3) =       0.000406265612
  error estimate for blocks of size 2^( 4) =       0.000412833970
  error estimate for blocks of size 2^( 5) =       0.000416555478
  error estimate for blocks of size 2^( 6) =       0.000417954266
  error estimate for blocks of size 2^( 7) =       0.000418488720

      target function =                  N/A
              le_mean =     -17.215901568958
             les_mean =     296.703308265477
             stat err =       0.000416458109
             autocorr =       1.154897768493
              std dev =       0.548042891819
             le_variance =       0.300351011273


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721590156896e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215901569010       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215901892374       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215901891203       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215901893946       residual = 1.93e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 3.174679e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215901569010       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215901651385       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215901650598       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215901651258       residual = 2.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 8.104711e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215901569010       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215901589702       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215901589473       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215901589635       residual = 2.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 2.036961e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.290502 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6289e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -4.040588e-02 3 1  ON 0
ci_002                -2.979020e-02 3 1  ON 1
ci_003                -2.579849e-02 3 1  ON 2
ci_004                 2.128653e-02 3 1  ON 3
ci_005                 2.163636e-02 3 1  ON 4
ci_006                -1.925258e-02 3 1  ON 5
ci_007                -1.911027e-02 3 1  ON 6
ci_008                -1.805073e-02 3 1  ON 7
ci_009                -1.795775e-02 3 1  ON 8
ci_010                -1.749302e-02 3 1  ON 9
ci_011                -1.639304e-02 3 1  ON 10
ci_012                -1.637101e-02 3 1  ON 11
ci_013                -1.941252e-02 3 1  ON 12
ci_014                 1.410828e-02 3 1  ON 13
ci_015                 1.379936e-02 3 1  ON 14
ci_016                 1.659585e-02 3 1  ON 15
ci_017                 1.602398e-02 3 1  ON 16
ci_018                 1.272602e-02 3 1  ON 17
ci_019                 1.275198e-02 3 1  ON 18
ci_020                 1.281727e-02 3 1  ON 19
ci_021                 1.290872e-02 3 1  ON 20
ci_022                 1.162446e-02 3 1  ON 21
ci_023                 1.139501e-02 3 1  ON 22
ci_024                 1.193885e-02 3 1  ON 23
ci_025                 1.142812e-02 3 1  ON 24
ci_026                 1.096645e-02 3 1  ON 25
ci_027                 1.111789e-02 3 1  ON 26
ci_028                -1.407000e-02 3 1  ON 27
ci_029                -1.477837e-02 3 1  ON 28
ci_030                -1.136588e-02 3 1  ON 29
ci_031                -1.095535e-02 3 1  ON 30
ci_032                -1.373667e-02 3 1  ON 31
ci_033                 1.034641e-02 3 1  ON 32
ci_034                 1.021058e-02 3 1  ON 33
ci_035                -4.773447e-03 3 1  ON 34
ci_036                -1.027556e-02 3 1  ON 35
ci_037                -1.009750e-02 3 1  ON 36
ci_038                 1.687607e-03 3 1  ON 37
ci_039                 1.683157e-03 3 1  ON 38
ci_040                -3.766638e-03 3 1  ON 39
ci_041                 9.462291e-03 3 1  ON 40
ci_042                 9.618568e-03 3 1  ON 41
ci_043                -3.038117e-03 3 1  ON 42
ci_044                -1.509100e-02 3 1  ON 43
ci_045                -1.593423e-03 3 1  ON 44
ci_046                 5.778632e-03 3 1  ON 45
ci_047                 5.460668e-03 3 1  ON 46
ci_048                -1.180546e-02 3 1  ON 47
ci_049                -1.180410e-02 3 1  ON 48
ci_050                 7.528546e-03 3 1  ON 49
ci_051                 7.244145e-03 3 1  ON 50
ci_052                -6.496199e-03 3 1  ON 51
ci_053                -6.910369e-03 3 1  ON 52
ci_054                -2.860231e-03 3 1  ON 53
ci_055                -3.016048e-03 3 1  ON 54
ci_056                 4.482025e-03 3 1  ON 55
ci_057                 4.874157e-03 3 1  ON 56
ci_058                -6.939516e-03 3 1  ON 57
ci_059                -6.624324e-03 3 1  ON 58
ci_060                 8.530695e-03 3 1  ON 59
ci_061                 8.359689e-03 3 1  ON 60
ci_062                -3.045675e-03 3 1  ON 61
ci_063                -3.230099e-03 3 1  ON 62
ci_064                -3.159005e-03 3 1  ON 63
ci_065                -4.254110e-03 3 1  ON 64
ci_066                 5.700440e-03 3 1  ON 65
ci_067                 5.831005e-03 3 1  ON 66
ci_068                -4.909516e-03 3 1  ON 67
ci_069                -4.600328e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1689
    reference variance = 0.272673
====================================================
  Execution time = 1.3510e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1310e-01
  Total weights = 1.9563e+06
  Execution time = 1.8158e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300128833628
                                         uncertainty =       0.002009766136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300128833628
                                         uncertainty =       0.002009766136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387364499
  error estimate for blocks of size 2^( 2) =       0.000397329236
  error estimate for blocks of size 2^( 3) =       0.000405638338
  error estimate for blocks of size 2^( 4) =       0.000411636358
  error estimate for blocks of size 2^( 5) =       0.000416028532
  error estimate for blocks of size 2^( 6) =       0.000418572426
  error estimate for blocks of size 2^( 7) =       0.000419085892

      target function =                  N/A
              le_mean =     -17.217032868288
             les_mean =     296.739313289679
             stat err =       0.000416330802
             autocorr =       1.155147529272
              std dev =       0.547816128090
             le_variance =       0.300102510195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300133853399
                                         uncertainty =       0.002009502788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300133853399
                                         uncertainty =       0.002009502788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387367726
  error estimate for blocks of size 2^( 2) =       0.000397331835
  error estimate for blocks of size 2^( 3) =       0.000405640355
  error estimate for blocks of size 2^( 4) =       0.000411637848
  error estimate for blocks of size 2^( 5) =       0.000416030214
  error estimate for blocks of size 2^( 6) =       0.000418574326
  error estimate for blocks of size 2^( 7) =       0.000419088452

      target function =                  N/A
              le_mean =     -17.217033424999
             les_mean =     296.739371029335
             stat err =       0.000416332710
             autocorr =       1.155138871224
              std dev =       0.547820692261
             le_variance =       0.300107510870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300131355789
                                         uncertainty =       0.002009630037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300131355789
                                         uncertainty =       0.002009630037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387366121
  error estimate for blocks of size 2^( 2) =       0.000397330536
  error estimate for blocks of size 2^( 3) =       0.000405639343
  error estimate for blocks of size 2^( 4) =       0.000411637093
  error estimate for blocks of size 2^( 5) =       0.000416029364
  error estimate for blocks of size 2^( 6) =       0.000418573371
  error estimate for blocks of size 2^( 7) =       0.000419087170

      target function =                  N/A
              le_mean =     -17.217033144314
             les_mean =     296.739336243478
             stat err =       0.000416331750
             autocorr =       1.155143117540
              std dev =       0.547818421278
             le_variance =       0.300105022692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300129142568
                                         uncertainty =       0.002009748756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300129142568
                                         uncertainty =       0.002009748756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387364698
  error estimate for blocks of size 2^( 2) =       0.000397329394
  error estimate for blocks of size 2^( 3) =       0.000405638460
  error estimate for blocks of size 2^( 4) =       0.000411636445
  error estimate for blocks of size 2^( 5) =       0.000416028631
  error estimate for blocks of size 2^( 6) =       0.000418572540
  error estimate for blocks of size 2^( 7) =       0.000419086047

      target function =                  N/A
              le_mean =     -17.217032902098
             les_mean =     296.739315538037
             stat err =       0.000416330916
             autocorr =       1.155146977690
              std dev =       0.547816408963
             le_variance =       0.300102817930


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217032868288        initial
     9.7656e+00     9.7656e+01             3.1747e-05       -17.217033424999  <--
     3.9062e+01     3.9062e+02             8.1047e-06       -17.217033144314
     1.5625e+02     1.5625e+03             2.0370e-06       -17.217032902098

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 2.2673e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979537e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380810e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021425e-02 3 1  ON 33
ci_035                -4.764949e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681540e-03 3 1  ON 38
ci_040                -3.773452e-03 3 1  ON 39
ci_041                 9.465423e-03 3 1  ON 40
ci_042                 9.624934e-03 3 1  ON 41
ci_043                -3.042957e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773017e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540380e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486533e-03 3 1  ON 51
ci_053                -6.900635e-03 3 1  ON 52
ci_054                -2.841037e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870287e-03 3 1  ON 56
ci_058                -6.948411e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516329e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213717e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252913e-03 3 1  ON 64
ci_066                 5.684563e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9132e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1665
    reference variance = 0.339682
====================================================
  Execution time = 1.3526e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1342e-01
  Total weights = 1.956633427e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299850782985
                                         uncertainty =       0.001871626913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299850782985
                                         uncertainty =       0.001871626913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387219514
  error estimate for blocks of size 2^( 2) =       0.000397333510
  error estimate for blocks of size 2^( 3) =       0.000405837626
  error estimate for blocks of size 2^( 4) =       0.000412103823
  error estimate for blocks of size 2^( 5) =       0.000416927666
  error estimate for blocks of size 2^( 6) =       0.000418663702
  error estimate for blocks of size 2^( 7) =       0.000421685249

      target function =                  N/A
              le_mean =     -17.216251621810
             les_mean =     296.712737128823
             stat err =       0.000417345110
             autocorr =       1.161652384536
              std dev =       0.547611087844
             le_variance =       0.299877903529


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721625162181e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216251621856       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216254209694       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216254285263       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 1.386201e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216251621856       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216252322569       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216252339727       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 3.771413e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216251621856       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216251800750       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216251804927       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 9.641848e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.291531 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6045e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -4.042009e-02 3 1  ON 0
ci_002                -2.980264e-02 3 1  ON 1
ci_003                -2.578924e-02 3 1  ON 2
ci_004                 2.127451e-02 3 1  ON 3
ci_005                 2.162456e-02 3 1  ON 4
ci_006                -1.925321e-02 3 1  ON 5
ci_007                -1.910556e-02 3 1  ON 6
ci_008                -1.804915e-02 3 1  ON 7
ci_009                -1.793013e-02 3 1  ON 8
ci_010                -1.750334e-02 3 1  ON 9
ci_011                -1.637059e-02 3 1  ON 10
ci_012                -1.635118e-02 3 1  ON 11
ci_013                -1.942950e-02 3 1  ON 12
ci_014                 1.409802e-02 3 1  ON 13
ci_015                 1.378468e-02 3 1  ON 14
ci_016                 1.659317e-02 3 1  ON 15
ci_017                 1.604210e-02 3 1  ON 16
ci_018                 1.274301e-02 3 1  ON 17
ci_019                 1.273852e-02 3 1  ON 18
ci_020                 1.280095e-02 3 1  ON 19
ci_021                 1.290756e-02 3 1  ON 20
ci_022                 1.162172e-02 3 1  ON 21
ci_023                 1.140683e-02 3 1  ON 22
ci_024                 1.191816e-02 3 1  ON 23
ci_025                 1.142007e-02 3 1  ON 24
ci_026                 1.097078e-02 3 1  ON 25
ci_027                 1.110825e-02 3 1  ON 26
ci_028                -1.408494e-02 3 1  ON 27
ci_029                -1.477400e-02 3 1  ON 28
ci_030                -1.135793e-02 3 1  ON 29
ci_031                -1.094893e-02 3 1  ON 30
ci_032                -1.374977e-02 3 1  ON 31
ci_033                 1.036618e-02 3 1  ON 32
ci_034                 1.023078e-02 3 1  ON 33
ci_035                -4.774568e-03 3 1  ON 34
ci_036                -1.028804e-02 3 1  ON 35
ci_037                -1.009672e-02 3 1  ON 36
ci_038                 1.692398e-03 3 1  ON 37
ci_039                 1.686870e-03 3 1  ON 38
ci_040                -3.797611e-03 3 1  ON 39
ci_041                 9.471494e-03 3 1  ON 40
ci_042                 9.624439e-03 3 1  ON 41
ci_043                -3.040899e-03 3 1  ON 42
ci_044                -1.508016e-02 3 1  ON 43
ci_045                -1.614332e-03 3 1  ON 44
ci_046                 5.758857e-03 3 1  ON 45
ci_047                 5.468804e-03 3 1  ON 46
ci_048                -1.180703e-02 3 1  ON 47
ci_049                -1.180761e-02 3 1  ON 48
ci_050                 7.535625e-03 3 1  ON 49
ci_051                 7.251630e-03 3 1  ON 50
ci_052                -6.472964e-03 3 1  ON 51
ci_053                -6.873169e-03 3 1  ON 52
ci_054                -2.849515e-03 3 1  ON 53
ci_055                -2.996466e-03 3 1  ON 54
ci_056                 4.457413e-03 3 1  ON 55
ci_057                 4.847029e-03 3 1  ON 56
ci_058                -6.944749e-03 3 1  ON 57
ci_059                -6.609610e-03 3 1  ON 58
ci_060                 8.517695e-03 3 1  ON 59
ci_061                 8.389863e-03 3 1  ON 60
ci_062                -3.049650e-03 3 1  ON 61
ci_063                -3.200185e-03 3 1  ON 62
ci_064                -3.151225e-03 3 1  ON 63
ci_065                -4.234383e-03 3 1  ON 64
ci_066                 5.671410e-03 3 1  ON 65
ci_067                 5.836151e-03 3 1  ON 66
ci_068                -4.883024e-03 3 1  ON 67
ci_069                -4.605433e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1966
    reference variance = 0.255032
====================================================
  Execution time = 1.3476e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1241e-01
  Total weights = 1.9566e+06
  Execution time = 1.8166e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296495677990
                                         uncertainty =       0.002097979306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296495677990
                                         uncertainty =       0.002097979306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385099340
  error estimate for blocks of size 2^( 2) =       0.000394914119
  error estimate for blocks of size 2^( 3) =       0.000403761757
  error estimate for blocks of size 2^( 4) =       0.000411045621
  error estimate for blocks of size 2^( 5) =       0.000414946854
  error estimate for blocks of size 2^( 6) =       0.000415971968
  error estimate for blocks of size 2^( 7) =       0.000417695250

      target function =                  N/A
              le_mean =     -17.215777608380
             les_mean =     296.695443071028
             stat err =       0.000414914923
             autocorr =       1.160840524604
              std dev =       0.544612710056
             le_variance =       0.296603003955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296399306008
                                         uncertainty =       0.002098025887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296399306008
                                         uncertainty =       0.002098025887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385036634
  error estimate for blocks of size 2^( 2) =       0.000394854048
  error estimate for blocks of size 2^( 3) =       0.000403703258
  error estimate for blocks of size 2^( 4) =       0.000410989087
  error estimate for blocks of size 2^( 5) =       0.000414892110
  error estimate for blocks of size 2^( 6) =       0.000415923274
  error estimate for blocks of size 2^( 7) =       0.000417649345

      target function =                  N/A
              le_mean =     -17.215777055224
             les_mean =     296.695431933938
             stat err =       0.000414863454
             autocorr =       1.160930585428
              std dev =       0.544524030150
             le_variance =       0.296506419411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296442571596
                                         uncertainty =       0.002097940687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296442571596
                                         uncertainty =       0.002097940687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385064786
  error estimate for blocks of size 2^( 2) =       0.000394881006
  error estimate for blocks of size 2^( 3) =       0.000403729475
  error estimate for blocks of size 2^( 4) =       0.000411014395
  error estimate for blocks of size 2^( 5) =       0.000414916547
  error estimate for blocks of size 2^( 6) =       0.000415944946
  error estimate for blocks of size 2^( 7) =       0.000417669696

      target function =                  N/A
              le_mean =     -17.215777203220
             les_mean =     296.695383165714
             stat err =       0.000414886396
             autocorr =       1.160889226806
              std dev =       0.544563842859
             le_variance =       0.296549778949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296488788391
                                         uncertainty =       0.002097971430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296488788391
                                         uncertainty =       0.002097971430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385094858
  error estimate for blocks of size 2^( 2) =       0.000394909821
  error estimate for blocks of size 2^( 3) =       0.000403757563
  error estimate for blocks of size 2^( 4) =       0.000411041562
  error estimate for blocks of size 2^( 5) =       0.000414942909
  error estimate for blocks of size 2^( 6) =       0.000415968442
  error estimate for blocks of size 2^( 7) =       0.000417691910

      target function =                  N/A
              le_mean =     -17.215777543983
             les_mean =     296.695431806464
             stat err =       0.000414911206
             autocorr =       1.160846749244
              std dev =       0.544606370760
             le_variance =       0.296596099072


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215777608380        initial  <--
     2.4414e+00     2.4414e+01             1.3862e-04       -17.215777055224
     9.7656e+00     9.7656e+01             3.7714e-05       -17.215777203220
     3.9062e+01     3.9062e+02             9.6418e-06       -17.215777543983

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6681
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979537e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380810e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021425e-02 3 1  ON 33
ci_035                -4.764949e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681540e-03 3 1  ON 38
ci_040                -3.773452e-03 3 1  ON 39
ci_041                 9.465423e-03 3 1  ON 40
ci_042                 9.624934e-03 3 1  ON 41
ci_043                -3.042957e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773017e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540380e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486533e-03 3 1  ON 51
ci_053                -6.900635e-03 3 1  ON 52
ci_054                -2.841037e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870287e-03 3 1  ON 56
ci_058                -6.948411e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516329e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213717e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252913e-03 3 1  ON 64
ci_066                 5.684563e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8726e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1343
    reference variance = 0.438459
====================================================
  Execution time = 1.3628e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2065e-01
  Total weights = 1.956917000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4889e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302467948171
                                         uncertainty =       0.002767144976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302467948171
                                         uncertainty =       0.002767144976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388915046
  error estimate for blocks of size 2^( 2) =       0.000398905048
  error estimate for blocks of size 2^( 3) =       0.000408487804
  error estimate for blocks of size 2^( 4) =       0.000415346779
  error estimate for blocks of size 2^( 5) =       0.000418260016
  error estimate for blocks of size 2^( 6) =       0.000420480966
  error estimate for blocks of size 2^( 7) =       0.000421684412

      target function =                  N/A
              le_mean =     -17.216502962344
             les_mean =     296.728626616377
             stat err =       0.000418943043
             autocorr =       1.160380645996
              std dev =       0.550008932505
             le_variance =       0.302509825835


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650296234e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216502962374       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216503101235       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216503107399       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216503106857       residual = 1.09e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+01 is 1.645458e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216502962374       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216502997346       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216502998938       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216502998811       residual = 1.16e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+01 is 4.149853e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216502962374       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216502971133       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216502971535       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216502971504       residual = 1.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+02 is 1.039751e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.292810 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6122e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -4.040944e-02 3 1  ON 0
ci_002                -2.979470e-02 3 1  ON 1
ci_003                -2.580015e-02 3 1  ON 2
ci_004                 2.127386e-02 3 1  ON 3
ci_005                 2.162668e-02 3 1  ON 4
ci_006                -1.924261e-02 3 1  ON 5
ci_007                -1.910238e-02 3 1  ON 6
ci_008                -1.805301e-02 3 1  ON 7
ci_009                -1.795421e-02 3 1  ON 8
ci_010                -1.750550e-02 3 1  ON 9
ci_011                -1.638009e-02 3 1  ON 10
ci_012                -1.636591e-02 3 1  ON 11
ci_013                -1.941797e-02 3 1  ON 12
ci_014                 1.409556e-02 3 1  ON 13
ci_015                 1.380989e-02 3 1  ON 14
ci_016                 1.661594e-02 3 1  ON 15
ci_017                 1.602748e-02 3 1  ON 16
ci_018                 1.272558e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281359e-02 3 1  ON 19
ci_021                 1.290806e-02 3 1  ON 20
ci_022                 1.161350e-02 3 1  ON 21
ci_023                 1.139846e-02 3 1  ON 22
ci_024                 1.191954e-02 3 1  ON 23
ci_025                 1.142867e-02 3 1  ON 24
ci_026                 1.096706e-02 3 1  ON 25
ci_027                 1.110710e-02 3 1  ON 26
ci_028                -1.407636e-02 3 1  ON 27
ci_029                -1.477707e-02 3 1  ON 28
ci_030                -1.135724e-02 3 1  ON 29
ci_031                -1.095526e-02 3 1  ON 30
ci_032                -1.375899e-02 3 1  ON 31
ci_033                 1.034758e-02 3 1  ON 32
ci_034                 1.021563e-02 3 1  ON 33
ci_035                -4.764586e-03 3 1  ON 34
ci_036                -1.028712e-02 3 1  ON 35
ci_037                -1.009556e-02 3 1  ON 36
ci_038                 1.695523e-03 3 1  ON 37
ci_039                 1.679712e-03 3 1  ON 38
ci_040                -3.773966e-03 3 1  ON 39
ci_041                 9.465439e-03 3 1  ON 40
ci_042                 9.625601e-03 3 1  ON 41
ci_043                -3.043079e-03 3 1  ON 42
ci_044                -1.509348e-02 3 1  ON 43
ci_045                -1.607930e-03 3 1  ON 44
ci_046                 5.772390e-03 3 1  ON 45
ci_047                 5.461565e-03 3 1  ON 46
ci_048                -1.181147e-02 3 1  ON 47
ci_049                -1.181200e-02 3 1  ON 48
ci_050                 7.542062e-03 3 1  ON 49
ci_051                 7.245187e-03 3 1  ON 50
ci_052                -6.487955e-03 3 1  ON 51
ci_053                -6.896802e-03 3 1  ON 52
ci_054                -2.840344e-03 3 1  ON 53
ci_055                -3.013137e-03 3 1  ON 54
ci_056                 4.469389e-03 3 1  ON 55
ci_057                 4.867836e-03 3 1  ON 56
ci_058                -6.948031e-03 3 1  ON 57
ci_059                -6.645151e-03 3 1  ON 58
ci_060                 8.516406e-03 3 1  ON 59
ci_061                 8.380410e-03 3 1  ON 60
ci_062                -3.044221e-03 3 1  ON 61
ci_063                -3.213464e-03 3 1  ON 62
ci_064                -3.160420e-03 3 1  ON 63
ci_065                -4.253897e-03 3 1  ON 64
ci_066                 5.684468e-03 3 1  ON 65
ci_067                 5.838059e-03 3 1  ON 66
ci_068                -4.899734e-03 3 1  ON 67
ci_069                -4.600537e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2538
    reference variance = 0.202487
====================================================
  Execution time = 1.3403e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2036e-01
  Total weights = 1.9566e+06
  Execution time = 1.8416e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301517025886
                                         uncertainty =       0.002141394589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301517025886
                                         uncertainty =       0.002141394589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388271919
  error estimate for blocks of size 2^( 2) =       0.000398092684
  error estimate for blocks of size 2^( 3) =       0.000407416786
  error estimate for blocks of size 2^( 4) =       0.000414266250
  error estimate for blocks of size 2^( 5) =       0.000419462196
  error estimate for blocks of size 2^( 6) =       0.000422347322
  error estimate for blocks of size 2^( 7) =       0.000423637069

      target function =                  N/A
              le_mean =     -17.216042029681
             les_mean =     296.712462153772
             stat err =       0.000419928209
             autocorr =       1.169709816366
              std dev =       0.549099414251
             le_variance =       0.301510166731

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301510736846
                                         uncertainty =       0.002141220382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301510736846
                                         uncertainty =       0.002141220382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388267847
  error estimate for blocks of size 2^( 2) =       0.000398088999
  error estimate for blocks of size 2^( 3) =       0.000407413527
  error estimate for blocks of size 2^( 4) =       0.000414263212
  error estimate for blocks of size 2^( 5) =       0.000419459280
  error estimate for blocks of size 2^( 6) =       0.000422344788
  error estimate for blocks of size 2^( 7) =       0.000423634634

      target function =                  N/A
              le_mean =     -17.216041925194
             les_mean =     296.712423468361
             stat err =       0.000419925479
             autocorr =       1.169719143591
              std dev =       0.549093654494
             le_variance =       0.301503841406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301513843926
                                         uncertainty =       0.002141306550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301513843926
                                         uncertainty =       0.002141306550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388269859
  error estimate for blocks of size 2^( 2) =       0.000398090818
  error estimate for blocks of size 2^( 3) =       0.000407415136
  error estimate for blocks of size 2^( 4) =       0.000414264711
  error estimate for blocks of size 2^( 5) =       0.000419460719
  error estimate for blocks of size 2^( 6) =       0.000422346037
  error estimate for blocks of size 2^( 7) =       0.000423635833

      target function =                  N/A
              le_mean =     -17.216041975428
             les_mean =     296.712443551599
             stat err =       0.000419926825
             autocorr =       1.169714521382
              std dev =       0.549096500196
             le_variance =       0.301506966528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301516625689
                                         uncertainty =       0.002141383505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301516625689
                                         uncertainty =       0.002141383505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388271660
  error estimate for blocks of size 2^( 2) =       0.000398092449
  error estimate for blocks of size 2^( 3) =       0.000407416578
  error estimate for blocks of size 2^( 4) =       0.000414266056
  error estimate for blocks of size 2^( 5) =       0.000419462010
  error estimate for blocks of size 2^( 6) =       0.000422347160
  error estimate for blocks of size 2^( 7) =       0.000423636913

      target function =                  N/A
              le_mean =     -17.216042022662
             les_mean =     296.712459950279
             stat err =       0.000419928035
             autocorr =       1.169710406686
              std dev =       0.549099047760
             le_variance =       0.301509764251


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216042029681        initial  <--
     2.4414e+01     2.4414e+02             1.6455e-05       -17.216041925194
     9.7656e+01     9.7656e+02             4.1499e-06       -17.216041975428
     3.9062e+02     3.9062e+03             1.0398e-06       -17.216042022662

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6819
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979537e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380810e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021425e-02 3 1  ON 33
ci_035                -4.764949e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681540e-03 3 1  ON 38
ci_040                -3.773452e-03 3 1  ON 39
ci_041                 9.465423e-03 3 1  ON 40
ci_042                 9.624934e-03 3 1  ON 41
ci_043                -3.042957e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773017e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540380e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486533e-03 3 1  ON 51
ci_053                -6.900635e-03 3 1  ON 52
ci_054                -2.841037e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870287e-03 3 1  ON 56
ci_058                -6.948411e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516329e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213717e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252913e-03 3 1  ON 64
ci_066                 5.684563e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8962e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2501
    reference variance = 0.230021
====================================================
  Execution time = 1.3878e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1308e-01
  Total weights = 1.957032984e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4876e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299316384626
                                         uncertainty =       0.001888298938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299316384626
                                         uncertainty =       0.001888298938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386859994
  error estimate for blocks of size 2^( 2) =       0.000397126380
  error estimate for blocks of size 2^( 3) =       0.000406349661
  error estimate for blocks of size 2^( 4) =       0.000412830964
  error estimate for blocks of size 2^( 5) =       0.000417506938
  error estimate for blocks of size 2^( 6) =       0.000419881498
  error estimate for blocks of size 2^( 7) =       0.000422826631

      target function =                  N/A
              le_mean =     -17.216108580991
             les_mean =     296.707469987110
             stat err =       0.000418261508
             autocorr =       1.168929058821
              std dev =       0.547102650743
             le_variance =       0.299321310450


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721610858099e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216108581018       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216108568967       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216108568092       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+02 is 1.173478e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216108581018       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216108578003       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216108577783       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+02 is 2.935950e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216108581018       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216108580264       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216108580209       residual = 7.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+03 is 7.341285e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.293795 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6371e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -4.040850e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579885e-02 3 1  ON 2
ci_004                 2.127518e-02 3 1  ON 3
ci_005                 2.162918e-02 3 1  ON 4
ci_006                -1.924384e-02 3 1  ON 5
ci_007                -1.910348e-02 3 1  ON 6
ci_008                -1.805229e-02 3 1  ON 7
ci_009                -1.795626e-02 3 1  ON 8
ci_010                -1.750475e-02 3 1  ON 9
ci_011                -1.638221e-02 3 1  ON 10
ci_012                -1.636512e-02 3 1  ON 11
ci_013                -1.941935e-02 3 1  ON 12
ci_014                 1.409557e-02 3 1  ON 13
ci_015                 1.380805e-02 3 1  ON 14
ci_016                 1.661585e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272682e-02 3 1  ON 17
ci_019                 1.274479e-02 3 1  ON 18
ci_020                 1.281350e-02 3 1  ON 19
ci_021                 1.291009e-02 3 1  ON 20
ci_022                 1.161646e-02 3 1  ON 21
ci_023                 1.139652e-02 3 1  ON 22
ci_024                 1.192035e-02 3 1  ON 23
ci_025                 1.142627e-02 3 1  ON 24
ci_026                 1.096702e-02 3 1  ON 25
ci_027                 1.110473e-02 3 1  ON 26
ci_028                -1.407465e-02 3 1  ON 27
ci_029                -1.477648e-02 3 1  ON 28
ci_030                -1.135782e-02 3 1  ON 29
ci_031                -1.095406e-02 3 1  ON 30
ci_032                -1.376043e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021440e-02 3 1  ON 33
ci_035                -4.764848e-03 3 1  ON 34
ci_036                -1.028734e-02 3 1  ON 35
ci_037                -1.009361e-02 3 1  ON 36
ci_038                 1.696056e-03 3 1  ON 37
ci_039                 1.681597e-03 3 1  ON 38
ci_040                -3.773478e-03 3 1  ON 39
ci_041                 9.465427e-03 3 1  ON 40
ci_042                 9.625228e-03 3 1  ON 41
ci_043                -3.042702e-03 3 1  ON 42
ci_044                -1.509626e-02 3 1  ON 43
ci_045                -1.607356e-03 3 1  ON 44
ci_046                 5.772912e-03 3 1  ON 45
ci_047                 5.462310e-03 3 1  ON 46
ci_048                -1.181473e-02 3 1  ON 47
ci_049                -1.181188e-02 3 1  ON 48
ci_050                 7.540383e-03 3 1  ON 49
ci_051                 7.245162e-03 3 1  ON 50
ci_052                -6.486636e-03 3 1  ON 51
ci_053                -6.900456e-03 3 1  ON 52
ci_054                -2.841087e-03 3 1  ON 53
ci_055                -3.008972e-03 3 1  ON 54
ci_056                 4.470306e-03 3 1  ON 55
ci_057                 4.870261e-03 3 1  ON 56
ci_058                -6.948393e-03 3 1  ON 57
ci_059                -6.647182e-03 3 1  ON 58
ci_060                 8.516416e-03 3 1  ON 59
ci_061                 8.382891e-03 3 1  ON 60
ci_062                -3.045313e-03 3 1  ON 61
ci_063                -3.213806e-03 3 1  ON 62
ci_064                -3.159262e-03 3 1  ON 63
ci_065                -4.252804e-03 3 1  ON 64
ci_066                 5.684429e-03 3 1  ON 65
ci_067                 5.841065e-03 3 1  ON 66
ci_068                -4.901486e-03 3 1  ON 67
ci_069                -4.600615e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1888
    reference variance = 0.176975
====================================================
  Execution time = 1.3339e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1670e-01
  Total weights = 1.9566e+06
  Execution time = 1.8167e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301821863670
                                         uncertainty =       0.001996177080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301821863670
                                         uncertainty =       0.001996177080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388486603
  error estimate for blocks of size 2^( 2) =       0.000398808533
  error estimate for blocks of size 2^( 3) =       0.000408071839
  error estimate for blocks of size 2^( 4) =       0.000415333811
  error estimate for blocks of size 2^( 5) =       0.000419844876
  error estimate for blocks of size 2^( 6) =       0.000422807573
  error estimate for blocks of size 2^( 7) =       0.000422936050

      target function =                  N/A
              le_mean =     -17.216235860039
             les_mean =     296.715508552251
             stat err =       0.000420230577
             autocorr =       1.170100614952
              std dev =       0.549403022185
             le_variance =       0.301843680786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301821083812
                                         uncertainty =       0.001996155192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301821083812
                                         uncertainty =       0.001996155192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388486102
  error estimate for blocks of size 2^( 2) =       0.000398808050
  error estimate for blocks of size 2^( 3) =       0.000408071383
  error estimate for blocks of size 2^( 4) =       0.000415333376
  error estimate for blocks of size 2^( 5) =       0.000419844442
  error estimate for blocks of size 2^( 6) =       0.000422807159
  error estimate for blocks of size 2^( 7) =       0.000422935622

      target function =                  N/A
              le_mean =     -17.216235856869
             les_mean =     296.715424903740
             stat err =       0.000420230150
             autocorr =       1.170101249157
              std dev =       0.549402314380
             le_variance =       0.301842903046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301821473299
                                         uncertainty =       0.001996166127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301821473299
                                         uncertainty =       0.001996166127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388486352
  error estimate for blocks of size 2^( 2) =       0.000398808291
  error estimate for blocks of size 2^( 3) =       0.000408071611
  error estimate for blocks of size 2^( 4) =       0.000415333593
  error estimate for blocks of size 2^( 5) =       0.000419844659
  error estimate for blocks of size 2^( 6) =       0.000422807366
  error estimate for blocks of size 2^( 7) =       0.000422935836

      target function =                  N/A
              le_mean =     -17.216235858399
             les_mean =     296.715458396370
             stat err =       0.000420230363
             autocorr =       1.170100932429
              std dev =       0.549402667881
             le_variance =       0.301843291475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301821814854
                                         uncertainty =       0.001996175711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301821814854
                                         uncertainty =       0.001996175711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388486571
  error estimate for blocks of size 2^( 2) =       0.000398808502
  error estimate for blocks of size 2^( 3) =       0.000408071811
  error estimate for blocks of size 2^( 4) =       0.000415333784
  error estimate for blocks of size 2^( 5) =       0.000419844849
  error estimate for blocks of size 2^( 6) =       0.000422807547
  error estimate for blocks of size 2^( 7) =       0.000422936023

      target function =                  N/A
              le_mean =     -17.216235859827
             les_mean =     296.715501008885
             stat err =       0.000420230551
             autocorr =       1.170100654653
              std dev =       0.549402977879
             le_variance =       0.301843632102


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216235860039        initial  <--
     2.4414e+02     2.4414e+03             1.1735e-06       -17.216235856869
     9.7656e+02     9.7656e+03             2.9359e-07       -17.216235858399
     3.9062e+03     3.9062e+04             7.3413e-08       -17.216235859827

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5448
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979537e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380810e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021425e-02 3 1  ON 33
ci_035                -4.764949e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681540e-03 3 1  ON 38
ci_040                -3.773452e-03 3 1  ON 39
ci_041                 9.465423e-03 3 1  ON 40
ci_042                 9.624934e-03 3 1  ON 41
ci_043                -3.042957e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773017e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540380e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486533e-03 3 1  ON 51
ci_053                -6.900635e-03 3 1  ON 52
ci_054                -2.841037e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870287e-03 3 1  ON 56
ci_058                -6.948411e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516329e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213717e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252913e-03 3 1  ON 64
ci_066                 5.684563e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9011e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2217
    reference variance = 0.23086
====================================================
  Execution time = 1.3669e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1637e-01
  Total weights = 1.956827382e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4566e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296453131143
                                         uncertainty =       0.001944781909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296453131143
                                         uncertainty =       0.001944781909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384977925
  error estimate for blocks of size 2^( 2) =       0.000395428352
  error estimate for blocks of size 2^( 3) =       0.000404610545
  error estimate for blocks of size 2^( 4) =       0.000411842730
  error estimate for blocks of size 2^( 5) =       0.000415982951
  error estimate for blocks of size 2^( 6) =       0.000418982091
  error estimate for blocks of size 2^( 7) =       0.000417933353

      target function =                  N/A
              le_mean =     -17.216916614084
             les_mean =     296.738590906849
             stat err =       0.000416185281
             autocorr =       1.168696598500
              std dev =       0.544441002200
             le_variance =       0.296416004876


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721691661408e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216916614137       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216916614831       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216916614950       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216916614952       residual = 3.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+03 is 1.228998e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216916614137       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216916614311       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216916614340       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216916614341       residual = 3.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+03 is 3.072951e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216916614137       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216916614181       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216916614188       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216916614188       residual = 3.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+04 is 7.682662e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.295064 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6131e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -4.040870e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579892e-02 3 1  ON 2
ci_004                 2.127527e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805238e-02 3 1  ON 7
ci_009                -1.795629e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638231e-02 3 1  ON 10
ci_012                -1.636527e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409545e-02 3 1  ON 13
ci_015                 1.380812e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602527e-02 3 1  ON 16
ci_018                 1.272679e-02 3 1  ON 17
ci_019                 1.274466e-02 3 1  ON 18
ci_020                 1.281357e-02 3 1  ON 19
ci_021                 1.291000e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139633e-02 3 1  ON 22
ci_024                 1.192025e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110485e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477655e-02 3 1  ON 28
ci_030                -1.135787e-02 3 1  ON 29
ci_031                -1.095402e-02 3 1  ON 30
ci_032                -1.376032e-02 3 1  ON 31
ci_033                 1.034898e-02 3 1  ON 32
ci_034                 1.021425e-02 3 1  ON 33
ci_035                -4.764944e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.695996e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773452e-03 3 1  ON 39
ci_041                 9.465434e-03 3 1  ON 40
ci_042                 9.624945e-03 3 1  ON 41
ci_043                -3.042971e-03 3 1  ON 42
ci_044                -1.509618e-02 3 1  ON 43
ci_045                -1.607432e-03 3 1  ON 44
ci_046                 5.773005e-03 3 1  ON 45
ci_047                 5.462202e-03 3 1  ON 46
ci_048                -1.181464e-02 3 1  ON 47
ci_049                -1.181196e-02 3 1  ON 48
ci_050                 7.540375e-03 3 1  ON 49
ci_051                 7.245314e-03 3 1  ON 50
ci_052                -6.486537e-03 3 1  ON 51
ci_053                -6.900624e-03 3 1  ON 52
ci_054                -2.841037e-03 3 1  ON 53
ci_055                -3.008978e-03 3 1  ON 54
ci_056                 4.470416e-03 3 1  ON 55
ci_057                 4.870308e-03 3 1  ON 56
ci_058                -6.948416e-03 3 1  ON 57
ci_059                -6.647340e-03 3 1  ON 58
ci_060                 8.516320e-03 3 1  ON 59
ci_061                 8.383085e-03 3 1  ON 60
ci_062                -3.045260e-03 3 1  ON 61
ci_063                -3.213702e-03 3 1  ON 62
ci_064                -3.159374e-03 3 1  ON 63
ci_065                -4.252882e-03 3 1  ON 64
ci_066                 5.684547e-03 3 1  ON 65
ci_067                 5.841103e-03 3 1  ON 66
ci_068                -4.901399e-03 3 1  ON 67
ci_069                -4.600514e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1586
    reference variance = 0.266494
====================================================
  Execution time = 1.4125e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1790e-01
  Total weights = 1.9569e+06
  Execution time = 2.2804e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302099607860
                                         uncertainty =       0.002214214593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302099607860
                                         uncertainty =       0.002214214593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388681912
  error estimate for blocks of size 2^( 2) =       0.000398729657
  error estimate for blocks of size 2^( 3) =       0.000407825621
  error estimate for blocks of size 2^( 4) =       0.000414191114
  error estimate for blocks of size 2^( 5) =       0.000418640657
  error estimate for blocks of size 2^( 6) =       0.000420766042
  error estimate for blocks of size 2^( 7) =       0.000422319406

      target function =                  N/A
              le_mean =     -17.216423741568
             les_mean =     296.723143200779
             stat err =       0.000418979305
             autocorr =       1.161974191908
              std dev =       0.549679231770
             le_variance =       0.302147257839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302099553653
                                         uncertainty =       0.002214215008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302099553653
                                         uncertainty =       0.002214215008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388681877
  error estimate for blocks of size 2^( 2) =       0.000398729623
  error estimate for blocks of size 2^( 3) =       0.000407825589
  error estimate for blocks of size 2^( 4) =       0.000414191084
  error estimate for blocks of size 2^( 5) =       0.000418640632
  error estimate for blocks of size 2^( 6) =       0.000420766022
  error estimate for blocks of size 2^( 7) =       0.000422319380

      target function =                  N/A
              le_mean =     -17.216423740040
             les_mean =     296.723143052803
             stat err =       0.000418979280
             autocorr =       1.161974262060
              std dev =       0.549679182258
             le_variance =       0.302147203408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302099580754
                                         uncertainty =       0.002214214800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302099580754
                                         uncertainty =       0.002214214800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388681895
  error estimate for blocks of size 2^( 2) =       0.000398729640
  error estimate for blocks of size 2^( 3) =       0.000407825605
  error estimate for blocks of size 2^( 4) =       0.000414191099
  error estimate for blocks of size 2^( 5) =       0.000418640645
  error estimate for blocks of size 2^( 6) =       0.000420766032
  error estimate for blocks of size 2^( 7) =       0.000422319393

      target function =                  N/A
              le_mean =     -17.216423740804
             les_mean =     296.723143126527
             stat err =       0.000418979292
             autocorr =       1.161974226983
              std dev =       0.549679207012
             le_variance =       0.302147230621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302099604472
                                         uncertainty =       0.002214214619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302099604472
                                         uncertainty =       0.002214214619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388681910
  error estimate for blocks of size 2^( 2) =       0.000398729655
  error estimate for blocks of size 2^( 3) =       0.000407825619
  error estimate for blocks of size 2^( 4) =       0.000414191112
  error estimate for blocks of size 2^( 5) =       0.000418640656
  error estimate for blocks of size 2^( 6) =       0.000420766041
  error estimate for blocks of size 2^( 7) =       0.000422319404

      target function =                  N/A
              le_mean =     -17.216423741473
             les_mean =     296.723143191469
             stat err =       0.000418979303
             autocorr =       1.161974196283
              std dev =       0.549679228675
             le_variance =       0.302147254437


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216423741568        initial  <--
     2.4414e+03     2.4414e+04             1.2290e-07       -17.216423740040
     9.7656e+03     9.7656e+04             3.0730e-08       -17.216423740804
     3.9062e+04     3.9062e+05             7.6827e-09       -17.216423741473

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0399
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979537e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380810e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021425e-02 3 1  ON 33
ci_035                -4.764949e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681540e-03 3 1  ON 38
ci_040                -3.773452e-03 3 1  ON 39
ci_041                 9.465423e-03 3 1  ON 40
ci_042                 9.624934e-03 3 1  ON 41
ci_043                -3.042957e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773017e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540380e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486533e-03 3 1  ON 51
ci_053                -6.900635e-03 3 1  ON 52
ci_054                -2.841037e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870287e-03 3 1  ON 56
ci_058                -6.948411e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516329e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213717e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252913e-03 3 1  ON 64
ci_066                 5.684563e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0214e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2333
    reference variance = 0.244365
====================================================
  Execution time = 1.3715e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1591e-01
  Total weights = 1.956439610e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300076532418
                                         uncertainty =       0.002473624072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300076532418
                                         uncertainty =       0.002473624072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387311015
  error estimate for blocks of size 2^( 2) =       0.000397481347
  error estimate for blocks of size 2^( 3) =       0.000406483357
  error estimate for blocks of size 2^( 4) =       0.000413290880
  error estimate for blocks of size 2^( 5) =       0.000418211003
  error estimate for blocks of size 2^( 6) =       0.000419646675
  error estimate for blocks of size 2^( 7) =       0.000420606224

      target function =                  N/A
              le_mean =     -17.215889912233
             les_mean =     296.702776522264
             stat err =       0.000417938696
             autocorr =       1.164408774076
              std dev =       0.547740490062
             le_variance =       0.300019644454


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721588991223e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215889912282       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215889912229       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215889912224       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215889912226       residual = 3.11e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+04 is 1.531649e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215889912282       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215889912269       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215889912268       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215889912290       residual = 3.11e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+04 is 3.829149e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215889912282       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215889912279       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215889912279       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215889912279       residual = 3.11e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+05 is 9.572888e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.296375 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6207e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579895e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795627e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638230e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380810e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477656e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021425e-02 3 1  ON 33
ci_035                -4.764949e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009356e-02 3 1  ON 36
ci_038                 1.696007e-03 3 1  ON 37
ci_039                 1.681540e-03 3 1  ON 38
ci_040                -3.773452e-03 3 1  ON 39
ci_041                 9.465426e-03 3 1  ON 40
ci_042                 9.624936e-03 3 1  ON 41
ci_043                -3.042959e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607419e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462211e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540380e-03 3 1  ON 49
ci_051                 7.245317e-03 3 1  ON 50
ci_052                -6.486533e-03 3 1  ON 51
ci_053                -6.900638e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470407e-03 3 1  ON 55
ci_057                 4.870287e-03 3 1  ON 56
ci_058                -6.948411e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383071e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159394e-03 3 1  ON 63
ci_065                -4.252912e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841076e-03 3 1  ON 66
ci_068                -4.901376e-03 3 1  ON 67
ci_069                -4.600518e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2028
    reference variance = 0.185253
====================================================
  Execution time = 1.3876e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1568e-01
  Total weights = 1.9562e+06
  Execution time = 1.8133e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299547119956
                                         uncertainty =       0.002025293280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299547119956
                                         uncertainty =       0.002025293280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386979299
  error estimate for blocks of size 2^( 2) =       0.000397030327
  error estimate for blocks of size 2^( 3) =       0.000406421412
  error estimate for blocks of size 2^( 4) =       0.000413140730
  error estimate for blocks of size 2^( 5) =       0.000417632392
  error estimate for blocks of size 2^( 6) =       0.000418352500
  error estimate for blocks of size 2^( 7) =       0.000418188796

      target function =                  N/A
              le_mean =     -17.217404337082
             les_mean =     296.754689729944
             stat err =       0.000416828605
             autocorr =       1.160217897522
              std dev =       0.547271373698
             le_variance =       0.299505956470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299547119910
                                         uncertainty =       0.002025293323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299547119910
                                         uncertainty =       0.002025293323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386979299
  error estimate for blocks of size 2^( 2) =       0.000397030327
  error estimate for blocks of size 2^( 3) =       0.000406421411
  error estimate for blocks of size 2^( 4) =       0.000413140729
  error estimate for blocks of size 2^( 5) =       0.000417632391
  error estimate for blocks of size 2^( 6) =       0.000418352500
  error estimate for blocks of size 2^( 7) =       0.000418188795

      target function =                  N/A
              le_mean =     -17.217404337030
             les_mean =     296.754689746828
             stat err =       0.000416828604
             autocorr =       1.160217894031
              std dev =       0.547271373614
             le_variance =       0.299505956377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299547119933
                                         uncertainty =       0.002025293301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299547119933
                                         uncertainty =       0.002025293301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386979299
  error estimate for blocks of size 2^( 2) =       0.000397030327
  error estimate for blocks of size 2^( 3) =       0.000406421411
  error estimate for blocks of size 2^( 4) =       0.000413140730
  error estimate for blocks of size 2^( 5) =       0.000417632391
  error estimate for blocks of size 2^( 6) =       0.000418352500
  error estimate for blocks of size 2^( 7) =       0.000418188795

      target function =                  N/A
              le_mean =     -17.217404337056
             les_mean =     296.754689738370
             stat err =       0.000416828604
             autocorr =       1.160217895776
              std dev =       0.547271373656
             le_variance =       0.299505956423

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299547119953
                                         uncertainty =       0.002025293282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299547119953
                                         uncertainty =       0.002025293282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386979299
  error estimate for blocks of size 2^( 2) =       0.000397030327
  error estimate for blocks of size 2^( 3) =       0.000406421412
  error estimate for blocks of size 2^( 4) =       0.000413140730
  error estimate for blocks of size 2^( 5) =       0.000417632392
  error estimate for blocks of size 2^( 6) =       0.000418352500
  error estimate for blocks of size 2^( 7) =       0.000418188796

      target function =                  N/A
              le_mean =     -17.217404337079
             les_mean =     296.754689730995
             stat err =       0.000416828604
             autocorr =       1.160217897294
              std dev =       0.547271373693
             le_variance =       0.299505956464


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217404337082        initial  <--
     2.4414e+04     2.4414e+05             1.5316e-08       -17.217404337030
     9.7656e+04     9.7656e+05             3.8291e-09       -17.217404337056
     3.9062e+05     3.9062e+06             9.5729e-10       -17.217404337079

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0521
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979537e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380810e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021425e-02 3 1  ON 33
ci_035                -4.764949e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681540e-03 3 1  ON 38
ci_040                -3.773452e-03 3 1  ON 39
ci_041                 9.465423e-03 3 1  ON 40
ci_042                 9.624934e-03 3 1  ON 41
ci_043                -3.042957e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773017e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540380e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486533e-03 3 1  ON 51
ci_053                -6.900635e-03 3 1  ON 52
ci_054                -2.841037e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870287e-03 3 1  ON 56
ci_058                -6.948411e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516329e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213717e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252913e-03 3 1  ON 64
ci_066                 5.684563e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9268e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2626
    reference variance = 0.917744
====================================================
  Execution time = 1.4006e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1172e-01
  Total weights = 1.956802880e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5122e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298556285186
                                         uncertainty =       0.002083613610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298556285186
                                         uncertainty =       0.002083613610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386365195
  error estimate for blocks of size 2^( 2) =       0.000396627601
  error estimate for blocks of size 2^( 3) =       0.000405819699
  error estimate for blocks of size 2^( 4) =       0.000412666502
  error estimate for blocks of size 2^( 5) =       0.000417608260
  error estimate for blocks of size 2^( 6) =       0.000420806633
  error estimate for blocks of size 2^( 7) =       0.000421929975

      target function =                  N/A
              le_mean =     -17.216376494144
             les_mean =     296.715341519040
             stat err =       0.000418252842
             autocorr =       1.171876400438
              std dev =       0.546402898713
             le_variance =       0.298556127722


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721637649414e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216376494178       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216376494202       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216376494205       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216376494205       residual = 1.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+05 is 1.184452e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216376494178       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216376494184       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216376494185       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216376494185       residual = 1.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+05 is 2.961132e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216376494178       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216376494179       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216376494180       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216376494180       residual = 1.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+06 is 7.402843e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.297630 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6524e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979537e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380810e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021425e-02 3 1  ON 33
ci_035                -4.764949e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681540e-03 3 1  ON 38
ci_040                -3.773452e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042957e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773017e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540380e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486533e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841037e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870287e-03 3 1  ON 56
ci_058                -6.948411e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213717e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252913e-03 3 1  ON 64
ci_066                 5.684563e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2563
    reference variance = 0.226368
====================================================
  Execution time = 1.3348e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1538e-01
  Total weights = 1.9565e+06
  Execution time = 1.8177e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298095654871
                                         uncertainty =       0.001696288753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298095654871
                                         uncertainty =       0.001696288753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386106549
  error estimate for blocks of size 2^( 2) =       0.000395688107
  error estimate for blocks of size 2^( 3) =       0.000404727487
  error estimate for blocks of size 2^( 4) =       0.000411650537
  error estimate for blocks of size 2^( 5) =       0.000416241452
  error estimate for blocks of size 2^( 6) =       0.000418809031
  error estimate for blocks of size 2^( 7) =       0.000419989313

      target function =                  N/A
              le_mean =     -17.216357416426
             les_mean =     296.718338683086
             stat err =       0.000416672583
             autocorr =       1.164596594129
              std dev =       0.546037117418
             le_variance =       0.298156533599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298095654448
                                         uncertainty =       0.001696288762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298095654448
                                         uncertainty =       0.001696288762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386106548
  error estimate for blocks of size 2^( 2) =       0.000395688107
  error estimate for blocks of size 2^( 3) =       0.000404727486
  error estimate for blocks of size 2^( 4) =       0.000411650537
  error estimate for blocks of size 2^( 5) =       0.000416241452
  error estimate for blocks of size 2^( 6) =       0.000418809030
  error estimate for blocks of size 2^( 7) =       0.000419989313

      target function =                  N/A
              le_mean =     -17.216357416441
             les_mean =     296.718338673337
             stat err =       0.000416672583
             autocorr =       1.164596594105
              std dev =       0.546037117032
             le_variance =       0.298156533176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298095654660
                                         uncertainty =       0.001696288757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298095654660
                                         uncertainty =       0.001696288757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386106548
  error estimate for blocks of size 2^( 2) =       0.000395688107
  error estimate for blocks of size 2^( 3) =       0.000404727487
  error estimate for blocks of size 2^( 4) =       0.000411650537
  error estimate for blocks of size 2^( 5) =       0.000416241452
  error estimate for blocks of size 2^( 6) =       0.000418809030
  error estimate for blocks of size 2^( 7) =       0.000419989313

      target function =                  N/A
              le_mean =     -17.216357416433
             les_mean =     296.718338678207
             stat err =       0.000416672583
             autocorr =       1.164596594121
              std dev =       0.546037117225
             le_variance =       0.298156533388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298095654845
                                         uncertainty =       0.001696288753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298095654845
                                         uncertainty =       0.001696288753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386106548
  error estimate for blocks of size 2^( 2) =       0.000395688107
  error estimate for blocks of size 2^( 3) =       0.000404727487
  error estimate for blocks of size 2^( 4) =       0.000411650537
  error estimate for blocks of size 2^( 5) =       0.000416241452
  error estimate for blocks of size 2^( 6) =       0.000418809031
  error estimate for blocks of size 2^( 7) =       0.000419989313

      target function =                  N/A
              le_mean =     -17.216357416427
             les_mean =     296.718338682476
             stat err =       0.000416672583
             autocorr =       1.164596594136
              std dev =       0.546037117394
             le_variance =       0.298156533572


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216357416426        initial
     2.4414e+05     2.4414e+06             1.1845e-09       -17.216357416441  <--
     9.7656e+05     9.7656e+06             2.9611e-10       -17.216357416433
     3.9062e+06     3.9062e+07             7.4028e-11       -17.216357416427

*****************************************************************************
Applying the update for shift_i =   2.4414e+05     and shift_s =   2.4414e+06
*****************************************************************************

  Execution time = 2.2587e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486533e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841077e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9272e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1806
    reference variance = 0.4856
====================================================
  Execution time = 1.3683e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1053e-01
  Total weights = 1.956642722e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5071e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297134593931
                                         uncertainty =       0.001620301447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297134593931
                                         uncertainty =       0.001620301447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385418117
  error estimate for blocks of size 2^( 2) =       0.000395259702
  error estimate for blocks of size 2^( 3) =       0.000403665959
  error estimate for blocks of size 2^( 4) =       0.000410628170
  error estimate for blocks of size 2^( 5) =       0.000414550437
  error estimate for blocks of size 2^( 6) =       0.000417061008
  error estimate for blocks of size 2^( 7) =       0.000418181877

      target function =                  N/A
              le_mean =     -17.216571926894
             les_mean =     296.720881484295
             stat err =       0.000415105373
             autocorr =       1.159985231740
              std dev =       0.545063527819
             le_variance =       0.297094249359


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721657192689e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216571926941       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216571926890       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216571926884       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216571926884       residual = 2.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+04 is 5.970341e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216571926941       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216571926928       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216571926927       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216571926927       residual = 2.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+05 is 1.492588e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216571926941       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216571926938       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216571926938       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216571926944       residual = 2.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+05 is 3.731471e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.298947 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6195e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805238e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380810e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477656e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095402e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021425e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696005e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462211e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540382e-03 3 1  ON 49
ci_051                 7.245319e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900633e-03 3 1  ON 52
ci_054                -2.841037e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470407e-03 3 1  ON 55
ci_057                 4.870285e-03 3 1  ON 56
ci_058                -6.948411e-03 3 1  ON 57
ci_059                -6.647323e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252913e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841077e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1395
    reference variance = 0.182795
====================================================
  Execution time = 1.3410e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1613e-01
  Total weights = 1.9569e+06
  Execution time = 1.8140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300260721023
                                         uncertainty =       0.002329543891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300260721023
                                         uncertainty =       0.002329543891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387486824
  error estimate for blocks of size 2^( 2) =       0.000397617699
  error estimate for blocks of size 2^( 3) =       0.000406590300
  error estimate for blocks of size 2^( 4) =       0.000412557127
  error estimate for blocks of size 2^( 5) =       0.000415858346
  error estimate for blocks of size 2^( 6) =       0.000418379757
  error estimate for blocks of size 2^( 7) =       0.000420582567

      target function =                  N/A
              le_mean =     -17.216288020502
             les_mean =     296.716699728617
             stat err =       0.000416844449
             autocorr =       1.157268589997
              std dev =       0.547989121809
             le_variance =       0.300292077621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300260718547
                                         uncertainty =       0.002329544143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300260718547
                                         uncertainty =       0.002329544143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387486822
  error estimate for blocks of size 2^( 2) =       0.000397617698
  error estimate for blocks of size 2^( 3) =       0.000406590299
  error estimate for blocks of size 2^( 4) =       0.000412557125
  error estimate for blocks of size 2^( 5) =       0.000415858344
  error estimate for blocks of size 2^( 6) =       0.000418379756
  error estimate for blocks of size 2^( 7) =       0.000420582566

      target function =                  N/A
              le_mean =     -17.216288020491
             les_mean =     296.716699732592
             stat err =       0.000416844448
             autocorr =       1.157268593635
              std dev =       0.547989119557
             le_variance =       0.300292075153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300260719785
                                         uncertainty =       0.002329544017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300260719785
                                         uncertainty =       0.002329544017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387486823
  error estimate for blocks of size 2^( 2) =       0.000397617699
  error estimate for blocks of size 2^( 3) =       0.000406590299
  error estimate for blocks of size 2^( 4) =       0.000412557126
  error estimate for blocks of size 2^( 5) =       0.000415858345
  error estimate for blocks of size 2^( 6) =       0.000418379756
  error estimate for blocks of size 2^( 7) =       0.000420582566

      target function =                  N/A
              le_mean =     -17.216288020497
             les_mean =     296.716699730604
             stat err =       0.000416844448
             autocorr =       1.157268591813
              std dev =       0.547989120683
             le_variance =       0.300292076387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300260720868
                                         uncertainty =       0.002329543907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300260720868
                                         uncertainty =       0.002329543907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387486824
  error estimate for blocks of size 2^( 2) =       0.000397617699
  error estimate for blocks of size 2^( 3) =       0.000406590300
  error estimate for blocks of size 2^( 4) =       0.000412557127
  error estimate for blocks of size 2^( 5) =       0.000415858345
  error estimate for blocks of size 2^( 6) =       0.000418379757
  error estimate for blocks of size 2^( 7) =       0.000420582567

      target function =                  N/A
              le_mean =     -17.216288020502
             les_mean =     296.716699728865
             stat err =       0.000416844449
             autocorr =       1.157268590222
              std dev =       0.547989121668
             le_variance =       0.300292077467


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216288020502        initial  <--
     6.1035e+04     6.1035e+05             5.9703e-09       -17.216288020491
     2.4414e+05     2.4414e+06             1.4926e-09       -17.216288020497
     9.7656e+05     9.7656e+06             3.7315e-10       -17.216288020502

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5961
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486533e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841077e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8960e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1423
    reference variance = 0.139847
====================================================
  Execution time = 1.3846e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1228e-01
  Total weights = 1.956952375e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5016e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296770224350
                                         uncertainty =       0.002668665480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296770224350
                                         uncertainty =       0.002668665480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385189507
  error estimate for blocks of size 2^( 2) =       0.000394884030
  error estimate for blocks of size 2^( 3) =       0.000404417046
  error estimate for blocks of size 2^( 4) =       0.000411364970
  error estimate for blocks of size 2^( 5) =       0.000415645932
  error estimate for blocks of size 2^( 6) =       0.000418614504
  error estimate for blocks of size 2^( 7) =       0.000420887186

      target function =                  N/A
              le_mean =     -17.216293841165
             les_mean =     296.713054617599
             stat err =       0.000416628148
             autocorr =       1.169898871296
              std dev =       0.544740224203
             le_variance =       0.296741911864


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721629384117e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216293841206       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216293841230       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216293841231       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216293841231       residual = 1.34e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+05 is 6.701152e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216293841206       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216293841212       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216293841212       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216293841212       residual = 1.34e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+06 is 1.675290e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216293841206       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216293841207       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216293841207       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216293843763       residual = 1.34e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+06 is 4.188223e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.300345 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6353e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021425e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245319e-03 3 1  ON 50
ci_052                -6.486533e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1414
    reference variance = 0.335101
====================================================
  Execution time = 1.3426e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1461e-01
  Total weights = 1.9566e+06
  Execution time = 1.8122e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300218151008
                                         uncertainty =       0.002021351614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300218151008
                                         uncertainty =       0.002021351614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387430502
  error estimate for blocks of size 2^( 2) =       0.000397249655
  error estimate for blocks of size 2^( 3) =       0.000406112325
  error estimate for blocks of size 2^( 4) =       0.000412908855
  error estimate for blocks of size 2^( 5) =       0.000417810450
  error estimate for blocks of size 2^( 6) =       0.000418582572
  error estimate for blocks of size 2^( 7) =       0.000421186051

      target function =                  N/A
              le_mean =     -17.217539295444
             les_mean =     296.758269849283
             stat err =       0.000417621982
             autocorr =       1.161927634131
              std dev =       0.547909471017
             le_variance =       0.300204788430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300218151125
                                         uncertainty =       0.002021351621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300218151125
                                         uncertainty =       0.002021351621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387430503
  error estimate for blocks of size 2^( 2) =       0.000397249655
  error estimate for blocks of size 2^( 3) =       0.000406112325
  error estimate for blocks of size 2^( 4) =       0.000412908855
  error estimate for blocks of size 2^( 5) =       0.000417810450
  error estimate for blocks of size 2^( 6) =       0.000418582572
  error estimate for blocks of size 2^( 7) =       0.000421186051

      target function =                  N/A
              le_mean =     -17.217539295435
             les_mean =     296.758269846880
             stat err =       0.000417621982
             autocorr =       1.161927634015
              std dev =       0.547909471122
             le_variance =       0.300204788545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300218151067
                                         uncertainty =       0.002021351617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300218151067
                                         uncertainty =       0.002021351617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387430502
  error estimate for blocks of size 2^( 2) =       0.000397249655
  error estimate for blocks of size 2^( 3) =       0.000406112325
  error estimate for blocks of size 2^( 4) =       0.000412908855
  error estimate for blocks of size 2^( 5) =       0.000417810450
  error estimate for blocks of size 2^( 6) =       0.000418582572
  error estimate for blocks of size 2^( 7) =       0.000421186051

      target function =                  N/A
              le_mean =     -17.217539295439
             les_mean =     296.758269848081
             stat err =       0.000417621982
             autocorr =       1.161927634079
              std dev =       0.547909471069
             le_variance =       0.300204788488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300218151015
                                         uncertainty =       0.002021351614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300218151015
                                         uncertainty =       0.002021351614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387430502
  error estimate for blocks of size 2^( 2) =       0.000397249655
  error estimate for blocks of size 2^( 3) =       0.000406112325
  error estimate for blocks of size 2^( 4) =       0.000412908855
  error estimate for blocks of size 2^( 5) =       0.000417810450
  error estimate for blocks of size 2^( 6) =       0.000418582572
  error estimate for blocks of size 2^( 7) =       0.000421186051

      target function =                  N/A
              le_mean =     -17.217539295444
             les_mean =     296.758269849133
             stat err =       0.000417621982
             autocorr =       1.161927634127
              std dev =       0.547909471023
             le_variance =       0.300204788437


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217539295444        initial  <--
     6.1035e+05     6.1035e+06             6.7012e-10       -17.217539295435
     2.4414e+06     2.4414e+07             1.6753e-10       -17.217539295439
     9.7656e+06     9.7656e+07             4.1882e-11       -17.217539295444

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5926
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486533e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841077e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8983e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1402
    reference variance = 0.222836
====================================================
  Execution time = 1.3622e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2797e-01
  Total weights = 1.956520301e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306999715847
                                         uncertainty =       0.003326647574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306999715847
                                         uncertainty =       0.003326647574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391790922
  error estimate for blocks of size 2^( 2) =       0.000401609402
  error estimate for blocks of size 2^( 3) =       0.000410292567
  error estimate for blocks of size 2^( 4) =       0.000416680784
  error estimate for blocks of size 2^( 5) =       0.000420140949
  error estimate for blocks of size 2^( 6) =       0.000422530572
  error estimate for blocks of size 2^( 7) =       0.000424764448

      target function =                  N/A
              le_mean =     -17.215702039915
             les_mean =     296.708362928335
             stat err =       0.000421029188
             autocorr =       1.154823656963
              std dev =       0.554076035382
             le_variance =       0.307000252984


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721570203992e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215702039942       residual = 9.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215702039942       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215702039942       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215702039942       residual = 2.49e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+06 is 4.244350e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215702039942       residual = 9.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215702039942       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215702039942       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215702039942       residual = 2.49e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+07 is 1.061088e-11

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215702039942       residual = 9.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215702039942       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215702039942       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215702032026       residual = 2.49e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+07 is 2.652708e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.301571 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6108e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486533e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841077e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1796
    reference variance = 0.234721
====================================================
  Execution time = 1.3391e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1581e-01
  Total weights = 1.9564e+06
  Execution time = 1.8155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302838253938
                                         uncertainty =       0.002241630284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302838253938
                                         uncertainty =       0.002241630284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389206752
  error estimate for blocks of size 2^( 2) =       0.000399118669
  error estimate for blocks of size 2^( 3) =       0.000408074357
  error estimate for blocks of size 2^( 4) =       0.000414731115
  error estimate for blocks of size 2^( 5) =       0.000418963589
  error estimate for blocks of size 2^( 6) =       0.000421175110
  error estimate for blocks of size 2^( 7) =       0.000422535578

      target function =                  N/A
              le_mean =     -17.216368854675
             les_mean =     296.719171081943
             stat err =       0.000419351348
             autocorr =       1.160901454252
              std dev =       0.550421467424
             le_variance =       0.302963791801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302838253932
                                         uncertainty =       0.002241630285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302838253932
                                         uncertainty =       0.002241630285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389206752
  error estimate for blocks of size 2^( 2) =       0.000399118669
  error estimate for blocks of size 2^( 3) =       0.000408074356
  error estimate for blocks of size 2^( 4) =       0.000414731115
  error estimate for blocks of size 2^( 5) =       0.000418963589
  error estimate for blocks of size 2^( 6) =       0.000421175110
  error estimate for blocks of size 2^( 7) =       0.000422535578

      target function =                  N/A
              le_mean =     -17.216368854675
             les_mean =     296.719171081939
             stat err =       0.000419351348
             autocorr =       1.160901454265
              std dev =       0.550421467417
             le_variance =       0.302963791794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302838253935
                                         uncertainty =       0.002241630284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302838253935
                                         uncertainty =       0.002241630284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389206752
  error estimate for blocks of size 2^( 2) =       0.000399118669
  error estimate for blocks of size 2^( 3) =       0.000408074356
  error estimate for blocks of size 2^( 4) =       0.000414731115
  error estimate for blocks of size 2^( 5) =       0.000418963589
  error estimate for blocks of size 2^( 6) =       0.000421175110
  error estimate for blocks of size 2^( 7) =       0.000422535578

      target function =                  N/A
              le_mean =     -17.216368854675
             les_mean =     296.719171081941
             stat err =       0.000419351348
             autocorr =       1.160901454273
              std dev =       0.550421467421
             le_variance =       0.302963791798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302838253938
                                         uncertainty =       0.002241630284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302838253938
                                         uncertainty =       0.002241630284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389206752
  error estimate for blocks of size 2^( 2) =       0.000399118669
  error estimate for blocks of size 2^( 3) =       0.000408074356
  error estimate for blocks of size 2^( 4) =       0.000414731115
  error estimate for blocks of size 2^( 5) =       0.000418963589
  error estimate for blocks of size 2^( 6) =       0.000421175110
  error estimate for blocks of size 2^( 7) =       0.000422535578

      target function =                  N/A
              le_mean =     -17.216368854675
             les_mean =     296.719171081943
             stat err =       0.000419351348
             autocorr =       1.160901454254
              std dev =       0.550421467424
             le_variance =       0.302963791801


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216368854675        initial  <--
     6.1035e+06     6.1035e+07             4.2444e-11       -17.216368854675
     2.4414e+07     2.4414e+08             1.0611e-11       -17.216368854675
     9.7656e+07     9.7656e+08             2.6527e-12       -17.216368854675

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5603
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486533e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841077e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8792e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2755
    reference variance = 0.161243
====================================================
  Execution time = 1.3776e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1799e-01
  Total weights = 1.956793786e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4951e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302311402113
                                         uncertainty =       0.002614793939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302311402113
                                         uncertainty =       0.002614793939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388732108
  error estimate for blocks of size 2^( 2) =       0.000398200838
  error estimate for blocks of size 2^( 3) =       0.000407574831
  error estimate for blocks of size 2^( 4) =       0.000414309674
  error estimate for blocks of size 2^( 5) =       0.000418437559
  error estimate for blocks of size 2^( 6) =       0.000421555279
  error estimate for blocks of size 2^( 7) =       0.000422138569

      target function =                  N/A
              le_mean =     -17.217111086745
             les_mean =     296.746901421703
             stat err =       0.000419110270
             autocorr =       1.162400477044
              std dev =       0.549750219103
             le_variance =       0.302225303404


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721711108674e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217111086774       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217111086774       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217111086774       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+07 is 4.983985e-12

solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217111086774       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217111086774       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217111086774       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+08 is 1.245996e-12

solving harmonic davidson linear method for identity shift 9.7656e+08, overlap shift 9.7656e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217111086774       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217111086774       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217111086774       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+08 is 3.114991e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.302583 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6276e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841077e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2265
    reference variance = 0.496419
====================================================
  Execution time = 1.3315e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1057e-01
  Total weights = 1.9566e+06
  Execution time = 1.8155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297841832505
                                         uncertainty =       0.001512235962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297841832505
                                         uncertainty =       0.001512235962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385939071
  error estimate for blocks of size 2^( 2) =       0.000395879708
  error estimate for blocks of size 2^( 3) =       0.000405398830
  error estimate for blocks of size 2^( 4) =       0.000412601416
  error estimate for blocks of size 2^( 5) =       0.000416807968
  error estimate for blocks of size 2^( 6) =       0.000418983011
  error estimate for blocks of size 2^( 7) =       0.000422052569

      target function =                  N/A
              le_mean =     -17.216548318778
             les_mean =     296.720106480144
             stat err =       0.000417611241
             autocorr =       1.170865110218
              std dev =       0.545800268864
             le_variance =       0.297897933492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297841832504
                                         uncertainty =       0.001512235962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297841832504
                                         uncertainty =       0.001512235962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385939071
  error estimate for blocks of size 2^( 2) =       0.000395879708
  error estimate for blocks of size 2^( 3) =       0.000405398830
  error estimate for blocks of size 2^( 4) =       0.000412601416
  error estimate for blocks of size 2^( 5) =       0.000416807968
  error estimate for blocks of size 2^( 6) =       0.000418983011
  error estimate for blocks of size 2^( 7) =       0.000422052569

      target function =                  N/A
              le_mean =     -17.216548318778
             les_mean =     296.720106480657
             stat err =       0.000417611241
             autocorr =       1.170865110212
              std dev =       0.545800268863
             le_variance =       0.297897933491

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297841832504
                                         uncertainty =       0.001512235962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297841832504
                                         uncertainty =       0.001512235962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385939071
  error estimate for blocks of size 2^( 2) =       0.000395879708
  error estimate for blocks of size 2^( 3) =       0.000405398830
  error estimate for blocks of size 2^( 4) =       0.000412601416
  error estimate for blocks of size 2^( 5) =       0.000416807968
  error estimate for blocks of size 2^( 6) =       0.000418983011
  error estimate for blocks of size 2^( 7) =       0.000422052569

      target function =                  N/A
              le_mean =     -17.216548318778
             les_mean =     296.720106480401
             stat err =       0.000417611241
             autocorr =       1.170865110220
              std dev =       0.545800268864
             le_variance =       0.297897933492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297841832505
                                         uncertainty =       0.001512235962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297841832505
                                         uncertainty =       0.001512235962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385939071
  error estimate for blocks of size 2^( 2) =       0.000395879708
  error estimate for blocks of size 2^( 3) =       0.000405398830
  error estimate for blocks of size 2^( 4) =       0.000412601416
  error estimate for blocks of size 2^( 5) =       0.000416807968
  error estimate for blocks of size 2^( 6) =       0.000418983011
  error estimate for blocks of size 2^( 7) =       0.000422052569

      target function =                  N/A
              le_mean =     -17.216548318778
             les_mean =     296.720106480176
             stat err =       0.000417611241
             autocorr =       1.170865110217
              std dev =       0.545800268864
             le_variance =       0.297897933492


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216548318778        initial
     6.1035e+07     6.1035e+08             4.9840e-12       -17.216548318778  <--
     2.4414e+08     2.4414e+09             1.2460e-12       -17.216548318778
     9.7656e+08     9.7656e+09             3.1150e-13       -17.216548318778

*****************************************************************************
Applying the update for shift_i =   6.1035e+07     and shift_s =   6.1035e+08
*****************************************************************************

  Execution time = 2.2509e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8794e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1968
    reference variance = 0.265833
====================================================
  Execution time = 1.3705e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1198e-01
  Total weights = 1.956538168e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4519e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298515382836
                                         uncertainty =       0.002066686828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298515382836
                                         uncertainty =       0.002066686828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386341819
  error estimate for blocks of size 2^( 2) =       0.000396395600
  error estimate for blocks of size 2^( 3) =       0.000405826513
  error estimate for blocks of size 2^( 4) =       0.000412935763
  error estimate for blocks of size 2^( 5) =       0.000418202811
  error estimate for blocks of size 2^( 6) =       0.000421696801
  error estimate for blocks of size 2^( 7) =       0.000422803848

      target function =                  N/A
              le_mean =     -17.215833611628
             les_mean =     296.696909334227
             stat err =       0.000418909806
             autocorr =       1.175702961479
              std dev =       0.546369839988
             le_variance =       0.298520002048


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721583361163e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215833611640       residual = 9.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215833611640       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215833611640       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+07 is 1.763878e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215833611640       residual = 9.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215833611640       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215833611640       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+07 is 4.409696e-12

solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215833611640       residual = 9.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215833611640       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215833611640       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+08 is 1.102424e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.303556 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6162e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841077e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1971
    reference variance = 0.261415
====================================================
  Execution time = 1.3417e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1177e-01
  Total weights = 1.9567e+06
  Execution time = 1.8133e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297630168752
                                         uncertainty =       0.001652207715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297630168752
                                         uncertainty =       0.001652207715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385788166
  error estimate for blocks of size 2^( 2) =       0.000395638219
  error estimate for blocks of size 2^( 3) =       0.000404420116
  error estimate for blocks of size 2^( 4) =       0.000411111362
  error estimate for blocks of size 2^( 5) =       0.000414278946
  error estimate for blocks of size 2^( 6) =       0.000416589209
  error estimate for blocks of size 2^( 7) =       0.000418082863

      target function =                  N/A
              le_mean =     -17.217165995390
             les_mean =     296.742570120437
             stat err =       0.000415015595
             autocorr =       1.157260231053
              std dev =       0.545586857224
             le_variance =       0.297665018776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297630168747
                                         uncertainty =       0.001652207715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297630168747
                                         uncertainty =       0.001652207715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385788166
  error estimate for blocks of size 2^( 2) =       0.000395638219
  error estimate for blocks of size 2^( 3) =       0.000404420116
  error estimate for blocks of size 2^( 4) =       0.000411111362
  error estimate for blocks of size 2^( 5) =       0.000414278946
  error estimate for blocks of size 2^( 6) =       0.000416589209
  error estimate for blocks of size 2^( 7) =       0.000418082863

      target function =                  N/A
              le_mean =     -17.217165995389
             les_mean =     296.742570120347
             stat err =       0.000415015595
             autocorr =       1.157260231065
              std dev =       0.545586857220
             le_variance =       0.297665018771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297630168749
                                         uncertainty =       0.001652207715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297630168749
                                         uncertainty =       0.001652207715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385788166
  error estimate for blocks of size 2^( 2) =       0.000395638219
  error estimate for blocks of size 2^( 3) =       0.000404420116
  error estimate for blocks of size 2^( 4) =       0.000411111362
  error estimate for blocks of size 2^( 5) =       0.000414278946
  error estimate for blocks of size 2^( 6) =       0.000416589209
  error estimate for blocks of size 2^( 7) =       0.000418082863

      target function =                  N/A
              le_mean =     -17.217165995389
             les_mean =     296.742570120392
             stat err =       0.000415015595
             autocorr =       1.157260231066
              std dev =       0.545586857222
             le_variance =       0.297665018773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297630168752
                                         uncertainty =       0.001652207715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297630168752
                                         uncertainty =       0.001652207715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385788166
  error estimate for blocks of size 2^( 2) =       0.000395638219
  error estimate for blocks of size 2^( 3) =       0.000404420116
  error estimate for blocks of size 2^( 4) =       0.000411111362
  error estimate for blocks of size 2^( 5) =       0.000414278946
  error estimate for blocks of size 2^( 6) =       0.000416589209
  error estimate for blocks of size 2^( 7) =       0.000418082863

      target function =                  N/A
              le_mean =     -17.217165995390
             les_mean =     296.742570120432
             stat err =       0.000415015595
             autocorr =       1.157260231047
              std dev =       0.545586857224
             le_variance =       0.297665018776


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217165995390        initial  <--
     1.5259e+07     1.5259e+08             1.7639e-11       -17.217165995389
     6.1035e+07     6.1035e+08             4.4097e-12       -17.217165995389
     2.4414e+08     2.4414e+09             1.1024e-12       -17.217165995390

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6081
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8781e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2143
    reference variance = 0.371817
====================================================
  Execution time = 1.3712e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1909e-01
  Total weights = 1.956535852e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.8147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302391303402
                                         uncertainty =       0.002131187627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302391303402
                                         uncertainty =       0.002131187627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388821314
  error estimate for blocks of size 2^( 2) =       0.000398543747
  error estimate for blocks of size 2^( 3) =       0.000407935959
  error estimate for blocks of size 2^( 4) =       0.000414690945
  error estimate for blocks of size 2^( 5) =       0.000419642478
  error estimate for blocks of size 2^( 6) =       0.000421533656
  error estimate for blocks of size 2^( 7) =       0.000422472795

      target function =                  N/A
              le_mean =     -17.216669432096
             les_mean =     296.732792838453
             stat err =       0.000419584969
             autocorr =       1.164500594957
              std dev =       0.549876376226
             le_variance =       0.302364029132


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721666943210e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216669432121       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216669432121       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216669432121       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+08 is 1.950211e-12

solving harmonic davidson linear method for identity shift 6.1035e+08, overlap shift 6.1035e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216669432121       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216669432121       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216669432121       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+08 is 4.875526e-13

solving harmonic davidson linear method for identity shift 2.4414e+09, overlap shift 2.4414e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216669432121       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216669432121       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216669432121       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+09 is 1.218882e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.316610 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9914e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2771
    reference variance = 0.448191
====================================================
  Execution time = 1.3609e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1874e-01
  Total weights = 1.9566e+06
  Execution time = 1.8167e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301866398115
                                         uncertainty =       0.002230798007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301866398115
                                         uncertainty =       0.002230798007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388532763
  error estimate for blocks of size 2^( 2) =       0.000398635682
  error estimate for blocks of size 2^( 3) =       0.000407604134
  error estimate for blocks of size 2^( 4) =       0.000414517546
  error estimate for blocks of size 2^( 5) =       0.000417704505
  error estimate for blocks of size 2^( 6) =       0.000419711190
  error estimate for blocks of size 2^( 7) =       0.000421186222

      target function =                  N/A
              le_mean =     -17.215699858776
             les_mean =     296.699057992634
             stat err =       0.000418279866
             autocorr =       1.158987168516
              std dev =       0.549468302236
             le_variance =       0.301915415162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301866398115
                                         uncertainty =       0.002230798007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301866398115
                                         uncertainty =       0.002230798007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388532763
  error estimate for blocks of size 2^( 2) =       0.000398635682
  error estimate for blocks of size 2^( 3) =       0.000407604134
  error estimate for blocks of size 2^( 4) =       0.000414517546
  error estimate for blocks of size 2^( 5) =       0.000417704505
  error estimate for blocks of size 2^( 6) =       0.000419711190
  error estimate for blocks of size 2^( 7) =       0.000421186222

      target function =                  N/A
              le_mean =     -17.215699858776
             les_mean =     296.699057992633
             stat err =       0.000418279866
             autocorr =       1.158987168509
              std dev =       0.549468302236
             le_variance =       0.301915415163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301866398115
                                         uncertainty =       0.002230798007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301866398115
                                         uncertainty =       0.002230798007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388532763
  error estimate for blocks of size 2^( 2) =       0.000398635682
  error estimate for blocks of size 2^( 3) =       0.000407604134
  error estimate for blocks of size 2^( 4) =       0.000414517546
  error estimate for blocks of size 2^( 5) =       0.000417704505
  error estimate for blocks of size 2^( 6) =       0.000419711190
  error estimate for blocks of size 2^( 7) =       0.000421186222

      target function =                  N/A
              le_mean =     -17.215699858776
             les_mean =     296.699057992633
             stat err =       0.000418279866
             autocorr =       1.158987168511
              std dev =       0.549468302236
             le_variance =       0.301915415163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301866398115
                                         uncertainty =       0.002230798007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301866398115
                                         uncertainty =       0.002230798007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388532763
  error estimate for blocks of size 2^( 2) =       0.000398635682
  error estimate for blocks of size 2^( 3) =       0.000407604134
  error estimate for blocks of size 2^( 4) =       0.000414517546
  error estimate for blocks of size 2^( 5) =       0.000417704505
  error estimate for blocks of size 2^( 6) =       0.000419711190
  error estimate for blocks of size 2^( 7) =       0.000421186222

      target function =                  N/A
              le_mean =     -17.215699858776
             les_mean =     296.699057992634
             stat err =       0.000418279866
             autocorr =       1.158987168516
              std dev =       0.549468302236
             le_variance =       0.301915415162


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215699858776        initial  <--
     1.5259e+08     1.5259e+09             1.9502e-12       -17.215699858776
     6.1035e+08     6.1035e+09             4.8755e-13       -17.215699858776
     2.4414e+09     2.4414e+10             1.2189e-13       -17.215699858776

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7925
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2793e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2263
    reference variance = 0.547621
====================================================
  Execution time = 1.3624e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1721e-01
  Total weights = 1.956825201e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299459416108
                                         uncertainty =       0.001604959958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299459416108
                                         uncertainty =       0.001604959958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386951851
  error estimate for blocks of size 2^( 2) =       0.000397084849
  error estimate for blocks of size 2^( 3) =       0.000406162696
  error estimate for blocks of size 2^( 4) =       0.000413330446
  error estimate for blocks of size 2^( 5) =       0.000417956057
  error estimate for blocks of size 2^( 6) =       0.000420365431
  error estimate for blocks of size 2^( 7) =       0.000420629671

      target function =                  N/A
              le_mean =     -17.216579061443
             les_mean =     296.727802495951
             stat err =       0.000418070401
             autocorr =       1.167306718917
              std dev =       0.547232555749
             le_variance =       0.299463470071


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721657906144e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+09, overlap shift 1.5259e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216579061487       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216579061487       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216579061487       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+09 is 2.631774e-13

solving harmonic davidson linear method for identity shift 6.1035e+09, overlap shift 6.1035e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216579061487       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216579061487       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216579061487       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+09 is 6.579413e-14

solving harmonic davidson linear method for identity shift 2.4414e+10, overlap shift 2.4414e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216579061487       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216579061487       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216579061487       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+10 is 1.644853e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.317654 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6109e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2734
    reference variance = 0.33561
====================================================
  Execution time = 1.4231e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1519e-01
  Total weights = 1.9570e+06
  Execution time = 1.8138e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298429099743
                                         uncertainty =       0.001982363464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298429099743
                                         uncertainty =       0.001982363464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386255150
  error estimate for blocks of size 2^( 2) =       0.000396398752
  error estimate for blocks of size 2^( 3) =       0.000405688060
  error estimate for blocks of size 2^( 4) =       0.000412294297
  error estimate for blocks of size 2^( 5) =       0.000417082108
  error estimate for blocks of size 2^( 6) =       0.000420635167
  error estimate for blocks of size 2^( 7) =       0.000421350763

      target function =                  N/A
              le_mean =     -17.215954268561
             les_mean =     296.704272919060
             stat err =       0.000417840584
             autocorr =       1.170233896837
              std dev =       0.546247271522
             le_variance =       0.298386081646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298429099743
                                         uncertainty =       0.001982363464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298429099743
                                         uncertainty =       0.001982363464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386255150
  error estimate for blocks of size 2^( 2) =       0.000396398752
  error estimate for blocks of size 2^( 3) =       0.000405688060
  error estimate for blocks of size 2^( 4) =       0.000412294297
  error estimate for blocks of size 2^( 5) =       0.000417082108
  error estimate for blocks of size 2^( 6) =       0.000420635167
  error estimate for blocks of size 2^( 7) =       0.000421350763

      target function =                  N/A
              le_mean =     -17.215954268561
             les_mean =     296.704272919061
             stat err =       0.000417840584
             autocorr =       1.170233896838
              std dev =       0.546247271522
             le_variance =       0.298386081646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298429099743
                                         uncertainty =       0.001982363464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298429099743
                                         uncertainty =       0.001982363464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386255150
  error estimate for blocks of size 2^( 2) =       0.000396398752
  error estimate for blocks of size 2^( 3) =       0.000405688060
  error estimate for blocks of size 2^( 4) =       0.000412294297
  error estimate for blocks of size 2^( 5) =       0.000417082108
  error estimate for blocks of size 2^( 6) =       0.000420635167
  error estimate for blocks of size 2^( 7) =       0.000421350763

      target function =                  N/A
              le_mean =     -17.215954268561
             les_mean =     296.704272919061
             stat err =       0.000417840584
             autocorr =       1.170233896838
              std dev =       0.546247271522
             le_variance =       0.298386081646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298429099743
                                         uncertainty =       0.001982363464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298429099743
                                         uncertainty =       0.001982363464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386255150
  error estimate for blocks of size 2^( 2) =       0.000396398752
  error estimate for blocks of size 2^( 3) =       0.000405688060
  error estimate for blocks of size 2^( 4) =       0.000412294297
  error estimate for blocks of size 2^( 5) =       0.000417082108
  error estimate for blocks of size 2^( 6) =       0.000420635167
  error estimate for blocks of size 2^( 7) =       0.000421350763

      target function =                  N/A
              le_mean =     -17.215954268561
             les_mean =     296.704272919060
             stat err =       0.000417840584
             autocorr =       1.170233896840
              std dev =       0.546247271522
             le_variance =       0.298386081645


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215954268561        initial
     1.5259e+09     1.5259e+10             2.6318e-13       -17.215954268561
     6.1035e+09     6.1035e+10             6.5794e-14       -17.215954268561
     2.4414e+10     2.4414e+11             1.6449e-14       -17.215954268561  <--

*****************************************************************************
Applying the update for shift_i =   2.4414e+10     and shift_s =   2.4414e+11
*****************************************************************************

  Execution time = 2.3436e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9574e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.219
    reference variance = 0.142952
====================================================
  Execution time = 1.3768e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1766e-01
  Total weights = 1.956207225e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4643e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303166282617
                                         uncertainty =       0.002111565300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303166282617
                                         uncertainty =       0.002111565300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389415574
  error estimate for blocks of size 2^( 2) =       0.000399022943
  error estimate for blocks of size 2^( 3) =       0.000408061074
  error estimate for blocks of size 2^( 4) =       0.000415128167
  error estimate for blocks of size 2^( 5) =       0.000420206594
  error estimate for blocks of size 2^( 6) =       0.000422703094
  error estimate for blocks of size 2^( 7) =       0.000424601573

      target function =                  N/A
              le_mean =     -17.216738788586
             les_mean =     296.733755059461
             stat err =       0.000420659857
             autocorr =       1.166905018517
              std dev =       0.550716785938
             le_variance =       0.303288978314


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721673878859e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+09, overlap shift 6.1035e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216738788648       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216738788648       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216738788648       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+09 is 5.233879e-14

solving harmonic davidson linear method for identity shift 2.4414e+10, overlap shift 2.4414e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216738788648       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216738788648       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216738788648       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+10 is 1.308470e-14

solving harmonic davidson linear method for identity shift 9.7656e+10, overlap shift 9.7656e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216738788648       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216738788648       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216738788648       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+10 is 3.271174e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.318619 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6238e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2042
    reference variance = 0.210687
====================================================
  Execution time = 1.3353e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1238e-01
  Total weights = 1.9566e+06
  Execution time = 1.8148e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298525577304
                                         uncertainty =       0.001762984895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298525577304
                                         uncertainty =       0.001762984895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386396808
  error estimate for blocks of size 2^( 2) =       0.000396714566
  error estimate for blocks of size 2^( 3) =       0.000405555598
  error estimate for blocks of size 2^( 4) =       0.000412430780
  error estimate for blocks of size 2^( 5) =       0.000416254587
  error estimate for blocks of size 2^( 6) =       0.000418829464
  error estimate for blocks of size 2^( 7) =       0.000422364773

      target function =                  N/A
              le_mean =     -17.216163966938
             les_mean =     296.708677309146
             stat err =       0.000417469901
             autocorr =       1.167302129660
              std dev =       0.546447606359
             le_variance =       0.298604986495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298525577304
                                         uncertainty =       0.001762984895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298525577304
                                         uncertainty =       0.001762984895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386396808
  error estimate for blocks of size 2^( 2) =       0.000396714566
  error estimate for blocks of size 2^( 3) =       0.000405555598
  error estimate for blocks of size 2^( 4) =       0.000412430780
  error estimate for blocks of size 2^( 5) =       0.000416254587
  error estimate for blocks of size 2^( 6) =       0.000418829464
  error estimate for blocks of size 2^( 7) =       0.000422364773

      target function =                  N/A
              le_mean =     -17.216163966938
             les_mean =     296.708677309146
             stat err =       0.000417469901
             autocorr =       1.167302129661
              std dev =       0.546447606358
             le_variance =       0.298604986495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298525577304
                                         uncertainty =       0.001762984895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298525577304
                                         uncertainty =       0.001762984895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386396808
  error estimate for blocks of size 2^( 2) =       0.000396714566
  error estimate for blocks of size 2^( 3) =       0.000405555598
  error estimate for blocks of size 2^( 4) =       0.000412430780
  error estimate for blocks of size 2^( 5) =       0.000416254587
  error estimate for blocks of size 2^( 6) =       0.000418829464
  error estimate for blocks of size 2^( 7) =       0.000422364773

      target function =                  N/A
              le_mean =     -17.216163966938
             les_mean =     296.708677309146
             stat err =       0.000417469901
             autocorr =       1.167302129664
              std dev =       0.546447606359
             le_variance =       0.298604986495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298525577304
                                         uncertainty =       0.001762984895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298525577304
                                         uncertainty =       0.001762984895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386396808
  error estimate for blocks of size 2^( 2) =       0.000396714566
  error estimate for blocks of size 2^( 3) =       0.000405555598
  error estimate for blocks of size 2^( 4) =       0.000412430780
  error estimate for blocks of size 2^( 5) =       0.000416254587
  error estimate for blocks of size 2^( 6) =       0.000418829464
  error estimate for blocks of size 2^( 7) =       0.000422364773

      target function =                  N/A
              le_mean =     -17.216163966938
             les_mean =     296.708677309146
             stat err =       0.000417469901
             autocorr =       1.167302129664
              std dev =       0.546447606359
             le_variance =       0.298604986495


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216163966938        initial
     6.1035e+09     6.1035e+10             5.2339e-14       -17.216163966938
     2.4414e+10     2.4414e+11             1.3085e-14       -17.216163966938  <--
     9.7656e+10     9.7656e+11             3.2712e-15       -17.216163966938

*****************************************************************************
Applying the update for shift_i =   2.4414e+10     and shift_s =   2.4414e+11
*****************************************************************************

  Execution time = 2.2550e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8818e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1702
    reference variance = 0.196177
====================================================
  Execution time = 1.3699e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1555e-01
  Total weights = 1.956686715e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300225432960
                                         uncertainty =       0.001886533947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300225432960
                                         uncertainty =       0.001886533947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387508923
  error estimate for blocks of size 2^( 2) =       0.000397317301
  error estimate for blocks of size 2^( 3) =       0.000406212261
  error estimate for blocks of size 2^( 4) =       0.000413458988
  error estimate for blocks of size 2^( 5) =       0.000417801062
  error estimate for blocks of size 2^( 6) =       0.000421413887
  error estimate for blocks of size 2^( 7) =       0.000423769142

      target function =                  N/A
              le_mean =     -17.216567640969
             les_mean =     296.725748568422
             stat err =       0.000419110770
             autocorr =       1.169753162021
              std dev =       0.548020374161
             le_variance =       0.300326330495


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656764097e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+09, overlap shift 6.1035e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216567640987       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216567640987       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216567640987       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+09 is 4.874494e-14

solving harmonic davidson linear method for identity shift 2.4414e+10, overlap shift 2.4414e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216567640987       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216567640987       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216567640987       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+10 is 1.218623e-14

solving harmonic davidson linear method for identity shift 9.7656e+10, overlap shift 9.7656e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216567640987       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216567640987       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216567640987       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216567640987       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216567640987       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216526806725       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216500218760       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216579685738       residual = 8.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+10 is 3.032967e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.343264 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6210e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.205
    reference variance = 0.204564
====================================================
  Execution time = 1.3238e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1170e-01
  Total weights = 1.9563e+06
  Execution time = 1.8187e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298940515945
                                         uncertainty =       0.002185142212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298940515945
                                         uncertainty =       0.002185142212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386590890
  error estimate for blocks of size 2^( 2) =       0.000396339370
  error estimate for blocks of size 2^( 3) =       0.000405186011
  error estimate for blocks of size 2^( 4) =       0.000412104759
  error estimate for blocks of size 2^( 5) =       0.000417256703
  error estimate for blocks of size 2^( 6) =       0.000420568542
  error estimate for blocks of size 2^( 7) =       0.000423450118

      target function =                  N/A
              le_mean =     -17.216622402522
             les_mean =     296.723787199854
             stat err =       0.000418345030
             autocorr =       1.171024541098
              std dev =       0.546722079938
             le_variance =       0.298905032691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298940515945
                                         uncertainty =       0.002185142212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298940515945
                                         uncertainty =       0.002185142212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386590890
  error estimate for blocks of size 2^( 2) =       0.000396339370
  error estimate for blocks of size 2^( 3) =       0.000405186011
  error estimate for blocks of size 2^( 4) =       0.000412104759
  error estimate for blocks of size 2^( 5) =       0.000417256703
  error estimate for blocks of size 2^( 6) =       0.000420568542
  error estimate for blocks of size 2^( 7) =       0.000423450118

      target function =                  N/A
              le_mean =     -17.216622402522
             les_mean =     296.723787199855
             stat err =       0.000418345030
             autocorr =       1.171024541100
              std dev =       0.546722079938
             le_variance =       0.298905032691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298940515945
                                         uncertainty =       0.002185142212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298940515945
                                         uncertainty =       0.002185142212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386590890
  error estimate for blocks of size 2^( 2) =       0.000396339370
  error estimate for blocks of size 2^( 3) =       0.000405186011
  error estimate for blocks of size 2^( 4) =       0.000412104759
  error estimate for blocks of size 2^( 5) =       0.000417256703
  error estimate for blocks of size 2^( 6) =       0.000420568542
  error estimate for blocks of size 2^( 7) =       0.000423450118

      target function =                  N/A
              le_mean =     -17.216622402522
             les_mean =     296.723787199855
             stat err =       0.000418345030
             autocorr =       1.171024541096
              std dev =       0.546722079938
             le_variance =       0.298905032691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298940515945
                                         uncertainty =       0.002185142212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298940515945
                                         uncertainty =       0.002185142212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386590890
  error estimate for blocks of size 2^( 2) =       0.000396339370
  error estimate for blocks of size 2^( 3) =       0.000405186011
  error estimate for blocks of size 2^( 4) =       0.000412104759
  error estimate for blocks of size 2^( 5) =       0.000417256703
  error estimate for blocks of size 2^( 6) =       0.000420568542
  error estimate for blocks of size 2^( 7) =       0.000423450118

      target function =                  N/A
              le_mean =     -17.216622402522
             les_mean =     296.723787199854
             stat err =       0.000418345030
             autocorr =       1.171024541095
              std dev =       0.546722079938
             le_variance =       0.298905032692


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216622402522        initial  <--
     6.1035e+09     6.1035e+10             4.8745e-14       -17.216622402522
     2.4414e+10     2.4414e+11             1.2186e-14       -17.216622402522
     9.7656e+10     9.7656e+11             3.0330e-15       -17.216622402522

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.4094
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8635e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.192
    reference variance = 0.172378
====================================================
  Execution time = 1.3738e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1065e-01
  Total weights = 1.956429987e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299036538144
                                         uncertainty =       0.002807567735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299036538144
                                         uncertainty =       0.002807567735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386656602
  error estimate for blocks of size 2^( 2) =       0.000396666875
  error estimate for blocks of size 2^( 3) =       0.000405574004
  error estimate for blocks of size 2^( 4) =       0.000412146246
  error estimate for blocks of size 2^( 5) =       0.000417382329
  error estimate for blocks of size 2^( 6) =       0.000420597534
  error estimate for blocks of size 2^( 7) =       0.000421586959

      target function =                  N/A
              le_mean =     -17.215820896732
             les_mean =     296.695142080872
             stat err =       0.000417928267
             autocorr =       1.168295306110
              std dev =       0.546815010551
             le_variance =       0.299006655763


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721582089673e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+10, overlap shift 6.1035e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215820896766       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215820896766       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215820896766       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215820896766       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215800911249       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215820241110       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+10 is 4.305090e-15

solving harmonic davidson linear method for identity shift 2.4414e+11, overlap shift 2.4414e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215820896766       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215820896766       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215820896766       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215820896766       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215920985923       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215883455043       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215875865198       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215855744559       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215828711570       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216084517403       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216011738079       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215398888179       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216361272480       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215905872745       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215637544973       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216089138519       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215768502552       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215802796492       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216126444727       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.215799162569       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216113061826       residual = 3.60e-07           smallest_sin_value = 9.98e-01
davidson iteration   21 stopping due to small subspace S singular value of 9.63e-01
davidson solver did not converge after         21 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+11 is 1.079853e-15

solving harmonic davidson linear method for identity shift 9.7656e+11, overlap shift 9.7656e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215820896766       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215820896766       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215820896766       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215637631898       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215820896766       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215194678062       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215641920586       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215998705042       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215877079798       residual = 9.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215846056394       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215580512353       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215498079992       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215839300749       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216255961254       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215746440845       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216231504535       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216050568130       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215728009090       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215159683317       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216716255361       residual = 4.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216213958239       residual = 1.07e-05           smallest_sin_value = 9.97e-01
davidson iteration   21 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         21 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+11 is 2.676681e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.356809 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6241e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2475
    reference variance = 0.277929
====================================================
  Execution time = 1.3158e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1223e-01
  Total weights = 1.9566e+06
  Execution time = 1.8159e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298860983619
                                         uncertainty =       0.001842242793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298860983619
                                         uncertainty =       0.001842242793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386576771
  error estimate for blocks of size 2^( 2) =       0.000396737144
  error estimate for blocks of size 2^( 3) =       0.000405013387
  error estimate for blocks of size 2^( 4) =       0.000411873463
  error estimate for blocks of size 2^( 5) =       0.000416069858
  error estimate for blocks of size 2^( 6) =       0.000417750765
  error estimate for blocks of size 2^( 7) =       0.000420319856

      target function =                  N/A
              le_mean =     -17.216322523494
             les_mean =     296.713989915925
             stat err =       0.000416503485
             autocorr =       1.160822378223
              std dev =       0.546702112391
             le_variance =       0.298883199692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298860983619
                                         uncertainty =       0.001842242793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298860983619
                                         uncertainty =       0.001842242793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386576771
  error estimate for blocks of size 2^( 2) =       0.000396737144
  error estimate for blocks of size 2^( 3) =       0.000405013387
  error estimate for blocks of size 2^( 4) =       0.000411873463
  error estimate for blocks of size 2^( 5) =       0.000416069858
  error estimate for blocks of size 2^( 6) =       0.000417750765
  error estimate for blocks of size 2^( 7) =       0.000420319856

      target function =                  N/A
              le_mean =     -17.216322523494
             les_mean =     296.713989915925
             stat err =       0.000416503485
             autocorr =       1.160822378229
              std dev =       0.546702112391
             le_variance =       0.298883199692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298860983619
                                         uncertainty =       0.001842242793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298860983619
                                         uncertainty =       0.001842242793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386576771
  error estimate for blocks of size 2^( 2) =       0.000396737144
  error estimate for blocks of size 2^( 3) =       0.000405013387
  error estimate for blocks of size 2^( 4) =       0.000411873463
  error estimate for blocks of size 2^( 5) =       0.000416069858
  error estimate for blocks of size 2^( 6) =       0.000417750765
  error estimate for blocks of size 2^( 7) =       0.000420319856

      target function =                  N/A
              le_mean =     -17.216322523494
             les_mean =     296.713989915925
             stat err =       0.000416503485
             autocorr =       1.160822378230
              std dev =       0.546702112391
             le_variance =       0.298883199692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298860983619
                                         uncertainty =       0.001842242793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298860983619
                                         uncertainty =       0.001842242793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386576771
  error estimate for blocks of size 2^( 2) =       0.000396737144
  error estimate for blocks of size 2^( 3) =       0.000405013387
  error estimate for blocks of size 2^( 4) =       0.000411873463
  error estimate for blocks of size 2^( 5) =       0.000416069858
  error estimate for blocks of size 2^( 6) =       0.000417750765
  error estimate for blocks of size 2^( 7) =       0.000420319856

      target function =                  N/A
              le_mean =     -17.216322523494
             les_mean =     296.713989915925
             stat err =       0.000416503485
             autocorr =       1.160822378224
              std dev =       0.546702112391
             le_variance =       0.298883199692


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216322523494        initial  <--
     6.1035e+10     6.1035e+11             4.3051e-15       -17.216322523494
     2.4414e+11     2.4414e+12             1.0799e-15       -17.216322523494
     9.7656e+11     9.7656e+12             2.6767e-16       -17.216322523494

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.3070
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8558e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.3168
    reference variance = 2.32516
====================================================
  Execution time = 1.3781e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1147e-01
  Total weights = 1.956559296e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298040984161
                                         uncertainty =       0.001745719257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298040984161
                                         uncertainty =       0.001745719257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386086721
  error estimate for blocks of size 2^( 2) =       0.000396121208
  error estimate for blocks of size 2^( 3) =       0.000404708773
  error estimate for blocks of size 2^( 4) =       0.000411491465
  error estimate for blocks of size 2^( 5) =       0.000415147804
  error estimate for blocks of size 2^( 6) =       0.000416814737
  error estimate for blocks of size 2^( 7) =       0.000419847674

      target function =                  N/A
              le_mean =     -17.216124631618
             les_mean =     296.706416669171
             stat err =       0.000415825420
             autocorr =       1.159984908685
              std dev =       0.546009077423
             le_variance =       0.298125912629


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721612463162e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+11, overlap shift 6.1035e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216124631633       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216124631633       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216124631633       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216125341242       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216271019300       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215973827745       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215866338346       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216186800479       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215440894649       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216211090808       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216062031857       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215740980434       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215941280080       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216159306273       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216055192240       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216235334452       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216364203888       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.214697959562       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216290842727       residual = 3.69e-05           smallest_sin_value = 9.99e-01
davidson iteration   19 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         19 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+11 is 5.425430e-16

solving harmonic davidson linear method for identity shift 2.4414e+12, overlap shift 2.4414e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216124631633       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216124631633       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216124631633       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216816402567       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215402660243       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216853715518       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216009502285       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217612060017       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.219602370335       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217229713345       residual = 9.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213265964396       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.218707715287       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.220016536491       residual = 6.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217920208643       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.212998988526       residual = 6.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.222812369452       residual = 9.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.213548684012       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217131751679       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216615565264       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.214985920142       residual = 7.48e-04           smallest_sin_value = 9.99e-01
davidson iteration   20 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         20 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+12 is 1.353941e-16

solving harmonic davidson linear method for identity shift 9.7656e+12, overlap shift 9.7656e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216124631633       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216124631633       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.26e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.366935 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6270e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.141
    reference variance = 0.188822
====================================================
  Execution time = 1.3147e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2006e-01
  Total weights = 1.9567e+06
  Execution time = 1.8194e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303687189723
                                         uncertainty =       0.002945883236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303687189723
                                         uncertainty =       0.002945883236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389626039
  error estimate for blocks of size 2^( 2) =       0.000399473523
  error estimate for blocks of size 2^( 3) =       0.000408169146
  error estimate for blocks of size 2^( 4) =       0.000415253143
  error estimate for blocks of size 2^( 5) =       0.000419777428
  error estimate for blocks of size 2^( 6) =       0.000421690225
  error estimate for blocks of size 2^( 7) =       0.000421985654

      target function =                  N/A
              le_mean =     -17.215962385389
             les_mean =     296.709424132243
             stat err =       0.000419676612
             autocorr =       1.160201943828
              std dev =       0.551014428419
             le_variance =       0.303616900326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303687189723
                                         uncertainty =       0.002945883236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303687189723
                                         uncertainty =       0.002945883236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389626039
  error estimate for blocks of size 2^( 2) =       0.000399473523
  error estimate for blocks of size 2^( 3) =       0.000408169146
  error estimate for blocks of size 2^( 4) =       0.000415253143
  error estimate for blocks of size 2^( 5) =       0.000419777428
  error estimate for blocks of size 2^( 6) =       0.000421690225
  error estimate for blocks of size 2^( 7) =       0.000421985654

      target function =                  N/A
              le_mean =     -17.215962385389
             les_mean =     296.709424132243
             stat err =       0.000419676612
             autocorr =       1.160201943827
              std dev =       0.551014428419
             le_variance =       0.303616900326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303687189723
                                         uncertainty =       0.002945883236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303687189723
                                         uncertainty =       0.002945883236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389626039
  error estimate for blocks of size 2^( 2) =       0.000399473523
  error estimate for blocks of size 2^( 3) =       0.000408169146
  error estimate for blocks of size 2^( 4) =       0.000415253143
  error estimate for blocks of size 2^( 5) =       0.000419777428
  error estimate for blocks of size 2^( 6) =       0.000421690225
  error estimate for blocks of size 2^( 7) =       0.000421985654

      target function =                  N/A
              le_mean =     -17.215962385389
             les_mean =     296.709424132243
             stat err =       0.000419676612
             autocorr =       1.160201943828
              std dev =       0.551014428419
             le_variance =       0.303616900326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303687189723
                                         uncertainty =       0.002945883236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303687189723
                                         uncertainty =       0.002945883236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389626039
  error estimate for blocks of size 2^( 2) =       0.000399473523
  error estimate for blocks of size 2^( 3) =       0.000408169146
  error estimate for blocks of size 2^( 4) =       0.000415253143
  error estimate for blocks of size 2^( 5) =       0.000419777428
  error estimate for blocks of size 2^( 6) =       0.000421690225
  error estimate for blocks of size 2^( 7) =       0.000421985654

      target function =                  N/A
              le_mean =     -17.215962385389
             les_mean =     296.709424132243
             stat err =       0.000419676612
             autocorr =       1.160201943828
              std dev =       0.551014428419
             le_variance =       0.303616900326


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215962385389        initial  <--
     6.1035e+11     6.1035e+12             5.4254e-16       -17.215962385389
     2.4414e+12     2.4414e+13             1.3539e-16       -17.215962385389
     9.7656e+12     9.7656e+13             0.0000e+00       -17.215962385389

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.3214
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8628e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2426
    reference variance = 0.191737
====================================================
  Execution time = 1.3698e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1877e-01
  Total weights = 1.956920966e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4679e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304084359445
                                         uncertainty =       0.002452613719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304084359445
                                         uncertainty =       0.002452613719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389961552
  error estimate for blocks of size 2^( 2) =       0.000399746290
  error estimate for blocks of size 2^( 3) =       0.000408596396
  error estimate for blocks of size 2^( 4) =       0.000414835786
  error estimate for blocks of size 2^( 5) =       0.000419297655
  error estimate for blocks of size 2^( 6) =       0.000421506231
  error estimate for blocks of size 2^( 7) =       0.000422010853

      target function =                  N/A
              le_mean =     -17.217363083223
             les_mean =     296.756360916081
             stat err =       0.000419412631
             autocorr =       1.156749796608
              std dev =       0.551488915002
             le_variance =       0.304140023370


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721736308322e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+12, overlap shift 6.1035e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217363083280       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217363083280       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.30e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+13, overlap shift 2.4414e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217363083280       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217363083280       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.82e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+13, overlap shift 9.7656e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217363083280       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217363083280       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.82e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.367964 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6171e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1477
    reference variance = 0.212939
====================================================
  Execution time = 1.3313e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1447e-01
  Total weights = 1.9567e+06
  Execution time = 1.8182e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300223286493
                                         uncertainty =       0.001937342819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300223286493
                                         uncertainty =       0.001937342819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387429135
  error estimate for blocks of size 2^( 2) =       0.000397019135
  error estimate for blocks of size 2^( 3) =       0.000405719804
  error estimate for blocks of size 2^( 4) =       0.000412412856
  error estimate for blocks of size 2^( 5) =       0.000418152221
  error estimate for blocks of size 2^( 6) =       0.000418662858
  error estimate for blocks of size 2^( 7) =       0.000419748100

      target function =                  N/A
              le_mean =     -17.216628272461
             les_mean =     296.726757207728
             stat err =       0.000417244009
             autocorr =       1.159833542838
              std dev =       0.547907537178
             le_variance =       0.300202669296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300223286493
                                         uncertainty =       0.001937342819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300223286493
                                         uncertainty =       0.001937342819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387429135
  error estimate for blocks of size 2^( 2) =       0.000397019135
  error estimate for blocks of size 2^( 3) =       0.000405719804
  error estimate for blocks of size 2^( 4) =       0.000412412856
  error estimate for blocks of size 2^( 5) =       0.000418152221
  error estimate for blocks of size 2^( 6) =       0.000418662858
  error estimate for blocks of size 2^( 7) =       0.000419748100

      target function =                  N/A
              le_mean =     -17.216628272461
             les_mean =     296.726757207728
             stat err =       0.000417244009
             autocorr =       1.159833542838
              std dev =       0.547907537178
             le_variance =       0.300202669296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300223286493
                                         uncertainty =       0.001937342819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300223286493
                                         uncertainty =       0.001937342819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387429135
  error estimate for blocks of size 2^( 2) =       0.000397019135
  error estimate for blocks of size 2^( 3) =       0.000405719804
  error estimate for blocks of size 2^( 4) =       0.000412412856
  error estimate for blocks of size 2^( 5) =       0.000418152221
  error estimate for blocks of size 2^( 6) =       0.000418662858
  error estimate for blocks of size 2^( 7) =       0.000419748100

      target function =                  N/A
              le_mean =     -17.216628272461
             les_mean =     296.726757207728
             stat err =       0.000417244009
             autocorr =       1.159833542838
              std dev =       0.547907537178
             le_variance =       0.300202669296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300223286493
                                         uncertainty =       0.001937342819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300223286493
                                         uncertainty =       0.001937342819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387429135
  error estimate for blocks of size 2^( 2) =       0.000397019135
  error estimate for blocks of size 2^( 3) =       0.000405719804
  error estimate for blocks of size 2^( 4) =       0.000412412856
  error estimate for blocks of size 2^( 5) =       0.000418152221
  error estimate for blocks of size 2^( 6) =       0.000418662858
  error estimate for blocks of size 2^( 7) =       0.000419748100

      target function =                  N/A
              le_mean =     -17.216628272461
             les_mean =     296.726757207728
             stat err =       0.000417244009
             autocorr =       1.159833542838
              std dev =       0.547907537178
             le_variance =       0.300202669296


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216628272461        initial  <--
     6.1035e+12     6.1035e+13             0.0000e+00       -17.216628272461
     2.4414e+13     2.4414e+14             0.0000e+00       -17.216628272461
     9.7656e+13     9.7656e+14             0.0000e+00       -17.216628272461

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.4736
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8734e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.199
    reference variance = 0.284342
====================================================
  Execution time = 1.3738e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1352e-01
  Total weights = 1.956543142e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4997e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298227763318
                                         uncertainty =       0.001645849135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298227763318
                                         uncertainty =       0.001645849135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386102036
  error estimate for blocks of size 2^( 2) =       0.000396011963
  error estimate for blocks of size 2^( 3) =       0.000405120096
  error estimate for blocks of size 2^( 4) =       0.000411494855
  error estimate for blocks of size 2^( 5) =       0.000415788122
  error estimate for blocks of size 2^( 6) =       0.000416951915
  error estimate for blocks of size 2^( 7) =       0.000417888037

      target function =                  N/A
              le_mean =     -17.216887753816
             les_mean =     296.734746455913
             stat err =       0.000415530732
             autocorr =       1.158249485890
              std dev =       0.546030735118
             le_variance =       0.298149563693


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721688775382e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+13, overlap shift 6.1035e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216887753821       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216887753821       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+14, overlap shift 2.4414e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216887753821       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216887753821       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+14, overlap shift 9.7656e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216887753821       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216887753821       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.369009 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6243e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.304
    reference variance = 0.239425
====================================================
  Execution time = 1.3332e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1823e-01
  Total weights = 1.9567e+06
  Execution time = 1.8143e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300341711409
                                         uncertainty =       0.002437247323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300341711409
                                         uncertainty =       0.002437247323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387503370
  error estimate for blocks of size 2^( 2) =       0.000397282962
  error estimate for blocks of size 2^( 3) =       0.000405712989
  error estimate for blocks of size 2^( 4) =       0.000412292532
  error estimate for blocks of size 2^( 5) =       0.000416509545
  error estimate for blocks of size 2^( 6) =       0.000419562558
  error estimate for blocks of size 2^( 7) =       0.000419641461

      target function =                  N/A
              le_mean =     -17.215981966139
             les_mean =     296.708260451922
             stat err =       0.000417001524
             autocorr =       1.158042015855
              std dev =       0.548012521137
             le_variance =       0.300317723323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300341711409
                                         uncertainty =       0.002437247323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300341711409
                                         uncertainty =       0.002437247323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387503370
  error estimate for blocks of size 2^( 2) =       0.000397282962
  error estimate for blocks of size 2^( 3) =       0.000405712989
  error estimate for blocks of size 2^( 4) =       0.000412292532
  error estimate for blocks of size 2^( 5) =       0.000416509545
  error estimate for blocks of size 2^( 6) =       0.000419562558
  error estimate for blocks of size 2^( 7) =       0.000419641461

      target function =                  N/A
              le_mean =     -17.215981966139
             les_mean =     296.708260451922
             stat err =       0.000417001524
             autocorr =       1.158042015855
              std dev =       0.548012521137
             le_variance =       0.300317723323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300341711409
                                         uncertainty =       0.002437247323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300341711409
                                         uncertainty =       0.002437247323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387503370
  error estimate for blocks of size 2^( 2) =       0.000397282962
  error estimate for blocks of size 2^( 3) =       0.000405712989
  error estimate for blocks of size 2^( 4) =       0.000412292532
  error estimate for blocks of size 2^( 5) =       0.000416509545
  error estimate for blocks of size 2^( 6) =       0.000419562558
  error estimate for blocks of size 2^( 7) =       0.000419641461

      target function =                  N/A
              le_mean =     -17.215981966139
             les_mean =     296.708260451922
             stat err =       0.000417001524
             autocorr =       1.158042015855
              std dev =       0.548012521137
             le_variance =       0.300317723323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300341711409
                                         uncertainty =       0.002437247323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300341711409
                                         uncertainty =       0.002437247323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387503370
  error estimate for blocks of size 2^( 2) =       0.000397282962
  error estimate for blocks of size 2^( 3) =       0.000405712989
  error estimate for blocks of size 2^( 4) =       0.000412292532
  error estimate for blocks of size 2^( 5) =       0.000416509545
  error estimate for blocks of size 2^( 6) =       0.000419562558
  error estimate for blocks of size 2^( 7) =       0.000419641461

      target function =                  N/A
              le_mean =     -17.215981966139
             les_mean =     296.708260451922
             stat err =       0.000417001524
             autocorr =       1.158042015855
              std dev =       0.548012521137
             le_variance =       0.300317723323


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215981966139        initial  <--
     6.1035e+13     6.1035e+14             0.0000e+00       -17.215981966139
     2.4414e+14     2.4414e+15             0.0000e+00       -17.215981966139
     9.7656e+14     9.7656e+15             0.0000e+00       -17.215981966139

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5597
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8823e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2162
    reference variance = 0.198315
====================================================
  Execution time = 1.5918e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0922e-01
  Total weights = 1.956730551e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4609e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296375952653
                                         uncertainty =       0.002003519098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296375952653
                                         uncertainty =       0.002003519098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384924593
  error estimate for blocks of size 2^( 2) =       0.000395056079
  error estimate for blocks of size 2^( 3) =       0.000404254760
  error estimate for blocks of size 2^( 4) =       0.000411078768
  error estimate for blocks of size 2^( 5) =       0.000415072950
  error estimate for blocks of size 2^( 6) =       0.000416488735
  error estimate for blocks of size 2^( 7) =       0.000418531422

      target function =                  N/A
              le_mean =     -17.217131649629
             les_mean =     296.738838118951
             stat err =       0.000415292969
             autocorr =       1.164013019297
              std dev =       0.544365580237
             le_variance =       0.296333884947


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721713164963e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+14, overlap shift 6.1035e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217131649725       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217131649725       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217131649725       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217131649725       residual = 2.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+14 is 5.597168e-19

solving harmonic davidson linear method for identity shift 2.4414e+15, overlap shift 2.4414e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217131649725       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217131649725       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217131649725       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.300543129380       residual = 4.11e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.089513328062       residual = 1.21e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.905483305042       residual = 8.67e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.107106167821       residual = 2.02e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.154506178792       residual = 2.11e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.796574219827       residual = 1.48e+03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -18.316351188078       residual = 3.03e+02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -18.241141683272       residual = 1.47e+03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.564152356781       residual = 1.56e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.520361722148       residual = 4.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.584323146691       residual = 9.32e+03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -18.886684493795       residual = 6.92e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.841606998319       residual = 1.21e+03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -18.421140264315       residual = 4.17e+03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -18.259389694694       residual = 5.87e+03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -13.055127565540       residual = 3.86e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -23.059609306998       residual = 5.38e+03           smallest_sin_value = 9.98e-01
davidson iteration   20: stopping due to imaginary component in cost function
davidson solver did not converge after         20 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+15 is 1.389846e-19

solving harmonic davidson linear method for identity shift 9.7656e+15, overlap shift 9.7656e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217131649725       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217131649725       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217131649725       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.27e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+15 is 3.393504e-20

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.375006 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8389e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2425
    reference variance = 0.154517
====================================================
  Execution time = 1.3493e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1593e-01
  Total weights = 1.9568e+06
  Execution time = 1.8149e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299535913253
                                         uncertainty =       0.001835111592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299535913253
                                         uncertainty =       0.001835111592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386963894
  error estimate for blocks of size 2^( 2) =       0.000396993706
  error estimate for blocks of size 2^( 3) =       0.000405739276
  error estimate for blocks of size 2^( 4) =       0.000411966577
  error estimate for blocks of size 2^( 5) =       0.000416776918
  error estimate for blocks of size 2^( 6) =       0.000417583864
  error estimate for blocks of size 2^( 7) =       0.000418243410

      target function =                  N/A
              le_mean =     -17.216685225664
             les_mean =     296.730184534585
             stat err =       0.000416142692
             autocorr =       1.156494723173
              std dev =       0.547249587173
             le_variance =       0.299482110661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299535913253
                                         uncertainty =       0.001835111592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299535913253
                                         uncertainty =       0.001835111592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386963894
  error estimate for blocks of size 2^( 2) =       0.000396993706
  error estimate for blocks of size 2^( 3) =       0.000405739276
  error estimate for blocks of size 2^( 4) =       0.000411966577
  error estimate for blocks of size 2^( 5) =       0.000416776918
  error estimate for blocks of size 2^( 6) =       0.000417583864
  error estimate for blocks of size 2^( 7) =       0.000418243410

      target function =                  N/A
              le_mean =     -17.216685225664
             les_mean =     296.730184534585
             stat err =       0.000416142692
             autocorr =       1.156494723173
              std dev =       0.547249587173
             le_variance =       0.299482110661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299535913253
                                         uncertainty =       0.001835111592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299535913253
                                         uncertainty =       0.001835111592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386963894
  error estimate for blocks of size 2^( 2) =       0.000396993706
  error estimate for blocks of size 2^( 3) =       0.000405739276
  error estimate for blocks of size 2^( 4) =       0.000411966577
  error estimate for blocks of size 2^( 5) =       0.000416776918
  error estimate for blocks of size 2^( 6) =       0.000417583864
  error estimate for blocks of size 2^( 7) =       0.000418243410

      target function =                  N/A
              le_mean =     -17.216685225664
             les_mean =     296.730184534585
             stat err =       0.000416142692
             autocorr =       1.156494723173
              std dev =       0.547249587173
             le_variance =       0.299482110661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299535913253
                                         uncertainty =       0.001835111592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299535913253
                                         uncertainty =       0.001835111592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386963894
  error estimate for blocks of size 2^( 2) =       0.000396993706
  error estimate for blocks of size 2^( 3) =       0.000405739276
  error estimate for blocks of size 2^( 4) =       0.000411966577
  error estimate for blocks of size 2^( 5) =       0.000416776918
  error estimate for blocks of size 2^( 6) =       0.000417583864
  error estimate for blocks of size 2^( 7) =       0.000418243410

      target function =                  N/A
              le_mean =     -17.216685225664
             les_mean =     296.730184534585
             stat err =       0.000416142692
             autocorr =       1.156494723173
              std dev =       0.547249587173
             le_variance =       0.299482110661


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216685225664        initial  <--
     6.1035e+14     6.1035e+15             5.5972e-19       -17.216685225664
     2.4414e+15     2.4414e+16             1.3898e-19       -17.216685225664
     9.7656e+15     9.7656e+16             3.3935e-20       -17.216685225664

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6427
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1095e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2204
    reference variance = 0.240735
====================================================
  Execution time = 1.3551e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0744e-01
  Total weights = 1.956224636e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295542009073
                                         uncertainty =       0.002321498808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295542009073
                                         uncertainty =       0.002321498808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384358358
  error estimate for blocks of size 2^( 2) =       0.000394768877
  error estimate for blocks of size 2^( 3) =       0.000404164119
  error estimate for blocks of size 2^( 4) =       0.000410463259
  error estimate for blocks of size 2^( 5) =       0.000414259725
  error estimate for blocks of size 2^( 6) =       0.000416767293
  error estimate for blocks of size 2^( 7) =       0.000418155259

      target function =                  N/A
              le_mean =     -17.215884221044
             les_mean =     296.694114074677
             stat err =       0.000414911384
             autocorr =       1.165300796482
              std dev =       0.543564802125
             le_variance =       0.295462694109


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721588422104e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+15, overlap shift 6.1035e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215884221082       residual = 8.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215884221082       residual = 8.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.02e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+16, overlap shift 2.4414e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215884221082       residual = 8.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215884221082       residual = 8.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.02e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+16, overlap shift 9.7656e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215884221082       residual = 8.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215884221082       residual = 8.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.376028 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6042e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2706
    reference variance = 0.31088
====================================================
  Execution time = 1.3398e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1003e-01
  Total weights = 1.9565e+06
  Execution time = 1.8113e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297867309572
                                         uncertainty =       0.001889567141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297867309572
                                         uncertainty =       0.001889567141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385883484
  error estimate for blocks of size 2^( 2) =       0.000396119935
  error estimate for blocks of size 2^( 3) =       0.000404960765
  error estimate for blocks of size 2^( 4) =       0.000411352355
  error estimate for blocks of size 2^( 5) =       0.000415464757
  error estimate for blocks of size 2^( 6) =       0.000419721717
  error estimate for blocks of size 2^( 7) =       0.000422370712

      target function =                  N/A
              le_mean =     -17.215728590169
             les_mean =     296.691337041802
             stat err =       0.000417227385
             autocorr =       1.169050385959
              std dev =       0.545721656885
             le_variance =       0.297812126793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297867309572
                                         uncertainty =       0.001889567141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297867309572
                                         uncertainty =       0.001889567141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385883484
  error estimate for blocks of size 2^( 2) =       0.000396119935
  error estimate for blocks of size 2^( 3) =       0.000404960765
  error estimate for blocks of size 2^( 4) =       0.000411352355
  error estimate for blocks of size 2^( 5) =       0.000415464757
  error estimate for blocks of size 2^( 6) =       0.000419721717
  error estimate for blocks of size 2^( 7) =       0.000422370712

      target function =                  N/A
              le_mean =     -17.215728590169
             les_mean =     296.691337041802
             stat err =       0.000417227385
             autocorr =       1.169050385959
              std dev =       0.545721656885
             le_variance =       0.297812126793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297867309572
                                         uncertainty =       0.001889567141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297867309572
                                         uncertainty =       0.001889567141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385883484
  error estimate for blocks of size 2^( 2) =       0.000396119935
  error estimate for blocks of size 2^( 3) =       0.000404960765
  error estimate for blocks of size 2^( 4) =       0.000411352355
  error estimate for blocks of size 2^( 5) =       0.000415464757
  error estimate for blocks of size 2^( 6) =       0.000419721717
  error estimate for blocks of size 2^( 7) =       0.000422370712

      target function =                  N/A
              le_mean =     -17.215728590169
             les_mean =     296.691337041802
             stat err =       0.000417227385
             autocorr =       1.169050385959
              std dev =       0.545721656885
             le_variance =       0.297812126793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297867309572
                                         uncertainty =       0.001889567141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297867309572
                                         uncertainty =       0.001889567141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385883484
  error estimate for blocks of size 2^( 2) =       0.000396119935
  error estimate for blocks of size 2^( 3) =       0.000404960765
  error estimate for blocks of size 2^( 4) =       0.000411352355
  error estimate for blocks of size 2^( 5) =       0.000415464757
  error estimate for blocks of size 2^( 6) =       0.000419721717
  error estimate for blocks of size 2^( 7) =       0.000422370712

      target function =                  N/A
              le_mean =     -17.215728590169
             les_mean =     296.691337041802
             stat err =       0.000417227385
             autocorr =       1.169050385959
              std dev =       0.545721656885
             le_variance =       0.297812126793


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215728590169        initial  <--
     6.1035e+15     6.1035e+16             0.0000e+00       -17.215728590169
     2.4414e+16     2.4414e+17             0.0000e+00       -17.215728590169
     9.7656e+16     9.7656e+17             0.0000e+00       -17.215728590169

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5393
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9029e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2742
    reference variance = 0.475663
====================================================
  Execution time = 1.3656e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1560e-01
  Total weights = 1.956538432e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301200580703
                                         uncertainty =       0.002127850319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301200580703
                                         uncertainty =       0.002127850319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388124285
  error estimate for blocks of size 2^( 2) =       0.000398422729
  error estimate for blocks of size 2^( 3) =       0.000408019462
  error estimate for blocks of size 2^( 4) =       0.000414856957
  error estimate for blocks of size 2^( 5) =       0.000419034675
  error estimate for blocks of size 2^( 6) =       0.000420632132
  error estimate for blocks of size 2^( 7) =       0.000421475344

      target function =                  N/A
              le_mean =     -17.216088867882
             les_mean =     296.709318471064
             stat err =       0.000418999777
             autocorr =       1.165429342025
              std dev =       0.548890628137
             le_variance =       0.301280921657


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721608886788e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+16, overlap shift 6.1035e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216088867924       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216088867924       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.32e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+17, overlap shift 2.4414e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216088867924       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216088867924       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.32e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+17, overlap shift 9.7656e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216088867924       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216088867924       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.377087 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6129e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1385
    reference variance = 0.257021
====================================================
  Execution time = 1.3380e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1098e-01
  Total weights = 1.9566e+06
  Execution time = 1.8167e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298729022251
                                         uncertainty =       0.001848117863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298729022251
                                         uncertainty =       0.001848117863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386502829
  error estimate for blocks of size 2^( 2) =       0.000396548321
  error estimate for blocks of size 2^( 3) =       0.000405990973
  error estimate for blocks of size 2^( 4) =       0.000413112041
  error estimate for blocks of size 2^( 5) =       0.000417903102
  error estimate for blocks of size 2^( 6) =       0.000420288771
  error estimate for blocks of size 2^( 7) =       0.000422064138

      target function =                  N/A
              le_mean =     -17.217524274541
             les_mean =     296.754124830835
             stat err =       0.000418342013
             autocorr =       1.171541315683
              std dev =       0.546597543039
             le_variance =       0.298768874056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298729022251
                                         uncertainty =       0.001848117863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298729022251
                                         uncertainty =       0.001848117863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386502829
  error estimate for blocks of size 2^( 2) =       0.000396548321
  error estimate for blocks of size 2^( 3) =       0.000405990973
  error estimate for blocks of size 2^( 4) =       0.000413112041
  error estimate for blocks of size 2^( 5) =       0.000417903102
  error estimate for blocks of size 2^( 6) =       0.000420288771
  error estimate for blocks of size 2^( 7) =       0.000422064138

      target function =                  N/A
              le_mean =     -17.217524274541
             les_mean =     296.754124830835
             stat err =       0.000418342013
             autocorr =       1.171541315683
              std dev =       0.546597543039
             le_variance =       0.298768874056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298729022251
                                         uncertainty =       0.001848117863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298729022251
                                         uncertainty =       0.001848117863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386502829
  error estimate for blocks of size 2^( 2) =       0.000396548321
  error estimate for blocks of size 2^( 3) =       0.000405990973
  error estimate for blocks of size 2^( 4) =       0.000413112041
  error estimate for blocks of size 2^( 5) =       0.000417903102
  error estimate for blocks of size 2^( 6) =       0.000420288771
  error estimate for blocks of size 2^( 7) =       0.000422064138

      target function =                  N/A
              le_mean =     -17.217524274541
             les_mean =     296.754124830835
             stat err =       0.000418342013
             autocorr =       1.171541315683
              std dev =       0.546597543039
             le_variance =       0.298768874056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298729022251
                                         uncertainty =       0.001848117863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298729022251
                                         uncertainty =       0.001848117863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386502829
  error estimate for blocks of size 2^( 2) =       0.000396548321
  error estimate for blocks of size 2^( 3) =       0.000405990973
  error estimate for blocks of size 2^( 4) =       0.000413112041
  error estimate for blocks of size 2^( 5) =       0.000417903102
  error estimate for blocks of size 2^( 6) =       0.000420288771
  error estimate for blocks of size 2^( 7) =       0.000422064138

      target function =                  N/A
              le_mean =     -17.217524274541
             les_mean =     296.754124830835
             stat err =       0.000418342013
             autocorr =       1.171541315683
              std dev =       0.546597543039
             le_variance =       0.298768874056


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217524274541        initial  <--
     6.1035e+16     6.1035e+17             0.0000e+00       -17.217524274541
     2.4414e+17     2.4414e+18             0.0000e+00       -17.217524274541
     9.7656e+17     9.7656e+18             0.0000e+00       -17.217524274541

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5631
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8699e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.2634
    reference variance = 0.263993
====================================================
  Execution time = 1.3627e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2512e-01
  Total weights = 1.956757404e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4898e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303017532857
                                         uncertainty =       0.004250655565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303017532857
                                         uncertainty =       0.004250655565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389196068
  error estimate for blocks of size 2^( 2) =       0.000398648420
  error estimate for blocks of size 2^( 3) =       0.000407370248
  error estimate for blocks of size 2^( 4) =       0.000414024974
  error estimate for blocks of size 2^( 5) =       0.000418613891
  error estimate for blocks of size 2^( 6) =       0.000421520346
  error estimate for blocks of size 2^( 7) =       0.000422445692

      target function =                  N/A
              le_mean =     -17.216109124080
             les_mean =     296.719531522105
             stat err =       0.000419151226
             autocorr =       1.159857385542
              std dev =       0.550406358261
             le_variance =       0.302947159214


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721610912408e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+17, overlap shift 6.1035e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216109124085       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216109124085       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+18, overlap shift 2.4414e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216109124085       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216109124085       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+18, overlap shift 9.7656e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216109124085       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216109124085       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.378114 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6122e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.2593
    reference variance = 0.216835
====================================================
  Execution time = 1.3478e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1433e-01
  Total weights = 1.9563e+06
  Execution time = 1.8082e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298676827705
                                         uncertainty =       0.002327184985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298676827705
                                         uncertainty =       0.002327184985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386478279
  error estimate for blocks of size 2^( 2) =       0.000396162809
  error estimate for blocks of size 2^( 3) =       0.000405454220
  error estimate for blocks of size 2^( 4) =       0.000412911576
  error estimate for blocks of size 2^( 5) =       0.000416612061
  error estimate for blocks of size 2^( 6) =       0.000419169069
  error estimate for blocks of size 2^( 7) =       0.000420035161

      target function =                  N/A
              le_mean =     -17.216182808939
             les_mean =     296.711276349490
             stat err =       0.000417181966
             autocorr =       1.165201061356
              std dev =       0.546562824337
             le_variance =       0.298730920947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298676827705
                                         uncertainty =       0.002327184985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298676827705
                                         uncertainty =       0.002327184985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386478279
  error estimate for blocks of size 2^( 2) =       0.000396162809
  error estimate for blocks of size 2^( 3) =       0.000405454220
  error estimate for blocks of size 2^( 4) =       0.000412911576
  error estimate for blocks of size 2^( 5) =       0.000416612061
  error estimate for blocks of size 2^( 6) =       0.000419169069
  error estimate for blocks of size 2^( 7) =       0.000420035161

      target function =                  N/A
              le_mean =     -17.216182808939
             les_mean =     296.711276349490
             stat err =       0.000417181966
             autocorr =       1.165201061356
              std dev =       0.546562824337
             le_variance =       0.298730920947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298676827705
                                         uncertainty =       0.002327184985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298676827705
                                         uncertainty =       0.002327184985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386478279
  error estimate for blocks of size 2^( 2) =       0.000396162809
  error estimate for blocks of size 2^( 3) =       0.000405454220
  error estimate for blocks of size 2^( 4) =       0.000412911576
  error estimate for blocks of size 2^( 5) =       0.000416612061
  error estimate for blocks of size 2^( 6) =       0.000419169069
  error estimate for blocks of size 2^( 7) =       0.000420035161

      target function =                  N/A
              le_mean =     -17.216182808939
             les_mean =     296.711276349490
             stat err =       0.000417181966
             autocorr =       1.165201061356
              std dev =       0.546562824337
             le_variance =       0.298730920947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298676827705
                                         uncertainty =       0.002327184985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298676827705
                                         uncertainty =       0.002327184985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386478279
  error estimate for blocks of size 2^( 2) =       0.000396162809
  error estimate for blocks of size 2^( 3) =       0.000405454220
  error estimate for blocks of size 2^( 4) =       0.000412911576
  error estimate for blocks of size 2^( 5) =       0.000416612061
  error estimate for blocks of size 2^( 6) =       0.000419169069
  error estimate for blocks of size 2^( 7) =       0.000420035161

      target function =                  N/A
              le_mean =     -17.216182808939
             les_mean =     296.711276349490
             stat err =       0.000417181966
             autocorr =       1.165201061356
              std dev =       0.546562824337
             le_variance =       0.298730920947


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216182808939        initial  <--
     6.1035e+17     6.1035e+18             0.0000e+00       -17.216182808939
     2.4414e+18     2.4414e+19             0.0000e+00       -17.216182808939
     9.7656e+18     9.7656e+19             0.0000e+00       -17.216182808939

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6082
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8740e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.1789
    reference variance = 0.268153
====================================================
  Execution time = 1.3755e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1554e-01
  Total weights = 1.956734107e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4985e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297983025732
                                         uncertainty =       0.001926527293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297983025732
                                         uncertainty =       0.001926527293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386042510
  error estimate for blocks of size 2^( 2) =       0.000396113643
  error estimate for blocks of size 2^( 3) =       0.000405184800
  error estimate for blocks of size 2^( 4) =       0.000413243315
  error estimate for blocks of size 2^( 5) =       0.000417416976
  error estimate for blocks of size 2^( 6) =       0.000419850840
  error estimate for blocks of size 2^( 7) =       0.000422813649

      target function =                  N/A
              le_mean =     -17.217244630448
             les_mean =     296.749050734053
             stat err =       0.000418331195
             autocorr =       1.174276148261
              std dev =       0.545946553886
             le_variance =       0.298057639700


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721724463045e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+18, overlap shift 6.1035e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217244630484       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217244630484       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+18 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+19, overlap shift 2.4414e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217244630484       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217244630484       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+19 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+19, overlap shift 9.7656e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217244630484       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217244630484       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.379178 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6259e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.2495
    reference variance = 0.205077
====================================================
  Execution time = 1.3456e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1592e-01
  Total weights = 1.9567e+06
  Execution time = 1.8189e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301397356001
                                         uncertainty =       0.002221697788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301397356001
                                         uncertainty =       0.002221697788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388156428
  error estimate for blocks of size 2^( 2) =       0.000398336258
  error estimate for blocks of size 2^( 3) =       0.000407013204
  error estimate for blocks of size 2^( 4) =       0.000413857051
  error estimate for blocks of size 2^( 5) =       0.000418577688
  error estimate for blocks of size 2^( 6) =       0.000420693290
  error estimate for blocks of size 2^( 7) =       0.000422454644

      target function =                  N/A
              le_mean =     -17.216228354841
             les_mean =     296.714441203230
             stat err =       0.000418895668
             autocorr =       1.164657352843
              std dev =       0.548936085258
             le_variance =       0.301330825698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301397356001
                                         uncertainty =       0.002221697788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301397356001
                                         uncertainty =       0.002221697788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388156428
  error estimate for blocks of size 2^( 2) =       0.000398336258
  error estimate for blocks of size 2^( 3) =       0.000407013204
  error estimate for blocks of size 2^( 4) =       0.000413857051
  error estimate for blocks of size 2^( 5) =       0.000418577688
  error estimate for blocks of size 2^( 6) =       0.000420693290
  error estimate for blocks of size 2^( 7) =       0.000422454644

      target function =                  N/A
              le_mean =     -17.216228354841
             les_mean =     296.714441203230
             stat err =       0.000418895668
             autocorr =       1.164657352843
              std dev =       0.548936085258
             le_variance =       0.301330825698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301397356001
                                         uncertainty =       0.002221697788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301397356001
                                         uncertainty =       0.002221697788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388156428
  error estimate for blocks of size 2^( 2) =       0.000398336258
  error estimate for blocks of size 2^( 3) =       0.000407013204
  error estimate for blocks of size 2^( 4) =       0.000413857051
  error estimate for blocks of size 2^( 5) =       0.000418577688
  error estimate for blocks of size 2^( 6) =       0.000420693290
  error estimate for blocks of size 2^( 7) =       0.000422454644

      target function =                  N/A
              le_mean =     -17.216228354841
             les_mean =     296.714441203230
             stat err =       0.000418895668
             autocorr =       1.164657352843
              std dev =       0.548936085258
             le_variance =       0.301330825698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301397356001
                                         uncertainty =       0.002221697788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301397356001
                                         uncertainty =       0.002221697788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388156428
  error estimate for blocks of size 2^( 2) =       0.000398336258
  error estimate for blocks of size 2^( 3) =       0.000407013204
  error estimate for blocks of size 2^( 4) =       0.000413857051
  error estimate for blocks of size 2^( 5) =       0.000418577688
  error estimate for blocks of size 2^( 6) =       0.000420693290
  error estimate for blocks of size 2^( 7) =       0.000422454644

      target function =                  N/A
              le_mean =     -17.216228354841
             les_mean =     296.714441203230
             stat err =       0.000418895668
             autocorr =       1.164657352843
              std dev =       0.548936085258
             le_variance =       0.301330825698


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216228354841        initial  <--
     6.1035e+18     6.1035e+19             0.0000e+00       -17.216228354841
     2.4414e+19     2.4414e+20             0.0000e+00       -17.216228354841
     9.7656e+19     9.7656e+20             0.0000e+00       -17.216228354841

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6238
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8895e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2262
    reference variance = 0.226694
====================================================
  Execution time = 1.3471e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1289e-01
  Total weights = 1.956759553e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5012e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297414362091
                                         uncertainty =       0.002008531460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297414362091
                                         uncertainty =       0.002008531460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385579586
  error estimate for blocks of size 2^( 2) =       0.000395703196
  error estimate for blocks of size 2^( 3) =       0.000404719265
  error estimate for blocks of size 2^( 4) =       0.000411572851
  error estimate for blocks of size 2^( 5) =       0.000416529490
  error estimate for blocks of size 2^( 6) =       0.000418620887
  error estimate for blocks of size 2^( 7) =       0.000420949898

      target function =                  N/A
              le_mean =     -17.217044914737
             les_mean =     296.739525436265
             stat err =       0.000416918282
             autocorr =       1.169159631946
              std dev =       0.545291880404
             le_variance =       0.297343234834


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721704491474e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+19, overlap shift 6.1035e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217044914775       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217044914775       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217044914775       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+19 is 6.992806e-24

solving harmonic davidson linear method for identity shift 2.4414e+20, overlap shift 2.4414e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217044914775       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217044914775       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217044914775       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+20 is 1.749557e-24

solving harmonic davidson linear method for identity shift 9.7656e+20, overlap shift 9.7656e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217044914775       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217044914775       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217044914775       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+20 is 4.373893e-25

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.380337 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.5978e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2095
    reference variance = 0.27084
====================================================
  Execution time = 1.3465e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1591e-01
  Total weights = 1.9563e+06
  Execution time = 1.8068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298868564332
                                         uncertainty =       0.001803127131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298868564332
                                         uncertainty =       0.001803127131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386553006
  error estimate for blocks of size 2^( 2) =       0.000396710709
  error estimate for blocks of size 2^( 3) =       0.000405018205
  error estimate for blocks of size 2^( 4) =       0.000411510313
  error estimate for blocks of size 2^( 5) =       0.000415288691
  error estimate for blocks of size 2^( 6) =       0.000416945619
  error estimate for blocks of size 2^( 7) =       0.000419915066

      target function =                  N/A
              le_mean =     -17.216597933891
             les_mean =     296.727156624935
             stat err =       0.000415914922
             autocorr =       1.157686305503
              std dev =       0.546668503024
             le_variance =       0.298846452198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298868564332
                                         uncertainty =       0.001803127131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298868564332
                                         uncertainty =       0.001803127131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386553006
  error estimate for blocks of size 2^( 2) =       0.000396710709
  error estimate for blocks of size 2^( 3) =       0.000405018205
  error estimate for blocks of size 2^( 4) =       0.000411510313
  error estimate for blocks of size 2^( 5) =       0.000415288691
  error estimate for blocks of size 2^( 6) =       0.000416945619
  error estimate for blocks of size 2^( 7) =       0.000419915066

      target function =                  N/A
              le_mean =     -17.216597933891
             les_mean =     296.727156624935
             stat err =       0.000415914922
             autocorr =       1.157686305503
              std dev =       0.546668503024
             le_variance =       0.298846452198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298868564332
                                         uncertainty =       0.001803127131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298868564332
                                         uncertainty =       0.001803127131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386553006
  error estimate for blocks of size 2^( 2) =       0.000396710709
  error estimate for blocks of size 2^( 3) =       0.000405018205
  error estimate for blocks of size 2^( 4) =       0.000411510313
  error estimate for blocks of size 2^( 5) =       0.000415288691
  error estimate for blocks of size 2^( 6) =       0.000416945619
  error estimate for blocks of size 2^( 7) =       0.000419915066

      target function =                  N/A
              le_mean =     -17.216597933891
             les_mean =     296.727156624935
             stat err =       0.000415914922
             autocorr =       1.157686305503
              std dev =       0.546668503024
             le_variance =       0.298846452198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298868564332
                                         uncertainty =       0.001803127131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298868564332
                                         uncertainty =       0.001803127131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386553006
  error estimate for blocks of size 2^( 2) =       0.000396710709
  error estimate for blocks of size 2^( 3) =       0.000405018205
  error estimate for blocks of size 2^( 4) =       0.000411510313
  error estimate for blocks of size 2^( 5) =       0.000415288691
  error estimate for blocks of size 2^( 6) =       0.000416945619
  error estimate for blocks of size 2^( 7) =       0.000419915066

      target function =                  N/A
              le_mean =     -17.216597933891
             les_mean =     296.727156624935
             stat err =       0.000415914922
             autocorr =       1.157686305503
              std dev =       0.546668503024
             le_variance =       0.298846452198


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216597933891        initial  <--
     6.1035e+19     6.1035e+20             6.9928e-24       -17.216597933891
     2.4414e+20     2.4414e+21             1.7496e-24       -17.216597933891
     9.7656e+20     9.7656e+21             4.3739e-25       -17.216597933891

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5998
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8587e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2219
    reference variance = 0.390876
====================================================
  Execution time = 1.3807e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1294e-01
  Total weights = 1.956702840e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300515702062
                                         uncertainty =       0.001851945968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300515702062
                                         uncertainty =       0.001851945968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387585997
  error estimate for blocks of size 2^( 2) =       0.000397303634
  error estimate for blocks of size 2^( 3) =       0.000406099349
  error estimate for blocks of size 2^( 4) =       0.000413252924
  error estimate for blocks of size 2^( 5) =       0.000417318824
  error estimate for blocks of size 2^( 6) =       0.000420558812
  error estimate for blocks of size 2^( 7) =       0.000419686455

      target function =                  N/A
              le_mean =     -17.216727913079
             les_mean =     296.728657965459
             stat err =       0.000417704254
             autocorr =       1.161452995196
              std dev =       0.548129374157
             le_variance =       0.300445810814


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721672791308e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+20, overlap shift 6.1035e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216727913127       residual = 8.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216727913127       residual = 8.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+21, overlap shift 2.4414e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216727913127       residual = 8.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216727913127       residual = 8.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+21, overlap shift 9.7656e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216727913127       residual = 8.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216727913127       residual = 8.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.381389 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6301e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2332
    reference variance = 0.271699
====================================================
  Execution time = 1.3383e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1252e-01
  Total weights = 1.9562e+06
  Execution time = 1.8131e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297668468066
                                         uncertainty =       0.001767586407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297668468066
                                         uncertainty =       0.001767586407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385784443
  error estimate for blocks of size 2^( 2) =       0.000395898210
  error estimate for blocks of size 2^( 3) =       0.000404527492
  error estimate for blocks of size 2^( 4) =       0.000411352422
  error estimate for blocks of size 2^( 5) =       0.000416099937
  error estimate for blocks of size 2^( 6) =       0.000418657664
  error estimate for blocks of size 2^( 7) =       0.000419631732

      target function =                  N/A
              le_mean =     -17.217124346794
             les_mean =     296.741892166561
             stat err =       0.000416435439
             autocorr =       1.165214661661
              std dev =       0.545581591815
             le_variance =       0.297659273328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297668468066
                                         uncertainty =       0.001767586407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297668468066
                                         uncertainty =       0.001767586407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385784443
  error estimate for blocks of size 2^( 2) =       0.000395898210
  error estimate for blocks of size 2^( 3) =       0.000404527492
  error estimate for blocks of size 2^( 4) =       0.000411352422
  error estimate for blocks of size 2^( 5) =       0.000416099937
  error estimate for blocks of size 2^( 6) =       0.000418657664
  error estimate for blocks of size 2^( 7) =       0.000419631732

      target function =                  N/A
              le_mean =     -17.217124346794
             les_mean =     296.741892166561
             stat err =       0.000416435439
             autocorr =       1.165214661661
              std dev =       0.545581591815
             le_variance =       0.297659273328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297668468066
                                         uncertainty =       0.001767586407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297668468066
                                         uncertainty =       0.001767586407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385784443
  error estimate for blocks of size 2^( 2) =       0.000395898210
  error estimate for blocks of size 2^( 3) =       0.000404527492
  error estimate for blocks of size 2^( 4) =       0.000411352422
  error estimate for blocks of size 2^( 5) =       0.000416099937
  error estimate for blocks of size 2^( 6) =       0.000418657664
  error estimate for blocks of size 2^( 7) =       0.000419631732

      target function =                  N/A
              le_mean =     -17.217124346794
             les_mean =     296.741892166561
             stat err =       0.000416435439
             autocorr =       1.165214661661
              std dev =       0.545581591815
             le_variance =       0.297659273328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297668468066
                                         uncertainty =       0.001767586407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297668468066
                                         uncertainty =       0.001767586407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385784443
  error estimate for blocks of size 2^( 2) =       0.000395898210
  error estimate for blocks of size 2^( 3) =       0.000404527492
  error estimate for blocks of size 2^( 4) =       0.000411352422
  error estimate for blocks of size 2^( 5) =       0.000416099937
  error estimate for blocks of size 2^( 6) =       0.000418657664
  error estimate for blocks of size 2^( 7) =       0.000419631732

      target function =                  N/A
              le_mean =     -17.217124346794
             les_mean =     296.741892166561
             stat err =       0.000416435439
             autocorr =       1.165214661661
              std dev =       0.545581591815
             le_variance =       0.297659273328


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217124346794        initial  <--
     6.1035e+20     6.1035e+21             0.0000e+00       -17.217124346794
     2.4414e+21     2.4414e+22             0.0000e+00       -17.217124346794
     9.7656e+21     9.7656e+22             0.0000e+00       -17.217124346794

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5936
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8918e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.2165
    reference variance = 0.228764
====================================================
  Execution time = 1.3892e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1026e-01
  Total weights = 1.956663431e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4890e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296365051008
                                         uncertainty =       0.001806248726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296365051008
                                         uncertainty =       0.001806248726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384966600
  error estimate for blocks of size 2^( 2) =       0.000395238197
  error estimate for blocks of size 2^( 3) =       0.000404465733
  error estimate for blocks of size 2^( 4) =       0.000411837887
  error estimate for blocks of size 2^( 5) =       0.000416272831
  error estimate for blocks of size 2^( 6) =       0.000418146564
  error estimate for blocks of size 2^( 7) =       0.000421563363

      target function =                  N/A
              le_mean =     -17.216939201574
             les_mean =     296.733254908285
             stat err =       0.000416955161
             autocorr =       1.173093435226
              std dev =       0.544424987206
             le_variance =       0.296398566695


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721693920157e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+21, overlap shift 6.1035e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216939201628       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216939201628       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+22, overlap shift 2.4414e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216939201628       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216939201628       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+22, overlap shift 9.7656e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216939201628       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216939201628       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.382519 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6388e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.3065
    reference variance = 0.532552
====================================================
  Execution time = 1.5794e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2038e-01
  Total weights = 1.9570e+06
  Execution time = 1.8227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302054970737
                                         uncertainty =       0.002587766083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302054970737
                                         uncertainty =       0.002587766083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388576301
  error estimate for blocks of size 2^( 2) =       0.000398596471
  error estimate for blocks of size 2^( 3) =       0.000408163133
  error estimate for blocks of size 2^( 4) =       0.000414627231
  error estimate for blocks of size 2^( 5) =       0.000419188528
  error estimate for blocks of size 2^( 6) =       0.000422157685
  error estimate for blocks of size 2^( 7) =       0.000424756870

      target function =                  N/A
              le_mean =     -17.217017823439
             les_mean =     296.746086167365
             stat err =       0.000420182578
             autocorr =       1.169293305066
              std dev =       0.549529875373
             le_variance =       0.301983083928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302054970737
                                         uncertainty =       0.002587766083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302054970737
                                         uncertainty =       0.002587766083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388576301
  error estimate for blocks of size 2^( 2) =       0.000398596471
  error estimate for blocks of size 2^( 3) =       0.000408163133
  error estimate for blocks of size 2^( 4) =       0.000414627231
  error estimate for blocks of size 2^( 5) =       0.000419188528
  error estimate for blocks of size 2^( 6) =       0.000422157685
  error estimate for blocks of size 2^( 7) =       0.000424756870

      target function =                  N/A
              le_mean =     -17.217017823439
             les_mean =     296.746086167365
             stat err =       0.000420182578
             autocorr =       1.169293305066
              std dev =       0.549529875373
             le_variance =       0.301983083928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302054970737
                                         uncertainty =       0.002587766083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302054970737
                                         uncertainty =       0.002587766083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388576301
  error estimate for blocks of size 2^( 2) =       0.000398596471
  error estimate for blocks of size 2^( 3) =       0.000408163133
  error estimate for blocks of size 2^( 4) =       0.000414627231
  error estimate for blocks of size 2^( 5) =       0.000419188528
  error estimate for blocks of size 2^( 6) =       0.000422157685
  error estimate for blocks of size 2^( 7) =       0.000424756870

      target function =                  N/A
              le_mean =     -17.217017823439
             les_mean =     296.746086167365
             stat err =       0.000420182578
             autocorr =       1.169293305066
              std dev =       0.549529875373
             le_variance =       0.301983083928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302054970737
                                         uncertainty =       0.002587766083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302054970737
                                         uncertainty =       0.002587766083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388576301
  error estimate for blocks of size 2^( 2) =       0.000398596471
  error estimate for blocks of size 2^( 3) =       0.000408163133
  error estimate for blocks of size 2^( 4) =       0.000414627231
  error estimate for blocks of size 2^( 5) =       0.000419188528
  error estimate for blocks of size 2^( 6) =       0.000422157685
  error estimate for blocks of size 2^( 7) =       0.000424756870

      target function =                  N/A
              le_mean =     -17.217017823439
             les_mean =     296.746086167365
             stat err =       0.000420182578
             autocorr =       1.169293305066
              std dev =       0.549529875373
             le_variance =       0.301983083928


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217017823439        initial  <--
     6.1035e+21     6.1035e+22             0.0000e+00       -17.217017823439
     2.4414e+22     2.4414e+23             0.0000e+00       -17.217017823439
     9.7656e+22     9.7656e+23             0.0000e+00       -17.217017823439

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.9980
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1402e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.1944
    reference variance = 0.207553
====================================================
  Execution time = 1.3754e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1336e-01
  Total weights = 1.956677320e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4661e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300735173523
                                         uncertainty =       0.002102062616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300735173523
                                         uncertainty =       0.002102062616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387749171
  error estimate for blocks of size 2^( 2) =       0.000398443095
  error estimate for blocks of size 2^( 3) =       0.000407249623
  error estimate for blocks of size 2^( 4) =       0.000413734194
  error estimate for blocks of size 2^( 5) =       0.000417649157
  error estimate for blocks of size 2^( 6) =       0.000418811505
  error estimate for blocks of size 2^( 7) =       0.000421325625

      target function =                  N/A
              le_mean =     -17.217592287095
             les_mean =     296.758843312463
             stat err =       0.000417880120
             autocorr =       1.161453067721
              std dev =       0.548360136709
             le_variance =       0.300698839531


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721759228709e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+22, overlap shift 6.1035e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217592287171       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217592287171       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+23, overlap shift 2.4414e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217592287171       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217592287171       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+23, overlap shift 9.7656e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217592287171       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217592287171       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.383523 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6225e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2334
    reference variance = 0.338112
====================================================
  Execution time = 1.3459e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1177e-01
  Total weights = 1.9567e+06
  Execution time = 1.8331e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298766503581
                                         uncertainty =       0.002249467966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298766503581
                                         uncertainty =       0.002249467966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386512899
  error estimate for blocks of size 2^( 2) =       0.000396439949
  error estimate for blocks of size 2^( 3) =       0.000405330465
  error estimate for blocks of size 2^( 4) =       0.000412448158
  error estimate for blocks of size 2^( 5) =       0.000416448980
  error estimate for blocks of size 2^( 6) =       0.000418931666
  error estimate for blocks of size 2^( 7) =       0.000420686884

      target function =                  N/A
              le_mean =     -17.216558087255
             les_mean =     296.721639741793
             stat err =       0.000417128922
             autocorr =       1.164696103959
              std dev =       0.546611783219
             le_variance =       0.298784441554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298766503581
                                         uncertainty =       0.002249467966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298766503581
                                         uncertainty =       0.002249467966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386512899
  error estimate for blocks of size 2^( 2) =       0.000396439949
  error estimate for blocks of size 2^( 3) =       0.000405330465
  error estimate for blocks of size 2^( 4) =       0.000412448158
  error estimate for blocks of size 2^( 5) =       0.000416448980
  error estimate for blocks of size 2^( 6) =       0.000418931666
  error estimate for blocks of size 2^( 7) =       0.000420686884

      target function =                  N/A
              le_mean =     -17.216558087255
             les_mean =     296.721639741793
             stat err =       0.000417128922
             autocorr =       1.164696103959
              std dev =       0.546611783219
             le_variance =       0.298784441554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298766503581
                                         uncertainty =       0.002249467966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298766503581
                                         uncertainty =       0.002249467966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386512899
  error estimate for blocks of size 2^( 2) =       0.000396439949
  error estimate for blocks of size 2^( 3) =       0.000405330465
  error estimate for blocks of size 2^( 4) =       0.000412448158
  error estimate for blocks of size 2^( 5) =       0.000416448980
  error estimate for blocks of size 2^( 6) =       0.000418931666
  error estimate for blocks of size 2^( 7) =       0.000420686884

      target function =                  N/A
              le_mean =     -17.216558087255
             les_mean =     296.721639741793
             stat err =       0.000417128922
             autocorr =       1.164696103959
              std dev =       0.546611783219
             le_variance =       0.298784441554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298766503581
                                         uncertainty =       0.002249467966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298766503581
                                         uncertainty =       0.002249467966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386512899
  error estimate for blocks of size 2^( 2) =       0.000396439949
  error estimate for blocks of size 2^( 3) =       0.000405330465
  error estimate for blocks of size 2^( 4) =       0.000412448158
  error estimate for blocks of size 2^( 5) =       0.000416448980
  error estimate for blocks of size 2^( 6) =       0.000418931666
  error estimate for blocks of size 2^( 7) =       0.000420686884

      target function =                  N/A
              le_mean =     -17.216558087255
             les_mean =     296.721639741793
             stat err =       0.000417128922
             autocorr =       1.164696103959
              std dev =       0.546611783219
             le_variance =       0.298784441554


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216558087255        initial  <--
     6.1035e+22     6.1035e+23             0.0000e+00       -17.216558087255
     2.4414e+23     2.4414e+24             0.0000e+00       -17.216558087255
     9.7656e+23     9.7656e+24             0.0000e+00       -17.216558087255

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6290
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8989e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.1889
    reference variance = 0.198911
====================================================
  Execution time = 1.3661e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5315e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1536e-01
  Total weights = 1.956981160e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5026e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299089428945
                                         uncertainty =       0.002051622258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299089428945
                                         uncertainty =       0.002051622258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386636402
  error estimate for blocks of size 2^( 2) =       0.000396367226
  error estimate for blocks of size 2^( 3) =       0.000405062992
  error estimate for blocks of size 2^( 4) =       0.000412214167
  error estimate for blocks of size 2^( 5) =       0.000416963663
  error estimate for blocks of size 2^( 6) =       0.000421004292
  error estimate for blocks of size 2^( 7) =       0.000422582606

      target function =                  N/A
              le_mean =     -17.216604181233
             les_mean =     296.726817167122
             stat err =       0.000418191182
             autocorr =       1.169887934044
              std dev =       0.546786443024
             le_variance =       0.298975414275


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660418123e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+23, overlap shift 6.1035e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216604181268       residual = 9.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216604181268       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216604181268       residual = 9.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+23 is 6.071365e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+24, overlap shift 2.4414e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216604181268       residual = 9.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216604181268       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216604181268       residual = 9.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+24 is 1.517841e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+24, overlap shift 9.7656e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216604181268       residual = 9.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216604181268       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216604181268       residual = 9.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+24 is 3.794603e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.384849 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6169e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2259
    reference variance = 0.326869
====================================================
  Execution time = 1.3154e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1363e-01
  Total weights = 1.9568e+06
  Execution time = 1.8243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298793231257
                                         uncertainty =       0.001802148782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298793231257
                                         uncertainty =       0.001802148782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386547220
  error estimate for blocks of size 2^( 2) =       0.000396655882
  error estimate for blocks of size 2^( 3) =       0.000405625905
  error estimate for blocks of size 2^( 4) =       0.000412206340
  error estimate for blocks of size 2^( 5) =       0.000416245460
  error estimate for blocks of size 2^( 6) =       0.000418698257
  error estimate for blocks of size 2^( 7) =       0.000421745361

      target function =                  N/A
              le_mean =     -17.216054306008
             les_mean =     296.706152798764
             stat err =       0.000417223855
             autocorr =       1.165019388016
              std dev =       0.546660321505
             le_variance =       0.298837507108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298793231257
                                         uncertainty =       0.001802148782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298793231257
                                         uncertainty =       0.001802148782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386547220
  error estimate for blocks of size 2^( 2) =       0.000396655882
  error estimate for blocks of size 2^( 3) =       0.000405625905
  error estimate for blocks of size 2^( 4) =       0.000412206340
  error estimate for blocks of size 2^( 5) =       0.000416245460
  error estimate for blocks of size 2^( 6) =       0.000418698257
  error estimate for blocks of size 2^( 7) =       0.000421745361

      target function =                  N/A
              le_mean =     -17.216054306008
             les_mean =     296.706152798764
             stat err =       0.000417223855
             autocorr =       1.165019388016
              std dev =       0.546660321505
             le_variance =       0.298837507108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298793231257
                                         uncertainty =       0.001802148782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298793231257
                                         uncertainty =       0.001802148782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386547220
  error estimate for blocks of size 2^( 2) =       0.000396655882
  error estimate for blocks of size 2^( 3) =       0.000405625905
  error estimate for blocks of size 2^( 4) =       0.000412206340
  error estimate for blocks of size 2^( 5) =       0.000416245460
  error estimate for blocks of size 2^( 6) =       0.000418698257
  error estimate for blocks of size 2^( 7) =       0.000421745361

      target function =                  N/A
              le_mean =     -17.216054306008
             les_mean =     296.706152798764
             stat err =       0.000417223855
             autocorr =       1.165019388016
              std dev =       0.546660321505
             le_variance =       0.298837507108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298793231257
                                         uncertainty =       0.001802148782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298793231257
                                         uncertainty =       0.001802148782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386547220
  error estimate for blocks of size 2^( 2) =       0.000396655882
  error estimate for blocks of size 2^( 3) =       0.000405625905
  error estimate for blocks of size 2^( 4) =       0.000412206340
  error estimate for blocks of size 2^( 5) =       0.000416245460
  error estimate for blocks of size 2^( 6) =       0.000418698257
  error estimate for blocks of size 2^( 7) =       0.000421745361

      target function =                  N/A
              le_mean =     -17.216054306008
             les_mean =     296.706152798764
             stat err =       0.000417223855
             autocorr =       1.165019388016
              std dev =       0.546660321505
             le_variance =       0.298837507108


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216054306008        initial  <--
     6.1035e+23     6.1035e+24             6.0714e-28       -17.216054306008
     2.4414e+24     2.4414e+25             1.5178e-28       -17.216054306008
     9.7656e+24     9.7656e+25             3.7946e-29       -17.216054306008

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.3208
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8517e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.1992
    reference variance = 0.149273
====================================================
  Execution time = 1.3608e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5303e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1559e-01
  Total weights = 1.956830393e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4763e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299467661273
                                         uncertainty =       0.002581168710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299467661273
                                         uncertainty =       0.002581168710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386878587
  error estimate for blocks of size 2^( 2) =       0.000397132410
  error estimate for blocks of size 2^( 3) =       0.000406126559
  error estimate for blocks of size 2^( 4) =       0.000413091004
  error estimate for blocks of size 2^( 5) =       0.000419091982
  error estimate for blocks of size 2^( 6) =       0.000422958934
  error estimate for blocks of size 2^( 7) =       0.000423755792

      target function =                  N/A
              le_mean =     -17.216268984720
             les_mean =     296.715504845316
             stat err =       0.000419724428
             autocorr =       1.177007163160
              std dev =       0.547128944504
             le_variance =       0.299350081915


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721626898472e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+24, overlap shift 6.1035e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216268984752       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216268984752       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+25, overlap shift 2.4414e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216268984752       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216268984752       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+25, overlap shift 9.7656e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216268984752       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216268984752       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.386002 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6089e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.1783
    reference variance = 0.66028
====================================================
  Execution time = 1.3508e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0928e-01
  Total weights = 1.9567e+06
  Execution time = 1.8152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296412017721
                                         uncertainty =       0.001755636061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296412017721
                                         uncertainty =       0.001755636061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384966754
  error estimate for blocks of size 2^( 2) =       0.000395017168
  error estimate for blocks of size 2^( 3) =       0.000404488513
  error estimate for blocks of size 2^( 4) =       0.000411599996
  error estimate for blocks of size 2^( 5) =       0.000416425309
  error estimate for blocks of size 2^( 6) =       0.000418123454
  error estimate for blocks of size 2^( 7) =       0.000419338999

      target function =                  N/A
              le_mean =     -17.215813713972
             les_mean =     296.693522947644
             stat err =       0.000416371939
             autocorr =       1.169813034226
              std dev =       0.544425204622
             le_variance =       0.296398803428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296412017721
                                         uncertainty =       0.001755636061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296412017721
                                         uncertainty =       0.001755636061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384966754
  error estimate for blocks of size 2^( 2) =       0.000395017168
  error estimate for blocks of size 2^( 3) =       0.000404488513
  error estimate for blocks of size 2^( 4) =       0.000411599996
  error estimate for blocks of size 2^( 5) =       0.000416425309
  error estimate for blocks of size 2^( 6) =       0.000418123454
  error estimate for blocks of size 2^( 7) =       0.000419338999

      target function =                  N/A
              le_mean =     -17.215813713972
             les_mean =     296.693522947644
             stat err =       0.000416371939
             autocorr =       1.169813034226
              std dev =       0.544425204622
             le_variance =       0.296398803428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296412017721
                                         uncertainty =       0.001755636061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296412017721
                                         uncertainty =       0.001755636061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384966754
  error estimate for blocks of size 2^( 2) =       0.000395017168
  error estimate for blocks of size 2^( 3) =       0.000404488513
  error estimate for blocks of size 2^( 4) =       0.000411599996
  error estimate for blocks of size 2^( 5) =       0.000416425309
  error estimate for blocks of size 2^( 6) =       0.000418123454
  error estimate for blocks of size 2^( 7) =       0.000419338999

      target function =                  N/A
              le_mean =     -17.215813713972
             les_mean =     296.693522947644
             stat err =       0.000416371939
             autocorr =       1.169813034226
              std dev =       0.544425204622
             le_variance =       0.296398803428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296412017721
                                         uncertainty =       0.001755636061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296412017721
                                         uncertainty =       0.001755636061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384966754
  error estimate for blocks of size 2^( 2) =       0.000395017168
  error estimate for blocks of size 2^( 3) =       0.000404488513
  error estimate for blocks of size 2^( 4) =       0.000411599996
  error estimate for blocks of size 2^( 5) =       0.000416425309
  error estimate for blocks of size 2^( 6) =       0.000418123454
  error estimate for blocks of size 2^( 7) =       0.000419338999

      target function =                  N/A
              le_mean =     -17.215813713972
             les_mean =     296.693522947644
             stat err =       0.000416371939
             autocorr =       1.169813034226
              std dev =       0.544425204622
             le_variance =       0.296398803428


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215813713972        initial  <--
     6.1035e+24     6.1035e+25             0.0000e+00       -17.215813713972
     2.4414e+25     2.4414e+26             0.0000e+00       -17.215813713972
     9.7656e+25     9.7656e+26             0.0000e+00       -17.215813713972

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6778
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8775e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2575
    reference variance = 0.207761
====================================================
  Execution time = 1.3644e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5314e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1414e-01
  Total weights = 1.956757684e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4832e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299406476688
                                         uncertainty =       0.001826406725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299406476688
                                         uncertainty =       0.001826406725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386882466
  error estimate for blocks of size 2^( 2) =       0.000396430238
  error estimate for blocks of size 2^( 3) =       0.000405076524
  error estimate for blocks of size 2^( 4) =       0.000411955934
  error estimate for blocks of size 2^( 5) =       0.000415270550
  error estimate for blocks of size 2^( 6) =       0.000416751016
  error estimate for blocks of size 2^( 7) =       0.000417756726

      target function =                  N/A
              le_mean =     -17.217059766645
             les_mean =     296.741282843967
             stat err =       0.000415433557
             autocorr =       1.153041804528
              std dev =       0.547134430043
             le_variance =       0.299356084538


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721705976664e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+25, overlap shift 6.1035e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217059766680       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217059766680       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+26, overlap shift 2.4414e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217059766680       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217059766680       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+26, overlap shift 9.7656e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217059766680       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217059766680       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.387002 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6133e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2347
    reference variance = 0.179556
====================================================
  Execution time = 1.3370e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1935e-01
  Total weights = 1.9570e+06
  Execution time = 1.8179e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303435389145
                                         uncertainty =       0.002369950229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303435389145
                                         uncertainty =       0.002369950229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389454600
  error estimate for blocks of size 2^( 2) =       0.000399383110
  error estimate for blocks of size 2^( 3) =       0.000408316772
  error estimate for blocks of size 2^( 4) =       0.000414613383
  error estimate for blocks of size 2^( 5) =       0.000418415522
  error estimate for blocks of size 2^( 6) =       0.000420631148
  error estimate for blocks of size 2^( 7) =       0.000422115245

      target function =                  N/A
              le_mean =     -17.216856874340
             les_mean =     296.739513487612
             stat err =       0.000418943825
             autocorr =       1.157171986816
              std dev =       0.550771976566
             le_variance =       0.303349770170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303435389145
                                         uncertainty =       0.002369950229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303435389145
                                         uncertainty =       0.002369950229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389454600
  error estimate for blocks of size 2^( 2) =       0.000399383110
  error estimate for blocks of size 2^( 3) =       0.000408316772
  error estimate for blocks of size 2^( 4) =       0.000414613383
  error estimate for blocks of size 2^( 5) =       0.000418415522
  error estimate for blocks of size 2^( 6) =       0.000420631148
  error estimate for blocks of size 2^( 7) =       0.000422115245

      target function =                  N/A
              le_mean =     -17.216856874340
             les_mean =     296.739513487612
             stat err =       0.000418943825
             autocorr =       1.157171986816
              std dev =       0.550771976566
             le_variance =       0.303349770170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303435389145
                                         uncertainty =       0.002369950229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303435389145
                                         uncertainty =       0.002369950229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389454600
  error estimate for blocks of size 2^( 2) =       0.000399383110
  error estimate for blocks of size 2^( 3) =       0.000408316772
  error estimate for blocks of size 2^( 4) =       0.000414613383
  error estimate for blocks of size 2^( 5) =       0.000418415522
  error estimate for blocks of size 2^( 6) =       0.000420631148
  error estimate for blocks of size 2^( 7) =       0.000422115245

      target function =                  N/A
              le_mean =     -17.216856874340
             les_mean =     296.739513487612
             stat err =       0.000418943825
             autocorr =       1.157171986816
              std dev =       0.550771976566
             le_variance =       0.303349770170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303435389145
                                         uncertainty =       0.002369950229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303435389145
                                         uncertainty =       0.002369950229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389454600
  error estimate for blocks of size 2^( 2) =       0.000399383110
  error estimate for blocks of size 2^( 3) =       0.000408316772
  error estimate for blocks of size 2^( 4) =       0.000414613383
  error estimate for blocks of size 2^( 5) =       0.000418415522
  error estimate for blocks of size 2^( 6) =       0.000420631148
  error estimate for blocks of size 2^( 7) =       0.000422115245

      target function =                  N/A
              le_mean =     -17.216856874340
             les_mean =     296.739513487612
             stat err =       0.000418943825
             autocorr =       1.157171986816
              std dev =       0.550771976566
             le_variance =       0.303349770170


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216856874340        initial  <--
     6.1035e+25     6.1035e+26             0.0000e+00       -17.216856874340
     2.4414e+26     2.4414e+27             0.0000e+00       -17.216856874340
     9.7656e+26     9.7656e+27             0.0000e+00       -17.216856874340

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5334
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8676e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.253
    reference variance = 0.215805
====================================================
  Execution time = 1.3791e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1981e-01
  Total weights = 1.956687654e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4931e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304167878468
                                         uncertainty =       0.002498596973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304167878468
                                         uncertainty =       0.002498596973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389976941
  error estimate for blocks of size 2^( 2) =       0.000399788336
  error estimate for blocks of size 2^( 3) =       0.000409113507
  error estimate for blocks of size 2^( 4) =       0.000415726360
  error estimate for blocks of size 2^( 5) =       0.000420132255
  error estimate for blocks of size 2^( 6) =       0.000423207964
  error estimate for blocks of size 2^( 7) =       0.000426006118

      target function =                  N/A
              le_mean =     -17.216044296869
             les_mean =     296.711986766447
             stat err =       0.000421268174
             autocorr =       1.166915593824
              std dev =       0.551510679107
             le_variance =       0.304164029169


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721604429687e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+26, overlap shift 6.1035e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216044296915       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216044296915       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+27, overlap shift 2.4414e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216044296915       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216044296915       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+27, overlap shift 9.7656e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216044296915       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216044296915       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.388074 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6289e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.0872
    reference variance = 0.606873
====================================================
  Execution time = 1.3275e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1851e-01
  Total weights = 1.9567e+06
  Execution time = 1.8242e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303019448484
                                         uncertainty =       0.002555033539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303019448484
                                         uncertainty =       0.002555033539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389188159
  error estimate for blocks of size 2^( 2) =       0.000398893057
  error estimate for blocks of size 2^( 3) =       0.000408093332
  error estimate for blocks of size 2^( 4) =       0.000415208855
  error estimate for blocks of size 2^( 5) =       0.000419984123
  error estimate for blocks of size 2^( 6) =       0.000422132426
  error estimate for blocks of size 2^( 7) =       0.000423178532

      target function =                  N/A
              le_mean =     -17.215662657077
             les_mean =     296.697555552675
             stat err =       0.000420125984
             autocorr =       1.165305637119
              std dev =       0.550395173329
             le_variance =       0.302934846823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303019448484
                                         uncertainty =       0.002555033539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303019448484
                                         uncertainty =       0.002555033539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389188159
  error estimate for blocks of size 2^( 2) =       0.000398893057
  error estimate for blocks of size 2^( 3) =       0.000408093332
  error estimate for blocks of size 2^( 4) =       0.000415208855
  error estimate for blocks of size 2^( 5) =       0.000419984123
  error estimate for blocks of size 2^( 6) =       0.000422132426
  error estimate for blocks of size 2^( 7) =       0.000423178532

      target function =                  N/A
              le_mean =     -17.215662657077
             les_mean =     296.697555552675
             stat err =       0.000420125984
             autocorr =       1.165305637119
              std dev =       0.550395173329
             le_variance =       0.302934846823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303019448484
                                         uncertainty =       0.002555033539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303019448484
                                         uncertainty =       0.002555033539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389188159
  error estimate for blocks of size 2^( 2) =       0.000398893057
  error estimate for blocks of size 2^( 3) =       0.000408093332
  error estimate for blocks of size 2^( 4) =       0.000415208855
  error estimate for blocks of size 2^( 5) =       0.000419984123
  error estimate for blocks of size 2^( 6) =       0.000422132426
  error estimate for blocks of size 2^( 7) =       0.000423178532

      target function =                  N/A
              le_mean =     -17.215662657077
             les_mean =     296.697555552675
             stat err =       0.000420125984
             autocorr =       1.165305637119
              std dev =       0.550395173329
             le_variance =       0.302934846823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303019448484
                                         uncertainty =       0.002555033539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303019448484
                                         uncertainty =       0.002555033539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389188159
  error estimate for blocks of size 2^( 2) =       0.000398893057
  error estimate for blocks of size 2^( 3) =       0.000408093332
  error estimate for blocks of size 2^( 4) =       0.000415208855
  error estimate for blocks of size 2^( 5) =       0.000419984123
  error estimate for blocks of size 2^( 6) =       0.000422132426
  error estimate for blocks of size 2^( 7) =       0.000423178532

      target function =                  N/A
              le_mean =     -17.215662657077
             les_mean =     296.697555552675
             stat err =       0.000420125984
             autocorr =       1.165305637119
              std dev =       0.550395173329
             le_variance =       0.302934846823


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215662657077        initial  <--
     6.1035e+26     6.1035e+27             0.0000e+00       -17.215662657077
     2.4414e+27     2.4414e+28             0.0000e+00       -17.215662657077
     9.7656e+27     9.7656e+28             0.0000e+00       -17.215662657077

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.4626
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8764e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2435
    reference variance = 0.180304
====================================================
  Execution time = 1.3810e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1576e-01
  Total weights = 1.956372923e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299865705242
                                         uncertainty =       0.002735249094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299865705242
                                         uncertainty =       0.002735249094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387186061
  error estimate for blocks of size 2^( 2) =       0.000397233883
  error estimate for blocks of size 2^( 3) =       0.000406396890
  error estimate for blocks of size 2^( 4) =       0.000412169602
  error estimate for blocks of size 2^( 5) =       0.000416994316
  error estimate for blocks of size 2^( 6) =       0.000419465281
  error estimate for blocks of size 2^( 7) =       0.000423378723

      target function =                  N/A
              le_mean =     -17.216595152972
             les_mean =     296.726910316692
             stat err =       0.000418001981
             autocorr =       1.165513347983
              std dev =       0.547563778348
             le_variance =       0.299826091359


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721659515297e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+27, overlap shift 6.1035e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216595152989       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216595152989       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216595152989       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+27 is 4.960885e-32

solving harmonic davidson linear method for identity shift 2.4414e+28, overlap shift 2.4414e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216595152989       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216595152989       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216595152975       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+28 is 1.240221e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+28, overlap shift 9.7656e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216595152989       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216595152989       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216595152989       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+28 is 3.100553e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.389434 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6306e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2746
    reference variance = 0.36213
====================================================
  Execution time = 1.3189e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1525e-01
  Total weights = 1.9566e+06
  Execution time = 1.8178e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300556151420
                                         uncertainty =       0.002530709445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300556151420
                                         uncertainty =       0.002530709445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387616113
  error estimate for blocks of size 2^( 2) =       0.000397385285
  error estimate for blocks of size 2^( 3) =       0.000406541586
  error estimate for blocks of size 2^( 4) =       0.000414123217
  error estimate for blocks of size 2^( 5) =       0.000417918458
  error estimate for blocks of size 2^( 6) =       0.000420478545
  error estimate for blocks of size 2^( 7) =       0.000423231547

      target function =                  N/A
              le_mean =     -17.216327594776
             les_mean =     296.717181637248
             stat err =       0.000418937942
             autocorr =       1.168142285510
              std dev =       0.548171964303
             le_variance =       0.300492502448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300556151420
                                         uncertainty =       0.002530709445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300556151420
                                         uncertainty =       0.002530709445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387616113
  error estimate for blocks of size 2^( 2) =       0.000397385285
  error estimate for blocks of size 2^( 3) =       0.000406541586
  error estimate for blocks of size 2^( 4) =       0.000414123217
  error estimate for blocks of size 2^( 5) =       0.000417918458
  error estimate for blocks of size 2^( 6) =       0.000420478545
  error estimate for blocks of size 2^( 7) =       0.000423231547

      target function =                  N/A
              le_mean =     -17.216327594776
             les_mean =     296.717181637248
             stat err =       0.000418937942
             autocorr =       1.168142285510
              std dev =       0.548171964303
             le_variance =       0.300492502448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300556151420
                                         uncertainty =       0.002530709445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300556151420
                                         uncertainty =       0.002530709445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387616113
  error estimate for blocks of size 2^( 2) =       0.000397385285
  error estimate for blocks of size 2^( 3) =       0.000406541586
  error estimate for blocks of size 2^( 4) =       0.000414123217
  error estimate for blocks of size 2^( 5) =       0.000417918458
  error estimate for blocks of size 2^( 6) =       0.000420478545
  error estimate for blocks of size 2^( 7) =       0.000423231547

      target function =                  N/A
              le_mean =     -17.216327594776
             les_mean =     296.717181637248
             stat err =       0.000418937942
             autocorr =       1.168142285510
              std dev =       0.548171964303
             le_variance =       0.300492502448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300556151420
                                         uncertainty =       0.002530709445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300556151420
                                         uncertainty =       0.002530709445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387616113
  error estimate for blocks of size 2^( 2) =       0.000397385285
  error estimate for blocks of size 2^( 3) =       0.000406541586
  error estimate for blocks of size 2^( 4) =       0.000414123217
  error estimate for blocks of size 2^( 5) =       0.000417918458
  error estimate for blocks of size 2^( 6) =       0.000420478545
  error estimate for blocks of size 2^( 7) =       0.000423231547

      target function =                  N/A
              le_mean =     -17.216327594776
             les_mean =     296.717181637248
             stat err =       0.000418937942
             autocorr =       1.168142285510
              std dev =       0.548171964303
             le_variance =       0.300492502448


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216327594776        initial  <--
     6.1035e+27     6.1035e+28             4.9609e-32       -17.216327594776
     2.4414e+28     2.4414e+29             1.2402e-32       -17.216327594776
     9.7656e+28     9.7656e+29             3.1006e-33       -17.216327594776

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.3746
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8707e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2681
    reference variance = 0.277947
====================================================
  Execution time = 1.3771e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1218e-01
  Total weights = 1.957039822e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299217372215
                                         uncertainty =       0.001916269146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299217372215
                                         uncertainty =       0.001916269146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386773231
  error estimate for blocks of size 2^( 2) =       0.000396678760
  error estimate for blocks of size 2^( 3) =       0.000406337340
  error estimate for blocks of size 2^( 4) =       0.000412669590
  error estimate for blocks of size 2^( 5) =       0.000416223031
  error estimate for blocks of size 2^( 6) =       0.000418668716
  error estimate for blocks of size 2^( 7) =       0.000421260437

      target function =                  N/A
              le_mean =     -17.216460362188
             les_mean =     296.718686473170
             stat err =       0.000417205443
             autocorr =       1.163555532622
              std dev =       0.546979948883
             le_variance =       0.299187064480


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721646036219e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+28, overlap shift 6.1035e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216460362233       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216460362233       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+29, overlap shift 2.4414e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216460362233       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216460362233       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+29, overlap shift 9.7656e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216460362233       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216460362233       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.390451 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6254e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2571
    reference variance = 0.232625
====================================================
  Execution time = 1.3566e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1055e-01
  Total weights = 1.9565e+06
  Execution time = 1.8299e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297619385541
                                         uncertainty =       0.002363776378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297619385541
                                         uncertainty =       0.002363776378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385741258
  error estimate for blocks of size 2^( 2) =       0.000395172219
  error estimate for blocks of size 2^( 3) =       0.000403888681
  error estimate for blocks of size 2^( 4) =       0.000410544493
  error estimate for blocks of size 2^( 5) =       0.000414623508
  error estimate for blocks of size 2^( 6) =       0.000418132078
  error estimate for blocks of size 2^( 7) =       0.000420658078

      target function =                  N/A
              le_mean =     -17.216349633143
             les_mean =     296.713244395797
             stat err =       0.000415989539
             autocorr =       1.162981038250
              std dev =       0.545520518681
             le_variance =       0.297592636301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297619385541
                                         uncertainty =       0.002363776378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297619385541
                                         uncertainty =       0.002363776378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385741258
  error estimate for blocks of size 2^( 2) =       0.000395172219
  error estimate for blocks of size 2^( 3) =       0.000403888681
  error estimate for blocks of size 2^( 4) =       0.000410544493
  error estimate for blocks of size 2^( 5) =       0.000414623508
  error estimate for blocks of size 2^( 6) =       0.000418132078
  error estimate for blocks of size 2^( 7) =       0.000420658078

      target function =                  N/A
              le_mean =     -17.216349633143
             les_mean =     296.713244395797
             stat err =       0.000415989539
             autocorr =       1.162981038250
              std dev =       0.545520518681
             le_variance =       0.297592636301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297619385541
                                         uncertainty =       0.002363776378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297619385541
                                         uncertainty =       0.002363776378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385741258
  error estimate for blocks of size 2^( 2) =       0.000395172219
  error estimate for blocks of size 2^( 3) =       0.000403888681
  error estimate for blocks of size 2^( 4) =       0.000410544493
  error estimate for blocks of size 2^( 5) =       0.000414623508
  error estimate for blocks of size 2^( 6) =       0.000418132078
  error estimate for blocks of size 2^( 7) =       0.000420658078

      target function =                  N/A
              le_mean =     -17.216349633143
             les_mean =     296.713244395797
             stat err =       0.000415989539
             autocorr =       1.162981038250
              std dev =       0.545520518681
             le_variance =       0.297592636301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297619385541
                                         uncertainty =       0.002363776378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297619385541
                                         uncertainty =       0.002363776378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385741258
  error estimate for blocks of size 2^( 2) =       0.000395172219
  error estimate for blocks of size 2^( 3) =       0.000403888681
  error estimate for blocks of size 2^( 4) =       0.000410544493
  error estimate for blocks of size 2^( 5) =       0.000414623508
  error estimate for blocks of size 2^( 6) =       0.000418132078
  error estimate for blocks of size 2^( 7) =       0.000420658078

      target function =                  N/A
              le_mean =     -17.216349633143
             les_mean =     296.713244395797
             stat err =       0.000415989539
             autocorr =       1.162981038250
              std dev =       0.545520518681
             le_variance =       0.297592636301


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216349633143        initial  <--
     6.1035e+28     6.1035e+29             0.0000e+00       -17.216349633143
     2.4414e+29     2.4414e+30             0.0000e+00       -17.216349633143
     9.7656e+29     9.7656e+30             0.0000e+00       -17.216349633143

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7648
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9116e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.2686
    reference variance = 0.172173
====================================================
  Execution time = 1.4644e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1620e-01
  Total weights = 1.956630305e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.9670e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300873026439
                                         uncertainty =       0.001969720224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300873026439
                                         uncertainty =       0.001969720224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387847462
  error estimate for blocks of size 2^( 2) =       0.000398216409
  error estimate for blocks of size 2^( 3) =       0.000407174839
  error estimate for blocks of size 2^( 4) =       0.000414354028
  error estimate for blocks of size 2^( 5) =       0.000418565819
  error estimate for blocks of size 2^( 6) =       0.000421234876
  error estimate for blocks of size 2^( 7) =       0.000422001421

      target function =                  N/A
              le_mean =     -17.217526940394
             les_mean =     296.759435136716
             stat err =       0.000419039036
             autocorr =       1.167312283270
              std dev =       0.548499141487
             le_variance =       0.300851308212


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721752694039e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+29, overlap shift 6.1035e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217526940444       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217526940444       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+30, overlap shift 2.4414e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217526940444       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217526940444       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+30, overlap shift 9.7656e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217526940444       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217526940444       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.391508 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7803e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.1944
    reference variance = 0.201309
====================================================
  Execution time = 1.3258e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1649e-01
  Total weights = 1.9567e+06
  Execution time = 1.8179e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301553553059
                                         uncertainty =       0.002236415496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301553553059
                                         uncertainty =       0.002236415496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388230243
  error estimate for blocks of size 2^( 2) =       0.000397893611
  error estimate for blocks of size 2^( 3) =       0.000407078080
  error estimate for blocks of size 2^( 4) =       0.000414103285
  error estimate for blocks of size 2^( 5) =       0.000418110495
  error estimate for blocks of size 2^( 6) =       0.000420211137
  error estimate for blocks of size 2^( 7) =       0.000420708529

      target function =                  N/A
              le_mean =     -17.216076935953
             les_mean =     296.709796887688
             stat err =       0.000418283361
             autocorr =       1.160813501146
              std dev =       0.549040475355
             le_variance =       0.301445443578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301553553059
                                         uncertainty =       0.002236415496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301553553059
                                         uncertainty =       0.002236415496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388230243
  error estimate for blocks of size 2^( 2) =       0.000397893611
  error estimate for blocks of size 2^( 3) =       0.000407078080
  error estimate for blocks of size 2^( 4) =       0.000414103285
  error estimate for blocks of size 2^( 5) =       0.000418110495
  error estimate for blocks of size 2^( 6) =       0.000420211137
  error estimate for blocks of size 2^( 7) =       0.000420708529

      target function =                  N/A
              le_mean =     -17.216076935953
             les_mean =     296.709796887688
             stat err =       0.000418283361
             autocorr =       1.160813501146
              std dev =       0.549040475355
             le_variance =       0.301445443578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301553553059
                                         uncertainty =       0.002236415496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301553553059
                                         uncertainty =       0.002236415496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388230243
  error estimate for blocks of size 2^( 2) =       0.000397893611
  error estimate for blocks of size 2^( 3) =       0.000407078080
  error estimate for blocks of size 2^( 4) =       0.000414103285
  error estimate for blocks of size 2^( 5) =       0.000418110495
  error estimate for blocks of size 2^( 6) =       0.000420211137
  error estimate for blocks of size 2^( 7) =       0.000420708529

      target function =                  N/A
              le_mean =     -17.216076935953
             les_mean =     296.709796887688
             stat err =       0.000418283361
             autocorr =       1.160813501146
              std dev =       0.549040475355
             le_variance =       0.301445443578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301553553059
                                         uncertainty =       0.002236415496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301553553059
                                         uncertainty =       0.002236415496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388230243
  error estimate for blocks of size 2^( 2) =       0.000397893611
  error estimate for blocks of size 2^( 3) =       0.000407078080
  error estimate for blocks of size 2^( 4) =       0.000414103285
  error estimate for blocks of size 2^( 5) =       0.000418110495
  error estimate for blocks of size 2^( 6) =       0.000420211137
  error estimate for blocks of size 2^( 7) =       0.000420708529

      target function =                  N/A
              le_mean =     -17.216076935953
             les_mean =     296.709796887688
             stat err =       0.000418283361
             autocorr =       1.160813501146
              std dev =       0.549040475355
             le_variance =       0.301445443578


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216076935953        initial  <--
     6.1035e+29     6.1035e+30             0.0000e+00       -17.216076935953
     2.4414e+30     2.4414e+31             0.0000e+00       -17.216076935953
     9.7656e+30     9.7656e+31             0.0000e+00       -17.216076935953

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.4374
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0251e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2106
    reference variance = 0.37847
====================================================
  Execution time = 1.3819e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1517e-01
  Total weights = 1.956786202e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4625e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301406163416
                                         uncertainty =       0.002595534549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301406163416
                                         uncertainty =       0.002595534549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388169728
  error estimate for blocks of size 2^( 2) =       0.000398267553
  error estimate for blocks of size 2^( 3) =       0.000407374977
  error estimate for blocks of size 2^( 4) =       0.000414081265
  error estimate for blocks of size 2^( 5) =       0.000418680568
  error estimate for blocks of size 2^( 6) =       0.000421120719
  error estimate for blocks of size 2^( 7) =       0.000423529726

      target function =                  N/A
              le_mean =     -17.215746991829
             les_mean =     296.697118411938
             stat err =       0.000419353070
             autocorr =       1.167122188194
              std dev =       0.548954894209
             le_variance =       0.301351475876


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721574699183e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+30, overlap shift 6.1035e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215746991866       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215746991866       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+31, overlap shift 2.4414e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215746991866       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215746991866       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+31, overlap shift 9.7656e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215746991866       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215746991866       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.392592 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6286e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2463
    reference variance = 0.256926
====================================================
  Execution time = 1.3390e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2117e-01
  Total weights = 1.9566e+06
  Execution time = 1.8149e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306956482186
                                         uncertainty =       0.002544792918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306956482186
                                         uncertainty =       0.002544792918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391744479
  error estimate for blocks of size 2^( 2) =       0.000401573133
  error estimate for blocks of size 2^( 3) =       0.000410613489
  error estimate for blocks of size 2^( 4) =       0.000417084285
  error estimate for blocks of size 2^( 5) =       0.000421102344
  error estimate for blocks of size 2^( 6) =       0.000424201261
  error estimate for blocks of size 2^( 7) =       0.000423544597

      target function =                  N/A
              le_mean =     -17.215953177841
             les_mean =     296.710217924252
             stat err =       0.000421483122
             autocorr =       1.157589578028
              std dev =       0.554010354711
             le_variance =       0.306927473127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306956482186
                                         uncertainty =       0.002544792918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306956482186
                                         uncertainty =       0.002544792918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391744479
  error estimate for blocks of size 2^( 2) =       0.000401573133
  error estimate for blocks of size 2^( 3) =       0.000410613489
  error estimate for blocks of size 2^( 4) =       0.000417084285
  error estimate for blocks of size 2^( 5) =       0.000421102344
  error estimate for blocks of size 2^( 6) =       0.000424201261
  error estimate for blocks of size 2^( 7) =       0.000423544597

      target function =                  N/A
              le_mean =     -17.215953177841
             les_mean =     296.710217924252
             stat err =       0.000421483122
             autocorr =       1.157589578028
              std dev =       0.554010354711
             le_variance =       0.306927473127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306956482186
                                         uncertainty =       0.002544792918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306956482186
                                         uncertainty =       0.002544792918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391744479
  error estimate for blocks of size 2^( 2) =       0.000401573133
  error estimate for blocks of size 2^( 3) =       0.000410613489
  error estimate for blocks of size 2^( 4) =       0.000417084285
  error estimate for blocks of size 2^( 5) =       0.000421102344
  error estimate for blocks of size 2^( 6) =       0.000424201261
  error estimate for blocks of size 2^( 7) =       0.000423544597

      target function =                  N/A
              le_mean =     -17.215953177841
             les_mean =     296.710217924252
             stat err =       0.000421483122
             autocorr =       1.157589578028
              std dev =       0.554010354711
             le_variance =       0.306927473127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306956482186
                                         uncertainty =       0.002544792918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306956482186
                                         uncertainty =       0.002544792918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391744479
  error estimate for blocks of size 2^( 2) =       0.000401573133
  error estimate for blocks of size 2^( 3) =       0.000410613489
  error estimate for blocks of size 2^( 4) =       0.000417084285
  error estimate for blocks of size 2^( 5) =       0.000421102344
  error estimate for blocks of size 2^( 6) =       0.000424201261
  error estimate for blocks of size 2^( 7) =       0.000423544597

      target function =                  N/A
              le_mean =     -17.215953177841
             les_mean =     296.710217924252
             stat err =       0.000421483122
             autocorr =       1.157589578028
              std dev =       0.554010354711
             le_variance =       0.306927473127


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215953177841        initial  <--
     6.1035e+30     6.1035e+31             0.0000e+00       -17.215953177841
     2.4414e+31     2.4414e+32             0.0000e+00       -17.215953177841
     9.7656e+31     9.7656e+32             0.0000e+00       -17.215953177841

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5462
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8913e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.1225
    reference variance = 0.311442
====================================================
  Execution time = 1.3781e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1439e-01
  Total weights = 1.956662184e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4650e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299431162659
                                         uncertainty =       0.002416386555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299431162659
                                         uncertainty =       0.002416386555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386982525
  error estimate for blocks of size 2^( 2) =       0.000396833276
  error estimate for blocks of size 2^( 3) =       0.000406389802
  error estimate for blocks of size 2^( 4) =       0.000413480062
  error estimate for blocks of size 2^( 5) =       0.000418433437
  error estimate for blocks of size 2^( 6) =       0.000418919092
  error estimate for blocks of size 2^( 7) =       0.000420713562

      target function =                  N/A
              le_mean =     -17.217049210122
             les_mean =     296.741174848283
             stat err =       0.000417886539
             autocorr =       1.166095326765
              std dev =       0.547275935225
             le_variance =       0.299510949277


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721704921012e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+31, overlap shift 6.1035e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217049210160       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217049210160       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+32, overlap shift 2.4414e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217049210160       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217049210160       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+32, overlap shift 9.7656e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217049210160       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217049210160       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.393616 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6251e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2361
    reference variance = 0.205491
====================================================
  Execution time = 1.3116e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1924e-01
  Total weights = 1.9567e+06
  Execution time = 1.8148e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301061295304
                                         uncertainty =       0.002566956316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301061295304
                                         uncertainty =       0.002566956316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387996977
  error estimate for blocks of size 2^( 2) =       0.000398000170
  error estimate for blocks of size 2^( 3) =       0.000407187002
  error estimate for blocks of size 2^( 4) =       0.000414161565
  error estimate for blocks of size 2^( 5) =       0.000419015951
  error estimate for blocks of size 2^( 6) =       0.000420706507
  error estimate for blocks of size 2^( 7) =       0.000420699016

      target function =                  N/A
              le_mean =     -17.216450562495
             les_mean =     296.725411976904
             stat err =       0.000418645760
             autocorr =       1.164224435767
              std dev =       0.548710586751
             le_variance =       0.301083308012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301061295304
                                         uncertainty =       0.002566956316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301061295304
                                         uncertainty =       0.002566956316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387996977
  error estimate for blocks of size 2^( 2) =       0.000398000170
  error estimate for blocks of size 2^( 3) =       0.000407187002
  error estimate for blocks of size 2^( 4) =       0.000414161565
  error estimate for blocks of size 2^( 5) =       0.000419015951
  error estimate for blocks of size 2^( 6) =       0.000420706507
  error estimate for blocks of size 2^( 7) =       0.000420699016

      target function =                  N/A
              le_mean =     -17.216450562495
             les_mean =     296.725411976904
             stat err =       0.000418645760
             autocorr =       1.164224435767
              std dev =       0.548710586751
             le_variance =       0.301083308012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301061295304
                                         uncertainty =       0.002566956316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301061295304
                                         uncertainty =       0.002566956316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387996977
  error estimate for blocks of size 2^( 2) =       0.000398000170
  error estimate for blocks of size 2^( 3) =       0.000407187002
  error estimate for blocks of size 2^( 4) =       0.000414161565
  error estimate for blocks of size 2^( 5) =       0.000419015951
  error estimate for blocks of size 2^( 6) =       0.000420706507
  error estimate for blocks of size 2^( 7) =       0.000420699016

      target function =                  N/A
              le_mean =     -17.216450562495
             les_mean =     296.725411976904
             stat err =       0.000418645760
             autocorr =       1.164224435767
              std dev =       0.548710586751
             le_variance =       0.301083308012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301061295304
                                         uncertainty =       0.002566956316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301061295304
                                         uncertainty =       0.002566956316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387996977
  error estimate for blocks of size 2^( 2) =       0.000398000170
  error estimate for blocks of size 2^( 3) =       0.000407187002
  error estimate for blocks of size 2^( 4) =       0.000414161565
  error estimate for blocks of size 2^( 5) =       0.000419015951
  error estimate for blocks of size 2^( 6) =       0.000420706507
  error estimate for blocks of size 2^( 7) =       0.000420699016

      target function =                  N/A
              le_mean =     -17.216450562495
             les_mean =     296.725411976904
             stat err =       0.000418645760
             autocorr =       1.164224435767
              std dev =       0.548710586751
             le_variance =       0.301083308012


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216450562495        initial  <--
     6.1035e+31     6.1035e+32             0.0000e+00       -17.216450562495
     2.4414e+32     2.4414e+33             0.0000e+00       -17.216450562495
     9.7656e+32     9.7656e+33             0.0000e+00       -17.216450562495

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.3174
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8577e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2415
    reference variance = 0.183345
====================================================
  Execution time = 1.3445e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1787e-01
  Total weights = 1.956484448e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4690e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301921481730
                                         uncertainty =       0.002737934551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301921481730
                                         uncertainty =       0.002737934551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388476832
  error estimate for blocks of size 2^( 2) =       0.000397929498
  error estimate for blocks of size 2^( 3) =       0.000407076174
  error estimate for blocks of size 2^( 4) =       0.000413769786
  error estimate for blocks of size 2^( 5) =       0.000418864682
  error estimate for blocks of size 2^( 6) =       0.000419273412
  error estimate for blocks of size 2^( 7) =       0.000422129456

      target function =                  N/A
              le_mean =     -17.216464541971
             les_mean =     296.724525779296
             stat err =       0.000418509334
             autocorr =       1.160593277665
              std dev =       0.549389203857
             le_variance =       0.301828497314


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721646454197e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+32, overlap shift 6.1035e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216464541987       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216464541987       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216464541987       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216464541852       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+32 is 5.089585e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+33, overlap shift 2.4414e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216464541987       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216464541987       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216464541987       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216464549303       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216464549303       residual = 5.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+33 is 1.272396e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+33, overlap shift 9.7656e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216464541987       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216464541987       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216464541987       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216464549303       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216464519501       residual = 5.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+33 is 3.180991e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.395440 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.5919e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2637
    reference variance = 0.191848
====================================================
  Execution time = 1.3331e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1493e-01
  Total weights = 1.9566e+06
  Execution time = 1.8217e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301517980970
                                         uncertainty =       0.002336596890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301517980970
                                         uncertainty =       0.002336596890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388211653
  error estimate for blocks of size 2^( 2) =       0.000398313042
  error estimate for blocks of size 2^( 3) =       0.000407540336
  error estimate for blocks of size 2^( 4) =       0.000413777042
  error estimate for blocks of size 2^( 5) =       0.000417351015
  error estimate for blocks of size 2^( 6) =       0.000421035420
  error estimate for blocks of size 2^( 7) =       0.000425140885

      target function =                  N/A
              le_mean =     -17.216191058422
             les_mean =     296.712163106583
             stat err =       0.000419326090
             autocorr =       1.166719980937
              std dev =       0.549014184458
             le_variance =       0.301416574736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301517980970
                                         uncertainty =       0.002336596890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301517980970
                                         uncertainty =       0.002336596890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388211653
  error estimate for blocks of size 2^( 2) =       0.000398313042
  error estimate for blocks of size 2^( 3) =       0.000407540336
  error estimate for blocks of size 2^( 4) =       0.000413777042
  error estimate for blocks of size 2^( 5) =       0.000417351015
  error estimate for blocks of size 2^( 6) =       0.000421035420
  error estimate for blocks of size 2^( 7) =       0.000425140885

      target function =                  N/A
              le_mean =     -17.216191058422
             les_mean =     296.712163106583
             stat err =       0.000419326090
             autocorr =       1.166719980937
              std dev =       0.549014184458
             le_variance =       0.301416574736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301517980970
                                         uncertainty =       0.002336596890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301517980970
                                         uncertainty =       0.002336596890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388211653
  error estimate for blocks of size 2^( 2) =       0.000398313042
  error estimate for blocks of size 2^( 3) =       0.000407540336
  error estimate for blocks of size 2^( 4) =       0.000413777042
  error estimate for blocks of size 2^( 5) =       0.000417351015
  error estimate for blocks of size 2^( 6) =       0.000421035420
  error estimate for blocks of size 2^( 7) =       0.000425140885

      target function =                  N/A
              le_mean =     -17.216191058422
             les_mean =     296.712163106583
             stat err =       0.000419326090
             autocorr =       1.166719980937
              std dev =       0.549014184458
             le_variance =       0.301416574736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301517980970
                                         uncertainty =       0.002336596890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301517980970
                                         uncertainty =       0.002336596890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388211653
  error estimate for blocks of size 2^( 2) =       0.000398313042
  error estimate for blocks of size 2^( 3) =       0.000407540336
  error estimate for blocks of size 2^( 4) =       0.000413777042
  error estimate for blocks of size 2^( 5) =       0.000417351015
  error estimate for blocks of size 2^( 6) =       0.000421035420
  error estimate for blocks of size 2^( 7) =       0.000425140885

      target function =                  N/A
              le_mean =     -17.216191058422
             les_mean =     296.712163106583
             stat err =       0.000419326090
             autocorr =       1.166719980937
              std dev =       0.549014184458
             le_variance =       0.301416574736


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216191058422        initial  <--
     6.1035e+32     6.1035e+33             5.0896e-37       -17.216191058422
     2.4414e+33     2.4414e+34             1.2724e-37       -17.216191058422
     9.7656e+33     9.7656e+34             3.1810e-38       -17.216191058422

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5524
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8592e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2271
    reference variance = 0.267339
====================================================
  Execution time = 1.3617e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1621e-01
  Total weights = 1.956753754e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301880088676
                                         uncertainty =       0.002735059820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301880088676
                                         uncertainty =       0.002735059820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388482305
  error estimate for blocks of size 2^( 2) =       0.000398220204
  error estimate for blocks of size 2^( 3) =       0.000406821977
  error estimate for blocks of size 2^( 4) =       0.000413797728
  error estimate for blocks of size 2^( 5) =       0.000418036803
  error estimate for blocks of size 2^( 6) =       0.000420688025
  error estimate for blocks of size 2^( 7) =       0.000420351469

      target function =                  N/A
              le_mean =     -17.216328942158
             les_mean =     296.718193383383
             stat err =       0.000418218506
             autocorr =       1.158948154480
              std dev =       0.549396945102
             le_variance =       0.301837003287


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721632894216e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+33, overlap shift 6.1035e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216328942208       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216328942208       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+34, overlap shift 2.4414e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216328942208       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216328942208       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+34, overlap shift 9.7656e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216328942208       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216328942208       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.396518 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6096e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.231
    reference variance = 0.239895
====================================================
  Execution time = 1.3506e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1614e-01
  Total weights = 1.9564e+06
  Execution time = 1.8151e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301407688220
                                         uncertainty =       0.002117063318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301407688220
                                         uncertainty =       0.002117063318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388339741
  error estimate for blocks of size 2^( 2) =       0.000398296757
  error estimate for blocks of size 2^( 3) =       0.000407070573
  error estimate for blocks of size 2^( 4) =       0.000412958065
  error estimate for blocks of size 2^( 5) =       0.000416762299
  error estimate for blocks of size 2^( 6) =       0.000418799409
  error estimate for blocks of size 2^( 7) =       0.000420170834

      target function =                  N/A
              le_mean =     -17.216965364204
             les_mean =     296.740031670020
             stat err =       0.000417172652
             autocorr =       1.154005790386
              std dev =       0.549195328021
             le_variance =       0.301615508321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301407688220
                                         uncertainty =       0.002117063318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301407688220
                                         uncertainty =       0.002117063318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388339741
  error estimate for blocks of size 2^( 2) =       0.000398296757
  error estimate for blocks of size 2^( 3) =       0.000407070573
  error estimate for blocks of size 2^( 4) =       0.000412958065
  error estimate for blocks of size 2^( 5) =       0.000416762299
  error estimate for blocks of size 2^( 6) =       0.000418799409
  error estimate for blocks of size 2^( 7) =       0.000420170834

      target function =                  N/A
              le_mean =     -17.216965364204
             les_mean =     296.740031670020
             stat err =       0.000417172652
             autocorr =       1.154005790386
              std dev =       0.549195328021
             le_variance =       0.301615508321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301407688220
                                         uncertainty =       0.002117063318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301407688220
                                         uncertainty =       0.002117063318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388339741
  error estimate for blocks of size 2^( 2) =       0.000398296757
  error estimate for blocks of size 2^( 3) =       0.000407070573
  error estimate for blocks of size 2^( 4) =       0.000412958065
  error estimate for blocks of size 2^( 5) =       0.000416762299
  error estimate for blocks of size 2^( 6) =       0.000418799409
  error estimate for blocks of size 2^( 7) =       0.000420170834

      target function =                  N/A
              le_mean =     -17.216965364204
             les_mean =     296.740031670020
             stat err =       0.000417172652
             autocorr =       1.154005790386
              std dev =       0.549195328021
             le_variance =       0.301615508321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301407688220
                                         uncertainty =       0.002117063318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301407688220
                                         uncertainty =       0.002117063318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388339741
  error estimate for blocks of size 2^( 2) =       0.000398296757
  error estimate for blocks of size 2^( 3) =       0.000407070573
  error estimate for blocks of size 2^( 4) =       0.000412958065
  error estimate for blocks of size 2^( 5) =       0.000416762299
  error estimate for blocks of size 2^( 6) =       0.000418799409
  error estimate for blocks of size 2^( 7) =       0.000420170834

      target function =                  N/A
              le_mean =     -17.216965364204
             les_mean =     296.740031670020
             stat err =       0.000417172652
             autocorr =       1.154005790386
              std dev =       0.549195328021
             le_variance =       0.301615508321


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216965364204        initial  <--
     6.1035e+33     6.1035e+34             0.0000e+00       -17.216965364204
     2.4414e+34     2.4414e+35             0.0000e+00       -17.216965364204
     9.7656e+34     9.7656e+35             0.0000e+00       -17.216965364204

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6662
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8769e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.1899
    reference variance = 0.339695
====================================================
  Execution time = 1.3526e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1302e-01
  Total weights = 1.956628360e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4862e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296886693373
                                         uncertainty =       0.001819066927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296886693373
                                         uncertainty =       0.001819066927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385239128
  error estimate for blocks of size 2^( 2) =       0.000395427409
  error estimate for blocks of size 2^( 3) =       0.000405054962
  error estimate for blocks of size 2^( 4) =       0.000411899773
  error estimate for blocks of size 2^( 5) =       0.000415401536
  error estimate for blocks of size 2^( 6) =       0.000418240053
  error estimate for blocks of size 2^( 7) =       0.000418607199

      target function =                  N/A
              le_mean =     -17.216121460872
             les_mean =     296.707857454381
             stat err =       0.000416037140
             autocorr =       1.166281599005
              std dev =       0.544810399100
             le_variance =       0.296818370967


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721612146087e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+34, overlap shift 6.1035e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216121460878       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216121460878       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+35, overlap shift 2.4414e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216121460878       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216121460878       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+35, overlap shift 9.7656e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216121460878       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216121460878       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.397561 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6017e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2777
    reference variance = 0.421568
====================================================
  Execution time = 1.3287e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1282e-01
  Total weights = 1.9567e+06
  Execution time = 1.8207e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297487184864
                                         uncertainty =       0.002170684963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297487184864
                                         uncertainty =       0.002170684963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385713869
  error estimate for blocks of size 2^( 2) =       0.000395372753
  error estimate for blocks of size 2^( 3) =       0.000404575656
  error estimate for blocks of size 2^( 4) =       0.000411214158
  error estimate for blocks of size 2^( 5) =       0.000415677997
  error estimate for blocks of size 2^( 6) =       0.000417386113
  error estimate for blocks of size 2^( 7) =       0.000420514452

      target function =                  N/A
              le_mean =     -17.216072207491
             les_mean =     296.705966058943
             stat err =       0.000416198180
             autocorr =       1.164313258166
              std dev =       0.545481785162
             le_variance =       0.297550377943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297487184864
                                         uncertainty =       0.002170684963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297487184864
                                         uncertainty =       0.002170684963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385713869
  error estimate for blocks of size 2^( 2) =       0.000395372753
  error estimate for blocks of size 2^( 3) =       0.000404575656
  error estimate for blocks of size 2^( 4) =       0.000411214158
  error estimate for blocks of size 2^( 5) =       0.000415677997
  error estimate for blocks of size 2^( 6) =       0.000417386113
  error estimate for blocks of size 2^( 7) =       0.000420514452

      target function =                  N/A
              le_mean =     -17.216072207491
             les_mean =     296.705966058943
             stat err =       0.000416198180
             autocorr =       1.164313258166
              std dev =       0.545481785162
             le_variance =       0.297550377943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297487184864
                                         uncertainty =       0.002170684963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297487184864
                                         uncertainty =       0.002170684963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385713869
  error estimate for blocks of size 2^( 2) =       0.000395372753
  error estimate for blocks of size 2^( 3) =       0.000404575656
  error estimate for blocks of size 2^( 4) =       0.000411214158
  error estimate for blocks of size 2^( 5) =       0.000415677997
  error estimate for blocks of size 2^( 6) =       0.000417386113
  error estimate for blocks of size 2^( 7) =       0.000420514452

      target function =                  N/A
              le_mean =     -17.216072207491
             les_mean =     296.705966058943
             stat err =       0.000416198180
             autocorr =       1.164313258166
              std dev =       0.545481785162
             le_variance =       0.297550377943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297487184864
                                         uncertainty =       0.002170684963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297487184864
                                         uncertainty =       0.002170684963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385713869
  error estimate for blocks of size 2^( 2) =       0.000395372753
  error estimate for blocks of size 2^( 3) =       0.000404575656
  error estimate for blocks of size 2^( 4) =       0.000411214158
  error estimate for blocks of size 2^( 5) =       0.000415677997
  error estimate for blocks of size 2^( 6) =       0.000417386113
  error estimate for blocks of size 2^( 7) =       0.000420514452

      target function =                  N/A
              le_mean =     -17.216072207491
             les_mean =     296.705966058943
             stat err =       0.000416198180
             autocorr =       1.164313258166
              std dev =       0.545481785162
             le_variance =       0.297550377943


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216072207491        initial  <--
     6.1035e+34     6.1035e+35             0.0000e+00       -17.216072207491
     2.4414e+35     2.4414e+36             0.0000e+00       -17.216072207491
     9.7656e+35     9.7656e+36             0.0000e+00       -17.216072207491

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.4611
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8519e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2708
    reference variance = 0.291305
====================================================
  Execution time = 1.3625e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1643e-01
  Total weights = 1.956581445e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4781e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302631886726
                                         uncertainty =       0.001940902115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302631886726
                                         uncertainty =       0.001940902115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388953724
  error estimate for blocks of size 2^( 2) =       0.000399059763
  error estimate for blocks of size 2^( 3) =       0.000407846177
  error estimate for blocks of size 2^( 4) =       0.000414830071
  error estimate for blocks of size 2^( 5) =       0.000418797744
  error estimate for blocks of size 2^( 6) =       0.000421011155
  error estimate for blocks of size 2^( 7) =       0.000421867875

      target function =                  N/A
              le_mean =     -17.216431701402
             les_mean =     296.721947508739
             stat err =       0.000419126712
             autocorr =       1.161167341056
              std dev =       0.550063631325
             le_variance =       0.302569998506


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721643170140e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+35, overlap shift 6.1035e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216431701464       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216431701464       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+36, overlap shift 2.4414e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216431701464       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216431701464       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+36, overlap shift 9.7656e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216431701464       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216431701464       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.398625 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6112e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2798
    reference variance = 0.233646
====================================================
  Execution time = 1.3363e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1103e-01
  Total weights = 1.9572e+06
  Execution time = 1.8163e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296223868929
                                         uncertainty =       0.001675714073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296223868929
                                         uncertainty =       0.001675714073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384816555
  error estimate for blocks of size 2^( 2) =       0.000395054818
  error estimate for blocks of size 2^( 3) =       0.000403901550
  error estimate for blocks of size 2^( 4) =       0.000411125295
  error estimate for blocks of size 2^( 5) =       0.000415235942
  error estimate for blocks of size 2^( 6) =       0.000418052591
  error estimate for blocks of size 2^( 7) =       0.000418823927

      target function =                  N/A
              le_mean =     -17.216934817377
             les_mean =     296.733869630098
             stat err =       0.000415809439
             autocorr =       1.167565332367
              std dev =       0.544212791634
             le_variance =       0.296167562578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296223868929
                                         uncertainty =       0.001675714073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296223868929
                                         uncertainty =       0.001675714073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384816555
  error estimate for blocks of size 2^( 2) =       0.000395054818
  error estimate for blocks of size 2^( 3) =       0.000403901550
  error estimate for blocks of size 2^( 4) =       0.000411125295
  error estimate for blocks of size 2^( 5) =       0.000415235942
  error estimate for blocks of size 2^( 6) =       0.000418052591
  error estimate for blocks of size 2^( 7) =       0.000418823927

      target function =                  N/A
              le_mean =     -17.216934817377
             les_mean =     296.733869630098
             stat err =       0.000415809439
             autocorr =       1.167565332367
              std dev =       0.544212791634
             le_variance =       0.296167562578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296223868929
                                         uncertainty =       0.001675714073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296223868929
                                         uncertainty =       0.001675714073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384816555
  error estimate for blocks of size 2^( 2) =       0.000395054818
  error estimate for blocks of size 2^( 3) =       0.000403901550
  error estimate for blocks of size 2^( 4) =       0.000411125295
  error estimate for blocks of size 2^( 5) =       0.000415235942
  error estimate for blocks of size 2^( 6) =       0.000418052591
  error estimate for blocks of size 2^( 7) =       0.000418823927

      target function =                  N/A
              le_mean =     -17.216934817377
             les_mean =     296.733869630098
             stat err =       0.000415809439
             autocorr =       1.167565332367
              std dev =       0.544212791634
             le_variance =       0.296167562578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296223868929
                                         uncertainty =       0.001675714073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296223868929
                                         uncertainty =       0.001675714073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384816555
  error estimate for blocks of size 2^( 2) =       0.000395054818
  error estimate for blocks of size 2^( 3) =       0.000403901550
  error estimate for blocks of size 2^( 4) =       0.000411125295
  error estimate for blocks of size 2^( 5) =       0.000415235942
  error estimate for blocks of size 2^( 6) =       0.000418052591
  error estimate for blocks of size 2^( 7) =       0.000418823927

      target function =                  N/A
              le_mean =     -17.216934817377
             les_mean =     296.733869630098
             stat err =       0.000415809439
             autocorr =       1.167565332367
              std dev =       0.544212791634
             le_variance =       0.296167562578


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216934817377        initial  <--
     6.1035e+35     6.1035e+36             0.0000e+00       -17.216934817377
     2.4414e+36     2.4414e+37             0.0000e+00       -17.216934817377
     9.7656e+36     9.7656e+37             0.0000e+00       -17.216934817377

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5166
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8662e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2428
    reference variance = 0.255158
====================================================
  Execution time = 1.3863e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1574e-01
  Total weights = 1.957001393e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4733e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301277154059
                                         uncertainty =       0.002321224289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301277154059
                                         uncertainty =       0.002321224289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388117359
  error estimate for blocks of size 2^( 2) =       0.000398004508
  error estimate for blocks of size 2^( 3) =       0.000406925340
  error estimate for blocks of size 2^( 4) =       0.000413678009
  error estimate for blocks of size 2^( 5) =       0.000418684175
  error estimate for blocks of size 2^( 6) =       0.000420453316
  error estimate for blocks of size 2^( 7) =       0.000423171981

      target function =                  N/A
              le_mean =     -17.216940324430
             les_mean =     296.738774569414
             stat err =       0.000418996870
             autocorr =       1.165454765178
              std dev =       0.548880833411
             le_variance =       0.301270169286


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721694032443e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+36, overlap shift 6.1035e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216940324474       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216940324474       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+37, overlap shift 2.4414e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216940324474       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216940324474       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+37, overlap shift 9.7656e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216940324474       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216940324474       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.399630 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6341e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2296
    reference variance = 0.130909
====================================================
  Execution time = 1.3339e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1754e-01
  Total weights = 1.9564e+06
  Execution time = 1.8133e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300967016562
                                         uncertainty =       0.002128471167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300967016562
                                         uncertainty =       0.002128471167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387890211
  error estimate for blocks of size 2^( 2) =       0.000397883452
  error estimate for blocks of size 2^( 3) =       0.000406646629
  error estimate for blocks of size 2^( 4) =       0.000413639026
  error estimate for blocks of size 2^( 5) =       0.000418907029
  error estimate for blocks of size 2^( 6) =       0.000421472295
  error estimate for blocks of size 2^( 7) =       0.000422867920

      target function =                  N/A
              le_mean =     -17.216773302764
             les_mean =     296.734826946358
             stat err =       0.000419221567
             autocorr =       1.168071951558
              std dev =       0.548559597089
             le_variance =       0.300917631559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300967016562
                                         uncertainty =       0.002128471167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300967016562
                                         uncertainty =       0.002128471167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387890211
  error estimate for blocks of size 2^( 2) =       0.000397883452
  error estimate for blocks of size 2^( 3) =       0.000406646629
  error estimate for blocks of size 2^( 4) =       0.000413639026
  error estimate for blocks of size 2^( 5) =       0.000418907029
  error estimate for blocks of size 2^( 6) =       0.000421472295
  error estimate for blocks of size 2^( 7) =       0.000422867920

      target function =                  N/A
              le_mean =     -17.216773302764
             les_mean =     296.734826946358
             stat err =       0.000419221567
             autocorr =       1.168071951558
              std dev =       0.548559597089
             le_variance =       0.300917631559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300967016562
                                         uncertainty =       0.002128471167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300967016562
                                         uncertainty =       0.002128471167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387890211
  error estimate for blocks of size 2^( 2) =       0.000397883452
  error estimate for blocks of size 2^( 3) =       0.000406646629
  error estimate for blocks of size 2^( 4) =       0.000413639026
  error estimate for blocks of size 2^( 5) =       0.000418907029
  error estimate for blocks of size 2^( 6) =       0.000421472295
  error estimate for blocks of size 2^( 7) =       0.000422867920

      target function =                  N/A
              le_mean =     -17.216773302764
             les_mean =     296.734826946358
             stat err =       0.000419221567
             autocorr =       1.168071951558
              std dev =       0.548559597089
             le_variance =       0.300917631559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300967016562
                                         uncertainty =       0.002128471167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300967016562
                                         uncertainty =       0.002128471167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387890211
  error estimate for blocks of size 2^( 2) =       0.000397883452
  error estimate for blocks of size 2^( 3) =       0.000406646629
  error estimate for blocks of size 2^( 4) =       0.000413639026
  error estimate for blocks of size 2^( 5) =       0.000418907029
  error estimate for blocks of size 2^( 6) =       0.000421472295
  error estimate for blocks of size 2^( 7) =       0.000422867920

      target function =                  N/A
              le_mean =     -17.216773302764
             les_mean =     296.734826946358
             stat err =       0.000419221567
             autocorr =       1.168071951558
              std dev =       0.548559597089
             le_variance =       0.300917631559


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216773302764        initial  <--
     6.1035e+36     6.1035e+37             0.0000e+00       -17.216773302764
     2.4414e+37     2.4414e+38             0.0000e+00       -17.216773302764
     9.7656e+37     9.7656e+38             0.0000e+00       -17.216773302764

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.4768
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8827e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2696
    reference variance = 0.229892
====================================================
  Execution time = 1.6177e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1240e-01
  Total weights = 1.956768567e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4843e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300576100515
                                         uncertainty =       0.002035232284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300576100515
                                         uncertainty =       0.002035232284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387668734
  error estimate for blocks of size 2^( 2) =       0.000397616622
  error estimate for blocks of size 2^( 3) =       0.000406986674
  error estimate for blocks of size 2^( 4) =       0.000412818336
  error estimate for blocks of size 2^( 5) =       0.000416976071
  error estimate for blocks of size 2^( 6) =       0.000419542884
  error estimate for blocks of size 2^( 7) =       0.000421133804

      target function =                  N/A
              le_mean =     -17.216834668463
             les_mean =     296.731791784141
             stat err =       0.000417617774
             autocorr =       1.160476622844
              std dev =       0.548246381000
             le_variance =       0.300574094279


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721683466846e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+37, overlap shift 6.1035e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216834668504       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216834668504       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216835021973       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+37 is 4.498866e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+38, overlap shift 2.4414e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216834668504       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216834668504       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216834668504       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+38 is 1.155892e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+38, overlap shift 9.7656e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216834668504       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216834668504       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216835021973       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+38 is 2.811791e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.400939 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8667e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2433
    reference variance = 0.280246
====================================================
  Execution time = 1.3369e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1301e-01
  Total weights = 1.9566e+06
  Execution time = 1.8168e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296577333585
                                         uncertainty =       0.001738577815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296577333585
                                         uncertainty =       0.001738577815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385119448
  error estimate for blocks of size 2^( 2) =       0.000395270541
  error estimate for blocks of size 2^( 3) =       0.000404315779
  error estimate for blocks of size 2^( 4) =       0.000411459714
  error estimate for blocks of size 2^( 5) =       0.000416414880
  error estimate for blocks of size 2^( 6) =       0.000417180812
  error estimate for blocks of size 2^( 7) =       0.000417794009

      target function =                  N/A
              le_mean =     -17.216313305961
             les_mean =     296.714453264171
             stat err =       0.000415712354
             autocorr =       1.165185203282
              std dev =       0.544641146264
             le_variance =       0.296633978204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296577333585
                                         uncertainty =       0.001738577815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296577333585
                                         uncertainty =       0.001738577815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385119448
  error estimate for blocks of size 2^( 2) =       0.000395270541
  error estimate for blocks of size 2^( 3) =       0.000404315779
  error estimate for blocks of size 2^( 4) =       0.000411459714
  error estimate for blocks of size 2^( 5) =       0.000416414880
  error estimate for blocks of size 2^( 6) =       0.000417180812
  error estimate for blocks of size 2^( 7) =       0.000417794009

      target function =                  N/A
              le_mean =     -17.216313305961
             les_mean =     296.714453264171
             stat err =       0.000415712354
             autocorr =       1.165185203282
              std dev =       0.544641146264
             le_variance =       0.296633978204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296577333585
                                         uncertainty =       0.001738577815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296577333585
                                         uncertainty =       0.001738577815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385119448
  error estimate for blocks of size 2^( 2) =       0.000395270541
  error estimate for blocks of size 2^( 3) =       0.000404315779
  error estimate for blocks of size 2^( 4) =       0.000411459714
  error estimate for blocks of size 2^( 5) =       0.000416414880
  error estimate for blocks of size 2^( 6) =       0.000417180812
  error estimate for blocks of size 2^( 7) =       0.000417794009

      target function =                  N/A
              le_mean =     -17.216313305961
             les_mean =     296.714453264171
             stat err =       0.000415712354
             autocorr =       1.165185203282
              std dev =       0.544641146264
             le_variance =       0.296633978204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296577333585
                                         uncertainty =       0.001738577815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296577333585
                                         uncertainty =       0.001738577815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385119448
  error estimate for blocks of size 2^( 2) =       0.000395270541
  error estimate for blocks of size 2^( 3) =       0.000404315779
  error estimate for blocks of size 2^( 4) =       0.000411459714
  error estimate for blocks of size 2^( 5) =       0.000416414880
  error estimate for blocks of size 2^( 6) =       0.000417180812
  error estimate for blocks of size 2^( 7) =       0.000417794009

      target function =                  N/A
              le_mean =     -17.216313305961
             les_mean =     296.714453264171
             stat err =       0.000415712354
             autocorr =       1.165185203282
              std dev =       0.544641146264
             le_variance =       0.296633978204


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216313305961        initial  <--
     6.1035e+37     6.1035e+38             4.4989e-42       -17.216313305961
     2.4414e+38     2.4414e+39             1.1559e-42       -17.216313305961
     9.7656e+38     9.7656e+39             2.8118e-43       -17.216313305961

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5505
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1246e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.2983
    reference variance = 0.232925
====================================================
  Execution time = 1.3627e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1635e-01
  Total weights = 1.956708249e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4955e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302476558338
                                         uncertainty =       0.002608887855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302476558338
                                         uncertainty =       0.002608887855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388919834
  error estimate for blocks of size 2^( 2) =       0.000398920218
  error estimate for blocks of size 2^( 3) =       0.000407944416
  error estimate for blocks of size 2^( 4) =       0.000415247288
  error estimate for blocks of size 2^( 5) =       0.000419206257
  error estimate for blocks of size 2^( 6) =       0.000420808334
  error estimate for blocks of size 2^( 7) =       0.000421880016

      target function =                  N/A
              le_mean =     -17.216991648486
             les_mean =     296.741149115191
             stat err =       0.000419285474
             autocorr =       1.162249717913
              std dev =       0.550015703895
             le_variance =       0.302517274531


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721699164849e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+38, overlap shift 6.1035e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216991648552       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216991648552       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+39, overlap shift 2.4414e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216991648552       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216991648552       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+39 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+39, overlap shift 9.7656e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216991648552       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216991648552       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.401995 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6127e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.2039
    reference variance = 0.360639
====================================================
  Execution time = 1.3160e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1449e-01
  Total weights = 1.9565e+06
  Execution time = 1.8185e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301037797054
                                         uncertainty =       0.002244166994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301037797054
                                         uncertainty =       0.002244166994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388023955
  error estimate for blocks of size 2^( 2) =       0.000397929512
  error estimate for blocks of size 2^( 3) =       0.000406850665
  error estimate for blocks of size 2^( 4) =       0.000414156165
  error estimate for blocks of size 2^( 5) =       0.000417742457
  error estimate for blocks of size 2^( 6) =       0.000420250425
  error estimate for blocks of size 2^( 7) =       0.000423247088

      target function =                  N/A
              le_mean =     -17.216376127418
             les_mean =     296.718091999577
             stat err =       0.000418849034
             autocorr =       1.165193249669
              std dev =       0.548748739839
             le_variance =       0.301125179475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301037797054
                                         uncertainty =       0.002244166994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301037797054
                                         uncertainty =       0.002244166994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388023955
  error estimate for blocks of size 2^( 2) =       0.000397929512
  error estimate for blocks of size 2^( 3) =       0.000406850665
  error estimate for blocks of size 2^( 4) =       0.000414156165
  error estimate for blocks of size 2^( 5) =       0.000417742457
  error estimate for blocks of size 2^( 6) =       0.000420250425
  error estimate for blocks of size 2^( 7) =       0.000423247088

      target function =                  N/A
              le_mean =     -17.216376127418
             les_mean =     296.718091999577
             stat err =       0.000418849034
             autocorr =       1.165193249669
              std dev =       0.548748739839
             le_variance =       0.301125179475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301037797054
                                         uncertainty =       0.002244166994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301037797054
                                         uncertainty =       0.002244166994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388023955
  error estimate for blocks of size 2^( 2) =       0.000397929512
  error estimate for blocks of size 2^( 3) =       0.000406850665
  error estimate for blocks of size 2^( 4) =       0.000414156165
  error estimate for blocks of size 2^( 5) =       0.000417742457
  error estimate for blocks of size 2^( 6) =       0.000420250425
  error estimate for blocks of size 2^( 7) =       0.000423247088

      target function =                  N/A
              le_mean =     -17.216376127418
             les_mean =     296.718091999577
             stat err =       0.000418849034
             autocorr =       1.165193249669
              std dev =       0.548748739839
             le_variance =       0.301125179475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301037797054
                                         uncertainty =       0.002244166994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301037797054
                                         uncertainty =       0.002244166994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388023955
  error estimate for blocks of size 2^( 2) =       0.000397929512
  error estimate for blocks of size 2^( 3) =       0.000406850665
  error estimate for blocks of size 2^( 4) =       0.000414156165
  error estimate for blocks of size 2^( 5) =       0.000417742457
  error estimate for blocks of size 2^( 6) =       0.000420250425
  error estimate for blocks of size 2^( 7) =       0.000423247088

      target function =                  N/A
              le_mean =     -17.216376127418
             les_mean =     296.718091999577
             stat err =       0.000418849034
             autocorr =       1.165193249669
              std dev =       0.548748739839
             le_variance =       0.301125179475


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216376127418        initial  <--
     6.1035e+38     6.1035e+39             0.0000e+00       -17.216376127418
     2.4414e+39     2.4414e+40             0.0000e+00       -17.216376127418
     9.7656e+39     9.7656e+40             0.0000e+00       -17.216376127418

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.3259
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8483e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.203
    reference variance = 0.20149
====================================================
  Execution time = 1.3637e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1804e-01
  Total weights = 1.956683850e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4624e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297978290128
                                         uncertainty =       0.002258920159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297978290128
                                         uncertainty =       0.002258920159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385981842
  error estimate for blocks of size 2^( 2) =       0.000395790832
  error estimate for blocks of size 2^( 3) =       0.000404615598
  error estimate for blocks of size 2^( 4) =       0.000411231961
  error estimate for blocks of size 2^( 5) =       0.000417038252
  error estimate for blocks of size 2^( 6) =       0.000420964467
  error estimate for blocks of size 2^( 7) =       0.000423211368

      target function =                  N/A
              le_mean =     -17.216978614337
             les_mean =     296.742395133055
             stat err =       0.000418111512
             autocorr =       1.173411937638
              std dev =       0.545860755641
             le_variance =       0.297963964549


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721697861434e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+39, overlap shift 6.1035e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216978614384       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216978614384       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+40, overlap shift 2.4414e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216978614384       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216978614384       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+40, overlap shift 9.7656e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216978614384       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216978614384       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.403039 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6104e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.1655
    reference variance = 0.253734
====================================================
  Execution time = 1.3458e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1860e-01
  Total weights = 1.9566e+06
  Execution time = 1.8137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303411356159
                                         uncertainty =       0.002690290469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303411356159
                                         uncertainty =       0.002690290469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389478464
  error estimate for blocks of size 2^( 2) =       0.000399782680
  error estimate for blocks of size 2^( 3) =       0.000408446034
  error estimate for blocks of size 2^( 4) =       0.000415405576
  error estimate for blocks of size 2^( 5) =       0.000419738448
  error estimate for blocks of size 2^( 6) =       0.000422674130
  error estimate for blocks of size 2^( 7) =       0.000424429531

      target function =                  N/A
              le_mean =     -17.217134519409
             les_mean =     296.748320499122
             stat err =       0.000420561921
             autocorr =       1.165985093874
              std dev =       0.550805726555
             le_variance =       0.303386948406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303411356159
                                         uncertainty =       0.002690290469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303411356159
                                         uncertainty =       0.002690290469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389478464
  error estimate for blocks of size 2^( 2) =       0.000399782680
  error estimate for blocks of size 2^( 3) =       0.000408446034
  error estimate for blocks of size 2^( 4) =       0.000415405576
  error estimate for blocks of size 2^( 5) =       0.000419738448
  error estimate for blocks of size 2^( 6) =       0.000422674130
  error estimate for blocks of size 2^( 7) =       0.000424429531

      target function =                  N/A
              le_mean =     -17.217134519409
             les_mean =     296.748320499122
             stat err =       0.000420561921
             autocorr =       1.165985093874
              std dev =       0.550805726555
             le_variance =       0.303386948406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303411356159
                                         uncertainty =       0.002690290469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303411356159
                                         uncertainty =       0.002690290469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389478464
  error estimate for blocks of size 2^( 2) =       0.000399782680
  error estimate for blocks of size 2^( 3) =       0.000408446034
  error estimate for blocks of size 2^( 4) =       0.000415405576
  error estimate for blocks of size 2^( 5) =       0.000419738448
  error estimate for blocks of size 2^( 6) =       0.000422674130
  error estimate for blocks of size 2^( 7) =       0.000424429531

      target function =                  N/A
              le_mean =     -17.217134519409
             les_mean =     296.748320499122
             stat err =       0.000420561921
             autocorr =       1.165985093874
              std dev =       0.550805726555
             le_variance =       0.303386948406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303411356159
                                         uncertainty =       0.002690290469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303411356159
                                         uncertainty =       0.002690290469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389478464
  error estimate for blocks of size 2^( 2) =       0.000399782680
  error estimate for blocks of size 2^( 3) =       0.000408446034
  error estimate for blocks of size 2^( 4) =       0.000415405576
  error estimate for blocks of size 2^( 5) =       0.000419738448
  error estimate for blocks of size 2^( 6) =       0.000422674130
  error estimate for blocks of size 2^( 7) =       0.000424429531

      target function =                  N/A
              le_mean =     -17.217134519409
             les_mean =     296.748320499122
             stat err =       0.000420561921
             autocorr =       1.165985093874
              std dev =       0.550805726555
             le_variance =       0.303386948406


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217134519409        initial  <--
     6.1035e+39     6.1035e+40             0.0000e+00       -17.217134519409
     2.4414e+40     2.4414e+41             0.0000e+00       -17.217134519409
     9.7656e+40     9.7656e+41             0.0000e+00       -17.217134519409

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5997
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8714e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.2935
    reference variance = 0.528738
====================================================
  Execution time = 1.3792e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1478e-01
  Total weights = 1.956623741e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4867e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300620953293
                                         uncertainty =       0.002153196275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300620953293
                                         uncertainty =       0.002153196275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387681721
  error estimate for blocks of size 2^( 2) =       0.000397872485
  error estimate for blocks of size 2^( 3) =       0.000407230283
  error estimate for blocks of size 2^( 4) =       0.000414414747
  error estimate for blocks of size 2^( 5) =       0.000418068118
  error estimate for blocks of size 2^( 6) =       0.000420559239
  error estimate for blocks of size 2^( 7) =       0.000422407142

      target function =                  N/A
              le_mean =     -17.217148167940
             les_mean =     296.744974477205
             stat err =       0.000418862312
             autocorr =       1.167325360802
              std dev =       0.548264747592
             le_variance =       0.300594233452


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721714816794e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+40, overlap shift 6.1035e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217148167979       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217148167979       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217148167979       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+40 is 5.935749e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+41, overlap shift 2.4414e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217148167979       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217148167979       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217148167979       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+41 is 1.483937e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+41, overlap shift 9.7656e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217148167979       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217148167979       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217148167979       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+41 is 3.709843e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.404387 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6284e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.1949
    reference variance = 0.226668
====================================================
  Execution time = 1.3106e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1018e-01
  Total weights = 1.9564e+06
  Execution time = 1.8188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297007951272
                                         uncertainty =       0.001643898779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297007951272
                                         uncertainty =       0.001643898779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385367805
  error estimate for blocks of size 2^( 2) =       0.000395012713
  error estimate for blocks of size 2^( 3) =       0.000403530198
  error estimate for blocks of size 2^( 4) =       0.000410176391
  error estimate for blocks of size 2^( 5) =       0.000415318730
  error estimate for blocks of size 2^( 6) =       0.000417197714
  error estimate for blocks of size 2^( 7) =       0.000417257037

      target function =                  N/A
              le_mean =     -17.216476266859
             les_mean =     296.717236225310
             stat err =       0.000414987468
             autocorr =       1.159629099378
              std dev =       0.544992376385
             le_variance =       0.297016690318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297007951272
                                         uncertainty =       0.001643898779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297007951272
                                         uncertainty =       0.001643898779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385367805
  error estimate for blocks of size 2^( 2) =       0.000395012713
  error estimate for blocks of size 2^( 3) =       0.000403530198
  error estimate for blocks of size 2^( 4) =       0.000410176391
  error estimate for blocks of size 2^( 5) =       0.000415318730
  error estimate for blocks of size 2^( 6) =       0.000417197714
  error estimate for blocks of size 2^( 7) =       0.000417257037

      target function =                  N/A
              le_mean =     -17.216476266859
             les_mean =     296.717236225310
             stat err =       0.000414987468
             autocorr =       1.159629099378
              std dev =       0.544992376385
             le_variance =       0.297016690318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297007951272
                                         uncertainty =       0.001643898779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297007951272
                                         uncertainty =       0.001643898779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385367805
  error estimate for blocks of size 2^( 2) =       0.000395012713
  error estimate for blocks of size 2^( 3) =       0.000403530198
  error estimate for blocks of size 2^( 4) =       0.000410176391
  error estimate for blocks of size 2^( 5) =       0.000415318730
  error estimate for blocks of size 2^( 6) =       0.000417197714
  error estimate for blocks of size 2^( 7) =       0.000417257037

      target function =                  N/A
              le_mean =     -17.216476266859
             les_mean =     296.717236225310
             stat err =       0.000414987468
             autocorr =       1.159629099378
              std dev =       0.544992376385
             le_variance =       0.297016690318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297007951272
                                         uncertainty =       0.001643898779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297007951272
                                         uncertainty =       0.001643898779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385367805
  error estimate for blocks of size 2^( 2) =       0.000395012713
  error estimate for blocks of size 2^( 3) =       0.000403530198
  error estimate for blocks of size 2^( 4) =       0.000410176391
  error estimate for blocks of size 2^( 5) =       0.000415318730
  error estimate for blocks of size 2^( 6) =       0.000417197714
  error estimate for blocks of size 2^( 7) =       0.000417257037

      target function =                  N/A
              le_mean =     -17.216476266859
             les_mean =     296.717236225310
             stat err =       0.000414987468
             autocorr =       1.159629099378
              std dev =       0.544992376385
             le_variance =       0.297016690318


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216476266859        initial  <--
     6.1035e+40     6.1035e+41             5.9357e-45       -17.216476266859
     2.4414e+41     2.4414e+42             1.4839e-45       -17.216476266859
     9.7656e+41     9.7656e+42             3.7098e-46       -17.216476266859

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.2738
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8587e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.2617
    reference variance = 0.193146
====================================================
  Execution time = 1.3700e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1625e-01
  Total weights = 1.956711401e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4653e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297124883860
                                         uncertainty =       0.001874095169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297124883860
                                         uncertainty =       0.001874095169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385403234
  error estimate for blocks of size 2^( 2) =       0.000395063536
  error estimate for blocks of size 2^( 3) =       0.000404875762
  error estimate for blocks of size 2^( 4) =       0.000411230343
  error estimate for blocks of size 2^( 5) =       0.000415924779
  error estimate for blocks of size 2^( 6) =       0.000420116641
  error estimate for blocks of size 2^( 7) =       0.000421580085

      target function =                  N/A
              le_mean =     -17.216599795140
             les_mean =     296.727563409891
             stat err =       0.000417212962
             autocorr =       1.171884678456
              std dev =       0.545042480089
             le_variance =       0.297071305101


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721659979514e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+41, overlap shift 6.1035e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216599795177       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216599795177       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+42, overlap shift 2.4414e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216599795177       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216599795177       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+42, overlap shift 9.7656e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216599795177       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216599795177       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.405455 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6170e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.215
    reference variance = 0.175948
====================================================
  Execution time = 1.3320e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1484e-01
  Total weights = 1.9563e+06
  Execution time = 1.8087e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300042610508
                                         uncertainty =       0.002097596412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300042610508
                                         uncertainty =       0.002097596412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387301206
  error estimate for blocks of size 2^( 2) =       0.000397427205
  error estimate for blocks of size 2^( 3) =       0.000406562229
  error estimate for blocks of size 2^( 4) =       0.000413569470
  error estimate for blocks of size 2^( 5) =       0.000418015365
  error estimate for blocks of size 2^( 6) =       0.000421200921
  error estimate for blocks of size 2^( 7) =       0.000422691677

      target function =                  N/A
              le_mean =     -17.216396861328
             les_mean =     296.719164347591
             stat err =       0.000418869358
             autocorr =       1.169659585386
              std dev =       0.547726618173
             le_variance =       0.300004448255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300042610508
                                         uncertainty =       0.002097596412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300042610508
                                         uncertainty =       0.002097596412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387301206
  error estimate for blocks of size 2^( 2) =       0.000397427205
  error estimate for blocks of size 2^( 3) =       0.000406562229
  error estimate for blocks of size 2^( 4) =       0.000413569470
  error estimate for blocks of size 2^( 5) =       0.000418015365
  error estimate for blocks of size 2^( 6) =       0.000421200921
  error estimate for blocks of size 2^( 7) =       0.000422691677

      target function =                  N/A
              le_mean =     -17.216396861328
             les_mean =     296.719164347591
             stat err =       0.000418869358
             autocorr =       1.169659585386
              std dev =       0.547726618173
             le_variance =       0.300004448255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300042610508
                                         uncertainty =       0.002097596412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300042610508
                                         uncertainty =       0.002097596412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387301206
  error estimate for blocks of size 2^( 2) =       0.000397427205
  error estimate for blocks of size 2^( 3) =       0.000406562229
  error estimate for blocks of size 2^( 4) =       0.000413569470
  error estimate for blocks of size 2^( 5) =       0.000418015365
  error estimate for blocks of size 2^( 6) =       0.000421200921
  error estimate for blocks of size 2^( 7) =       0.000422691677

      target function =                  N/A
              le_mean =     -17.216396861328
             les_mean =     296.719164347591
             stat err =       0.000418869358
             autocorr =       1.169659585386
              std dev =       0.547726618173
             le_variance =       0.300004448255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300042610508
                                         uncertainty =       0.002097596412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300042610508
                                         uncertainty =       0.002097596412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387301206
  error estimate for blocks of size 2^( 2) =       0.000397427205
  error estimate for blocks of size 2^( 3) =       0.000406562229
  error estimate for blocks of size 2^( 4) =       0.000413569470
  error estimate for blocks of size 2^( 5) =       0.000418015365
  error estimate for blocks of size 2^( 6) =       0.000421200921
  error estimate for blocks of size 2^( 7) =       0.000422691677

      target function =                  N/A
              le_mean =     -17.216396861328
             les_mean =     296.719164347591
             stat err =       0.000418869358
             autocorr =       1.169659585386
              std dev =       0.547726618173
             le_variance =       0.300004448255


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216396861328        initial  <--
     6.1035e+41     6.1035e+42             0.0000e+00       -17.216396861328
     2.4414e+42     2.4414e+43             0.0000e+00       -17.216396861328
     9.7656e+42     9.7656e+43             0.0000e+00       -17.216396861328

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.4544
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8636e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.2132
    reference variance = 0.355568
====================================================
  Execution time = 1.3650e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1432e-01
  Total weights = 1.956827484e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4876e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299227966215
                                         uncertainty =       0.002118839021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299227966215
                                         uncertainty =       0.002118839021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386748672
  error estimate for blocks of size 2^( 2) =       0.000396821040
  error estimate for blocks of size 2^( 3) =       0.000405217371
  error estimate for blocks of size 2^( 4) =       0.000411541820
  error estimate for blocks of size 2^( 5) =       0.000415849010
  error estimate for blocks of size 2^( 6) =       0.000417277869
  error estimate for blocks of size 2^( 7) =       0.000417917515

      target function =                  N/A
              le_mean =     -17.217051041525
             les_mean =     296.741164130070
             stat err =       0.000415646554
             autocorr =       1.155023192876
              std dev =       0.546945217522
             le_variance =       0.299149070970


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721705104152e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+42, overlap shift 6.1035e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217051041556       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217051041556       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+43, overlap shift 2.4414e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217051041556       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217051041556       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+43, overlap shift 9.7656e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217051041556       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217051041556       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.406505 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6143e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.2266
    reference variance = 0.289583
====================================================
  Execution time = 1.3221e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1574e-01
  Total weights = 1.9565e+06
  Execution time = 1.8169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300341079854
                                         uncertainty =       0.001928616981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300341079854
                                         uncertainty =       0.001928616981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387690121
  error estimate for blocks of size 2^( 2) =       0.000397615769
  error estimate for blocks of size 2^( 3) =       0.000406368091
  error estimate for blocks of size 2^( 4) =       0.000412381082
  error estimate for blocks of size 2^( 5) =       0.000415571878
  error estimate for blocks of size 2^( 6) =       0.000418315919
  error estimate for blocks of size 2^( 7) =       0.000419681975

      target function =                  N/A
              le_mean =     -17.215763047574
             les_mean =     296.698233747633
             stat err =       0.000416487713
             autocorr =       1.154077352909
              std dev =       0.548276627326
             le_variance =       0.300607260072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300341079854
                                         uncertainty =       0.001928616981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300341079854
                                         uncertainty =       0.001928616981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387690121
  error estimate for blocks of size 2^( 2) =       0.000397615769
  error estimate for blocks of size 2^( 3) =       0.000406368091
  error estimate for blocks of size 2^( 4) =       0.000412381082
  error estimate for blocks of size 2^( 5) =       0.000415571878
  error estimate for blocks of size 2^( 6) =       0.000418315919
  error estimate for blocks of size 2^( 7) =       0.000419681975

      target function =                  N/A
              le_mean =     -17.215763047574
             les_mean =     296.698233747633
             stat err =       0.000416487713
             autocorr =       1.154077352913
              std dev =       0.548276627326
             le_variance =       0.300607260072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300341079854
                                         uncertainty =       0.001928616981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300341079854
                                         uncertainty =       0.001928616981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387690121
  error estimate for blocks of size 2^( 2) =       0.000397615769
  error estimate for blocks of size 2^( 3) =       0.000406368091
  error estimate for blocks of size 2^( 4) =       0.000412381082
  error estimate for blocks of size 2^( 5) =       0.000415571878
  error estimate for blocks of size 2^( 6) =       0.000418315919
  error estimate for blocks of size 2^( 7) =       0.000419681975

      target function =                  N/A
              le_mean =     -17.215763047574
             les_mean =     296.698233747633
             stat err =       0.000416487713
             autocorr =       1.154077352913
              std dev =       0.548276627326
             le_variance =       0.300607260072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300341079854
                                         uncertainty =       0.001928616981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300341079854
                                         uncertainty =       0.001928616981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387690121
  error estimate for blocks of size 2^( 2) =       0.000397615769
  error estimate for blocks of size 2^( 3) =       0.000406368091
  error estimate for blocks of size 2^( 4) =       0.000412381082
  error estimate for blocks of size 2^( 5) =       0.000415571878
  error estimate for blocks of size 2^( 6) =       0.000418315919
  error estimate for blocks of size 2^( 7) =       0.000419681975

      target function =                  N/A
              le_mean =     -17.215763047574
             les_mean =     296.698233747633
             stat err =       0.000416487713
             autocorr =       1.154077352913
              std dev =       0.548276627326
             le_variance =       0.300607260072


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215763047574        initial  <--
     6.1035e+42     6.1035e+43             0.0000e+00       -17.215763047574
     2.4414e+43     2.4414e+44             0.0000e+00       -17.215763047574
     9.7656e+43     9.7656e+44             0.0000e+00       -17.215763047574

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.3775
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8533e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.2521
    reference variance = 0.17964
====================================================
  Execution time = 1.3621e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2077e-01
  Total weights = 1.956525632e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4919e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302724012412
                                         uncertainty =       0.002568936830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302724012412
                                         uncertainty =       0.002568936830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389078896
  error estimate for blocks of size 2^( 2) =       0.000398829294
  error estimate for blocks of size 2^( 3) =       0.000408049611
  error estimate for blocks of size 2^( 4) =       0.000414546445
  error estimate for blocks of size 2^( 5) =       0.000419609560
  error estimate for blocks of size 2^( 6) =       0.000423359245
  error estimate for blocks of size 2^( 7) =       0.000423260760

      target function =                  N/A
              le_mean =     -17.216623836071
             les_mean =     296.732908476698
             stat err =       0.000420194002
             autocorr =       1.166337794710
              std dev =       0.550240651447
             le_variance =       0.302764774505


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721662383607e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+43, overlap shift 6.1035e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216623836142       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216623836142       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+44, overlap shift 2.4414e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216623836142       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216623836142       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+44, overlap shift 9.7656e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216623836142       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216623836142       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.407593 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6119e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.14
    reference variance = 0.434193
====================================================
  Execution time = 1.3165e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1384e-01
  Total weights = 1.9567e+06
  Execution time = 1.8217e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297946437808
                                         uncertainty =       0.001972012007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297946437808
                                         uncertainty =       0.001972012007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385971261
  error estimate for blocks of size 2^( 2) =       0.000396052345
  error estimate for blocks of size 2^( 3) =       0.000405490760
  error estimate for blocks of size 2^( 4) =       0.000412883612
  error estimate for blocks of size 2^( 5) =       0.000416979584
  error estimate for blocks of size 2^( 6) =       0.000419121626
  error estimate for blocks of size 2^( 7) =       0.000420688094

      target function =                  N/A
              le_mean =     -17.216019648208
             les_mean =     296.705175135877
             stat err =       0.000417418229
             autocorr =       1.169587948336
              std dev =       0.545845792011
             le_variance =       0.297947628656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297946437808
                                         uncertainty =       0.001972012007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297946437808
                                         uncertainty =       0.001972012007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385971261
  error estimate for blocks of size 2^( 2) =       0.000396052345
  error estimate for blocks of size 2^( 3) =       0.000405490760
  error estimate for blocks of size 2^( 4) =       0.000412883612
  error estimate for blocks of size 2^( 5) =       0.000416979584
  error estimate for blocks of size 2^( 6) =       0.000419121626
  error estimate for blocks of size 2^( 7) =       0.000420688094

      target function =                  N/A
              le_mean =     -17.216019648208
             les_mean =     296.705175135877
             stat err =       0.000417418229
             autocorr =       1.169587948336
              std dev =       0.545845792011
             le_variance =       0.297947628656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297946437808
                                         uncertainty =       0.001972012007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297946437808
                                         uncertainty =       0.001972012007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385971261
  error estimate for blocks of size 2^( 2) =       0.000396052345
  error estimate for blocks of size 2^( 3) =       0.000405490760
  error estimate for blocks of size 2^( 4) =       0.000412883612
  error estimate for blocks of size 2^( 5) =       0.000416979584
  error estimate for blocks of size 2^( 6) =       0.000419121626
  error estimate for blocks of size 2^( 7) =       0.000420688094

      target function =                  N/A
              le_mean =     -17.216019648208
             les_mean =     296.705175135877
             stat err =       0.000417418229
             autocorr =       1.169587948336
              std dev =       0.545845792011
             le_variance =       0.297947628656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297946437808
                                         uncertainty =       0.001972012007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297946437808
                                         uncertainty =       0.001972012007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385971261
  error estimate for blocks of size 2^( 2) =       0.000396052345
  error estimate for blocks of size 2^( 3) =       0.000405490760
  error estimate for blocks of size 2^( 4) =       0.000412883612
  error estimate for blocks of size 2^( 5) =       0.000416979584
  error estimate for blocks of size 2^( 6) =       0.000419121626
  error estimate for blocks of size 2^( 7) =       0.000420688094

      target function =                  N/A
              le_mean =     -17.216019648208
             les_mean =     296.705175135877
             stat err =       0.000417418229
             autocorr =       1.169587948336
              std dev =       0.545845792011
             le_variance =       0.297947628656


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216019648208        initial  <--
     6.1035e+43     6.1035e+44             0.0000e+00       -17.216019648208
     2.4414e+44     2.4414e+45             0.0000e+00       -17.216019648208
     9.7656e+44     9.7656e+45             0.0000e+00       -17.216019648208

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.3467
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8473e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.2181
    reference variance = 0.176358
====================================================
  Execution time = 1.3572e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1701e-01
  Total weights = 1.956803520e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5063e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303350891872
                                         uncertainty =       0.002058267747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303350891872
                                         uncertainty =       0.002058267747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389499172
  error estimate for blocks of size 2^( 2) =       0.000399378019
  error estimate for blocks of size 2^( 3) =       0.000408519347
  error estimate for blocks of size 2^( 4) =       0.000415798590
  error estimate for blocks of size 2^( 5) =       0.000420471342
  error estimate for blocks of size 2^( 6) =       0.000421209203
  error estimate for blocks of size 2^( 7) =       0.000423402445

      target function =                  N/A
              le_mean =     -17.216491339586
             les_mean =     296.724584933279
             stat err =       0.000420220395
             autocorr =       1.163968360960
              std dev =       0.550835011190
             le_variance =       0.303419209552


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721649133959e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+44, overlap shift 6.1035e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216491339635       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216491339635       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+45, overlap shift 2.4414e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216491339635       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216491339635       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+45, overlap shift 9.7656e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216491339635       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216491339635       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.408710 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6084e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.1859
    reference variance = 0.188286
====================================================
  Execution time = 1.3228e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1323e-01
  Total weights = 1.9562e+06
  Execution time = 2.2694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299813565407
                                         uncertainty =       0.001917017691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299813565407
                                         uncertainty =       0.001917017691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387205773
  error estimate for blocks of size 2^( 2) =       0.000397533302
  error estimate for blocks of size 2^( 3) =       0.000407110303
  error estimate for blocks of size 2^( 4) =       0.000414226047
  error estimate for blocks of size 2^( 5) =       0.000417267186
  error estimate for blocks of size 2^( 6) =       0.000418395233
  error estimate for blocks of size 2^( 7) =       0.000420346985

      target function =                  N/A
              le_mean =     -17.215931488107
             les_mean =     296.701525208813
             stat err =       0.000417558863
             autocorr =       1.162925158574
              std dev =       0.547591654905
             le_variance =       0.299856620522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299813565407
                                         uncertainty =       0.001917017691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299813565407
                                         uncertainty =       0.001917017691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387205773
  error estimate for blocks of size 2^( 2) =       0.000397533302
  error estimate for blocks of size 2^( 3) =       0.000407110303
  error estimate for blocks of size 2^( 4) =       0.000414226047
  error estimate for blocks of size 2^( 5) =       0.000417267186
  error estimate for blocks of size 2^( 6) =       0.000418395233
  error estimate for blocks of size 2^( 7) =       0.000420346985

      target function =                  N/A
              le_mean =     -17.215931488107
             les_mean =     296.701525208813
             stat err =       0.000417558863
             autocorr =       1.162925158574
              std dev =       0.547591654905
             le_variance =       0.299856620522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299813565407
                                         uncertainty =       0.001917017691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299813565407
                                         uncertainty =       0.001917017691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387205773
  error estimate for blocks of size 2^( 2) =       0.000397533302
  error estimate for blocks of size 2^( 3) =       0.000407110303
  error estimate for blocks of size 2^( 4) =       0.000414226047
  error estimate for blocks of size 2^( 5) =       0.000417267186
  error estimate for blocks of size 2^( 6) =       0.000418395233
  error estimate for blocks of size 2^( 7) =       0.000420346985

      target function =                  N/A
              le_mean =     -17.215931488107
             les_mean =     296.701525208813
             stat err =       0.000417558863
             autocorr =       1.162925158574
              std dev =       0.547591654905
             le_variance =       0.299856620522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299813565407
                                         uncertainty =       0.001917017691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299813565407
                                         uncertainty =       0.001917017691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387205773
  error estimate for blocks of size 2^( 2) =       0.000397533302
  error estimate for blocks of size 2^( 3) =       0.000407110303
  error estimate for blocks of size 2^( 4) =       0.000414226047
  error estimate for blocks of size 2^( 5) =       0.000417267186
  error estimate for blocks of size 2^( 6) =       0.000418395233
  error estimate for blocks of size 2^( 7) =       0.000420346985

      target function =                  N/A
              le_mean =     -17.215931488107
             les_mean =     296.701525208813
             stat err =       0.000417558863
             autocorr =       1.162925158574
              std dev =       0.547591654905
             le_variance =       0.299856620522


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215931488107        initial  <--
     6.1035e+44     6.1035e+45             0.0000e+00       -17.215931488107
     2.4414e+45     2.4414e+46             0.0000e+00       -17.215931488107
     9.7656e+45     9.7656e+46             0.0000e+00       -17.215931488107

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.3861
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9477e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.1594
    reference variance = 0.264244
====================================================
  Execution time = 1.3574e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1191e-01
  Total weights = 1.956345899e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4828e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297214701766
                                         uncertainty =       0.001492254670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297214701766
                                         uncertainty =       0.001492254670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385503971
  error estimate for blocks of size 2^( 2) =       0.000395551641
  error estimate for blocks of size 2^( 3) =       0.000404241597
  error estimate for blocks of size 2^( 4) =       0.000411356285
  error estimate for blocks of size 2^( 5) =       0.000415568194
  error estimate for blocks of size 2^( 6) =       0.000417785963
  error estimate for blocks of size 2^( 7) =       0.000418045083

      target function =                  N/A
              le_mean =     -17.216968165917
             les_mean =     296.735906287055
             stat err =       0.000415688882
             autocorr =       1.162730608978
              std dev =       0.545184943882
             le_variance =       0.297226623036


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721696816592e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+45, overlap shift 6.1035e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216968165961       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216968165961       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+46, overlap shift 2.4414e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216968165961       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216968165961       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+46, overlap shift 9.7656e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216968165961       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216968165961       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.409720 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6062e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.2672
    reference variance = 0.389707
====================================================
  Execution time = 1.3171e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1422e-01
  Total weights = 1.9567e+06
  Execution time = 1.8162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299389844536
                                         uncertainty =       0.001941815476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299389844536
                                         uncertainty =       0.001941815476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386903893
  error estimate for blocks of size 2^( 2) =       0.000396817878
  error estimate for blocks of size 2^( 3) =       0.000405942488
  error estimate for blocks of size 2^( 4) =       0.000412240647
  error estimate for blocks of size 2^( 5) =       0.000416803425
  error estimate for blocks of size 2^( 6) =       0.000417613635
  error estimate for blocks of size 2^( 7) =       0.000419400892

      target function =                  N/A
              le_mean =     -17.217082500044
             les_mean =     296.742152214581
             stat err =       0.000416514650
             autocorr =       1.158922415947
              std dev =       0.547164732526
             le_variance =       0.299389244520

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299389844536
                                         uncertainty =       0.001941815476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299389844536
                                         uncertainty =       0.001941815476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386903893
  error estimate for blocks of size 2^( 2) =       0.000396817878
  error estimate for blocks of size 2^( 3) =       0.000405942488
  error estimate for blocks of size 2^( 4) =       0.000412240647
  error estimate for blocks of size 2^( 5) =       0.000416803425
  error estimate for blocks of size 2^( 6) =       0.000417613635
  error estimate for blocks of size 2^( 7) =       0.000419400892

      target function =                  N/A
              le_mean =     -17.217082500044
             les_mean =     296.742152214581
             stat err =       0.000416514650
             autocorr =       1.158922415947
              std dev =       0.547164732526
             le_variance =       0.299389244520

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299389844536
                                         uncertainty =       0.001941815476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299389844536
                                         uncertainty =       0.001941815476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386903893
  error estimate for blocks of size 2^( 2) =       0.000396817878
  error estimate for blocks of size 2^( 3) =       0.000405942488
  error estimate for blocks of size 2^( 4) =       0.000412240647
  error estimate for blocks of size 2^( 5) =       0.000416803425
  error estimate for blocks of size 2^( 6) =       0.000417613635
  error estimate for blocks of size 2^( 7) =       0.000419400892

      target function =                  N/A
              le_mean =     -17.217082500044
             les_mean =     296.742152214581
             stat err =       0.000416514650
             autocorr =       1.158922415947
              std dev =       0.547164732526
             le_variance =       0.299389244520

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299389844536
                                         uncertainty =       0.001941815476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299389844536
                                         uncertainty =       0.001941815476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386903893
  error estimate for blocks of size 2^( 2) =       0.000396817878
  error estimate for blocks of size 2^( 3) =       0.000405942488
  error estimate for blocks of size 2^( 4) =       0.000412240647
  error estimate for blocks of size 2^( 5) =       0.000416803425
  error estimate for blocks of size 2^( 6) =       0.000417613635
  error estimate for blocks of size 2^( 7) =       0.000419400892

      target function =                  N/A
              le_mean =     -17.217082500044
             les_mean =     296.742152214581
             stat err =       0.000416514650
             autocorr =       1.158922415947
              std dev =       0.547164732526
             le_variance =       0.299389244520


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217082500044        initial  <--
     6.1035e+45     6.1035e+46             0.0000e+00       -17.217082500044
     2.4414e+46     2.4414e+47             0.0000e+00       -17.217082500044
     9.7656e+46     9.7656e+47             0.0000e+00       -17.217082500044

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.4220
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8491e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.2076
    reference variance = 0.22054
====================================================
  Execution time = 1.3582e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1779e-01
  Total weights = 1.956618442e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4666e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301922564486
                                         uncertainty =       0.002114229088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301922564486
                                         uncertainty =       0.002114229088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388545568
  error estimate for blocks of size 2^( 2) =       0.000398471497
  error estimate for blocks of size 2^( 3) =       0.000407403237
  error estimate for blocks of size 2^( 4) =       0.000413845760
  error estimate for blocks of size 2^( 5) =       0.000418635590
  error estimate for blocks of size 2^( 6) =       0.000420354230
  error estimate for blocks of size 2^( 7) =       0.000422843594

      target function =                  N/A
              le_mean =     -17.216851336265
             les_mean =     296.737761568126
             stat err =       0.000418919793
             autocorr =       1.162459531905
              std dev =       0.549486411571
             le_variance =       0.301935316502


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721685133627e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+46, overlap shift 6.1035e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216851336301       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216851336301       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+47, overlap shift 2.4414e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216851336301       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216851336301       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+47, overlap shift 9.7656e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216851336301       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216851336301       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.410762 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6054e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.2574
    reference variance = 0.519787
====================================================
  Execution time = 1.3263e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1866e-01
  Total weights = 1.9568e+06
  Execution time = 1.8144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301192870925
                                         uncertainty =       0.002380329831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301192870925
                                         uncertainty =       0.002380329831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388116324
  error estimate for blocks of size 2^( 2) =       0.000398253716
  error estimate for blocks of size 2^( 3) =       0.000407321360
  error estimate for blocks of size 2^( 4) =       0.000414565542
  error estimate for blocks of size 2^( 5) =       0.000418076090
  error estimate for blocks of size 2^( 6) =       0.000421152791
  error estimate for blocks of size 2^( 7) =       0.000424052572

      target function =                  N/A
              le_mean =     -17.215816722695
             les_mean =     296.703008930852
             stat err =       0.000419461749
             autocorr =       1.168048587549
              std dev =       0.548879368640
             le_variance =       0.301268561318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301192870925
                                         uncertainty =       0.002380329831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301192870925
                                         uncertainty =       0.002380329831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388116324
  error estimate for blocks of size 2^( 2) =       0.000398253716
  error estimate for blocks of size 2^( 3) =       0.000407321360
  error estimate for blocks of size 2^( 4) =       0.000414565542
  error estimate for blocks of size 2^( 5) =       0.000418076090
  error estimate for blocks of size 2^( 6) =       0.000421152791
  error estimate for blocks of size 2^( 7) =       0.000424052572

      target function =                  N/A
              le_mean =     -17.215816722695
             les_mean =     296.703008930852
             stat err =       0.000419461749
             autocorr =       1.168048587549
              std dev =       0.548879368640
             le_variance =       0.301268561318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301192870925
                                         uncertainty =       0.002380329831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301192870925
                                         uncertainty =       0.002380329831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388116324
  error estimate for blocks of size 2^( 2) =       0.000398253716
  error estimate for blocks of size 2^( 3) =       0.000407321360
  error estimate for blocks of size 2^( 4) =       0.000414565542
  error estimate for blocks of size 2^( 5) =       0.000418076090
  error estimate for blocks of size 2^( 6) =       0.000421152791
  error estimate for blocks of size 2^( 7) =       0.000424052572

      target function =                  N/A
              le_mean =     -17.215816722695
             les_mean =     296.703008930852
             stat err =       0.000419461749
             autocorr =       1.168048587549
              std dev =       0.548879368640
             le_variance =       0.301268561318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301192870925
                                         uncertainty =       0.002380329831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301192870925
                                         uncertainty =       0.002380329831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388116324
  error estimate for blocks of size 2^( 2) =       0.000398253716
  error estimate for blocks of size 2^( 3) =       0.000407321360
  error estimate for blocks of size 2^( 4) =       0.000414565542
  error estimate for blocks of size 2^( 5) =       0.000418076090
  error estimate for blocks of size 2^( 6) =       0.000421152791
  error estimate for blocks of size 2^( 7) =       0.000424052572

      target function =                  N/A
              le_mean =     -17.215816722695
             les_mean =     296.703008930852
             stat err =       0.000419461749
             autocorr =       1.168048587549
              std dev =       0.548879368640
             le_variance =       0.301268561318


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215816722695        initial  <--
     6.1035e+46     6.1035e+47             0.0000e+00       -17.215816722695
     2.4414e+47     2.4414e+48             0.0000e+00       -17.215816722695
     9.7656e+47     9.7656e+48             0.0000e+00       -17.215816722695

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.4257
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8486e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.127
    reference variance = 0.299909
====================================================
  Execution time = 1.3502e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1149e-01
  Total weights = 1.956465362e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4758e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298320378281
                                         uncertainty =       0.001979887049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298320378281
                                         uncertainty =       0.001979887049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386215261
  error estimate for blocks of size 2^( 2) =       0.000396101584
  error estimate for blocks of size 2^( 3) =       0.000404867178
  error estimate for blocks of size 2^( 4) =       0.000411587200
  error estimate for blocks of size 2^( 5) =       0.000417227776
  error estimate for blocks of size 2^( 6) =       0.000419069385
  error estimate for blocks of size 2^( 7) =       0.000420552797

      target function =                  N/A
              le_mean =     -17.216797606807
             les_mean =     296.729614560867
             stat err =       0.000417109290
             autocorr =       1.166382145001
              std dev =       0.546190860411
             le_variance =       0.298324455997


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721679760681e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+47, overlap shift 6.1035e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216797606844       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216797606844       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216797606844       residual = 7.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+47 is 5.087265e-52

solving harmonic davidson linear method for identity shift 2.4414e+48, overlap shift 2.4414e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216797606844       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216797606844       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216797606844       residual = 7.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+48 is 1.271816e-52

solving harmonic davidson linear method for identity shift 9.7656e+48, overlap shift 9.7656e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216797606844       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216797606844       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216797606844       residual = 7.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+48 is 3.179541e-53

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.411820 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.5983e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.0913
    reference variance = 0.24522
====================================================
  Execution time = 1.3211e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1364e-01
  Total weights = 1.9564e+06
  Execution time = 1.8156e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297936176183
                                         uncertainty =       0.001948417037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297936176183
                                         uncertainty =       0.001948417037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385949061
  error estimate for blocks of size 2^( 2) =       0.000396082112
  error estimate for blocks of size 2^( 3) =       0.000405269851
  error estimate for blocks of size 2^( 4) =       0.000411775637
  error estimate for blocks of size 2^( 5) =       0.000416239860
  error estimate for blocks of size 2^( 6) =       0.000416365880
  error estimate for blocks of size 2^( 7) =       0.000414784550

      target function =                  N/A
              le_mean =     -17.216318251606
             les_mean =     296.715258415671
             stat err =       0.000414791482
             autocorr =       1.155047062646
              std dev =       0.545814396930
             le_variance =       0.297913355897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297936176183
                                         uncertainty =       0.001948417037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297936176183
                                         uncertainty =       0.001948417037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385949061
  error estimate for blocks of size 2^( 2) =       0.000396082112
  error estimate for blocks of size 2^( 3) =       0.000405269851
  error estimate for blocks of size 2^( 4) =       0.000411775637
  error estimate for blocks of size 2^( 5) =       0.000416239860
  error estimate for blocks of size 2^( 6) =       0.000416365880
  error estimate for blocks of size 2^( 7) =       0.000414784550

      target function =                  N/A
              le_mean =     -17.216318251606
             les_mean =     296.715258415671
             stat err =       0.000414791482
             autocorr =       1.155047062646
              std dev =       0.545814396930
             le_variance =       0.297913355897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297936176183
                                         uncertainty =       0.001948417037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297936176183
                                         uncertainty =       0.001948417037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385949061
  error estimate for blocks of size 2^( 2) =       0.000396082112
  error estimate for blocks of size 2^( 3) =       0.000405269851
  error estimate for blocks of size 2^( 4) =       0.000411775637
  error estimate for blocks of size 2^( 5) =       0.000416239860
  error estimate for blocks of size 2^( 6) =       0.000416365880
  error estimate for blocks of size 2^( 7) =       0.000414784550

      target function =                  N/A
              le_mean =     -17.216318251606
             les_mean =     296.715258415671
             stat err =       0.000414791482
             autocorr =       1.155047062646
              std dev =       0.545814396930
             le_variance =       0.297913355897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297936176183
                                         uncertainty =       0.001948417037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297936176183
                                         uncertainty =       0.001948417037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385949061
  error estimate for blocks of size 2^( 2) =       0.000396082112
  error estimate for blocks of size 2^( 3) =       0.000405269851
  error estimate for blocks of size 2^( 4) =       0.000411775637
  error estimate for blocks of size 2^( 5) =       0.000416239860
  error estimate for blocks of size 2^( 6) =       0.000416365880
  error estimate for blocks of size 2^( 7) =       0.000414784550

      target function =                  N/A
              le_mean =     -17.216318251606
             les_mean =     296.715258415671
             stat err =       0.000414791482
             autocorr =       1.155047062646
              std dev =       0.545814396930
             le_variance =       0.297913355897


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216318251606        initial  <--
     6.1035e+47     6.1035e+48             5.0873e-52       -17.216318251606
     2.4414e+48     2.4414e+49             1.2718e-52       -17.216318251606
     9.7656e+48     9.7656e+49             3.1795e-53       -17.216318251606

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.3568
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8347e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.2178
    reference variance = 0.152179
====================================================
  Execution time = 1.4011e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5306e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2074e-01
  Total weights = 1.956606093e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4946e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299444996006
                                         uncertainty =       0.002465443571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299444996006
                                         uncertainty =       0.002465443571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386925952
  error estimate for blocks of size 2^( 2) =       0.000397159144
  error estimate for blocks of size 2^( 3) =       0.000405993782
  error estimate for blocks of size 2^( 4) =       0.000412991116
  error estimate for blocks of size 2^( 5) =       0.000417365931
  error estimate for blocks of size 2^( 6) =       0.000419961269
  error estimate for blocks of size 2^( 7) =       0.000420729961

      target function =                  N/A
              le_mean =     -17.216292651311
             les_mean =     296.721470778561
             stat err =       0.000417762069
             autocorr =       1.165741593465
              std dev =       0.547195928433
             le_variance =       0.299423384094


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721629265131e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+48, overlap shift 6.1035e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216292651334       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216292651334       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.000000000000       residual = 4.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216292651334       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+48 is 5.775770e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+49, overlap shift 2.4414e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216292651334       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216292651334       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -18.000000000000       residual = 6.58e-01           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+49 is 1.443942e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+49, overlap shift 9.7656e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216292651334       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216292651334       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.000000000000       residual = 1.58e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216292651334       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+49 is 3.609856e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.413322 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6511e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.1985
    reference variance = 0.209102
====================================================
  Execution time = 1.3300e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1532e-01
  Total weights = 1.9566e+06
  Execution time = 1.8185e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298431370323
                                         uncertainty =       0.002197897573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298431370323
                                         uncertainty =       0.002197897573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386310823
  error estimate for blocks of size 2^( 2) =       0.000396119354
  error estimate for blocks of size 2^( 3) =       0.000405213244
  error estimate for blocks of size 2^( 4) =       0.000412707463
  error estimate for blocks of size 2^( 5) =       0.000417292496
  error estimate for blocks of size 2^( 6) =       0.000420251927
  error estimate for blocks of size 2^( 7) =       0.000422627909

      target function =                  N/A
              le_mean =     -17.215977308465
             les_mean =     296.705189830270
             stat err =       0.000418219949
             autocorr =       1.172021931388
              std dev =       0.546326005106
             le_variance =       0.298472103855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298431370323
                                         uncertainty =       0.002197897573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298431370323
                                         uncertainty =       0.002197897573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386310823
  error estimate for blocks of size 2^( 2) =       0.000396119354
  error estimate for blocks of size 2^( 3) =       0.000405213244
  error estimate for blocks of size 2^( 4) =       0.000412707463
  error estimate for blocks of size 2^( 5) =       0.000417292496
  error estimate for blocks of size 2^( 6) =       0.000420251927
  error estimate for blocks of size 2^( 7) =       0.000422627909

      target function =                  N/A
              le_mean =     -17.215977308465
             les_mean =     296.705189830270
             stat err =       0.000418219949
             autocorr =       1.172021931388
              std dev =       0.546326005106
             le_variance =       0.298472103855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298431370323
                                         uncertainty =       0.002197897573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298431370323
                                         uncertainty =       0.002197897573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386310823
  error estimate for blocks of size 2^( 2) =       0.000396119354
  error estimate for blocks of size 2^( 3) =       0.000405213244
  error estimate for blocks of size 2^( 4) =       0.000412707463
  error estimate for blocks of size 2^( 5) =       0.000417292496
  error estimate for blocks of size 2^( 6) =       0.000420251927
  error estimate for blocks of size 2^( 7) =       0.000422627909

      target function =                  N/A
              le_mean =     -17.215977308465
             les_mean =     296.705189830270
             stat err =       0.000418219949
             autocorr =       1.172021931388
              std dev =       0.546326005106
             le_variance =       0.298472103855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298431370323
                                         uncertainty =       0.002197897573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298431370323
                                         uncertainty =       0.002197897573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386310823
  error estimate for blocks of size 2^( 2) =       0.000396119354
  error estimate for blocks of size 2^( 3) =       0.000405213244
  error estimate for blocks of size 2^( 4) =       0.000412707463
  error estimate for blocks of size 2^( 5) =       0.000417292496
  error estimate for blocks of size 2^( 6) =       0.000420251927
  error estimate for blocks of size 2^( 7) =       0.000422627909

      target function =                  N/A
              le_mean =     -17.215977308465
             les_mean =     296.705189830270
             stat err =       0.000418219949
             autocorr =       1.172021931388
              std dev =       0.546326005106
             le_variance =       0.298472103855


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215977308465        initial  <--
     6.1035e+48     6.1035e+49             5.7758e-53       -17.215977308465
     2.4414e+49     2.4414e+50             1.4439e-53       -17.215977308465
     9.7656e+49     9.7656e+50             3.6099e-54       -17.215977308465

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.4751
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8994e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.1588
    reference variance = 0.245748
====================================================
  Execution time = 1.3531e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1214e-01
  Total weights = 1.956562820e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297163684132
                                         uncertainty =       0.001726238127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297163684132
                                         uncertainty =       0.001726238127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385425596
  error estimate for blocks of size 2^( 2) =       0.000395681451
  error estimate for blocks of size 2^( 3) =       0.000404472356
  error estimate for blocks of size 2^( 4) =       0.000411169506
  error estimate for blocks of size 2^( 5) =       0.000415938944
  error estimate for blocks of size 2^( 6) =       0.000417775744
  error estimate for blocks of size 2^( 7) =       0.000418493711

      target function =                  N/A
              le_mean =     -17.216542581135
             les_mean =     296.721476367488
             stat err =       0.000415844476
             autocorr =       1.164074480164
              std dev =       0.545074105557
             le_variance =       0.297105780549


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654258113e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+49, overlap shift 6.1035e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216542581158       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216542581158       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+50, overlap shift 2.4414e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216542581158       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216542581158       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+50, overlap shift 9.7656e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216542581158       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216542581158       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.414387 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6051e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.24
    reference variance = 0.400443
====================================================
  Execution time = 1.3448e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0912e-01
  Total weights = 1.9566e+06
  Execution time = 1.8195e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296463360727
                                         uncertainty =       0.001935857550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296463360727
                                         uncertainty =       0.001935857550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384997819
  error estimate for blocks of size 2^( 2) =       0.000395213298
  error estimate for blocks of size 2^( 3) =       0.000404530270
  error estimate for blocks of size 2^( 4) =       0.000412119207
  error estimate for blocks of size 2^( 5) =       0.000416078257
  error estimate for blocks of size 2^( 6) =       0.000419076429
  error estimate for blocks of size 2^( 7) =       0.000420705975

      target function =                  N/A
              le_mean =     -17.216622590278
             les_mean =     296.721215511909
             stat err =       0.000416994967
             autocorr =       1.173127155309
              std dev =       0.544469137018
             le_variance =       0.296446641166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296463360727
                                         uncertainty =       0.001935857550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296463360727
                                         uncertainty =       0.001935857550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384997819
  error estimate for blocks of size 2^( 2) =       0.000395213298
  error estimate for blocks of size 2^( 3) =       0.000404530270
  error estimate for blocks of size 2^( 4) =       0.000412119207
  error estimate for blocks of size 2^( 5) =       0.000416078257
  error estimate for blocks of size 2^( 6) =       0.000419076429
  error estimate for blocks of size 2^( 7) =       0.000420705975

      target function =                  N/A
              le_mean =     -17.216622590278
             les_mean =     296.721215511909
             stat err =       0.000416994967
             autocorr =       1.173127155309
              std dev =       0.544469137018
             le_variance =       0.296446641166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296463360727
                                         uncertainty =       0.001935857550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296463360727
                                         uncertainty =       0.001935857550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384997819
  error estimate for blocks of size 2^( 2) =       0.000395213298
  error estimate for blocks of size 2^( 3) =       0.000404530270
  error estimate for blocks of size 2^( 4) =       0.000412119207
  error estimate for blocks of size 2^( 5) =       0.000416078257
  error estimate for blocks of size 2^( 6) =       0.000419076429
  error estimate for blocks of size 2^( 7) =       0.000420705975

      target function =                  N/A
              le_mean =     -17.216622590278
             les_mean =     296.721215511909
             stat err =       0.000416994967
             autocorr =       1.173127155309
              std dev =       0.544469137018
             le_variance =       0.296446641166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296463360727
                                         uncertainty =       0.001935857550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296463360727
                                         uncertainty =       0.001935857550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384997819
  error estimate for blocks of size 2^( 2) =       0.000395213298
  error estimate for blocks of size 2^( 3) =       0.000404530270
  error estimate for blocks of size 2^( 4) =       0.000412119207
  error estimate for blocks of size 2^( 5) =       0.000416078257
  error estimate for blocks of size 2^( 6) =       0.000419076429
  error estimate for blocks of size 2^( 7) =       0.000420705975

      target function =                  N/A
              le_mean =     -17.216622590278
             les_mean =     296.721215511909
             stat err =       0.000416994967
             autocorr =       1.173127155309
              std dev =       0.544469137018
             le_variance =       0.296446641166


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216622590278        initial  <--
     6.1035e+49     6.1035e+50             0.0000e+00       -17.216622590278
     2.4414e+50     2.4414e+51             0.0000e+00       -17.216622590278
     9.7656e+50     9.7656e+51             0.0000e+00       -17.216622590278

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6328
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8697e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.2122
    reference variance = 0.190571
====================================================
  Execution time = 1.3637e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1226e-01
  Total weights = 1.957027590e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4921e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297277889781
                                         uncertainty =       0.002157679960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297277889781
                                         uncertainty =       0.002157679960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385556155
  error estimate for blocks of size 2^( 2) =       0.000395631443
  error estimate for blocks of size 2^( 3) =       0.000404285125
  error estimate for blocks of size 2^( 4) =       0.000411493681
  error estimate for blocks of size 2^( 5) =       0.000416476036
  error estimate for blocks of size 2^( 6) =       0.000419380524
  error estimate for blocks of size 2^( 7) =       0.000420311072

      target function =                  N/A
              le_mean =     -17.216414796873
             les_mean =     296.717199921968
             stat err =       0.000416915328
             autocorr =       1.169285178413
              std dev =       0.545258742831
             le_variance =       0.297307096634


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721641479687e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+50, overlap shift 6.1035e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216414796913       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216414796913       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+51, overlap shift 2.4414e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216414796913       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216414796913       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+51, overlap shift 9.7656e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216414796913       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216414796913       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.415391 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6134e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.1824
    reference variance = 0.238129
====================================================
  Execution time = 1.3420e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1330e-01
  Total weights = 1.9566e+06
  Execution time = 1.8080e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299641035180
                                         uncertainty =       0.002007992540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299641035180
                                         uncertainty =       0.002007992540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387038071
  error estimate for blocks of size 2^( 2) =       0.000396781448
  error estimate for blocks of size 2^( 3) =       0.000405948639
  error estimate for blocks of size 2^( 4) =       0.000412076629
  error estimate for blocks of size 2^( 5) =       0.000415808271
  error estimate for blocks of size 2^( 6) =       0.000418244962
  error estimate for blocks of size 2^( 7) =       0.000419190220

      target function =                  N/A
              le_mean =     -17.215433747393
             les_mean =     296.684456371961
             stat err =       0.000416330020
             autocorr =       1.157092513139
              std dev =       0.547354488534
             le_variance =       0.299596936118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299641035180
                                         uncertainty =       0.002007992540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299641035180
                                         uncertainty =       0.002007992540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387038071
  error estimate for blocks of size 2^( 2) =       0.000396781448
  error estimate for blocks of size 2^( 3) =       0.000405948639
  error estimate for blocks of size 2^( 4) =       0.000412076629
  error estimate for blocks of size 2^( 5) =       0.000415808271
  error estimate for blocks of size 2^( 6) =       0.000418244962
  error estimate for blocks of size 2^( 7) =       0.000419190220

      target function =                  N/A
              le_mean =     -17.215433747393
             les_mean =     296.684456371961
             stat err =       0.000416330020
             autocorr =       1.157092513139
              std dev =       0.547354488534
             le_variance =       0.299596936118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299641035180
                                         uncertainty =       0.002007992540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299641035180
                                         uncertainty =       0.002007992540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387038071
  error estimate for blocks of size 2^( 2) =       0.000396781448
  error estimate for blocks of size 2^( 3) =       0.000405948639
  error estimate for blocks of size 2^( 4) =       0.000412076629
  error estimate for blocks of size 2^( 5) =       0.000415808271
  error estimate for blocks of size 2^( 6) =       0.000418244962
  error estimate for blocks of size 2^( 7) =       0.000419190220

      target function =                  N/A
              le_mean =     -17.215433747393
             les_mean =     296.684456371961
             stat err =       0.000416330020
             autocorr =       1.157092513139
              std dev =       0.547354488534
             le_variance =       0.299596936118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299641035180
                                         uncertainty =       0.002007992540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299641035180
                                         uncertainty =       0.002007992540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387038071
  error estimate for blocks of size 2^( 2) =       0.000396781448
  error estimate for blocks of size 2^( 3) =       0.000405948639
  error estimate for blocks of size 2^( 4) =       0.000412076629
  error estimate for blocks of size 2^( 5) =       0.000415808271
  error estimate for blocks of size 2^( 6) =       0.000418244962
  error estimate for blocks of size 2^( 7) =       0.000419190220

      target function =                  N/A
              le_mean =     -17.215433747393
             les_mean =     296.684456371961
             stat err =       0.000416330020
             autocorr =       1.157092513139
              std dev =       0.547354488534
             le_variance =       0.299596936118


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215433747393        initial  <--
     6.1035e+50     6.1035e+51             0.0000e+00       -17.215433747393
     2.4414e+51     2.4414e+52             0.0000e+00       -17.215433747393
     9.7656e+51     9.7656e+52             0.0000e+00       -17.215433747393

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5469
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8690e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.1251
    reference variance = 0.174971
====================================================
  Execution time = 1.3761e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1339e-01
  Total weights = 1.956655767e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4720e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300286321741
                                         uncertainty =       0.001893586723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300286321741
                                         uncertainty =       0.001893586723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387509279
  error estimate for blocks of size 2^( 2) =       0.000397617975
  error estimate for blocks of size 2^( 3) =       0.000406954561
  error estimate for blocks of size 2^( 4) =       0.000414158211
  error estimate for blocks of size 2^( 5) =       0.000418920128
  error estimate for blocks of size 2^( 6) =       0.000420960246
  error estimate for blocks of size 2^( 7) =       0.000420537681

      target function =                  N/A
              le_mean =     -17.216719634503
             les_mean =     296.728827963485
             stat err =       0.000418644067
             autocorr =       1.167147297958
              std dev =       0.548020877648
             le_variance =       0.300326882338


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721671963450e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+51, overlap shift 6.1035e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216719634557       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216719634557       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+52, overlap shift 2.4414e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216719634557       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216719634557       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+52, overlap shift 9.7656e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216719634557       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216719634557       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.416461 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6238e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.1852
    reference variance = 0.218475
====================================================
  Execution time = 1.3487e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1561e-01
  Total weights = 1.9565e+06
  Execution time = 1.8110e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300414609218
                                         uncertainty =       0.001686316511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300414609218
                                         uncertainty =       0.001686316511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387535415
  error estimate for blocks of size 2^( 2) =       0.000397498201
  error estimate for blocks of size 2^( 3) =       0.000406225710
  error estimate for blocks of size 2^( 4) =       0.000412893786
  error estimate for blocks of size 2^( 5) =       0.000417539235
  error estimate for blocks of size 2^( 6) =       0.000420974676
  error estimate for blocks of size 2^( 7) =       0.000422624249

      target function =                  N/A
              le_mean =     -17.216181473537
             les_mean =     296.712513686911
             stat err =       0.000418507987
             autocorr =       1.166231339291
              std dev =       0.548057839276
             le_variance =       0.300367395192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300414609218
                                         uncertainty =       0.001686316511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300414609218
                                         uncertainty =       0.001686316511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387535415
  error estimate for blocks of size 2^( 2) =       0.000397498201
  error estimate for blocks of size 2^( 3) =       0.000406225710
  error estimate for blocks of size 2^( 4) =       0.000412893786
  error estimate for blocks of size 2^( 5) =       0.000417539235
  error estimate for blocks of size 2^( 6) =       0.000420974676
  error estimate for blocks of size 2^( 7) =       0.000422624249

      target function =                  N/A
              le_mean =     -17.216181473537
             les_mean =     296.712513686911
             stat err =       0.000418507987
             autocorr =       1.166231339291
              std dev =       0.548057839276
             le_variance =       0.300367395192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300414609218
                                         uncertainty =       0.001686316511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300414609218
                                         uncertainty =       0.001686316511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387535415
  error estimate for blocks of size 2^( 2) =       0.000397498201
  error estimate for blocks of size 2^( 3) =       0.000406225710
  error estimate for blocks of size 2^( 4) =       0.000412893786
  error estimate for blocks of size 2^( 5) =       0.000417539235
  error estimate for blocks of size 2^( 6) =       0.000420974676
  error estimate for blocks of size 2^( 7) =       0.000422624249

      target function =                  N/A
              le_mean =     -17.216181473537
             les_mean =     296.712513686911
             stat err =       0.000418507987
             autocorr =       1.166231339291
              std dev =       0.548057839276
             le_variance =       0.300367395192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300414609218
                                         uncertainty =       0.001686316511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300414609218
                                         uncertainty =       0.001686316511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387535415
  error estimate for blocks of size 2^( 2) =       0.000397498201
  error estimate for blocks of size 2^( 3) =       0.000406225710
  error estimate for blocks of size 2^( 4) =       0.000412893786
  error estimate for blocks of size 2^( 5) =       0.000417539235
  error estimate for blocks of size 2^( 6) =       0.000420974676
  error estimate for blocks of size 2^( 7) =       0.000422624249

      target function =                  N/A
              le_mean =     -17.216181473537
             les_mean =     296.712513686911
             stat err =       0.000418507987
             autocorr =       1.166231339291
              std dev =       0.548057839276
             le_variance =       0.300367395192


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216181473537        initial  <--
     6.1035e+51     6.1035e+52             0.0000e+00       -17.216181473537
     2.4414e+52     2.4414e+53             0.0000e+00       -17.216181473537
     9.7656e+52     9.7656e+53             0.0000e+00       -17.216181473537

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6144
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8865e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.1671
    reference variance = 0.262782
====================================================
  Execution time = 1.3597e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1544e-01
  Total weights = 1.956573755e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4695e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301172546480
                                         uncertainty =       0.001844771632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301172546480
                                         uncertainty =       0.001844771632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388183729
  error estimate for blocks of size 2^( 2) =       0.000397768403
  error estimate for blocks of size 2^( 3) =       0.000406775873
  error estimate for blocks of size 2^( 4) =       0.000413541825
  error estimate for blocks of size 2^( 5) =       0.000417096273
  error estimate for blocks of size 2^( 6) =       0.000419624648
  error estimate for blocks of size 2^( 7) =       0.000421239722

      target function =                  N/A
              le_mean =     -17.216315879703
             les_mean =     296.716970091497
             stat err =       0.000417875617
             autocorr =       1.158829137944
              std dev =       0.548974694304
             le_variance =       0.301373214987


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721631587970e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+52, overlap shift 6.1035e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216315879724       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216315879724       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216315879724       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+52 is 7.911469e-57

solving harmonic davidson linear method for identity shift 2.4414e+53, overlap shift 2.4414e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216315879724       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216315879724       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216315879724       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+53 is 1.977867e-57

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+53, overlap shift 9.7656e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216315879724       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216315879724       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216315879724       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+53 is 4.944668e-58

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.417784 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6071e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.2812
    reference variance = 0.437414
====================================================
  Execution time = 1.5644e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1893e-01
  Total weights = 1.9566e+06
  Execution time = 1.8094e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303757883122
                                         uncertainty =       0.003335518344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303757883122
                                         uncertainty =       0.003335518344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389662645
  error estimate for blocks of size 2^( 2) =       0.000399193841
  error estimate for blocks of size 2^( 3) =       0.000408115646
  error estimate for blocks of size 2^( 4) =       0.000415034759
  error estimate for blocks of size 2^( 5) =       0.000419628570
  error estimate for blocks of size 2^( 6) =       0.000420240808
  error estimate for blocks of size 2^( 7) =       0.000420945752

      target function =                  N/A
              le_mean =     -17.217138542871
             les_mean =     296.748792415871
             stat err =       0.000418962473
             autocorr =       1.156039567849
              std dev =       0.551066197815
             le_variance =       0.303673954375

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303757883122
                                         uncertainty =       0.003335518344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303757883122
                                         uncertainty =       0.003335518344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389662645
  error estimate for blocks of size 2^( 2) =       0.000399193841
  error estimate for blocks of size 2^( 3) =       0.000408115646
  error estimate for blocks of size 2^( 4) =       0.000415034759
  error estimate for blocks of size 2^( 5) =       0.000419628570
  error estimate for blocks of size 2^( 6) =       0.000420240808
  error estimate for blocks of size 2^( 7) =       0.000420945752

      target function =                  N/A
              le_mean =     -17.217138542871
             les_mean =     296.748792415871
             stat err =       0.000418962473
             autocorr =       1.156039567849
              std dev =       0.551066197815
             le_variance =       0.303673954375

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303757883122
                                         uncertainty =       0.003335518344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303757883122
                                         uncertainty =       0.003335518344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389662645
  error estimate for blocks of size 2^( 2) =       0.000399193841
  error estimate for blocks of size 2^( 3) =       0.000408115646
  error estimate for blocks of size 2^( 4) =       0.000415034759
  error estimate for blocks of size 2^( 5) =       0.000419628570
  error estimate for blocks of size 2^( 6) =       0.000420240808
  error estimate for blocks of size 2^( 7) =       0.000420945752

      target function =                  N/A
              le_mean =     -17.217138542871
             les_mean =     296.748792415871
             stat err =       0.000418962473
             autocorr =       1.156039567849
              std dev =       0.551066197815
             le_variance =       0.303673954375

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303757883122
                                         uncertainty =       0.003335518344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303757883122
                                         uncertainty =       0.003335518344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389662645
  error estimate for blocks of size 2^( 2) =       0.000399193841
  error estimate for blocks of size 2^( 3) =       0.000408115646
  error estimate for blocks of size 2^( 4) =       0.000415034759
  error estimate for blocks of size 2^( 5) =       0.000419628570
  error estimate for blocks of size 2^( 6) =       0.000420240808
  error estimate for blocks of size 2^( 7) =       0.000420945752

      target function =                  N/A
              le_mean =     -17.217138542871
             les_mean =     296.748792415871
             stat err =       0.000418962473
             autocorr =       1.156039567849
              std dev =       0.551066197815
             le_variance =       0.303673954375


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217138542871        initial  <--
     6.1035e+52     6.1035e+53             7.9115e-57       -17.217138542871
     2.4414e+53     2.4414e+54             1.9779e-57       -17.217138542871
     9.7656e+53     9.7656e+54             4.9447e-58       -17.217138542871

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.7784
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0857e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.2958
    reference variance = 0.178743
====================================================
  Execution time = 1.3589e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1563e-01
  Total weights = 1.956372668e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4717e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300900979896
                                         uncertainty =       0.002514647863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300900979896
                                         uncertainty =       0.002514647863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387901324
  error estimate for blocks of size 2^( 2) =       0.000397764824
  error estimate for blocks of size 2^( 3) =       0.000406877841
  error estimate for blocks of size 2^( 4) =       0.000413262279
  error estimate for blocks of size 2^( 5) =       0.000416762246
  error estimate for blocks of size 2^( 6) =       0.000419280017
  error estimate for blocks of size 2^( 7) =       0.000419587014

      target function =                  N/A
              le_mean =     -17.217009700860
             les_mean =     296.741049514751
             stat err =       0.000417222889
             autocorr =       1.156894425262
              std dev =       0.548575312867
             le_variance =       0.300934873888


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721700970086e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+53, overlap shift 6.1035e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217009700882       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217009700882       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217009700882       residual = 8.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+53 is 4.107308e-58

solving harmonic davidson linear method for identity shift 2.4414e+54, overlap shift 2.4414e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217009700882       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217009700882       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217009700882       residual = 8.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+54 is 1.026827e-58

solving harmonic davidson linear method for identity shift 9.7656e+54, overlap shift 9.7656e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217009700882       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217009700882       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217009700882       residual = 8.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+54 is 2.567068e-59

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.418761 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6066e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.1584
    reference variance = 0.219476
====================================================
  Execution time = 1.3600e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1133e-01
  Total weights = 1.9569e+06
  Execution time = 1.8148e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297905396089
                                         uncertainty =       0.001999279936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297905396089
                                         uncertainty =       0.001999279936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385895088
  error estimate for blocks of size 2^( 2) =       0.000396215868
  error estimate for blocks of size 2^( 3) =       0.000405026948
  error estimate for blocks of size 2^( 4) =       0.000412045951
  error estimate for blocks of size 2^( 5) =       0.000415831864
  error estimate for blocks of size 2^( 6) =       0.000417539454
  error estimate for blocks of size 2^( 7) =       0.000418882897

      target function =                  N/A
              le_mean =     -17.216575127836
             les_mean =     296.721793229143
             stat err =       0.000416075042
             autocorr =       1.162531767297
              std dev =       0.545738067452
             le_variance =       0.297830038266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297905396089
                                         uncertainty =       0.001999279936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297905396089
                                         uncertainty =       0.001999279936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385895088
  error estimate for blocks of size 2^( 2) =       0.000396215868
  error estimate for blocks of size 2^( 3) =       0.000405026948
  error estimate for blocks of size 2^( 4) =       0.000412045951
  error estimate for blocks of size 2^( 5) =       0.000415831864
  error estimate for blocks of size 2^( 6) =       0.000417539454
  error estimate for blocks of size 2^( 7) =       0.000418882897

      target function =                  N/A
              le_mean =     -17.216575127836
             les_mean =     296.721793229143
             stat err =       0.000416075042
             autocorr =       1.162531767296
              std dev =       0.545738067452
             le_variance =       0.297830038266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297905396089
                                         uncertainty =       0.001999279936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297905396089
                                         uncertainty =       0.001999279936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385895088
  error estimate for blocks of size 2^( 2) =       0.000396215868
  error estimate for blocks of size 2^( 3) =       0.000405026948
  error estimate for blocks of size 2^( 4) =       0.000412045951
  error estimate for blocks of size 2^( 5) =       0.000415831864
  error estimate for blocks of size 2^( 6) =       0.000417539454
  error estimate for blocks of size 2^( 7) =       0.000418882897

      target function =                  N/A
              le_mean =     -17.216575127836
             les_mean =     296.721793229143
             stat err =       0.000416075042
             autocorr =       1.162531767296
              std dev =       0.545738067452
             le_variance =       0.297830038266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297905396089
                                         uncertainty =       0.001999279936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297905396089
                                         uncertainty =       0.001999279936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385895088
  error estimate for blocks of size 2^( 2) =       0.000396215868
  error estimate for blocks of size 2^( 3) =       0.000405026948
  error estimate for blocks of size 2^( 4) =       0.000412045951
  error estimate for blocks of size 2^( 5) =       0.000415831864
  error estimate for blocks of size 2^( 6) =       0.000417539454
  error estimate for blocks of size 2^( 7) =       0.000418882897

      target function =                  N/A
              le_mean =     -17.216575127836
             les_mean =     296.721793229143
             stat err =       0.000416075042
             autocorr =       1.162531767296
              std dev =       0.545738067452
             le_variance =       0.297830038266


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216575127836        initial  <--
     6.1035e+53     6.1035e+54             4.1073e-58       -17.216575127836
     2.4414e+54     2.4414e+55             1.0268e-58       -17.216575127836
     9.7656e+54     9.7656e+55             2.5671e-59       -17.216575127836

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7494
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8822e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.1683
    reference variance = 0.307568
====================================================
  Execution time = 1.3675e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1698e-01
  Total weights = 1.956472770e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4774e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300303621798
                                         uncertainty =       0.001959349985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300303621798
                                         uncertainty =       0.001959349985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387474497
  error estimate for blocks of size 2^( 2) =       0.000397409475
  error estimate for blocks of size 2^( 3) =       0.000406584599
  error estimate for blocks of size 2^( 4) =       0.000413291275
  error estimate for blocks of size 2^( 5) =       0.000418044351
  error estimate for blocks of size 2^( 6) =       0.000420249424
  error estimate for blocks of size 2^( 7) =       0.000422588909

      target function =                  N/A
              le_mean =     -17.216681071206
             les_mean =     296.731084517096
             stat err =       0.000418543489
             autocorr =       1.166796009508
              std dev =       0.547971688784
             le_variance =       0.300272971709


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721668107121e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+54, overlap shift 6.1035e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216681071268       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216681071268       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+55, overlap shift 2.4414e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216681071268       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216681071268       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+55, overlap shift 9.7656e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216681071268       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216681071268       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.419903 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6158e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.2236
    reference variance = 0.134995
====================================================
  Execution time = 1.3659e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1567e-01
  Total weights = 1.9566e+06
  Execution time = 1.8105e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299219289664
                                         uncertainty =       0.001786584056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299219289664
                                         uncertainty =       0.001786584056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386716525
  error estimate for blocks of size 2^( 2) =       0.000396648591
  error estimate for blocks of size 2^( 3) =       0.000406043132
  error estimate for blocks of size 2^( 4) =       0.000412785227
  error estimate for blocks of size 2^( 5) =       0.000416878539
  error estimate for blocks of size 2^( 6) =       0.000417411614
  error estimate for blocks of size 2^( 7) =       0.000418162203

      target function =                  N/A
              le_mean =     -17.216674655429
             les_mean =     296.729551704751
             stat err =       0.000416309396
             autocorr =       1.158902675575
              std dev =       0.546899753890
             le_variance =       0.299099340805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299219289664
                                         uncertainty =       0.001786584056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299219289664
                                         uncertainty =       0.001786584056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386716525
  error estimate for blocks of size 2^( 2) =       0.000396648591
  error estimate for blocks of size 2^( 3) =       0.000406043132
  error estimate for blocks of size 2^( 4) =       0.000412785227
  error estimate for blocks of size 2^( 5) =       0.000416878539
  error estimate for blocks of size 2^( 6) =       0.000417411614
  error estimate for blocks of size 2^( 7) =       0.000418162203

      target function =                  N/A
              le_mean =     -17.216674655429
             les_mean =     296.729551704751
             stat err =       0.000416309396
             autocorr =       1.158902675575
              std dev =       0.546899753890
             le_variance =       0.299099340805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299219289664
                                         uncertainty =       0.001786584056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299219289664
                                         uncertainty =       0.001786584056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386716525
  error estimate for blocks of size 2^( 2) =       0.000396648591
  error estimate for blocks of size 2^( 3) =       0.000406043132
  error estimate for blocks of size 2^( 4) =       0.000412785227
  error estimate for blocks of size 2^( 5) =       0.000416878539
  error estimate for blocks of size 2^( 6) =       0.000417411614
  error estimate for blocks of size 2^( 7) =       0.000418162203

      target function =                  N/A
              le_mean =     -17.216674655429
             les_mean =     296.729551704751
             stat err =       0.000416309396
             autocorr =       1.158902675575
              std dev =       0.546899753890
             le_variance =       0.299099340805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299219289664
                                         uncertainty =       0.001786584056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299219289664
                                         uncertainty =       0.001786584056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386716525
  error estimate for blocks of size 2^( 2) =       0.000396648591
  error estimate for blocks of size 2^( 3) =       0.000406043132
  error estimate for blocks of size 2^( 4) =       0.000412785227
  error estimate for blocks of size 2^( 5) =       0.000416878539
  error estimate for blocks of size 2^( 6) =       0.000417411614
  error estimate for blocks of size 2^( 7) =       0.000418162203

      target function =                  N/A
              le_mean =     -17.216674655429
             les_mean =     296.729551704751
             stat err =       0.000416309396
             autocorr =       1.158902675575
              std dev =       0.546899753890
             le_variance =       0.299099340805


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216674655429        initial  <--
     6.1035e+54     6.1035e+55             0.0000e+00       -17.216674655429
     2.4414e+55     2.4414e+56             0.0000e+00       -17.216674655429
     9.7656e+55     9.7656e+56             0.0000e+00       -17.216674655429

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7910
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8957e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.167
    reference variance = 0.362646
====================================================
  Execution time = 1.3757e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0929e-01
  Total weights = 1.956569296e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4762e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294801292159
                                         uncertainty =       0.001764455188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294801292159
                                         uncertainty =       0.001764455188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384279622
  error estimate for blocks of size 2^( 2) =       0.000394324376
  error estimate for blocks of size 2^( 3) =       0.000404070005
  error estimate for blocks of size 2^( 4) =       0.000411114080
  error estimate for blocks of size 2^( 5) =       0.000415550153
  error estimate for blocks of size 2^( 6) =       0.000417003753
  error estimate for blocks of size 2^( 7) =       0.000417669819

      target function =                  N/A
              le_mean =     -17.216512141808
             les_mean =     296.717575724799
             stat err =       0.000415334451
             autocorr =       1.168156964724
              std dev =       0.543453453618
             le_variance =       0.295341656249


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721651214181e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+55, overlap shift 6.1035e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216512141855       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216512141855       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+56, overlap shift 2.4414e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216512141855       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216512141855       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+56, overlap shift 9.7656e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216512141855       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216512141855       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.420992 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6239e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.2627
    reference variance = 0.319955
====================================================
  Execution time = 1.3492e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1546e-01
  Total weights = 1.9564e+06
  Execution time = 1.8137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300072179147
                                         uncertainty =       0.002216397351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300072179147
                                         uncertainty =       0.002216397351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387340338
  error estimate for blocks of size 2^( 2) =       0.000397177532
  error estimate for blocks of size 2^( 3) =       0.000406218052
  error estimate for blocks of size 2^( 4) =       0.000412406764
  error estimate for blocks of size 2^( 5) =       0.000416384459
  error estimate for blocks of size 2^( 6) =       0.000418511195
  error estimate for blocks of size 2^( 7) =       0.000418213003

      target function =                  N/A
              le_mean =     -17.215887365469
             les_mean =     296.702233801583
             stat err =       0.000416378855
             autocorr =       1.155558348491
              std dev =       0.547781959295
             le_variance =       0.300065074929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300072179147
                                         uncertainty =       0.002216397351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300072179147
                                         uncertainty =       0.002216397351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387340338
  error estimate for blocks of size 2^( 2) =       0.000397177532
  error estimate for blocks of size 2^( 3) =       0.000406218052
  error estimate for blocks of size 2^( 4) =       0.000412406764
  error estimate for blocks of size 2^( 5) =       0.000416384459
  error estimate for blocks of size 2^( 6) =       0.000418511195
  error estimate for blocks of size 2^( 7) =       0.000418213003

      target function =                  N/A
              le_mean =     -17.215887365469
             les_mean =     296.702233801583
             stat err =       0.000416378855
             autocorr =       1.155558348491
              std dev =       0.547781959295
             le_variance =       0.300065074929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300072179147
                                         uncertainty =       0.002216397351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300072179147
                                         uncertainty =       0.002216397351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387340338
  error estimate for blocks of size 2^( 2) =       0.000397177532
  error estimate for blocks of size 2^( 3) =       0.000406218052
  error estimate for blocks of size 2^( 4) =       0.000412406764
  error estimate for blocks of size 2^( 5) =       0.000416384459
  error estimate for blocks of size 2^( 6) =       0.000418511195
  error estimate for blocks of size 2^( 7) =       0.000418213003

      target function =                  N/A
              le_mean =     -17.215887365469
             les_mean =     296.702233801583
             stat err =       0.000416378855
             autocorr =       1.155558348491
              std dev =       0.547781959295
             le_variance =       0.300065074929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300072179147
                                         uncertainty =       0.002216397351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300072179147
                                         uncertainty =       0.002216397351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387340338
  error estimate for blocks of size 2^( 2) =       0.000397177532
  error estimate for blocks of size 2^( 3) =       0.000406218052
  error estimate for blocks of size 2^( 4) =       0.000412406764
  error estimate for blocks of size 2^( 5) =       0.000416384459
  error estimate for blocks of size 2^( 6) =       0.000418511195
  error estimate for blocks of size 2^( 7) =       0.000418213003

      target function =                  N/A
              le_mean =     -17.215887365469
             les_mean =     296.702233801583
             stat err =       0.000416378855
             autocorr =       1.155558348491
              std dev =       0.547781959295
             le_variance =       0.300065074929


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215887365469        initial  <--
     6.1035e+55     6.1035e+56             0.0000e+00       -17.215887365469
     2.4414e+56     2.4414e+57             0.0000e+00       -17.215887365469
     9.7656e+56     9.7656e+57             0.0000e+00       -17.215887365469

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6377
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8892e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.2143
    reference variance = 0.280719
====================================================
  Execution time = 1.3637e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1240e-01
  Total weights = 1.956384702e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4935e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299514975437
                                         uncertainty =       0.002050038188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299514975437
                                         uncertainty =       0.002050038188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387009047
  error estimate for blocks of size 2^( 2) =       0.000396904038
  error estimate for blocks of size 2^( 3) =       0.000406185783
  error estimate for blocks of size 2^( 4) =       0.000412825400
  error estimate for blocks of size 2^( 5) =       0.000416607261
  error estimate for blocks of size 2^( 6) =       0.000418732948
  error estimate for blocks of size 2^( 7) =       0.000422135625

      target function =                  N/A
              le_mean =     -17.216425662258
             les_mean =     296.717712729392
             stat err =       0.000417575308
             autocorr =       1.164199437533
              std dev =       0.547313443718
             le_variance =       0.299552005674


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721642566226e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+56, overlap shift 6.1035e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216425662298       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216425662298       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+57, overlap shift 2.4414e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216425662298       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216425662298       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+57, overlap shift 9.7656e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216425662298       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216425662298       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.422034 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6136e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.1895
    reference variance = 0.265143
====================================================
  Execution time = 1.3202e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1152e-01
  Total weights = 1.9567e+06
  Execution time = 1.8136e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299373711493
                                         uncertainty =       0.002704426859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299373711493
                                         uncertainty =       0.002704426859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386832607
  error estimate for blocks of size 2^( 2) =       0.000396491921
  error estimate for blocks of size 2^( 3) =       0.000405894266
  error estimate for blocks of size 2^( 4) =       0.000411864343
  error estimate for blocks of size 2^( 5) =       0.000416247433
  error estimate for blocks of size 2^( 6) =       0.000417985883
  error estimate for blocks of size 2^( 7) =       0.000422063524

      target function =                  N/A
              le_mean =     -17.216178506893
             les_mean =     296.708324858129
             stat err =       0.000417040296
             autocorr =       1.162277660285
              std dev =       0.547063919461
             le_variance =       0.299278931976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299373711493
                                         uncertainty =       0.002704426859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299373711493
                                         uncertainty =       0.002704426859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386832607
  error estimate for blocks of size 2^( 2) =       0.000396491921
  error estimate for blocks of size 2^( 3) =       0.000405894266
  error estimate for blocks of size 2^( 4) =       0.000411864343
  error estimate for blocks of size 2^( 5) =       0.000416247433
  error estimate for blocks of size 2^( 6) =       0.000417985883
  error estimate for blocks of size 2^( 7) =       0.000422063524

      target function =                  N/A
              le_mean =     -17.216178506893
             les_mean =     296.708324858129
             stat err =       0.000417040296
             autocorr =       1.162277660285
              std dev =       0.547063919461
             le_variance =       0.299278931976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299373711493
                                         uncertainty =       0.002704426859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299373711493
                                         uncertainty =       0.002704426859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386832607
  error estimate for blocks of size 2^( 2) =       0.000396491921
  error estimate for blocks of size 2^( 3) =       0.000405894266
  error estimate for blocks of size 2^( 4) =       0.000411864343
  error estimate for blocks of size 2^( 5) =       0.000416247433
  error estimate for blocks of size 2^( 6) =       0.000417985883
  error estimate for blocks of size 2^( 7) =       0.000422063524

      target function =                  N/A
              le_mean =     -17.216178506893
             les_mean =     296.708324858129
             stat err =       0.000417040296
             autocorr =       1.162277660285
              std dev =       0.547063919461
             le_variance =       0.299278931976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299373711493
                                         uncertainty =       0.002704426859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299373711493
                                         uncertainty =       0.002704426859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386832607
  error estimate for blocks of size 2^( 2) =       0.000396491921
  error estimate for blocks of size 2^( 3) =       0.000405894266
  error estimate for blocks of size 2^( 4) =       0.000411864343
  error estimate for blocks of size 2^( 5) =       0.000416247433
  error estimate for blocks of size 2^( 6) =       0.000417985883
  error estimate for blocks of size 2^( 7) =       0.000422063524

      target function =                  N/A
              le_mean =     -17.216178506893
             les_mean =     296.708324858129
             stat err =       0.000417040296
             autocorr =       1.162277660285
              std dev =       0.547063919461
             le_variance =       0.299278931976


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216178506893        initial  <--
     6.1035e+56     6.1035e+57             0.0000e+00       -17.216178506893
     2.4414e+57     2.4414e+58             0.0000e+00       -17.216178506893
     9.7656e+57     9.7656e+58             0.0000e+00       -17.216178506893

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.3556
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8499e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.1694
    reference variance = 0.317957
====================================================
  Execution time = 1.3684e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5310e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1795e-01
  Total weights = 1.956793687e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4737e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302265469051
                                         uncertainty =       0.001953072364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302265469051
                                         uncertainty =       0.001953072364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388728408
  error estimate for blocks of size 2^( 2) =       0.000398483349
  error estimate for blocks of size 2^( 3) =       0.000407712046
  error estimate for blocks of size 2^( 4) =       0.000414867524
  error estimate for blocks of size 2^( 5) =       0.000418319215
  error estimate for blocks of size 2^( 6) =       0.000420551115
  error estimate for blocks of size 2^( 7) =       0.000421732372

      target function =                  N/A
              le_mean =     -17.217185213098
             les_mean =     296.749416131715
             stat err =       0.000418867557
             autocorr =       1.161076639819
              std dev =       0.549744986498
             le_variance =       0.302219550180


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721718521310e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+57, overlap shift 6.1035e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217185213114       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217185213114       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+58, overlap shift 2.4414e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217185213114       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217185213114       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+58, overlap shift 9.7656e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217185213114       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217185213114       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.423128 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6163e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.2433
    reference variance = 0.25473
====================================================
  Execution time = 1.3555e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1650e-01
  Total weights = 1.9567e+06
  Execution time = 1.8430e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300345523653
                                         uncertainty =       0.002372049935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300345523653
                                         uncertainty =       0.002372049935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387501736
  error estimate for blocks of size 2^( 2) =       0.000397822832
  error estimate for blocks of size 2^( 3) =       0.000406443822
  error estimate for blocks of size 2^( 4) =       0.000413169797
  error estimate for blocks of size 2^( 5) =       0.000417060657
  error estimate for blocks of size 2^( 6) =       0.000418235729
  error estimate for blocks of size 2^( 7) =       0.000419649035

      target function =                  N/A
              le_mean =     -17.216647097325
             les_mean =     296.729432281982
             stat err =       0.000417028804
             autocorr =       1.158203308640
              std dev =       0.548010210330
             le_variance =       0.300315190626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300345523653
                                         uncertainty =       0.002372049935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300345523653
                                         uncertainty =       0.002372049935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387501736
  error estimate for blocks of size 2^( 2) =       0.000397822832
  error estimate for blocks of size 2^( 3) =       0.000406443822
  error estimate for blocks of size 2^( 4) =       0.000413169797
  error estimate for blocks of size 2^( 5) =       0.000417060657
  error estimate for blocks of size 2^( 6) =       0.000418235729
  error estimate for blocks of size 2^( 7) =       0.000419649035

      target function =                  N/A
              le_mean =     -17.216647097325
             les_mean =     296.729432281982
             stat err =       0.000417028804
             autocorr =       1.158203308640
              std dev =       0.548010210330
             le_variance =       0.300315190626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300345523653
                                         uncertainty =       0.002372049935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300345523653
                                         uncertainty =       0.002372049935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387501736
  error estimate for blocks of size 2^( 2) =       0.000397822832
  error estimate for blocks of size 2^( 3) =       0.000406443822
  error estimate for blocks of size 2^( 4) =       0.000413169797
  error estimate for blocks of size 2^( 5) =       0.000417060657
  error estimate for blocks of size 2^( 6) =       0.000418235729
  error estimate for blocks of size 2^( 7) =       0.000419649035

      target function =                  N/A
              le_mean =     -17.216647097325
             les_mean =     296.729432281982
             stat err =       0.000417028804
             autocorr =       1.158203308640
              std dev =       0.548010210330
             le_variance =       0.300315190626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300345523653
                                         uncertainty =       0.002372049935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300345523653
                                         uncertainty =       0.002372049935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387501736
  error estimate for blocks of size 2^( 2) =       0.000397822832
  error estimate for blocks of size 2^( 3) =       0.000406443822
  error estimate for blocks of size 2^( 4) =       0.000413169797
  error estimate for blocks of size 2^( 5) =       0.000417060657
  error estimate for blocks of size 2^( 6) =       0.000418235729
  error estimate for blocks of size 2^( 7) =       0.000419649035

      target function =                  N/A
              le_mean =     -17.216647097325
             les_mean =     296.729432281982
             stat err =       0.000417028804
             autocorr =       1.158203308640
              std dev =       0.548010210330
             le_variance =       0.300315190626


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216647097325        initial  <--
     6.1035e+57     6.1035e+58             0.0000e+00       -17.216647097325
     2.4414e+58     2.4414e+59             0.0000e+00       -17.216647097325
     9.7656e+58     9.7656e+59             0.0000e+00       -17.216647097325

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9419
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9114e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.1999
    reference variance = 0.311725
====================================================
  Execution time = 1.4112e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1553e-01
  Total weights = 1.956699729e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4900e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301595890585
                                         uncertainty =       0.002281693679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301595890585
                                         uncertainty =       0.002281693679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388316879
  error estimate for blocks of size 2^( 2) =       0.000398559802
  error estimate for blocks of size 2^( 3) =       0.000407709108
  error estimate for blocks of size 2^( 4) =       0.000414355597
  error estimate for blocks of size 2^( 5) =       0.000418236962
  error estimate for blocks of size 2^( 6) =       0.000420632974
  error estimate for blocks of size 2^( 7) =       0.000421277057

      target function =                  N/A
              le_mean =     -17.216193424036
             les_mean =     296.712846609764
             stat err =       0.000418625648
             autocorr =       1.162195336278
              std dev =       0.549162996485
             le_variance =       0.301579996709


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721619342404e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+58, overlap shift 6.1035e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216193424077       residual = 8.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216193424077       residual = 8.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+59, overlap shift 2.4414e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216193424077       residual = 8.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216193424077       residual = 8.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+59, overlap shift 9.7656e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216193424077       residual = 8.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216193424077       residual = 8.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.424219 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6607e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.2675
    reference variance = 0.283342
====================================================
  Execution time = 1.3421e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1732e-01
  Total weights = 1.9568e+06
  Execution time = 1.8434e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299386614857
                                         uncertainty =       0.002024128489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299386614857
                                         uncertainty =       0.002024128489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386846812
  error estimate for blocks of size 2^( 2) =       0.000397026866
  error estimate for blocks of size 2^( 3) =       0.000406242429
  error estimate for blocks of size 2^( 4) =       0.000412638164
  error estimate for blocks of size 2^( 5) =       0.000417253038
  error estimate for blocks of size 2^( 6) =       0.000419042841
  error estimate for blocks of size 2^( 7) =       0.000419867642

      target function =                  N/A
              le_mean =     -17.216912006893
             les_mean =     296.739382636357
             stat err =       0.000417200421
             autocorr =       1.163084941550
              std dev =       0.547084007764
             le_variance =       0.299300911552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299386614857
                                         uncertainty =       0.002024128489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299386614857
                                         uncertainty =       0.002024128489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386846812
  error estimate for blocks of size 2^( 2) =       0.000397026866
  error estimate for blocks of size 2^( 3) =       0.000406242429
  error estimate for blocks of size 2^( 4) =       0.000412638164
  error estimate for blocks of size 2^( 5) =       0.000417253038
  error estimate for blocks of size 2^( 6) =       0.000419042841
  error estimate for blocks of size 2^( 7) =       0.000419867642

      target function =                  N/A
              le_mean =     -17.216912006893
             les_mean =     296.739382636357
             stat err =       0.000417200421
             autocorr =       1.163084941550
              std dev =       0.547084007764
             le_variance =       0.299300911552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299386614857
                                         uncertainty =       0.002024128489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299386614857
                                         uncertainty =       0.002024128489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386846812
  error estimate for blocks of size 2^( 2) =       0.000397026866
  error estimate for blocks of size 2^( 3) =       0.000406242429
  error estimate for blocks of size 2^( 4) =       0.000412638164
  error estimate for blocks of size 2^( 5) =       0.000417253038
  error estimate for blocks of size 2^( 6) =       0.000419042841
  error estimate for blocks of size 2^( 7) =       0.000419867642

      target function =                  N/A
              le_mean =     -17.216912006893
             les_mean =     296.739382636357
             stat err =       0.000417200421
             autocorr =       1.163084941550
              std dev =       0.547084007764
             le_variance =       0.299300911552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299386614857
                                         uncertainty =       0.002024128489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299386614857
                                         uncertainty =       0.002024128489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386846812
  error estimate for blocks of size 2^( 2) =       0.000397026866
  error estimate for blocks of size 2^( 3) =       0.000406242429
  error estimate for blocks of size 2^( 4) =       0.000412638164
  error estimate for blocks of size 2^( 5) =       0.000417253038
  error estimate for blocks of size 2^( 6) =       0.000419042841
  error estimate for blocks of size 2^( 7) =       0.000419867642

      target function =                  N/A
              le_mean =     -17.216912006893
             les_mean =     296.739382636357
             stat err =       0.000417200421
             autocorr =       1.163084941550
              std dev =       0.547084007764
             le_variance =       0.299300911552


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216912006893        initial  <--
     6.1035e+58     6.1035e+59             0.0000e+00       -17.216912006893
     2.4414e+59     2.4414e+60             0.0000e+00       -17.216912006893
     9.7656e+59     9.7656e+60             0.0000e+00       -17.216912006893

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6939
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9315e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.3047
    reference variance = 0.24786
====================================================
  Execution time = 1.3981e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1422e-01
  Total weights = 1.956498584e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4874e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299258999285
                                         uncertainty =       0.002006320109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299258999285
                                         uncertainty =       0.002006320109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386771291
  error estimate for blocks of size 2^( 2) =       0.000396721732
  error estimate for blocks of size 2^( 3) =       0.000405472883
  error estimate for blocks of size 2^( 4) =       0.000412033237
  error estimate for blocks of size 2^( 5) =       0.000416964569
  error estimate for blocks of size 2^( 6) =       0.000419171454
  error estimate for blocks of size 2^( 7) =       0.000420909908

      target function =                  N/A
              le_mean =     -17.216220651262
             les_mean =     296.712477472714
             stat err =       0.000417269792
             autocorr =       1.163926166685
              std dev =       0.546977204720
             le_variance =       0.299184062483


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721622065126e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+59, overlap shift 6.1035e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216220651307       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216220651307       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+60, overlap shift 2.4414e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216220651307       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216220651307       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+60, overlap shift 9.7656e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216220651307       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216220651307       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.425245 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6474e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.1751
    reference variance = 0.183755
====================================================
  Execution time = 1.3838e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2293e-01
  Total weights = 1.9567e+06
  Execution time = 1.8418e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304859419803
                                         uncertainty =       0.003056588078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304859419803
                                         uncertainty =       0.003056588078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390508872
  error estimate for blocks of size 2^( 2) =       0.000400512623
  error estimate for blocks of size 2^( 3) =       0.000409591159
  error estimate for blocks of size 2^( 4) =       0.000417279546
  error estimate for blocks of size 2^( 5) =       0.000421034688
  error estimate for blocks of size 2^( 6) =       0.000422062465
  error estimate for blocks of size 2^( 7) =       0.000423755126

      target function =                  N/A
              le_mean =     -17.216357699596
             les_mean =     296.725905065677
             stat err =       0.000421032956
             autocorr =       1.162439534030
              std dev =       0.552262943523
             le_variance =       0.304994358789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304859419803
                                         uncertainty =       0.003056588078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304859419803
                                         uncertainty =       0.003056588078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390508872
  error estimate for blocks of size 2^( 2) =       0.000400512623
  error estimate for blocks of size 2^( 3) =       0.000409591159
  error estimate for blocks of size 2^( 4) =       0.000417279546
  error estimate for blocks of size 2^( 5) =       0.000421034688
  error estimate for blocks of size 2^( 6) =       0.000422062465
  error estimate for blocks of size 2^( 7) =       0.000423755126

      target function =                  N/A
              le_mean =     -17.216357699596
             les_mean =     296.725905065677
             stat err =       0.000421032956
             autocorr =       1.162439534030
              std dev =       0.552262943523
             le_variance =       0.304994358789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304859419803
                                         uncertainty =       0.003056588078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304859419803
                                         uncertainty =       0.003056588078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390508872
  error estimate for blocks of size 2^( 2) =       0.000400512623
  error estimate for blocks of size 2^( 3) =       0.000409591159
  error estimate for blocks of size 2^( 4) =       0.000417279546
  error estimate for blocks of size 2^( 5) =       0.000421034688
  error estimate for blocks of size 2^( 6) =       0.000422062465
  error estimate for blocks of size 2^( 7) =       0.000423755126

      target function =                  N/A
              le_mean =     -17.216357699596
             les_mean =     296.725905065677
             stat err =       0.000421032956
             autocorr =       1.162439534030
              std dev =       0.552262943523
             le_variance =       0.304994358789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304859419803
                                         uncertainty =       0.003056588078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304859419803
                                         uncertainty =       0.003056588078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390508872
  error estimate for blocks of size 2^( 2) =       0.000400512623
  error estimate for blocks of size 2^( 3) =       0.000409591159
  error estimate for blocks of size 2^( 4) =       0.000417279546
  error estimate for blocks of size 2^( 5) =       0.000421034688
  error estimate for blocks of size 2^( 6) =       0.000422062465
  error estimate for blocks of size 2^( 7) =       0.000423755126

      target function =                  N/A
              le_mean =     -17.216357699596
             les_mean =     296.725905065677
             stat err =       0.000421032956
             autocorr =       1.162439534030
              std dev =       0.552262943523
             le_variance =       0.304994358789


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216357699596        initial  <--
     6.1035e+59     6.1035e+60             0.0000e+00       -17.216357699596
     2.4414e+60     2.4414e+61             0.0000e+00       -17.216357699596
     9.7656e+60     9.7656e+61             0.0000e+00       -17.216357699596

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1202
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9602e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.2787
    reference variance = 0.468294
====================================================
  Execution time = 1.6588e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5311e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1064e-01
  Total weights = 1.956951620e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297725006764
                                         uncertainty =       0.001799124357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297725006764
                                         uncertainty =       0.001799124357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385810887
  error estimate for blocks of size 2^( 2) =       0.000395888611
  error estimate for blocks of size 2^( 3) =       0.000404635718
  error estimate for blocks of size 2^( 4) =       0.000411526743
  error estimate for blocks of size 2^( 5) =       0.000415864311
  error estimate for blocks of size 2^( 6) =       0.000417087126
  error estimate for blocks of size 2^( 7) =       0.000418885172

      target function =                  N/A
              le_mean =     -17.215903219297
             les_mean =     296.697967295663
             stat err =       0.000415840838
             autocorr =       1.161730299925
              std dev =       0.545618989402
             le_variance =       0.297700081597


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721590321930e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+60, overlap shift 6.1035e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215903219349       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215903219349       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+61, overlap shift 2.4414e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215903219349       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215903219349       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+61, overlap shift 9.7656e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215903219349       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215903219349       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.426321 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9097e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.3016
    reference variance = 0.541298
====================================================
  Execution time = 1.3526e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1586e-01
  Total weights = 1.9563e+06
  Execution time = 1.8374e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299889559749
                                         uncertainty =       0.002228218196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299889559749
                                         uncertainty =       0.002228218196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387216698
  error estimate for blocks of size 2^( 2) =       0.000397487758
  error estimate for blocks of size 2^( 3) =       0.000406321201
  error estimate for blocks of size 2^( 4) =       0.000412973323
  error estimate for blocks of size 2^( 5) =       0.000417266847
  error estimate for blocks of size 2^( 6) =       0.000418828120
  error estimate for blocks of size 2^( 7) =       0.000421513086

      target function =                  N/A
              le_mean =     -17.216698529517
             les_mean =     296.730566933846
             stat err =       0.000417645344
             autocorr =       1.163341269386
              std dev =       0.547607105693
             le_variance =       0.299873542206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299889559749
                                         uncertainty =       0.002228218196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299889559749
                                         uncertainty =       0.002228218196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387216698
  error estimate for blocks of size 2^( 2) =       0.000397487758
  error estimate for blocks of size 2^( 3) =       0.000406321201
  error estimate for blocks of size 2^( 4) =       0.000412973323
  error estimate for blocks of size 2^( 5) =       0.000417266847
  error estimate for blocks of size 2^( 6) =       0.000418828120
  error estimate for blocks of size 2^( 7) =       0.000421513086

      target function =                  N/A
              le_mean =     -17.216698529517
             les_mean =     296.730566933846
             stat err =       0.000417645344
             autocorr =       1.163341269386
              std dev =       0.547607105693
             le_variance =       0.299873542206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299889559749
                                         uncertainty =       0.002228218196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299889559749
                                         uncertainty =       0.002228218196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387216698
  error estimate for blocks of size 2^( 2) =       0.000397487758
  error estimate for blocks of size 2^( 3) =       0.000406321201
  error estimate for blocks of size 2^( 4) =       0.000412973323
  error estimate for blocks of size 2^( 5) =       0.000417266847
  error estimate for blocks of size 2^( 6) =       0.000418828120
  error estimate for blocks of size 2^( 7) =       0.000421513086

      target function =                  N/A
              le_mean =     -17.216698529517
             les_mean =     296.730566933846
             stat err =       0.000417645344
             autocorr =       1.163341269386
              std dev =       0.547607105693
             le_variance =       0.299873542206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299889559749
                                         uncertainty =       0.002228218196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299889559749
                                         uncertainty =       0.002228218196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387216698
  error estimate for blocks of size 2^( 2) =       0.000397487758
  error estimate for blocks of size 2^( 3) =       0.000406321201
  error estimate for blocks of size 2^( 4) =       0.000412973323
  error estimate for blocks of size 2^( 5) =       0.000417266847
  error estimate for blocks of size 2^( 6) =       0.000418828120
  error estimate for blocks of size 2^( 7) =       0.000421513086

      target function =                  N/A
              le_mean =     -17.216698529517
             les_mean =     296.730566933846
             stat err =       0.000417645344
             autocorr =       1.163341269386
              std dev =       0.547607105693
             le_variance =       0.299873542206


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216698529517        initial  <--
     6.1035e+60     6.1035e+61             0.0000e+00       -17.216698529517
     2.4414e+61     2.4414e+62             0.0000e+00       -17.216698529517
     9.7656e+61     9.7656e+62             0.0000e+00       -17.216698529517

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7900
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1895e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2922
    reference variance = 0.428955
====================================================
  Execution time = 1.4051e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1273e-01
  Total weights = 1.956613028e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4843e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297511802257
                                         uncertainty =       0.002186109624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297511802257
                                         uncertainty =       0.002186109624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385847482
  error estimate for blocks of size 2^( 2) =       0.000395967729
  error estimate for blocks of size 2^( 3) =       0.000404568721
  error estimate for blocks of size 2^( 4) =       0.000411323440
  error estimate for blocks of size 2^( 5) =       0.000415611356
  error estimate for blocks of size 2^( 6) =       0.000418165529
  error estimate for blocks of size 2^( 7) =       0.000416472097

      target function =                  N/A
              le_mean =     -17.216302574113
             les_mean =     296.713801182304
             stat err =       0.000415393105
             autocorr =       1.159010114801
              std dev =       0.545670742679
             le_variance =       0.297756559416


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721630257411e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+61, overlap shift 6.1035e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216302574148       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216302574148       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+62, overlap shift 2.4414e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216302574148       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216302574148       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+62, overlap shift 9.7656e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216302574148       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216302574148       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.427432 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6541e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2467
    reference variance = 0.205398
====================================================
  Execution time = 1.3436e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1558e-01
  Total weights = 1.9566e+06
  Execution time = 1.8437e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300740072591
                                         uncertainty =       0.001905698844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300740072591
                                         uncertainty =       0.001905698844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388053381
  error estimate for blocks of size 2^( 2) =       0.000397818610
  error estimate for blocks of size 2^( 3) =       0.000406937439
  error estimate for blocks of size 2^( 4) =       0.000413828620
  error estimate for blocks of size 2^( 5) =       0.000418660358
  error estimate for blocks of size 2^( 6) =       0.000422293056
  error estimate for blocks of size 2^( 7) =       0.000425680640

      target function =                  N/A
              le_mean =     -17.216560834002
             les_mean =     296.725543387834
             stat err =       0.000420115669
             autocorr =       1.172073417783
              std dev =       0.548790353655
             le_variance =       0.301170852265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300740072591
                                         uncertainty =       0.001905698844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300740072591
                                         uncertainty =       0.001905698844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388053381
  error estimate for blocks of size 2^( 2) =       0.000397818610
  error estimate for blocks of size 2^( 3) =       0.000406937439
  error estimate for blocks of size 2^( 4) =       0.000413828620
  error estimate for blocks of size 2^( 5) =       0.000418660358
  error estimate for blocks of size 2^( 6) =       0.000422293056
  error estimate for blocks of size 2^( 7) =       0.000425680640

      target function =                  N/A
              le_mean =     -17.216560834002
             les_mean =     296.725543387834
             stat err =       0.000420115669
             autocorr =       1.172073417783
              std dev =       0.548790353655
             le_variance =       0.301170852265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300740072591
                                         uncertainty =       0.001905698844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300740072591
                                         uncertainty =       0.001905698844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388053381
  error estimate for blocks of size 2^( 2) =       0.000397818610
  error estimate for blocks of size 2^( 3) =       0.000406937439
  error estimate for blocks of size 2^( 4) =       0.000413828620
  error estimate for blocks of size 2^( 5) =       0.000418660358
  error estimate for blocks of size 2^( 6) =       0.000422293056
  error estimate for blocks of size 2^( 7) =       0.000425680640

      target function =                  N/A
              le_mean =     -17.216560834002
             les_mean =     296.725543387834
             stat err =       0.000420115669
             autocorr =       1.172073417783
              std dev =       0.548790353655
             le_variance =       0.301170852265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300740072591
                                         uncertainty =       0.001905698844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300740072591
                                         uncertainty =       0.001905698844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388053381
  error estimate for blocks of size 2^( 2) =       0.000397818610
  error estimate for blocks of size 2^( 3) =       0.000406937439
  error estimate for blocks of size 2^( 4) =       0.000413828620
  error estimate for blocks of size 2^( 5) =       0.000418660358
  error estimate for blocks of size 2^( 6) =       0.000422293056
  error estimate for blocks of size 2^( 7) =       0.000425680640

      target function =                  N/A
              le_mean =     -17.216560834002
             les_mean =     296.725543387834
             stat err =       0.000420115669
             autocorr =       1.172073417783
              std dev =       0.548790353655
             le_variance =       0.301170852265


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216560834002        initial  <--
     6.1035e+61     6.1035e+62             0.0000e+00       -17.216560834002
     2.4414e+62     2.4414e+63             0.0000e+00       -17.216560834002
     9.7656e+62     9.7656e+63             0.0000e+00       -17.216560834002

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7281
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9275e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2184
    reference variance = 0.368393
====================================================
  Execution time = 1.4166e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1107e-01
  Total weights = 1.956733884e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4721e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298529673128
                                         uncertainty =       0.002186868622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298529673128
                                         uncertainty =       0.002186868622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386286885
  error estimate for blocks of size 2^( 2) =       0.000396268633
  error estimate for blocks of size 2^( 3) =       0.000405272317
  error estimate for blocks of size 2^( 4) =       0.000412571741
  error estimate for blocks of size 2^( 5) =       0.000417203746
  error estimate for blocks of size 2^( 6) =       0.000418495006
  error estimate for blocks of size 2^( 7) =       0.000417828311

      target function =                  N/A
              le_mean =     -17.216491367472
             les_mean =     296.718642701877
             stat err =       0.000416524701
             autocorr =       1.162683730407
              std dev =       0.546292151748
             le_variance =       0.298435115061


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721649136747e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+62, overlap shift 6.1035e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216491367509       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216491367509       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+63, overlap shift 2.4414e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216491367509       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216491367509       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+63, overlap shift 9.7656e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216491367509       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216491367509       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.428457 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6643e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2017
    reference variance = 0.290482
====================================================
  Execution time = 1.3460e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1947e-01
  Total weights = 1.9568e+06
  Execution time = 1.8359e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303223616760
                                         uncertainty =       0.003699379696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303223616760
                                         uncertainty =       0.003699379696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389332791
  error estimate for blocks of size 2^( 2) =       0.000399307545
  error estimate for blocks of size 2^( 3) =       0.000408663293
  error estimate for blocks of size 2^( 4) =       0.000415707651
  error estimate for blocks of size 2^( 5) =       0.000419755038
  error estimate for blocks of size 2^( 6) =       0.000422251572
  error estimate for blocks of size 2^( 7) =       0.000423443734

      target function =                  N/A
              le_mean =     -17.216414771723
             les_mean =     296.724404658248
             stat err =       0.000420289499
             autocorr =       1.165346594135
              std dev =       0.550599713644
             le_variance =       0.303160044665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303223616760
                                         uncertainty =       0.003699379696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303223616760
                                         uncertainty =       0.003699379696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389332791
  error estimate for blocks of size 2^( 2) =       0.000399307545
  error estimate for blocks of size 2^( 3) =       0.000408663293
  error estimate for blocks of size 2^( 4) =       0.000415707651
  error estimate for blocks of size 2^( 5) =       0.000419755038
  error estimate for blocks of size 2^( 6) =       0.000422251572
  error estimate for blocks of size 2^( 7) =       0.000423443734

      target function =                  N/A
              le_mean =     -17.216414771723
             les_mean =     296.724404658248
             stat err =       0.000420289499
             autocorr =       1.165346594135
              std dev =       0.550599713644
             le_variance =       0.303160044665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303223616760
                                         uncertainty =       0.003699379696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303223616760
                                         uncertainty =       0.003699379696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389332791
  error estimate for blocks of size 2^( 2) =       0.000399307545
  error estimate for blocks of size 2^( 3) =       0.000408663293
  error estimate for blocks of size 2^( 4) =       0.000415707651
  error estimate for blocks of size 2^( 5) =       0.000419755038
  error estimate for blocks of size 2^( 6) =       0.000422251572
  error estimate for blocks of size 2^( 7) =       0.000423443734

      target function =                  N/A
              le_mean =     -17.216414771723
             les_mean =     296.724404658248
             stat err =       0.000420289499
             autocorr =       1.165346594135
              std dev =       0.550599713644
             le_variance =       0.303160044665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303223616760
                                         uncertainty =       0.003699379696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303223616760
                                         uncertainty =       0.003699379696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389332791
  error estimate for blocks of size 2^( 2) =       0.000399307545
  error estimate for blocks of size 2^( 3) =       0.000408663293
  error estimate for blocks of size 2^( 4) =       0.000415707651
  error estimate for blocks of size 2^( 5) =       0.000419755038
  error estimate for blocks of size 2^( 6) =       0.000422251572
  error estimate for blocks of size 2^( 7) =       0.000423443734

      target function =                  N/A
              le_mean =     -17.216414771723
             les_mean =     296.724404658248
             stat err =       0.000420289499
             autocorr =       1.165346594135
              std dev =       0.550599713644
             le_variance =       0.303160044665


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216414771723        initial  <--
     6.1035e+62     6.1035e+63             0.0000e+00       -17.216414771723
     2.4414e+63     2.4414e+64             0.0000e+00       -17.216414771723
     9.7656e+63     9.7656e+64             0.0000e+00       -17.216414771723

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7155
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9366e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.2445
    reference variance = 0.227505
====================================================
  Execution time = 1.3946e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1553e-01
  Total weights = 1.956453288e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4899e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300270121297
                                         uncertainty =       0.002553257031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300270121297
                                         uncertainty =       0.002553257031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387445824
  error estimate for blocks of size 2^( 2) =       0.000397792522
  error estimate for blocks of size 2^( 3) =       0.000406844314
  error estimate for blocks of size 2^( 4) =       0.000413240118
  error estimate for blocks of size 2^( 5) =       0.000416736459
  error estimate for blocks of size 2^( 6) =       0.000419725418
  error estimate for blocks of size 2^( 7) =       0.000422264061

      target function =                  N/A
              le_mean =     -17.216315816112
             les_mean =     296.717058353645
             stat err =       0.000417991514
             autocorr =       1.163892745840
              std dev =       0.547931139056
             le_variance =       0.300228533147


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721631581611e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+63, overlap shift 6.1035e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216315816136       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216315816136       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+64, overlap shift 2.4414e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216315816136       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216315816136       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+64 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+64, overlap shift 9.7656e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216315816136       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216315816136       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.429533 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6441e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.2053
    reference variance = 0.182635
====================================================
  Execution time = 1.3646e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1077e-01
  Total weights = 1.9566e+06
  Execution time = 1.8470e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297913808497
                                         uncertainty =       0.001577746865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297913808497
                                         uncertainty =       0.001577746865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385908307
  error estimate for blocks of size 2^( 2) =       0.000395823618
  error estimate for blocks of size 2^( 3) =       0.000404337447
  error estimate for blocks of size 2^( 4) =       0.000410449839
  error estimate for blocks of size 2^( 5) =       0.000414456345
  error estimate for blocks of size 2^( 6) =       0.000416035117
  error estimate for blocks of size 2^( 7) =       0.000418776516

      target function =                  N/A
              le_mean =     -17.216918795561
             les_mean =     296.733057826346
             stat err =       0.000414929454
             autocorr =       1.156059732248
              std dev =       0.545756762260
             le_variance =       0.297850443552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297913808497
                                         uncertainty =       0.001577746865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297913808497
                                         uncertainty =       0.001577746865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385908307
  error estimate for blocks of size 2^( 2) =       0.000395823618
  error estimate for blocks of size 2^( 3) =       0.000404337447
  error estimate for blocks of size 2^( 4) =       0.000410449839
  error estimate for blocks of size 2^( 5) =       0.000414456345
  error estimate for blocks of size 2^( 6) =       0.000416035117
  error estimate for blocks of size 2^( 7) =       0.000418776516

      target function =                  N/A
              le_mean =     -17.216918795561
             les_mean =     296.733057826346
             stat err =       0.000414929454
             autocorr =       1.156059732248
              std dev =       0.545756762260
             le_variance =       0.297850443552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297913808497
                                         uncertainty =       0.001577746865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297913808497
                                         uncertainty =       0.001577746865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385908307
  error estimate for blocks of size 2^( 2) =       0.000395823618
  error estimate for blocks of size 2^( 3) =       0.000404337447
  error estimate for blocks of size 2^( 4) =       0.000410449839
  error estimate for blocks of size 2^( 5) =       0.000414456345
  error estimate for blocks of size 2^( 6) =       0.000416035117
  error estimate for blocks of size 2^( 7) =       0.000418776516

      target function =                  N/A
              le_mean =     -17.216918795561
             les_mean =     296.733057826346
             stat err =       0.000414929454
             autocorr =       1.156059732248
              std dev =       0.545756762260
             le_variance =       0.297850443552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297913808497
                                         uncertainty =       0.001577746865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297913808497
                                         uncertainty =       0.001577746865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385908307
  error estimate for blocks of size 2^( 2) =       0.000395823618
  error estimate for blocks of size 2^( 3) =       0.000404337447
  error estimate for blocks of size 2^( 4) =       0.000410449839
  error estimate for blocks of size 2^( 5) =       0.000414456345
  error estimate for blocks of size 2^( 6) =       0.000416035117
  error estimate for blocks of size 2^( 7) =       0.000418776516

      target function =                  N/A
              le_mean =     -17.216918795561
             les_mean =     296.733057826346
             stat err =       0.000414929454
             autocorr =       1.156059732248
              std dev =       0.545756762260
             le_variance =       0.297850443552


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216918795561        initial  <--
     6.1035e+63     6.1035e+64             0.0000e+00       -17.216918795561
     2.4414e+64     2.4414e+65             0.0000e+00       -17.216918795561
     9.7656e+64     9.7656e+65             0.0000e+00       -17.216918795561

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9737
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9426e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.2923
    reference variance = 0.585607
====================================================
  Execution time = 1.4107e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5309e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1335e-01
  Total weights = 1.956663330e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4810e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298385055417
                                         uncertainty =       0.002290815451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298385055417
                                         uncertainty =       0.002290815451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386260515
  error estimate for blocks of size 2^( 2) =       0.000396296466
  error estimate for blocks of size 2^( 3) =       0.000405462982
  error estimate for blocks of size 2^( 4) =       0.000413059458
  error estimate for blocks of size 2^( 5) =       0.000417300870
  error estimate for blocks of size 2^( 6) =       0.000420378565
  error estimate for blocks of size 2^( 7) =       0.000422365418

      target function =                  N/A
              le_mean =     -17.216271036196
             les_mean =     296.713342746183
             stat err =       0.000418276078
             autocorr =       1.172641941533
              std dev =       0.546254858808
             le_variance =       0.298394370771


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721627103620e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+64, overlap shift 6.1035e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216271036263       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216271036263       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+65, overlap shift 2.4414e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216271036263       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216271036263       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+65, overlap shift 9.7656e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216271036263       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216271036263       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.430615 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6593e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.2813
    reference variance = 0.256066
====================================================
  Execution time = 1.3700e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1494e-01
  Total weights = 1.9566e+06
  Execution time = 1.8327e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298413469232
                                         uncertainty =       0.001765908634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298413469232
                                         uncertainty =       0.001765908634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386258228
  error estimate for blocks of size 2^( 2) =       0.000396107521
  error estimate for blocks of size 2^( 3) =       0.000405151683
  error estimate for blocks of size 2^( 4) =       0.000411171021
  error estimate for blocks of size 2^( 5) =       0.000415280838
  error estimate for blocks of size 2^( 6) =       0.000416872661
  error estimate for blocks of size 2^( 7) =       0.000420260638

      target function =                  N/A
              le_mean =     -17.215852998815
             les_mean =     296.700538044925
             stat err =       0.000415896289
             autocorr =       1.159350100687
              std dev =       0.546251624377
             le_variance =       0.298390837134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298413469232
                                         uncertainty =       0.001765908634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298413469232
                                         uncertainty =       0.001765908634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386258228
  error estimate for blocks of size 2^( 2) =       0.000396107521
  error estimate for blocks of size 2^( 3) =       0.000405151683
  error estimate for blocks of size 2^( 4) =       0.000411171021
  error estimate for blocks of size 2^( 5) =       0.000415280838
  error estimate for blocks of size 2^( 6) =       0.000416872661
  error estimate for blocks of size 2^( 7) =       0.000420260638

      target function =                  N/A
              le_mean =     -17.215852998815
             les_mean =     296.700538044925
             stat err =       0.000415896289
             autocorr =       1.159350100687
              std dev =       0.546251624377
             le_variance =       0.298390837134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298413469232
                                         uncertainty =       0.001765908634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298413469232
                                         uncertainty =       0.001765908634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386258228
  error estimate for blocks of size 2^( 2) =       0.000396107521
  error estimate for blocks of size 2^( 3) =       0.000405151683
  error estimate for blocks of size 2^( 4) =       0.000411171021
  error estimate for blocks of size 2^( 5) =       0.000415280838
  error estimate for blocks of size 2^( 6) =       0.000416872661
  error estimate for blocks of size 2^( 7) =       0.000420260638

      target function =                  N/A
              le_mean =     -17.215852998815
             les_mean =     296.700538044925
             stat err =       0.000415896289
             autocorr =       1.159350100687
              std dev =       0.546251624377
             le_variance =       0.298390837134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298413469232
                                         uncertainty =       0.001765908634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298413469232
                                         uncertainty =       0.001765908634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386258228
  error estimate for blocks of size 2^( 2) =       0.000396107521
  error estimate for blocks of size 2^( 3) =       0.000405151683
  error estimate for blocks of size 2^( 4) =       0.000411171021
  error estimate for blocks of size 2^( 5) =       0.000415280838
  error estimate for blocks of size 2^( 6) =       0.000416872661
  error estimate for blocks of size 2^( 7) =       0.000420260638

      target function =                  N/A
              le_mean =     -17.215852998815
             les_mean =     296.700538044925
             stat err =       0.000415896289
             autocorr =       1.159350100687
              std dev =       0.546251624377
             le_variance =       0.298390837134


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215852998815        initial  <--
     6.1035e+64     6.1035e+65             0.0000e+00       -17.215852998815
     2.4414e+65     2.4414e+66             0.0000e+00       -17.215852998815
     9.7656e+65     9.7656e+66             0.0000e+00       -17.215852998815

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9797
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9580e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.2293
    reference variance = 0.238749
====================================================
  Execution time = 1.3878e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1637e-01
  Total weights = 1.956723607e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4859e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300677704359
                                         uncertainty =       0.002228482763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300677704359
                                         uncertainty =       0.002228482763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387716694
  error estimate for blocks of size 2^( 2) =       0.000397639364
  error estimate for blocks of size 2^( 3) =       0.000406948852
  error estimate for blocks of size 2^( 4) =       0.000413950104
  error estimate for blocks of size 2^( 5) =       0.000417906191
  error estimate for blocks of size 2^( 6) =       0.000418819807
  error estimate for blocks of size 2^( 7) =       0.000421275538

      target function =                  N/A
              le_mean =     -17.216127578514
             les_mean =     296.711418224448
             stat err =       0.000417987910
             autocorr =       1.162247013894
              std dev =       0.548314206589
             le_variance =       0.300648469148


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721612757851e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+65, overlap shift 6.1035e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216127578566       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216127578566       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+66, overlap shift 2.4414e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216127578566       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216127578566       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+66, overlap shift 9.7656e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216127578566       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216127578566       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.431623 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6369e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.2051
    reference variance = 0.21338
====================================================
  Execution time = 1.3464e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2037e-01
  Total weights = 1.9566e+06
  Execution time = 1.8300e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302726293981
                                         uncertainty =       0.002310449249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302726293981
                                         uncertainty =       0.002310449249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389062854
  error estimate for blocks of size 2^( 2) =       0.000399142042
  error estimate for blocks of size 2^( 3) =       0.000407461142
  error estimate for blocks of size 2^( 4) =       0.000413558886
  error estimate for blocks of size 2^( 5) =       0.000417925159
  error estimate for blocks of size 2^( 6) =       0.000418387610
  error estimate for blocks of size 2^( 7) =       0.000420492046

      target function =                  N/A
              le_mean =     -17.216458889686
             les_mean =     296.726821707236
             stat err =       0.000417590925
             autocorr =       1.152026759838
              std dev =       0.550217965402
             le_variance =       0.302739809452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302726293981
                                         uncertainty =       0.002310449249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302726293981
                                         uncertainty =       0.002310449249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389062854
  error estimate for blocks of size 2^( 2) =       0.000399142042
  error estimate for blocks of size 2^( 3) =       0.000407461142
  error estimate for blocks of size 2^( 4) =       0.000413558886
  error estimate for blocks of size 2^( 5) =       0.000417925159
  error estimate for blocks of size 2^( 6) =       0.000418387610
  error estimate for blocks of size 2^( 7) =       0.000420492046

      target function =                  N/A
              le_mean =     -17.216458889686
             les_mean =     296.726821707236
             stat err =       0.000417590925
             autocorr =       1.152026759838
              std dev =       0.550217965402
             le_variance =       0.302739809452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302726293981
                                         uncertainty =       0.002310449249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302726293981
                                         uncertainty =       0.002310449249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389062854
  error estimate for blocks of size 2^( 2) =       0.000399142042
  error estimate for blocks of size 2^( 3) =       0.000407461142
  error estimate for blocks of size 2^( 4) =       0.000413558886
  error estimate for blocks of size 2^( 5) =       0.000417925159
  error estimate for blocks of size 2^( 6) =       0.000418387610
  error estimate for blocks of size 2^( 7) =       0.000420492046

      target function =                  N/A
              le_mean =     -17.216458889686
             les_mean =     296.726821707236
             stat err =       0.000417590925
             autocorr =       1.152026759838
              std dev =       0.550217965402
             le_variance =       0.302739809452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302726293981
                                         uncertainty =       0.002310449249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302726293981
                                         uncertainty =       0.002310449249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389062854
  error estimate for blocks of size 2^( 2) =       0.000399142042
  error estimate for blocks of size 2^( 3) =       0.000407461142
  error estimate for blocks of size 2^( 4) =       0.000413558886
  error estimate for blocks of size 2^( 5) =       0.000417925159
  error estimate for blocks of size 2^( 6) =       0.000418387610
  error estimate for blocks of size 2^( 7) =       0.000420492046

      target function =                  N/A
              le_mean =     -17.216458889686
             les_mean =     296.726821707236
             stat err =       0.000417590925
             autocorr =       1.152026759838
              std dev =       0.550217965402
             le_variance =       0.302739809452


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216458889686        initial  <--
     6.1035e+65     6.1035e+66             0.0000e+00       -17.216458889686
     2.4414e+66     2.4414e+67             0.0000e+00       -17.216458889686
     9.7656e+66     9.7656e+67             0.0000e+00       -17.216458889686

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6867
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9062e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.1435
    reference variance = 0.3911
====================================================
  Execution time = 1.3986e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1768e-01
  Total weights = 1.956434823e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4806e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301498479807
                                         uncertainty =       0.002049917855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301498479807
                                         uncertainty =       0.002049917855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388353772
  error estimate for blocks of size 2^( 2) =       0.000398518223
  error estimate for blocks of size 2^( 3) =       0.000407062735
  error estimate for blocks of size 2^( 4) =       0.000413818974
  error estimate for blocks of size 2^( 5) =       0.000418871871
  error estimate for blocks of size 2^( 6) =       0.000421004759
  error estimate for blocks of size 2^( 7) =       0.000423232092

      target function =                  N/A
              le_mean =     -17.216287041013
             les_mean =     296.718222432497
             stat err =       0.000419231924
             autocorr =       1.165342639624
              std dev =       0.549215171039
             le_variance =       0.301637304099


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721628704101e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+66, overlap shift 6.1035e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216287041039       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216287041039       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216287041039       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+66 is 5.299598e-71

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+67, overlap shift 2.4414e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216287041039       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216287041039       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216287041039       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+67 is 1.324899e-71

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+67, overlap shift 9.7656e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216287041039       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216287041039       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216287041039       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+67 is 3.312248e-72

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.432911 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6472e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.2331
    reference variance = 0.23462
====================================================
  Execution time = 1.3464e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1740e-01
  Total weights = 1.9565e+06
  Execution time = 1.8454e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298551329446
                                         uncertainty =       0.001722341760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298551329446
                                         uncertainty =       0.001722341760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386343500
  error estimate for blocks of size 2^( 2) =       0.000396320141
  error estimate for blocks of size 2^( 3) =       0.000405592525
  error estimate for blocks of size 2^( 4) =       0.000411783045
  error estimate for blocks of size 2^( 5) =       0.000416447747
  error estimate for blocks of size 2^( 6) =       0.000419049612
  error estimate for blocks of size 2^( 7) =       0.000421188521

      target function =                  N/A
              le_mean =     -17.215526625830
             les_mean =     296.691756192587
             stat err =       0.000417117231
             autocorr =       1.165652346770
              std dev =       0.546372217607
             le_variance =       0.298522600173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298551329446
                                         uncertainty =       0.001722341760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298551329446
                                         uncertainty =       0.001722341760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386343500
  error estimate for blocks of size 2^( 2) =       0.000396320141
  error estimate for blocks of size 2^( 3) =       0.000405592525
  error estimate for blocks of size 2^( 4) =       0.000411783045
  error estimate for blocks of size 2^( 5) =       0.000416447747
  error estimate for blocks of size 2^( 6) =       0.000419049612
  error estimate for blocks of size 2^( 7) =       0.000421188521

      target function =                  N/A
              le_mean =     -17.215526625830
             les_mean =     296.691756192587
             stat err =       0.000417117231
             autocorr =       1.165652346770
              std dev =       0.546372217607
             le_variance =       0.298522600173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298551329446
                                         uncertainty =       0.001722341760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298551329446
                                         uncertainty =       0.001722341760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386343500
  error estimate for blocks of size 2^( 2) =       0.000396320141
  error estimate for blocks of size 2^( 3) =       0.000405592525
  error estimate for blocks of size 2^( 4) =       0.000411783045
  error estimate for blocks of size 2^( 5) =       0.000416447747
  error estimate for blocks of size 2^( 6) =       0.000419049612
  error estimate for blocks of size 2^( 7) =       0.000421188521

      target function =                  N/A
              le_mean =     -17.215526625830
             les_mean =     296.691756192587
             stat err =       0.000417117231
             autocorr =       1.165652346770
              std dev =       0.546372217607
             le_variance =       0.298522600173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298551329446
                                         uncertainty =       0.001722341760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298551329446
                                         uncertainty =       0.001722341760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386343500
  error estimate for blocks of size 2^( 2) =       0.000396320141
  error estimate for blocks of size 2^( 3) =       0.000405592525
  error estimate for blocks of size 2^( 4) =       0.000411783045
  error estimate for blocks of size 2^( 5) =       0.000416447747
  error estimate for blocks of size 2^( 6) =       0.000419049612
  error estimate for blocks of size 2^( 7) =       0.000421188521

      target function =                  N/A
              le_mean =     -17.215526625830
             les_mean =     296.691756192587
             stat err =       0.000417117231
             autocorr =       1.165652346770
              std dev =       0.546372217607
             le_variance =       0.298522600173


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215526625830        initial  <--
     6.1035e+66     6.1035e+67             5.2996e-71       -17.215526625830
     2.4414e+67     2.4414e+68             1.3249e-71       -17.215526625830
     9.7656e+67     9.7656e+68             3.3122e-72       -17.215526625830

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7715
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9256e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.2195
    reference variance = 0.193583
====================================================
  Execution time = 1.3748e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1625e-01
  Total weights = 1.956702043e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4738e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300847317760
                                         uncertainty =       0.001902649486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300847317760
                                         uncertainty =       0.001902649486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387834332
  error estimate for blocks of size 2^( 2) =       0.000397415834
  error estimate for blocks of size 2^( 3) =       0.000406581988
  error estimate for blocks of size 2^( 4) =       0.000413433484
  error estimate for blocks of size 2^( 5) =       0.000417328951
  error estimate for blocks of size 2^( 6) =       0.000420250204
  error estimate for blocks of size 2^( 7) =       0.000421713423

      target function =                  N/A
              le_mean =     -17.217204202453
             les_mean =     296.748371212046
             stat err =       0.000418181516
             autocorr =       1.162618321999
              std dev =       0.548480571756
             le_variance =       0.300830937594


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721720420245e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+67, overlap shift 6.1035e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217204202505       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217204202505       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+68, overlap shift 2.4414e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217204202505       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217204202505       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+68 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+68, overlap shift 9.7656e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217204202505       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217204202505       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+68 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.433998 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6227e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.2193
    reference variance = 0.149133
====================================================
  Execution time = 1.5918e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1848e-01
  Total weights = 1.9565e+06
  Execution time = 1.8411e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301255103678
                                         uncertainty =       0.001911270888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301255103678
                                         uncertainty =       0.001911270888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388199934
  error estimate for blocks of size 2^( 2) =       0.000398114300
  error estimate for blocks of size 2^( 3) =       0.000406832134
  error estimate for blocks of size 2^( 4) =       0.000413406649
  error estimate for blocks of size 2^( 5) =       0.000417718359
  error estimate for blocks of size 2^( 6) =       0.000419859152
  error estimate for blocks of size 2^( 7) =       0.000420200253

      target function =                  N/A
              le_mean =     -17.216971024723
             les_mean =     296.742575242029
             stat err =       0.000417796103
             autocorr =       1.158291464682
              std dev =       0.548997611218
             le_variance =       0.301398377123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301255103678
                                         uncertainty =       0.001911270888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301255103678
                                         uncertainty =       0.001911270888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388199934
  error estimate for blocks of size 2^( 2) =       0.000398114300
  error estimate for blocks of size 2^( 3) =       0.000406832134
  error estimate for blocks of size 2^( 4) =       0.000413406649
  error estimate for blocks of size 2^( 5) =       0.000417718359
  error estimate for blocks of size 2^( 6) =       0.000419859152
  error estimate for blocks of size 2^( 7) =       0.000420200253

      target function =                  N/A
              le_mean =     -17.216971024723
             les_mean =     296.742575242029
             stat err =       0.000417796103
             autocorr =       1.158291464682
              std dev =       0.548997611218
             le_variance =       0.301398377123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301255103678
                                         uncertainty =       0.001911270888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301255103678
                                         uncertainty =       0.001911270888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388199934
  error estimate for blocks of size 2^( 2) =       0.000398114300
  error estimate for blocks of size 2^( 3) =       0.000406832134
  error estimate for blocks of size 2^( 4) =       0.000413406649
  error estimate for blocks of size 2^( 5) =       0.000417718359
  error estimate for blocks of size 2^( 6) =       0.000419859152
  error estimate for blocks of size 2^( 7) =       0.000420200253

      target function =                  N/A
              le_mean =     -17.216971024723
             les_mean =     296.742575242029
             stat err =       0.000417796103
             autocorr =       1.158291464682
              std dev =       0.548997611218
             le_variance =       0.301398377123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301255103678
                                         uncertainty =       0.001911270888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301255103678
                                         uncertainty =       0.001911270888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388199934
  error estimate for blocks of size 2^( 2) =       0.000398114300
  error estimate for blocks of size 2^( 3) =       0.000406832134
  error estimate for blocks of size 2^( 4) =       0.000413406649
  error estimate for blocks of size 2^( 5) =       0.000417718359
  error estimate for blocks of size 2^( 6) =       0.000419859152
  error estimate for blocks of size 2^( 7) =       0.000420200253

      target function =                  N/A
              le_mean =     -17.216971024723
             les_mean =     296.742575242029
             stat err =       0.000417796103
             autocorr =       1.158291464682
              std dev =       0.548997611218
             le_variance =       0.301398377123


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216971024723        initial  <--
     6.1035e+67     6.1035e+68             0.0000e+00       -17.216971024723
     2.4414e+68     2.4414e+69             0.0000e+00       -17.216971024723
     9.7656e+68     9.7656e+69             0.0000e+00       -17.216971024723

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.1914
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1427e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.1423
    reference variance = 0.274454
====================================================
  Execution time = 1.3785e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1627e-01
  Total weights = 1.956587855e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4869e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300876610330
                                         uncertainty =       0.002375785944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300876610330
                                         uncertainty =       0.002375785944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387897857
  error estimate for blocks of size 2^( 2) =       0.000397874562
  error estimate for blocks of size 2^( 3) =       0.000406944057
  error estimate for blocks of size 2^( 4) =       0.000413841723
  error estimate for blocks of size 2^( 5) =       0.000418394403
  error estimate for blocks of size 2^( 6) =       0.000419035716
  error estimate for blocks of size 2^( 7) =       0.000419203061

      target function =                  N/A
              le_mean =     -17.215767844404
             les_mean =     296.698934991407
             stat err =       0.000417618726
             autocorr =       1.159111371227
              std dev =       0.548570410681
             le_variance =       0.300929495474


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721576784440e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+68, overlap shift 6.1035e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215767844476       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215767844476       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215767844476       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+68 is 1.013808e-72

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+69, overlap shift 2.4414e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215767844476       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215767844476       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215767844476       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+69 is 2.534521e-73

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+69, overlap shift 9.7656e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215767844476       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215767844476       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215767844476       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+69 is 6.336303e-74

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.435292 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6277e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.261
    reference variance = 0.227518
====================================================
  Execution time = 1.3614e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0920e-01
  Total weights = 1.9568e+06
  Execution time = 1.8348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295687211404
                                         uncertainty =       0.001741967620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295687211404
                                         uncertainty =       0.001741967620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384492913
  error estimate for blocks of size 2^( 2) =       0.000394355186
  error estimate for blocks of size 2^( 3) =       0.000403546137
  error estimate for blocks of size 2^( 4) =       0.000409622976
  error estimate for blocks of size 2^( 5) =       0.000413044426
  error estimate for blocks of size 2^( 6) =       0.000413795773
  error estimate for blocks of size 2^( 7) =       0.000414072551

      target function =                  N/A
              le_mean =     -17.216307399150
             les_mean =     296.710443576041
             stat err =       0.000412633932
             autocorr =       1.151736675806
              std dev =       0.543755092793
             le_variance =       0.295669600938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295687211404
                                         uncertainty =       0.001741967620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295687211404
                                         uncertainty =       0.001741967620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384492913
  error estimate for blocks of size 2^( 2) =       0.000394355186
  error estimate for blocks of size 2^( 3) =       0.000403546137
  error estimate for blocks of size 2^( 4) =       0.000409622976
  error estimate for blocks of size 2^( 5) =       0.000413044426
  error estimate for blocks of size 2^( 6) =       0.000413795773
  error estimate for blocks of size 2^( 7) =       0.000414072551

      target function =                  N/A
              le_mean =     -17.216307399150
             les_mean =     296.710443576041
             stat err =       0.000412633932
             autocorr =       1.151736675806
              std dev =       0.543755092793
             le_variance =       0.295669600938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295687211404
                                         uncertainty =       0.001741967620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295687211404
                                         uncertainty =       0.001741967620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384492913
  error estimate for blocks of size 2^( 2) =       0.000394355186
  error estimate for blocks of size 2^( 3) =       0.000403546137
  error estimate for blocks of size 2^( 4) =       0.000409622976
  error estimate for blocks of size 2^( 5) =       0.000413044426
  error estimate for blocks of size 2^( 6) =       0.000413795773
  error estimate for blocks of size 2^( 7) =       0.000414072551

      target function =                  N/A
              le_mean =     -17.216307399150
             les_mean =     296.710443576041
             stat err =       0.000412633932
             autocorr =       1.151736675806
              std dev =       0.543755092793
             le_variance =       0.295669600938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295687211404
                                         uncertainty =       0.001741967620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295687211404
                                         uncertainty =       0.001741967620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384492913
  error estimate for blocks of size 2^( 2) =       0.000394355186
  error estimate for blocks of size 2^( 3) =       0.000403546137
  error estimate for blocks of size 2^( 4) =       0.000409622976
  error estimate for blocks of size 2^( 5) =       0.000413044426
  error estimate for blocks of size 2^( 6) =       0.000413795773
  error estimate for blocks of size 2^( 7) =       0.000414072551

      target function =                  N/A
              le_mean =     -17.216307399150
             les_mean =     296.710443576041
             stat err =       0.000412633932
             autocorr =       1.151736675806
              std dev =       0.543755092793
             le_variance =       0.295669600938


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216307399150        initial  <--
     6.1035e+68     6.1035e+69             1.0138e-72       -17.216307399150
     2.4414e+69     2.4414e+70             2.5345e-73       -17.216307399150
     9.7656e+69     9.7656e+70             6.3363e-74       -17.216307399150

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8596
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9146e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.1929
    reference variance = 0.209587
====================================================
  Execution time = 1.3760e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1409e-01
  Total weights = 1.956263133e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5011e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301039570753
                                         uncertainty =       0.001960549105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301039570753
                                         uncertainty =       0.001960549105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387933711
  error estimate for blocks of size 2^( 2) =       0.000397679965
  error estimate for blocks of size 2^( 3) =       0.000406660381
  error estimate for blocks of size 2^( 4) =       0.000412911752
  error estimate for blocks of size 2^( 5) =       0.000418053492
  error estimate for blocks of size 2^( 6) =       0.000421996975
  error estimate for blocks of size 2^( 7) =       0.000423443577

      target function =                  N/A
              le_mean =     -17.216318688587
             les_mean =     296.715720970444
             stat err =       0.000419101449
             autocorr =       1.167140883954
              std dev =       0.548621115904
             le_variance =       0.300985128816


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721631868859e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+69, overlap shift 6.1035e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216318688617       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216318688617       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+69 is 5.358692e-74

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+70, overlap shift 2.4414e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216318688617       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216318688617       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+70 is 1.339673e-74

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+70, overlap shift 9.7656e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216318688617       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216318688617       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+70 is 3.349182e-75

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.436349 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6266e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.2746
    reference variance = 0.232897
====================================================
  Execution time = 1.3394e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1401e-01
  Total weights = 1.9564e+06
  Execution time = 1.8362e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300280015467
                                         uncertainty =       0.002187290623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300280015467
                                         uncertainty =       0.002187290623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387511187
  error estimate for blocks of size 2^( 2) =       0.000397664651
  error estimate for blocks of size 2^( 3) =       0.000407199388
  error estimate for blocks of size 2^( 4) =       0.000413857437
  error estimate for blocks of size 2^( 5) =       0.000419156189
  error estimate for blocks of size 2^( 6) =       0.000421514252
  error estimate for blocks of size 2^( 7) =       0.000421579034

      target function =                  N/A
              le_mean =     -17.217172933800
             les_mean =     296.745052815891
             stat err =       0.000419026728
             autocorr =       1.169270419673
              std dev =       0.548023575753
             le_variance =       0.300329839581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300280015467
                                         uncertainty =       0.002187290623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300280015467
                                         uncertainty =       0.002187290623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387511187
  error estimate for blocks of size 2^( 2) =       0.000397664651
  error estimate for blocks of size 2^( 3) =       0.000407199388
  error estimate for blocks of size 2^( 4) =       0.000413857437
  error estimate for blocks of size 2^( 5) =       0.000419156189
  error estimate for blocks of size 2^( 6) =       0.000421514252
  error estimate for blocks of size 2^( 7) =       0.000421579034

      target function =                  N/A
              le_mean =     -17.217172933800
             les_mean =     296.745052815891
             stat err =       0.000419026728
             autocorr =       1.169270419673
              std dev =       0.548023575753
             le_variance =       0.300329839581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300280015467
                                         uncertainty =       0.002187290623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300280015467
                                         uncertainty =       0.002187290623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387511187
  error estimate for blocks of size 2^( 2) =       0.000397664651
  error estimate for blocks of size 2^( 3) =       0.000407199388
  error estimate for blocks of size 2^( 4) =       0.000413857437
  error estimate for blocks of size 2^( 5) =       0.000419156189
  error estimate for blocks of size 2^( 6) =       0.000421514252
  error estimate for blocks of size 2^( 7) =       0.000421579034

      target function =                  N/A
              le_mean =     -17.217172933800
             les_mean =     296.745052815891
             stat err =       0.000419026728
             autocorr =       1.169270419673
              std dev =       0.548023575753
             le_variance =       0.300329839581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300280015467
                                         uncertainty =       0.002187290623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300280015467
                                         uncertainty =       0.002187290623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387511187
  error estimate for blocks of size 2^( 2) =       0.000397664651
  error estimate for blocks of size 2^( 3) =       0.000407199388
  error estimate for blocks of size 2^( 4) =       0.000413857437
  error estimate for blocks of size 2^( 5) =       0.000419156189
  error estimate for blocks of size 2^( 6) =       0.000421514252
  error estimate for blocks of size 2^( 7) =       0.000421579034

      target function =                  N/A
              le_mean =     -17.217172933800
             les_mean =     296.745052815891
             stat err =       0.000419026728
             autocorr =       1.169270419673
              std dev =       0.548023575753
             le_variance =       0.300329839581


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217172933800        initial  <--
     6.1035e+69     6.1035e+70             5.3587e-74       -17.217172933800
     2.4414e+70     2.4414e+71             1.3397e-74       -17.217172933800
     9.7656e+70     9.7656e+71             3.3492e-75       -17.217172933800

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6386
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8915e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.2483
    reference variance = 0.259036
====================================================
  Execution time = 1.3927e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1535e-01
  Total weights = 1.956881386e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4744e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299416343379
                                         uncertainty =       0.001936740741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299416343379
                                         uncertainty =       0.001936740741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386932091
  error estimate for blocks of size 2^( 2) =       0.000396666209
  error estimate for blocks of size 2^( 3) =       0.000405412679
  error estimate for blocks of size 2^( 4) =       0.000412658617
  error estimate for blocks of size 2^( 5) =       0.000415878768
  error estimate for blocks of size 2^( 6) =       0.000418899692
  error estimate for blocks of size 2^( 7) =       0.000421089803

      target function =                  N/A
              le_mean =     -17.216620236675
             les_mean =     296.727361294811
             stat err =       0.000417131720
             autocorr =       1.162189460350
              std dev =       0.547204610327
             le_variance =       0.299432885563


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721662023668e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+70, overlap shift 6.1035e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216620236718       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216620236718       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+70 is 6.084121e-75

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+71, overlap shift 2.4414e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216620236718       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216620236718       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+71 is 1.521030e-75

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+71, overlap shift 9.7656e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216620236718       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216620236718       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+71 is 3.802576e-76

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.437421 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6406e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.2506
    reference variance = 0.282752
====================================================
  Execution time = 1.3375e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1546e-01
  Total weights = 1.9567e+06
  Execution time = 1.8380e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302100990590
                                         uncertainty =       0.002141435094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302100990590
                                         uncertainty =       0.002141435094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388595229
  error estimate for blocks of size 2^( 2) =       0.000398674580
  error estimate for blocks of size 2^( 3) =       0.000407862394
  error estimate for blocks of size 2^( 4) =       0.000414110764
  error estimate for blocks of size 2^( 5) =       0.000418910400
  error estimate for blocks of size 2^( 6) =       0.000420695904
  error estimate for blocks of size 2^( 7) =       0.000422425298

      target function =                  N/A
              le_mean =     -17.216502788488
             les_mean =     296.723431284810
             stat err =       0.000419035591
             autocorr =       1.162805015255
              std dev =       0.549556642564
             le_variance =       0.302012503386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302100990590
                                         uncertainty =       0.002141435094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302100990590
                                         uncertainty =       0.002141435094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388595229
  error estimate for blocks of size 2^( 2) =       0.000398674580
  error estimate for blocks of size 2^( 3) =       0.000407862394
  error estimate for blocks of size 2^( 4) =       0.000414110764
  error estimate for blocks of size 2^( 5) =       0.000418910400
  error estimate for blocks of size 2^( 6) =       0.000420695904
  error estimate for blocks of size 2^( 7) =       0.000422425298

      target function =                  N/A
              le_mean =     -17.216502788488
             les_mean =     296.723431284810
             stat err =       0.000419035591
             autocorr =       1.162805015255
              std dev =       0.549556642564
             le_variance =       0.302012503386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302100990590
                                         uncertainty =       0.002141435094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302100990590
                                         uncertainty =       0.002141435094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388595229
  error estimate for blocks of size 2^( 2) =       0.000398674580
  error estimate for blocks of size 2^( 3) =       0.000407862394
  error estimate for blocks of size 2^( 4) =       0.000414110764
  error estimate for blocks of size 2^( 5) =       0.000418910400
  error estimate for blocks of size 2^( 6) =       0.000420695904
  error estimate for blocks of size 2^( 7) =       0.000422425298

      target function =                  N/A
              le_mean =     -17.216502788488
             les_mean =     296.723431284810
             stat err =       0.000419035591
             autocorr =       1.162805015255
              std dev =       0.549556642564
             le_variance =       0.302012503386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302100990590
                                         uncertainty =       0.002141435094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302100990590
                                         uncertainty =       0.002141435094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388595229
  error estimate for blocks of size 2^( 2) =       0.000398674580
  error estimate for blocks of size 2^( 3) =       0.000407862394
  error estimate for blocks of size 2^( 4) =       0.000414110764
  error estimate for blocks of size 2^( 5) =       0.000418910400
  error estimate for blocks of size 2^( 6) =       0.000420695904
  error estimate for blocks of size 2^( 7) =       0.000422425298

      target function =                  N/A
              le_mean =     -17.216502788488
             les_mean =     296.723431284810
             stat err =       0.000419035591
             autocorr =       1.162805015255
              std dev =       0.549556642564
             le_variance =       0.302012503386


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216502788488        initial  <--
     6.1035e+70     6.1035e+71             6.0841e-75       -17.216502788488
     2.4414e+71     2.4414e+72             1.5210e-75       -17.216502788488
     9.7656e+71     9.7656e+72             3.8026e-76       -17.216502788488

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6358
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9081e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.3119
    reference variance = 0.179438
====================================================
  Execution time = 1.4117e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5303e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1512e-01
  Total weights = 1.956727376e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300724007895
                                         uncertainty =       0.002298850815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300724007895
                                         uncertainty =       0.002298850815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387724314
  error estimate for blocks of size 2^( 2) =       0.000397628573
  error estimate for blocks of size 2^( 3) =       0.000407008063
  error estimate for blocks of size 2^( 4) =       0.000413855688
  error estimate for blocks of size 2^( 5) =       0.000418228906
  error estimate for blocks of size 2^( 6) =       0.000420596919
  error estimate for blocks of size 2^( 7) =       0.000421709546

      target function =                  N/A
              le_mean =     -17.216725200188
             les_mean =     296.730748255894
             stat err =       0.000418597765
             autocorr =       1.165595165353
              std dev =       0.548324983396
             le_variance =       0.300660287417


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721672520019e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+71, overlap shift 6.1035e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216725200225       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216725200225       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+71 is 4.861718e-76

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+72, overlap shift 2.4414e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216725200225       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216725200225       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+72 is 1.215430e-76

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+72, overlap shift 9.7656e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216725200225       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216725200225       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+72 is 3.038574e-77

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.438434 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6606e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.1743
    reference variance = 0.182822
====================================================
  Execution time = 1.3338e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1169e-01
  Total weights = 1.9566e+06
  Execution time = 1.8387e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297949301016
                                         uncertainty =       0.001703884323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297949301016
                                         uncertainty =       0.001703884323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385967043
  error estimate for blocks of size 2^( 2) =       0.000395904198
  error estimate for blocks of size 2^( 3) =       0.000405250076
  error estimate for blocks of size 2^( 4) =       0.000412884107
  error estimate for blocks of size 2^( 5) =       0.000416783629
  error estimate for blocks of size 2^( 6) =       0.000419336133
  error estimate for blocks of size 2^( 7) =       0.000419135647

      target function =                  N/A
              le_mean =     -17.216127105109
             les_mean =     296.706725757264
             stat err =       0.000417034879
             autocorr =       1.167466190819
              std dev =       0.545839827022
             le_variance =       0.297941116763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297949301016
                                         uncertainty =       0.001703884323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297949301016
                                         uncertainty =       0.001703884323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385967043
  error estimate for blocks of size 2^( 2) =       0.000395904198
  error estimate for blocks of size 2^( 3) =       0.000405250076
  error estimate for blocks of size 2^( 4) =       0.000412884107
  error estimate for blocks of size 2^( 5) =       0.000416783629
  error estimate for blocks of size 2^( 6) =       0.000419336133
  error estimate for blocks of size 2^( 7) =       0.000419135647

      target function =                  N/A
              le_mean =     -17.216127105109
             les_mean =     296.706725757264
             stat err =       0.000417034879
             autocorr =       1.167466190819
              std dev =       0.545839827022
             le_variance =       0.297941116763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297949301016
                                         uncertainty =       0.001703884323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297949301016
                                         uncertainty =       0.001703884323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385967043
  error estimate for blocks of size 2^( 2) =       0.000395904198
  error estimate for blocks of size 2^( 3) =       0.000405250076
  error estimate for blocks of size 2^( 4) =       0.000412884107
  error estimate for blocks of size 2^( 5) =       0.000416783629
  error estimate for blocks of size 2^( 6) =       0.000419336133
  error estimate for blocks of size 2^( 7) =       0.000419135647

      target function =                  N/A
              le_mean =     -17.216127105109
             les_mean =     296.706725757264
             stat err =       0.000417034879
             autocorr =       1.167466190819
              std dev =       0.545839827022
             le_variance =       0.297941116763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297949301016
                                         uncertainty =       0.001703884323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297949301016
                                         uncertainty =       0.001703884323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385967043
  error estimate for blocks of size 2^( 2) =       0.000395904198
  error estimate for blocks of size 2^( 3) =       0.000405250076
  error estimate for blocks of size 2^( 4) =       0.000412884107
  error estimate for blocks of size 2^( 5) =       0.000416783629
  error estimate for blocks of size 2^( 6) =       0.000419336133
  error estimate for blocks of size 2^( 7) =       0.000419135647

      target function =                  N/A
              le_mean =     -17.216127105109
             les_mean =     296.706725757264
             stat err =       0.000417034879
             autocorr =       1.167466190819
              std dev =       0.545839827022
             le_variance =       0.297941116763


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216127105109        initial  <--
     6.1035e+71     6.1035e+72             4.8617e-76       -17.216127105109
     2.4414e+72     2.4414e+73             1.2154e-76       -17.216127105109
     9.7656e+72     9.7656e+73             3.0386e-77       -17.216127105109

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6034
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9217e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.2799
    reference variance = 0.136491
====================================================
  Execution time = 1.4043e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1964e-01
  Total weights = 1.956536689e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4899e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304707445910
                                         uncertainty =       0.002673792308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304707445910
                                         uncertainty =       0.002673792308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390292173
  error estimate for blocks of size 2^( 2) =       0.000400182059
  error estimate for blocks of size 2^( 3) =       0.000408697609
  error estimate for blocks of size 2^( 4) =       0.000415218651
  error estimate for blocks of size 2^( 5) =       0.000419784940
  error estimate for blocks of size 2^( 6) =       0.000421652561
  error estimate for blocks of size 2^( 7) =       0.000422735193

      target function =                  N/A
              le_mean =     -17.216320702531
             les_mean =     296.721335359908
             stat err =       0.000419847836
             autocorr =       1.157188621022
              std dev =       0.551956484681
             le_variance =       0.304655960981


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721632070253e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+72, overlap shift 6.1035e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216320702571       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216320702571       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+72 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+73, overlap shift 2.4414e+74 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216320702571       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216320702571       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+73 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+73, overlap shift 9.7656e+74 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216320702571       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216320702571       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+73 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.439512 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6538e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.1888
    reference variance = 0.480291
====================================================
  Execution time = 1.3479e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1484e-01
  Total weights = 1.9569e+06
  Execution time = 1.8335e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300962118473
                                         uncertainty =       0.001979208928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300962118473
                                         uncertainty =       0.001979208928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387858342
  error estimate for blocks of size 2^( 2) =       0.000398263132
  error estimate for blocks of size 2^( 3) =       0.000407056600
  error estimate for blocks of size 2^( 4) =       0.000413704707
  error estimate for blocks of size 2^( 5) =       0.000418293616
  error estimate for blocks of size 2^( 6) =       0.000419775332
  error estimate for blocks of size 2^( 7) =       0.000420466420

      target function =                  N/A
              le_mean =     -17.217033410584
             les_mean =     296.741077367742
             stat err =       0.000418060019
             autocorr =       1.161798998265
              std dev =       0.548514527894
             le_variance =       0.300868187311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300962118473
                                         uncertainty =       0.001979208928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300962118473
                                         uncertainty =       0.001979208928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387858342
  error estimate for blocks of size 2^( 2) =       0.000398263132
  error estimate for blocks of size 2^( 3) =       0.000407056600
  error estimate for blocks of size 2^( 4) =       0.000413704707
  error estimate for blocks of size 2^( 5) =       0.000418293616
  error estimate for blocks of size 2^( 6) =       0.000419775332
  error estimate for blocks of size 2^( 7) =       0.000420466420

      target function =                  N/A
              le_mean =     -17.217033410584
             les_mean =     296.741077367742
             stat err =       0.000418060019
             autocorr =       1.161798998265
              std dev =       0.548514527894
             le_variance =       0.300868187311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300962118473
                                         uncertainty =       0.001979208928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300962118473
                                         uncertainty =       0.001979208928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387858342
  error estimate for blocks of size 2^( 2) =       0.000398263132
  error estimate for blocks of size 2^( 3) =       0.000407056600
  error estimate for blocks of size 2^( 4) =       0.000413704707
  error estimate for blocks of size 2^( 5) =       0.000418293616
  error estimate for blocks of size 2^( 6) =       0.000419775332
  error estimate for blocks of size 2^( 7) =       0.000420466420

      target function =                  N/A
              le_mean =     -17.217033410584
             les_mean =     296.741077367742
             stat err =       0.000418060019
             autocorr =       1.161798998265
              std dev =       0.548514527894
             le_variance =       0.300868187311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300962118473
                                         uncertainty =       0.001979208928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300962118473
                                         uncertainty =       0.001979208928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387858342
  error estimate for blocks of size 2^( 2) =       0.000398263132
  error estimate for blocks of size 2^( 3) =       0.000407056600
  error estimate for blocks of size 2^( 4) =       0.000413704707
  error estimate for blocks of size 2^( 5) =       0.000418293616
  error estimate for blocks of size 2^( 6) =       0.000419775332
  error estimate for blocks of size 2^( 7) =       0.000420466420

      target function =                  N/A
              le_mean =     -17.217033410584
             les_mean =     296.741077367742
             stat err =       0.000418060019
             autocorr =       1.161798998265
              std dev =       0.548514527894
             le_variance =       0.300868187311


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217033410584        initial  <--
     6.1035e+72     6.1035e+73             0.0000e+00       -17.217033410584
     2.4414e+73     2.4414e+74             0.0000e+00       -17.217033410584
     9.7656e+73     9.7656e+74             0.0000e+00       -17.217033410584

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7238
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9272e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.2569
    reference variance = 0.218036
====================================================
  Execution time = 1.3783e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0825e-01
  Total weights = 1.956624685e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4838e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296697266482
                                         uncertainty =       0.001825869006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296697266482
                                         uncertainty =       0.001825869006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385177949
  error estimate for blocks of size 2^( 2) =       0.000394932442
  error estimate for blocks of size 2^( 3) =       0.000403998558
  error estimate for blocks of size 2^( 4) =       0.000410832588
  error estimate for blocks of size 2^( 5) =       0.000415215018
  error estimate for blocks of size 2^( 6) =       0.000417279486
  error estimate for blocks of size 2^( 7) =       0.000417867992

      target function =                  N/A
              le_mean =     -17.215423414966
             les_mean =     296.679052759538
             stat err =       0.000415298771
             autocorr =       1.162514717659
              std dev =       0.544723879050
             le_variance =       0.296724104407


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721542341497e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+73, overlap shift 6.1035e+74 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215423415026       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215423415026       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+73 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+74, overlap shift 2.4414e+75 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215423415026       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215423415026       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+74 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+74, overlap shift 9.7656e+75 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215423415026       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215423415026       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+74 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.440531 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6271e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.2569
    reference variance = 0.318932
====================================================
  Execution time = 1.3403e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1672e-01
  Total weights = 1.9565e+06
  Execution time = 1.8364e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299621739327
                                         uncertainty =       0.002004558264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299621739327
                                         uncertainty =       0.002004558264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387068031
  error estimate for blocks of size 2^( 2) =       0.000397144058
  error estimate for blocks of size 2^( 3) =       0.000405731223
  error estimate for blocks of size 2^( 4) =       0.000412092339
  error estimate for blocks of size 2^( 5) =       0.000415968136
  error estimate for blocks of size 2^( 6) =       0.000419642735
  error estimate for blocks of size 2^( 7) =       0.000422102154

      target function =                  N/A
              le_mean =     -17.215699112380
             les_mean =     296.697020501842
             stat err =       0.000417451341
             autocorr =       1.163153719507
              std dev =       0.547396859539
             le_variance =       0.299643321833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299621739327
                                         uncertainty =       0.002004558264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299621739327
                                         uncertainty =       0.002004558264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387068031
  error estimate for blocks of size 2^( 2) =       0.000397144058
  error estimate for blocks of size 2^( 3) =       0.000405731223
  error estimate for blocks of size 2^( 4) =       0.000412092339
  error estimate for blocks of size 2^( 5) =       0.000415968136
  error estimate for blocks of size 2^( 6) =       0.000419642735
  error estimate for blocks of size 2^( 7) =       0.000422102154

      target function =                  N/A
              le_mean =     -17.215699112380
             les_mean =     296.697020501842
             stat err =       0.000417451341
             autocorr =       1.163153719507
              std dev =       0.547396859539
             le_variance =       0.299643321833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299621739327
                                         uncertainty =       0.002004558264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299621739327
                                         uncertainty =       0.002004558264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387068031
  error estimate for blocks of size 2^( 2) =       0.000397144058
  error estimate for blocks of size 2^( 3) =       0.000405731223
  error estimate for blocks of size 2^( 4) =       0.000412092339
  error estimate for blocks of size 2^( 5) =       0.000415968136
  error estimate for blocks of size 2^( 6) =       0.000419642735
  error estimate for blocks of size 2^( 7) =       0.000422102154

      target function =                  N/A
              le_mean =     -17.215699112380
             les_mean =     296.697020501842
             stat err =       0.000417451341
             autocorr =       1.163153719507
              std dev =       0.547396859539
             le_variance =       0.299643321833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299621739327
                                         uncertainty =       0.002004558264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299621739327
                                         uncertainty =       0.002004558264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387068031
  error estimate for blocks of size 2^( 2) =       0.000397144058
  error estimate for blocks of size 2^( 3) =       0.000405731223
  error estimate for blocks of size 2^( 4) =       0.000412092339
  error estimate for blocks of size 2^( 5) =       0.000415968136
  error estimate for blocks of size 2^( 6) =       0.000419642735
  error estimate for blocks of size 2^( 7) =       0.000422102154

      target function =                  N/A
              le_mean =     -17.215699112380
             les_mean =     296.697020501842
             stat err =       0.000417451341
             autocorr =       1.163153719507
              std dev =       0.547396859539
             le_variance =       0.299643321833


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215699112380        initial  <--
     6.1035e+73     6.1035e+74             0.0000e+00       -17.215699112380
     2.4414e+74     2.4414e+75             0.0000e+00       -17.215699112380
     9.7656e+74     9.7656e+75             0.0000e+00       -17.215699112380

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6702
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8950e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.1729
    reference variance = 1.06159
====================================================
  Execution time = 1.3795e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1509e-01
  Total weights = 1.956895375e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4669e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300703450676
                                         uncertainty =       0.002341821511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300703450676
                                         uncertainty =       0.002341821511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387844785
  error estimate for blocks of size 2^( 2) =       0.000397353276
  error estimate for blocks of size 2^( 3) =       0.000406446514
  error estimate for blocks of size 2^( 4) =       0.000412855231
  error estimate for blocks of size 2^( 5) =       0.000416844932
  error estimate for blocks of size 2^( 6) =       0.000419859360
  error estimate for blocks of size 2^( 7) =       0.000421308497

      target function =                  N/A
              le_mean =     -17.216051254502
             les_mean =     296.707511827374
             stat err =       0.000417717005
             autocorr =       1.159974384034
              std dev =       0.548495354848
             le_variance =       0.300847154289


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721605125450e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+74, overlap shift 6.1035e+75 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216051254538       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216051254538       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+74 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+75, overlap shift 2.4414e+76 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216051254538       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216051254538       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+75 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+75, overlap shift 9.7656e+76 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216051254538       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216051254538       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+75 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.441599 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6267e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2103
    reference variance = 0.420198
====================================================
  Execution time = 1.3679e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1423e-01
  Total weights = 1.9567e+06
  Execution time = 1.8272e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299483116082
                                         uncertainty =       0.001762964078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299483116082
                                         uncertainty =       0.001762964078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387019261
  error estimate for blocks of size 2^( 2) =       0.000397256976
  error estimate for blocks of size 2^( 3) =       0.000406158807
  error estimate for blocks of size 2^( 4) =       0.000412491534
  error estimate for blocks of size 2^( 5) =       0.000416146168
  error estimate for blocks of size 2^( 6) =       0.000418798413
  error estimate for blocks of size 2^( 7) =       0.000417705720

      target function =                  N/A
              le_mean =     -17.216635579906
             les_mean =     296.726769297468
             stat err =       0.000416285459
             autocorr =       1.156957277227
              std dev =       0.547327888283
             le_variance =       0.299567817293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299483116082
                                         uncertainty =       0.001762964078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299483116082
                                         uncertainty =       0.001762964078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387019261
  error estimate for blocks of size 2^( 2) =       0.000397256976
  error estimate for blocks of size 2^( 3) =       0.000406158807
  error estimate for blocks of size 2^( 4) =       0.000412491534
  error estimate for blocks of size 2^( 5) =       0.000416146168
  error estimate for blocks of size 2^( 6) =       0.000418798413
  error estimate for blocks of size 2^( 7) =       0.000417705720

      target function =                  N/A
              le_mean =     -17.216635579906
             les_mean =     296.726769297468
             stat err =       0.000416285459
             autocorr =       1.156957277227
              std dev =       0.547327888283
             le_variance =       0.299567817293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299483116082
                                         uncertainty =       0.001762964078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299483116082
                                         uncertainty =       0.001762964078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387019261
  error estimate for blocks of size 2^( 2) =       0.000397256976
  error estimate for blocks of size 2^( 3) =       0.000406158807
  error estimate for blocks of size 2^( 4) =       0.000412491534
  error estimate for blocks of size 2^( 5) =       0.000416146168
  error estimate for blocks of size 2^( 6) =       0.000418798413
  error estimate for blocks of size 2^( 7) =       0.000417705720

      target function =                  N/A
              le_mean =     -17.216635579906
             les_mean =     296.726769297468
             stat err =       0.000416285459
             autocorr =       1.156957277227
              std dev =       0.547327888283
             le_variance =       0.299567817293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299483116082
                                         uncertainty =       0.001762964078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299483116082
                                         uncertainty =       0.001762964078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387019261
  error estimate for blocks of size 2^( 2) =       0.000397256976
  error estimate for blocks of size 2^( 3) =       0.000406158807
  error estimate for blocks of size 2^( 4) =       0.000412491534
  error estimate for blocks of size 2^( 5) =       0.000416146168
  error estimate for blocks of size 2^( 6) =       0.000418798413
  error estimate for blocks of size 2^( 7) =       0.000417705720

      target function =                  N/A
              le_mean =     -17.216635579906
             les_mean =     296.726769297468
             stat err =       0.000416285459
             autocorr =       1.156957277227
              std dev =       0.547327888283
             le_variance =       0.299567817293


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216635579906        initial  <--
     6.1035e+74     6.1035e+75             0.0000e+00       -17.216635579906
     2.4414e+75     2.4414e+76             0.0000e+00       -17.216635579906
     9.7656e+75     9.7656e+76             0.0000e+00       -17.216635579906

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9142
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9189e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.1563
    reference variance = 0.647016
====================================================
  Execution time = 1.5901e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2094e-01
  Total weights = 1.956580445e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5150e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300471124989
                                         uncertainty =       0.003076673421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300471124989
                                         uncertainty =       0.003076673421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387730552
  error estimate for blocks of size 2^( 2) =       0.000397617609
  error estimate for blocks of size 2^( 3) =       0.000406664896
  error estimate for blocks of size 2^( 4) =       0.000413641282
  error estimate for blocks of size 2^( 5) =       0.000417843880
  error estimate for blocks of size 2^( 6) =       0.000420891006
  error estimate for blocks of size 2^( 7) =       0.000421434235

      target function =                  N/A
              le_mean =     -17.216395634496
             les_mean =     296.725223602286
             stat err =       0.000418452601
             autocorr =       1.164749402834
              std dev =       0.548333804717
             le_variance =       0.300669961395


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721639563450e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+75, overlap shift 6.1035e+76 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216395634535       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216395634535       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216395634535       residual = 8.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+75 is 6.202726e-80

solving harmonic davidson linear method for identity shift 2.4414e+76, overlap shift 2.4414e+77 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216395634535       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216395634535       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216395634535       residual = 8.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+76 is 1.550682e-80

solving harmonic davidson linear method for identity shift 9.7656e+76, overlap shift 9.7656e+77 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216395634535       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216395634535       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216395634535       residual = 8.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+76 is 3.876704e-81

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.442680 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8421e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.2389
    reference variance = 0.160818
====================================================
  Execution time = 1.3741e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1968e-01
  Total weights = 1.9566e+06
  Execution time = 1.8257e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302433153029
                                         uncertainty =       0.002643906207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302433153029
                                         uncertainty =       0.002643906207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388835464
  error estimate for blocks of size 2^( 2) =       0.000398547036
  error estimate for blocks of size 2^( 3) =       0.000407017875
  error estimate for blocks of size 2^( 4) =       0.000413879494
  error estimate for blocks of size 2^( 5) =       0.000417550167
  error estimate for blocks of size 2^( 6) =       0.000419311662
  error estimate for blocks of size 2^( 7) =       0.000419971988

      target function =                  N/A
              le_mean =     -17.216608808800
             les_mean =     296.731303256689
             stat err =       0.000417678328
             autocorr =       1.153857416640
              std dev =       0.549896386972
             le_variance =       0.302386036404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302433153029
                                         uncertainty =       0.002643906207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302433153029
                                         uncertainty =       0.002643906207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388835464
  error estimate for blocks of size 2^( 2) =       0.000398547036
  error estimate for blocks of size 2^( 3) =       0.000407017875
  error estimate for blocks of size 2^( 4) =       0.000413879494
  error estimate for blocks of size 2^( 5) =       0.000417550167
  error estimate for blocks of size 2^( 6) =       0.000419311662
  error estimate for blocks of size 2^( 7) =       0.000419971988

      target function =                  N/A
              le_mean =     -17.216608808800
             les_mean =     296.731303256689
             stat err =       0.000417678328
             autocorr =       1.153857416640
              std dev =       0.549896386972
             le_variance =       0.302386036404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302433153029
                                         uncertainty =       0.002643906207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302433153029
                                         uncertainty =       0.002643906207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388835464
  error estimate for blocks of size 2^( 2) =       0.000398547036
  error estimate for blocks of size 2^( 3) =       0.000407017875
  error estimate for blocks of size 2^( 4) =       0.000413879494
  error estimate for blocks of size 2^( 5) =       0.000417550167
  error estimate for blocks of size 2^( 6) =       0.000419311662
  error estimate for blocks of size 2^( 7) =       0.000419971988

      target function =                  N/A
              le_mean =     -17.216608808800
             les_mean =     296.731303256689
             stat err =       0.000417678328
             autocorr =       1.153857416640
              std dev =       0.549896386972
             le_variance =       0.302386036404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302433153029
                                         uncertainty =       0.002643906207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302433153029
                                         uncertainty =       0.002643906207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388835464
  error estimate for blocks of size 2^( 2) =       0.000398547036
  error estimate for blocks of size 2^( 3) =       0.000407017875
  error estimate for blocks of size 2^( 4) =       0.000413879494
  error estimate for blocks of size 2^( 5) =       0.000417550167
  error estimate for blocks of size 2^( 6) =       0.000419311662
  error estimate for blocks of size 2^( 7) =       0.000419971988

      target function =                  N/A
              le_mean =     -17.216608808800
             les_mean =     296.731303256689
             stat err =       0.000417678328
             autocorr =       1.153857416640
              std dev =       0.549896386972
             le_variance =       0.302386036404


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216608808800        initial  <--
     6.1035e+75     6.1035e+76             6.2027e-80       -17.216608808800
     2.4414e+76     2.4414e+77             1.5507e-80       -17.216608808800
     9.7656e+76     9.7656e+77             3.8767e-81       -17.216608808800

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9491
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1380e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.1724
    reference variance = 0.22082
====================================================
  Execution time = 1.3847e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1572e-01
  Total weights = 1.956498576e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4736e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298570056101
                                         uncertainty =       0.002240340135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298570056101
                                         uncertainty =       0.002240340135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386352070
  error estimate for blocks of size 2^( 2) =       0.000396372491
  error estimate for blocks of size 2^( 3) =       0.000405456966
  error estimate for blocks of size 2^( 4) =       0.000411997255
  error estimate for blocks of size 2^( 5) =       0.000414664499
  error estimate for blocks of size 2^( 6) =       0.000417549388
  error estimate for blocks of size 2^( 7) =       0.000417716511

      target function =                  N/A
              le_mean =     -17.216120381644
             les_mean =     296.710517619037
             stat err =       0.000415481913
             autocorr =       1.156479016006
              std dev =       0.546384337906
             le_variance =       0.298535844710


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721612038164e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+76, overlap shift 6.1035e+77 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216120381679       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216120381679       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216120381679       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+76 is 6.293141e-81

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+77, overlap shift 2.4414e+78 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216120381679       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216120381679       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216120381679       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+77 is 1.573285e-81

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+77, overlap shift 9.7656e+78 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216120381679       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216120381679       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216120381679       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+77 is 3.933213e-82

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.443984 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6326e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.4332
    reference variance = 3.27629
====================================================
  Execution time = 1.3382e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1604e-01
  Total weights = 1.9566e+06
  Execution time = 1.8348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301587144614
                                         uncertainty =       0.002210554248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301587144614
                                         uncertainty =       0.002210554248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388391090
  error estimate for blocks of size 2^( 2) =       0.000398012159
  error estimate for blocks of size 2^( 3) =       0.000406995238
  error estimate for blocks of size 2^( 4) =       0.000413274455
  error estimate for blocks of size 2^( 5) =       0.000417515837
  error estimate for blocks of size 2^( 6) =       0.000419082439
  error estimate for blocks of size 2^( 7) =       0.000420907626

      target function =                  N/A
              le_mean =     -17.216593916617
             les_mean =     296.727151033104
             stat err =       0.000417695089
             autocorr =       1.156592100453
              std dev =       0.549267947138
             le_variance =       0.301695277753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301587144614
                                         uncertainty =       0.002210554248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301587144614
                                         uncertainty =       0.002210554248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388391090
  error estimate for blocks of size 2^( 2) =       0.000398012159
  error estimate for blocks of size 2^( 3) =       0.000406995238
  error estimate for blocks of size 2^( 4) =       0.000413274455
  error estimate for blocks of size 2^( 5) =       0.000417515837
  error estimate for blocks of size 2^( 6) =       0.000419082439
  error estimate for blocks of size 2^( 7) =       0.000420907626

      target function =                  N/A
              le_mean =     -17.216593916617
             les_mean =     296.727151033104
             stat err =       0.000417695089
             autocorr =       1.156592100453
              std dev =       0.549267947138
             le_variance =       0.301695277753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301587144614
                                         uncertainty =       0.002210554248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301587144614
                                         uncertainty =       0.002210554248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388391090
  error estimate for blocks of size 2^( 2) =       0.000398012159
  error estimate for blocks of size 2^( 3) =       0.000406995238
  error estimate for blocks of size 2^( 4) =       0.000413274455
  error estimate for blocks of size 2^( 5) =       0.000417515837
  error estimate for blocks of size 2^( 6) =       0.000419082439
  error estimate for blocks of size 2^( 7) =       0.000420907626

      target function =                  N/A
              le_mean =     -17.216593916617
             les_mean =     296.727151033104
             stat err =       0.000417695089
             autocorr =       1.156592100453
              std dev =       0.549267947138
             le_variance =       0.301695277753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301587144614
                                         uncertainty =       0.002210554248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301587144614
                                         uncertainty =       0.002210554248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388391090
  error estimate for blocks of size 2^( 2) =       0.000398012159
  error estimate for blocks of size 2^( 3) =       0.000406995238
  error estimate for blocks of size 2^( 4) =       0.000413274455
  error estimate for blocks of size 2^( 5) =       0.000417515837
  error estimate for blocks of size 2^( 6) =       0.000419082439
  error estimate for blocks of size 2^( 7) =       0.000420907626

      target function =                  N/A
              le_mean =     -17.216593916617
             les_mean =     296.727151033104
             stat err =       0.000417695089
             autocorr =       1.156592100453
              std dev =       0.549267947138
             le_variance =       0.301695277753


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216593916617        initial  <--
     6.1035e+76     6.1035e+77             6.2931e-81       -17.216593916617
     2.4414e+77     2.4414e+78             1.5733e-81       -17.216593916617
     9.7656e+77     9.7656e+78             3.9332e-82       -17.216593916617

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6253
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_001                -4.040871e-02 3 1  ON 0
ci_002                -2.979538e-02 3 1  ON 1
ci_003                -2.579894e-02 3 1  ON 2
ci_004                 2.127529e-02 3 1  ON 3
ci_005                 2.162903e-02 3 1  ON 4
ci_006                -1.924381e-02 3 1  ON 5
ci_007                -1.910359e-02 3 1  ON 6
ci_008                -1.805239e-02 3 1  ON 7
ci_009                -1.795628e-02 3 1  ON 8
ci_010                -1.750498e-02 3 1  ON 9
ci_011                -1.638229e-02 3 1  ON 10
ci_012                -1.636529e-02 3 1  ON 11
ci_013                -1.941944e-02 3 1  ON 12
ci_014                 1.409546e-02 3 1  ON 13
ci_015                 1.380809e-02 3 1  ON 14
ci_016                 1.661581e-02 3 1  ON 15
ci_017                 1.602526e-02 3 1  ON 16
ci_018                 1.272678e-02 3 1  ON 17
ci_019                 1.274468e-02 3 1  ON 18
ci_020                 1.281358e-02 3 1  ON 19
ci_021                 1.290999e-02 3 1  ON 20
ci_022                 1.161652e-02 3 1  ON 21
ci_023                 1.139636e-02 3 1  ON 22
ci_024                 1.192026e-02 3 1  ON 23
ci_025                 1.142617e-02 3 1  ON 24
ci_026                 1.096701e-02 3 1  ON 25
ci_027                 1.110484e-02 3 1  ON 26
ci_028                -1.407484e-02 3 1  ON 27
ci_029                -1.477657e-02 3 1  ON 28
ci_030                -1.135786e-02 3 1  ON 29
ci_031                -1.095403e-02 3 1  ON 30
ci_032                -1.376031e-02 3 1  ON 31
ci_033                 1.034895e-02 3 1  ON 32
ci_034                 1.021426e-02 3 1  ON 33
ci_035                -4.764948e-03 3 1  ON 34
ci_036                -1.028743e-02 3 1  ON 35
ci_037                -1.009357e-02 3 1  ON 36
ci_038                 1.696006e-03 3 1  ON 37
ci_039                 1.681541e-03 3 1  ON 38
ci_040                -3.773453e-03 3 1  ON 39
ci_041                 9.465424e-03 3 1  ON 40
ci_042                 9.624935e-03 3 1  ON 41
ci_043                -3.042958e-03 3 1  ON 42
ci_044                -1.509620e-02 3 1  ON 43
ci_045                -1.607418e-03 3 1  ON 44
ci_046                 5.773016e-03 3 1  ON 45
ci_047                 5.462210e-03 3 1  ON 46
ci_048                -1.181461e-02 3 1  ON 47
ci_049                -1.181197e-02 3 1  ON 48
ci_050                 7.540381e-03 3 1  ON 49
ci_051                 7.245318e-03 3 1  ON 50
ci_052                -6.486532e-03 3 1  ON 51
ci_053                -6.900634e-03 3 1  ON 52
ci_054                -2.841036e-03 3 1  ON 53
ci_055                -3.008987e-03 3 1  ON 54
ci_056                 4.470408e-03 3 1  ON 55
ci_057                 4.870286e-03 3 1  ON 56
ci_058                -6.948412e-03 3 1  ON 57
ci_059                -6.647324e-03 3 1  ON 58
ci_060                 8.516328e-03 3 1  ON 59
ci_061                 8.383070e-03 3 1  ON 60
ci_062                -3.045240e-03 3 1  ON 61
ci_063                -3.213716e-03 3 1  ON 62
ci_064                -3.159396e-03 3 1  ON 63
ci_065                -4.252914e-03 3 1  ON 64
ci_066                 5.684562e-03 3 1  ON 65
ci_067                 5.841078e-03 3 1  ON 66
ci_068                -4.901378e-03 3 1  ON 67
ci_069                -4.600519e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8957e+01 secs
  Total Execution time = 3.9278e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
