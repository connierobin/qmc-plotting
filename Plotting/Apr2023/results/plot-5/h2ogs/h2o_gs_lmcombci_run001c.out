Rank =    0  Free Memory = 74100 MB
Rank =    1  Free Memory = 74100 MB
Rank =    2  Free Memory = 74100 MB
Rank =    3  Free Memory = 74100 MB
Rank =    4  Free Memory = 74099 MB
Rank =    5  Free Memory = 74099 MB
Rank =    6  Free Memory = 74099 MB
Rank =    7  Free Memory = 74099 MB
Rank =    8  Free Memory = 74099 MB
Rank =    9  Free Memory = 74099 MB
Rank =   10  Free Memory = 74099 MB
Rank =   11  Free Memory = 74099 MB
Rank =   12  Free Memory = 74098 MB
Rank =   13  Free Memory = 74098 MB
Rank =   14  Free Memory = 74098 MB
Rank =   15  Free Memory = 74084 MB
Rank =   16  Free Memory = 74084 MB
Rank =   17  Free Memory = 74084 MB
Rank =   18  Free Memory = 74084 MB
Rank =   19  Free Memory = 74084 MB
Rank =   20  Free Memory = 74084 MB
Rank =   21  Free Memory = 74084 MB
Rank =   22  Free Memory = 74084 MB
Rank =   23  Free Memory = 74084 MB
Rank =   24  Free Memory = 74084 MB
Rank =   25  Free Memory = 74084 MB
Rank =   26  Free Memory = 74084 MB
Rank =   27  Free Memory = 74084 MB
Rank =   28  Free Memory = 74084 MB
Rank =   29  Free Memory = 74084 MB
Rank =   30  Free Memory = 74084 MB
Rank =   31  Free Memory = 74084 MB
Rank =   32  Free Memory = 75445 MB
Rank =   33  Free Memory = 75445 MB
Rank =   34  Free Memory = 75445 MB
Rank =   35  Free Memory = 75445 MB
Rank =   36  Free Memory = 75445 MB
Rank =   37  Free Memory = 75444 MB
Rank =   38  Free Memory = 75444 MB
Rank =   39  Free Memory = 75444 MB
Rank =   40  Free Memory = 75444 MB
Rank =   41  Free Memory = 75444 MB
Rank =   42  Free Memory = 75444 MB
Rank =   43  Free Memory = 75444 MB
Rank =   44  Free Memory = 75444 MB
Rank =   45  Free Memory = 75444 MB
Rank =   46  Free Memory = 75444 MB
Rank =   47  Free Memory = 75444 MB
Rank =   48  Free Memory = 75444 MB
Rank =   49  Free Memory = 75444 MB
Rank =   50  Free Memory = 75444 MB
Rank =   51  Free Memory = 75444 MB
Rank =   52  Free Memory = 75444 MB
Rank =   53  Free Memory = 75444 MB
Rank =   54  Free Memory = 75444 MB
Rank =   55  Free Memory = 75444 MB
Rank =   56  Free Memory = 75444 MB
Rank =   57  Free Memory = 75444 MB
Rank =   58  Free Memory = 75444 MB
Rank =   59  Free Memory = 75444 MB
Rank =   60  Free Memory = 75444 MB
Rank =   61  Free Memory = 75444 MB
Rank =   62  Free Memory = 75444 MB
Rank =   63  Free Memory = 75444 MB
Rank =   64  Free Memory = 80612 MB
Rank =   65  Free Memory = 80612 MB
Rank =   66  Free Memory = 80612 MB
Rank =   67  Free Memory = 80612 MB
Rank =   68  Free Memory = 80612 MB
Rank =   69  Free Memory = 80612 MB
Rank =   70  Free Memory = 80612 MB
Rank =   71  Free Memory = 80612 MB
Rank =   72  Free Memory = 80612 MB
Rank =   73  Free Memory = 80612 MB
Rank =   74  Free Memory = 80612 MB
Rank =   75  Free Memory = 80612 MB
Rank =   76  Free Memory = 80612 MB
Rank =   77  Free Memory = 80612 MB
Rank =   78  Free Memory = 80612 MB
Rank =   79  Free Memory = 80612 MB
Rank =   80  Free Memory = 80612 MB
Rank =   81  Free Memory = 80612 MB
Rank =   82  Free Memory = 80612 MB
Rank =   83  Free Memory = 80612 MB
Rank =   84  Free Memory = 80612 MB
Rank =   85  Free Memory = 80612 MB
Rank =   86  Free Memory = 80612 MB
Rank =   87  Free Memory = 80612 MB
Rank =   88  Free Memory = 80612 MB
Rank =   89  Free Memory = 80612 MB
Rank =   90  Free Memory = 80612 MB
Rank =   91  Free Memory = 80612 MB
Rank =   92  Free Memory = 80612 MB
Rank =   93  Free Memory = 80612 MB
Rank =   94  Free Memory = 80612 MB
Rank =   95  Free Memory = 80612 MB
Rank =   96  Free Memory = 80722 MB
Rank =   97  Free Memory = 80722 MB
Rank =   98  Free Memory = 80722 MB
Rank =   99  Free Memory = 80722 MB
Rank =  100  Free Memory = 80722 MB
Rank =  101  Free Memory = 80722 MB
Rank =  102  Free Memory = 80722 MB
Rank =  103  Free Memory = 80722 MB
Rank =  104  Free Memory = 80722 MB
Rank =  105  Free Memory = 80722 MB
Rank =  106  Free Memory = 80722 MB
Rank =  107  Free Memory = 80722 MB
Rank =  108  Free Memory = 80722 MB
Rank =  109  Free Memory = 80722 MB
Rank =  110  Free Memory = 80722 MB
Rank =  111  Free Memory = 80722 MB
Rank =  112  Free Memory = 80722 MB
Rank =  113  Free Memory = 80722 MB
Rank =  114  Free Memory = 80722 MB
Rank =  115  Free Memory = 80722 MB
Rank =  116  Free Memory = 80722 MB
Rank =  117  Free Memory = 80722 MB
Rank =  118  Free Memory = 80721 MB
Rank =  119  Free Memory = 80721 MB
Rank =  120  Free Memory = 80721 MB
Rank =  121  Free Memory = 80721 MB
Rank =  122  Free Memory = 80721 MB
Rank =  123  Free Memory = 80721 MB
Rank =  124  Free Memory = 80721 MB
Rank =  125  Free Memory = 80721 MB
Rank =  126  Free Memory = 80721 MB
Rank =  127  Free Memory = 80721 MB
  Input file(s): opt_h2o_gs_lmcombci_run001c.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_lmcombci_run001c.xml

  Project = H2O
  date    = 2023-04-14 11:37:59 PDT
  host    = n0098.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 391

  Range of prime numbers to use as seeds over processors and threads = 2699-3733


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.061949e-01    1         1 OFF
     uu_1                 4.539117e-02    1         1 OFF
     uu_2                -4.680481e-02    1         1 OFF
     uu_3                -9.936272e-02    1         1 OFF
     uu_4                -1.304449e-01    1         1 OFF
     uu_5                -1.356413e-01    1         1 OFF
     uu_6                -1.130357e-01    1         1 OFF
     uu_7                -3.972344e-02    1         1 OFF
     uu_8                 9.988696e-02    1         1 OFF
     uu_9                 1.208933e-01    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.495801e-01    1         1 OFF
     ud_1                 9.178565e-02    1         1 OFF
     ud_2                -1.648758e-02    1         1 OFF
     ud_3                -7.596335e-02    1         1 OFF
     ud_4                -1.217524e-01    1         1 OFF
     ud_5                -1.523214e-01    1         1 OFF
     ud_6                -1.544624e-01    1         1 OFF
     ud_7                -1.100034e-01    1         1 OFF
     ud_8                 4.463187e-03    1         1 OFF
     ud_9                 9.258159e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.504332e-01    1         1 OFF
     eO_1                -4.354966e-01    1         1 OFF
     eO_2                -3.598301e-02    1         1 OFF
     eO_3                 2.081612e-01    1         1 OFF
     eO_4                 2.891481e-01    1         1 OFF
     eO_5                 3.052708e-01    1         1 OFF
     eO_6                 2.501148e-01    1         1 OFF
     eO_7                 1.121837e-01    1         1 OFF
     eO_8                 2.793060e-02    1         1 OFF
     eO_9                 1.846823e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.820113e-01    1         1 OFF
     eH1_1                -1.027126e-01    1         1 OFF
     eH1_2                -6.202978e-02    1         1 OFF
     eH1_3                -2.594624e-02    1         1 OFF
     eH1_4                 1.931583e-02    1         1 OFF
     eH1_5                 3.552903e-02    1         1 OFF
     eH1_6                 7.728065e-02    1         1 OFF
     eH1_7                 1.103061e-01    1         1 OFF
     eH1_8                 9.073801e-02    1         1 OFF
     eH1_9                 2.428776e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.835289e-01    1         1 OFF
     eH2_1                -1.038380e-01    1         1 OFF
     eH2_2                -6.350521e-02    1         1 OFF
     eH2_3                -2.706107e-02    1         1 OFF
     eH2_4                 1.856801e-02    1         1 OFF
     eH2_5                 3.504988e-02    1         1 OFF
     eH2_6                 7.827831e-02    1         1 OFF
     eH2_7                 1.134121e-01    1         1 OFF
     eH2_8                 9.397367e-02    1         1 OFF
     eH2_9                 2.639279e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.707212e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.4440e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.189
    reference variance = 0.144903
====================================================
  Execution time = 2.7953e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0594e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1510e-01
  Total weights = 3.913579175e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.0687e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300215913645
                                         uncertainty =       0.001381565744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300215913645
                                         uncertainty =       0.001381565744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273937778
  error estimate for blocks of size 2^( 2) =       0.000281051565
  error estimate for blocks of size 2^( 3) =       0.000287510775
  error estimate for blocks of size 2^( 4) =       0.000292113007
  error estimate for blocks of size 2^( 5) =       0.000295079668
  error estimate for blocks of size 2^( 6) =       0.000296534417
  error estimate for blocks of size 2^( 7) =       0.000298094704
  error estimate for blocks of size 2^( 8) =       0.000297646091

      target function =                  N/A
              le_mean =     -17.217300560595
             les_mean =     296.750533757188
             stat err =       0.000296838720
             autocorr =       1.174186938328
              std dev =       0.547875555083
             le_variance =       0.300167623857


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721730056059e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217300560613       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217308882091       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217309973577       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217309935280       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 8.433085e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217300560613       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217303960776       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217304183322       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217304156469       residual = 3.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.291554e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217300560613       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217301570883       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217301605142       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217301597278       residual = 2.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 9.582620e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.309576 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3341e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001 -4.017943e-02                3 1 ON  0
ci_002 -2.956205e-02                3 1 ON  1
ci_003 -2.503498e-02                3 1 ON  2
ci_004 2.084582e-02                 3 1 ON  3
ci_005 2.137907e-02                 3 1 ON  4
ci_006 -1.908355e-02                3 1 ON  5
ci_007 -1.871167e-02                3 1 ON  6
ci_008 -1.781916e-02                3 1 ON  7
ci_009 -1.752550e-02                3 1 ON  8
ci_010 -1.710037e-02                3 1 ON  9
ci_011 -1.647147e-02                3 1 ON  10
ci_012 -1.643804e-02                3 1 ON  11
ci_013 -1.900305e-02                3 1 ON  12
ci_014 1.330071e-02                 3 1 ON  13
ci_015 1.337848e-02                 3 1 ON  14
ci_016 1.619527e-02                 3 1 ON  15
ci_017 1.699423e-02                 3 1 ON  16
ci_018 1.259827e-02                 3 1 ON  17
ci_019 1.234158e-02                 3 1 ON  18
ci_020 1.301423e-02                 3 1 ON  19
ci_021 1.311798e-02                 3 1 ON  20
ci_022 1.182176e-02                 3 1 ON  21
ci_023 1.137030e-02                 3 1 ON  22
ci_024 1.162931e-02                 3 1 ON  23
ci_025 1.169715e-02                 3 1 ON  24
ci_026 1.118704e-02                 3 1 ON  25
ci_027 1.113147e-02                 3 1 ON  26
ci_028 -1.499759e-02                3 1 ON  27
ci_029 -1.427140e-02                3 1 ON  28
ci_030 -1.106468e-02                3 1 ON  29
ci_031 -1.072553e-02                3 1 ON  30
ci_032 -1.332136e-02                3 1 ON  31
ci_033 1.037661e-02                 3 1 ON  32
ci_034 9.919791e-03                 3 1 ON  33
ci_035 -4.574121e-03                3 1 ON  34
ci_036 -1.055246e-02                3 1 ON  35
ci_037 -1.030320e-02                3 1 ON  36
ci_038 1.556158e-03                 3 1 ON  37
ci_039 1.720876e-03                 3 1 ON  38
ci_040 -3.971396e-03                3 1 ON  39
ci_041 9.966444e-03                 3 1 ON  40
ci_042 1.013896e-02                 3 1 ON  41
ci_043 -3.026755e-03                3 1 ON  42
ci_044 -1.549572e-02                3 1 ON  43
ci_045 -1.489097e-03                3 1 ON  44
ci_046 5.171589e-03                 3 1 ON  45
ci_047 5.881308e-03                 3 1 ON  46
ci_048 -1.204082e-02                3 1 ON  47
ci_049 -1.156388e-02                3 1 ON  48
ci_050 7.699182e-03                 3 1 ON  49
ci_051 7.795103e-03                 3 1 ON  50
ci_052 -6.547928e-03                3 1 ON  51
ci_053 -6.521574e-03                3 1 ON  52
ci_054 -2.538307e-03                3 1 ON  53
ci_055 -3.031249e-03                3 1 ON  54
ci_056 4.324634e-03                 3 1 ON  55
ci_057 4.606118e-03                 3 1 ON  56
ci_058 -6.477753e-03                3 1 ON  57
ci_059 -6.863096e-03                3 1 ON  58
ci_060 8.825557e-03                 3 1 ON  59
ci_061 8.958646e-03                 3 1 ON  60
ci_062 -3.475577e-03                3 1 ON  61
ci_063 -2.685695e-03                3 1 ON  62
ci_064 -3.053655e-03                3 1 ON  63
ci_065 -3.808335e-03                3 1 ON  64
ci_066 5.256467e-03                 3 1 ON  65
ci_067 5.534561e-03                 3 1 ON  66
ci_068 -4.603972e-03                3 1 ON  67
ci_069 -5.322860e-03                3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2123
    reference variance = 0.26363
====================================================
  Execution time = 2.6882e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1505e-01
  Total weights = 3.9133e+06
  Execution time = 3.6411e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301064272563
                                         uncertainty =       0.001417152668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301064272563
                                         uncertainty =       0.001417152668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274328324
  error estimate for blocks of size 2^( 2) =       0.000281337307
  error estimate for blocks of size 2^( 3) =       0.000288022217
  error estimate for blocks of size 2^( 4) =       0.000292863652
  error estimate for blocks of size 2^( 5) =       0.000295636971
  error estimate for blocks of size 2^( 6) =       0.000296932896
  error estimate for blocks of size 2^( 7) =       0.000297995199
  error estimate for blocks of size 2^( 8) =       0.000298369480

      target function =                  N/A
              le_mean =     -17.216097020959
             les_mean =     296.716269094603
             stat err =       0.000297233637
             autocorr =       1.173963541028
              std dev =       0.548656647918
             le_variance =       0.301024117304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301074123997
                                         uncertainty =       0.001423619359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301074123997
                                         uncertainty =       0.001423619359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274333474
  error estimate for blocks of size 2^( 2) =       0.000281361303
  error estimate for blocks of size 2^( 3) =       0.000288057090
  error estimate for blocks of size 2^( 4) =       0.000292921505
  error estimate for blocks of size 2^( 5) =       0.000295706898
  error estimate for blocks of size 2^( 6) =       0.000296995313
  error estimate for blocks of size 2^( 7) =       0.000298048882
  error estimate for blocks of size 2^( 8) =       0.000298410137

      target function =                  N/A
              le_mean =     -17.216101019391
             les_mean =     296.778083864819
             stat err =       0.000297290307
             autocorr =       1.174367144119
              std dev =       0.548666948882
             le_variance =       0.301035420796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301056384359
                                         uncertainty =       0.001436058445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301056384359
                                         uncertainty =       0.001436058445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274325329
  error estimate for blocks of size 2^( 2) =       0.000281350470
  error estimate for blocks of size 2^( 3) =       0.000288058275
  error estimate for blocks of size 2^( 4) =       0.000292915792
  error estimate for blocks of size 2^( 5) =       0.000295690348
  error estimate for blocks of size 2^( 6) =       0.000297000957
  error estimate for blocks of size 2^( 7) =       0.000298081113
  error estimate for blocks of size 2^( 8) =       0.000298487742

      target function =                  N/A
              le_mean =     -17.216105804197
             les_mean =     297.019615431900
             stat err =       0.000297315040
             autocorr =       1.174632304935
              std dev =       0.548650657835
             le_variance =       0.301017544343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301039714194
                                         uncertainty =       0.001418534286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301039714194
                                         uncertainty =       0.001418534286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274317234
  error estimate for blocks of size 2^( 2) =       0.000281328696
  error estimate for blocks of size 2^( 3) =       0.000288014687
  error estimate for blocks of size 2^( 4) =       0.000292858031
  error estimate for blocks of size 2^( 5) =       0.000295630612
  error estimate for blocks of size 2^( 6) =       0.000296930465
  error estimate for blocks of size 2^( 7) =       0.000297991912
  error estimate for blocks of size 2^( 8) =       0.000298365237

      target function =                  N/A
              le_mean =     -17.216096832021
             les_mean =     296.714526061887
             stat err =       0.000297229557
             autocorr =       1.174026235218
              std dev =       0.548634467971
             le_variance =       0.300999779446


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216097020959        initial
     2.5000e-01     2.5000e+00             8.4331e-04       -17.216101019391
     1.0000e+00     1.0000e+01             3.2916e-04       -17.216105804197  <--
     4.0000e+00     4.0000e+01             9.5826e-05       -17.216096832021

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.5236e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001                -4.017943e-02 3 1  ON 0
ci_002                -2.956205e-02 3 1  ON 1
ci_003                -2.503498e-02 3 1  ON 2
ci_004                 2.084582e-02 3 1  ON 3
ci_005                 2.137907e-02 3 1  ON 4
ci_006                -1.908355e-02 3 1  ON 5
ci_007                -1.871167e-02 3 1  ON 6
ci_008                -1.781916e-02 3 1  ON 7
ci_009                -1.752550e-02 3 1  ON 8
ci_010                -1.710037e-02 3 1  ON 9
ci_011                -1.647147e-02 3 1  ON 10
ci_012                -1.643804e-02 3 1  ON 11
ci_013                -1.900305e-02 3 1  ON 12
ci_014                 1.330071e-02 3 1  ON 13
ci_015                 1.337848e-02 3 1  ON 14
ci_016                 1.619527e-02 3 1  ON 15
ci_017                 1.699423e-02 3 1  ON 16
ci_018                 1.259827e-02 3 1  ON 17
ci_019                 1.234158e-02 3 1  ON 18
ci_020                 1.301423e-02 3 1  ON 19
ci_021                 1.311798e-02 3 1  ON 20
ci_022                 1.182176e-02 3 1  ON 21
ci_023                 1.137030e-02 3 1  ON 22
ci_024                 1.162931e-02 3 1  ON 23
ci_025                 1.169715e-02 3 1  ON 24
ci_026                 1.118704e-02 3 1  ON 25
ci_027                 1.113147e-02 3 1  ON 26
ci_028                -1.499759e-02 3 1  ON 27
ci_029                -1.427140e-02 3 1  ON 28
ci_030                -1.106468e-02 3 1  ON 29
ci_031                -1.072553e-02 3 1  ON 30
ci_032                -1.332136e-02 3 1  ON 31
ci_033                 1.037661e-02 3 1  ON 32
ci_034                 9.919791e-03 3 1  ON 33
ci_035                -4.574121e-03 3 1  ON 34
ci_036                -1.055246e-02 3 1  ON 35
ci_037                -1.030320e-02 3 1  ON 36
ci_038                 1.556158e-03 3 1  ON 37
ci_039                 1.720876e-03 3 1  ON 38
ci_040                -3.971396e-03 3 1  ON 39
ci_041                 9.966444e-03 3 1  ON 40
ci_042                 1.013896e-02 3 1  ON 41
ci_043                -3.026755e-03 3 1  ON 42
ci_044                -1.549572e-02 3 1  ON 43
ci_045                -1.489097e-03 3 1  ON 44
ci_046                 5.171589e-03 3 1  ON 45
ci_047                 5.881308e-03 3 1  ON 46
ci_048                -1.204082e-02 3 1  ON 47
ci_049                -1.156388e-02 3 1  ON 48
ci_050                 7.699182e-03 3 1  ON 49
ci_051                 7.795103e-03 3 1  ON 50
ci_052                -6.547928e-03 3 1  ON 51
ci_053                -6.521574e-03 3 1  ON 52
ci_054                -2.538307e-03 3 1  ON 53
ci_055                -3.031249e-03 3 1  ON 54
ci_056                 4.324634e-03 3 1  ON 55
ci_057                 4.606118e-03 3 1  ON 56
ci_058                -6.477753e-03 3 1  ON 57
ci_059                -6.863096e-03 3 1  ON 58
ci_060                 8.825557e-03 3 1  ON 59
ci_061                 8.958646e-03 3 1  ON 60
ci_062                -3.475577e-03 3 1  ON 61
ci_063                -2.685695e-03 3 1  ON 62
ci_064                -3.053655e-03 3 1  ON 63
ci_065                -3.808335e-03 3 1  ON 64
ci_066                 5.256467e-03 3 1  ON 65
ci_067                 5.534561e-03 3 1  ON 66
ci_068                -4.603972e-03 3 1  ON 67
ci_069                -5.322860e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8624e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1967
    reference variance = 0.155849
====================================================
  Execution time = 2.6927e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0547e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1764e-01
  Total weights = 3.913501538e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9487e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302691118802
                                         uncertainty =       0.001614960515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302691118802
                                         uncertainty =       0.001614960515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275094757
  error estimate for blocks of size 2^( 2) =       0.000282170151
  error estimate for blocks of size 2^( 3) =       0.000288626957
  error estimate for blocks of size 2^( 4) =       0.000293428465
  error estimate for blocks of size 2^( 5) =       0.000296338443
  error estimate for blocks of size 2^( 6) =       0.000297512043
  error estimate for blocks of size 2^( 7) =       0.000298329854
  error estimate for blocks of size 2^( 8) =       0.000297893899

      target function =                  N/A
              le_mean =     -17.216550569154
             les_mean =     296.727256131189
             stat err =       0.000297518560
             autocorr =       1.169670396882
              std dev =       0.550189514259
             le_variance =       0.302708501600


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721655056915e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216550569177       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216556817003       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216557296554       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216557190929       residual = 9.45e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.538372e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216550569177       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216553124241       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216553066232       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.019654e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216550569177       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216551328665       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216551275872       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 5.872302e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.310800 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1883e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -4.011297e-02 3 1  ON 0
ci_002                -2.972282e-02 3 1  ON 1
ci_003                -2.501122e-02 3 1  ON 2
ci_004                 2.093872e-02 3 1  ON 3
ci_005                 2.126014e-02 3 1  ON 4
ci_006                -1.910593e-02 3 1  ON 5
ci_007                -1.881859e-02 3 1  ON 6
ci_008                -1.778420e-02 3 1  ON 7
ci_009                -1.757784e-02 3 1  ON 8
ci_010                -1.706730e-02 3 1  ON 9
ci_011                -1.652692e-02 3 1  ON 10
ci_012                -1.629254e-02 3 1  ON 11
ci_013                -1.902898e-02 3 1  ON 12
ci_014                 1.346381e-02 3 1  ON 13
ci_015                 1.339488e-02 3 1  ON 14
ci_016                 1.619657e-02 3 1  ON 15
ci_017                 1.701597e-02 3 1  ON 16
ci_018                 1.267915e-02 3 1  ON 17
ci_019                 1.244907e-02 3 1  ON 18
ci_020                 1.290944e-02 3 1  ON 19
ci_021                 1.300574e-02 3 1  ON 20
ci_022                 1.177768e-02 3 1  ON 21
ci_023                 1.133905e-02 3 1  ON 22
ci_024                 1.167423e-02 3 1  ON 23
ci_025                 1.169471e-02 3 1  ON 24
ci_026                 1.108107e-02 3 1  ON 25
ci_027                 1.111613e-02 3 1  ON 26
ci_028                -1.480908e-02 3 1  ON 27
ci_029                -1.447336e-02 3 1  ON 28
ci_030                -1.108910e-02 3 1  ON 29
ci_031                -1.073436e-02 3 1  ON 30
ci_032                -1.344999e-02 3 1  ON 31
ci_033                 1.051968e-02 3 1  ON 32
ci_034                 1.003389e-02 3 1  ON 33
ci_035                -4.472138e-03 3 1  ON 34
ci_036                -1.048574e-02 3 1  ON 35
ci_037                -1.024852e-02 3 1  ON 36
ci_038                 1.684335e-03 3 1  ON 37
ci_039                 1.674549e-03 3 1  ON 38
ci_040                -3.910673e-03 3 1  ON 39
ci_041                 1.002278e-02 3 1  ON 40
ci_042                 1.005007e-02 3 1  ON 41
ci_043                -3.058822e-03 3 1  ON 42
ci_044                -1.544430e-02 3 1  ON 43
ci_045                -1.594610e-03 3 1  ON 44
ci_046                 5.176672e-03 3 1  ON 45
ci_047                 5.933582e-03 3 1  ON 46
ci_048                -1.202612e-02 3 1  ON 47
ci_049                -1.158117e-02 3 1  ON 48
ci_050                 7.638347e-03 3 1  ON 49
ci_051                 7.692760e-03 3 1  ON 50
ci_052                -6.492786e-03 3 1  ON 51
ci_053                -6.440478e-03 3 1  ON 52
ci_054                -2.667072e-03 3 1  ON 53
ci_055                -3.136807e-03 3 1  ON 54
ci_056                 4.248969e-03 3 1  ON 55
ci_057                 4.548902e-03 3 1  ON 56
ci_058                -6.595827e-03 3 1  ON 57
ci_059                -6.705570e-03 3 1  ON 58
ci_060                 8.648802e-03 3 1  ON 59
ci_061                 8.848964e-03 3 1  ON 60
ci_062                -3.420274e-03 3 1  ON 61
ci_063                -2.804704e-03 3 1  ON 62
ci_064                -3.056639e-03 3 1  ON 63
ci_065                -3.984437e-03 3 1  ON 64
ci_066                 5.427817e-03 3 1  ON 65
ci_067                 5.528036e-03 3 1  ON 66
ci_068                -4.744496e-03 3 1  ON 67
ci_069                -5.243346e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.169
    reference variance = 0.196727
====================================================
  Execution time = 2.6660e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1678e-01
  Total weights = 3.9133e+06
  Execution time = 3.6329e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301695657428
                                         uncertainty =       0.002438152703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301695657428
                                         uncertainty =       0.002438152703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274629243
  error estimate for blocks of size 2^( 2) =       0.000281586617
  error estimate for blocks of size 2^( 3) =       0.000288041447
  error estimate for blocks of size 2^( 4) =       0.000292939487
  error estimate for blocks of size 2^( 5) =       0.000296084099
  error estimate for blocks of size 2^( 6) =       0.000297685573
  error estimate for blocks of size 2^( 7) =       0.000297643590
  error estimate for blocks of size 2^( 8) =       0.000297505344

      target function =                  N/A
              le_mean =     -17.216390525182
             les_mean =     296.726296588557
             stat err =       0.000297229651
             autocorr =       1.171360849724
              std dev =       0.549258486130
             le_variance =       0.301684884586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301632002032
                                         uncertainty =       0.002449154268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301632002032
                                         uncertainty =       0.002449154268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274600496
  error estimate for blocks of size 2^( 2) =       0.000281555923
  error estimate for blocks of size 2^( 3) =       0.000288007964
  error estimate for blocks of size 2^( 4) =       0.000292899915
  error estimate for blocks of size 2^( 5) =       0.000296039567
  error estimate for blocks of size 2^( 6) =       0.000297636676
  error estimate for blocks of size 2^( 7) =       0.000297589575
  error estimate for blocks of size 2^( 8) =       0.000297474084

      target function =                  N/A
              le_mean =     -17.216388270708
             les_mean =     296.722618353363
             stat err =       0.000297184975
             autocorr =       1.171253934780
              std dev =       0.549200992372
             le_variance =       0.301621730022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301617091071
                                         uncertainty =       0.002447016576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301617091071
                                         uncertainty =       0.002447016576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274593670
  error estimate for blocks of size 2^( 2) =       0.000281550070
  error estimate for blocks of size 2^( 3) =       0.000288002810
  error estimate for blocks of size 2^( 4) =       0.000292895924
  error estimate for blocks of size 2^( 5) =       0.000296037146
  error estimate for blocks of size 2^( 6) =       0.000297635306
  error estimate for blocks of size 2^( 7) =       0.000297585783
  error estimate for blocks of size 2^( 8) =       0.000297464800

      target function =                  N/A
              le_mean =     -17.216387212155
             les_mean =     296.722642739814
             stat err =       0.000297180758
             autocorr =       1.171278929692
              std dev =       0.549187339728
             le_variance =       0.301606734118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301672473545
                                         uncertainty =       0.002439866114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301672473545
                                         uncertainty =       0.002439866114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274618725
  error estimate for blocks of size 2^( 2) =       0.000281575958
  error estimate for blocks of size 2^( 3) =       0.000288029991
  error estimate for blocks of size 2^( 4) =       0.000292927063
  error estimate for blocks of size 2^( 5) =       0.000296072905
  error estimate for blocks of size 2^( 6) =       0.000297673182
  error estimate for blocks of size 2^( 7) =       0.000297627617
  error estimate for blocks of size 2^( 8) =       0.000297492546

      target function =                  N/A
              le_mean =     -17.216388358110
             les_mean =     296.723231705225
             stat err =       0.000297216562
             autocorr =       1.171347409077
              std dev =       0.549237449618
             le_variance =       0.301661776062


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216390525182        initial  <--
     2.5000e-01     2.5000e+00             5.5384e-04       -17.216388270708
     1.0000e+00     1.0000e+01             2.0197e-04       -17.216387212155
     4.0000e+00     4.0000e+01             5.8723e-05       -17.216388358110

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0297
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -4.017943e-02 3 1  ON 0
ci_002                -2.956205e-02 3 1  ON 1
ci_003                -2.503498e-02 3 1  ON 2
ci_004                 2.084582e-02 3 1  ON 3
ci_005                 2.137907e-02 3 1  ON 4
ci_006                -1.908355e-02 3 1  ON 5
ci_007                -1.871167e-02 3 1  ON 6
ci_008                -1.781916e-02 3 1  ON 7
ci_009                -1.752550e-02 3 1  ON 8
ci_010                -1.710037e-02 3 1  ON 9
ci_011                -1.647147e-02 3 1  ON 10
ci_012                -1.643804e-02 3 1  ON 11
ci_013                -1.900305e-02 3 1  ON 12
ci_014                 1.330071e-02 3 1  ON 13
ci_015                 1.337848e-02 3 1  ON 14
ci_016                 1.619527e-02 3 1  ON 15
ci_017                 1.699423e-02 3 1  ON 16
ci_018                 1.259827e-02 3 1  ON 17
ci_019                 1.234158e-02 3 1  ON 18
ci_020                 1.301423e-02 3 1  ON 19
ci_021                 1.311798e-02 3 1  ON 20
ci_022                 1.182176e-02 3 1  ON 21
ci_023                 1.137030e-02 3 1  ON 22
ci_024                 1.162931e-02 3 1  ON 23
ci_025                 1.169715e-02 3 1  ON 24
ci_026                 1.118704e-02 3 1  ON 25
ci_027                 1.113147e-02 3 1  ON 26
ci_028                -1.499759e-02 3 1  ON 27
ci_029                -1.427140e-02 3 1  ON 28
ci_030                -1.106468e-02 3 1  ON 29
ci_031                -1.072553e-02 3 1  ON 30
ci_032                -1.332136e-02 3 1  ON 31
ci_033                 1.037661e-02 3 1  ON 32
ci_034                 9.919791e-03 3 1  ON 33
ci_035                -4.574121e-03 3 1  ON 34
ci_036                -1.055246e-02 3 1  ON 35
ci_037                -1.030320e-02 3 1  ON 36
ci_038                 1.556158e-03 3 1  ON 37
ci_039                 1.720876e-03 3 1  ON 38
ci_040                -3.971396e-03 3 1  ON 39
ci_041                 9.966444e-03 3 1  ON 40
ci_042                 1.013896e-02 3 1  ON 41
ci_043                -3.026755e-03 3 1  ON 42
ci_044                -1.549572e-02 3 1  ON 43
ci_045                -1.489097e-03 3 1  ON 44
ci_046                 5.171589e-03 3 1  ON 45
ci_047                 5.881308e-03 3 1  ON 46
ci_048                -1.204082e-02 3 1  ON 47
ci_049                -1.156388e-02 3 1  ON 48
ci_050                 7.699182e-03 3 1  ON 49
ci_051                 7.795103e-03 3 1  ON 50
ci_052                -6.547928e-03 3 1  ON 51
ci_053                -6.521574e-03 3 1  ON 52
ci_054                -2.538307e-03 3 1  ON 53
ci_055                -3.031249e-03 3 1  ON 54
ci_056                 4.324634e-03 3 1  ON 55
ci_057                 4.606118e-03 3 1  ON 56
ci_058                -6.477753e-03 3 1  ON 57
ci_059                -6.863096e-03 3 1  ON 58
ci_060                 8.825557e-03 3 1  ON 59
ci_061                 8.958646e-03 3 1  ON 60
ci_062                -3.475577e-03 3 1  ON 61
ci_063                -2.685695e-03 3 1  ON 62
ci_064                -3.053655e-03 3 1  ON 63
ci_065                -3.808335e-03 3 1  ON 64
ci_066                 5.256467e-03 3 1  ON 65
ci_067                 5.534561e-03 3 1  ON 66
ci_068                -4.603972e-03 3 1  ON 67
ci_069                -5.322860e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6922e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7192e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2191
    reference variance = 0.258747
====================================================
  Execution time = 2.7073e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0578e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1264e-01
  Total weights = 3.913240072e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9286e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298714037584
                                         uncertainty =       0.001399522381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298714037584
                                         uncertainty =       0.001399522381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273260221
  error estimate for blocks of size 2^( 2) =       0.000280349500
  error estimate for blocks of size 2^( 3) =       0.000286875015
  error estimate for blocks of size 2^( 4) =       0.000291573859
  error estimate for blocks of size 2^( 5) =       0.000294277866
  error estimate for blocks of size 2^( 6) =       0.000296501500
  error estimate for blocks of size 2^( 7) =       0.000297905184
  error estimate for blocks of size 2^( 8) =       0.000299189586

      target function =                  N/A
              le_mean =     -17.216438618488
             les_mean =     296.718396245696
             stat err =       0.000296968534
             autocorr =       1.181049335993
              std dev =       0.546520441371
             le_variance =       0.298684592836


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721643861849e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216438618510       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216440463298       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216440410598       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216440399326       residual = 2.23e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 1.121269e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216438618510       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216439113321       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216439103170       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216439100074       residual = 2.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 3.003584e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216438618510       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216438744509       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216438742205       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216438741425       residual = 2.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 7.645605e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.312194 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2011e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -4.017643e-02 3 1  ON 0
ci_002                -2.957210e-02 3 1  ON 1
ci_003                -2.504720e-02 3 1  ON 2
ci_004                 2.085558e-02 3 1  ON 3
ci_005                 2.138505e-02 3 1  ON 4
ci_006                -1.908459e-02 3 1  ON 5
ci_007                -1.872095e-02 3 1  ON 6
ci_008                -1.781808e-02 3 1  ON 7
ci_009                -1.752236e-02 3 1  ON 8
ci_010                -1.709876e-02 3 1  ON 9
ci_011                -1.646591e-02 3 1  ON 10
ci_012                -1.642759e-02 3 1  ON 11
ci_013                -1.900972e-02 3 1  ON 12
ci_014                 1.331161e-02 3 1  ON 13
ci_015                 1.338326e-02 3 1  ON 14
ci_016                 1.622072e-02 3 1  ON 15
ci_017                 1.698725e-02 3 1  ON 16
ci_018                 1.260586e-02 3 1  ON 17
ci_019                 1.236198e-02 3 1  ON 18
ci_020                 1.301443e-02 3 1  ON 19
ci_021                 1.312012e-02 3 1  ON 20
ci_022                 1.179940e-02 3 1  ON 21
ci_023                 1.136543e-02 3 1  ON 22
ci_024                 1.163450e-02 3 1  ON 23
ci_025                 1.169200e-02 3 1  ON 24
ci_026                 1.118547e-02 3 1  ON 25
ci_027                 1.111968e-02 3 1  ON 26
ci_028                -1.498881e-02 3 1  ON 27
ci_029                -1.427023e-02 3 1  ON 28
ci_030                -1.106890e-02 3 1  ON 29
ci_031                -1.073330e-02 3 1  ON 30
ci_032                -1.334069e-02 3 1  ON 31
ci_033                 1.036716e-02 3 1  ON 32
ci_034                 9.921495e-03 3 1  ON 33
ci_035                -4.587028e-03 3 1  ON 34
ci_036                -1.055359e-02 3 1  ON 35
ci_037                -1.028927e-02 3 1  ON 36
ci_038                 1.558762e-03 3 1  ON 37
ci_039                 1.723007e-03 3 1  ON 38
ci_040                -3.973645e-03 3 1  ON 39
ci_041                 9.958577e-03 3 1  ON 40
ci_042                 1.012664e-02 3 1  ON 41
ci_043                -3.019579e-03 3 1  ON 42
ci_044                -1.549966e-02 3 1  ON 43
ci_045                -1.493559e-03 3 1  ON 44
ci_046                 5.179189e-03 3 1  ON 45
ci_047                 5.870111e-03 3 1  ON 46
ci_048                -1.204458e-02 3 1  ON 47
ci_049                -1.158080e-02 3 1  ON 48
ci_050                 7.697535e-03 3 1  ON 49
ci_051                 7.788065e-03 3 1  ON 50
ci_052                -6.545651e-03 3 1  ON 51
ci_053                -6.508185e-03 3 1  ON 52
ci_054                -2.542613e-03 3 1  ON 53
ci_055                -3.033569e-03 3 1  ON 54
ci_056                 4.333160e-03 3 1  ON 55
ci_057                 4.600332e-03 3 1  ON 56
ci_058                -6.475600e-03 3 1  ON 57
ci_059                -6.841258e-03 3 1  ON 58
ci_060                 8.795522e-03 3 1  ON 59
ci_061                 8.940357e-03 3 1  ON 60
ci_062                -3.464616e-03 3 1  ON 61
ci_063                -2.695965e-03 3 1  ON 62
ci_064                -3.055964e-03 3 1  ON 63
ci_065                -3.818440e-03 3 1  ON 64
ci_066                 5.275172e-03 3 1  ON 65
ci_067                 5.535071e-03 3 1  ON 66
ci_068                -4.613320e-03 3 1  ON 67
ci_069                -5.315857e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2187
    reference variance = 0.147603
====================================================
  Execution time = 2.6810e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1619e-01
  Total weights = 3.9128e+06
  Execution time = 3.6405e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300752539023
                                         uncertainty =       0.001469858119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300752539023
                                         uncertainty =       0.001469858119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274173771
  error estimate for blocks of size 2^( 2) =       0.000281230208
  error estimate for blocks of size 2^( 3) =       0.000287656081
  error estimate for blocks of size 2^( 4) =       0.000292214180
  error estimate for blocks of size 2^( 5) =       0.000294609128
  error estimate for blocks of size 2^( 6) =       0.000296235679
  error estimate for blocks of size 2^( 7) =       0.000296493747
  error estimate for blocks of size 2^( 8) =       0.000297086161

      target function =                  N/A
              le_mean =     -17.216781871138
             les_mean =     296.733782950814
             stat err =       0.000296106179
             autocorr =       1.166388234766
              std dev =       0.548347541298
             le_variance =       0.300685026048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300701435168
                                         uncertainty =       0.001468471407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300701435168
                                         uncertainty =       0.001468471407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274150491
  error estimate for blocks of size 2^( 2) =       0.000281206944
  error estimate for blocks of size 2^( 3) =       0.000287632790
  error estimate for blocks of size 2^( 4) =       0.000292190556
  error estimate for blocks of size 2^( 5) =       0.000294584025
  error estimate for blocks of size 2^( 6) =       0.000296211628
  error estimate for blocks of size 2^( 7) =       0.000296473163
  error estimate for blocks of size 2^( 8) =       0.000297064311

      target function =                  N/A
              le_mean =     -17.216782451861
             les_mean =     296.733772868587
             stat err =       0.000296083282
             autocorr =       1.166405916531
              std dev =       0.548300982931
             le_variance =       0.300633967883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300724425037
                                         uncertainty =       0.001469120063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300724425037
                                         uncertainty =       0.001469120063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274160964
  error estimate for blocks of size 2^( 2) =       0.000281217406
  error estimate for blocks of size 2^( 3) =       0.000287643264
  error estimate for blocks of size 2^( 4) =       0.000292201188
  error estimate for blocks of size 2^( 5) =       0.000294595336
  error estimate for blocks of size 2^( 6) =       0.000296222424
  error estimate for blocks of size 2^( 7) =       0.000296482367
  error estimate for blocks of size 2^( 8) =       0.000297074072

      target function =                  N/A
              le_mean =     -17.216782110431
             les_mean =     296.733765064650
             stat err =       0.000296093550
             autocorr =       1.166397703314
              std dev =       0.548321928065
             le_variance =       0.300656936797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300748883033
                                         uncertainty =       0.001469763505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300748883033
                                         uncertainty =       0.001469763505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274172105
  error estimate for blocks of size 2^( 2) =       0.000281228543
  error estimate for blocks of size 2^( 3) =       0.000287654414
  error estimate for blocks of size 2^( 4) =       0.000292212491
  error estimate for blocks of size 2^( 5) =       0.000294607337
  error estimate for blocks of size 2^( 6) =       0.000296233955
  error estimate for blocks of size 2^( 7) =       0.000296492263
  error estimate for blocks of size 2^( 8) =       0.000297084586

      target function =                  N/A
              le_mean =     -17.216781892977
             les_mean =     296.733779141376
             stat err =       0.000296104535
             autocorr =       1.166389457142
              std dev =       0.548344210538
             le_variance =       0.300681373231


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216781871138        initial
     2.5000e+00     2.5000e+01             1.1213e-04       -17.216782451861  <--
     1.0000e+01     1.0000e+02             3.0036e-05       -17.216782110431
     4.0000e+01     4.0000e+02             7.6456e-06       -17.216781892977

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 4.7714e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -4.016740e-02 3 1  ON 0
ci_002                -2.959955e-02 3 1  ON 1
ci_003                -2.508116e-02 3 1  ON 2
ci_004                 2.088289e-02 3 1  ON 3
ci_005                 2.140161e-02 3 1  ON 4
ci_006                -1.908700e-02 3 1  ON 5
ci_007                -1.874633e-02 3 1  ON 6
ci_008                -1.781508e-02 3 1  ON 7
ci_009                -1.751350e-02 3 1  ON 8
ci_010                -1.709447e-02 3 1  ON 9
ci_011                -1.645095e-02 3 1  ON 10
ci_012                -1.639873e-02 3 1  ON 11
ci_013                -1.902832e-02 3 1  ON 12
ci_014                 1.334187e-02 3 1  ON 13
ci_015                 1.339632e-02 3 1  ON 14
ci_016                 1.629123e-02 3 1  ON 15
ci_017                 1.696787e-02 3 1  ON 16
ci_018                 1.262685e-02 3 1  ON 17
ci_019                 1.241759e-02 3 1  ON 18
ci_020                 1.301479e-02 3 1  ON 19
ci_021                 1.312593e-02 3 1  ON 20
ci_022                 1.173878e-02 3 1  ON 21
ci_023                 1.135233e-02 3 1  ON 22
ci_024                 1.164907e-02 3 1  ON 23
ci_025                 1.167724e-02 3 1  ON 24
ci_026                 1.118100e-02 3 1  ON 25
ci_027                 1.108682e-02 3 1  ON 26
ci_028                -1.496433e-02 3 1  ON 27
ci_029                -1.426650e-02 3 1  ON 28
ci_030                -1.108057e-02 3 1  ON 29
ci_031                -1.075482e-02 3 1  ON 30
ci_032                -1.339285e-02 3 1  ON 31
ci_033                 1.034087e-02 3 1  ON 32
ci_034                 9.925934e-03 3 1  ON 33
ci_035                -4.620477e-03 3 1  ON 34
ci_036                -1.055667e-02 3 1  ON 35
ci_037                -1.025084e-02 3 1  ON 36
ci_038                 1.565490e-03 3 1  ON 37
ci_039                 1.728433e-03 3 1  ON 38
ci_040                -3.979394e-03 3 1  ON 39
ci_041                 9.936943e-03 3 1  ON 40
ci_042                 1.009266e-02 3 1  ON 41
ci_043                -3.000665e-03 3 1  ON 42
ci_044                -1.551054e-02 3 1  ON 43
ci_045                -1.504986e-03 3 1  ON 44
ci_046                 5.199901e-03 3 1  ON 45
ci_047                 5.839757e-03 3 1  ON 46
ci_048                -1.205513e-02 3 1  ON 47
ci_049                -1.162812e-02 3 1  ON 48
ci_050                 7.693301e-03 3 1  ON 49
ci_051                 7.769608e-03 3 1  ON 50
ci_052                -6.539605e-03 3 1  ON 51
ci_053                -6.472657e-03 3 1  ON 52
ci_054                -2.554129e-03 3 1  ON 53
ci_055                -3.039915e-03 3 1  ON 54
ci_056                 4.355754e-03 3 1  ON 55
ci_057                 4.585046e-03 3 1  ON 56
ci_058                -6.469818e-03 3 1  ON 57
ci_059                -6.782732e-03 3 1  ON 58
ci_060                 8.713431e-03 3 1  ON 59
ci_061                 8.890529e-03 3 1  ON 60
ci_062                -3.435066e-03 3 1  ON 61
ci_063                -2.723690e-03 3 1  ON 62
ci_064                -3.061673e-03 3 1  ON 63
ci_065                -3.843877e-03 3 1  ON 64
ci_066                 5.324445e-03 3 1  ON 65
ci_067                 5.536405e-03 3 1  ON 66
ci_068                -4.638930e-03 3 1  ON 67
ci_069                -5.296696e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9754e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.203
    reference variance = 0.280474
====================================================
  Execution time = 2.7430e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0571e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1312e-01
  Total weights = 3.913174713e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.0245e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298825538069
                                         uncertainty =       0.001637084192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298825538069
                                         uncertainty =       0.001637084192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273303575
  error estimate for blocks of size 2^( 2) =       0.000280432382
  error estimate for blocks of size 2^( 3) =       0.000286780311
  error estimate for blocks of size 2^( 4) =       0.000291623540
  error estimate for blocks of size 2^( 5) =       0.000294923137
  error estimate for blocks of size 2^( 6) =       0.000296288033
  error estimate for blocks of size 2^( 7) =       0.000296880406
  error estimate for blocks of size 2^( 8) =       0.000296513992

      target function =                  N/A
              le_mean =     -17.216725960044
             les_mean =     296.728775710052
             stat err =       0.000296151392
             autocorr =       1.174186086985
              std dev =       0.546607150524
             le_variance =       0.298779377004


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721672596004e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216725960064       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216728905664       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216729026028       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216729006808       residual = 1.89e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 2.610559e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216725960064       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216726902931       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216726945159       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 8.181201e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216725960064       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216726213548       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216726225290       residual = 7.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 2.247424e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.313422 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2462e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -4.018684e-02 3 1  ON 0
ci_002                -2.965543e-02 3 1  ON 1
ci_003                -2.512758e-02 3 1  ON 2
ci_004                 2.085179e-02 3 1  ON 3
ci_005                 2.141191e-02 3 1  ON 4
ci_006                -1.906667e-02 3 1  ON 5
ci_007                -1.875249e-02 3 1  ON 6
ci_008                -1.780978e-02 3 1  ON 7
ci_009                -1.752079e-02 3 1  ON 8
ci_010                -1.708551e-02 3 1  ON 9
ci_011                -1.647082e-02 3 1  ON 10
ci_012                -1.633502e-02 3 1  ON 11
ci_013                -1.907173e-02 3 1  ON 12
ci_014                 1.339041e-02 3 1  ON 13
ci_015                 1.337519e-02 3 1  ON 14
ci_016                 1.627495e-02 3 1  ON 15
ci_017                 1.694335e-02 3 1  ON 16
ci_018                 1.262040e-02 3 1  ON 17
ci_019                 1.243000e-02 3 1  ON 18
ci_020                 1.307549e-02 3 1  ON 19
ci_021                 1.312989e-02 3 1  ON 20
ci_022                 1.170486e-02 3 1  ON 21
ci_023                 1.132544e-02 3 1  ON 22
ci_024                 1.168865e-02 3 1  ON 23
ci_025                 1.170316e-02 3 1  ON 24
ci_026                 1.116272e-02 3 1  ON 25
ci_027                 1.116816e-02 3 1  ON 26
ci_028                -1.495349e-02 3 1  ON 27
ci_029                -1.428458e-02 3 1  ON 28
ci_030                -1.105163e-02 3 1  ON 29
ci_031                -1.077350e-02 3 1  ON 30
ci_032                -1.332608e-02 3 1  ON 31
ci_033                 1.037124e-02 3 1  ON 32
ci_034                 9.963394e-03 3 1  ON 33
ci_035                -4.624684e-03 3 1  ON 34
ci_036                -1.053113e-02 3 1  ON 35
ci_037                -1.030280e-02 3 1  ON 36
ci_038                 1.588220e-03 3 1  ON 37
ci_039                 1.721147e-03 3 1  ON 38
ci_040                -3.937819e-03 3 1  ON 39
ci_041                 9.964469e-03 3 1  ON 40
ci_042                 1.012131e-02 3 1  ON 41
ci_043                -3.006313e-03 3 1  ON 42
ci_044                -1.547060e-02 3 1  ON 43
ci_045                -1.512879e-03 3 1  ON 44
ci_046                 5.273386e-03 3 1  ON 45
ci_047                 5.787823e-03 3 1  ON 46
ci_048                -1.203442e-02 3 1  ON 47
ci_049                -1.162135e-02 3 1  ON 48
ci_050                 7.679556e-03 3 1  ON 49
ci_051                 7.687796e-03 3 1  ON 50
ci_052                -6.538916e-03 3 1  ON 51
ci_053                -6.501450e-03 3 1  ON 52
ci_054                -2.569002e-03 3 1  ON 53
ci_055                -3.037342e-03 3 1  ON 54
ci_056                 4.382713e-03 3 1  ON 55
ci_057                 4.587669e-03 3 1  ON 56
ci_058                -6.483522e-03 3 1  ON 57
ci_059                -6.795153e-03 3 1  ON 58
ci_060                 8.700882e-03 3 1  ON 59
ci_061                 8.851499e-03 3 1  ON 60
ci_062                -3.391735e-03 3 1  ON 61
ci_063                -2.776555e-03 3 1  ON 62
ci_064                -3.102754e-03 3 1  ON 63
ci_065                -3.886870e-03 3 1  ON 64
ci_066                 5.396441e-03 3 1  ON 65
ci_067                 5.546203e-03 3 1  ON 66
ci_068                -4.699009e-03 3 1  ON 67
ci_069                -5.344699e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1918
    reference variance = 0.316552
====================================================
  Execution time = 2.6624e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1557e-01
  Total weights = 3.9133e+06
  Execution time = 3.6380e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300169609604
                                         uncertainty =       0.001533223049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300169609604
                                         uncertainty =       0.001533223049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273944439
  error estimate for blocks of size 2^( 2) =       0.000280878319
  error estimate for blocks of size 2^( 3) =       0.000287240153
  error estimate for blocks of size 2^( 4) =       0.000291894919
  error estimate for blocks of size 2^( 5) =       0.000294897595
  error estimate for blocks of size 2^( 6) =       0.000296187293
  error estimate for blocks of size 2^( 7) =       0.000296259276
  error estimate for blocks of size 2^( 8) =       0.000296690548

      target function =                  N/A
              le_mean =     -17.216501827642
             les_mean =     296.723980977666
             stat err =       0.000296008678
             autocorr =       1.167572639013
              std dev =       0.547888878165
             le_variance =       0.300182222817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300124051486
                                         uncertainty =       0.001537013511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300124051486
                                         uncertainty =       0.001537013511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273923805
  error estimate for blocks of size 2^( 2) =       0.000280856633
  error estimate for blocks of size 2^( 3) =       0.000287216557
  error estimate for blocks of size 2^( 4) =       0.000291866068
  error estimate for blocks of size 2^( 5) =       0.000294867465
  error estimate for blocks of size 2^( 6) =       0.000296155718
  error estimate for blocks of size 2^( 7) =       0.000296224560
  error estimate for blocks of size 2^( 8) =       0.000296659495

      target function =                  N/A
              le_mean =     -17.216502974303
             les_mean =     296.747303821368
             stat err =       0.000295976809
             autocorr =       1.167497119418
              std dev =       0.547847609483
             le_variance =       0.300137003217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300130934483
                                         uncertainty =       0.001535411570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300130934483
                                         uncertainty =       0.001535411570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273926896
  error estimate for blocks of size 2^( 2) =       0.000280860146
  error estimate for blocks of size 2^( 3) =       0.000287221020
  error estimate for blocks of size 2^( 4) =       0.000291872798
  error estimate for blocks of size 2^( 5) =       0.000294876513
  error estimate for blocks of size 2^( 6) =       0.000296166041
  error estimate for blocks of size 2^( 7) =       0.000296238283
  error estimate for blocks of size 2^( 8) =       0.000296674730

      target function =                  N/A
              le_mean =     -17.216501359578
             les_mean =     296.724005494397
             stat err =       0.000295988892
             autocorr =       1.167566090152
              std dev =       0.547853791487
             le_variance =       0.300143776847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300163398689
                                         uncertainty =       0.001533501156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300163398689
                                         uncertainty =       0.001533501156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273941619
  error estimate for blocks of size 2^( 2) =       0.000280875443
  error estimate for blocks of size 2^( 3) =       0.000287237119
  error estimate for blocks of size 2^( 4) =       0.000291891415
  error estimate for blocks of size 2^( 5) =       0.000294894237
  error estimate for blocks of size 2^( 6) =       0.000296183944
  error estimate for blocks of size 2^( 7) =       0.000296256211
  error estimate for blocks of size 2^( 8) =       0.000296687989

      target function =                  N/A
              le_mean =     -17.216501553298
             les_mean =     296.723563843975
             stat err =       0.000296005596
             autocorr =       1.167572357539
              std dev =       0.547883238551
             le_variance =       0.300176043086


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216501827642        initial
     6.2500e-01     6.2500e+00             2.6106e-04       -17.216502974303  <--
     2.5000e+00     2.5000e+01             8.1812e-05       -17.216501359578
     1.0000e+01     1.0000e+02             2.2474e-05       -17.216501553298

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 4.4999e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -4.023933e-02 3 1  ON 0
ci_002                -2.977721e-02 3 1  ON 1
ci_003                -2.523623e-02 3 1  ON 2
ci_004                 2.077889e-02 3 1  ON 3
ci_005                 2.143538e-02 3 1  ON 4
ci_006                -1.901910e-02 3 1  ON 5
ci_007                -1.876656e-02 3 1  ON 6
ci_008                -1.779882e-02 3 1  ON 7
ci_009                -1.753656e-02 3 1  ON 8
ci_010                -1.706407e-02 3 1  ON 9
ci_011                -1.651792e-02 3 1  ON 10
ci_012                -1.619452e-02 3 1  ON 11
ci_013                -1.917598e-02 3 1  ON 12
ci_014                 1.349305e-02 3 1  ON 13
ci_015                 1.332570e-02 3 1  ON 14
ci_016                 1.623469e-02 3 1  ON 15
ci_017                 1.688925e-02 3 1  ON 16
ci_018                 1.260679e-02 3 1  ON 17
ci_019                 1.245546e-02 3 1  ON 18
ci_020                 1.321374e-02 3 1  ON 19
ci_021                 1.313761e-02 3 1  ON 20
ci_022                 1.163091e-02 3 1  ON 21
ci_023                 1.126728e-02 3 1  ON 22
ci_024                 1.178680e-02 3 1  ON 23
ci_025                 1.176376e-02 3 1  ON 24
ci_026                 1.112285e-02 3 1  ON 25
ci_027                 1.134787e-02 3 1  ON 26
ci_028                -1.492591e-02 3 1  ON 27
ci_029                -1.432732e-02 3 1  ON 28
ci_030                -1.098705e-02 3 1  ON 29
ci_031                -1.081306e-02 3 1  ON 30
ci_032                -1.318671e-02 3 1  ON 31
ci_033                 1.044013e-02 3 1  ON 32
ci_034                 1.004559e-02 3 1  ON 33
ci_035                -4.631069e-03 3 1  ON 34
ci_036                -1.047527e-02 3 1  ON 35
ci_037                -1.042005e-02 3 1  ON 36
ci_038                 1.630604e-03 3 1  ON 37
ci_039                 1.707303e-03 3 1  ON 38
ci_040                -3.862514e-03 3 1  ON 39
ci_041                 1.002278e-02 3 1  ON 40
ci_042                 1.018246e-02 3 1  ON 41
ci_043                -3.016028e-03 3 1  ON 42
ci_044                -1.537409e-02 3 1  ON 43
ci_045                -1.525960e-03 3 1  ON 44
ci_046                 5.427997e-03 3 1  ON 45
ci_047                 5.678886e-03 3 1  ON 46
ci_048                -1.198199e-02 3 1  ON 47
ci_049                -1.160854e-02 3 1  ON 48
ci_050                 7.653332e-03 3 1  ON 49
ci_051                 7.531292e-03 3 1  ON 50
ci_052                -6.538229e-03 3 1  ON 51
ci_053                -6.559481e-03 3 1  ON 52
ci_054                -2.597864e-03 3 1  ON 53
ci_055                -3.032902e-03 3 1  ON 54
ci_056                 4.436549e-03 3 1  ON 55
ci_057                 4.593117e-03 3 1  ON 56
ci_058                -6.513698e-03 3 1  ON 57
ci_059                -6.819993e-03 3 1  ON 58
ci_060                 8.677336e-03 3 1  ON 59
ci_061                 8.771012e-03 3 1  ON 60
ci_062                -3.303112e-03 3 1  ON 61
ci_063                -2.885259e-03 3 1  ON 62
ci_064                -3.170905e-03 3 1  ON 63
ci_065                -3.958922e-03 3 1  ON 64
ci_066                 5.535260e-03 3 1  ON 65
ci_067                 5.565568e-03 3 1  ON 66
ci_068                -4.831106e-03 3 1  ON 67
ci_069                -5.445729e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7573e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1496
    reference variance = 0.214416
====================================================
  Execution time = 2.7056e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0559e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1580e-01
  Total weights = 3.912729220e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9742e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300107931049
                                         uncertainty =       0.001676377314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300107931049
                                         uncertainty =       0.001676377314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273900533
  error estimate for blocks of size 2^( 2) =       0.000280996361
  error estimate for blocks of size 2^( 3) =       0.000287384318
  error estimate for blocks of size 2^( 4) =       0.000291866656
  error estimate for blocks of size 2^( 5) =       0.000294415981
  error estimate for blocks of size 2^( 6) =       0.000296183118
  error estimate for blocks of size 2^( 7) =       0.000297764441
  error estimate for blocks of size 2^( 8) =       0.000298084568

      target function =                  N/A
              le_mean =     -17.216963822199
             les_mean =     296.739645598132
             stat err =       0.000296612027
             autocorr =       1.172713054026
              std dev =       0.547801065358
             le_variance =       0.300086007207


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721696382220e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216963822218       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216960040449       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216960667893       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216961009728       residual = 2.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 7.071699e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216963822218       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216962063600       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216962189031       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 3.131350e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216963822218       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216963262130       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216963252317       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 9.692067e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.314645 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2039e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -4.021871e-02 3 1  ON 0
ci_002                -2.996688e-02 3 1  ON 1
ci_003                -2.511397e-02 3 1  ON 2
ci_004                 2.087044e-02 3 1  ON 3
ci_005                 2.133351e-02 3 1  ON 4
ci_006                -1.901941e-02 3 1  ON 5
ci_007                -1.861972e-02 3 1  ON 6
ci_008                -1.790651e-02 3 1  ON 7
ci_009                -1.767039e-02 3 1  ON 8
ci_010                -1.702071e-02 3 1  ON 9
ci_011                -1.640294e-02 3 1  ON 10
ci_012                -1.604295e-02 3 1  ON 11
ci_013                -1.927899e-02 3 1  ON 12
ci_014                 1.380618e-02 3 1  ON 13
ci_015                 1.350062e-02 3 1  ON 14
ci_016                 1.619675e-02 3 1  ON 15
ci_017                 1.666610e-02 3 1  ON 16
ci_018                 1.255664e-02 3 1  ON 17
ci_019                 1.260713e-02 3 1  ON 18
ci_020                 1.316289e-02 3 1  ON 19
ci_021                 1.319057e-02 3 1  ON 20
ci_022                 1.145098e-02 3 1  ON 21
ci_023                 1.139794e-02 3 1  ON 22
ci_024                 1.169856e-02 3 1  ON 23
ci_025                 1.157468e-02 3 1  ON 24
ci_026                 1.098894e-02 3 1  ON 25
ci_027                 1.131311e-02 3 1  ON 26
ci_028                -1.481955e-02 3 1  ON 27
ci_029                -1.447075e-02 3 1  ON 28
ci_030                -1.106696e-02 3 1  ON 29
ci_031                -1.088922e-02 3 1  ON 30
ci_032                -1.315720e-02 3 1  ON 31
ci_033                 1.031699e-02 3 1  ON 32
ci_034                 1.016178e-02 3 1  ON 33
ci_035                -4.581811e-03 3 1  ON 34
ci_036                -1.028509e-02 3 1  ON 35
ci_037                -1.044769e-02 3 1  ON 36
ci_038                 1.673648e-03 3 1  ON 37
ci_039                 1.675145e-03 3 1  ON 38
ci_040                -3.878944e-03 3 1  ON 39
ci_041                 9.962346e-03 3 1  ON 40
ci_042                 1.022544e-02 3 1  ON 41
ci_043                -3.121782e-03 3 1  ON 42
ci_044                -1.533902e-02 3 1  ON 43
ci_045                -1.683021e-03 3 1  ON 44
ci_046                 5.505545e-03 3 1  ON 45
ci_047                 5.609600e-03 3 1  ON 46
ci_048                -1.191661e-02 3 1  ON 47
ci_049                -1.166987e-02 3 1  ON 48
ci_050                 7.544477e-03 3 1  ON 49
ci_051                 7.579299e-03 3 1  ON 50
ci_052                -6.593812e-03 3 1  ON 51
ci_053                -6.784766e-03 3 1  ON 52
ci_054                -2.722643e-03 3 1  ON 53
ci_055                -3.004765e-03 3 1  ON 54
ci_056                 4.364064e-03 3 1  ON 55
ci_057                 4.565863e-03 3 1  ON 56
ci_058                -6.491546e-03 3 1  ON 57
ci_059                -6.652438e-03 3 1  ON 58
ci_060                 8.387935e-03 3 1  ON 59
ci_061                 8.602993e-03 3 1  ON 60
ci_062                -3.313870e-03 3 1  ON 61
ci_063                -2.999684e-03 3 1  ON 62
ci_064                -3.002224e-03 3 1  ON 63
ci_065                -4.060810e-03 3 1  ON 64
ci_066                 5.542509e-03 3 1  ON 65
ci_067                 5.644144e-03 3 1  ON 66
ci_068                -4.931054e-03 3 1  ON 67
ci_069                -5.341226e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2087
    reference variance = 0.180266
====================================================
  Execution time = 2.7019e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1741e-01
  Total weights = 3.9136e+06
  Execution time = 3.6290e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303634189055
                                         uncertainty =       0.002071240601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303634189055
                                         uncertainty =       0.002071240601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275501012
  error estimate for blocks of size 2^( 2) =       0.000282561317
  error estimate for blocks of size 2^( 3) =       0.000289107913
  error estimate for blocks of size 2^( 4) =       0.000294021216
  error estimate for blocks of size 2^( 5) =       0.000296746237
  error estimate for blocks of size 2^( 6) =       0.000297867403
  error estimate for blocks of size 2^( 7) =       0.000299404249
  error estimate for blocks of size 2^( 8) =       0.000299385455

      target function =                  N/A
              le_mean =     -17.216836956713
             les_mean =     301.139177907103
             stat err =       0.000298350836
             autocorr =       1.172757240958
              std dev =       0.551002023081
             le_variance =       0.303603229439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303375120390
                                         uncertainty =       0.002105807666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303375120390
                                         uncertainty =       0.002105807666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275384340
  error estimate for blocks of size 2^( 2) =       0.000282449246
  error estimate for blocks of size 2^( 3) =       0.000288994431
  error estimate for blocks of size 2^( 4) =       0.000293895143
  error estimate for blocks of size 2^( 5) =       0.000296626978
  error estimate for blocks of size 2^( 6) =       0.000297740596
  error estimate for blocks of size 2^( 7) =       0.000299404185
  error estimate for blocks of size 2^( 8) =       0.000299321139

      target function =                  N/A
              le_mean =     -17.216855324706
             les_mean =     296.739973000452
             stat err =       0.000298273225
             autocorr =       1.173140579322
              std dev =       0.550768680767
             le_variance =       0.303346139714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303384114714
                                         uncertainty =       0.002105461148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303384114714
                                         uncertainty =       0.002105461148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275388456
  error estimate for blocks of size 2^( 2) =       0.000282452776
  error estimate for blocks of size 2^( 3) =       0.000288997741
  error estimate for blocks of size 2^( 4) =       0.000293897393
  error estimate for blocks of size 2^( 5) =       0.000296629835
  error estimate for blocks of size 2^( 6) =       0.000297742701
  error estimate for blocks of size 2^( 7) =       0.000299401516
  error estimate for blocks of size 2^( 8) =       0.000299320443

      target function =                  N/A
              le_mean =     -17.216854534429
             les_mean =     296.738870569760
             stat err =       0.000298273624
             autocorr =       1.173108656259
              std dev =       0.550776911905
             le_variance =       0.303355206688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303069898400
                                         uncertainty =       0.002002501336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303069898400
                                         uncertainty =       0.002002501336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275245842
  error estimate for blocks of size 2^( 2) =       0.000282312117
  error estimate for blocks of size 2^( 3) =       0.000288862593
  error estimate for blocks of size 2^( 4) =       0.000293766704
  error estimate for blocks of size 2^( 5) =       0.000296499602
  error estimate for blocks of size 2^( 6) =       0.000297608566
  error estimate for blocks of size 2^( 7) =       0.000299252640
  error estimate for blocks of size 2^( 8) =       0.000299188141

      target function =                  N/A
              le_mean =     -17.216848406736
             les_mean =     296.737777706217
             stat err =       0.000298137237
             autocorr =       1.173250941153
              std dev =       0.550491683584
             le_variance =       0.303041093696


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216836956713        initial
     1.5625e-01     1.5625e+00             7.0717e-04       -17.216855324706  <--
     6.2500e-01     6.2500e+00             3.1313e-04       -17.216854534429
     2.5000e+00     2.5000e+01             9.6921e-05       -17.216848406736

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 4.5383e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -4.019229e-02 3 1  ON 0
ci_002                -3.020425e-02 3 1  ON 1
ci_003                -2.491361e-02 3 1  ON 2
ci_004                 2.101275e-02 3 1  ON 3
ci_005                 2.119760e-02 3 1  ON 4
ci_006                -1.902564e-02 3 1  ON 5
ci_007                -1.842738e-02 3 1  ON 6
ci_008                -1.801685e-02 3 1  ON 7
ci_009                -1.781175e-02 3 1  ON 8
ci_010                -1.696775e-02 3 1  ON 9
ci_011                -1.626333e-02 3 1  ON 10
ci_012                -1.584343e-02 3 1  ON 11
ci_013                -1.943164e-02 3 1  ON 12
ci_014                 1.420022e-02 3 1  ON 13
ci_015                 1.372018e-02 3 1  ON 14
ci_016                 1.613697e-02 3 1  ON 15
ci_017                 1.636988e-02 3 1  ON 16
ci_018                 1.250071e-02 3 1  ON 17
ci_019                 1.278429e-02 3 1  ON 18
ci_020                 1.309966e-02 3 1  ON 19
ci_021                 1.326030e-02 3 1  ON 20
ci_022                 1.124818e-02 3 1  ON 21
ci_023                 1.155088e-02 3 1  ON 22
ci_024                 1.156272e-02 3 1  ON 23
ci_025                 1.128912e-02 3 1  ON 24
ci_026                 1.082124e-02 3 1  ON 25
ci_027                 1.126578e-02 3 1  ON 26
ci_028                -1.468265e-02 3 1  ON 27
ci_029                -1.466710e-02 3 1  ON 28
ci_030                -1.117710e-02 3 1  ON 29
ci_031                -1.098643e-02 3 1  ON 30
ci_032                -1.312529e-02 3 1  ON 31
ci_033                 1.015167e-02 3 1  ON 32
ci_034                 1.028786e-02 3 1  ON 33
ci_035                -4.538179e-03 3 1  ON 34
ci_036                -1.003792e-02 3 1  ON 35
ci_037                -1.048757e-02 3 1  ON 36
ci_038                 1.705775e-03 3 1  ON 37
ci_039                 1.645543e-03 3 1  ON 38
ci_040                -3.898383e-03 3 1  ON 39
ci_041                 9.887716e-03 3 1  ON 40
ci_042                 1.027288e-02 3 1  ON 41
ci_043                -3.211622e-03 3 1  ON 42
ci_044                -1.527751e-02 3 1  ON 43
ci_045                -1.816553e-03 3 1  ON 44
ci_046                 5.593380e-03 3 1  ON 45
ci_047                 5.531242e-03 3 1  ON 46
ci_048                -1.182832e-02 3 1  ON 47
ci_049                -1.175498e-02 3 1  ON 48
ci_050                 7.442719e-03 3 1  ON 49
ci_051                 7.621658e-03 3 1  ON 50
ci_052                -6.649700e-03 3 1  ON 51
ci_053                -7.013372e-03 3 1  ON 52
ci_054                -2.850048e-03 3 1  ON 53
ci_055                -2.977799e-03 3 1  ON 54
ci_056                 4.297820e-03 3 1  ON 55
ci_057                 4.541026e-03 3 1  ON 56
ci_058                -6.467261e-03 3 1  ON 57
ci_059                -6.475160e-03 3 1  ON 58
ci_060                 8.047138e-03 3 1  ON 59
ci_061                 8.411241e-03 3 1  ON 60
ci_062                -3.323868e-03 3 1  ON 61
ci_063                -3.116433e-03 3 1  ON 62
ci_064                -2.875774e-03 3 1  ON 63
ci_065                -4.135085e-03 3 1  ON 64
ci_066                 5.548788e-03 3 1  ON 65
ci_067                 5.712850e-03 3 1  ON 66
ci_068                -5.038866e-03 3 1  ON 67
ci_069                -5.209383e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7442e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7196e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2575
    reference variance = 0.547049
====================================================
  Execution time = 2.6986e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0507e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1583e-01
  Total weights = 3.913211266e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9336e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300453842537
                                         uncertainty =       0.001696999765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300453842537
                                         uncertainty =       0.001696999765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274069351
  error estimate for blocks of size 2^( 2) =       0.000281220285
  error estimate for blocks of size 2^( 3) =       0.000287743852
  error estimate for blocks of size 2^( 4) =       0.000292556331
  error estimate for blocks of size 2^( 5) =       0.000295092827
  error estimate for blocks of size 2^( 6) =       0.000296511263
  error estimate for blocks of size 2^( 7) =       0.000297252631
  error estimate for blocks of size 2^( 8) =       0.000297346116

      target function =                  N/A
              le_mean =     -17.216824584149
             les_mean =     296.734879184340
             stat err =       0.000296550709
             autocorr =       1.170784572229
              std dev =       0.548138701846
             le_variance =       0.300456036461


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721682458415e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216824584162       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216841252786       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216840838684       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216841258202       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216841088724       residual = 1.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-02 is 1.171000e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216824584162       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216836596081       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216836174498       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216836345247       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 7.268105e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216824584162       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216830256903       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216830070332       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216830108807       residual = 3.91e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 2.924876e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.316745 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1927e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -4.019433e-02 3 1  ON 0
ci_002                -3.031704e-02 3 1  ON 1
ci_003                -2.530670e-02 3 1  ON 2
ci_004                 2.144338e-02 3 1  ON 3
ci_005                 2.168991e-02 3 1  ON 4
ci_006                -1.912714e-02 3 1  ON 5
ci_007                -1.861207e-02 3 1  ON 6
ci_008                -1.791323e-02 3 1  ON 7
ci_009                -1.758022e-02 3 1  ON 8
ci_010                -1.735928e-02 3 1  ON 9
ci_011                -1.645944e-02 3 1  ON 10
ci_012                -1.582597e-02 3 1  ON 11
ci_013                -1.952775e-02 3 1  ON 12
ci_014                 1.364269e-02 3 1  ON 13
ci_015                 1.326487e-02 3 1  ON 14
ci_016                 1.637544e-02 3 1  ON 15
ci_017                 1.655834e-02 3 1  ON 16
ci_018                 1.258927e-02 3 1  ON 17
ci_019                 1.294169e-02 3 1  ON 18
ci_020                 1.297309e-02 3 1  ON 19
ci_021                 1.306240e-02 3 1  ON 20
ci_022                 1.118375e-02 3 1  ON 21
ci_023                 1.132619e-02 3 1  ON 22
ci_024                 1.139714e-02 3 1  ON 23
ci_025                 1.143972e-02 3 1  ON 24
ci_026                 1.126461e-02 3 1  ON 25
ci_027                 1.128594e-02 3 1  ON 26
ci_028                -1.467042e-02 3 1  ON 27
ci_029                -1.476949e-02 3 1  ON 28
ci_030                -1.129419e-02 3 1  ON 29
ci_031                -1.097702e-02 3 1  ON 30
ci_032                -1.361451e-02 3 1  ON 31
ci_033                 1.009618e-02 3 1  ON 32
ci_034                 1.035073e-02 3 1  ON 33
ci_035                -4.452552e-03 3 1  ON 34
ci_036                -1.021141e-02 3 1  ON 35
ci_037                -1.044627e-02 3 1  ON 36
ci_038                 1.735489e-03 3 1  ON 37
ci_039                 1.791929e-03 3 1  ON 38
ci_040                -4.004792e-03 3 1  ON 39
ci_041                 9.859820e-03 3 1  ON 40
ci_042                 1.019177e-02 3 1  ON 41
ci_043                -2.986572e-03 3 1  ON 42
ci_044                -1.600432e-02 3 1  ON 43
ci_045                -1.826098e-03 3 1  ON 44
ci_046                 5.911021e-03 3 1  ON 45
ci_047                 5.615133e-03 3 1  ON 46
ci_048                -1.196131e-02 3 1  ON 47
ci_049                -1.168651e-02 3 1  ON 48
ci_050                 7.648765e-03 3 1  ON 49
ci_051                 7.354187e-03 3 1  ON 50
ci_052                -6.720842e-03 3 1  ON 51
ci_053                -7.028964e-03 3 1  ON 52
ci_054                -2.770709e-03 3 1  ON 53
ci_055                -3.150502e-03 3 1  ON 54
ci_056                 4.303762e-03 3 1  ON 55
ci_057                 4.307590e-03 3 1  ON 56
ci_058                -6.656096e-03 3 1  ON 57
ci_059                -6.374795e-03 3 1  ON 58
ci_060                 8.186212e-03 3 1  ON 59
ci_061                 8.546776e-03 3 1  ON 60
ci_062                -3.067167e-03 3 1  ON 61
ci_063                -3.275449e-03 3 1  ON 62
ci_064                -3.144242e-03 3 1  ON 63
ci_065                -4.034741e-03 3 1  ON 64
ci_066                 5.797131e-03 3 1  ON 65
ci_067                 6.134862e-03 3 1  ON 66
ci_068                -4.791223e-03 3 1  ON 67
ci_069                -4.725171e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2879
    reference variance = 0.338234
====================================================
  Execution time = 2.6701e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1225e-01
  Total weights = 3.9136e+06
  Execution time = 3.6391e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298140854810
                                         uncertainty =       0.001307654460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298140854810
                                         uncertainty =       0.001307654460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273003599
  error estimate for blocks of size 2^( 2) =       0.000280111396
  error estimate for blocks of size 2^( 3) =       0.000286340029
  error estimate for blocks of size 2^( 4) =       0.000291378991
  error estimate for blocks of size 2^( 5) =       0.000294538794
  error estimate for blocks of size 2^( 6) =       0.000296722034
  error estimate for blocks of size 2^( 7) =       0.000297972430
  error estimate for blocks of size 2^( 8) =       0.000298035357

      target function =                  N/A
              le_mean =     -17.216807998035
             les_mean =     296.736936902758
             stat err =       0.000296817154
             autocorr =       1.182064702698
              std dev =       0.546007197144
             le_variance =       0.298123859333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298366114017
                                         uncertainty =       0.001303723904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298366114017
                                         uncertainty =       0.001303723904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273106911
  error estimate for blocks of size 2^( 2) =       0.000280212017
  error estimate for blocks of size 2^( 3) =       0.000286431277
  error estimate for blocks of size 2^( 4) =       0.000291453564
  error estimate for blocks of size 2^( 5) =       0.000294609215
  error estimate for blocks of size 2^( 6) =       0.000296778844
  error estimate for blocks of size 2^( 7) =       0.000298036892
  error estimate for blocks of size 2^( 8) =       0.000298122790

      target function =                  N/A
              le_mean =     -17.216789411270
             les_mean =     296.730674454177
             stat err =       0.000296886935
             autocorr =       1.181726007722
              std dev =       0.546213821726
             le_variance =       0.298349539045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298526466730
                                         uncertainty =       0.001304473432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298526466730
                                         uncertainty =       0.001304473432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273180303
  error estimate for blocks of size 2^( 2) =       0.000280282308
  error estimate for blocks of size 2^( 3) =       0.000286499114
  error estimate for blocks of size 2^( 4) =       0.000291514554
  error estimate for blocks of size 2^( 5) =       0.000294669708
  error estimate for blocks of size 2^( 6) =       0.000296829864
  error estimate for blocks of size 2^( 7) =       0.000298089957
  error estimate for blocks of size 2^( 8) =       0.000298175118

      target function =                  N/A
              le_mean =     -17.216790735707
             les_mean =     296.732353376532
             stat err =       0.000296941162
             autocorr =       1.181522621450
              std dev =       0.546360606335
             le_variance =       0.298509912154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298147087871
                                         uncertainty =       0.001303454640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298147087871
                                         uncertainty =       0.001303454640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273006499
  error estimate for blocks of size 2^( 2) =       0.000280114873
  error estimate for blocks of size 2^( 3) =       0.000286341776
  error estimate for blocks of size 2^( 4) =       0.000291377625
  error estimate for blocks of size 2^( 5) =       0.000294539215
  error estimate for blocks of size 2^( 6) =       0.000296715058
  error estimate for blocks of size 2^( 7) =       0.000297969689
  error estimate for blocks of size 2^( 8) =       0.000298052091

      target function =                  N/A
              le_mean =     -17.216799092117
             les_mean =     296.760642865713
             stat err =       0.000296819013
             autocorr =       1.182054396416
              std dev =       0.546012997472
             le_variance =       0.298130193408


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216807998035        initial  <--
     3.9062e-02     3.9062e-01             1.1710e-03       -17.216789411270
     1.5625e-01     1.5625e+00             7.2681e-04       -17.216790735707
     6.2500e-01     6.2500e+00             2.9249e-04       -17.216799092117

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0622
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -4.019229e-02 3 1  ON 0
ci_002                -3.020425e-02 3 1  ON 1
ci_003                -2.491361e-02 3 1  ON 2
ci_004                 2.101275e-02 3 1  ON 3
ci_005                 2.119760e-02 3 1  ON 4
ci_006                -1.902564e-02 3 1  ON 5
ci_007                -1.842738e-02 3 1  ON 6
ci_008                -1.801685e-02 3 1  ON 7
ci_009                -1.781175e-02 3 1  ON 8
ci_010                -1.696775e-02 3 1  ON 9
ci_011                -1.626333e-02 3 1  ON 10
ci_012                -1.584343e-02 3 1  ON 11
ci_013                -1.943164e-02 3 1  ON 12
ci_014                 1.420022e-02 3 1  ON 13
ci_015                 1.372018e-02 3 1  ON 14
ci_016                 1.613697e-02 3 1  ON 15
ci_017                 1.636988e-02 3 1  ON 16
ci_018                 1.250071e-02 3 1  ON 17
ci_019                 1.278429e-02 3 1  ON 18
ci_020                 1.309966e-02 3 1  ON 19
ci_021                 1.326030e-02 3 1  ON 20
ci_022                 1.124818e-02 3 1  ON 21
ci_023                 1.155088e-02 3 1  ON 22
ci_024                 1.156272e-02 3 1  ON 23
ci_025                 1.128912e-02 3 1  ON 24
ci_026                 1.082124e-02 3 1  ON 25
ci_027                 1.126578e-02 3 1  ON 26
ci_028                -1.468265e-02 3 1  ON 27
ci_029                -1.466710e-02 3 1  ON 28
ci_030                -1.117710e-02 3 1  ON 29
ci_031                -1.098643e-02 3 1  ON 30
ci_032                -1.312529e-02 3 1  ON 31
ci_033                 1.015167e-02 3 1  ON 32
ci_034                 1.028786e-02 3 1  ON 33
ci_035                -4.538179e-03 3 1  ON 34
ci_036                -1.003792e-02 3 1  ON 35
ci_037                -1.048757e-02 3 1  ON 36
ci_038                 1.705775e-03 3 1  ON 37
ci_039                 1.645543e-03 3 1  ON 38
ci_040                -3.898383e-03 3 1  ON 39
ci_041                 9.887716e-03 3 1  ON 40
ci_042                 1.027288e-02 3 1  ON 41
ci_043                -3.211622e-03 3 1  ON 42
ci_044                -1.527751e-02 3 1  ON 43
ci_045                -1.816553e-03 3 1  ON 44
ci_046                 5.593380e-03 3 1  ON 45
ci_047                 5.531242e-03 3 1  ON 46
ci_048                -1.182832e-02 3 1  ON 47
ci_049                -1.175498e-02 3 1  ON 48
ci_050                 7.442719e-03 3 1  ON 49
ci_051                 7.621658e-03 3 1  ON 50
ci_052                -6.649700e-03 3 1  ON 51
ci_053                -7.013372e-03 3 1  ON 52
ci_054                -2.850048e-03 3 1  ON 53
ci_055                -2.977799e-03 3 1  ON 54
ci_056                 4.297820e-03 3 1  ON 55
ci_057                 4.541026e-03 3 1  ON 56
ci_058                -6.467261e-03 3 1  ON 57
ci_059                -6.475160e-03 3 1  ON 58
ci_060                 8.047138e-03 3 1  ON 59
ci_061                 8.411241e-03 3 1  ON 60
ci_062                -3.323868e-03 3 1  ON 61
ci_063                -3.116433e-03 3 1  ON 62
ci_064                -2.875774e-03 3 1  ON 63
ci_065                -4.135085e-03 3 1  ON 64
ci_066                 5.548788e-03 3 1  ON 65
ci_067                 5.712850e-03 3 1  ON 66
ci_068                -5.038866e-03 3 1  ON 67
ci_069                -5.209383e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7001e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1485
    reference variance = 0.169332
====================================================
  Execution time = 2.7164e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0579e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1502e-01
  Total weights = 3.913896803e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9875e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298632001150
                                         uncertainty =       0.001801631213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298632001150
                                         uncertainty =       0.001801631213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273258390
  error estimate for blocks of size 2^( 2) =       0.000280331472
  error estimate for blocks of size 2^( 3) =       0.000286960588
  error estimate for blocks of size 2^( 4) =       0.000291987220
  error estimate for blocks of size 2^( 5) =       0.000294788050
  error estimate for blocks of size 2^( 6) =       0.000296197887
  error estimate for blocks of size 2^( 7) =       0.000297104302
  error estimate for blocks of size 2^( 8) =       0.000298139518

      target function =                  N/A
              le_mean =     -17.216414916500
             les_mean =     296.719960177982
             stat err =       0.000296557439
             autocorr =       1.177797518815
              std dev =       0.546516780131
             le_variance =       0.298680590964


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721641491650e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216414916516       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216422260392       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216421611615       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216421624013       residual = 5.06e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 3.631831e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216414916516       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216417583766       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216417570040       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.254308e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216414916516       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216415668442       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216415695523       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 3.473644e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.317958 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2160e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -4.022338e-02 3 1  ON 0
ci_002                -3.020943e-02 3 1  ON 1
ci_003                -2.496587e-02 3 1  ON 2
ci_004                 2.102996e-02 3 1  ON 3
ci_005                 2.124891e-02 3 1  ON 4
ci_006                -1.907232e-02 3 1  ON 5
ci_007                -1.841074e-02 3 1  ON 6
ci_008                -1.794825e-02 3 1  ON 7
ci_009                -1.782087e-02 3 1  ON 8
ci_010                -1.696746e-02 3 1  ON 9
ci_011                -1.621175e-02 3 1  ON 10
ci_012                -1.583936e-02 3 1  ON 11
ci_013                -1.944316e-02 3 1  ON 12
ci_014                 1.407479e-02 3 1  ON 13
ci_015                 1.376639e-02 3 1  ON 14
ci_016                 1.614263e-02 3 1  ON 15
ci_017                 1.638482e-02 3 1  ON 16
ci_018                 1.262520e-02 3 1  ON 17
ci_019                 1.276013e-02 3 1  ON 18
ci_020                 1.318385e-02 3 1  ON 19
ci_021                 1.325149e-02 3 1  ON 20
ci_022                 1.121583e-02 3 1  ON 21
ci_023                 1.148204e-02 3 1  ON 22
ci_024                 1.158891e-02 3 1  ON 23
ci_025                 1.136416e-02 3 1  ON 24
ci_026                 1.083095e-02 3 1  ON 25
ci_027                 1.121547e-02 3 1  ON 26
ci_028                -1.463107e-02 3 1  ON 27
ci_029                -1.465876e-02 3 1  ON 28
ci_030                -1.115138e-02 3 1  ON 29
ci_031                -1.093070e-02 3 1  ON 30
ci_032                -1.312050e-02 3 1  ON 31
ci_033                 1.026504e-02 3 1  ON 32
ci_034                 1.023000e-02 3 1  ON 33
ci_035                -4.613132e-03 3 1  ON 34
ci_036                -1.003166e-02 3 1  ON 35
ci_037                -1.050486e-02 3 1  ON 36
ci_038                 1.656075e-03 3 1  ON 37
ci_039                 1.716642e-03 3 1  ON 38
ci_040                -3.981456e-03 3 1  ON 39
ci_041                 9.821265e-03 3 1  ON 40
ci_042                 1.022195e-02 3 1  ON 41
ci_043                -3.243813e-03 3 1  ON 42
ci_044                -1.533022e-02 3 1  ON 43
ci_045                -1.800148e-03 3 1  ON 44
ci_046                 5.491857e-03 3 1  ON 45
ci_047                 5.472973e-03 3 1  ON 46
ci_048                -1.182583e-02 3 1  ON 47
ci_049                -1.176031e-02 3 1  ON 48
ci_050                 7.472360e-03 3 1  ON 49
ci_051                 7.622114e-03 3 1  ON 50
ci_052                -6.573593e-03 3 1  ON 51
ci_053                -6.955678e-03 3 1  ON 52
ci_054                -2.846122e-03 3 1  ON 53
ci_055                -3.029899e-03 3 1  ON 54
ci_056                 4.309699e-03 3 1  ON 55
ci_057                 4.508522e-03 3 1  ON 56
ci_058                -6.397235e-03 3 1  ON 57
ci_059                -6.441343e-03 3 1  ON 58
ci_060                 8.005603e-03 3 1  ON 59
ci_061                 8.368979e-03 3 1  ON 60
ci_062                -3.338467e-03 3 1  ON 61
ci_063                -3.055264e-03 3 1  ON 62
ci_064                -2.985017e-03 3 1  ON 63
ci_065                -4.121377e-03 3 1  ON 64
ci_066                 5.515449e-03 3 1  ON 65
ci_067                 5.811084e-03 3 1  ON 66
ci_068                -5.031042e-03 3 1  ON 67
ci_069                -5.183165e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.231
    reference variance = 0.302457
====================================================
  Execution time = 2.8807e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1555e-01
  Total weights = 3.9138e+06
  Execution time = 3.6366e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300203341762
                                         uncertainty =       0.001563585681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300203341762
                                         uncertainty =       0.001563585681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273963708
  error estimate for blocks of size 2^( 2) =       0.000281090279
  error estimate for blocks of size 2^( 3) =       0.000287368284
  error estimate for blocks of size 2^( 4) =       0.000292008904
  error estimate for blocks of size 2^( 5) =       0.000295035723
  error estimate for blocks of size 2^( 6) =       0.000296141392
  error estimate for blocks of size 2^( 7) =       0.000296836834
  error estimate for blocks of size 2^( 8) =       0.000297051054

      target function =                  N/A
              le_mean =     -17.216913482358
             les_mean =     296.738300818782
             stat err =       0.000296266251
             autocorr =       1.169440940542
              std dev =       0.547927415083
             le_variance =       0.300224452199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300004620258
                                         uncertainty =       0.001565333553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300004620258
                                         uncertainty =       0.001565333553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273873272
  error estimate for blocks of size 2^( 2) =       0.000281004785
  error estimate for blocks of size 2^( 3) =       0.000287288292
  error estimate for blocks of size 2^( 4) =       0.000291931599
  error estimate for blocks of size 2^( 5) =       0.000294958547
  error estimate for blocks of size 2^( 6) =       0.000296058642
  error estimate for blocks of size 2^( 7) =       0.000296749522
  error estimate for blocks of size 2^( 8) =       0.000296960997

      target function =                  N/A
              le_mean =     -17.216914175264
             les_mean =     296.737597135383
             stat err =       0.000296181927
             autocorr =       1.169547348500
              std dev =       0.547746543533
             le_variance =       0.300026275953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300050746796
                                         uncertainty =       0.001564626585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300050746796
                                         uncertainty =       0.001564626585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273894272
  error estimate for blocks of size 2^( 2) =       0.000281024542
  error estimate for blocks of size 2^( 3) =       0.000287307065
  error estimate for blocks of size 2^( 4) =       0.000291949326
  error estimate for blocks of size 2^( 5) =       0.000294975867
  error estimate for blocks of size 2^( 6) =       0.000296076764
  error estimate for blocks of size 2^( 7) =       0.000296768066
  error estimate for blocks of size 2^( 8) =       0.000296981812

      target function =                  N/A
              le_mean =     -17.216913194899
             les_mean =     296.737794212253
             stat err =       0.000296200627
             autocorr =       1.169515675644
              std dev =       0.547788544800
             le_variance =       0.300072289814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300179664953
                                         uncertainty =       0.001563711994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300179664953
                                         uncertainty =       0.001563711994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273952932
  error estimate for blocks of size 2^( 2) =       0.000281079991
  error estimate for blocks of size 2^( 3) =       0.000287358837
  error estimate for blocks of size 2^( 4) =       0.000291999830
  error estimate for blocks of size 2^( 5) =       0.000295026864
  error estimate for blocks of size 2^( 6) =       0.000296132479
  error estimate for blocks of size 2^( 7) =       0.000296828083
  error estimate for blocks of size 2^( 8) =       0.000297043565

      target function =                  N/A
              le_mean =     -17.216913196928
             les_mean =     296.744162188486
             stat err =       0.000296257748
             autocorr =       1.169465802228
              std dev =       0.547905864860
             le_variance =       0.300200836748


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216913482358        initial
     3.9062e-01     3.9062e+00             3.6318e-04       -17.216914175264  <--
     1.5625e+00     1.5625e+01             1.2543e-04       -17.216913194899
     6.2500e+00     6.2500e+01             3.4736e-05       -17.216913196928

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 4.7139e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -4.029120e-02 3 1  ON 0
ci_002                -3.021763e-02 3 1  ON 1
ci_003                -2.507467e-02 3 1  ON 2
ci_004                 2.106347e-02 3 1  ON 3
ci_005                 2.135339e-02 3 1  ON 4
ci_006                -1.916618e-02 3 1  ON 5
ci_007                -1.837770e-02 3 1  ON 6
ci_008                -1.783186e-02 3 1  ON 7
ci_009                -1.783717e-02 3 1  ON 8
ci_010                -1.696337e-02 3 1  ON 9
ci_011                -1.611833e-02 3 1  ON 10
ci_012                -1.583433e-02 3 1  ON 11
ci_013                -1.946774e-02 3 1  ON 12
ci_014                 1.383703e-02 3 1  ON 13
ci_015                 1.384707e-02 3 1  ON 14
ci_016                 1.615455e-02 3 1  ON 15
ci_017                 1.641518e-02 3 1  ON 16
ci_018                 1.285496e-02 3 1  ON 17
ci_019                 1.272104e-02 3 1  ON 18
ci_020                 1.335553e-02 3 1  ON 19
ci_021                 1.323465e-02 3 1  ON 20
ci_022                 1.116255e-02 3 1  ON 21
ci_023                 1.135728e-02 3 1  ON 22
ci_024                 1.164296e-02 3 1  ON 23
ci_025                 1.153024e-02 3 1  ON 24
ci_026                 1.085142e-02 3 1  ON 25
ci_027                 1.112168e-02 3 1  ON 26
ci_028                -1.451919e-02 3 1  ON 27
ci_029                -1.464149e-02 3 1  ON 28
ci_030                -1.110682e-02 3 1  ON 29
ci_031                -1.082333e-02 3 1  ON 30
ci_032                -1.310915e-02 3 1  ON 31
ci_033                 1.048300e-02 3 1  ON 32
ci_034                 1.012294e-02 3 1  ON 33
ci_035                -4.724209e-03 3 1  ON 34
ci_036                -1.002169e-02 3 1  ON 35
ci_037                -1.053996e-02 3 1  ON 36
ci_038                 1.582194e-03 3 1  ON 37
ci_039                 1.821456e-03 3 1  ON 38
ci_040                -4.095582e-03 3 1  ON 39
ci_041                 9.697167e-03 3 1  ON 40
ci_042                 1.012544e-02 3 1  ON 41
ci_043                -3.294465e-03 3 1  ON 42
ci_044                -1.544152e-02 3 1  ON 43
ci_045                -1.771663e-03 3 1  ON 44
ci_046                 5.308924e-03 3 1  ON 45
ci_047                 5.369022e-03 3 1  ON 46
ci_048                -1.181899e-02 3 1  ON 47
ci_049                -1.176970e-02 3 1  ON 48
ci_050                 7.520630e-03 3 1  ON 49
ci_051                 7.623657e-03 3 1  ON 50
ci_052                -6.449616e-03 3 1  ON 51
ci_053                -6.859088e-03 3 1  ON 52
ci_054                -2.842026e-03 3 1  ON 53
ci_055                -3.118850e-03 3 1  ON 54
ci_056                 4.327321e-03 3 1  ON 55
ci_057                 4.456933e-03 3 1  ON 56
ci_058                -6.277122e-03 3 1  ON 57
ci_059                -6.386279e-03 3 1  ON 58
ci_060                 7.933006e-03 3 1  ON 59
ci_061                 8.291650e-03 3 1  ON 60
ci_062                -3.364303e-03 3 1  ON 61
ci_063                -2.947168e-03 3 1  ON 62
ci_064                -3.125320e-03 3 1  ON 63
ci_065                -4.100090e-03 3 1  ON 64
ci_066                 5.462195e-03 3 1  ON 65
ci_067                 5.968468e-03 3 1  ON 66
ci_068                -5.016737e-03 3 1  ON 67
ci_069                -5.137512e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9376e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1991
    reference variance = 0.36246
====================================================
  Execution time = 2.7009e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0534e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1433e-01
  Total weights = 3.913587422e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9784e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299188493103
                                         uncertainty =       0.001620750244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299188493103
                                         uncertainty =       0.001620750244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273501918
  error estimate for blocks of size 2^( 2) =       0.000280443441
  error estimate for blocks of size 2^( 3) =       0.000286726506
  error estimate for blocks of size 2^( 4) =       0.000291136015
  error estimate for blocks of size 2^( 5) =       0.000294155911
  error estimate for blocks of size 2^( 6) =       0.000294490751
  error estimate for blocks of size 2^( 7) =       0.000295004834
  error estimate for blocks of size 2^( 8) =       0.000296945192

      target function =                  N/A
              le_mean =     -17.216983778277
             les_mean =     296.738859534604
             stat err =       0.000295149172
             autocorr =       1.164561385530
              std dev =       0.547003835746
             le_variance =       0.299213196321


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721698377828e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216983778296       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216986753402       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216986464491       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216986476562       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 8.880286e-04

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216983778296       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216985390536       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216985281203       residual = 9.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 4.486224e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216983778296       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216984347517       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216984329411       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.507763e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.319178 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1994e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -4.026978e-02 3 1  ON 0
ci_002                -3.004457e-02 3 1  ON 1
ci_003                -2.515137e-02 3 1  ON 2
ci_004                 2.128050e-02 3 1  ON 3
ci_005                 2.112541e-02 3 1  ON 4
ci_006                -1.905958e-02 3 1  ON 5
ci_007                -1.882633e-02 3 1  ON 6
ci_008                -1.783134e-02 3 1  ON 7
ci_009                -1.804107e-02 3 1  ON 8
ci_010                -1.688806e-02 3 1  ON 9
ci_011                -1.609791e-02 3 1  ON 10
ci_012                -1.586211e-02 3 1  ON 11
ci_013                -1.979130e-02 3 1  ON 12
ci_014                 1.366769e-02 3 1  ON 13
ci_015                 1.368247e-02 3 1  ON 14
ci_016                 1.593782e-02 3 1  ON 15
ci_017                 1.670454e-02 3 1  ON 16
ci_018                 1.276350e-02 3 1  ON 17
ci_019                 1.251797e-02 3 1  ON 18
ci_020                 1.331546e-02 3 1  ON 19
ci_021                 1.317252e-02 3 1  ON 20
ci_022                 1.135868e-02 3 1  ON 21
ci_023                 1.117071e-02 3 1  ON 22
ci_024                 1.141622e-02 3 1  ON 23
ci_025                 1.160814e-02 3 1  ON 24
ci_026                 1.080355e-02 3 1  ON 25
ci_027                 1.091482e-02 3 1  ON 26
ci_028                -1.424227e-02 3 1  ON 27
ci_029                -1.469737e-02 3 1  ON 28
ci_030                -1.115899e-02 3 1  ON 29
ci_031                -1.082306e-02 3 1  ON 30
ci_032                -1.339002e-02 3 1  ON 31
ci_033                 1.061319e-02 3 1  ON 32
ci_034                 1.010480e-02 3 1  ON 33
ci_035                -4.575757e-03 3 1  ON 34
ci_036                -1.015901e-02 3 1  ON 35
ci_037                -1.035504e-02 3 1  ON 36
ci_038                 1.612521e-03 3 1  ON 37
ci_039                 1.721297e-03 3 1  ON 38
ci_040                -4.042933e-03 3 1  ON 39
ci_041                 9.724425e-03 3 1  ON 40
ci_042                 1.013840e-02 3 1  ON 41
ci_043                -3.275035e-03 3 1  ON 42
ci_044                -1.537668e-02 3 1  ON 43
ci_045                -1.866361e-03 3 1  ON 44
ci_046                 5.241696e-03 3 1  ON 45
ci_047                 5.300043e-03 3 1  ON 46
ci_048                -1.180204e-02 3 1  ON 47
ci_049                -1.171793e-02 3 1  ON 48
ci_050                 7.719482e-03 3 1  ON 49
ci_051                 7.594950e-03 3 1  ON 50
ci_052                -6.366813e-03 3 1  ON 51
ci_053                -6.914061e-03 3 1  ON 52
ci_054                -2.743547e-03 3 1  ON 53
ci_055                -2.994253e-03 3 1  ON 54
ci_056                 4.465885e-03 3 1  ON 55
ci_057                 4.419282e-03 3 1  ON 56
ci_058                -6.219179e-03 3 1  ON 57
ci_059                -6.235337e-03 3 1  ON 58
ci_060                 8.183498e-03 3 1  ON 59
ci_061                 8.231954e-03 3 1  ON 60
ci_062                -3.212468e-03 3 1  ON 61
ci_063                -2.901962e-03 3 1  ON 62
ci_064                -3.159824e-03 3 1  ON 63
ci_065                -4.022228e-03 3 1  ON 64
ci_066                 5.183700e-03 3 1  ON 65
ci_067                 5.751626e-03 3 1  ON 66
ci_068                -5.006125e-03 3 1  ON 67
ci_069                -5.234642e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.176
    reference variance = 0.268609
====================================================
  Execution time = 2.6675e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1799e-01
  Total weights = 3.9130e+06
  Execution time = 3.6406e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302173733202
                                         uncertainty =       0.002593586897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302173733202
                                         uncertainty =       0.002593586897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274845168
  error estimate for blocks of size 2^( 2) =       0.000281807816
  error estimate for blocks of size 2^( 3) =       0.000288114240
  error estimate for blocks of size 2^( 4) =       0.000292816667
  error estimate for blocks of size 2^( 5) =       0.000296225353
  error estimate for blocks of size 2^( 6) =       0.000298259677
  error estimate for blocks of size 2^( 7) =       0.000299890348
  error estimate for blocks of size 2^( 8) =       0.000300819385

      target function =                  N/A
              le_mean =     -17.216642319498
             les_mean =     296.738688577650
             stat err =       0.000298798691
             autocorr =       1.181901181415
              std dev =       0.549690336714
             le_variance =       0.302159466276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301941082763
                                         uncertainty =       0.002566170551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301941082763
                                         uncertainty =       0.002566170551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274739355
  error estimate for blocks of size 2^( 2) =       0.000281706746
  error estimate for blocks of size 2^( 3) =       0.000288015694
  error estimate for blocks of size 2^( 4) =       0.000292724237
  error estimate for blocks of size 2^( 5) =       0.000296133872
  error estimate for blocks of size 2^( 6) =       0.000298180219
  error estimate for blocks of size 2^( 7) =       0.000299802449
  error estimate for blocks of size 2^( 8) =       0.000300725153

      target function =                  N/A
              le_mean =     -17.216640851158
             les_mean =     296.736248219833
             stat err =       0.000298710423
             autocorr =       1.182113030053
              std dev =       0.549478710569
             le_variance =       0.301926853368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301931626226
                                         uncertainty =       0.002569093126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301931626226
                                         uncertainty =       0.002569093126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274735027
  error estimate for blocks of size 2^( 2) =       0.000281700749
  error estimate for blocks of size 2^( 3) =       0.000288009007
  error estimate for blocks of size 2^( 4) =       0.000292717451
  error estimate for blocks of size 2^( 5) =       0.000296126714
  error estimate for blocks of size 2^( 6) =       0.000298169129
  error estimate for blocks of size 2^( 7) =       0.000299793214
  error estimate for blocks of size 2^( 8) =       0.000300722702

      target function =                  N/A
              le_mean =     -17.216644142952
             les_mean =     296.737120968353
             stat err =       0.000298702940
             autocorr =       1.182091052341
              std dev =       0.549470053148
             le_variance =       0.301917339306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302105724623
                                         uncertainty =       0.002587730949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302105724623
                                         uncertainty =       0.002587730949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274814237
  error estimate for blocks of size 2^( 2) =       0.000281777932
  error estimate for blocks of size 2^( 3) =       0.000288085364
  error estimate for blocks of size 2^( 4) =       0.000292789922
  error estimate for blocks of size 2^( 5) =       0.000296199285
  error estimate for blocks of size 2^( 6) =       0.000298236010
  error estimate for blocks of size 2^( 7) =       0.000299866724
  error estimate for blocks of size 2^( 8) =       0.000300791881

      target function =                  N/A
              le_mean =     -17.216639109714
             les_mean =     296.732164780895
             stat err =       0.000298773475
             autocorr =       1.181967732819
              std dev =       0.549628474491
             le_variance =       0.302091459971


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216642319498        initial
     9.7656e-02     9.7656e-01             8.8803e-04       -17.216640851158
     3.9062e-01     3.9062e+00             4.4862e-04       -17.216644142952  <--
     1.5625e+00     1.5625e+01             1.5078e-04       -17.216639109714

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 4.5049e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -4.026978e-02 3 1  ON 0
ci_002                -3.004457e-02 3 1  ON 1
ci_003                -2.515137e-02 3 1  ON 2
ci_004                 2.128050e-02 3 1  ON 3
ci_005                 2.112541e-02 3 1  ON 4
ci_006                -1.905958e-02 3 1  ON 5
ci_007                -1.882633e-02 3 1  ON 6
ci_008                -1.783134e-02 3 1  ON 7
ci_009                -1.804107e-02 3 1  ON 8
ci_010                -1.688806e-02 3 1  ON 9
ci_011                -1.609791e-02 3 1  ON 10
ci_012                -1.586211e-02 3 1  ON 11
ci_013                -1.979130e-02 3 1  ON 12
ci_014                 1.366769e-02 3 1  ON 13
ci_015                 1.368247e-02 3 1  ON 14
ci_016                 1.593782e-02 3 1  ON 15
ci_017                 1.670454e-02 3 1  ON 16
ci_018                 1.276350e-02 3 1  ON 17
ci_019                 1.251797e-02 3 1  ON 18
ci_020                 1.331546e-02 3 1  ON 19
ci_021                 1.317252e-02 3 1  ON 20
ci_022                 1.135868e-02 3 1  ON 21
ci_023                 1.117071e-02 3 1  ON 22
ci_024                 1.141622e-02 3 1  ON 23
ci_025                 1.160814e-02 3 1  ON 24
ci_026                 1.080355e-02 3 1  ON 25
ci_027                 1.091482e-02 3 1  ON 26
ci_028                -1.424227e-02 3 1  ON 27
ci_029                -1.469737e-02 3 1  ON 28
ci_030                -1.115899e-02 3 1  ON 29
ci_031                -1.082306e-02 3 1  ON 30
ci_032                -1.339002e-02 3 1  ON 31
ci_033                 1.061319e-02 3 1  ON 32
ci_034                 1.010480e-02 3 1  ON 33
ci_035                -4.575757e-03 3 1  ON 34
ci_036                -1.015901e-02 3 1  ON 35
ci_037                -1.035504e-02 3 1  ON 36
ci_038                 1.612521e-03 3 1  ON 37
ci_039                 1.721297e-03 3 1  ON 38
ci_040                -4.042933e-03 3 1  ON 39
ci_041                 9.724425e-03 3 1  ON 40
ci_042                 1.013840e-02 3 1  ON 41
ci_043                -3.275035e-03 3 1  ON 42
ci_044                -1.537668e-02 3 1  ON 43
ci_045                -1.866361e-03 3 1  ON 44
ci_046                 5.241696e-03 3 1  ON 45
ci_047                 5.300043e-03 3 1  ON 46
ci_048                -1.180204e-02 3 1  ON 47
ci_049                -1.171793e-02 3 1  ON 48
ci_050                 7.719482e-03 3 1  ON 49
ci_051                 7.594950e-03 3 1  ON 50
ci_052                -6.366813e-03 3 1  ON 51
ci_053                -6.914061e-03 3 1  ON 52
ci_054                -2.743547e-03 3 1  ON 53
ci_055                -2.994253e-03 3 1  ON 54
ci_056                 4.465885e-03 3 1  ON 55
ci_057                 4.419282e-03 3 1  ON 56
ci_058                -6.219179e-03 3 1  ON 57
ci_059                -6.235337e-03 3 1  ON 58
ci_060                 8.183498e-03 3 1  ON 59
ci_061                 8.231954e-03 3 1  ON 60
ci_062                -3.212468e-03 3 1  ON 61
ci_063                -2.901962e-03 3 1  ON 62
ci_064                -3.159824e-03 3 1  ON 63
ci_065                -4.022228e-03 3 1  ON 64
ci_066                 5.183700e-03 3 1  ON 65
ci_067                 5.751626e-03 3 1  ON 66
ci_068                -5.006125e-03 3 1  ON 67
ci_069                -5.234642e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7068e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2833
    reference variance = 0.367435
====================================================
  Execution time = 2.7143e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0581e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1517e-01
  Total weights = 3.913238219e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9387e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299004247021
                                         uncertainty =       0.001227293959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299004247021
                                         uncertainty =       0.001227293959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273388305
  error estimate for blocks of size 2^( 2) =       0.000280426221
  error estimate for blocks of size 2^( 3) =       0.000287023251
  error estimate for blocks of size 2^( 4) =       0.000291526354
  error estimate for blocks of size 2^( 5) =       0.000293934578
  error estimate for blocks of size 2^( 6) =       0.000295398319
  error estimate for blocks of size 2^( 7) =       0.000295962036
  error estimate for blocks of size 2^( 8) =       0.000295780730

      target function =                  N/A
              le_mean =     -17.216836683560
             les_mean =     296.734634896761
             stat err =       0.000295268916
             autocorr =       1.166475427855
              std dev =       0.546776609447
             le_variance =       0.298964660638


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721683668356e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216836683584       residual = 8.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216846838646       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216847827895       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216847664266       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 8.435843e-04

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216836683584       residual = 8.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216842239640       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216842509382       residual = 6.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 4.748771e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216836683584       residual = 8.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216838659763       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216838696556       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.720746e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.320397 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2091e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -4.031385e-02 3 1  ON 0
ci_002                -2.999851e-02 3 1  ON 1
ci_003                -2.509701e-02 3 1  ON 2
ci_004                 2.113082e-02 3 1  ON 3
ci_005                 2.118684e-02 3 1  ON 4
ci_006                -1.896262e-02 3 1  ON 5
ci_007                -1.892447e-02 3 1  ON 6
ci_008                -1.797443e-02 3 1  ON 7
ci_009                -1.768843e-02 3 1  ON 8
ci_010                -1.691359e-02 3 1  ON 9
ci_011                -1.610650e-02 3 1  ON 10
ci_012                -1.565361e-02 3 1  ON 11
ci_013                -1.954519e-02 3 1  ON 12
ci_014                 1.372906e-02 3 1  ON 13
ci_015                 1.388575e-02 3 1  ON 14
ci_016                 1.624591e-02 3 1  ON 15
ci_017                 1.672150e-02 3 1  ON 16
ci_018                 1.265483e-02 3 1  ON 17
ci_019                 1.247039e-02 3 1  ON 18
ci_020                 1.304076e-02 3 1  ON 19
ci_021                 1.324517e-02 3 1  ON 20
ci_022                 1.121723e-02 3 1  ON 21
ci_023                 1.133587e-02 3 1  ON 22
ci_024                 1.136302e-02 3 1  ON 23
ci_025                 1.144829e-02 3 1  ON 24
ci_026                 1.083064e-02 3 1  ON 25
ci_027                 1.105792e-02 3 1  ON 26
ci_028                -1.439801e-02 3 1  ON 27
ci_029                -1.439469e-02 3 1  ON 28
ci_030                -1.112141e-02 3 1  ON 29
ci_031                -1.096785e-02 3 1  ON 30
ci_032                -1.374390e-02 3 1  ON 31
ci_033                 1.064910e-02 3 1  ON 32
ci_034                 1.024695e-02 3 1  ON 33
ci_035                -4.528024e-03 3 1  ON 34
ci_036                -1.034088e-02 3 1  ON 35
ci_037                -1.062487e-02 3 1  ON 36
ci_038                 1.677211e-03 3 1  ON 37
ci_039                 1.607697e-03 3 1  ON 38
ci_040                -3.981566e-03 3 1  ON 39
ci_041                 9.751646e-03 3 1  ON 40
ci_042                 1.001480e-02 3 1  ON 41
ci_043                -3.232129e-03 3 1  ON 42
ci_044                -1.539191e-02 3 1  ON 43
ci_045                -1.797027e-03 3 1  ON 44
ci_046                 5.120761e-03 3 1  ON 45
ci_047                 5.472260e-03 3 1  ON 46
ci_048                -1.158204e-02 3 1  ON 47
ci_049                -1.175073e-02 3 1  ON 48
ci_050                 7.558966e-03 3 1  ON 49
ci_051                 7.442698e-03 3 1  ON 50
ci_052                -6.598264e-03 3 1  ON 51
ci_053                -6.779188e-03 3 1  ON 52
ci_054                -2.623690e-03 3 1  ON 53
ci_055                -3.117915e-03 3 1  ON 54
ci_056                 4.729291e-03 3 1  ON 55
ci_057                 4.366851e-03 3 1  ON 56
ci_058                -6.501187e-03 3 1  ON 57
ci_059                -6.333239e-03 3 1  ON 58
ci_060                 8.141649e-03 3 1  ON 59
ci_061                 8.255132e-03 3 1  ON 60
ci_062                -2.989363e-03 3 1  ON 61
ci_063                -3.376839e-03 3 1  ON 62
ci_064                -3.073342e-03 3 1  ON 63
ci_065                -3.991998e-03 3 1  ON 64
ci_066                 5.389241e-03 3 1  ON 65
ci_067                 5.653185e-03 3 1  ON 66
ci_068                -4.780369e-03 3 1  ON 67
ci_069                -5.095827e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2502
    reference variance = 0.269614
====================================================
  Execution time = 2.7546e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1210e-01
  Total weights = 3.9134e+06
  Execution time = 3.6469e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297724337608
                                         uncertainty =       0.001432804464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297724337608
                                         uncertainty =       0.001432804464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272806678
  error estimate for blocks of size 2^( 2) =       0.000279932462
  error estimate for blocks of size 2^( 3) =       0.000286285370
  error estimate for blocks of size 2^( 4) =       0.000291247781
  error estimate for blocks of size 2^( 5) =       0.000293806875
  error estimate for blocks of size 2^( 6) =       0.000294556004
  error estimate for blocks of size 2^( 7) =       0.000295713975
  error estimate for blocks of size 2^( 8) =       0.000296509848

      target function =                  N/A
              le_mean =     -17.216326440384
             les_mean =     296.715600960768
             stat err =       0.000295146675
             autocorr =       1.170484849567
              std dev =       0.545613356067
             le_variance =       0.297693934318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297817936777
                                         uncertainty =       0.001447511687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297817936777
                                         uncertainty =       0.001447511687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272850032
  error estimate for blocks of size 2^( 2) =       0.000279979280
  error estimate for blocks of size 2^( 3) =       0.000286335856
  error estimate for blocks of size 2^( 4) =       0.000291295988
  error estimate for blocks of size 2^( 5) =       0.000293862663
  error estimate for blocks of size 2^( 6) =       0.000294617463
  error estimate for blocks of size 2^( 7) =       0.000295771991
  error estimate for blocks of size 2^( 8) =       0.000296611287

      target function =                  N/A
              le_mean =     -17.216326183112
             les_mean =     296.714673274686
             stat err =       0.000295215851
             autocorr =       1.170661473024
              std dev =       0.545700064116
             le_variance =       0.297788559976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297821439422
                                         uncertainty =       0.001448312283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297821439422
                                         uncertainty =       0.001448312283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272851693
  error estimate for blocks of size 2^( 2) =       0.000279981653
  error estimate for blocks of size 2^( 3) =       0.000286338276
  error estimate for blocks of size 2^( 4) =       0.000291299003
  error estimate for blocks of size 2^( 5) =       0.000293865093
  error estimate for blocks of size 2^( 6) =       0.000294619343
  error estimate for blocks of size 2^( 7) =       0.000295773400
  error estimate for blocks of size 2^( 8) =       0.000296616589

      target function =                  N/A
              le_mean =     -17.216328651663
             les_mean =     296.714737118756
             stat err =       0.000295218606
             autocorr =       1.170669070690
              std dev =       0.545703386648
             le_variance =       0.297792186199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297716425280
                                         uncertainty =       0.001435125689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297716425280
                                         uncertainty =       0.001435125689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272803150
  error estimate for blocks of size 2^( 2) =       0.000279929951
  error estimate for blocks of size 2^( 3) =       0.000286284259
  error estimate for blocks of size 2^( 4) =       0.000291245421
  error estimate for blocks of size 2^( 5) =       0.000293806547
  error estimate for blocks of size 2^( 6) =       0.000294556221
  error estimate for blocks of size 2^( 7) =       0.000295713605
  error estimate for blocks of size 2^( 8) =       0.000296518256

      target function =                  N/A
              le_mean =     -17.216323049844
             les_mean =     296.720581497805
             stat err =       0.000295148657
             autocorr =       1.170530844928
              std dev =       0.545606300224
             le_variance =       0.297686234844


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216326440384        initial
     9.7656e-02     9.7656e-01             8.4358e-04       -17.216326183112
     3.9062e-01     3.9062e+00             4.7488e-04       -17.216328651663  <--
     1.5625e+00     1.5625e+01             1.7207e-04       -17.216323049844

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 4.5929e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -4.031385e-02 3 1  ON 0
ci_002                -2.999851e-02 3 1  ON 1
ci_003                -2.509701e-02 3 1  ON 2
ci_004                 2.113082e-02 3 1  ON 3
ci_005                 2.118684e-02 3 1  ON 4
ci_006                -1.896262e-02 3 1  ON 5
ci_007                -1.892447e-02 3 1  ON 6
ci_008                -1.797443e-02 3 1  ON 7
ci_009                -1.768843e-02 3 1  ON 8
ci_010                -1.691359e-02 3 1  ON 9
ci_011                -1.610650e-02 3 1  ON 10
ci_012                -1.565361e-02 3 1  ON 11
ci_013                -1.954519e-02 3 1  ON 12
ci_014                 1.372906e-02 3 1  ON 13
ci_015                 1.388575e-02 3 1  ON 14
ci_016                 1.624591e-02 3 1  ON 15
ci_017                 1.672150e-02 3 1  ON 16
ci_018                 1.265483e-02 3 1  ON 17
ci_019                 1.247039e-02 3 1  ON 18
ci_020                 1.304076e-02 3 1  ON 19
ci_021                 1.324517e-02 3 1  ON 20
ci_022                 1.121723e-02 3 1  ON 21
ci_023                 1.133587e-02 3 1  ON 22
ci_024                 1.136302e-02 3 1  ON 23
ci_025                 1.144829e-02 3 1  ON 24
ci_026                 1.083064e-02 3 1  ON 25
ci_027                 1.105792e-02 3 1  ON 26
ci_028                -1.439801e-02 3 1  ON 27
ci_029                -1.439469e-02 3 1  ON 28
ci_030                -1.112141e-02 3 1  ON 29
ci_031                -1.096785e-02 3 1  ON 30
ci_032                -1.374390e-02 3 1  ON 31
ci_033                 1.064910e-02 3 1  ON 32
ci_034                 1.024695e-02 3 1  ON 33
ci_035                -4.528024e-03 3 1  ON 34
ci_036                -1.034088e-02 3 1  ON 35
ci_037                -1.062487e-02 3 1  ON 36
ci_038                 1.677211e-03 3 1  ON 37
ci_039                 1.607697e-03 3 1  ON 38
ci_040                -3.981566e-03 3 1  ON 39
ci_041                 9.751646e-03 3 1  ON 40
ci_042                 1.001480e-02 3 1  ON 41
ci_043                -3.232129e-03 3 1  ON 42
ci_044                -1.539191e-02 3 1  ON 43
ci_045                -1.797027e-03 3 1  ON 44
ci_046                 5.120761e-03 3 1  ON 45
ci_047                 5.472260e-03 3 1  ON 46
ci_048                -1.158204e-02 3 1  ON 47
ci_049                -1.175073e-02 3 1  ON 48
ci_050                 7.558966e-03 3 1  ON 49
ci_051                 7.442698e-03 3 1  ON 50
ci_052                -6.598264e-03 3 1  ON 51
ci_053                -6.779188e-03 3 1  ON 52
ci_054                -2.623690e-03 3 1  ON 53
ci_055                -3.117915e-03 3 1  ON 54
ci_056                 4.729291e-03 3 1  ON 55
ci_057                 4.366851e-03 3 1  ON 56
ci_058                -6.501187e-03 3 1  ON 57
ci_059                -6.333239e-03 3 1  ON 58
ci_060                 8.141649e-03 3 1  ON 59
ci_061                 8.255132e-03 3 1  ON 60
ci_062                -2.989363e-03 3 1  ON 61
ci_063                -3.376839e-03 3 1  ON 62
ci_064                -3.073342e-03 3 1  ON 63
ci_065                -3.991998e-03 3 1  ON 64
ci_066                 5.389241e-03 3 1  ON 65
ci_067                 5.653185e-03 3 1  ON 66
ci_068                -4.780369e-03 3 1  ON 67
ci_069                -5.095827e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8114e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2459
    reference variance = 0.294661
====================================================
  Execution time = 2.7538e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0573e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1276e-01
  Total weights = 3.912982924e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9235e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298085371939
                                         uncertainty =       0.001334517886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298085371939
                                         uncertainty =       0.001334517886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272979081
  error estimate for blocks of size 2^( 2) =       0.000279993172
  error estimate for blocks of size 2^( 3) =       0.000286563471
  error estimate for blocks of size 2^( 4) =       0.000291359168
  error estimate for blocks of size 2^( 5) =       0.000294265359
  error estimate for blocks of size 2^( 6) =       0.000295551339
  error estimate for blocks of size 2^( 7) =       0.000295575406
  error estimate for blocks of size 2^( 8) =       0.000295581994

      target function =                  N/A
              le_mean =     -17.216027233356
             les_mean =     296.704357204435
             stat err =       0.000295243524
             autocorr =       1.169774172891
              std dev =       0.545958161329
             le_variance =       0.298070313922


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721602723336e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216027233372       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216028524866       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216028494759       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216028438400       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 8.890795e-04

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216027233372       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216027966214       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216027604878       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216027541944       residual = 8.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 4.874831e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216027233372       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216027501788       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216027245742       residual = 6.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.825256e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.321671 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2468e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -4.017107e-02 3 1  ON 0
ci_002                -2.999904e-02 3 1  ON 1
ci_003                -2.484109e-02 3 1  ON 2
ci_004                 2.098942e-02 3 1  ON 3
ci_005                 2.109949e-02 3 1  ON 4
ci_006                -1.927380e-02 3 1  ON 5
ci_007                -1.888578e-02 3 1  ON 6
ci_008                -1.767593e-02 3 1  ON 7
ci_009                -1.747496e-02 3 1  ON 8
ci_010                -1.726814e-02 3 1  ON 9
ci_011                -1.631768e-02 3 1  ON 10
ci_012                -1.612674e-02 3 1  ON 11
ci_013                -1.944929e-02 3 1  ON 12
ci_014                 1.402584e-02 3 1  ON 13
ci_015                 1.384687e-02 3 1  ON 14
ci_016                 1.628536e-02 3 1  ON 15
ci_017                 1.689311e-02 3 1  ON 16
ci_018                 1.280162e-02 3 1  ON 17
ci_019                 1.253207e-02 3 1  ON 18
ci_020                 1.296228e-02 3 1  ON 19
ci_021                 1.322131e-02 3 1  ON 20
ci_022                 1.144100e-02 3 1  ON 21
ci_023                 1.126639e-02 3 1  ON 22
ci_024                 1.138613e-02 3 1  ON 23
ci_025                 1.142362e-02 3 1  ON 24
ci_026                 1.098789e-02 3 1  ON 25
ci_027                 1.092520e-02 3 1  ON 26
ci_028                -1.444098e-02 3 1  ON 27
ci_029                -1.439387e-02 3 1  ON 28
ci_030                -1.102502e-02 3 1  ON 29
ci_031                -1.100245e-02 3 1  ON 30
ci_032                -1.325642e-02 3 1  ON 31
ci_033                 1.059368e-02 3 1  ON 32
ci_034                 1.048275e-02 3 1  ON 33
ci_035                -4.598768e-03 3 1  ON 34
ci_036                -1.028317e-02 3 1  ON 35
ci_037                -1.045277e-02 3 1  ON 36
ci_038                 1.755210e-03 3 1  ON 37
ci_039                 1.570456e-03 3 1  ON 38
ci_040                -3.931198e-03 3 1  ON 39
ci_041                 9.804331e-03 3 1  ON 40
ci_042                 1.018090e-02 3 1  ON 41
ci_043                -3.003182e-03 3 1  ON 42
ci_044                -1.545128e-02 3 1  ON 43
ci_045                -1.834171e-03 3 1  ON 44
ci_046                 5.282836e-03 3 1  ON 45
ci_047                 5.525232e-03 3 1  ON 46
ci_048                -1.158893e-02 3 1  ON 47
ci_049                -1.191589e-02 3 1  ON 48
ci_050                 7.780425e-03 3 1  ON 49
ci_051                 7.561452e-03 3 1  ON 50
ci_052                -6.845365e-03 3 1  ON 51
ci_053                -6.293527e-03 3 1  ON 52
ci_054                -2.690858e-03 3 1  ON 53
ci_055                -3.128476e-03 3 1  ON 54
ci_056                 4.684759e-03 3 1  ON 55
ci_057                 4.393562e-03 3 1  ON 56
ci_058                -6.800579e-03 3 1  ON 57
ci_059                -6.457051e-03 3 1  ON 58
ci_060                 8.331559e-03 3 1  ON 59
ci_061                 8.473039e-03 3 1  ON 60
ci_062                -2.968367e-03 3 1  ON 61
ci_063                -3.139611e-03 3 1  ON 62
ci_064                -2.858291e-03 3 1  ON 63
ci_065                -3.974921e-03 3 1  ON 64
ci_066                 5.637565e-03 3 1  ON 65
ci_067                 6.065494e-03 3 1  ON 66
ci_068                -4.630289e-03 3 1  ON 67
ci_069                -5.190547e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2817
    reference variance = 0.366099
====================================================
  Execution time = 2.7157e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1273e-01
  Total weights = 3.9136e+06
  Execution time = 3.6417e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298549408681
                                         uncertainty =       0.001457484871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298549408681
                                         uncertainty =       0.001457484871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273190179
  error estimate for blocks of size 2^( 2) =       0.000280353892
  error estimate for blocks of size 2^( 3) =       0.000287008249
  error estimate for blocks of size 2^( 4) =       0.000291876818
  error estimate for blocks of size 2^( 5) =       0.000295087264
  error estimate for blocks of size 2^( 6) =       0.000297020453
  error estimate for blocks of size 2^( 7) =       0.000298050169
  error estimate for blocks of size 2^( 8) =       0.000298708878

      target function =                  N/A
              le_mean =     -17.216825631489
             les_mean =     296.732052301098
             stat err =       0.000297216691
             autocorr =       1.183630706398
              std dev =       0.546380358479
             le_variance =       0.298531496131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299202712718
                                         uncertainty =       0.001479887911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299202712718
                                         uncertainty =       0.001479887911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273489084
  error estimate for blocks of size 2^( 2) =       0.000280637183
  error estimate for blocks of size 2^( 3) =       0.000287279947
  error estimate for blocks of size 2^( 4) =       0.000292140060
  error estimate for blocks of size 2^( 5) =       0.000295341161
  error estimate for blocks of size 2^( 6) =       0.000297261658
  error estimate for blocks of size 2^( 7) =       0.000298289250
  error estimate for blocks of size 2^( 8) =       0.000298982138

      target function =                  N/A
              le_mean =     -17.216830068397
             les_mean =     296.733086456811
             stat err =       0.000297468552
             autocorr =       1.183047343020
              std dev =       0.546978167859
             le_variance =       0.299185116114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299281250797
                                         uncertainty =       0.001482204474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299281250797
                                         uncertainty =       0.001482204474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273524928
  error estimate for blocks of size 2^( 2) =       0.000280672792
  error estimate for blocks of size 2^( 3) =       0.000287316386
  error estimate for blocks of size 2^( 4) =       0.000292175695
  error estimate for blocks of size 2^( 5) =       0.000295376920
  error estimate for blocks of size 2^( 6) =       0.000297292950
  error estimate for blocks of size 2^( 7) =       0.000298313876
  error estimate for blocks of size 2^( 8) =       0.000299019772

      target function =                  N/A
              le_mean =     -17.216834679146
             les_mean =     296.739499898988
             stat err =       0.000297500880
             autocorr =       1.182994382579
              std dev =       0.547049856915
             le_variance =       0.299263545950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298645831984
                                         uncertainty =       0.001461470525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298645831984
                                         uncertainty =       0.001461470525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273234312
  error estimate for blocks of size 2^( 2) =       0.000280395429
  error estimate for blocks of size 2^( 3) =       0.000287048606
  error estimate for blocks of size 2^( 4) =       0.000291915779
  error estimate for blocks of size 2^( 5) =       0.000295124885
  error estimate for blocks of size 2^( 6) =       0.000297055978
  error estimate for blocks of size 2^( 7) =       0.000298085610
  error estimate for blocks of size 2^( 8) =       0.000298753590

      target function =                  N/A
              le_mean =     -17.216822725661
             les_mean =     296.731515980206
             stat err =       0.000297255016
             autocorr =       1.183553547796
              std dev =       0.546468623593
             le_variance =       0.298627956571


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216825631489        initial
     9.7656e-02     9.7656e-01             8.8908e-04       -17.216830068397
     3.9062e-01     3.9062e+00             4.8748e-04       -17.216834679146  <--
     1.5625e+00     1.5625e+01             1.8253e-04       -17.216822725661

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 4.5546e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -4.017107e-02 3 1  ON 0
ci_002                -2.999904e-02 3 1  ON 1
ci_003                -2.484109e-02 3 1  ON 2
ci_004                 2.098942e-02 3 1  ON 3
ci_005                 2.109949e-02 3 1  ON 4
ci_006                -1.927380e-02 3 1  ON 5
ci_007                -1.888578e-02 3 1  ON 6
ci_008                -1.767593e-02 3 1  ON 7
ci_009                -1.747496e-02 3 1  ON 8
ci_010                -1.726814e-02 3 1  ON 9
ci_011                -1.631768e-02 3 1  ON 10
ci_012                -1.612674e-02 3 1  ON 11
ci_013                -1.944929e-02 3 1  ON 12
ci_014                 1.402584e-02 3 1  ON 13
ci_015                 1.384687e-02 3 1  ON 14
ci_016                 1.628536e-02 3 1  ON 15
ci_017                 1.689311e-02 3 1  ON 16
ci_018                 1.280162e-02 3 1  ON 17
ci_019                 1.253207e-02 3 1  ON 18
ci_020                 1.296228e-02 3 1  ON 19
ci_021                 1.322131e-02 3 1  ON 20
ci_022                 1.144100e-02 3 1  ON 21
ci_023                 1.126639e-02 3 1  ON 22
ci_024                 1.138613e-02 3 1  ON 23
ci_025                 1.142362e-02 3 1  ON 24
ci_026                 1.098789e-02 3 1  ON 25
ci_027                 1.092520e-02 3 1  ON 26
ci_028                -1.444098e-02 3 1  ON 27
ci_029                -1.439387e-02 3 1  ON 28
ci_030                -1.102502e-02 3 1  ON 29
ci_031                -1.100245e-02 3 1  ON 30
ci_032                -1.325642e-02 3 1  ON 31
ci_033                 1.059368e-02 3 1  ON 32
ci_034                 1.048275e-02 3 1  ON 33
ci_035                -4.598768e-03 3 1  ON 34
ci_036                -1.028317e-02 3 1  ON 35
ci_037                -1.045277e-02 3 1  ON 36
ci_038                 1.755210e-03 3 1  ON 37
ci_039                 1.570456e-03 3 1  ON 38
ci_040                -3.931198e-03 3 1  ON 39
ci_041                 9.804331e-03 3 1  ON 40
ci_042                 1.018090e-02 3 1  ON 41
ci_043                -3.003182e-03 3 1  ON 42
ci_044                -1.545128e-02 3 1  ON 43
ci_045                -1.834171e-03 3 1  ON 44
ci_046                 5.282836e-03 3 1  ON 45
ci_047                 5.525232e-03 3 1  ON 46
ci_048                -1.158893e-02 3 1  ON 47
ci_049                -1.191589e-02 3 1  ON 48
ci_050                 7.780425e-03 3 1  ON 49
ci_051                 7.561452e-03 3 1  ON 50
ci_052                -6.845365e-03 3 1  ON 51
ci_053                -6.293527e-03 3 1  ON 52
ci_054                -2.690858e-03 3 1  ON 53
ci_055                -3.128476e-03 3 1  ON 54
ci_056                 4.684759e-03 3 1  ON 55
ci_057                 4.393562e-03 3 1  ON 56
ci_058                -6.800579e-03 3 1  ON 57
ci_059                -6.457051e-03 3 1  ON 58
ci_060                 8.331559e-03 3 1  ON 59
ci_061                 8.473039e-03 3 1  ON 60
ci_062                -2.968367e-03 3 1  ON 61
ci_063                -3.139611e-03 3 1  ON 62
ci_064                -2.858291e-03 3 1  ON 63
ci_065                -3.974921e-03 3 1  ON 64
ci_066                 5.637565e-03 3 1  ON 65
ci_067                 6.065494e-03 3 1  ON 66
ci_068                -4.630289e-03 3 1  ON 67
ci_069                -5.190547e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8039e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2123
    reference variance = 0.190246
====================================================
  Execution time = 2.6978e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0531e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1420e-01
  Total weights = 3.913622997e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9175e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299089112020
                                         uncertainty =       0.001497418275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299089112020
                                         uncertainty =       0.001497418275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273445492
  error estimate for blocks of size 2^( 2) =       0.000280576797
  error estimate for blocks of size 2^( 3) =       0.000286709101
  error estimate for blocks of size 2^( 4) =       0.000291197450
  error estimate for blocks of size 2^( 5) =       0.000293919505
  error estimate for blocks of size 2^( 6) =       0.000295177483
  error estimate for blocks of size 2^( 7) =       0.000296003905
  error estimate for blocks of size 2^( 8) =       0.000294788875

      target function =                  N/A
              le_mean =     -17.216586267435
             les_mean =     296.725046171820
             stat err =       0.000294972442
             autocorr =       1.163647258002
              std dev =       0.546890984064
             le_variance =       0.299089748450


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721658626744e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216586267452       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216594132238       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216592303841       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216592583790       residual = 7.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 8.482099e-04

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216586267452       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216590546950       residual = 9.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216589964933       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216590042544       residual = 4.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 4.335711e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216586267452       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216587783142       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216587736248       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.473719e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.323022 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1903e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -4.017962e-02 3 1  ON 0
ci_002                -2.982561e-02 3 1  ON 1
ci_003                -2.512915e-02 3 1  ON 2
ci_004                 2.076391e-02 3 1  ON 3
ci_005                 2.126377e-02 3 1  ON 4
ci_006                -1.908915e-02 3 1  ON 5
ci_007                -1.885723e-02 3 1  ON 6
ci_008                -1.769621e-02 3 1  ON 7
ci_009                -1.752151e-02 3 1  ON 8
ci_010                -1.735606e-02 3 1  ON 9
ci_011                -1.628954e-02 3 1  ON 10
ci_012                -1.619940e-02 3 1  ON 11
ci_013                -1.954300e-02 3 1  ON 12
ci_014                 1.402063e-02 3 1  ON 13
ci_015                 1.383860e-02 3 1  ON 14
ci_016                 1.655451e-02 3 1  ON 15
ci_017                 1.645954e-02 3 1  ON 16
ci_018                 1.256298e-02 3 1  ON 17
ci_019                 1.266395e-02 3 1  ON 18
ci_020                 1.273554e-02 3 1  ON 19
ci_021                 1.313037e-02 3 1  ON 20
ci_022                 1.133228e-02 3 1  ON 21
ci_023                 1.130315e-02 3 1  ON 22
ci_024                 1.162377e-02 3 1  ON 23
ci_025                 1.155765e-02 3 1  ON 24
ci_026                 1.114187e-02 3 1  ON 25
ci_027                 1.096739e-02 3 1  ON 26
ci_028                -1.445478e-02 3 1  ON 27
ci_029                -1.448347e-02 3 1  ON 28
ci_030                -1.107043e-02 3 1  ON 29
ci_031                -1.116658e-02 3 1  ON 30
ci_032                -1.345242e-02 3 1  ON 31
ci_033                 1.055189e-02 3 1  ON 32
ci_034                 1.033508e-02 3 1  ON 33
ci_035                -4.610893e-03 3 1  ON 34
ci_036                -1.030851e-02 3 1  ON 35
ci_037                -1.037684e-02 3 1  ON 36
ci_038                 1.560415e-03 3 1  ON 37
ci_039                 1.674132e-03 3 1  ON 38
ci_040                -3.982687e-03 3 1  ON 39
ci_041                 9.834477e-03 3 1  ON 40
ci_042                 9.970048e-03 3 1  ON 41
ci_043                -3.028482e-03 3 1  ON 42
ci_044                -1.525831e-02 3 1  ON 43
ci_045                -1.781111e-03 3 1  ON 44
ci_046                 5.326955e-03 3 1  ON 45
ci_047                 5.611433e-03 3 1  ON 46
ci_048                -1.172119e-02 3 1  ON 47
ci_049                -1.156231e-02 3 1  ON 48
ci_050                 7.651817e-03 3 1  ON 49
ci_051                 7.560517e-03 3 1  ON 50
ci_052                -6.684764e-03 3 1  ON 51
ci_053                -6.340055e-03 3 1  ON 52
ci_054                -2.752880e-03 3 1  ON 53
ci_055                -2.976243e-03 3 1  ON 54
ci_056                 4.842768e-03 3 1  ON 55
ci_057                 4.585805e-03 3 1  ON 56
ci_058                -6.873991e-03 3 1  ON 57
ci_059                -6.248485e-03 3 1  ON 58
ci_060                 8.579342e-03 3 1  ON 59
ci_061                 8.549054e-03 3 1  ON 60
ci_062                -3.226678e-03 3 1  ON 61
ci_063                -3.178636e-03 3 1  ON 62
ci_064                -3.045906e-03 3 1  ON 63
ci_065                -3.964870e-03 3 1  ON 64
ci_066                 5.444306e-03 3 1  ON 65
ci_067                 5.960533e-03 3 1  ON 66
ci_068                -4.698978e-03 3 1  ON 67
ci_069                -4.856070e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2032
    reference variance = 0.187153
====================================================
  Execution time = 2.9130e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1463e-01
  Total weights = 3.9131e+06
  Execution time = 3.6478e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299626796058
                                         uncertainty =       0.001330814099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299626796058
                                         uncertainty =       0.001330814099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273727826
  error estimate for blocks of size 2^( 2) =       0.000280769671
  error estimate for blocks of size 2^( 3) =       0.000287409502
  error estimate for blocks of size 2^( 4) =       0.000292448502
  error estimate for blocks of size 2^( 5) =       0.000295576397
  error estimate for blocks of size 2^( 6) =       0.000297189400
  error estimate for blocks of size 2^( 7) =       0.000298559173
  error estimate for blocks of size 2^( 8) =       0.000299585892

      target function =                  N/A
              le_mean =     -17.216155877950
             les_mean =     296.713684785754
             stat err =       0.000297727716
             autocorr =       1.183043286128
              std dev =       0.547455651205
             le_variance =       0.299707690036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299523072268
                                         uncertainty =       0.001309328057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299523072268
                                         uncertainty =       0.001309328057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273680604
  error estimate for blocks of size 2^( 2) =       0.000280727491
  error estimate for blocks of size 2^( 3) =       0.000287368075
  error estimate for blocks of size 2^( 4) =       0.000292413102
  error estimate for blocks of size 2^( 5) =       0.000295519281
  error estimate for blocks of size 2^( 6) =       0.000297126878
  error estimate for blocks of size 2^( 7) =       0.000298482186
  error estimate for blocks of size 2^( 8) =       0.000299502924

      target function =                  N/A
              le_mean =     -17.216166026695
             les_mean =     296.820282233999
             stat err =       0.000297657817
             autocorr =       1.182895953019
              std dev =       0.547361207674
             le_variance =       0.299604291667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299517016856
                                         uncertainty =       0.001303263343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299517016856
                                         uncertainty =       0.001303263343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273677813
  error estimate for blocks of size 2^( 2) =       0.000280728167
  error estimate for blocks of size 2^( 3) =       0.000287368173
  error estimate for blocks of size 2^( 4) =       0.000292413435
  error estimate for blocks of size 2^( 5) =       0.000295529786
  error estimate for blocks of size 2^( 6) =       0.000297127790
  error estimate for blocks of size 2^( 7) =       0.000298481003
  error estimate for blocks of size 2^( 8) =       0.000299514181

      target function =                  N/A
              le_mean =     -17.216156838975
             les_mean =     296.919756900043
             stat err =       0.000297663190
             autocorr =       1.182962786204
              std dev =       0.547355625377
             le_variance =       0.299598180632

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299560756636
                                         uncertainty =       0.001323049778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299560756636
                                         uncertainty =       0.001323049778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273697704
  error estimate for blocks of size 2^( 2) =       0.000280740746
  error estimate for blocks of size 2^( 3) =       0.000287381070
  error estimate for blocks of size 2^( 4) =       0.000292420593
  error estimate for blocks of size 2^( 5) =       0.000295546649
  error estimate for blocks of size 2^( 6) =       0.000297156698
  error estimate for blocks of size 2^( 7) =       0.000298525123
  error estimate for blocks of size 2^( 8) =       0.000299551214

      target function =                  N/A
              le_mean =     -17.216154822729
             les_mean =     296.711147603821
             stat err =       0.000297694921
             autocorr =       1.183043030941
              std dev =       0.547395408095
             le_variance =       0.299641732803


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216155877950        initial
     9.7656e-02     9.7656e-01             8.4821e-04       -17.216166026695  <--
     3.9062e-01     3.9062e+00             4.3357e-04       -17.216156838975
     1.5625e+00     1.5625e+01             1.4737e-04       -17.216154822729

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 4.7527e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -4.018007e-02 3 1  ON 0
ci_002                -2.968700e-02 3 1  ON 1
ci_003                -2.544653e-02 3 1  ON 2
ci_004                 2.053346e-02 3 1  ON 3
ci_005                 2.143750e-02 3 1  ON 4
ci_006                -1.891819e-02 3 1  ON 5
ci_007                -1.884088e-02 3 1  ON 6
ci_008                -1.770596e-02 3 1  ON 7
ci_009                -1.755364e-02 3 1  ON 8
ci_010                -1.744198e-02 3 1  ON 9
ci_011                -1.627819e-02 3 1  ON 10
ci_012                -1.627888e-02 3 1  ON 11
ci_013                -1.962394e-02 3 1  ON 12
ci_014                 1.403588e-02 3 1  ON 13
ci_015                 1.383675e-02 3 1  ON 14
ci_016                 1.683835e-02 3 1  ON 15
ci_017                 1.604490e-02 3 1  ON 16
ci_018                 1.236887e-02 3 1  ON 17
ci_019                 1.277427e-02 3 1  ON 18
ci_020                 1.249209e-02 3 1  ON 19
ci_021                 1.304975e-02 3 1  ON 20
ci_022                 1.124670e-02 3 1  ON 21
ci_023                 1.132412e-02 3 1  ON 22
ci_024                 1.188923e-02 3 1  ON 23
ci_025                 1.171682e-02 3 1  ON 24
ci_026                 1.128936e-02 3 1  ON 25
ci_027                 1.099724e-02 3 1  ON 26
ci_028                -1.448365e-02 3 1  ON 27
ci_029                -1.458460e-02 3 1  ON 28
ci_030                -1.111043e-02 3 1  ON 29
ci_031                -1.131224e-02 3 1  ON 30
ci_032                -1.359838e-02 3 1  ON 31
ci_033                 1.051937e-02 3 1  ON 32
ci_034                 1.020799e-02 3 1  ON 33
ci_035                -4.615989e-03 3 1  ON 34
ci_036                -1.034018e-02 3 1  ON 35
ci_037                -1.030394e-02 3 1  ON 36
ci_038                 1.449846e-03 3 1  ON 37
ci_039                 1.731963e-03 3 1  ON 38
ci_040                -4.006157e-03 3 1  ON 39
ci_041                 9.871134e-03 3 1  ON 40
ci_042                 9.789246e-03 3 1  ON 41
ci_043                -3.041192e-03 3 1  ON 42
ci_044                -1.503438e-02 3 1  ON 43
ci_045                -1.747812e-03 3 1  ON 44
ci_046                 5.366192e-03 3 1  ON 45
ci_047                 5.685628e-03 3 1  ON 46
ci_048                -1.188221e-02 3 1  ON 47
ci_049                -1.118070e-02 3 1  ON 48
ci_050                 7.567719e-03 3 1  ON 49
ci_051                 7.561549e-03 3 1  ON 50
ci_052                -6.573141e-03 3 1  ON 51
ci_053                -6.378509e-03 3 1  ON 52
ci_054                -2.796721e-03 3 1  ON 53
ci_055                -2.857217e-03 3 1  ON 54
ci_056                 4.947794e-03 3 1  ON 55
ci_057                 4.718261e-03 3 1  ON 56
ci_058                -6.930343e-03 3 1  ON 57
ci_059                -6.097356e-03 3 1  ON 58
ci_060                 8.793988e-03 3 1  ON 59
ci_061                 8.613088e-03 3 1  ON 60
ci_062                -3.428810e-03 3 1  ON 61
ci_063                -3.208294e-03 3 1  ON 62
ci_064                -3.137142e-03 3 1  ON 63
ci_065                -3.962152e-03 3 1  ON 64
ci_066                 5.320639e-03 3 1  ON 65
ci_067                 5.897450e-03 3 1  ON 66
ci_068                -4.761360e-03 3 1  ON 67
ci_069                -4.577922e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9627e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.231
    reference variance = 0.240113
====================================================
  Execution time = 2.7069e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0567e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1677e-01
  Total weights = 3.913146552e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.0508e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300682334799
                                         uncertainty =       0.001663163417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300682334799
                                         uncertainty =       0.001663163417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274164820
  error estimate for blocks of size 2^( 2) =       0.000281204629
  error estimate for blocks of size 2^( 3) =       0.000287581541
  error estimate for blocks of size 2^( 4) =       0.000292572249
  error estimate for blocks of size 2^( 5) =       0.000295829119
  error estimate for blocks of size 2^( 6) =       0.000298053530
  error estimate for blocks of size 2^( 7) =       0.000298783769
  error estimate for blocks of size 2^( 8) =       0.000300271360

      target function =                  N/A
              le_mean =     -17.217187250823
             les_mean =     296.748311205609
             stat err =       0.000298234444
             autocorr =       1.183292597995
              std dev =       0.548329639824
             le_variance =       0.300665393910


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721718725082e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217187250845       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217184691427       residual = 9.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217187056917       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217186940664       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217187029386       residual = 4.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-02 is 1.557773e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217187250845       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217185222251       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217186645154       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217186535742       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217186556673       residual = 6.28e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 1.097409e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217187250845       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217186142081       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217186467723       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217186412628       residual = 8.72e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 6.121148e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.324607 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2127e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -4.030718e-02 3 1  ON 0
ci_002                -2.971595e-02 3 1  ON 1
ci_003                -2.538469e-02 3 1  ON 2
ci_004                 2.088523e-02 3 1  ON 3
ci_005                 2.157310e-02 3 1  ON 4
ci_006                -1.867084e-02 3 1  ON 5
ci_007                -1.897546e-02 3 1  ON 6
ci_008                -1.783377e-02 3 1  ON 7
ci_009                -1.742791e-02 3 1  ON 8
ci_010                -1.709371e-02 3 1  ON 9
ci_011                -1.588777e-02 3 1  ON 10
ci_012                -1.544012e-02 3 1  ON 11
ci_013                -1.932568e-02 3 1  ON 12
ci_014                 1.390843e-02 3 1  ON 13
ci_015                 1.420901e-02 3 1  ON 14
ci_016                 1.607271e-02 3 1  ON 15
ci_017                 1.597282e-02 3 1  ON 16
ci_018                 1.261307e-02 3 1  ON 17
ci_019                 1.264651e-02 3 1  ON 18
ci_020                 1.300579e-02 3 1  ON 19
ci_021                 1.333380e-02 3 1  ON 20
ci_022                 1.174334e-02 3 1  ON 21
ci_023                 1.131939e-02 3 1  ON 22
ci_024                 1.147748e-02 3 1  ON 23
ci_025                 1.165760e-02 3 1  ON 24
ci_026                 1.086194e-02 3 1  ON 25
ci_027                 1.082006e-02 3 1  ON 26
ci_028                -1.474059e-02 3 1  ON 27
ci_029                -1.400359e-02 3 1  ON 28
ci_030                -1.142099e-02 3 1  ON 29
ci_031                -1.154645e-02 3 1  ON 30
ci_032                -1.408048e-02 3 1  ON 31
ci_033                 1.106723e-02 3 1  ON 32
ci_034                 9.761824e-03 3 1  ON 33
ci_035                -4.794441e-03 3 1  ON 34
ci_036                -1.039503e-02 3 1  ON 35
ci_037                -1.073277e-02 3 1  ON 36
ci_038                 1.911654e-03 3 1  ON 37
ci_039                 1.614524e-03 3 1  ON 38
ci_040                -4.234105e-03 3 1  ON 39
ci_041                 9.983101e-03 3 1  ON 40
ci_042                 9.535104e-03 3 1  ON 41
ci_043                -2.779392e-03 3 1  ON 42
ci_044                -1.612510e-02 3 1  ON 43
ci_045                -1.901225e-03 3 1  ON 44
ci_046                 5.626382e-03 3 1  ON 45
ci_047                 5.343041e-03 3 1  ON 46
ci_048                -1.183859e-02 3 1  ON 47
ci_049                -1.218132e-02 3 1  ON 48
ci_050                 7.154279e-03 3 1  ON 49
ci_051                 7.270090e-03 3 1  ON 50
ci_052                -6.047547e-03 3 1  ON 51
ci_053                -6.009898e-03 3 1  ON 52
ci_054                -3.203622e-03 3 1  ON 53
ci_055                -3.027349e-03 3 1  ON 54
ci_056                 4.720409e-03 3 1  ON 55
ci_057                 5.059661e-03 3 1  ON 56
ci_058                -6.326068e-03 3 1  ON 57
ci_059                -6.589685e-03 3 1  ON 58
ci_060                 8.102683e-03 3 1  ON 59
ci_061                 8.264812e-03 3 1  ON 60
ci_062                -3.122611e-03 3 1  ON 61
ci_063                -2.110885e-03 3 1  ON 62
ci_064                -3.333986e-03 3 1  ON 63
ci_065                -3.748080e-03 3 1  ON 64
ci_066                 6.318219e-03 3 1  ON 65
ci_067                 5.666782e-03 3 1  ON 66
ci_068                -4.749934e-03 3 1  ON 67
ci_069                -5.373640e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2156
    reference variance = 0.262137
====================================================
  Execution time = 2.6805e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2098e-01
  Total weights = 3.9135e+06
  Execution time = 3.6326e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.019897
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305647764382
                                         uncertainty =       0.005271005061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305647764382
                                         uncertainty =       0.005271005061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000276439107
  error estimate for blocks of size 2^( 2) =       0.000283371576
  error estimate for blocks of size 2^( 3) =       0.000289684412
  error estimate for blocks of size 2^( 4) =       0.000293925455
  error estimate for blocks of size 2^( 5) =       0.000297284309
  error estimate for blocks of size 2^( 6) =       0.000298831641
  error estimate for blocks of size 2^( 7) =       0.000299776403
  error estimate for blocks of size 2^( 8) =       0.000301962287

      target function =                  N/A
              le_mean =     -17.216574276856
             les_mean =     296.738065560279
             stat err =       0.000299463660
             autocorr =       1.173516752565
              std dev =       0.552878213721
             le_variance =       0.305674319208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304901055694
                                         uncertainty =       0.004813530267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304901055694
                                         uncertainty =       0.004813530267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000276095159
  error estimate for blocks of size 2^( 2) =       0.000283030452
  error estimate for blocks of size 2^( 3) =       0.000289357617
  error estimate for blocks of size 2^( 4) =       0.000293616076
  error estimate for blocks of size 2^( 5) =       0.000296960425
  error estimate for blocks of size 2^( 6) =       0.000298538364
  error estimate for blocks of size 2^( 7) =       0.000299494135
  error estimate for blocks of size 2^( 8) =       0.000301630634

      target function =                  N/A
              le_mean =     -17.216537351954
             les_mean =     296.731746630930
             stat err =       0.000299155889
             autocorr =       1.174025503401
              std dev =       0.552190317425
             le_variance =       0.304914146658

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0195186
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304860527671
                                         uncertainty =       0.004597903703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304860527671
                                         uncertainty =       0.004597903703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000276074047
  error estimate for blocks of size 2^( 2) =       0.000283015243
  error estimate for blocks of size 2^( 3) =       0.000289352056
  error estimate for blocks of size 2^( 4) =       0.000293619903
  error estimate for blocks of size 2^( 5) =       0.000296950716
  error estimate for blocks of size 2^( 6) =       0.000298543297
  error estimate for blocks of size 2^( 7) =       0.000299507009
  error estimate for blocks of size 2^( 8) =       0.000301633924

      target function =                  N/A
              le_mean =     -17.216563391949
             les_mean =     296.736926183920
             stat err =       0.000299158737
             autocorr =       1.174227422391
              std dev =       0.552148093253
             le_variance =       0.304867516883

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.229323
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305221861689
                                         uncertainty =       0.005082966406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305221861689
                                         uncertainty =       0.005082966406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000276243788
  error estimate for blocks of size 2^( 2) =       0.000283176194
  error estimate for blocks of size 2^( 3) =       0.000289494129
  error estimate for blocks of size 2^( 4) =       0.000293746065
  error estimate for blocks of size 2^( 5) =       0.000297100760
  error estimate for blocks of size 2^( 6) =       0.000298659206
  error estimate for blocks of size 2^( 7) =       0.000299608470
  error estimate for blocks of size 2^( 8) =       0.000301766193

      target function =                  N/A
              le_mean =     -17.216543652013
             les_mean =     296.755694196674
             stat err =       0.000299283657
             autocorr =       1.173764483835
              std dev =       0.552487575014
             le_variance =       0.305242520545


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216574276856        initial  <--
     2.4414e-02     2.4414e-01             1.5578e-03       -17.216537351954
     9.7656e-02     9.7656e-01             1.0974e-03       -17.216563391949
     3.9062e-01     3.9062e+00             6.1211e-04       -17.216543652013

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.1354
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -4.018007e-02 3 1  ON 0
ci_002                -2.968700e-02 3 1  ON 1
ci_003                -2.544653e-02 3 1  ON 2
ci_004                 2.053346e-02 3 1  ON 3
ci_005                 2.143750e-02 3 1  ON 4
ci_006                -1.891819e-02 3 1  ON 5
ci_007                -1.884088e-02 3 1  ON 6
ci_008                -1.770596e-02 3 1  ON 7
ci_009                -1.755364e-02 3 1  ON 8
ci_010                -1.744198e-02 3 1  ON 9
ci_011                -1.627819e-02 3 1  ON 10
ci_012                -1.627888e-02 3 1  ON 11
ci_013                -1.962394e-02 3 1  ON 12
ci_014                 1.403588e-02 3 1  ON 13
ci_015                 1.383675e-02 3 1  ON 14
ci_016                 1.683835e-02 3 1  ON 15
ci_017                 1.604490e-02 3 1  ON 16
ci_018                 1.236887e-02 3 1  ON 17
ci_019                 1.277427e-02 3 1  ON 18
ci_020                 1.249209e-02 3 1  ON 19
ci_021                 1.304975e-02 3 1  ON 20
ci_022                 1.124670e-02 3 1  ON 21
ci_023                 1.132412e-02 3 1  ON 22
ci_024                 1.188923e-02 3 1  ON 23
ci_025                 1.171682e-02 3 1  ON 24
ci_026                 1.128936e-02 3 1  ON 25
ci_027                 1.099724e-02 3 1  ON 26
ci_028                -1.448365e-02 3 1  ON 27
ci_029                -1.458460e-02 3 1  ON 28
ci_030                -1.111043e-02 3 1  ON 29
ci_031                -1.131224e-02 3 1  ON 30
ci_032                -1.359838e-02 3 1  ON 31
ci_033                 1.051937e-02 3 1  ON 32
ci_034                 1.020799e-02 3 1  ON 33
ci_035                -4.615989e-03 3 1  ON 34
ci_036                -1.034018e-02 3 1  ON 35
ci_037                -1.030394e-02 3 1  ON 36
ci_038                 1.449846e-03 3 1  ON 37
ci_039                 1.731963e-03 3 1  ON 38
ci_040                -4.006157e-03 3 1  ON 39
ci_041                 9.871134e-03 3 1  ON 40
ci_042                 9.789246e-03 3 1  ON 41
ci_043                -3.041192e-03 3 1  ON 42
ci_044                -1.503438e-02 3 1  ON 43
ci_045                -1.747812e-03 3 1  ON 44
ci_046                 5.366192e-03 3 1  ON 45
ci_047                 5.685628e-03 3 1  ON 46
ci_048                -1.188221e-02 3 1  ON 47
ci_049                -1.118070e-02 3 1  ON 48
ci_050                 7.567719e-03 3 1  ON 49
ci_051                 7.561549e-03 3 1  ON 50
ci_052                -6.573141e-03 3 1  ON 51
ci_053                -6.378509e-03 3 1  ON 52
ci_054                -2.796721e-03 3 1  ON 53
ci_055                -2.857217e-03 3 1  ON 54
ci_056                 4.947794e-03 3 1  ON 55
ci_057                 4.718261e-03 3 1  ON 56
ci_058                -6.930343e-03 3 1  ON 57
ci_059                -6.097356e-03 3 1  ON 58
ci_060                 8.793988e-03 3 1  ON 59
ci_061                 8.613088e-03 3 1  ON 60
ci_062                -3.428810e-03 3 1  ON 61
ci_063                -3.208294e-03 3 1  ON 62
ci_064                -3.137142e-03 3 1  ON 63
ci_065                -3.962152e-03 3 1  ON 64
ci_066                 5.320639e-03 3 1  ON 65
ci_067                 5.897450e-03 3 1  ON 66
ci_068                -4.761360e-03 3 1  ON 67
ci_069                -4.577922e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7276e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1492
    reference variance = 1.14694
====================================================
  Execution time = 2.6879e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0588e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1249e-01
  Total weights = 3.913614726e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9847e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297587786648
                                         uncertainty =       0.001328617810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297587786648
                                         uncertainty =       0.001328617810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272761659
  error estimate for blocks of size 2^( 2) =       0.000279855982
  error estimate for blocks of size 2^( 3) =       0.000286025740
  error estimate for blocks of size 2^( 4) =       0.000290641539
  error estimate for blocks of size 2^( 5) =       0.000293677056
  error estimate for blocks of size 2^( 6) =       0.000295715053
  error estimate for blocks of size 2^( 7) =       0.000296790563
  error estimate for blocks of size 2^( 8) =       0.000296197681

      target function =                  N/A
              le_mean =     -17.216389838683
             les_mean =     296.716572085914
             stat err =       0.000295595088
             autocorr =       1.174431735740
              std dev =       0.545523318947
             le_variance =       0.297595691514


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721638983868e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216389838715       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216392557715       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216392541036       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216392636238       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 5.647941e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216389838715       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216390923879       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216390888926       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216390889455       residual = 2.51e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 2.195428e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216389838715       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216390157545       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216390145490       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216390138499       residual = 3.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 6.370447e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.328976 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1877e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -4.020829e-02 3 1  ON 0
ci_002                -2.977650e-02 3 1  ON 1
ci_003                -2.555701e-02 3 1  ON 2
ci_004                 2.062052e-02 3 1  ON 3
ci_005                 2.145357e-02 3 1  ON 4
ci_006                -1.905365e-02 3 1  ON 5
ci_007                -1.881601e-02 3 1  ON 6
ci_008                -1.766885e-02 3 1  ON 7
ci_009                -1.761148e-02 3 1  ON 8
ci_010                -1.758809e-02 3 1  ON 9
ci_011                -1.627747e-02 3 1  ON 10
ci_012                -1.618567e-02 3 1  ON 11
ci_013                -1.943167e-02 3 1  ON 12
ci_014                 1.385587e-02 3 1  ON 13
ci_015                 1.387344e-02 3 1  ON 14
ci_016                 1.682758e-02 3 1  ON 15
ci_017                 1.610979e-02 3 1  ON 16
ci_018                 1.239358e-02 3 1  ON 17
ci_019                 1.269420e-02 3 1  ON 18
ci_020                 1.252422e-02 3 1  ON 19
ci_021                 1.303433e-02 3 1  ON 20
ci_022                 1.111578e-02 3 1  ON 21
ci_023                 1.132178e-02 3 1  ON 22
ci_024                 1.169410e-02 3 1  ON 23
ci_025                 1.171780e-02 3 1  ON 24
ci_026                 1.120156e-02 3 1  ON 25
ci_027                 1.095452e-02 3 1  ON 26
ci_028                -1.453024e-02 3 1  ON 27
ci_029                -1.452806e-02 3 1  ON 28
ci_030                -1.113864e-02 3 1  ON 29
ci_031                -1.119076e-02 3 1  ON 30
ci_032                -1.366431e-02 3 1  ON 31
ci_033                 1.038033e-02 3 1  ON 32
ci_034                 9.988446e-03 3 1  ON 33
ci_035                -4.546558e-03 3 1  ON 34
ci_036                -1.035664e-02 3 1  ON 35
ci_037                -1.043935e-02 3 1  ON 36
ci_038                 1.504093e-03 3 1  ON 37
ci_039                 1.729000e-03 3 1  ON 38
ci_040                -3.964163e-03 3 1  ON 39
ci_041                 9.892151e-03 3 1  ON 40
ci_042                 9.773205e-03 3 1  ON 41
ci_043                -3.097739e-03 3 1  ON 42
ci_044                -1.509596e-02 3 1  ON 43
ci_045                -1.826997e-03 3 1  ON 44
ci_046                 5.271163e-03 3 1  ON 45
ci_047                 5.639497e-03 3 1  ON 46
ci_048                -1.184328e-02 3 1  ON 47
ci_049                -1.127218e-02 3 1  ON 48
ci_050                 7.457725e-03 3 1  ON 49
ci_051                 7.691859e-03 3 1  ON 50
ci_052                -6.544976e-03 3 1  ON 51
ci_053                -6.550750e-03 3 1  ON 52
ci_054                -2.829532e-03 3 1  ON 53
ci_055                -3.034604e-03 3 1  ON 54
ci_056                 4.847558e-03 3 1  ON 55
ci_057                 4.727388e-03 3 1  ON 56
ci_058                -7.041231e-03 3 1  ON 57
ci_059                -6.162883e-03 3 1  ON 58
ci_060                 8.674134e-03 3 1  ON 59
ci_061                 8.469287e-03 3 1  ON 60
ci_062                -3.452068e-03 3 1  ON 61
ci_063                -3.228581e-03 3 1  ON 62
ci_064                -3.171797e-03 3 1  ON 63
ci_065                -3.928047e-03 3 1  ON 64
ci_066                 5.431852e-03 3 1  ON 65
ci_067                 5.824461e-03 3 1  ON 66
ci_068                -4.749330e-03 3 1  ON 67
ci_069                -4.683286e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1498
    reference variance = 0.346597
====================================================
  Execution time = 2.6812e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1342e-01
  Total weights = 3.9132e+06
  Execution time = 3.6432e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299447565767
                                         uncertainty =       0.001466844252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299447565767
                                         uncertainty =       0.001466844252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273591953
  error estimate for blocks of size 2^( 2) =       0.000280633256
  error estimate for blocks of size 2^( 3) =       0.000286936811
  error estimate for blocks of size 2^( 4) =       0.000291569974
  error estimate for blocks of size 2^( 5) =       0.000294655511
  error estimate for blocks of size 2^( 6) =       0.000296539394
  error estimate for blocks of size 2^( 7) =       0.000297153399
  error estimate for blocks of size 2^( 8) =       0.000297838138

      target function =                  N/A
              le_mean =     -17.216250636476
             les_mean =     296.713348312117
             stat err =       0.000296546610
             autocorr =       1.174841525911
              std dev =       0.547183906644
             le_variance =       0.299410227690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299240758252
                                         uncertainty =       0.001443259776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299240758252
                                         uncertainty =       0.001443259776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273497333
  error estimate for blocks of size 2^( 2) =       0.000280549058
  error estimate for blocks of size 2^( 3) =       0.000286860804
  error estimate for blocks of size 2^( 4) =       0.000291503118
  error estimate for blocks of size 2^( 5) =       0.000294593206
  error estimate for blocks of size 2^( 6) =       0.000296490214
  error estimate for blocks of size 2^( 7) =       0.000297091706
  error estimate for blocks of size 2^( 8) =       0.000297770250

      target function =                  N/A
              le_mean =     -17.216254394934
             les_mean =     296.772083749282
             stat err =       0.000296486344
             autocorr =       1.175176769588
              std dev =       0.546994665876
             le_variance =       0.299203164496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299265455803
                                         uncertainty =       0.001446963924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299265455803
                                         uncertainty =       0.001446963924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273508641
  error estimate for blocks of size 2^( 2) =       0.000280558727
  error estimate for blocks of size 2^( 3) =       0.000286868321
  error estimate for blocks of size 2^( 4) =       0.000291508954
  error estimate for blocks of size 2^( 5) =       0.000294598985
  error estimate for blocks of size 2^( 6) =       0.000296492434
  error estimate for blocks of size 2^( 7) =       0.000297096140
  error estimate for blocks of size 2^( 8) =       0.000297775427

      target function =                  N/A
              le_mean =     -17.216252274414
             les_mean =     296.714458359008
             stat err =       0.000296490747
             autocorr =       1.175114494699
              std dev =       0.547017282538
             le_variance =       0.299227907395

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299414253410
                                         uncertainty =       0.001463667042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299414253410
                                         uncertainty =       0.001463667042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273576717
  error estimate for blocks of size 2^( 2) =       0.000280619449
  error estimate for blocks of size 2^( 3) =       0.000286923862
  error estimate for blocks of size 2^( 4) =       0.000291558102
  error estimate for blocks of size 2^( 5) =       0.000294644150
  error estimate for blocks of size 2^( 6) =       0.000296530443
  error estimate for blocks of size 2^( 7) =       0.000297142983
  error estimate for blocks of size 2^( 8) =       0.000297827149

      target function =                  N/A
              le_mean =     -17.216250121571
             les_mean =     296.712986075862
             stat err =       0.000296536181
             autocorr =       1.174889749897
              std dev =       0.547153433284
             le_variance =       0.299376879554


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216250636476        initial
     2.4414e-01     2.4414e+00             5.6479e-04       -17.216254394934  <--
     9.7656e-01     9.7656e+00             2.1954e-04       -17.216252274414
     3.9062e+00     3.9062e+01             6.3704e-05       -17.216250121571

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 4.5200e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -4.023549e-02 3 1  ON 0
ci_002                -2.991019e-02 3 1  ON 1
ci_003                -2.574054e-02 3 1  ON 2
ci_004                 2.077849e-02 3 1  ON 3
ci_005                 2.148085e-02 3 1  ON 4
ci_006                -1.927152e-02 3 1  ON 5
ci_007                -1.877388e-02 3 1  ON 6
ci_008                -1.762581e-02 3 1  ON 7
ci_009                -1.767303e-02 3 1  ON 8
ci_010                -1.782915e-02 3 1  ON 9
ci_011                -1.627839e-02 3 1  ON 10
ci_012                -1.604015e-02 3 1  ON 11
ci_013                -1.907293e-02 3 1  ON 12
ci_014                 1.359524e-02 3 1  ON 13
ci_015                 1.394227e-02 3 1  ON 14
ci_016                 1.680326e-02 3 1  ON 15
ci_017                 1.621298e-02 3 1  ON 16
ci_018                 1.242854e-02 3 1  ON 17
ci_019                 1.257586e-02 3 1  ON 18
ci_020                 1.257069e-02 3 1  ON 19
ci_021                 1.299552e-02 3 1  ON 20
ci_022                 1.092435e-02 3 1  ON 21
ci_023                 1.132408e-02 3 1  ON 22
ci_024                 1.133304e-02 3 1  ON 23
ci_025                 1.171305e-02 3 1  ON 24
ci_026                 1.106929e-02 3 1  ON 25
ci_027                 1.088883e-02 3 1  ON 26
ci_028                -1.459765e-02 3 1  ON 27
ci_029                -1.442639e-02 3 1  ON 28
ci_030                -1.119059e-02 3 1  ON 29
ci_031                -1.099812e-02 3 1  ON 30
ci_032                -1.375640e-02 3 1  ON 31
ci_033                 1.016841e-02 3 1  ON 32
ci_034                 9.643194e-03 3 1  ON 33
ci_035                -4.464713e-03 3 1  ON 34
ci_036                -1.038288e-02 3 1  ON 35
ci_037                -1.065927e-02 3 1  ON 36
ci_038                 1.565984e-03 3 1  ON 37
ci_039                 1.724232e-03 3 1  ON 38
ci_040                -3.915718e-03 3 1  ON 39
ci_041                 9.921191e-03 3 1  ON 40
ci_042                 9.749479e-03 3 1  ON 41
ci_043                -3.166425e-03 3 1  ON 42
ci_044                -1.520024e-02 3 1  ON 43
ci_045                -1.916201e-03 3 1  ON 44
ci_046                 5.133277e-03 3 1  ON 45
ci_047                 5.570178e-03 3 1  ON 46
ci_048                -1.176002e-02 3 1  ON 47
ci_049                -1.142159e-02 3 1  ON 48
ci_050                 7.317095e-03 3 1  ON 49
ci_051                 7.851401e-03 3 1  ON 50
ci_052                -6.506662e-03 3 1  ON 51
ci_053                -6.775135e-03 3 1  ON 52
ci_054                -2.877242e-03 3 1  ON 53
ci_055                -3.278100e-03 3 1  ON 54
ci_056                 4.720629e-03 3 1  ON 55
ci_057                 4.739133e-03 3 1  ON 56
ci_058                -7.193727e-03 3 1  ON 57
ci_059                -6.254752e-03 3 1  ON 58
ci_060                 8.494859e-03 3 1  ON 59
ci_061                 8.252293e-03 3 1  ON 60
ci_062                -3.483542e-03 3 1  ON 61
ci_063                -3.257897e-03 3 1  ON 62
ci_064                -3.205890e-03 3 1  ON 63
ci_065                -3.893631e-03 3 1  ON 64
ci_066                 5.567865e-03 3 1  ON 65
ci_067                 5.735748e-03 3 1  ON 66
ci_068                -4.727321e-03 3 1  ON 67
ci_069                -4.846565e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7188e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2261
    reference variance = 0.756784
====================================================
  Execution time = 2.7275e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0546e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1842e-01
  Total weights = 3.913494770e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9516e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304000953740
                                         uncertainty =       0.002682625429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304000953740
                                         uncertainty =       0.002682625429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275693713
  error estimate for blocks of size 2^( 2) =       0.000282841672
  error estimate for blocks of size 2^( 3) =       0.000289201780
  error estimate for blocks of size 2^( 4) =       0.000293677053
  error estimate for blocks of size 2^( 5) =       0.000296381038
  error estimate for blocks of size 2^( 6) =       0.000297688063
  error estimate for blocks of size 2^( 7) =       0.000297890137
  error estimate for blocks of size 2^( 8) =       0.000299030096

      target function =                  N/A
              le_mean =     -17.216440256163
             les_mean =     296.724235548591
             stat err =       0.000297747333
             autocorr =       1.166385297710
              std dev =       0.551387425892
             le_variance =       0.304028093432


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721644025616e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216440256187       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216442256145       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216444064674       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216444372341       residual = 8.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-02 is 8.492982e-04

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216440256187       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216441518917       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216442155085       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216442180814       residual = 6.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 5.555633e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216440256187       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216440766487       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216440812535       residual = 6.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 2.335353e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.333230 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2240e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -4.026565e-02 3 1  ON 0
ci_002                -2.984528e-02 3 1  ON 1
ci_003                -2.562938e-02 3 1  ON 2
ci_004                 2.113085e-02 3 1  ON 3
ci_005                 2.110820e-02 3 1  ON 4
ci_006                -1.904650e-02 3 1  ON 5
ci_007                -1.870909e-02 3 1  ON 6
ci_008                -1.769974e-02 3 1  ON 7
ci_009                -1.711747e-02 3 1  ON 8
ci_010                -1.763430e-02 3 1  ON 9
ci_011                -1.660769e-02 3 1  ON 10
ci_012                -1.628003e-02 3 1  ON 11
ci_013                -1.933614e-02 3 1  ON 12
ci_014                 1.368971e-02 3 1  ON 13
ci_015                 1.402748e-02 3 1  ON 14
ci_016                 1.664215e-02 3 1  ON 15
ci_017                 1.633142e-02 3 1  ON 16
ci_018                 1.226226e-02 3 1  ON 17
ci_019                 1.273687e-02 3 1  ON 18
ci_020                 1.268589e-02 3 1  ON 19
ci_021                 1.257096e-02 3 1  ON 20
ci_022                 1.114118e-02 3 1  ON 21
ci_023                 1.111038e-02 3 1  ON 22
ci_024                 1.157106e-02 3 1  ON 23
ci_025                 1.133523e-02 3 1  ON 24
ci_026                 1.096940e-02 3 1  ON 25
ci_027                 1.077611e-02 3 1  ON 26
ci_028                -1.452494e-02 3 1  ON 27
ci_029                -1.437517e-02 3 1  ON 28
ci_030                -1.092116e-02 3 1  ON 29
ci_031                -1.096538e-02 3 1  ON 30
ci_032                -1.367485e-02 3 1  ON 31
ci_033                 1.054232e-02 3 1  ON 32
ci_034                 9.746558e-03 3 1  ON 33
ci_035                -4.701395e-03 3 1  ON 34
ci_036                -1.026930e-02 3 1  ON 35
ci_037                -1.066379e-02 3 1  ON 36
ci_038                 1.588824e-03 3 1  ON 37
ci_039                 1.854388e-03 3 1  ON 38
ci_040                -3.951256e-03 3 1  ON 39
ci_041                 9.763819e-03 3 1  ON 40
ci_042                 1.000184e-02 3 1  ON 41
ci_043                -3.038461e-03 3 1  ON 42
ci_044                -1.540586e-02 3 1  ON 43
ci_045                -1.765811e-03 3 1  ON 44
ci_046                 5.068094e-03 3 1  ON 45
ci_047                 5.711683e-03 3 1  ON 46
ci_048                -1.202399e-02 3 1  ON 47
ci_049                -1.132508e-02 3 1  ON 48
ci_050                 7.521744e-03 3 1  ON 49
ci_051                 7.921527e-03 3 1  ON 50
ci_052                -6.279690e-03 3 1  ON 51
ci_053                -6.445232e-03 3 1  ON 52
ci_054                -2.866198e-03 3 1  ON 53
ci_055                -3.329721e-03 3 1  ON 54
ci_056                 4.728454e-03 3 1  ON 55
ci_057                 5.083273e-03 3 1  ON 56
ci_058                -6.757158e-03 3 1  ON 57
ci_059                -6.253481e-03 3 1  ON 58
ci_060                 8.166020e-03 3 1  ON 59
ci_061                 8.419282e-03 3 1  ON 60
ci_062                -3.276838e-03 3 1  ON 61
ci_063                -3.052500e-03 3 1  ON 62
ci_064                -3.101942e-03 3 1  ON 63
ci_065                -3.921365e-03 3 1  ON 64
ci_066                 5.825970e-03 3 1  ON 65
ci_067                 5.723158e-03 3 1  ON 66
ci_068                -5.072844e-03 3 1  ON 67
ci_069                -4.790544e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.3407
    reference variance = 0.340054
====================================================
  Execution time = 2.6715e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1534e-01
  Total weights = 3.9132e+06
  Execution time = 3.6454e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.148521
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299637566640
                                         uncertainty =       0.001488881978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299637566640
                                         uncertainty =       0.001488881978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273669611
  error estimate for blocks of size 2^( 2) =       0.000280661451
  error estimate for blocks of size 2^( 3) =       0.000287176214
  error estimate for blocks of size 2^( 4) =       0.000292077634
  error estimate for blocks of size 2^( 5) =       0.000295184317
  error estimate for blocks of size 2^( 6) =       0.000297210231
  error estimate for blocks of size 2^( 7) =       0.000298439424
  error estimate for blocks of size 2^( 8) =       0.000300477045

      target function =                  N/A
              le_mean =     -17.216476534898
             les_mean =     296.728754935220
             stat err =       0.000297827754
             autocorr =       1.184342148054
              std dev =       0.547339221357
             le_variance =       0.299580223236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299766633157
                                         uncertainty =       0.001493282211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299766633157
                                         uncertainty =       0.001493282211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273728970
  error estimate for blocks of size 2^( 2) =       0.000280720160
  error estimate for blocks of size 2^( 3) =       0.000287235584
  error estimate for blocks of size 2^( 4) =       0.000292138275
  error estimate for blocks of size 2^( 5) =       0.000295248357
  error estimate for blocks of size 2^( 6) =       0.000297285249
  error estimate for blocks of size 2^( 7) =       0.000298524504
  error estimate for blocks of size 2^( 8) =       0.000300550562

      target function =                  N/A
              le_mean =     -17.216489457645
             les_mean =     296.725987086008
             stat err =       0.000297902168
             autocorr =       1.184420190192
              std dev =       0.547457939449
             le_variance =       0.299710195466

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.153463
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301015261434
                                         uncertainty =       0.001907415684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301015261434
                                         uncertainty =       0.001907415684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274297637
  error estimate for blocks of size 2^( 2) =       0.000281279010
  error estimate for blocks of size 2^( 3) =       0.000287775292
  error estimate for blocks of size 2^( 4) =       0.000292655239
  error estimate for blocks of size 2^( 5) =       0.000295726474
  error estimate for blocks of size 2^( 6) =       0.000297693081
  error estimate for blocks of size 2^( 7) =       0.000298842510
  error estimate for blocks of size 2^( 8) =       0.000300821718

      target function =                  N/A
              le_mean =     -17.216490864625
             les_mean =     297.263921415935
             stat err =       0.000298270946
             autocorr =       1.182436340770
              std dev =       0.548595274595
             le_variance =       0.300956775308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299608408926
                                         uncertainty =       0.001484220075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299608408926
                                         uncertainty =       0.001484220075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273656432
  error estimate for blocks of size 2^( 2) =       0.000280648860
  error estimate for blocks of size 2^( 3) =       0.000287163409
  error estimate for blocks of size 2^( 4) =       0.000292064827
  error estimate for blocks of size 2^( 5) =       0.000295170998
  error estimate for blocks of size 2^( 6) =       0.000297200449
  error estimate for blocks of size 2^( 7) =       0.000298431381
  error estimate for blocks of size 2^( 8) =       0.000300458560

      target function =                  N/A
              le_mean =     -17.216475075278
             les_mean =     296.723973431260
             stat err =       0.000297815347
             autocorr =       1.184357533599
              std dev =       0.547312864507
             le_variance =       0.299551371655


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216476534898        initial
     6.1035e-02     6.1035e-01             8.4930e-04       -17.216489457645
     2.4414e-01     2.4414e+00             5.5556e-04       -17.216490864625  <--
     9.7656e-01     9.7656e+00             2.3354e-04       -17.216475075278

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 4.5089e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -4.026565e-02 3 1  ON 0
ci_002                -2.984528e-02 3 1  ON 1
ci_003                -2.562938e-02 3 1  ON 2
ci_004                 2.113085e-02 3 1  ON 3
ci_005                 2.110820e-02 3 1  ON 4
ci_006                -1.904650e-02 3 1  ON 5
ci_007                -1.870909e-02 3 1  ON 6
ci_008                -1.769974e-02 3 1  ON 7
ci_009                -1.711747e-02 3 1  ON 8
ci_010                -1.763430e-02 3 1  ON 9
ci_011                -1.660769e-02 3 1  ON 10
ci_012                -1.628003e-02 3 1  ON 11
ci_013                -1.933614e-02 3 1  ON 12
ci_014                 1.368971e-02 3 1  ON 13
ci_015                 1.402748e-02 3 1  ON 14
ci_016                 1.664215e-02 3 1  ON 15
ci_017                 1.633142e-02 3 1  ON 16
ci_018                 1.226226e-02 3 1  ON 17
ci_019                 1.273687e-02 3 1  ON 18
ci_020                 1.268589e-02 3 1  ON 19
ci_021                 1.257096e-02 3 1  ON 20
ci_022                 1.114118e-02 3 1  ON 21
ci_023                 1.111038e-02 3 1  ON 22
ci_024                 1.157106e-02 3 1  ON 23
ci_025                 1.133523e-02 3 1  ON 24
ci_026                 1.096940e-02 3 1  ON 25
ci_027                 1.077611e-02 3 1  ON 26
ci_028                -1.452494e-02 3 1  ON 27
ci_029                -1.437517e-02 3 1  ON 28
ci_030                -1.092116e-02 3 1  ON 29
ci_031                -1.096538e-02 3 1  ON 30
ci_032                -1.367485e-02 3 1  ON 31
ci_033                 1.054232e-02 3 1  ON 32
ci_034                 9.746558e-03 3 1  ON 33
ci_035                -4.701395e-03 3 1  ON 34
ci_036                -1.026930e-02 3 1  ON 35
ci_037                -1.066379e-02 3 1  ON 36
ci_038                 1.588824e-03 3 1  ON 37
ci_039                 1.854388e-03 3 1  ON 38
ci_040                -3.951256e-03 3 1  ON 39
ci_041                 9.763819e-03 3 1  ON 40
ci_042                 1.000184e-02 3 1  ON 41
ci_043                -3.038461e-03 3 1  ON 42
ci_044                -1.540586e-02 3 1  ON 43
ci_045                -1.765811e-03 3 1  ON 44
ci_046                 5.068094e-03 3 1  ON 45
ci_047                 5.711683e-03 3 1  ON 46
ci_048                -1.202399e-02 3 1  ON 47
ci_049                -1.132508e-02 3 1  ON 48
ci_050                 7.521744e-03 3 1  ON 49
ci_051                 7.921527e-03 3 1  ON 50
ci_052                -6.279690e-03 3 1  ON 51
ci_053                -6.445232e-03 3 1  ON 52
ci_054                -2.866198e-03 3 1  ON 53
ci_055                -3.329721e-03 3 1  ON 54
ci_056                 4.728454e-03 3 1  ON 55
ci_057                 5.083273e-03 3 1  ON 56
ci_058                -6.757158e-03 3 1  ON 57
ci_059                -6.253481e-03 3 1  ON 58
ci_060                 8.166020e-03 3 1  ON 59
ci_061                 8.419282e-03 3 1  ON 60
ci_062                -3.276838e-03 3 1  ON 61
ci_063                -3.052500e-03 3 1  ON 62
ci_064                -3.101942e-03 3 1  ON 63
ci_065                -3.921365e-03 3 1  ON 64
ci_066                 5.825970e-03 3 1  ON 65
ci_067                 5.723158e-03 3 1  ON 66
ci_068                -5.072844e-03 3 1  ON 67
ci_069                -4.790544e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7459e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1693
    reference variance = 0.189317
====================================================
  Execution time = 2.7071e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0575e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1417e-01
  Total weights = 3.913221278e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9640e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299537465444
                                         uncertainty =       0.001447550053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299537465444
                                         uncertainty =       0.001447550053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273712935
  error estimate for blocks of size 2^( 2) =       0.000280750200
  error estimate for blocks of size 2^( 3) =       0.000287138320
  error estimate for blocks of size 2^( 4) =       0.000292336359
  error estimate for blocks of size 2^( 5) =       0.000295378759
  error estimate for blocks of size 2^( 6) =       0.000297164773
  error estimate for blocks of size 2^( 7) =       0.000298248734
  error estimate for blocks of size 2^( 8) =       0.000297622234

      target function =                  N/A
              le_mean =     -17.215938083171
             les_mean =     296.702698156037
             stat err =       0.000297103625
             autocorr =       1.178216928669
              std dev =       0.547425869771
             le_variance =       0.299675082894


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721593808317e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215938083188       residual = 7.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215951132820       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215949817998       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215949790462       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215949856470       residual = 5.06e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-02 is 1.144301e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215938083188       residual = 7.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215946241235       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215945473855       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215945451637       residual = 1.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 6.185194e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215938083188       residual = 7.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215941347214       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215941101254       residual = 7.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 2.179933e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.334634 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2043e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -4.016807e-02 3 1  ON 0
ci_002                -2.998020e-02 3 1  ON 1
ci_003                -2.513610e-02 3 1  ON 2
ci_004                 2.095249e-02 3 1  ON 3
ci_005                 2.111295e-02 3 1  ON 4
ci_006                -1.891760e-02 3 1  ON 5
ci_007                -1.898627e-02 3 1  ON 6
ci_008                -1.792198e-02 3 1  ON 7
ci_009                -1.753761e-02 3 1  ON 8
ci_010                -1.742824e-02 3 1  ON 9
ci_011                -1.663844e-02 3 1  ON 10
ci_012                -1.618412e-02 3 1  ON 11
ci_013                -1.950581e-02 3 1  ON 12
ci_014                 1.400170e-02 3 1  ON 13
ci_015                 1.415193e-02 3 1  ON 14
ci_016                 1.653420e-02 3 1  ON 15
ci_017                 1.668367e-02 3 1  ON 16
ci_018                 1.259467e-02 3 1  ON 17
ci_019                 1.266762e-02 3 1  ON 18
ci_020                 1.285438e-02 3 1  ON 19
ci_021                 1.266171e-02 3 1  ON 20
ci_022                 1.125844e-02 3 1  ON 21
ci_023                 1.101755e-02 3 1  ON 22
ci_024                 1.161770e-02 3 1  ON 23
ci_025                 1.148728e-02 3 1  ON 24
ci_026                 1.073467e-02 3 1  ON 25
ci_027                 1.089527e-02 3 1  ON 26
ci_028                -1.449579e-02 3 1  ON 27
ci_029                -1.439114e-02 3 1  ON 28
ci_030                -1.132206e-02 3 1  ON 29
ci_031                -1.134612e-02 3 1  ON 30
ci_032                -1.368438e-02 3 1  ON 31
ci_033                 1.049583e-02 3 1  ON 32
ci_034                 9.879892e-03 3 1  ON 33
ci_035                -4.557282e-03 3 1  ON 34
ci_036                -1.056856e-02 3 1  ON 35
ci_037                -1.062862e-02 3 1  ON 36
ci_038                 1.457250e-03 3 1  ON 37
ci_039                 1.682635e-03 3 1  ON 38
ci_040                -3.972871e-03 3 1  ON 39
ci_041                 9.687345e-03 3 1  ON 40
ci_042                 9.839303e-03 3 1  ON 41
ci_043                -3.130922e-03 3 1  ON 42
ci_044                -1.530826e-02 3 1  ON 43
ci_045                -1.669377e-03 3 1  ON 44
ci_046                 5.249772e-03 3 1  ON 45
ci_047                 5.430935e-03 3 1  ON 46
ci_048                -1.210305e-02 3 1  ON 47
ci_049                -1.194360e-02 3 1  ON 48
ci_050                 7.684679e-03 3 1  ON 49
ci_051                 7.945507e-03 3 1  ON 50
ci_052                -6.428868e-03 3 1  ON 51
ci_053                -6.527136e-03 3 1  ON 52
ci_054                -2.768883e-03 3 1  ON 53
ci_055                -3.290766e-03 3 1  ON 54
ci_056                 4.614166e-03 3 1  ON 55
ci_057                 4.719996e-03 3 1  ON 56
ci_058                -6.610978e-03 3 1  ON 57
ci_059                -6.506612e-03 3 1  ON 58
ci_060                 8.348791e-03 3 1  ON 59
ci_061                 8.638963e-03 3 1  ON 60
ci_062                -3.221964e-03 3 1  ON 61
ci_063                -3.448947e-03 3 1  ON 62
ci_064                -2.973207e-03 3 1  ON 63
ci_065                -4.121197e-03 3 1  ON 64
ci_066                 5.719571e-03 3 1  ON 65
ci_067                 5.775038e-03 3 1  ON 66
ci_068                -5.032790e-03 3 1  ON 67
ci_069                -4.680880e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1847
    reference variance = 0.333681
====================================================
  Execution time = 2.8978e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1291e-01
  Total weights = 3.9135e+06
  Execution time = 3.6407e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00800427
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298355667369
                                         uncertainty =       0.001385512417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298355667369
                                         uncertainty =       0.001385512417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273116386
  error estimate for blocks of size 2^( 2) =       0.000280316789
  error estimate for blocks of size 2^( 3) =       0.000286620390
  error estimate for blocks of size 2^( 4) =       0.000291370501
  error estimate for blocks of size 2^( 5) =       0.000294176067
  error estimate for blocks of size 2^( 6) =       0.000295747707
  error estimate for blocks of size 2^( 7) =       0.000296869696
  error estimate for blocks of size 2^( 8) =       0.000297267008

      target function =                  N/A
              le_mean =     -17.216437965859
             les_mean =     296.747161945486
             stat err =       0.000296015119
             autocorr =       1.174714350481
              std dev =       0.546232771696
             le_variance =       0.298370240875

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0574497
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298838514570
                                         uncertainty =       0.001407447263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298838514570
                                         uncertainty =       0.001407447263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273337028
  error estimate for blocks of size 2^( 2) =       0.000280519470
  error estimate for blocks of size 2^( 3) =       0.000286801404
  error estimate for blocks of size 2^( 4) =       0.000291526916
  error estimate for blocks of size 2^( 5) =       0.000294321556
  error estimate for blocks of size 2^( 6) =       0.000295890121
  error estimate for blocks of size 2^( 7) =       0.000297005405
  error estimate for blocks of size 2^( 8) =       0.000297369728

      target function =                  N/A
              le_mean =     -17.216435059807
             les_mean =     296.722819784687
             stat err =       0.000296146702
             autocorr =       1.173861520906
              std dev =       0.546674055743
             le_variance =       0.298852523222

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00789463
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299082627186
                                         uncertainty =       0.001416242460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299082627186
                                         uncertainty =       0.001416242460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273448539
  error estimate for blocks of size 2^( 2) =       0.000280624701
  error estimate for blocks of size 2^( 3) =       0.000286900261
  error estimate for blocks of size 2^( 4) =       0.000291619847
  error estimate for blocks of size 2^( 5) =       0.000294408991
  error estimate for blocks of size 2^( 6) =       0.000295979247
  error estimate for blocks of size 2^( 7) =       0.000297094025
  error estimate for blocks of size 2^( 8) =       0.000297462248

      target function =                  N/A
              le_mean =     -17.216439308577
             les_mean =     296.724222347149
             stat err =       0.000296236128
             autocorr =       1.173612782145
              std dev =       0.546897077405
             le_variance =       0.299096413274

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0592877
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298454271281
                                         uncertainty =       0.001389730324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298454271281
                                         uncertainty =       0.001389730324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273161461
  error estimate for blocks of size 2^( 2) =       0.000280358039
  error estimate for blocks of size 2^( 3) =       0.000286655519
  error estimate for blocks of size 2^( 4) =       0.000291392392
  error estimate for blocks of size 2^( 5) =       0.000294197110
  error estimate for blocks of size 2^( 6) =       0.000295766831
  error estimate for blocks of size 2^( 7) =       0.000296885359
  error estimate for blocks of size 2^( 8) =       0.000297274306

      target function =                  N/A
              le_mean =     -17.216433070671
             les_mean =     296.721296290603
             stat err =       0.000296030902
             autocorr =       1.174451915877
              std dev =       0.546322922749
             le_variance =       0.298468735921


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216437965859        initial
     6.1035e-02     6.1035e-01             1.1443e-03       -17.216435059807
     2.4414e-01     2.4414e+00             6.1852e-04       -17.216439308577  <--
     9.7656e-01     9.7656e+00             2.1799e-04       -17.216433070671

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 4.7354e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -4.016807e-02 3 1  ON 0
ci_002                -2.998020e-02 3 1  ON 1
ci_003                -2.513610e-02 3 1  ON 2
ci_004                 2.095249e-02 3 1  ON 3
ci_005                 2.111295e-02 3 1  ON 4
ci_006                -1.891760e-02 3 1  ON 5
ci_007                -1.898627e-02 3 1  ON 6
ci_008                -1.792198e-02 3 1  ON 7
ci_009                -1.753761e-02 3 1  ON 8
ci_010                -1.742824e-02 3 1  ON 9
ci_011                -1.663844e-02 3 1  ON 10
ci_012                -1.618412e-02 3 1  ON 11
ci_013                -1.950581e-02 3 1  ON 12
ci_014                 1.400170e-02 3 1  ON 13
ci_015                 1.415193e-02 3 1  ON 14
ci_016                 1.653420e-02 3 1  ON 15
ci_017                 1.668367e-02 3 1  ON 16
ci_018                 1.259467e-02 3 1  ON 17
ci_019                 1.266762e-02 3 1  ON 18
ci_020                 1.285438e-02 3 1  ON 19
ci_021                 1.266171e-02 3 1  ON 20
ci_022                 1.125844e-02 3 1  ON 21
ci_023                 1.101755e-02 3 1  ON 22
ci_024                 1.161770e-02 3 1  ON 23
ci_025                 1.148728e-02 3 1  ON 24
ci_026                 1.073467e-02 3 1  ON 25
ci_027                 1.089527e-02 3 1  ON 26
ci_028                -1.449579e-02 3 1  ON 27
ci_029                -1.439114e-02 3 1  ON 28
ci_030                -1.132206e-02 3 1  ON 29
ci_031                -1.134612e-02 3 1  ON 30
ci_032                -1.368438e-02 3 1  ON 31
ci_033                 1.049583e-02 3 1  ON 32
ci_034                 9.879892e-03 3 1  ON 33
ci_035                -4.557282e-03 3 1  ON 34
ci_036                -1.056856e-02 3 1  ON 35
ci_037                -1.062862e-02 3 1  ON 36
ci_038                 1.457250e-03 3 1  ON 37
ci_039                 1.682635e-03 3 1  ON 38
ci_040                -3.972871e-03 3 1  ON 39
ci_041                 9.687345e-03 3 1  ON 40
ci_042                 9.839303e-03 3 1  ON 41
ci_043                -3.130922e-03 3 1  ON 42
ci_044                -1.530826e-02 3 1  ON 43
ci_045                -1.669377e-03 3 1  ON 44
ci_046                 5.249772e-03 3 1  ON 45
ci_047                 5.430935e-03 3 1  ON 46
ci_048                -1.210305e-02 3 1  ON 47
ci_049                -1.194360e-02 3 1  ON 48
ci_050                 7.684679e-03 3 1  ON 49
ci_051                 7.945507e-03 3 1  ON 50
ci_052                -6.428868e-03 3 1  ON 51
ci_053                -6.527136e-03 3 1  ON 52
ci_054                -2.768883e-03 3 1  ON 53
ci_055                -3.290766e-03 3 1  ON 54
ci_056                 4.614166e-03 3 1  ON 55
ci_057                 4.719996e-03 3 1  ON 56
ci_058                -6.610978e-03 3 1  ON 57
ci_059                -6.506612e-03 3 1  ON 58
ci_060                 8.348791e-03 3 1  ON 59
ci_061                 8.638963e-03 3 1  ON 60
ci_062                -3.221964e-03 3 1  ON 61
ci_063                -3.448947e-03 3 1  ON 62
ci_064                -2.973207e-03 3 1  ON 63
ci_065                -4.121197e-03 3 1  ON 64
ci_066                 5.719571e-03 3 1  ON 65
ci_067                 5.775038e-03 3 1  ON 66
ci_068                -5.032790e-03 3 1  ON 67
ci_069                -4.680880e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9411e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.218
    reference variance = 0.3601
====================================================
  Execution time = 2.7097e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0527e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1526e-01
  Total weights = 3.912703941e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9496e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301120539966
                                         uncertainty =       0.001365985164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301120539966
                                         uncertainty =       0.001365985164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274541122
  error estimate for blocks of size 2^( 2) =       0.000281634497
  error estimate for blocks of size 2^( 3) =       0.000288031796
  error estimate for blocks of size 2^( 4) =       0.000292848904
  error estimate for blocks of size 2^( 5) =       0.000295967266
  error estimate for blocks of size 2^( 6) =       0.000297713846
  error estimate for blocks of size 2^( 7) =       0.000298098751
  error estimate for blocks of size 2^( 8) =       0.000299607487

      target function =                  N/A
              le_mean =     -17.216683015074
             les_mean =     296.729434536687
             stat err =       0.000297846837
             autocorr =       1.176985671244
              std dev =       0.549082244914
             le_variance =       0.301491311680


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721668301507e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216683015088       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216690084290       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216690740229       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216690662794       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-02 is 6.210449e-04

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216683015088       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216687519416       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216687781162       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216687764193       residual = 4.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 3.889802e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216683015088       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216684852617       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216684915134       residual = 2.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 1.743124e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.335867 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2055e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -4.019277e-02 3 1  ON 0
ci_002                -3.011315e-02 3 1  ON 1
ci_003                -2.512150e-02 3 1  ON 2
ci_004                 2.112263e-02 3 1  ON 3
ci_005                 2.087255e-02 3 1  ON 4
ci_006                -1.915116e-02 3 1  ON 5
ci_007                -1.910622e-02 3 1  ON 6
ci_008                -1.764971e-02 3 1  ON 7
ci_009                -1.736774e-02 3 1  ON 8
ci_010                -1.740572e-02 3 1  ON 9
ci_011                -1.682538e-02 3 1  ON 10
ci_012                -1.615609e-02 3 1  ON 11
ci_013                -1.939029e-02 3 1  ON 12
ci_014                 1.363473e-02 3 1  ON 13
ci_015                 1.403999e-02 3 1  ON 14
ci_016                 1.676883e-02 3 1  ON 15
ci_017                 1.689686e-02 3 1  ON 16
ci_018                 1.270609e-02 3 1  ON 17
ci_019                 1.269087e-02 3 1  ON 18
ci_020                 1.274609e-02 3 1  ON 19
ci_021                 1.263080e-02 3 1  ON 20
ci_022                 1.140908e-02 3 1  ON 21
ci_023                 1.121157e-02 3 1  ON 22
ci_024                 1.186184e-02 3 1  ON 23
ci_025                 1.124292e-02 3 1  ON 24
ci_026                 1.095584e-02 3 1  ON 25
ci_027                 1.102985e-02 3 1  ON 26
ci_028                -1.444452e-02 3 1  ON 27
ci_029                -1.424996e-02 3 1  ON 28
ci_030                -1.135805e-02 3 1  ON 29
ci_031                -1.120881e-02 3 1  ON 30
ci_032                -1.368917e-02 3 1  ON 31
ci_033                 1.041821e-02 3 1  ON 32
ci_034                 1.013137e-02 3 1  ON 33
ci_035                -4.641858e-03 3 1  ON 34
ci_036                -1.031580e-02 3 1  ON 35
ci_037                -1.052019e-02 3 1  ON 36
ci_038                 1.485995e-03 3 1  ON 37
ci_039                 1.658609e-03 3 1  ON 38
ci_040                -4.077703e-03 3 1  ON 39
ci_041                 9.642472e-03 3 1  ON 40
ci_042                 9.734093e-03 3 1  ON 41
ci_043                -3.091618e-03 3 1  ON 42
ci_044                -1.521331e-02 3 1  ON 43
ci_045                -1.706692e-03 3 1  ON 44
ci_046                 5.325273e-03 3 1  ON 45
ci_047                 5.524984e-03 3 1  ON 46
ci_048                -1.208150e-02 3 1  ON 47
ci_049                -1.177283e-02 3 1  ON 48
ci_050                 7.854845e-03 3 1  ON 49
ci_051                 7.556527e-03 3 1  ON 50
ci_052                -6.622314e-03 3 1  ON 51
ci_053                -6.546173e-03 3 1  ON 52
ci_054                -3.091191e-03 3 1  ON 53
ci_055                -3.125465e-03 3 1  ON 54
ci_056                 4.551816e-03 3 1  ON 55
ci_057                 4.605107e-03 3 1  ON 56
ci_058                -6.496091e-03 3 1  ON 57
ci_059                -6.741850e-03 3 1  ON 58
ci_060                 8.334577e-03 3 1  ON 59
ci_061                 8.394604e-03 3 1  ON 60
ci_062                -3.115311e-03 3 1  ON 61
ci_063                -3.311446e-03 3 1  ON 62
ci_064                -3.165656e-03 3 1  ON 63
ci_065                -4.229517e-03 3 1  ON 64
ci_066                 5.717255e-03 3 1  ON 65
ci_067                 5.786536e-03 3 1  ON 66
ci_068                -5.064439e-03 3 1  ON 67
ci_069                -4.987313e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1659
    reference variance = 0.48055
====================================================
  Execution time = 2.6683e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1500e-01
  Total weights = 3.9132e+06
  Execution time = 3.6416e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302606641017
                                         uncertainty =       0.001707808882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302606641017
                                         uncertainty =       0.001707808882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275087263
  error estimate for blocks of size 2^( 2) =       0.000282051921
  error estimate for blocks of size 2^( 3) =       0.000288492927
  error estimate for blocks of size 2^( 4) =       0.000293019289
  error estimate for blocks of size 2^( 5) =       0.000296095989
  error estimate for blocks of size 2^( 6) =       0.000297462088
  error estimate for blocks of size 2^( 7) =       0.000298236383
  error estimate for blocks of size 2^( 8) =       0.000299902636

      target function =                  N/A
              le_mean =     -17.216865381329
             les_mean =     296.738912932204
             stat err =       0.000297924274
             autocorr =       1.172926547726
              std dev =       0.550174525126
             le_variance =       0.302692008098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302607808531
                                         uncertainty =       0.001711773634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302607808531
                                         uncertainty =       0.001711773634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275087672
  error estimate for blocks of size 2^( 2) =       0.000282052998
  error estimate for blocks of size 2^( 3) =       0.000288492653
  error estimate for blocks of size 2^( 4) =       0.000293027618
  error estimate for blocks of size 2^( 5) =       0.000296112382
  error estimate for blocks of size 2^( 6) =       0.000297482515
  error estimate for blocks of size 2^( 7) =       0.000298274601
  error estimate for blocks of size 2^( 8) =       0.000299943848

      target function =                  N/A
              le_mean =     -17.216871357091
             les_mean =     296.736541655990
             stat err =       0.000297953336
             autocorr =       1.173151906039
              std dev =       0.550175343691
             le_variance =       0.302692908805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302668402602
                                         uncertainty =       0.001717607961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302668402602
                                         uncertainty =       0.001717607961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275115147
  error estimate for blocks of size 2^( 2) =       0.000282077560
  error estimate for blocks of size 2^( 3) =       0.000288515849
  error estimate for blocks of size 2^( 4) =       0.000293050529
  error estimate for blocks of size 2^( 5) =       0.000296136554
  error estimate for blocks of size 2^( 6) =       0.000297516294
  error estimate for blocks of size 2^( 7) =       0.000298321452
  error estimate for blocks of size 2^( 8) =       0.000299998134

      target function =                  N/A
              le_mean =     -17.216874161171
             les_mean =     296.778231685156
             stat err =       0.000297993109
             autocorr =       1.173230752140
              std dev =       0.550230293621
             le_variance =       0.302753376018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302596319851
                                         uncertainty =       0.001707885442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302596319851
                                         uncertainty =       0.001707885442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275082537
  error estimate for blocks of size 2^( 2) =       0.000282047134
  error estimate for blocks of size 2^( 3) =       0.000288487480
  error estimate for blocks of size 2^( 4) =       0.000293018570
  error estimate for blocks of size 2^( 5) =       0.000296098897
  error estimate for blocks of size 2^( 6) =       0.000297466700
  error estimate for blocks of size 2^( 7) =       0.000298249470
  error estimate for blocks of size 2^( 8) =       0.000299912702

      target function =                  N/A
              le_mean =     -17.216862758740
             les_mean =     296.770968622221
             stat err =       0.000297931942
             autocorr =       1.173027229313
              std dev =       0.550165073842
             le_variance =       0.302681608475


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216865381329        initial
     6.1035e-02     6.1035e-01             6.2104e-04       -17.216871357091
     2.4414e-01     2.4414e+00             3.8898e-04       -17.216874161171  <--
     9.7656e-01     9.7656e+00             1.7431e-04       -17.216862758740

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 4.5030e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -4.019277e-02 3 1  ON 0
ci_002                -3.011315e-02 3 1  ON 1
ci_003                -2.512150e-02 3 1  ON 2
ci_004                 2.112263e-02 3 1  ON 3
ci_005                 2.087255e-02 3 1  ON 4
ci_006                -1.915116e-02 3 1  ON 5
ci_007                -1.910622e-02 3 1  ON 6
ci_008                -1.764971e-02 3 1  ON 7
ci_009                -1.736774e-02 3 1  ON 8
ci_010                -1.740572e-02 3 1  ON 9
ci_011                -1.682538e-02 3 1  ON 10
ci_012                -1.615609e-02 3 1  ON 11
ci_013                -1.939029e-02 3 1  ON 12
ci_014                 1.363473e-02 3 1  ON 13
ci_015                 1.403999e-02 3 1  ON 14
ci_016                 1.676883e-02 3 1  ON 15
ci_017                 1.689686e-02 3 1  ON 16
ci_018                 1.270609e-02 3 1  ON 17
ci_019                 1.269087e-02 3 1  ON 18
ci_020                 1.274609e-02 3 1  ON 19
ci_021                 1.263080e-02 3 1  ON 20
ci_022                 1.140908e-02 3 1  ON 21
ci_023                 1.121157e-02 3 1  ON 22
ci_024                 1.186184e-02 3 1  ON 23
ci_025                 1.124292e-02 3 1  ON 24
ci_026                 1.095584e-02 3 1  ON 25
ci_027                 1.102985e-02 3 1  ON 26
ci_028                -1.444452e-02 3 1  ON 27
ci_029                -1.424996e-02 3 1  ON 28
ci_030                -1.135805e-02 3 1  ON 29
ci_031                -1.120881e-02 3 1  ON 30
ci_032                -1.368917e-02 3 1  ON 31
ci_033                 1.041821e-02 3 1  ON 32
ci_034                 1.013137e-02 3 1  ON 33
ci_035                -4.641858e-03 3 1  ON 34
ci_036                -1.031580e-02 3 1  ON 35
ci_037                -1.052019e-02 3 1  ON 36
ci_038                 1.485995e-03 3 1  ON 37
ci_039                 1.658609e-03 3 1  ON 38
ci_040                -4.077703e-03 3 1  ON 39
ci_041                 9.642472e-03 3 1  ON 40
ci_042                 9.734093e-03 3 1  ON 41
ci_043                -3.091618e-03 3 1  ON 42
ci_044                -1.521331e-02 3 1  ON 43
ci_045                -1.706692e-03 3 1  ON 44
ci_046                 5.325273e-03 3 1  ON 45
ci_047                 5.524984e-03 3 1  ON 46
ci_048                -1.208150e-02 3 1  ON 47
ci_049                -1.177283e-02 3 1  ON 48
ci_050                 7.854845e-03 3 1  ON 49
ci_051                 7.556527e-03 3 1  ON 50
ci_052                -6.622314e-03 3 1  ON 51
ci_053                -6.546173e-03 3 1  ON 52
ci_054                -3.091191e-03 3 1  ON 53
ci_055                -3.125465e-03 3 1  ON 54
ci_056                 4.551816e-03 3 1  ON 55
ci_057                 4.605107e-03 3 1  ON 56
ci_058                -6.496091e-03 3 1  ON 57
ci_059                -6.741850e-03 3 1  ON 58
ci_060                 8.334577e-03 3 1  ON 59
ci_061                 8.394604e-03 3 1  ON 60
ci_062                -3.115311e-03 3 1  ON 61
ci_063                -3.311446e-03 3 1  ON 62
ci_064                -3.165656e-03 3 1  ON 63
ci_065                -4.229517e-03 3 1  ON 64
ci_066                 5.717255e-03 3 1  ON 65
ci_067                 5.786536e-03 3 1  ON 66
ci_068                -5.064439e-03 3 1  ON 67
ci_069                -4.987313e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7093e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2716
    reference variance = 0.253647
====================================================
  Execution time = 2.7013e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0607e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1833e-01
  Total weights = 3.913644200e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9112e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300332610436
                                         uncertainty =       0.001515605643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300332610436
                                         uncertainty =       0.001515605643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274021677
  error estimate for blocks of size 2^( 2) =       0.000281131777
  error estimate for blocks of size 2^( 3) =       0.000287734978
  error estimate for blocks of size 2^( 4) =       0.000292520763
  error estimate for blocks of size 2^( 5) =       0.000295697899
  error estimate for blocks of size 2^( 6) =       0.000297513935
  error estimate for blocks of size 2^( 7) =       0.000297780277
  error estimate for blocks of size 2^( 8) =       0.000297882673

      target function =                  N/A
              le_mean =     -17.216600661834
             les_mean =     296.729671632241
             stat err =       0.000297218696
             autocorr =       1.176474199647
              std dev =       0.548043354838
             le_variance =       0.300351518782


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660066183e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216600661861       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216610745177       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216611072235       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216611050760       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216610965841       residual = 4.10e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-02 is 8.781444e-04

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216600661861       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216607088868       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216607234597       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216607205694       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 5.511972e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216600661861       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216603284657       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216603346918       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 2.210896e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.337215 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1930e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -4.001156e-02 3 1  ON 0
ci_002                -3.039110e-02 3 1  ON 1
ci_003                -2.472770e-02 3 1  ON 2
ci_004                 2.103483e-02 3 1  ON 3
ci_005                 2.068014e-02 3 1  ON 4
ci_006                -1.875544e-02 3 1  ON 5
ci_007                -1.894151e-02 3 1  ON 6
ci_008                -1.804248e-02 3 1  ON 7
ci_009                -1.762293e-02 3 1  ON 8
ci_010                -1.756663e-02 3 1  ON 9
ci_011                -1.661780e-02 3 1  ON 10
ci_012                -1.629350e-02 3 1  ON 11
ci_013                -1.936731e-02 3 1  ON 12
ci_014                 1.401236e-02 3 1  ON 13
ci_015                 1.348880e-02 3 1  ON 14
ci_016                 1.633199e-02 3 1  ON 15
ci_017                 1.662124e-02 3 1  ON 16
ci_018                 1.249596e-02 3 1  ON 17
ci_019                 1.259295e-02 3 1  ON 18
ci_020                 1.316927e-02 3 1  ON 19
ci_021                 1.270805e-02 3 1  ON 20
ci_022                 1.160145e-02 3 1  ON 21
ci_023                 1.122845e-02 3 1  ON 22
ci_024                 1.204310e-02 3 1  ON 23
ci_025                 1.113400e-02 3 1  ON 24
ci_026                 1.092644e-02 3 1  ON 25
ci_027                 1.065493e-02 3 1  ON 26
ci_028                -1.449449e-02 3 1  ON 27
ci_029                -1.457246e-02 3 1  ON 28
ci_030                -1.131155e-02 3 1  ON 29
ci_031                -1.099977e-02 3 1  ON 30
ci_032                -1.393673e-02 3 1  ON 31
ci_033                 1.020919e-02 3 1  ON 32
ci_034                 1.015067e-02 3 1  ON 33
ci_035                -4.693615e-03 3 1  ON 34
ci_036                -1.024281e-02 3 1  ON 35
ci_037                -1.032270e-02 3 1  ON 36
ci_038                 1.316765e-03 3 1  ON 37
ci_039                 1.492526e-03 3 1  ON 38
ci_040                -4.001990e-03 3 1  ON 39
ci_041                 9.848073e-03 3 1  ON 40
ci_042                 9.698787e-03 3 1  ON 41
ci_043                -2.807332e-03 3 1  ON 42
ci_044                -1.525968e-02 3 1  ON 43
ci_045                -1.640607e-03 3 1  ON 44
ci_046                 5.722681e-03 3 1  ON 45
ci_047                 5.272940e-03 3 1  ON 46
ci_048                -1.204310e-02 3 1  ON 47
ci_049                -1.170165e-02 3 1  ON 48
ci_050                 7.942381e-03 3 1  ON 49
ci_051                 7.738737e-03 3 1  ON 50
ci_052                -6.468218e-03 3 1  ON 51
ci_053                -6.625474e-03 3 1  ON 52
ci_054                -3.131575e-03 3 1  ON 53
ci_055                -3.149568e-03 3 1  ON 54
ci_056                 4.757598e-03 3 1  ON 55
ci_057                 4.358755e-03 3 1  ON 56
ci_058                -6.983814e-03 3 1  ON 57
ci_059                -6.638387e-03 3 1  ON 58
ci_060                 8.413582e-03 3 1  ON 59
ci_061                 8.702936e-03 3 1  ON 60
ci_062                -3.145505e-03 3 1  ON 61
ci_063                -3.229329e-03 3 1  ON 62
ci_064                -2.978451e-03 3 1  ON 63
ci_065                -4.162630e-03 3 1  ON 64
ci_066                 5.608003e-03 3 1  ON 65
ci_067                 5.500248e-03 3 1  ON 66
ci_068                -5.007101e-03 3 1  ON 67
ci_069                -5.310687e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2447
    reference variance = 0.190479
====================================================
  Execution time = 2.7019e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1892e-01
  Total weights = 3.9131e+06
  Execution time = 3.6472e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301934626012
                                         uncertainty =       0.002133845228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301934626012
                                         uncertainty =       0.002133845228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274744485
  error estimate for blocks of size 2^( 2) =       0.000281687802
  error estimate for blocks of size 2^( 3) =       0.000287980328
  error estimate for blocks of size 2^( 4) =       0.000292715155
  error estimate for blocks of size 2^( 5) =       0.000295478297
  error estimate for blocks of size 2^( 6) =       0.000296953003
  error estimate for blocks of size 2^( 7) =       0.000298378259
  error estimate for blocks of size 2^( 8) =       0.000299409822

      target function =                  N/A
              le_mean =     -17.216603802703
             les_mean =     296.767674235664
             stat err =       0.000297554845
             autocorr =       1.172940778535
              std dev =       0.549488970665
             le_variance =       0.301938128883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302325022357
                                         uncertainty =       0.002101276713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302325022357
                                         uncertainty =       0.002101276713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274925372
  error estimate for blocks of size 2^( 2) =       0.000281863643
  error estimate for blocks of size 2^( 3) =       0.000288149596
  error estimate for blocks of size 2^( 4) =       0.000292888617
  error estimate for blocks of size 2^( 5) =       0.000295650734
  error estimate for blocks of size 2^( 6) =       0.000297125054
  error estimate for blocks of size 2^( 7) =       0.000298545697
  error estimate for blocks of size 2^( 8) =       0.000299569396

      target function =                  N/A
              le_mean =     -17.216602673673
             les_mean =     296.733651406013
             stat err =       0.000297722720
             autocorr =       1.172719949066
              std dev =       0.549850744909
             le_variance =       0.302335841677

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302596885116
                                         uncertainty =       0.002090699718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302596885116
                                         uncertainty =       0.002090699718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275049598
  error estimate for blocks of size 2^( 2) =       0.000281985007
  error estimate for blocks of size 2^( 3) =       0.000288272944
  error estimate for blocks of size 2^( 4) =       0.000293013918
  error estimate for blocks of size 2^( 5) =       0.000295772808
  error estimate for blocks of size 2^( 6) =       0.000297232919
  error estimate for blocks of size 2^( 7) =       0.000298649652
  error estimate for blocks of size 2^( 8) =       0.000299638797

      target function =                  N/A
              le_mean =     -17.216613896377
             les_mean =     296.745961531580
             stat err =       0.000297823544
             autocorr =       1.172454577880
              std dev =       0.550099195017
             le_variance =       0.302609124358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.394557568768
                                         uncertainty =       0.092110034602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.394557568768
                                         uncertainty =       0.092110034602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000313985080
  error estimate for blocks of size 2^( 2) =       0.000320037196
  error estimate for blocks of size 2^( 3) =       0.000325526799
  error estimate for blocks of size 2^( 4) =       0.000329721765
  error estimate for blocks of size 2^( 5) =       0.000331744897
  error estimate for blocks of size 2^( 6) =       0.000333189553
  error estimate for blocks of size 2^( 7) =       0.000334747733
  error estimate for blocks of size 2^( 8) =       0.000335573914

      target function =                  N/A
              le_mean =     -17.216750178829
             les_mean =     504.913926378898
             stat err =       0.000333814024
             autocorr =       1.130293251099
              std dev =       0.627970159119
             le_variance =       0.394346520744


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216603802703        initial
     6.1035e-02     6.1035e-01             8.7814e-04       -17.216602673673
     2.4414e-01     2.4414e+00             5.5120e-04       -17.216613896377
     9.7656e-01     9.7656e+00             2.2109e-04       -17.216750178829  <--

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 4.5423e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -4.012308e-02 3 1  ON 0
ci_002                -3.022000e-02 3 1  ON 1
ci_003                -2.498136e-02 3 1  ON 2
ci_004                 2.109031e-02 3 1  ON 3
ci_005                 2.080185e-02 3 1  ON 4
ci_006                -1.899597e-02 3 1  ON 5
ci_007                -1.904316e-02 3 1  ON 6
ci_008                -1.781236e-02 3 1  ON 7
ci_009                -1.747489e-02 3 1  ON 8
ci_010                -1.746587e-02 3 1  ON 9
ci_011                -1.674745e-02 3 1  ON 10
ci_012                -1.621048e-02 3 1  ON 11
ci_013                -1.938210e-02 3 1  ON 12
ci_014                 1.378286e-02 3 1  ON 13
ci_015                 1.381890e-02 3 1  ON 14
ci_016                 1.660071e-02 3 1  ON 15
ci_017                 1.679288e-02 3 1  ON 16
ci_018                 1.262142e-02 3 1  ON 17
ci_019                 1.265255e-02 3 1  ON 18
ci_020                 1.290256e-02 3 1  ON 19
ci_021                 1.266036e-02 3 1  ON 20
ci_022                 1.149052e-02 3 1  ON 21
ci_023                 1.121850e-02 3 1  ON 22
ci_024                 1.192819e-02 3 1  ON 23
ci_025                 1.120426e-02 3 1  ON 24
ci_026                 1.094280e-02 3 1  ON 25
ci_027                 1.088022e-02 3 1  ON 26
ci_028                -1.446174e-02 3 1  ON 27
ci_029                -1.436963e-02 3 1  ON 28
ci_030                -1.133839e-02 3 1  ON 29
ci_031                -1.112408e-02 3 1  ON 30
ci_032                -1.379178e-02 3 1  ON 31
ci_033                 1.033508e-02 3 1  ON 32
ci_034                 1.013735e-02 3 1  ON 33
ci_035                -4.664004e-03 3 1  ON 34
ci_036                -1.028765e-02 3 1  ON 35
ci_037                -1.044392e-02 3 1  ON 36
ci_038                 1.405243e-03 3 1  ON 37
ci_039                 1.581598e-03 3 1  ON 38
ci_040                -4.038351e-03 3 1  ON 39
ci_041                 9.723297e-03 3 1  ON 40
ci_042                 9.720067e-03 3 1  ON 41
ci_043                -2.961857e-03 3 1  ON 42
ci_044                -1.522979e-02 3 1  ON 43
ci_045                -1.673151e-03 3 1  ON 44
ci_046                 5.484698e-03 3 1  ON 45
ci_047                 5.422540e-03 3 1  ON 46
ci_048                -1.206435e-02 3 1  ON 47
ci_049                -1.174129e-02 3 1  ON 48
ci_050                 7.893921e-03 3 1  ON 49
ci_051                 7.638049e-03 3 1  ON 50
ci_052                -6.556983e-03 3 1  ON 51
ci_053                -6.580381e-03 3 1  ON 52
ci_054                -3.108545e-03 3 1  ON 53
ci_055                -3.134338e-03 3 1  ON 54
ci_056                 4.643504e-03 3 1  ON 55
ci_057                 4.496993e-03 3 1  ON 56
ci_058                -6.701095e-03 3 1  ON 57
ci_059                -6.698099e-03 3 1  ON 58
ci_060                 8.365158e-03 3 1  ON 59
ci_061                 8.516582e-03 3 1  ON 60
ci_062                -3.127954e-03 3 1  ON 61
ci_063                -3.278259e-03 3 1  ON 62
ci_064                -3.073522e-03 3 1  ON 63
ci_065                -4.196276e-03 3 1  ON 64
ci_066                 5.668367e-03 3 1  ON 65
ci_067                 5.659643e-03 3 1  ON 66
ci_068                -5.041494e-03 3 1  ON 67
ci_069                -5.120580e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7364e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1812
    reference variance = 0.234913
====================================================
  Execution time = 2.7205e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0602e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1589e-01
  Total weights = 3.913083099e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9290e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301103976938
                                         uncertainty =       0.001440927362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301103976938
                                         uncertainty =       0.001440927362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274363725
  error estimate for blocks of size 2^( 2) =       0.000281208513
  error estimate for blocks of size 2^( 3) =       0.000287651841
  error estimate for blocks of size 2^( 4) =       0.000292225867
  error estimate for blocks of size 2^( 5) =       0.000295274427
  error estimate for blocks of size 2^( 6) =       0.000296893817
  error estimate for blocks of size 2^( 7) =       0.000297267651
  error estimate for blocks of size 2^( 8) =       0.000298797864

      target function =                  N/A
              le_mean =     -17.216161803128
             les_mean =     296.712113327267
             stat err =       0.000297058440
             autocorr =       1.172277451675
              std dev =       0.548727449428
             le_variance =       0.301101813755


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721616180313e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216161803155       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216164088751       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216164428916       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216164451873       residual = 6.29e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 4.701621e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216161803155       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216162730195       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216162719469       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 1.807297e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216161803155       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216162077622       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216162053816       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 5.227248e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.338385 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2146e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -4.008341e-02 3 1  ON 0
ci_002                -3.021342e-02 3 1  ON 1
ci_003                -2.498442e-02 3 1  ON 2
ci_004                 2.119044e-02 3 1  ON 3
ci_005                 2.087012e-02 3 1  ON 4
ci_006                -1.892115e-02 3 1  ON 5
ci_007                -1.900675e-02 3 1  ON 6
ci_008                -1.779016e-02 3 1  ON 7
ci_009                -1.746112e-02 3 1  ON 8
ci_010                -1.736297e-02 3 1  ON 9
ci_011                -1.656672e-02 3 1  ON 10
ci_012                -1.623505e-02 3 1  ON 11
ci_013                -1.930247e-02 3 1  ON 12
ci_014                 1.377049e-02 3 1  ON 13
ci_015                 1.384318e-02 3 1  ON 14
ci_016                 1.657742e-02 3 1  ON 15
ci_017                 1.674850e-02 3 1  ON 16
ci_018                 1.261996e-02 3 1  ON 17
ci_019                 1.271274e-02 3 1  ON 18
ci_020                 1.299850e-02 3 1  ON 19
ci_021                 1.283526e-02 3 1  ON 20
ci_022                 1.162981e-02 3 1  ON 21
ci_023                 1.124779e-02 3 1  ON 22
ci_024                 1.182489e-02 3 1  ON 23
ci_025                 1.128057e-02 3 1  ON 24
ci_026                 1.092046e-02 3 1  ON 25
ci_027                 1.094541e-02 3 1  ON 26
ci_028                -1.456344e-02 3 1  ON 27
ci_029                -1.436059e-02 3 1  ON 28
ci_030                -1.122089e-02 3 1  ON 29
ci_031                -1.118776e-02 3 1  ON 30
ci_032                -1.379388e-02 3 1  ON 31
ci_033                 1.034585e-02 3 1  ON 32
ci_034                 1.020001e-02 3 1  ON 33
ci_035                -4.585725e-03 3 1  ON 34
ci_036                -1.037238e-02 3 1  ON 35
ci_037                -1.045260e-02 3 1  ON 36
ci_038                 1.415828e-03 3 1  ON 37
ci_039                 1.702485e-03 3 1  ON 38
ci_040                -3.987930e-03 3 1  ON 39
ci_041                 9.740340e-03 3 1  ON 40
ci_042                 9.706172e-03 3 1  ON 41
ci_043                -3.050867e-03 3 1  ON 42
ci_044                -1.510358e-02 3 1  ON 43
ci_045                -1.792568e-03 3 1  ON 44
ci_046                 5.403810e-03 3 1  ON 45
ci_047                 5.480624e-03 3 1  ON 46
ci_048                -1.202126e-02 3 1  ON 47
ci_049                -1.172707e-02 3 1  ON 48
ci_050                 7.849757e-03 3 1  ON 49
ci_051                 7.741683e-03 3 1  ON 50
ci_052                -6.422461e-03 3 1  ON 51
ci_053                -6.648562e-03 3 1  ON 52
ci_054                -3.107400e-03 3 1  ON 53
ci_055                -2.996905e-03 3 1  ON 54
ci_056                 4.525544e-03 3 1  ON 55
ci_057                 4.606884e-03 3 1  ON 56
ci_058                -6.795162e-03 3 1  ON 57
ci_059                -6.795391e-03 3 1  ON 58
ci_060                 8.535465e-03 3 1  ON 59
ci_061                 8.471054e-03 3 1  ON 60
ci_062                -3.106279e-03 3 1  ON 61
ci_063                -3.285052e-03 3 1  ON 62
ci_064                -3.108343e-03 3 1  ON 63
ci_065                -4.190139e-03 3 1  ON 64
ci_066                 5.746925e-03 3 1  ON 65
ci_067                 5.704053e-03 3 1  ON 66
ci_068                -4.928219e-03 3 1  ON 67
ci_069                -5.039439e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2042
    reference variance = 0.326631
====================================================
  Execution time = 2.6552e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2206e-01
  Total weights = 3.9133e+06
  Execution time = 3.6502e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302758944076
                                         uncertainty =       0.001824458685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302758944076
                                         uncertainty =       0.001824458685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275106905
  error estimate for blocks of size 2^( 2) =       0.000281970051
  error estimate for blocks of size 2^( 3) =       0.000288283684
  error estimate for blocks of size 2^( 4) =       0.000292770841
  error estimate for blocks of size 2^( 5) =       0.000295852521
  error estimate for blocks of size 2^( 6) =       0.000297553671
  error estimate for blocks of size 2^( 7) =       0.000297848701
  error estimate for blocks of size 2^( 8) =       0.000298036723

      target function =                  N/A
              le_mean =     -17.216167566449
             les_mean =     296.726216863983
             stat err =       0.000297322904
             autocorr =       1.168029335451
              std dev =       0.550213809977
             le_variance =       0.302735236689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302717784527
                                         uncertainty =       0.001820064246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302717784527
                                         uncertainty =       0.001820064246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275087437
  error estimate for blocks of size 2^( 2) =       0.000281952755
  error estimate for blocks of size 2^( 3) =       0.000288266701
  error estimate for blocks of size 2^( 4) =       0.000292752115
  error estimate for blocks of size 2^( 5) =       0.000295831758
  error estimate for blocks of size 2^( 6) =       0.000297534501
  error estimate for blocks of size 2^( 7) =       0.000297833108
  error estimate for blocks of size 2^( 8) =       0.000298036382

      target function =                  N/A
              le_mean =     -17.216174415192
             les_mean =     296.719965822180
             stat err =       0.000297308937
             autocorr =       1.168084911058
              std dev =       0.550174874464
             le_variance =       0.302692392491

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302734810677
                                         uncertainty =       0.001821386915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302734810677
                                         uncertainty =       0.001821386915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275095288
  error estimate for blocks of size 2^( 2) =       0.000281959570
  error estimate for blocks of size 2^( 3) =       0.000288273261
  error estimate for blocks of size 2^( 4) =       0.000292759351
  error estimate for blocks of size 2^( 5) =       0.000295838651
  error estimate for blocks of size 2^( 6) =       0.000297540878
  error estimate for blocks of size 2^( 7) =       0.000297841498
  error estimate for blocks of size 2^( 8) =       0.000298037122

      target function =                  N/A
              le_mean =     -17.216173487655
             les_mean =     296.726248014770
             stat err =       0.000297314537
             autocorr =       1.168062245091
              std dev =       0.550190575703
             le_variance =       0.302709669593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302752011473
                                         uncertainty =       0.001823904025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302752011473
                                         uncertainty =       0.001823904025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275103653
  error estimate for blocks of size 2^( 2) =       0.000281966974
  error estimate for blocks of size 2^( 3) =       0.000288280669
  error estimate for blocks of size 2^( 4) =       0.000292767818
  error estimate for blocks of size 2^( 5) =       0.000295849158
  error estimate for blocks of size 2^( 6) =       0.000297550522
  error estimate for blocks of size 2^( 7) =       0.000297846230
  error estimate for blocks of size 2^( 8) =       0.000298035755

      target function =                  N/A
              le_mean =     -17.216167383363
             les_mean =     296.727022101574
             stat err =       0.000297320416
             autocorr =       1.168037400603
              std dev =       0.550207306473
             le_variance =       0.302728080096


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216167566449        initial
     2.4414e-01     2.4414e+00             4.7016e-04       -17.216174415192  <--
     9.7656e-01     9.7656e+00             1.8073e-04       -17.216173487655
     3.9062e+00     3.9062e+01             5.2272e-05       -17.216167383363

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 4.4952e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -4.002733e-02 3 1  ON 0
ci_002                -3.020760e-02 3 1  ON 1
ci_003                -2.498276e-02 3 1  ON 2
ci_004                 2.136957e-02 3 1  ON 3
ci_005                 2.099139e-02 3 1  ON 4
ci_006                -1.879922e-02 3 1  ON 5
ci_007                -1.895366e-02 3 1  ON 6
ci_008                -1.775918e-02 3 1  ON 7
ci_009                -1.744772e-02 3 1  ON 8
ci_010                -1.718937e-02 3 1  ON 9
ci_011                -1.628157e-02 3 1  ON 10
ci_012                -1.628113e-02 3 1  ON 11
ci_013                -1.915981e-02 3 1  ON 12
ci_014                 1.375243e-02 3 1  ON 13
ci_015                 1.388107e-02 3 1  ON 14
ci_016                 1.653652e-02 3 1  ON 15
ci_017                 1.667226e-02 3 1  ON 16
ci_018                 1.261821e-02 3 1  ON 17
ci_019                 1.280363e-02 3 1  ON 18
ci_020                 1.316369e-02 3 1  ON 19
ci_021                 1.313052e-02 3 1  ON 20
ci_022                 1.184017e-02 3 1  ON 21
ci_023                 1.129355e-02 3 1  ON 22
ci_024                 1.163011e-02 3 1  ON 23
ci_025                 1.141293e-02 3 1  ON 24
ci_026                 1.089250e-02 3 1  ON 25
ci_027                 1.105005e-02 3 1  ON 26
ci_028                -1.472719e-02 3 1  ON 27
ci_029                -1.433020e-02 3 1  ON 28
ci_030                -1.103411e-02 3 1  ON 29
ci_031                -1.128286e-02 3 1  ON 30
ci_032                -1.379722e-02 3 1  ON 31
ci_033                 1.036298e-02 3 1  ON 32
ci_034                 1.029629e-02 3 1  ON 33
ci_035                -4.494118e-03 3 1  ON 34
ci_036                -1.050473e-02 3 1  ON 35
ci_037                -1.046415e-02 3 1  ON 36
ci_038                 1.426695e-03 3 1  ON 37
ci_039                 1.843617e-03 3 1  ON 38
ci_040                -3.928944e-03 3 1  ON 39
ci_041                 9.763716e-03 3 1  ON 40
ci_042                 9.685293e-03 3 1  ON 41
ci_043                -3.156451e-03 3 1  ON 42
ci_044                -1.487455e-02 3 1  ON 43
ci_045                -1.927357e-03 3 1  ON 44
ci_046                 5.281723e-03 3 1  ON 45
ci_047                 5.566570e-03 3 1  ON 46
ci_048                -1.193516e-02 3 1  ON 47
ci_049                -1.168452e-02 3 1  ON 48
ci_050                 7.792994e-03 3 1  ON 49
ci_051                 7.869571e-03 3 1  ON 50
ci_052                -6.247851e-03 3 1  ON 51
ci_053                -6.735599e-03 3 1  ON 52
ci_054                -3.106087e-03 3 1  ON 53
ci_055                -2.809234e-03 3 1  ON 54
ci_056                 4.376147e-03 3 1  ON 55
ci_057                 4.747280e-03 3 1  ON 56
ci_058                -6.925865e-03 3 1  ON 57
ci_059                -6.929453e-03 3 1  ON 58
ci_060                 8.788119e-03 3 1  ON 59
ci_061                 8.397058e-03 3 1  ON 60
ci_062                -3.079363e-03 3 1  ON 61
ci_063                -3.297230e-03 3 1  ON 62
ci_064                -3.142518e-03 3 1  ON 63
ci_065                -4.183636e-03 3 1  ON 64
ci_066                 5.842490e-03 3 1  ON 65
ci_067                 5.759617e-03 3 1  ON 66
ci_068                -4.749523e-03 3 1  ON 67
ci_069                -4.916021e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7135e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2358
    reference variance = 0.456756
====================================================
  Execution time = 2.9208e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0580e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1517e-01
  Total weights = 3.913646736e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9719e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300840916412
                                         uncertainty =       0.001325306225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300840916412
                                         uncertainty =       0.001325306225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274238416
  error estimate for blocks of size 2^( 2) =       0.000281180615
  error estimate for blocks of size 2^( 3) =       0.000287599139
  error estimate for blocks of size 2^( 4) =       0.000292219860
  error estimate for blocks of size 2^( 5) =       0.000295682401
  error estimate for blocks of size 2^( 6) =       0.000297456704
  error estimate for blocks of size 2^( 7) =       0.000298367684
  error estimate for blocks of size 2^( 8) =       0.000300086713

      target function =                  N/A
              le_mean =     -17.217174642915
             les_mean =     296.746272040259
             stat err =       0.000297898376
             autocorr =       1.179993696239
              std dev =       0.548476831793
             le_variance =       0.300826835014


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721717464292e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217174642955       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217174844307       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217176056188       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217176437670       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217176304553       residual = 4.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-02 is 1.030077e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217174642955       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217174769198       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217175164607       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217175248156       residual = 9.55e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 5.692726e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217174642955       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217174693613       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217174679055       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 2.057303e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.339733 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4187e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -4.017575e-02 3 1  ON 0
ci_002                -3.028713e-02 3 1  ON 1
ci_003                -2.470245e-02 3 1  ON 2
ci_004                 2.148547e-02 3 1  ON 3
ci_005                 2.076394e-02 3 1  ON 4
ci_006                -1.882738e-02 3 1  ON 5
ci_007                -1.854388e-02 3 1  ON 6
ci_008                -1.783672e-02 3 1  ON 7
ci_009                -1.771351e-02 3 1  ON 8
ci_010                -1.749946e-02 3 1  ON 9
ci_011                -1.645071e-02 3 1  ON 10
ci_012                -1.604953e-02 3 1  ON 11
ci_013                -1.859054e-02 3 1  ON 12
ci_014                 1.343460e-02 3 1  ON 13
ci_015                 1.392295e-02 3 1  ON 14
ci_016                 1.637420e-02 3 1  ON 15
ci_017                 1.680241e-02 3 1  ON 16
ci_018                 1.281666e-02 3 1  ON 17
ci_019                 1.292308e-02 3 1  ON 18
ci_020                 1.336563e-02 3 1  ON 19
ci_021                 1.312800e-02 3 1  ON 20
ci_022                 1.143697e-02 3 1  ON 21
ci_023                 1.150975e-02 3 1  ON 22
ci_024                 1.137637e-02 3 1  ON 23
ci_025                 1.161341e-02 3 1  ON 24
ci_026                 1.134574e-02 3 1  ON 25
ci_027                 1.118374e-02 3 1  ON 26
ci_028                -1.452649e-02 3 1  ON 27
ci_029                -1.390510e-02 3 1  ON 28
ci_030                -1.089883e-02 3 1  ON 29
ci_031                -1.145017e-02 3 1  ON 30
ci_032                -1.371477e-02 3 1  ON 31
ci_033                 1.015214e-02 3 1  ON 32
ci_034                 1.016132e-02 3 1  ON 33
ci_035                -4.622005e-03 3 1  ON 34
ci_036                -1.022137e-02 3 1  ON 35
ci_037                -1.007177e-02 3 1  ON 36
ci_038                 1.684897e-03 3 1  ON 37
ci_039                 1.797583e-03 3 1  ON 38
ci_040                -4.019542e-03 3 1  ON 39
ci_041                 9.848253e-03 3 1  ON 40
ci_042                 9.878682e-03 3 1  ON 41
ci_043                -3.216212e-03 3 1  ON 42
ci_044                -1.483727e-02 3 1  ON 43
ci_045                -1.858458e-03 3 1  ON 44
ci_046                 5.396467e-03 3 1  ON 45
ci_047                 5.589268e-03 3 1  ON 46
ci_048                -1.204148e-02 3 1  ON 47
ci_049                -1.205740e-02 3 1  ON 48
ci_050                 7.465810e-03 3 1  ON 49
ci_051                 7.703296e-03 3 1  ON 50
ci_052                -6.391620e-03 3 1  ON 51
ci_053                -6.659020e-03 3 1  ON 52
ci_054                -3.088447e-03 3 1  ON 53
ci_055                -2.608292e-03 3 1  ON 54
ci_056                 4.513096e-03 3 1  ON 55
ci_057                 4.577503e-03 3 1  ON 56
ci_058                -6.973663e-03 3 1  ON 57
ci_059                -6.781829e-03 3 1  ON 58
ci_060                 8.664600e-03 3 1  ON 59
ci_061                 8.173987e-03 3 1  ON 60
ci_062                -3.096120e-03 3 1  ON 61
ci_063                -3.169043e-03 3 1  ON 62
ci_064                -2.940693e-03 3 1  ON 63
ci_065                -4.075208e-03 3 1  ON 64
ci_066                 5.688219e-03 3 1  ON 65
ci_067                 5.566502e-03 3 1  ON 66
ci_068                -4.720316e-03 3 1  ON 67
ci_069                -5.228634e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1986
    reference variance = 0.435811
====================================================
  Execution time = 2.6701e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1392e-01
  Total weights = 3.9135e+06
  Execution time = 3.6362e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299185553689
                                         uncertainty =       0.001437319678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299185553689
                                         uncertainty =       0.001437319678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273526448
  error estimate for blocks of size 2^( 2) =       0.000280507333
  error estimate for blocks of size 2^( 3) =       0.000286797813
  error estimate for blocks of size 2^( 4) =       0.000291489058
  error estimate for blocks of size 2^( 5) =       0.000294524274
  error estimate for blocks of size 2^( 6) =       0.000296073369
  error estimate for blocks of size 2^( 7) =       0.000297230378
  error estimate for blocks of size 2^( 8) =       0.000297486920

      target function =                  N/A
              le_mean =     -17.216643365421
             les_mean =     296.728515586168
             stat err =       0.000296328735
             autocorr =       1.173677780946
              std dev =       0.547052896092
             le_variance =       0.299266871123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302148807376
                                         uncertainty =       0.003215336185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302148807376
                                         uncertainty =       0.003215336185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274873466
  error estimate for blocks of size 2^( 2) =       0.000281821559
  error estimate for blocks of size 2^( 3) =       0.000288089404
  error estimate for blocks of size 2^( 4) =       0.000292760876
  error estimate for blocks of size 2^( 5) =       0.000295827124
  error estimate for blocks of size 2^( 6) =       0.000297278892
  error estimate for blocks of size 2^( 7) =       0.000298400809
  error estimate for blocks of size 2^( 8) =       0.000298807662

      target function =                  N/A
              le_mean =     -17.216672016148
             les_mean =     297.356697022170
             stat err =       0.000297578622
             autocorr =       1.172027543748
              std dev =       0.549746931989
             le_variance =       0.302221689231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299425431432
                                         uncertainty =       0.001453491770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299425431432
                                         uncertainty =       0.001453491770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273635429
  error estimate for blocks of size 2^( 2) =       0.000280612841
  error estimate for blocks of size 2^( 3) =       0.000286899981
  error estimate for blocks of size 2^( 4) =       0.000291585804
  error estimate for blocks of size 2^( 5) =       0.000294623860
  error estimate for blocks of size 2^( 6) =       0.000296184037
  error estimate for blocks of size 2^( 7) =       0.000297381349
  error estimate for blocks of size 2^( 8) =       0.000297653007

      target function =                  N/A
              le_mean =     -17.216649028016
             les_mean =     296.731393584087
             stat err =       0.000296460563
             autocorr =       1.173786755180
              std dev =       0.547270857751
             le_variance =       0.299505391743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299179429584
                                         uncertainty =       0.001439268705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299179429584
                                         uncertainty =       0.001439268705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273523548
  error estimate for blocks of size 2^( 2) =       0.000280503616
  error estimate for blocks of size 2^( 3) =       0.000286793490
  error estimate for blocks of size 2^( 4) =       0.000291483197
  error estimate for blocks of size 2^( 5) =       0.000294518915
  error estimate for blocks of size 2^( 6) =       0.000296066880
  error estimate for blocks of size 2^( 7) =       0.000297230944
  error estimate for blocks of size 2^( 8) =       0.000297490094

      target function =                  N/A
              le_mean =     -17.216639661550
             les_mean =     296.726444384976
             stat err =       0.000296326708
             autocorr =       1.173686611961
              std dev =       0.547047096178
             le_variance =       0.299260525437


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216643365421        initial
     6.1035e-02     6.1035e-01             1.0301e-03       -17.216672016148  <--
     2.4414e-01     2.4414e+00             5.6927e-04       -17.216649028016
     9.7656e-01     9.7656e+00             2.0573e-04       -17.216639661550

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 4.5024e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -4.027079e-02 3 1  ON 0
ci_002                -3.033418e-02 3 1  ON 1
ci_003                -2.447805e-02 3 1  ON 2
ci_004                 2.157987e-02 3 1  ON 3
ci_005                 2.057519e-02 3 1  ON 4
ci_006                -1.884033e-02 3 1  ON 5
ci_007                -1.824279e-02 3 1  ON 6
ci_008                -1.786664e-02 3 1  ON 7
ci_009                -1.784788e-02 3 1  ON 8
ci_010                -1.772300e-02 3 1  ON 9
ci_011                -1.655858e-02 3 1  ON 10
ci_012                -1.589310e-02 3 1  ON 11
ci_013                -1.812973e-02 3 1  ON 12
ci_014                 1.323666e-02 3 1  ON 13
ci_015                 1.395914e-02 3 1  ON 14
ci_016                 1.625515e-02 3 1  ON 15
ci_017                 1.690309e-02 3 1  ON 16
ci_018                 1.292434e-02 3 1  ON 17
ci_019                 1.299770e-02 3 1  ON 18
ci_020                 1.353608e-02 3 1  ON 19
ci_021                 1.313140e-02 3 1  ON 20
ci_022                 1.120310e-02 3 1  ON 21
ci_023                 1.163741e-02 3 1  ON 22
ci_024                 1.117494e-02 3 1  ON 23
ci_025                 1.177809e-02 3 1  ON 24
ci_026                 1.162849e-02 3 1  ON 25
ci_027                 1.126342e-02 3 1  ON 26
ci_028                -1.438393e-02 3 1  ON 27
ci_029                -1.358529e-02 3 1  ON 28
ci_030                -1.081028e-02 3 1  ON 29
ci_031                -1.154499e-02 3 1  ON 30
ci_032                -1.366939e-02 3 1  ON 31
ci_033                 1.003211e-02 3 1  ON 32
ci_034                 1.007771e-02 3 1  ON 33
ci_035                -4.674591e-03 3 1  ON 34
ci_036                -1.002901e-02 3 1  ON 35
ci_037                -9.797279e-03 3 1  ON 36
ci_038                 1.792903e-03 3 1  ON 37
ci_039                 1.778359e-03 3 1  ON 38
ci_040                -4.054351e-03 3 1  ON 39
ci_041                 9.897388e-03 3 1  ON 40
ci_042                 9.980858e-03 3 1  ON 41
ci_043                -3.243419e-03 3 1  ON 42
ci_044                -1.479402e-02 3 1  ON 43
ci_045                -1.832524e-03 3 1  ON 44
ci_046                 5.464117e-03 3 1  ON 45
ci_047                 5.599280e-03 3 1  ON 46
ci_048                -1.214051e-02 3 1  ON 47
ci_049                -1.237666e-02 3 1  ON 48
ci_050                 7.325764e-03 3 1  ON 49
ci_051                 7.632425e-03 3 1  ON 50
ci_052                -6.462398e-03 3 1  ON 51
ci_053                -6.627389e-03 3 1  ON 52
ci_054                -3.079742e-03 3 1  ON 53
ci_055                -2.504193e-03 3 1  ON 54
ci_056                 4.576851e-03 3 1  ON 55
ci_057                 4.499083e-03 3 1  ON 56
ci_058                -6.996320e-03 3 1  ON 57
ci_059                -6.712578e-03 3 1  ON 58
ci_060                 8.590490e-03 3 1  ON 59
ci_061                 8.050874e-03 3 1  ON 60
ci_062                -3.107244e-03 3 1  ON 61
ci_063                -3.106091e-03 3 1  ON 62
ci_064                -2.879678e-03 3 1  ON 63
ci_065                -4.037088e-03 3 1  ON 64
ci_066                 5.616140e-03 3 1  ON 65
ci_067                 5.475985e-03 3 1  ON 66
ci_068                -4.700772e-03 3 1  ON 67
ci_069                -5.417715e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9224e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2092
    reference variance = 0.405521
====================================================
  Execution time = 2.7198e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0571e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 4.4012e-01
  Total weights = 3.913482094e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9060e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386536362212
                                         uncertainty =       0.087923178904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386536362212
                                         uncertainty =       0.087923178904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000310746811
  error estimate for blocks of size 2^( 2) =       0.000317044417
  error estimate for blocks of size 2^( 3) =       0.000322893954
  error estimate for blocks of size 2^( 4) =       0.000327215917
  error estimate for blocks of size 2^( 5) =       0.000330179856
  error estimate for blocks of size 2^( 6) =       0.000332060894
  error estimate for blocks of size 2^( 7) =       0.000332352368
  error estimate for blocks of size 2^( 8) =       0.000334044431

      target function =                  N/A
              le_mean =     -17.216736876763
             les_mean =     296.856151497077
             stat err =       0.000332159387
             autocorr =       1.142561803005
              std dev =       0.621493621678
             le_variance =       0.386254321786


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721673687676e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216736876803       residual = 1.28e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216637942517       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216616596952       residual = 6.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216620306516       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216622366982       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216622420783       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216622401618       residual = 1.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-02 is 3.828759e-02

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216736876803       residual = 1.28e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216654051248       residual = 7.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216641596034       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216644920960       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216646383971       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216646489694       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-02 is 3.106254e-02

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216736876803       residual = 1.28e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216686718390       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216686548033       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216688437920       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216688852317       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 1.812089e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.342459 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2114e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -3.718409e-02 3 1  ON 0
ci_002                -2.294014e-02 3 1  ON 1
ci_003                -2.490206e-02 3 1  ON 2
ci_004                 1.924604e-02 3 1  ON 3
ci_005                 2.058715e-02 3 1  ON 4
ci_006                -2.007788e-02 3 1  ON 5
ci_007                -4.930533e-02 3 1  ON 6
ci_008                -4.477026e-03 3 1  ON 7
ci_009                -1.820613e-02 3 1  ON 8
ci_010                -1.645137e-02 3 1  ON 9
ci_011                -1.677255e-02 3 1  ON 10
ci_012                -1.624634e-02 3 1  ON 11
ci_013                -1.790839e-02 3 1  ON 12
ci_014                 1.619421e-02 3 1  ON 13
ci_015                 1.351806e-02 3 1  ON 14
ci_016                 9.195584e-03 3 1  ON 15
ci_017                 1.677096e-02 3 1  ON 16
ci_018                 1.604803e-02 3 1  ON 17
ci_019                 4.287438e-02 3 1  ON 18
ci_020                 2.226863e-02 3 1  ON 19
ci_021                 1.299380e-02 3 1  ON 20
ci_022                 1.086661e-02 3 1  ON 21
ci_023                 1.673129e-02 3 1  ON 22
ci_024                 1.161703e-02 3 1  ON 23
ci_025                 3.710201e-03 3 1  ON 24
ci_026                -2.224610e-03 3 1  ON 25
ci_027                 8.722605e-03 3 1  ON 26
ci_028                -1.421722e-02 3 1  ON 27
ci_029                -1.017348e-02 3 1  ON 28
ci_030                -1.152446e-02 3 1  ON 29
ci_031                -1.662869e-02 3 1  ON 30
ci_032                -1.802436e-02 3 1  ON 31
ci_033                 2.037924e-02 3 1  ON 32
ci_034                 9.184401e-03 3 1  ON 33
ci_035                -4.607665e-03 3 1  ON 34
ci_036                -9.616306e-03 3 1  ON 35
ci_037                -5.820104e-03 3 1  ON 36
ci_038                 6.839752e-03 3 1  ON 37
ci_039                 2.142549e-03 3 1  ON 38
ci_040                -3.907068e-03 3 1  ON 39
ci_041                 9.829282e-03 3 1  ON 40
ci_042                 1.995632e-02 3 1  ON 41
ci_043                -3.140763e-03 3 1  ON 42
ci_044                -1.524325e-02 3 1  ON 43
ci_045                -2.449958e-03 3 1  ON 44
ci_046                 4.842648e-03 3 1  ON 45
ci_047                 6.349821e-03 3 1  ON 46
ci_048                -1.182999e-02 3 1  ON 47
ci_049                -9.029047e-03 3 1  ON 48
ci_050                -1.472849e-02 3 1  ON 49
ci_051                 3.128800e-03 3 1  ON 50
ci_052                -1.586741e-02 3 1  ON 51
ci_053                -1.184313e-02 3 1  ON 52
ci_054                 3.160870e-03 3 1  ON 53
ci_055                -2.308213e-03 3 1  ON 54
ci_056                 5.093402e-03 3 1  ON 55
ci_057                 4.583851e-03 3 1  ON 56
ci_058                -6.613197e-03 3 1  ON 57
ci_059                 1.494094e-02 3 1  ON 58
ci_060                 1.429847e-02 3 1  ON 59
ci_061                 9.148456e-03 3 1  ON 60
ci_062                -3.663360e-03 3 1  ON 61
ci_063                -3.463148e-03 3 1  ON 62
ci_064                -4.634152e-03 3 1  ON 63
ci_065                -5.705499e-03 3 1  ON 64
ci_066                 6.858321e-03 3 1  ON 65
ci_067                 5.021248e-03 3 1  ON 66
ci_068                -4.756014e-03 3 1  ON 67
ci_069                -1.458653e-02 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1127
    reference variance = 0.301999
====================================================
  Execution time = 2.6932e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.7019e-01
  Total weights = 3.9102e+06
  Execution time = 3.6369e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0763154
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       6.403316763852
                                         uncertainty =       3.378465444426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       6.403316763852
                                         uncertainty =       3.378465444426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001264444204
  error estimate for blocks of size 2^( 2) =       0.001265837984
  error estimate for blocks of size 2^( 3) =       0.001266962596
  error estimate for blocks of size 2^( 4) =       0.001268259498
  error estimate for blocks of size 2^( 5) =       0.001269119857
  error estimate for blocks of size 2^( 6) =       0.001269938448
  error estimate for blocks of size 2^( 7) =       0.001270027537
  error estimate for blocks of size 2^( 8) =       0.001269072018

      target function =                  N/A
              le_mean =     -17.216808502434
             les_mean =     304.697509750704
             stat err =       0.001269539465
             autocorr =       1.008075527075
              std dev =       2.528888408654
             le_variance =       6.395276583424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.380235321830
                                         uncertainty =       0.003130589208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.380235321830
                                         uncertainty =       0.003130589208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000308282068
  error estimate for blocks of size 2^( 2) =       0.000316143643
  error estimate for blocks of size 2^( 3) =       0.000322816702
  error estimate for blocks of size 2^( 4) =       0.000327926440
  error estimate for blocks of size 2^( 5) =       0.000330670999
  error estimate for blocks of size 2^( 6) =       0.000332413867
  error estimate for blocks of size 2^( 7) =       0.000332625427
  error estimate for blocks of size 2^( 8) =       0.000332547507

      target function =                  N/A
              le_mean =     -17.206739234470
             les_mean =     296.585475280521
             stat err =       0.000332064450
             autocorr =       1.160241082140
              std dev =       0.616564136520
             le_variance =       0.380151334443

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0815583
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =     237.729743771538
                                         uncertainty =     212.026450763187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =     237.729743771538
                                         uncertainty =     212.026450763187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.007702890701
  error estimate for blocks of size 2^( 2) =       0.007703352300
  error estimate for blocks of size 2^( 3) =       0.007703937826
  error estimate for blocks of size 2^( 4) =       0.007704879865
  error estimate for blocks of size 2^( 5) =       0.007705325599
  error estimate for blocks of size 2^( 6) =       0.007710169560
  error estimate for blocks of size 2^( 7) =       0.007709015893
  error estimate for blocks of size 2^( 8) =       0.007705615141

      target function =                  N/A
              le_mean =     -17.207629726996
             les_mean =     561.726591065804
             stat err =       0.007707531548
             autocorr =       1.001205325545
              std dev =      15.405781401846
             le_variance =     237.338100601473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.320626213148
                                         uncertainty =       1.967266525766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.320626213148
                                         uncertainty =       1.967266525766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000761036428
  error estimate for blocks of size 2^( 2) =       0.000763833545
  error estimate for blocks of size 2^( 3) =       0.000766643202
  error estimate for blocks of size 2^( 4) =       0.000768720129
  error estimate for blocks of size 2^( 5) =       0.000769648345
  error estimate for blocks of size 2^( 6) =       0.000770477598
  error estimate for blocks of size 2^( 7) =       0.000770467011
  error estimate for blocks of size 2^( 8) =       0.000768759927

      target function =                  N/A
              le_mean =     -17.208464966263
             les_mean =     302.209171649568
             stat err =       0.000769838220
             autocorr =       1.023264829303
              std dev =       1.522072855362
             le_variance =       2.316705777031


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216808502434        initial  <--
     1.5259e-02     1.5259e-01             3.8288e-02       -17.206739234470
     6.1035e-02     6.1035e-01             3.1063e-02       -17.207629726996
     2.4414e-01     2.4414e+00             1.8121e-02       -17.208464966263

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.2734
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -4.027079e-02 3 1  ON 0
ci_002                -3.033418e-02 3 1  ON 1
ci_003                -2.447805e-02 3 1  ON 2
ci_004                 2.157987e-02 3 1  ON 3
ci_005                 2.057519e-02 3 1  ON 4
ci_006                -1.884033e-02 3 1  ON 5
ci_007                -1.824279e-02 3 1  ON 6
ci_008                -1.786664e-02 3 1  ON 7
ci_009                -1.784788e-02 3 1  ON 8
ci_010                -1.772300e-02 3 1  ON 9
ci_011                -1.655858e-02 3 1  ON 10
ci_012                -1.589310e-02 3 1  ON 11
ci_013                -1.812973e-02 3 1  ON 12
ci_014                 1.323666e-02 3 1  ON 13
ci_015                 1.395914e-02 3 1  ON 14
ci_016                 1.625515e-02 3 1  ON 15
ci_017                 1.690309e-02 3 1  ON 16
ci_018                 1.292434e-02 3 1  ON 17
ci_019                 1.299770e-02 3 1  ON 18
ci_020                 1.353608e-02 3 1  ON 19
ci_021                 1.313140e-02 3 1  ON 20
ci_022                 1.120310e-02 3 1  ON 21
ci_023                 1.163741e-02 3 1  ON 22
ci_024                 1.117494e-02 3 1  ON 23
ci_025                 1.177809e-02 3 1  ON 24
ci_026                 1.162849e-02 3 1  ON 25
ci_027                 1.126342e-02 3 1  ON 26
ci_028                -1.438393e-02 3 1  ON 27
ci_029                -1.358529e-02 3 1  ON 28
ci_030                -1.081028e-02 3 1  ON 29
ci_031                -1.154499e-02 3 1  ON 30
ci_032                -1.366939e-02 3 1  ON 31
ci_033                 1.003211e-02 3 1  ON 32
ci_034                 1.007771e-02 3 1  ON 33
ci_035                -4.674591e-03 3 1  ON 34
ci_036                -1.002901e-02 3 1  ON 35
ci_037                -9.797279e-03 3 1  ON 36
ci_038                 1.792903e-03 3 1  ON 37
ci_039                 1.778359e-03 3 1  ON 38
ci_040                -4.054351e-03 3 1  ON 39
ci_041                 9.897388e-03 3 1  ON 40
ci_042                 9.980858e-03 3 1  ON 41
ci_043                -3.243419e-03 3 1  ON 42
ci_044                -1.479402e-02 3 1  ON 43
ci_045                -1.832524e-03 3 1  ON 44
ci_046                 5.464117e-03 3 1  ON 45
ci_047                 5.599280e-03 3 1  ON 46
ci_048                -1.214051e-02 3 1  ON 47
ci_049                -1.237666e-02 3 1  ON 48
ci_050                 7.325764e-03 3 1  ON 49
ci_051                 7.632425e-03 3 1  ON 50
ci_052                -6.462398e-03 3 1  ON 51
ci_053                -6.627389e-03 3 1  ON 52
ci_054                -3.079742e-03 3 1  ON 53
ci_055                -2.504193e-03 3 1  ON 54
ci_056                 4.576851e-03 3 1  ON 55
ci_057                 4.499083e-03 3 1  ON 56
ci_058                -6.996320e-03 3 1  ON 57
ci_059                -6.712578e-03 3 1  ON 58
ci_060                 8.590490e-03 3 1  ON 59
ci_061                 8.050874e-03 3 1  ON 60
ci_062                -3.107244e-03 3 1  ON 61
ci_063                -3.106091e-03 3 1  ON 62
ci_064                -2.879678e-03 3 1  ON 63
ci_065                -4.037088e-03 3 1  ON 64
ci_066                 5.616140e-03 3 1  ON 65
ci_067                 5.475985e-03 3 1  ON 66
ci_068                -4.700772e-03 3 1  ON 67
ci_069                -5.417715e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7400e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2211
    reference variance = 0.381521
====================================================
  Execution time = 2.7165e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0561e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1638e-01
  Total weights = 3.913313965e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9546e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300038941651
                                         uncertainty =       0.001261411584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300038941651
                                         uncertainty =       0.001261411584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273923158
  error estimate for blocks of size 2^( 2) =       0.000281001895
  error estimate for blocks of size 2^( 3) =       0.000287314530
  error estimate for blocks of size 2^( 4) =       0.000292470901
  error estimate for blocks of size 2^( 5) =       0.000295139330
  error estimate for blocks of size 2^( 6) =       0.000296003488
  error estimate for blocks of size 2^( 7) =       0.000297201845
  error estimate for blocks of size 2^( 8) =       0.000299295280

      target function =                  N/A
              le_mean =     -17.216292356319
             les_mean =     296.717098844337
             stat err =       0.000296909986
             autocorr =       1.174876205383
              std dev =       0.547846316170
             le_variance =       0.300135586141


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721629235632e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216292356331       residual = 7.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216295939527       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216296119828       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216296141671       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 7.919735e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216292356331       residual = 7.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216294044852       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216294208521       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 3.232864e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216292356331       residual = 7.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216292898381       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216292973042       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 9.590696e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.343619 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2126e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -4.030383e-02 3 1  ON 0
ci_002                -3.030992e-02 3 1  ON 1
ci_003                -2.464805e-02 3 1  ON 2
ci_004                 2.159050e-02 3 1  ON 3
ci_005                 2.061583e-02 3 1  ON 4
ci_006                -1.888395e-02 3 1  ON 5
ci_007                -1.831426e-02 3 1  ON 6
ci_008                -1.785545e-02 3 1  ON 7
ci_009                -1.757178e-02 3 1  ON 8
ci_010                -1.771637e-02 3 1  ON 9
ci_011                -1.656172e-02 3 1  ON 10
ci_012                -1.603474e-02 3 1  ON 11
ci_013                -1.822223e-02 3 1  ON 12
ci_014                 1.310412e-02 3 1  ON 13
ci_015                 1.403485e-02 3 1  ON 14
ci_016                 1.632976e-02 3 1  ON 15
ci_017                 1.692566e-02 3 1  ON 16
ci_018                 1.291583e-02 3 1  ON 17
ci_019                 1.284849e-02 3 1  ON 18
ci_020                 1.347954e-02 3 1  ON 19
ci_021                 1.324469e-02 3 1  ON 20
ci_022                 1.129977e-02 3 1  ON 21
ci_023                 1.156062e-02 3 1  ON 22
ci_024                 1.149823e-02 3 1  ON 23
ci_025                 1.181711e-02 3 1  ON 24
ci_026                 1.150554e-02 3 1  ON 25
ci_027                 1.136754e-02 3 1  ON 26
ci_028                -1.434962e-02 3 1  ON 27
ci_029                -1.380473e-02 3 1  ON 28
ci_030                -1.072335e-02 3 1  ON 29
ci_031                -1.137184e-02 3 1  ON 30
ci_032                -1.369206e-02 3 1  ON 31
ci_033                 1.029564e-02 3 1  ON 32
ci_034                 9.932301e-03 3 1  ON 33
ci_035                -4.699165e-03 3 1  ON 34
ci_036                -1.001152e-02 3 1  ON 35
ci_037                -9.905020e-03 3 1  ON 36
ci_038                 1.654284e-03 3 1  ON 37
ci_039                 1.596983e-03 3 1  ON 38
ci_040                -4.091988e-03 3 1  ON 39
ci_041                 9.843619e-03 3 1  ON 40
ci_042                 9.955231e-03 3 1  ON 41
ci_043                -3.200713e-03 3 1  ON 42
ci_044                -1.454007e-02 3 1  ON 43
ci_045                -1.870768e-03 3 1  ON 44
ci_046                 5.663166e-03 3 1  ON 45
ci_047                 5.619555e-03 3 1  ON 46
ci_048                -1.206189e-02 3 1  ON 47
ci_049                -1.229116e-02 3 1  ON 48
ci_050                 7.305566e-03 3 1  ON 49
ci_051                 7.624445e-03 3 1  ON 50
ci_052                -6.517484e-03 3 1  ON 51
ci_053                -6.487757e-03 3 1  ON 52
ci_054                -3.054845e-03 3 1  ON 53
ci_055                -2.764074e-03 3 1  ON 54
ci_056                 4.433222e-03 3 1  ON 55
ci_057                 4.408563e-03 3 1  ON 56
ci_058                -6.970470e-03 3 1  ON 57
ci_059                -6.808581e-03 3 1  ON 58
ci_060                 8.664077e-03 3 1  ON 59
ci_061                 8.274725e-03 3 1  ON 60
ci_062                -3.182047e-03 3 1  ON 61
ci_063                -3.217702e-03 3 1  ON 62
ci_064                -2.947871e-03 3 1  ON 63
ci_065                -4.175780e-03 3 1  ON 64
ci_066                 5.668834e-03 3 1  ON 65
ci_067                 5.584432e-03 3 1  ON 66
ci_068                -4.629653e-03 3 1  ON 67
ci_069                -5.348523e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2883
    reference variance = 0.292746
====================================================
  Execution time = 2.6695e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1497e-01
  Total weights = 3.9130e+06
  Execution time = 3.6429e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000204072
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299628399659
                                         uncertainty =       0.001928479367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299628399659
                                         uncertainty =       0.001928479367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273695864
  error estimate for blocks of size 2^( 2) =       0.000280781065
  error estimate for blocks of size 2^( 3) =       0.000287109088
  error estimate for blocks of size 2^( 4) =       0.000291925312
  error estimate for blocks of size 2^( 5) =       0.000294508998
  error estimate for blocks of size 2^( 6) =       0.000296686322
  error estimate for blocks of size 2^( 7) =       0.000296858114
  error estimate for blocks of size 2^( 8) =       0.000297597837

      target function =                  N/A
              le_mean =     -17.216705039442
             les_mean =     296.730635327055
             stat err =       0.000296412818
             autocorr =       1.172890561006
              std dev =       0.547391728042
             le_variance =       0.299637703929

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000182893
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299675056972
                                         uncertainty =       0.001957914548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299675056972
                                         uncertainty =       0.001957914548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273716593
  error estimate for blocks of size 2^( 2) =       0.000280810811
  error estimate for blocks of size 2^( 3) =       0.000287139839
  error estimate for blocks of size 2^( 4) =       0.000291969135
  error estimate for blocks of size 2^( 5) =       0.000294558432
  error estimate for blocks of size 2^( 6) =       0.000296736407
  error estimate for blocks of size 2^( 7) =       0.000296907338
  error estimate for blocks of size 2^( 8) =       0.000297643727

      target function =                  N/A
              le_mean =     -17.216703801644
             les_mean =     296.772017546591
             stat err =       0.000296461476
             autocorr =       1.173097968757
              std dev =       0.547433185350
             le_variance =       0.299683092423

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000204702
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299634436093
                                         uncertainty =       0.001955285703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299634436093
                                         uncertainty =       0.001955285703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273698099
  error estimate for blocks of size 2^( 2) =       0.000280792812
  error estimate for blocks of size 2^( 3) =       0.000287123630
  error estimate for blocks of size 2^( 4) =       0.000291948865
  error estimate for blocks of size 2^( 5) =       0.000294539542
  error estimate for blocks of size 2^( 6) =       0.000296726969
  error estimate for blocks of size 2^( 7) =       0.000296895489
  error estimate for blocks of size 2^( 8) =       0.000297627877

      target function =                  N/A
              le_mean =     -17.216707110459
             les_mean =     296.737477609560
             stat err =       0.000296447469
             autocorr =       1.173145647097
              std dev =       0.547396197487
             le_variance =       0.299642597024

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00062738
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299616727663
                                         uncertainty =       0.001932208801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299616727663
                                         uncertainty =       0.001932208801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273690452
  error estimate for blocks of size 2^( 2) =       0.000280777292
  error estimate for blocks of size 2^( 3) =       0.000287106353
  error estimate for blocks of size 2^( 4) =       0.000291923993
  error estimate for blocks of size 2^( 5) =       0.000294508721
  error estimate for blocks of size 2^( 6) =       0.000296688639
  error estimate for blocks of size 2^( 7) =       0.000296859967
  error estimate for blocks of size 2^( 8) =       0.000297598476

      target function =                  N/A
              le_mean =     -17.216704129241
             les_mean =     296.731555227506
             stat err =       0.000296413951
             autocorr =       1.172945916519
              std dev =       0.547380903596
             le_variance =       0.299625853622


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216705039442        initial
     1.5259e-01     1.5259e+00             7.9197e-04       -17.216703801644
     6.1035e-01     6.1035e+00             3.2329e-04       -17.216707110459  <--
     2.4414e+00     2.4414e+01             9.5907e-05       -17.216704129241

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 4.5067e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -4.030383e-02 3 1  ON 0
ci_002                -3.030992e-02 3 1  ON 1
ci_003                -2.464805e-02 3 1  ON 2
ci_004                 2.159050e-02 3 1  ON 3
ci_005                 2.061583e-02 3 1  ON 4
ci_006                -1.888395e-02 3 1  ON 5
ci_007                -1.831426e-02 3 1  ON 6
ci_008                -1.785545e-02 3 1  ON 7
ci_009                -1.757178e-02 3 1  ON 8
ci_010                -1.771637e-02 3 1  ON 9
ci_011                -1.656172e-02 3 1  ON 10
ci_012                -1.603474e-02 3 1  ON 11
ci_013                -1.822223e-02 3 1  ON 12
ci_014                 1.310412e-02 3 1  ON 13
ci_015                 1.403485e-02 3 1  ON 14
ci_016                 1.632976e-02 3 1  ON 15
ci_017                 1.692566e-02 3 1  ON 16
ci_018                 1.291583e-02 3 1  ON 17
ci_019                 1.284849e-02 3 1  ON 18
ci_020                 1.347954e-02 3 1  ON 19
ci_021                 1.324469e-02 3 1  ON 20
ci_022                 1.129977e-02 3 1  ON 21
ci_023                 1.156062e-02 3 1  ON 22
ci_024                 1.149823e-02 3 1  ON 23
ci_025                 1.181711e-02 3 1  ON 24
ci_026                 1.150554e-02 3 1  ON 25
ci_027                 1.136754e-02 3 1  ON 26
ci_028                -1.434962e-02 3 1  ON 27
ci_029                -1.380473e-02 3 1  ON 28
ci_030                -1.072335e-02 3 1  ON 29
ci_031                -1.137184e-02 3 1  ON 30
ci_032                -1.369206e-02 3 1  ON 31
ci_033                 1.029564e-02 3 1  ON 32
ci_034                 9.932301e-03 3 1  ON 33
ci_035                -4.699165e-03 3 1  ON 34
ci_036                -1.001152e-02 3 1  ON 35
ci_037                -9.905020e-03 3 1  ON 36
ci_038                 1.654284e-03 3 1  ON 37
ci_039                 1.596983e-03 3 1  ON 38
ci_040                -4.091988e-03 3 1  ON 39
ci_041                 9.843619e-03 3 1  ON 40
ci_042                 9.955231e-03 3 1  ON 41
ci_043                -3.200713e-03 3 1  ON 42
ci_044                -1.454007e-02 3 1  ON 43
ci_045                -1.870768e-03 3 1  ON 44
ci_046                 5.663166e-03 3 1  ON 45
ci_047                 5.619555e-03 3 1  ON 46
ci_048                -1.206189e-02 3 1  ON 47
ci_049                -1.229116e-02 3 1  ON 48
ci_050                 7.305566e-03 3 1  ON 49
ci_051                 7.624445e-03 3 1  ON 50
ci_052                -6.517484e-03 3 1  ON 51
ci_053                -6.487757e-03 3 1  ON 52
ci_054                -3.054845e-03 3 1  ON 53
ci_055                -2.764074e-03 3 1  ON 54
ci_056                 4.433222e-03 3 1  ON 55
ci_057                 4.408563e-03 3 1  ON 56
ci_058                -6.970470e-03 3 1  ON 57
ci_059                -6.808581e-03 3 1  ON 58
ci_060                 8.664077e-03 3 1  ON 59
ci_061                 8.274725e-03 3 1  ON 60
ci_062                -3.182047e-03 3 1  ON 61
ci_063                -3.217702e-03 3 1  ON 62
ci_064                -2.947871e-03 3 1  ON 63
ci_065                -4.175780e-03 3 1  ON 64
ci_066                 5.668834e-03 3 1  ON 65
ci_067                 5.584432e-03 3 1  ON 66
ci_068                -4.629653e-03 3 1  ON 67
ci_069                -5.348523e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7208e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1271
    reference variance = 0.157235
====================================================
  Execution time = 2.6872e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0560e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1637e-01
  Total weights = 3.913428367e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9263e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301819768217
                                         uncertainty =       0.001694576371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301819768217
                                         uncertainty =       0.001694576371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274681756
  error estimate for blocks of size 2^( 2) =       0.000281782102
  error estimate for blocks of size 2^( 3) =       0.000288292447
  error estimate for blocks of size 2^( 4) =       0.000292984576
  error estimate for blocks of size 2^( 5) =       0.000296051547
  error estimate for blocks of size 2^( 6) =       0.000297619059
  error estimate for blocks of size 2^( 7) =       0.000298330218
  error estimate for blocks of size 2^( 8) =       0.000298967925

      target function =                  N/A
              le_mean =     -17.216611050289
             les_mean =     296.728062217055
             stat err =       0.000297742187
             autocorr =       1.174954690305
              std dev =       0.549363511922
             le_variance =       0.301800268232


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721661105029e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216611050315       residual = 8.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216615525226       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216615533841       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216615856626       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 7.025213e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216611050315       residual = 8.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216613113950       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216613046183       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216613068269       residual = 2.12e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 2.903651e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216611050315       residual = 8.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216611704322       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216611674531       residual = 5.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 8.977072e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.344851 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1806e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -4.031270e-02 3 1  ON 0
ci_002                -3.032598e-02 3 1  ON 1
ci_003                -2.480013e-02 3 1  ON 2
ci_004                 2.134797e-02 3 1  ON 3
ci_005                 2.049138e-02 3 1  ON 4
ci_006                -1.888540e-02 3 1  ON 5
ci_007                -1.832618e-02 3 1  ON 6
ci_008                -1.783522e-02 3 1  ON 7
ci_009                -1.765251e-02 3 1  ON 8
ci_010                -1.746383e-02 3 1  ON 9
ci_011                -1.650595e-02 3 1  ON 10
ci_012                -1.624833e-02 3 1  ON 11
ci_013                -1.851259e-02 3 1  ON 12
ci_014                 1.323740e-02 3 1  ON 13
ci_015                 1.383217e-02 3 1  ON 14
ci_016                 1.634355e-02 3 1  ON 15
ci_017                 1.675313e-02 3 1  ON 16
ci_018                 1.289102e-02 3 1  ON 17
ci_019                 1.270035e-02 3 1  ON 18
ci_020                 1.337715e-02 3 1  ON 19
ci_021                 1.315560e-02 3 1  ON 20
ci_022                 1.152060e-02 3 1  ON 21
ci_023                 1.151262e-02 3 1  ON 22
ci_024                 1.157661e-02 3 1  ON 23
ci_025                 1.173293e-02 3 1  ON 24
ci_026                 1.150990e-02 3 1  ON 25
ci_027                 1.118702e-02 3 1  ON 26
ci_028                -1.455632e-02 3 1  ON 27
ci_029                -1.404499e-02 3 1  ON 28
ci_030                -1.071151e-02 3 1  ON 29
ci_031                -1.119174e-02 3 1  ON 30
ci_032                -1.355521e-02 3 1  ON 31
ci_033                 1.044385e-02 3 1  ON 32
ci_034                 9.894500e-03 3 1  ON 33
ci_035                -4.665562e-03 3 1  ON 34
ci_036                -1.007969e-02 3 1  ON 35
ci_037                -9.872390e-03 3 1  ON 36
ci_038                 1.738107e-03 3 1  ON 37
ci_039                 1.668639e-03 3 1  ON 38
ci_040                -4.070405e-03 3 1  ON 39
ci_041                 9.873868e-03 3 1  ON 40
ci_042                 9.946422e-03 3 1  ON 41
ci_043                -3.277992e-03 3 1  ON 42
ci_044                -1.444072e-02 3 1  ON 43
ci_045                -1.848123e-03 3 1  ON 44
ci_046                 5.565783e-03 3 1  ON 45
ci_047                 5.585447e-03 3 1  ON 46
ci_048                -1.209989e-02 3 1  ON 47
ci_049                -1.220625e-02 3 1  ON 48
ci_050                 7.300752e-03 3 1  ON 49
ci_051                 7.631143e-03 3 1  ON 50
ci_052                -6.708941e-03 3 1  ON 51
ci_053                -6.380359e-03 3 1  ON 52
ci_054                -3.218502e-03 3 1  ON 53
ci_055                -2.705183e-03 3 1  ON 54
ci_056                 4.581853e-03 3 1  ON 55
ci_057                 4.249461e-03 3 1  ON 56
ci_058                -6.791112e-03 3 1  ON 57
ci_059                -6.700112e-03 3 1  ON 58
ci_060                 8.666147e-03 3 1  ON 59
ci_061                 8.164072e-03 3 1  ON 60
ci_062                -3.190074e-03 3 1  ON 61
ci_063                -3.074268e-03 3 1  ON 62
ci_064                -3.122489e-03 3 1  ON 63
ci_065                -4.249769e-03 3 1  ON 64
ci_066                 5.791316e-03 3 1  ON 65
ci_067                 5.603957e-03 3 1  ON 66
ci_068                -4.481449e-03 3 1  ON 67
ci_069                -5.064710e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.185
    reference variance = 0.163844
====================================================
  Execution time = 2.6631e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1372e-01
  Total weights = 3.9133e+06
  Execution time = 3.6294e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297688832045
                                         uncertainty =       0.001385819127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297688832045
                                         uncertainty =       0.001385819127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272805044
  error estimate for blocks of size 2^( 2) =       0.000279901363
  error estimate for blocks of size 2^( 3) =       0.000286155456
  error estimate for blocks of size 2^( 4) =       0.000290829848
  error estimate for blocks of size 2^( 5) =       0.000293488251
  error estimate for blocks of size 2^( 6) =       0.000294983201
  error estimate for blocks of size 2^( 7) =       0.000296062753
  error estimate for blocks of size 2^( 8) =       0.000295722139

      target function =                  N/A
              le_mean =     -17.216366162380
             les_mean =     296.742619031949
             stat err =       0.000295064086
             autocorr =       1.169843893141
              std dev =       0.545610087720
             le_variance =       0.297690367822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297485238984
                                         uncertainty =       0.001378686088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297485238984
                                         uncertainty =       0.001378686088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272712185
  error estimate for blocks of size 2^( 2) =       0.000279814393
  error estimate for blocks of size 2^( 3) =       0.000286073640
  error estimate for blocks of size 2^( 4) =       0.000290745439
  error estimate for blocks of size 2^( 5) =       0.000293418221
  error estimate for blocks of size 2^( 6) =       0.000294907807
  error estimate for blocks of size 2^( 7) =       0.000295995671
  error estimate for blocks of size 2^( 8) =       0.000295682890

      target function =                  N/A
              le_mean =     -17.216363717595
             les_mean =     296.718979093850
             stat err =       0.000295001147
             autocorr =       1.170141342719
              std dev =       0.545424370242
             le_variance =       0.297487743653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297504085073
                                         uncertainty =       0.001379243922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297504085073
                                         uncertainty =       0.001379243922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272720766
  error estimate for blocks of size 2^( 2) =       0.000279822573
  error estimate for blocks of size 2^( 3) =       0.000286081184
  error estimate for blocks of size 2^( 4) =       0.000290753193
  error estimate for blocks of size 2^( 5) =       0.000293424065
  error estimate for blocks of size 2^( 6) =       0.000294914873
  error estimate for blocks of size 2^( 7) =       0.000296000360
  error estimate for blocks of size 2^( 8) =       0.000295683950

      target function =                  N/A
              le_mean =     -17.216362888153
             les_mean =     296.717146464471
             stat err =       0.000295005812
             autocorr =       1.170104708910
              std dev =       0.545441532847
             le_variance =       0.297506465754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297643805455
                                         uncertainty =       0.001383582792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297643805455
                                         uncertainty =       0.001383582792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272784478
  error estimate for blocks of size 2^( 2) =       0.000279880912
  error estimate for blocks of size 2^( 3) =       0.000286135295
  error estimate for blocks of size 2^( 4) =       0.000290809012
  error estimate for blocks of size 2^( 5) =       0.000293469051
  error estimate for blocks of size 2^( 6) =       0.000294960104
  error estimate for blocks of size 2^( 7) =       0.000296046240
  error estimate for blocks of size 2^( 8) =       0.000295711791

      target function =                  N/A
              le_mean =     -17.216366280767
             les_mean =     296.719490812110
             stat err =       0.000295046797
             autocorr =       1.169883183642
              std dev =       0.545568956160
             le_variance =       0.297645485926


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216366162380        initial
     1.5259e-01     1.5259e+00             7.0252e-04       -17.216363717595
     6.1035e-01     6.1035e+00             2.9037e-04       -17.216362888153
     2.4414e+00     2.4414e+01             8.9771e-05       -17.216366280767  <--

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 4.4933e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -4.030414e-02 3 1  ON 0
ci_002                -3.031479e-02 3 1  ON 1
ci_003                -2.469391e-02 3 1  ON 2
ci_004                 2.151833e-02 3 1  ON 3
ci_005                 2.057928e-02 3 1  ON 4
ci_006                -1.888368e-02 3 1  ON 5
ci_007                -1.831764e-02 3 1  ON 6
ci_008                -1.784885e-02 3 1  ON 7
ci_009                -1.759655e-02 3 1  ON 8
ci_010                -1.764121e-02 3 1  ON 9
ci_011                -1.654434e-02 3 1  ON 10
ci_012                -1.610113e-02 3 1  ON 11
ci_013                -1.830864e-02 3 1  ON 12
ci_014                 1.314716e-02 3 1  ON 13
ci_015                 1.397168e-02 3 1  ON 14
ci_016                 1.633363e-02 3 1  ON 15
ci_017                 1.687367e-02 3 1  ON 16
ci_018                 1.290832e-02 3 1  ON 17
ci_019                 1.280133e-02 3 1  ON 18
ci_020                 1.344905e-02 3 1  ON 19
ci_021                 1.321794e-02 3 1  ON 20
ci_022                 1.136950e-02 3 1  ON 21
ci_023                 1.154464e-02 3 1  ON 22
ci_024                 1.152102e-02 3 1  ON 23
ci_025                 1.179061e-02 3 1  ON 24
ci_026                 1.150656e-02 3 1  ON 25
ci_027                 1.131089e-02 3 1  ON 26
ci_028                -1.441215e-02 3 1  ON 27
ci_029                -1.387771e-02 3 1  ON 28
ci_030                -1.071933e-02 3 1  ON 29
ci_031                -1.131485e-02 3 1  ON 30
ci_032                -1.364879e-02 3 1  ON 31
ci_033                 1.034173e-02 3 1  ON 32
ci_034                 9.919265e-03 3 1  ON 33
ci_035                -4.687328e-03 3 1  ON 34
ci_036                -1.003263e-02 3 1  ON 35
ci_037                -9.894988e-03 3 1  ON 36
ci_038                 1.684099e-03 3 1  ON 37
ci_039                 1.622174e-03 3 1  ON 38
ci_040                -4.084589e-03 3 1  ON 39
ci_041                 9.852574e-03 3 1  ON 40
ci_042                 9.952150e-03 3 1  ON 41
ci_043                -3.228402e-03 3 1  ON 42
ci_044                -1.451102e-02 3 1  ON 43
ci_045                -1.863587e-03 3 1  ON 44
ci_046                 5.631910e-03 3 1  ON 45
ci_047                 5.608478e-03 3 1  ON 46
ci_048                -1.207276e-02 3 1  ON 47
ci_049                -1.226538e-02 3 1  ON 48
ci_050                 7.303867e-03 3 1  ON 49
ci_051                 7.626877e-03 3 1  ON 50
ci_052                -6.581707e-03 3 1  ON 51
ci_053                -6.451591e-03 3 1  ON 52
ci_054                -3.108860e-03 3 1  ON 53
ci_055                -2.744514e-03 3 1  ON 54
ci_056                 4.484333e-03 3 1  ON 55
ci_057                 4.354409e-03 3 1  ON 56
ci_058                -6.911246e-03 3 1  ON 57
ci_059                -6.772543e-03 3 1  ON 58
ci_060                 8.664988e-03 3 1  ON 59
ci_061                 8.240432e-03 3 1  ON 60
ci_062                -3.184794e-03 3 1  ON 61
ci_063                -3.170749e-03 3 1  ON 62
ci_064                -3.014447e-03 3 1  ON 63
ci_065                -4.203786e-03 3 1  ON 64
ci_066                 5.710957e-03 3 1  ON 65
ci_067                 5.591070e-03 3 1  ON 66
ci_068                -4.582945e-03 3 1  ON 67
ci_069                -5.258752e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6746e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.151
    reference variance = 0.270999
====================================================
  Execution time = 2.9638e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0522e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1739e-01
  Total weights = 3.913801410e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9990e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298775105757
                                         uncertainty =       0.001509831209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298775105757
                                         uncertainty =       0.001509831209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273295751
  error estimate for blocks of size 2^( 2) =       0.000280476651
  error estimate for blocks of size 2^( 3) =       0.000286865087
  error estimate for blocks of size 2^( 4) =       0.000291543947
  error estimate for blocks of size 2^( 5) =       0.000294404886
  error estimate for blocks of size 2^( 6) =       0.000295408223
  error estimate for blocks of size 2^( 7) =       0.000295473925
  error estimate for blocks of size 2^( 8) =       0.000295544974

      target function =                  N/A
              le_mean =     -17.216933753808
             les_mean =     296.740196867649
             stat err =       0.000295208002
             autocorr =       1.166784068750
              std dev =       0.546591502470
             le_variance =       0.298762270572


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721693375381e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216933753834       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216936779782       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216936620422       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216936610899       residual = 1.35e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 3.191617e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216933753834       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216934726533       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216934649693       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 1.010436e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216933753834       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216934015721       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216933993789       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 2.710172e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.346039 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4643e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -4.030515e-02 3 1  ON 0
ci_002                -3.032001e-02 3 1  ON 1
ci_003                -2.472478e-02 3 1  ON 2
ci_004                 2.150436e-02 3 1  ON 3
ci_005                 2.061664e-02 3 1  ON 4
ci_006                -1.883547e-02 3 1  ON 5
ci_007                -1.834219e-02 3 1  ON 6
ci_008                -1.784390e-02 3 1  ON 7
ci_009                -1.759243e-02 3 1  ON 8
ci_010                -1.759486e-02 3 1  ON 9
ci_011                -1.644329e-02 3 1  ON 10
ci_012                -1.607486e-02 3 1  ON 11
ci_013                -1.828834e-02 3 1  ON 12
ci_014                 1.318913e-02 3 1  ON 13
ci_015                 1.392671e-02 3 1  ON 14
ci_016                 1.632390e-02 3 1  ON 15
ci_017                 1.684129e-02 3 1  ON 16
ci_018                 1.292756e-02 3 1  ON 17
ci_019                 1.274749e-02 3 1  ON 18
ci_020                 1.341438e-02 3 1  ON 19
ci_021                 1.321320e-02 3 1  ON 20
ci_022                 1.136614e-02 3 1  ON 21
ci_023                 1.148578e-02 3 1  ON 22
ci_024                 1.156306e-02 3 1  ON 23
ci_025                 1.179384e-02 3 1  ON 24
ci_026                 1.148396e-02 3 1  ON 25
ci_027                 1.135261e-02 3 1  ON 26
ci_028                -1.443993e-02 3 1  ON 27
ci_029                -1.394579e-02 3 1  ON 28
ci_030                -1.075752e-02 3 1  ON 29
ci_031                -1.124475e-02 3 1  ON 30
ci_032                -1.365489e-02 3 1  ON 31
ci_033                 1.031793e-02 3 1  ON 32
ci_034                 9.898823e-03 3 1  ON 33
ci_035                -4.656529e-03 3 1  ON 34
ci_036                -9.999621e-03 3 1  ON 35
ci_037                -9.910383e-03 3 1  ON 36
ci_038                 1.672949e-03 3 1  ON 37
ci_039                 1.606830e-03 3 1  ON 38
ci_040                -4.120489e-03 3 1  ON 39
ci_041                 9.839065e-03 3 1  ON 40
ci_042                 9.921996e-03 3 1  ON 41
ci_043                -3.214431e-03 3 1  ON 42
ci_044                -1.457612e-02 3 1  ON 43
ci_045                -1.887864e-03 3 1  ON 44
ci_046                 5.590318e-03 3 1  ON 45
ci_047                 5.565747e-03 3 1  ON 46
ci_048                -1.206938e-02 3 1  ON 47
ci_049                -1.223373e-02 3 1  ON 48
ci_050                 7.339550e-03 3 1  ON 49
ci_051                 7.578402e-03 3 1  ON 50
ci_052                -6.557306e-03 3 1  ON 51
ci_053                -6.533892e-03 3 1  ON 52
ci_054                -3.054461e-03 3 1  ON 53
ci_055                -2.777701e-03 3 1  ON 54
ci_056                 4.471201e-03 3 1  ON 55
ci_057                 4.376379e-03 3 1  ON 56
ci_058                -6.904262e-03 3 1  ON 57
ci_059                -6.773822e-03 3 1  ON 58
ci_060                 8.696238e-03 3 1  ON 59
ci_061                 8.236634e-03 3 1  ON 60
ci_062                -3.173445e-03 3 1  ON 61
ci_063                -3.133614e-03 3 1  ON 62
ci_064                -2.984054e-03 3 1  ON 63
ci_065                -4.274152e-03 3 1  ON 64
ci_066                 5.690569e-03 3 1  ON 65
ci_067                 5.598023e-03 3 1  ON 66
ci_068                -4.654645e-03 3 1  ON 67
ci_069                -5.226674e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2705
    reference variance = 0.162453
====================================================
  Execution time = 2.6933e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1497e-01
  Total weights = 3.9133e+06
  Execution time = 3.6293e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299397015927
                                         uncertainty =       0.001572116524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299397015927
                                         uncertainty =       0.001572116524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273583042
  error estimate for blocks of size 2^( 2) =       0.000280578239
  error estimate for blocks of size 2^( 3) =       0.000287084725
  error estimate for blocks of size 2^( 4) =       0.000291892705
  error estimate for blocks of size 2^( 5) =       0.000295009348
  error estimate for blocks of size 2^( 6) =       0.000296210622
  error estimate for blocks of size 2^( 7) =       0.000297903944
  error estimate for blocks of size 2^( 8) =       0.000299451598

      target function =                  N/A
              le_mean =     -17.216276051633
             les_mean =     296.715437015604
             stat err =       0.000297143878
             autocorr =       1.179655571783
              std dev =       0.547166084961
             le_variance =       0.299390724531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299328585580
                                         uncertainty =       0.001569222480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299328585580
                                         uncertainty =       0.001569222480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273551693
  error estimate for blocks of size 2^( 2) =       0.000280549104
  error estimate for blocks of size 2^( 3) =       0.000287059660
  error estimate for blocks of size 2^( 4) =       0.000291868578
  error estimate for blocks of size 2^( 5) =       0.000294987361
  error estimate for blocks of size 2^( 6) =       0.000296188235
  error estimate for blocks of size 2^( 7) =       0.000297875991
  error estimate for blocks of size 2^( 8) =       0.000299419089

      target function =                  N/A
              le_mean =     -17.216282832623
             les_mean =     296.740170680675
             stat err =       0.000297117669
             autocorr =       1.179717832850
              std dev =       0.547103386109
             le_variance =       0.299322115092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299346163449
                                         uncertainty =       0.001570052728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299346163449
                                         uncertainty =       0.001570052728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273559770
  error estimate for blocks of size 2^( 2) =       0.000280556277
  error estimate for blocks of size 2^( 3) =       0.000287065901
  error estimate for blocks of size 2^( 4) =       0.000291874008
  error estimate for blocks of size 2^( 5) =       0.000294993031
  error estimate for blocks of size 2^( 6) =       0.000296192257
  error estimate for blocks of size 2^( 7) =       0.000297879590
  error estimate for blocks of size 2^( 8) =       0.000299424365

      target function =                  N/A
              le_mean =     -17.216279219975
             les_mean =     296.715303281400
             stat err =       0.000297122311
             autocorr =       1.179685030475
              std dev =       0.547119539483
             le_variance =       0.299339790484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299389132904
                                         uncertainty =       0.001571825970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299389132904
                                         uncertainty =       0.001571825970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273579436
  error estimate for blocks of size 2^( 2) =       0.000280574809
  error estimate for blocks of size 2^( 3) =       0.000287081731
  error estimate for blocks of size 2^( 4) =       0.000291889713
  error estimate for blocks of size 2^( 5) =       0.000295006700
  error estimate for blocks of size 2^( 6) =       0.000296207729
  error estimate for blocks of size 2^( 7) =       0.000297900245
  error estimate for blocks of size 2^( 8) =       0.000299447510

      target function =                  N/A
              le_mean =     -17.216276357976
             les_mean =     296.715288133729
             stat err =       0.000297140546
             autocorr =       1.179660215883
              std dev =       0.547158872361
             le_variance =       0.299382831603


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216276051633        initial
     6.1035e-01     6.1035e+00             3.1916e-04       -17.216282832623  <--
     2.4414e+00     2.4414e+01             1.0104e-04       -17.216279219975
     9.7656e+00     9.7656e+01             2.7102e-05       -17.216276357976

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 4.5222e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -4.030898e-02 3 1  ON 0
ci_002                -3.033042e-02 3 1  ON 1
ci_003                -2.479400e-02 3 1  ON 2
ci_004                 2.147040e-02 3 1  ON 3
ci_005                 2.070464e-02 3 1  ON 4
ci_006                -1.872512e-02 3 1  ON 5
ci_007                -1.839680e-02 3 1  ON 6
ci_008                -1.783410e-02 3 1  ON 7
ci_009                -1.758129e-02 3 1  ON 8
ci_010                -1.748805e-02 3 1  ON 9
ci_011                -1.622518e-02 3 1  ON 10
ci_012                -1.601788e-02 3 1  ON 11
ci_013                -1.823841e-02 3 1  ON 12
ci_014                 1.328208e-02 3 1  ON 13
ci_015                 1.382896e-02 3 1  ON 14
ci_016                 1.630539e-02 3 1  ON 15
ci_017                 1.676733e-02 3 1  ON 16
ci_018                 1.297003e-02 3 1  ON 17
ci_019                 1.263206e-02 3 1  ON 18
ci_020                 1.333200e-02 3 1  ON 19
ci_021                 1.319971e-02 3 1  ON 20
ci_022                 1.135704e-02 3 1  ON 21
ci_023                 1.135871e-02 3 1  ON 22
ci_024                 1.165836e-02 3 1  ON 23
ci_025                 1.180200e-02 3 1  ON 24
ci_026                 1.143502e-02 3 1  ON 25
ci_027                 1.144577e-02 3 1  ON 26
ci_028                -1.450549e-02 3 1  ON 27
ci_029                -1.410575e-02 3 1  ON 28
ci_030                -1.084040e-02 3 1  ON 29
ci_031                -1.109265e-02 3 1  ON 30
ci_032                -1.366778e-02 3 1  ON 31
ci_033                 1.026426e-02 3 1  ON 32
ci_034                 9.853047e-03 3 1  ON 33
ci_035                -4.598446e-03 3 1  ON 34
ci_036                -9.926007e-03 3 1  ON 35
ci_037                -9.946021e-03 3 1  ON 36
ci_038                 1.653794e-03 3 1  ON 37
ci_039                 1.578837e-03 3 1  ON 38
ci_040                -4.184426e-03 3 1  ON 39
ci_041                 9.808734e-03 3 1  ON 40
ci_042                 9.858711e-03 3 1  ON 41
ci_043                -3.186838e-03 3 1  ON 42
ci_044                -1.473220e-02 3 1  ON 43
ci_045                -1.931990e-03 3 1  ON 44
ci_046                 5.505071e-03 3 1  ON 45
ci_047                 5.476464e-03 3 1  ON 46
ci_048                -1.206059e-02 3 1  ON 47
ci_049                -1.215954e-02 3 1  ON 48
ci_050                 7.406649e-03 3 1  ON 49
ci_051                 7.486050e-03 3 1  ON 50
ci_052                -6.510075e-03 3 1  ON 51
ci_053                -6.695755e-03 3 1  ON 52
ci_054                -2.944872e-03 3 1  ON 53
ci_055                -2.846019e-03 3 1  ON 54
ci_056                 4.446483e-03 3 1  ON 55
ci_057                 4.419366e-03 3 1  ON 56
ci_058                -6.892669e-03 3 1  ON 57
ci_059                -6.776364e-03 3 1  ON 58
ci_060                 8.764420e-03 3 1  ON 59
ci_061                 8.229901e-03 3 1  ON 60
ci_062                -3.149852e-03 3 1  ON 61
ci_063                -3.059141e-03 3 1  ON 62
ci_064                -2.933540e-03 3 1  ON 63
ci_065                -4.391833e-03 3 1  ON 64
ci_066                 5.652183e-03 3 1  ON 65
ci_067                 5.611426e-03 3 1  ON 66
ci_068                -4.811667e-03 3 1  ON 67
ci_069                -5.162509e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9878e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2229
    reference variance = 0.181537
====================================================
  Execution time = 2.7373e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0548e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2071e-01
  Total weights = 3.913098105e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9058e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305007059759
                                         uncertainty =       0.002785693075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305007059759
                                         uncertainty =       0.002785693075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000276133967
  error estimate for blocks of size 2^( 2) =       0.000283219185
  error estimate for blocks of size 2^( 3) =       0.000289346841
  error estimate for blocks of size 2^( 4) =       0.000293612170
  error estimate for blocks of size 2^( 5) =       0.000296398682
  error estimate for blocks of size 2^( 6) =       0.000297612143
  error estimate for blocks of size 2^( 7) =       0.000298293758
  error estimate for blocks of size 2^( 8) =       0.000298673222

      target function =                  N/A
              le_mean =     -17.216351075693
             les_mean =     296.723457621818
             stat err =       0.000297744451
             autocorr =       1.162646499149
              std dev =       0.552267934548
             le_variance =       0.304999871530


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721635107569e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216351075710       residual = 9.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216361707115       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216359960229       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216360229973       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 6.552492e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216351075710       residual = 9.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216356170362       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216355612699       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216355649276       residual = 2.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 3.031752e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216351075710       residual = 9.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216352728116       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216352630809       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 1.080743e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.347305 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2286e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -4.029051e-02 3 1  ON 0
ci_002                -3.004150e-02 3 1  ON 1
ci_003                -2.493219e-02 3 1  ON 2
ci_004                 2.129092e-02 3 1  ON 3
ci_005                 2.063394e-02 3 1  ON 4
ci_006                -1.862111e-02 3 1  ON 5
ci_007                -1.852590e-02 3 1  ON 6
ci_008                -1.775764e-02 3 1  ON 7
ci_009                -1.740565e-02 3 1  ON 8
ci_010                -1.750236e-02 3 1  ON 9
ci_011                -1.636049e-02 3 1  ON 10
ci_012                -1.622561e-02 3 1  ON 11
ci_013                -1.832254e-02 3 1  ON 12
ci_014                 1.355489e-02 3 1  ON 13
ci_015                 1.380718e-02 3 1  ON 14
ci_016                 1.629621e-02 3 1  ON 15
ci_017                 1.662010e-02 3 1  ON 16
ci_018                 1.304781e-02 3 1  ON 17
ci_019                 1.268663e-02 3 1  ON 18
ci_020                 1.330311e-02 3 1  ON 19
ci_021                 1.301305e-02 3 1  ON 20
ci_022                 1.150080e-02 3 1  ON 21
ci_023                 1.153995e-02 3 1  ON 22
ci_024                 1.153582e-02 3 1  ON 23
ci_025                 1.178463e-02 3 1  ON 24
ci_026                 1.144082e-02 3 1  ON 25
ci_027                 1.133028e-02 3 1  ON 26
ci_028                -1.460129e-02 3 1  ON 27
ci_029                -1.404792e-02 3 1  ON 28
ci_030                -1.081194e-02 3 1  ON 29
ci_031                -1.116872e-02 3 1  ON 30
ci_032                -1.372606e-02 3 1  ON 31
ci_033                 1.021207e-02 3 1  ON 32
ci_034                 9.960162e-03 3 1  ON 33
ci_035                -4.592673e-03 3 1  ON 34
ci_036                -1.021369e-02 3 1  ON 35
ci_037                -9.919604e-03 3 1  ON 36
ci_038                 1.640066e-03 3 1  ON 37
ci_039                 1.580512e-03 3 1  ON 38
ci_040                -4.188996e-03 3 1  ON 39
ci_041                 9.842973e-03 3 1  ON 40
ci_042                 9.825981e-03 3 1  ON 41
ci_043                -3.136163e-03 3 1  ON 42
ci_044                -1.481628e-02 3 1  ON 43
ci_045                -1.628815e-03 3 1  ON 44
ci_046                 5.584690e-03 3 1  ON 45
ci_047                 5.649484e-03 3 1  ON 46
ci_048                -1.201239e-02 3 1  ON 47
ci_049                -1.206143e-02 3 1  ON 48
ci_050                 7.564888e-03 3 1  ON 49
ci_051                 7.586859e-03 3 1  ON 50
ci_052                -6.572703e-03 3 1  ON 51
ci_053                -6.413071e-03 3 1  ON 52
ci_054                -2.768333e-03 3 1  ON 53
ci_055                -3.129483e-03 3 1  ON 54
ci_056                 4.406313e-03 3 1  ON 55
ci_057                 4.518526e-03 3 1  ON 56
ci_058                -6.842162e-03 3 1  ON 57
ci_059                -6.717606e-03 3 1  ON 58
ci_060                 8.599161e-03 3 1  ON 59
ci_061                 8.259617e-03 3 1  ON 60
ci_062                -3.179691e-03 3 1  ON 61
ci_063                -3.209422e-03 3 1  ON 62
ci_064                -3.009333e-03 3 1  ON 63
ci_065                -4.238276e-03 3 1  ON 64
ci_066                 5.786403e-03 3 1  ON 65
ci_067                 5.539714e-03 3 1  ON 66
ci_068                -4.926794e-03 3 1  ON 67
ci_069                -5.135832e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.194
    reference variance = 0.534545
====================================================
  Execution time = 2.6995e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1509e-01
  Total weights = 3.9136e+06
  Execution time = 3.6382e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300608797489
                                         uncertainty =       0.001690576140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300608797489
                                         uncertainty =       0.001690576140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274117405
  error estimate for blocks of size 2^( 2) =       0.000281255853
  error estimate for blocks of size 2^( 3) =       0.000287496179
  error estimate for blocks of size 2^( 4) =       0.000291949338
  error estimate for blocks of size 2^( 5) =       0.000294521073
  error estimate for blocks of size 2^( 6) =       0.000295922665
  error estimate for blocks of size 2^( 7) =       0.000297068321
  error estimate for blocks of size 2^( 8) =       0.000299209969

      target function =                  N/A
              le_mean =     -17.216076869980
             les_mean =     296.722324888225
             stat err =       0.000296680507
             autocorr =       1.171398867249
              std dev =       0.548234810885
             le_variance =       0.300561407866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300778388099
                                         uncertainty =       0.001688749450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300778388099
                                         uncertainty =       0.001688749450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274194414
  error estimate for blocks of size 2^( 2) =       0.000281338425
  error estimate for blocks of size 2^( 3) =       0.000287580113
  error estimate for blocks of size 2^( 4) =       0.000292038064
  error estimate for blocks of size 2^( 5) =       0.000294606591
  error estimate for blocks of size 2^( 6) =       0.000295987229
  error estimate for blocks of size 2^( 7) =       0.000297165964
  error estimate for blocks of size 2^( 8) =       0.000299311916

      target function =                  N/A
              le_mean =     -17.216069361896
             les_mean =     296.709249040806
             stat err =       0.000296767925
             autocorr =       1.171431003090
              std dev =       0.548388828688
             le_variance =       0.300730307430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300759470350
                                         uncertainty =       0.001686229688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300759470350
                                         uncertainty =       0.001686229688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274185825
  error estimate for blocks of size 2^( 2) =       0.000281329678
  error estimate for blocks of size 2^( 3) =       0.000287571819
  error estimate for blocks of size 2^( 4) =       0.000292032078
  error estimate for blocks of size 2^( 5) =       0.000294602481
  error estimate for blocks of size 2^( 6) =       0.000295981118
  error estimate for blocks of size 2^( 7) =       0.000297159205
  error estimate for blocks of size 2^( 8) =       0.000299299419

      target function =                  N/A
              le_mean =     -17.216067483255
             les_mean =     296.767519074010
             stat err =       0.000296760556
             autocorr =       1.171446220360
              std dev =       0.548371649215
             le_variance =       0.300711465662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300598297754
                                         uncertainty =       0.001689344595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300598297754
                                         uncertainty =       0.001689344595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274112596
  error estimate for blocks of size 2^( 2) =       0.000281253902
  error estimate for blocks of size 2^( 3) =       0.000287498189
  error estimate for blocks of size 2^( 4) =       0.000291958269
  error estimate for blocks of size 2^( 5) =       0.000294534713
  error estimate for blocks of size 2^( 6) =       0.000295934144
  error estimate for blocks of size 2^( 7) =       0.000297084888
  error estimate for blocks of size 2^( 8) =       0.000299216322

      target function =                  N/A
              le_mean =     -17.216071424570
             les_mean =     296.714177308533
             stat err =       0.000296692517
             autocorr =       1.171534815317
              std dev =       0.548225191992
             le_variance =       0.300550861134


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216076869980        initial  <--
     1.5259e-01     1.5259e+00             6.5525e-04       -17.216069361896
     6.1035e-01     6.1035e+00             3.0318e-04       -17.216067483255
     2.4414e+00     2.4414e+01             1.0807e-04       -17.216071424570

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.3246
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -4.030898e-02 3 1  ON 0
ci_002                -3.033042e-02 3 1  ON 1
ci_003                -2.479400e-02 3 1  ON 2
ci_004                 2.147040e-02 3 1  ON 3
ci_005                 2.070464e-02 3 1  ON 4
ci_006                -1.872512e-02 3 1  ON 5
ci_007                -1.839680e-02 3 1  ON 6
ci_008                -1.783410e-02 3 1  ON 7
ci_009                -1.758129e-02 3 1  ON 8
ci_010                -1.748805e-02 3 1  ON 9
ci_011                -1.622518e-02 3 1  ON 10
ci_012                -1.601788e-02 3 1  ON 11
ci_013                -1.823841e-02 3 1  ON 12
ci_014                 1.328208e-02 3 1  ON 13
ci_015                 1.382896e-02 3 1  ON 14
ci_016                 1.630539e-02 3 1  ON 15
ci_017                 1.676733e-02 3 1  ON 16
ci_018                 1.297003e-02 3 1  ON 17
ci_019                 1.263206e-02 3 1  ON 18
ci_020                 1.333200e-02 3 1  ON 19
ci_021                 1.319971e-02 3 1  ON 20
ci_022                 1.135704e-02 3 1  ON 21
ci_023                 1.135871e-02 3 1  ON 22
ci_024                 1.165836e-02 3 1  ON 23
ci_025                 1.180200e-02 3 1  ON 24
ci_026                 1.143502e-02 3 1  ON 25
ci_027                 1.144577e-02 3 1  ON 26
ci_028                -1.450549e-02 3 1  ON 27
ci_029                -1.410575e-02 3 1  ON 28
ci_030                -1.084040e-02 3 1  ON 29
ci_031                -1.109265e-02 3 1  ON 30
ci_032                -1.366778e-02 3 1  ON 31
ci_033                 1.026426e-02 3 1  ON 32
ci_034                 9.853047e-03 3 1  ON 33
ci_035                -4.598446e-03 3 1  ON 34
ci_036                -9.926007e-03 3 1  ON 35
ci_037                -9.946021e-03 3 1  ON 36
ci_038                 1.653794e-03 3 1  ON 37
ci_039                 1.578837e-03 3 1  ON 38
ci_040                -4.184426e-03 3 1  ON 39
ci_041                 9.808734e-03 3 1  ON 40
ci_042                 9.858711e-03 3 1  ON 41
ci_043                -3.186838e-03 3 1  ON 42
ci_044                -1.473220e-02 3 1  ON 43
ci_045                -1.931990e-03 3 1  ON 44
ci_046                 5.505071e-03 3 1  ON 45
ci_047                 5.476464e-03 3 1  ON 46
ci_048                -1.206059e-02 3 1  ON 47
ci_049                -1.215954e-02 3 1  ON 48
ci_050                 7.406649e-03 3 1  ON 49
ci_051                 7.486050e-03 3 1  ON 50
ci_052                -6.510075e-03 3 1  ON 51
ci_053                -6.695755e-03 3 1  ON 52
ci_054                -2.944872e-03 3 1  ON 53
ci_055                -2.846019e-03 3 1  ON 54
ci_056                 4.446483e-03 3 1  ON 55
ci_057                 4.419366e-03 3 1  ON 56
ci_058                -6.892669e-03 3 1  ON 57
ci_059                -6.776364e-03 3 1  ON 58
ci_060                 8.764420e-03 3 1  ON 59
ci_061                 8.229901e-03 3 1  ON 60
ci_062                -3.149852e-03 3 1  ON 61
ci_063                -3.059141e-03 3 1  ON 62
ci_064                -2.933540e-03 3 1  ON 63
ci_065                -4.391833e-03 3 1  ON 64
ci_066                 5.652183e-03 3 1  ON 65
ci_067                 5.611426e-03 3 1  ON 66
ci_068                -4.811667e-03 3 1  ON 67
ci_069                -5.162509e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7693e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2158
    reference variance = 0.137283
====================================================
  Execution time = 2.7216e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0546e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1207e-01
  Total weights = 3.913487406e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9108e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297974918729
                                         uncertainty =       0.001397421176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297974918729
                                         uncertainty =       0.001397421176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272923048
  error estimate for blocks of size 2^( 2) =       0.000280056761
  error estimate for blocks of size 2^( 3) =       0.000286546918
  error estimate for blocks of size 2^( 4) =       0.000291312083
  error estimate for blocks of size 2^( 5) =       0.000294217031
  error estimate for blocks of size 2^( 6) =       0.000296127812
  error estimate for blocks of size 2^( 7) =       0.000296747570
  error estimate for blocks of size 2^( 8) =       0.000296910474

      target function =                  N/A
              le_mean =     -17.216568848480
             les_mean =     296.722316172734
             stat err =       0.000296000722
             autocorr =       1.176264839934
              std dev =       0.545846095012
             le_variance =       0.297947959440


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656884848e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216568848505       residual = 8.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216569766925       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216569830911       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 1.588748e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216568848505       residual = 8.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216569107116       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216569127847       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+00 is 4.283292e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216568848505       residual = 8.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216568915266       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216568920842       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+01 is 1.091846e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.348365 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2134e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -4.031198e-02 3 1  ON 0
ci_002                -3.030575e-02 3 1  ON 1
ci_003                -2.481696e-02 3 1  ON 2
ci_004                 2.147321e-02 3 1  ON 3
ci_005                 2.070734e-02 3 1  ON 4
ci_006                -1.873433e-02 3 1  ON 5
ci_007                -1.840666e-02 3 1  ON 6
ci_008                -1.783217e-02 3 1  ON 7
ci_009                -1.761365e-02 3 1  ON 8
ci_010                -1.748891e-02 3 1  ON 9
ci_011                -1.625239e-02 3 1  ON 10
ci_012                -1.601233e-02 3 1  ON 11
ci_013                -1.828124e-02 3 1  ON 12
ci_014                 1.331741e-02 3 1  ON 13
ci_015                 1.382908e-02 3 1  ON 14
ci_016                 1.630445e-02 3 1  ON 15
ci_017                 1.676671e-02 3 1  ON 16
ci_018                 1.295594e-02 3 1  ON 17
ci_019                 1.264660e-02 3 1  ON 18
ci_020                 1.331623e-02 3 1  ON 19
ci_021                 1.317751e-02 3 1  ON 20
ci_022                 1.136764e-02 3 1  ON 21
ci_023                 1.135361e-02 3 1  ON 22
ci_024                 1.165113e-02 3 1  ON 23
ci_025                 1.181022e-02 3 1  ON 24
ci_026                 1.142016e-02 3 1  ON 25
ci_027                 1.143926e-02 3 1  ON 26
ci_028                -1.449765e-02 3 1  ON 27
ci_029                -1.410889e-02 3 1  ON 28
ci_030                -1.086228e-02 3 1  ON 29
ci_031                -1.110809e-02 3 1  ON 30
ci_032                -1.368108e-02 3 1  ON 31
ci_033                 1.027391e-02 3 1  ON 32
ci_034                 9.853181e-03 3 1  ON 33
ci_035                -4.616285e-03 3 1  ON 34
ci_036                -9.962542e-03 3 1  ON 35
ci_037                -9.962244e-03 3 1  ON 36
ci_038                 1.662680e-03 3 1  ON 37
ci_039                 1.575484e-03 3 1  ON 38
ci_040                -4.165883e-03 3 1  ON 39
ci_041                 9.785880e-03 3 1  ON 40
ci_042                 9.851170e-03 3 1  ON 41
ci_043                -3.160725e-03 3 1  ON 42
ci_044                -1.475005e-02 3 1  ON 43
ci_045                -1.930624e-03 3 1  ON 44
ci_046                 5.499895e-03 3 1  ON 45
ci_047                 5.476866e-03 3 1  ON 46
ci_048                -1.205516e-02 3 1  ON 47
ci_049                -1.215815e-02 3 1  ON 48
ci_050                 7.425807e-03 3 1  ON 49
ci_051                 7.476557e-03 3 1  ON 50
ci_052                -6.525557e-03 3 1  ON 51
ci_053                -6.685341e-03 3 1  ON 52
ci_054                -2.974166e-03 3 1  ON 53
ci_055                -2.851582e-03 3 1  ON 54
ci_056                 4.446449e-03 3 1  ON 55
ci_057                 4.436152e-03 3 1  ON 56
ci_058                -6.892126e-03 3 1  ON 57
ci_059                -6.764003e-03 3 1  ON 58
ci_060                 8.739532e-03 3 1  ON 59
ci_061                 8.248131e-03 3 1  ON 60
ci_062                -3.118230e-03 3 1  ON 61
ci_063                -3.062057e-03 3 1  ON 62
ci_064                -2.967995e-03 3 1  ON 63
ci_065                -4.375074e-03 3 1  ON 64
ci_066                 5.649769e-03 3 1  ON 65
ci_067                 5.579077e-03 3 1  ON 66
ci_068                -4.797856e-03 3 1  ON 67
ci_069                -5.165794e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2523
    reference variance = 0.285134
====================================================
  Execution time = 2.7102e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1400e-01
  Total weights = 3.9132e+06
  Execution time = 3.6437e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299476365108
                                         uncertainty =       0.001870533058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299476365108
                                         uncertainty =       0.001870533058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273606262
  error estimate for blocks of size 2^( 2) =       0.000280503181
  error estimate for blocks of size 2^( 3) =       0.000286570168
  error estimate for blocks of size 2^( 4) =       0.000291022867
  error estimate for blocks of size 2^( 5) =       0.000294153022
  error estimate for blocks of size 2^( 6) =       0.000295650757
  error estimate for blocks of size 2^( 7) =       0.000295897349
  error estimate for blocks of size 2^( 8) =       0.000296399645

      target function =                  N/A
              le_mean =     -17.216289384233
             les_mean =     296.714602576620
             stat err =       0.000295525193
             autocorr =       1.166640244066
              std dev =       0.547212524283
             le_variance =       0.299441546733

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299495740240
                                         uncertainty =       0.001871795996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299495740240
                                         uncertainty =       0.001871795996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273615107
  error estimate for blocks of size 2^( 2) =       0.000280509803
  error estimate for blocks of size 2^( 3) =       0.000286573847
  error estimate for blocks of size 2^( 4) =       0.000291025586
  error estimate for blocks of size 2^( 5) =       0.000294154927
  error estimate for blocks of size 2^( 6) =       0.000295653851
  error estimate for blocks of size 2^( 7) =       0.000295902587
  error estimate for blocks of size 2^( 8) =       0.000296408509

      target function =                  N/A
              le_mean =     -17.216286844154
             les_mean =     296.715310615709
             stat err =       0.000295529969
             autocorr =       1.166602524813
              std dev =       0.547230213630
             le_variance =       0.299460906709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299485319236
                                         uncertainty =       0.001871220781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299485319236
                                         uncertainty =       0.001871220781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273610350
  error estimate for blocks of size 2^( 2) =       0.000280506025
  error estimate for blocks of size 2^( 3) =       0.000286571326
  error estimate for blocks of size 2^( 4) =       0.000291023424
  error estimate for blocks of size 2^( 5) =       0.000294153139
  error estimate for blocks of size 2^( 6) =       0.000295651502
  error estimate for blocks of size 2^( 7) =       0.000295899166
  error estimate for blocks of size 2^( 8) =       0.000296403522

      target function =                  N/A
              le_mean =     -17.216287667218
             les_mean =     296.714719623723
             stat err =       0.000295526832
             autocorr =       1.166618325549
              std dev =       0.547220699667
             le_variance =       0.299450494144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299477282747
                                         uncertainty =       0.001870618319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299477282747
                                         uncertainty =       0.001870618319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273606681
  error estimate for blocks of size 2^( 2) =       0.000280503438
  error estimate for blocks of size 2^( 3) =       0.000286570206
  error estimate for blocks of size 2^( 4) =       0.000291022830
  error estimate for blocks of size 2^( 5) =       0.000294152931
  error estimate for blocks of size 2^( 6) =       0.000295650747
  error estimate for blocks of size 2^( 7) =       0.000295897475
  error estimate for blocks of size 2^( 8) =       0.000296400031

      target function =                  N/A
              le_mean =     -17.216289133568
             les_mean =     296.714592739776
             stat err =       0.000295525296
             autocorr =       1.166637483494
              std dev =       0.547213362138
             le_variance =       0.299442463702


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216289384233        initial  <--
     1.5259e+00     1.5259e+01             1.5887e-04       -17.216286844154
     6.1035e+00     6.1035e+01             4.2833e-05       -17.216287667218
     2.4414e+01     2.4414e+02             1.0918e-05       -17.216289133568

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.4644
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -4.030898e-02 3 1  ON 0
ci_002                -3.033042e-02 3 1  ON 1
ci_003                -2.479400e-02 3 1  ON 2
ci_004                 2.147040e-02 3 1  ON 3
ci_005                 2.070464e-02 3 1  ON 4
ci_006                -1.872512e-02 3 1  ON 5
ci_007                -1.839680e-02 3 1  ON 6
ci_008                -1.783410e-02 3 1  ON 7
ci_009                -1.758129e-02 3 1  ON 8
ci_010                -1.748805e-02 3 1  ON 9
ci_011                -1.622518e-02 3 1  ON 10
ci_012                -1.601788e-02 3 1  ON 11
ci_013                -1.823841e-02 3 1  ON 12
ci_014                 1.328208e-02 3 1  ON 13
ci_015                 1.382896e-02 3 1  ON 14
ci_016                 1.630539e-02 3 1  ON 15
ci_017                 1.676733e-02 3 1  ON 16
ci_018                 1.297003e-02 3 1  ON 17
ci_019                 1.263206e-02 3 1  ON 18
ci_020                 1.333200e-02 3 1  ON 19
ci_021                 1.319971e-02 3 1  ON 20
ci_022                 1.135704e-02 3 1  ON 21
ci_023                 1.135871e-02 3 1  ON 22
ci_024                 1.165836e-02 3 1  ON 23
ci_025                 1.180200e-02 3 1  ON 24
ci_026                 1.143502e-02 3 1  ON 25
ci_027                 1.144577e-02 3 1  ON 26
ci_028                -1.450549e-02 3 1  ON 27
ci_029                -1.410575e-02 3 1  ON 28
ci_030                -1.084040e-02 3 1  ON 29
ci_031                -1.109265e-02 3 1  ON 30
ci_032                -1.366778e-02 3 1  ON 31
ci_033                 1.026426e-02 3 1  ON 32
ci_034                 9.853047e-03 3 1  ON 33
ci_035                -4.598446e-03 3 1  ON 34
ci_036                -9.926007e-03 3 1  ON 35
ci_037                -9.946021e-03 3 1  ON 36
ci_038                 1.653794e-03 3 1  ON 37
ci_039                 1.578837e-03 3 1  ON 38
ci_040                -4.184426e-03 3 1  ON 39
ci_041                 9.808734e-03 3 1  ON 40
ci_042                 9.858711e-03 3 1  ON 41
ci_043                -3.186838e-03 3 1  ON 42
ci_044                -1.473220e-02 3 1  ON 43
ci_045                -1.931990e-03 3 1  ON 44
ci_046                 5.505071e-03 3 1  ON 45
ci_047                 5.476464e-03 3 1  ON 46
ci_048                -1.206059e-02 3 1  ON 47
ci_049                -1.215954e-02 3 1  ON 48
ci_050                 7.406649e-03 3 1  ON 49
ci_051                 7.486050e-03 3 1  ON 50
ci_052                -6.510075e-03 3 1  ON 51
ci_053                -6.695755e-03 3 1  ON 52
ci_054                -2.944872e-03 3 1  ON 53
ci_055                -2.846019e-03 3 1  ON 54
ci_056                 4.446483e-03 3 1  ON 55
ci_057                 4.419366e-03 3 1  ON 56
ci_058                -6.892669e-03 3 1  ON 57
ci_059                -6.776364e-03 3 1  ON 58
ci_060                 8.764420e-03 3 1  ON 59
ci_061                 8.229901e-03 3 1  ON 60
ci_062                -3.149852e-03 3 1  ON 61
ci_063                -3.059141e-03 3 1  ON 62
ci_064                -2.933540e-03 3 1  ON 63
ci_065                -4.391833e-03 3 1  ON 64
ci_066                 5.652183e-03 3 1  ON 65
ci_067                 5.611426e-03 3 1  ON 66
ci_068                -4.811667e-03 3 1  ON 67
ci_069                -5.162509e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7630e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2583
    reference variance = 0.244896
====================================================
  Execution time = 2.7255e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0573e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1623e-01
  Total weights = 3.913609985e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9536e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300588387007
                                         uncertainty =       0.001744520715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300588387007
                                         uncertainty =       0.001744520715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274140697
  error estimate for blocks of size 2^( 2) =       0.000281216232
  error estimate for blocks of size 2^( 3) =       0.000287454340
  error estimate for blocks of size 2^( 4) =       0.000292071802
  error estimate for blocks of size 2^( 5) =       0.000295539956
  error estimate for blocks of size 2^( 6) =       0.000297751055
  error estimate for blocks of size 2^( 7) =       0.000298697160
  error estimate for blocks of size 2^( 8) =       0.000298630721

      target function =                  N/A
              le_mean =     -17.216780744250
             les_mean =     296.733773685348
             stat err =       0.000297654723
             autocorr =       1.178904244962
              std dev =       0.548281393371
             le_variance =       0.300612486316


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721678074425e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216780744276       residual = 8.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216781007144       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216780997998       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+01 is 1.467291e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216780744276       residual = 8.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216780810822       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216780808577       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+01 is 3.724502e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216780744276       residual = 8.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216780760965       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216780760406       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+02 is 9.347168e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.349468 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2216e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -4.030824e-02 3 1  ON 0
ci_002                -3.033039e-02 3 1  ON 1
ci_003                -2.479205e-02 3 1  ON 2
ci_004                 2.146858e-02 3 1  ON 3
ci_005                 2.070376e-02 3 1  ON 4
ci_006                -1.872584e-02 3 1  ON 5
ci_007                -1.839835e-02 3 1  ON 6
ci_008                -1.783368e-02 3 1  ON 7
ci_009                -1.758371e-02 3 1  ON 8
ci_010                -1.748787e-02 3 1  ON 9
ci_011                -1.622438e-02 3 1  ON 10
ci_012                -1.602047e-02 3 1  ON 11
ci_013                -1.824159e-02 3 1  ON 12
ci_014                 1.328022e-02 3 1  ON 13
ci_015                 1.383267e-02 3 1  ON 14
ci_016                 1.630747e-02 3 1  ON 15
ci_017                 1.676904e-02 3 1  ON 16
ci_018                 1.296913e-02 3 1  ON 17
ci_019                 1.263247e-02 3 1  ON 18
ci_020                 1.333210e-02 3 1  ON 19
ci_021                 1.320156e-02 3 1  ON 20
ci_022                 1.135639e-02 3 1  ON 21
ci_023                 1.135863e-02 3 1  ON 22
ci_024                 1.165682e-02 3 1  ON 23
ci_025                 1.180120e-02 3 1  ON 24
ci_026                 1.143191e-02 3 1  ON 25
ci_027                 1.144457e-02 3 1  ON 26
ci_028                -1.450365e-02 3 1  ON 27
ci_029                -1.410558e-02 3 1  ON 28
ci_030                -1.084349e-02 3 1  ON 29
ci_031                -1.109311e-02 3 1  ON 30
ci_032                -1.366860e-02 3 1  ON 31
ci_033                 1.026642e-02 3 1  ON 32
ci_034                 9.852921e-03 3 1  ON 33
ci_035                -4.597691e-03 3 1  ON 34
ci_036                -9.926767e-03 3 1  ON 35
ci_037                -9.949403e-03 3 1  ON 36
ci_038                 1.655123e-03 3 1  ON 37
ci_039                 1.579487e-03 3 1  ON 38
ci_040                -4.182518e-03 3 1  ON 39
ci_041                 9.807341e-03 3 1  ON 40
ci_042                 9.860784e-03 3 1  ON 41
ci_043                -3.184015e-03 3 1  ON 42
ci_044                -1.473179e-02 3 1  ON 43
ci_045                -1.931988e-03 3 1  ON 44
ci_046                 5.505676e-03 3 1  ON 45
ci_047                 5.476247e-03 3 1  ON 46
ci_048                -1.206040e-02 3 1  ON 47
ci_049                -1.215864e-02 3 1  ON 48
ci_050                 7.408493e-03 3 1  ON 49
ci_051                 7.486519e-03 3 1  ON 50
ci_052                -6.509136e-03 3 1  ON 51
ci_053                -6.692031e-03 3 1  ON 52
ci_054                -2.943165e-03 3 1  ON 53
ci_055                -2.847544e-03 3 1  ON 54
ci_056                 4.446918e-03 3 1  ON 55
ci_057                 4.422969e-03 3 1  ON 56
ci_058                -6.891606e-03 3 1  ON 57
ci_059                -6.778263e-03 3 1  ON 58
ci_060                 8.761082e-03 3 1  ON 59
ci_061                 8.227214e-03 3 1  ON 60
ci_062                -3.150058e-03 3 1  ON 61
ci_063                -3.058309e-03 3 1  ON 62
ci_064                -2.934542e-03 3 1  ON 63
ci_065                -4.388197e-03 3 1  ON 64
ci_066                 5.650874e-03 3 1  ON 65
ci_067                 5.611902e-03 3 1  ON 66
ci_068                -4.811428e-03 3 1  ON 67
ci_069                -5.163360e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.194
    reference variance = 0.178612
====================================================
  Execution time = 2.6767e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1238e-01
  Total weights = 3.9134e+06
  Execution time = 3.6374e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298370084677
                                         uncertainty =       0.001392903026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298370084677
                                         uncertainty =       0.001392903026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273109821
  error estimate for blocks of size 2^( 2) =       0.000280276465
  error estimate for blocks of size 2^( 3) =       0.000286648308
  error estimate for blocks of size 2^( 4) =       0.000291631708
  error estimate for blocks of size 2^( 5) =       0.000294804589
  error estimate for blocks of size 2^( 6) =       0.000296299667
  error estimate for blocks of size 2^( 7) =       0.000297172681
  error estimate for blocks of size 2^( 8) =       0.000298610167

      target function =                  N/A
              le_mean =     -17.215861071883
             les_mean =     296.698251767628
             stat err =       0.000296721776
             autocorr =       1.180386415670
              std dev =       0.546219642772
             le_variance =       0.298355898150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298363457094
                                         uncertainty =       0.001392727399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298363457094
                                         uncertainty =       0.001392727399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273106782
  error estimate for blocks of size 2^( 2) =       0.000280273561
  error estimate for blocks of size 2^( 3) =       0.000286645402
  error estimate for blocks of size 2^( 4) =       0.000291628845
  error estimate for blocks of size 2^( 5) =       0.000294801809
  error estimate for blocks of size 2^( 6) =       0.000296296856
  error estimate for blocks of size 2^( 7) =       0.000297169985
  error estimate for blocks of size 2^( 8) =       0.000298606947

      target function =                  N/A
              le_mean =     -17.215861200914
             les_mean =     296.698256191866
             stat err =       0.000296718899
             autocorr =       1.180389805161
              std dev =       0.546213563193
             le_variance =       0.298349256616

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298366710876
                                         uncertainty =       0.001392813845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298366710876
                                         uncertainty =       0.001392813845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273108274
  error estimate for blocks of size 2^( 2) =       0.000280274987
  error estimate for blocks of size 2^( 3) =       0.000286646829
  error estimate for blocks of size 2^( 4) =       0.000291630250
  error estimate for blocks of size 2^( 5) =       0.000294803173
  error estimate for blocks of size 2^( 6) =       0.000296298237
  error estimate for blocks of size 2^( 7) =       0.000297171309
  error estimate for blocks of size 2^( 8) =       0.000298608530

      target function =                  N/A
              le_mean =     -17.215861134599
             les_mean =     296.698251597310
             stat err =       0.000296720312
             autocorr =       1.180388144426
              std dev =       0.546216547960
             le_variance =       0.298352517265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298369659563
                                         uncertainty =       0.001392891811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298369659563
                                         uncertainty =       0.001392891811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273109626
  error estimate for blocks of size 2^( 2) =       0.000280276279
  error estimate for blocks of size 2^( 3) =       0.000286648122
  error estimate for blocks of size 2^( 4) =       0.000291631525
  error estimate for blocks of size 2^( 5) =       0.000294804410
  error estimate for blocks of size 2^( 6) =       0.000296299487
  error estimate for blocks of size 2^( 7) =       0.000297172508
  error estimate for blocks of size 2^( 8) =       0.000298609961

      target function =                  N/A
              le_mean =     -17.215861079497
             les_mean =     296.698251597110
             stat err =       0.000296721591
             autocorr =       1.180386633378
              std dev =       0.546219252816
             le_variance =       0.298355472147


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215861071883        initial
     1.5259e+01     1.5259e+02             1.4673e-05       -17.215861200914  <--
     6.1035e+01     6.1035e+02             3.7245e-06       -17.215861134599
     2.4414e+02     2.4414e+03             9.3472e-07       -17.215861079497

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 4.7972e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -4.030606e-02 3 1  ON 0
ci_002                -3.033028e-02 3 1  ON 1
ci_003                -2.478624e-02 3 1  ON 2
ci_004                 2.146319e-02 3 1  ON 3
ci_005                 2.070115e-02 3 1  ON 4
ci_006                -1.872798e-02 3 1  ON 5
ci_007                -1.840294e-02 3 1  ON 6
ci_008                -1.783243e-02 3 1  ON 7
ci_009                -1.759085e-02 3 1  ON 8
ci_010                -1.748735e-02 3 1  ON 9
ci_011                -1.622201e-02 3 1  ON 10
ci_012                -1.602813e-02 3 1  ON 11
ci_013                -1.825103e-02 3 1  ON 12
ci_014                 1.327475e-02 3 1  ON 13
ci_015                 1.384362e-02 3 1  ON 14
ci_016                 1.631361e-02 3 1  ON 15
ci_017                 1.677411e-02 3 1  ON 16
ci_018                 1.296646e-02 3 1  ON 17
ci_019                 1.263368e-02 3 1  ON 18
ci_020                 1.333242e-02 3 1  ON 19
ci_021                 1.320704e-02 3 1  ON 20
ci_022                 1.135450e-02 3 1  ON 21
ci_023                 1.135838e-02 3 1  ON 22
ci_024                 1.165222e-02 3 1  ON 23
ci_025                 1.179885e-02 3 1  ON 24
ci_026                 1.142269e-02 3 1  ON 25
ci_027                 1.144100e-02 3 1  ON 26
ci_028                -1.449820e-02 3 1  ON 27
ci_029                -1.410510e-02 3 1  ON 28
ci_030                -1.085261e-02 3 1  ON 29
ci_031                -1.109449e-02 3 1  ON 30
ci_032                -1.367098e-02 3 1  ON 31
ci_033                 1.027278e-02 3 1  ON 32
ci_034                 9.852548e-03 3 1  ON 33
ci_035                -4.595484e-03 3 1  ON 34
ci_036                -9.929008e-03 3 1  ON 35
ci_037                -9.959409e-03 3 1  ON 36
ci_038                 1.659009e-03 3 1  ON 37
ci_039                 1.581387e-03 3 1  ON 38
ci_040                -4.176952e-03 3 1  ON 39
ci_041                 9.803229e-03 3 1  ON 40
ci_042                 9.866903e-03 3 1  ON 41
ci_043                -3.175749e-03 3 1  ON 42
ci_044                -1.473056e-02 3 1  ON 43
ci_045                -1.931983e-03 3 1  ON 44
ci_046                 5.507465e-03 3 1  ON 45
ci_047                 5.475601e-03 3 1  ON 46
ci_048                -1.205985e-02 3 1  ON 47
ci_049                -1.215595e-02 3 1  ON 48
ci_050                 7.413906e-03 3 1  ON 49
ci_051                 7.487892e-03 3 1  ON 50
ci_052                -6.506377e-03 3 1  ON 51
ci_053                -6.681082e-03 3 1  ON 52
ci_054                -2.938143e-03 3 1  ON 53
ci_055                -2.852031e-03 3 1  ON 54
ci_056                 4.448196e-03 3 1  ON 55
ci_057                 4.433542e-03 3 1  ON 56
ci_058                -6.888474e-03 3 1  ON 57
ci_059                -6.783849e-03 3 1  ON 58
ci_060                 8.751231e-03 3 1  ON 59
ci_061                 8.219286e-03 3 1  ON 60
ci_062                -3.150661e-03 3 1  ON 61
ci_063                -3.055855e-03 3 1  ON 62
ci_064                -2.937448e-03 3 1  ON 63
ci_065                -4.377601e-03 3 1  ON 64
ci_066                 5.647037e-03 3 1  ON 65
ci_067                 5.613299e-03 3 1  ON 66
ci_068                -4.810705e-03 3 1  ON 67
ci_069                -5.165869e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0200e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.3175
    reference variance = 0.573382
====================================================
  Execution time = 2.7089e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0562e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1666e-01
  Total weights = 3.913513125e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9265e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300364996356
                                         uncertainty =       0.001926441002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300364996356
                                         uncertainty =       0.001926441002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274080663
  error estimate for blocks of size 2^( 2) =       0.000281354636
  error estimate for blocks of size 2^( 3) =       0.000287614583
  error estimate for blocks of size 2^( 4) =       0.000292042747
  error estimate for blocks of size 2^( 5) =       0.000294999084
  error estimate for blocks of size 2^( 6) =       0.000296452726
  error estimate for blocks of size 2^( 7) =       0.000297099568
  error estimate for blocks of size 2^( 8) =       0.000296850786

      target function =                  N/A
              le_mean =     -17.216561524142
             les_mean =     296.726654437259
             stat err =       0.000296350541
             autocorr =       1.169108064811
              std dev =       0.548161325496
             le_variance =       0.300480838769


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656152414e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216561524157       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216562132448       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216562119368       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+00 is 8.743768e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216561524157       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216561683375       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216561682629       residual = 9.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+01 is 2.252755e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216561524157       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216561564434       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216561564426       residual = 9.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+01 is 5.675300e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.350527 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2024e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -4.031014e-02 3 1  ON 0
ci_002                -3.032964e-02 3 1  ON 1
ci_003                -2.479417e-02 3 1  ON 2
ci_004                 2.146197e-02 3 1  ON 3
ci_005                 2.070502e-02 3 1  ON 4
ci_006                -1.872407e-02 3 1  ON 5
ci_007                -1.841488e-02 3 1  ON 6
ci_008                -1.783409e-02 3 1  ON 7
ci_009                -1.760156e-02 3 1  ON 8
ci_010                -1.748699e-02 3 1  ON 9
ci_011                -1.622338e-02 3 1  ON 10
ci_012                -1.601961e-02 3 1  ON 11
ci_013                -1.827356e-02 3 1  ON 12
ci_014                 1.328822e-02 3 1  ON 13
ci_015                 1.383060e-02 3 1  ON 14
ci_016                 1.632026e-02 3 1  ON 15
ci_017                 1.676924e-02 3 1  ON 16
ci_018                 1.296759e-02 3 1  ON 17
ci_019                 1.263675e-02 3 1  ON 18
ci_020                 1.333092e-02 3 1  ON 19
ci_021                 1.321084e-02 3 1  ON 20
ci_022                 1.135990e-02 3 1  ON 21
ci_023                 1.135767e-02 3 1  ON 22
ci_024                 1.164607e-02 3 1  ON 23
ci_025                 1.180998e-02 3 1  ON 24
ci_026                 1.142089e-02 3 1  ON 25
ci_027                 1.142705e-02 3 1  ON 26
ci_028                -1.449694e-02 3 1  ON 27
ci_029                -1.411287e-02 3 1  ON 28
ci_030                -1.085519e-02 3 1  ON 29
ci_031                -1.109195e-02 3 1  ON 30
ci_032                -1.367677e-02 3 1  ON 31
ci_033                 1.026927e-02 3 1  ON 32
ci_034                 9.861457e-03 3 1  ON 33
ci_035                -4.598817e-03 3 1  ON 34
ci_036                -9.936985e-03 3 1  ON 35
ci_037                -9.961471e-03 3 1  ON 36
ci_038                 1.659383e-03 3 1  ON 37
ci_039                 1.584449e-03 3 1  ON 38
ci_040                -4.181379e-03 3 1  ON 39
ci_041                 9.801128e-03 3 1  ON 40
ci_042                 9.871126e-03 3 1  ON 41
ci_043                -3.166414e-03 3 1  ON 42
ci_044                -1.474111e-02 3 1  ON 43
ci_045                -1.928741e-03 3 1  ON 44
ci_046                 5.507301e-03 3 1  ON 45
ci_047                 5.485789e-03 3 1  ON 46
ci_048                -1.206216e-02 3 1  ON 47
ci_049                -1.216013e-02 3 1  ON 48
ci_050                 7.423905e-03 3 1  ON 49
ci_051                 7.488196e-03 3 1  ON 50
ci_052                -6.511077e-03 3 1  ON 51
ci_053                -6.671116e-03 3 1  ON 52
ci_054                -2.942630e-03 3 1  ON 53
ci_055                -2.855410e-03 3 1  ON 54
ci_056                 4.462153e-03 3 1  ON 55
ci_057                 4.435492e-03 3 1  ON 56
ci_058                -6.881754e-03 3 1  ON 57
ci_059                -6.768097e-03 3 1  ON 58
ci_060                 8.740690e-03 3 1  ON 59
ci_061                 8.227304e-03 3 1  ON 60
ci_062                -3.157322e-03 3 1  ON 61
ci_063                -3.053297e-03 3 1  ON 62
ci_064                -2.942786e-03 3 1  ON 63
ci_065                -4.365870e-03 3 1  ON 64
ci_066                 5.654186e-03 3 1  ON 65
ci_067                 5.607117e-03 3 1  ON 66
ci_068                -4.814305e-03 3 1  ON 67
ci_069                -5.145424e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2422
    reference variance = 0.306997
====================================================
  Execution time = 2.6756e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1126e-01
  Total weights = 3.9135e+06
  Execution time = 3.6392e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297796001532
                                         uncertainty =       0.001445385816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297796001532
                                         uncertainty =       0.001445385816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272820098
  error estimate for blocks of size 2^( 2) =       0.000279762088
  error estimate for blocks of size 2^( 3) =       0.000285926321
  error estimate for blocks of size 2^( 4) =       0.000290321256
  error estimate for blocks of size 2^( 5) =       0.000292848141
  error estimate for blocks of size 2^( 6) =       0.000294290250
  error estimate for blocks of size 2^( 7) =       0.000295732980
  error estimate for blocks of size 2^( 8) =       0.000296082917

      target function =                  N/A
              le_mean =     -17.216420401263
             les_mean =     296.716368008626
             stat err =       0.000294738572
             autocorr =       1.167135366408
              std dev =       0.545640195613
             le_variance =       0.297723223069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297787597562
                                         uncertainty =       0.001444540716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297787597562
                                         uncertainty =       0.001444540716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272816241
  error estimate for blocks of size 2^( 2) =       0.000279757604
  error estimate for blocks of size 2^( 3) =       0.000285921317
  error estimate for blocks of size 2^( 4) =       0.000290315856
  error estimate for blocks of size 2^( 5) =       0.000292841520
  error estimate for blocks of size 2^( 6) =       0.000294283484
  error estimate for blocks of size 2^( 7) =       0.000295728975
  error estimate for blocks of size 2^( 8) =       0.000296077213

      target function =                  N/A
              le_mean =     -17.216420303394
             les_mean =     296.716660430029
             stat err =       0.000294732798
             autocorr =       1.167122637366
              std dev =       0.545632482296
             le_variance =       0.297714805737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297791247044
                                         uncertainty =       0.001444941554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297791247044
                                         uncertainty =       0.001444941554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272817916
  error estimate for blocks of size 2^( 2) =       0.000279759586
  error estimate for blocks of size 2^( 3) =       0.000285923542
  error estimate for blocks of size 2^( 4) =       0.000290318287
  error estimate for blocks of size 2^( 5) =       0.000292844505
  error estimate for blocks of size 2^( 6) =       0.000294286537
  error estimate for blocks of size 2^( 7) =       0.000295730672
  error estimate for blocks of size 2^( 8) =       0.000296079712

      target function =                  N/A
              le_mean =     -17.216420311125
             les_mean =     296.716610119139
             stat err =       0.000294735356
             autocorr =       1.167128567746
              std dev =       0.545635831941
             le_variance =       0.297718461098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297795360415
                                         uncertainty =       0.001445329194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297795360415
                                         uncertainty =       0.001445329194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272819804
  error estimate for blocks of size 2^( 2) =       0.000279761753
  error estimate for blocks of size 2^( 3) =       0.000285925952
  error estimate for blocks of size 2^( 4) =       0.000290320861
  error estimate for blocks of size 2^( 5) =       0.000292847666
  error estimate for blocks of size 2^( 6) =       0.000294289762
  error estimate for blocks of size 2^( 7) =       0.000295732671
  error estimate for blocks of size 2^( 8) =       0.000296082492

      target function =                  N/A
              le_mean =     -17.216420383238
             les_mean =     296.716369428989
             stat err =       0.000294738148
             autocorr =       1.167134524837
              std dev =       0.545639607193
             le_variance =       0.297722580938


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216420401263        initial  <--
     3.8147e+00     3.8147e+01             8.7438e-05       -17.216420303394
     1.5259e+01     1.5259e+02             2.2528e-05       -17.216420311125
     6.1035e+01     6.1035e+02             5.6753e-06       -17.216420383238

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.1077
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -4.030606e-02 3 1  ON 0
ci_002                -3.033028e-02 3 1  ON 1
ci_003                -2.478624e-02 3 1  ON 2
ci_004                 2.146319e-02 3 1  ON 3
ci_005                 2.070115e-02 3 1  ON 4
ci_006                -1.872798e-02 3 1  ON 5
ci_007                -1.840294e-02 3 1  ON 6
ci_008                -1.783243e-02 3 1  ON 7
ci_009                -1.759085e-02 3 1  ON 8
ci_010                -1.748735e-02 3 1  ON 9
ci_011                -1.622201e-02 3 1  ON 10
ci_012                -1.602813e-02 3 1  ON 11
ci_013                -1.825103e-02 3 1  ON 12
ci_014                 1.327475e-02 3 1  ON 13
ci_015                 1.384362e-02 3 1  ON 14
ci_016                 1.631361e-02 3 1  ON 15
ci_017                 1.677411e-02 3 1  ON 16
ci_018                 1.296646e-02 3 1  ON 17
ci_019                 1.263368e-02 3 1  ON 18
ci_020                 1.333242e-02 3 1  ON 19
ci_021                 1.320704e-02 3 1  ON 20
ci_022                 1.135450e-02 3 1  ON 21
ci_023                 1.135838e-02 3 1  ON 22
ci_024                 1.165222e-02 3 1  ON 23
ci_025                 1.179885e-02 3 1  ON 24
ci_026                 1.142269e-02 3 1  ON 25
ci_027                 1.144100e-02 3 1  ON 26
ci_028                -1.449820e-02 3 1  ON 27
ci_029                -1.410510e-02 3 1  ON 28
ci_030                -1.085261e-02 3 1  ON 29
ci_031                -1.109449e-02 3 1  ON 30
ci_032                -1.367098e-02 3 1  ON 31
ci_033                 1.027278e-02 3 1  ON 32
ci_034                 9.852548e-03 3 1  ON 33
ci_035                -4.595484e-03 3 1  ON 34
ci_036                -9.929008e-03 3 1  ON 35
ci_037                -9.959409e-03 3 1  ON 36
ci_038                 1.659009e-03 3 1  ON 37
ci_039                 1.581387e-03 3 1  ON 38
ci_040                -4.176952e-03 3 1  ON 39
ci_041                 9.803229e-03 3 1  ON 40
ci_042                 9.866903e-03 3 1  ON 41
ci_043                -3.175749e-03 3 1  ON 42
ci_044                -1.473056e-02 3 1  ON 43
ci_045                -1.931983e-03 3 1  ON 44
ci_046                 5.507465e-03 3 1  ON 45
ci_047                 5.475601e-03 3 1  ON 46
ci_048                -1.205985e-02 3 1  ON 47
ci_049                -1.215595e-02 3 1  ON 48
ci_050                 7.413906e-03 3 1  ON 49
ci_051                 7.487892e-03 3 1  ON 50
ci_052                -6.506377e-03 3 1  ON 51
ci_053                -6.681082e-03 3 1  ON 52
ci_054                -2.938143e-03 3 1  ON 53
ci_055                -2.852031e-03 3 1  ON 54
ci_056                 4.448196e-03 3 1  ON 55
ci_057                 4.433542e-03 3 1  ON 56
ci_058                -6.888474e-03 3 1  ON 57
ci_059                -6.783849e-03 3 1  ON 58
ci_060                 8.751231e-03 3 1  ON 59
ci_061                 8.219286e-03 3 1  ON 60
ci_062                -3.150661e-03 3 1  ON 61
ci_063                -3.055855e-03 3 1  ON 62
ci_064                -2.937448e-03 3 1  ON 63
ci_065                -4.377601e-03 3 1  ON 64
ci_066                 5.647037e-03 3 1  ON 65
ci_067                 5.613299e-03 3 1  ON 66
ci_068                -4.810705e-03 3 1  ON 67
ci_069                -5.165869e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7147e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1748
    reference variance = 0.239337
====================================================
  Execution time = 2.7548e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0549e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1560e-01
  Total weights = 3.913508451e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9690e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299874589250
                                         uncertainty =       0.001394169380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299874589250
                                         uncertainty =       0.001394169380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273787657
  error estimate for blocks of size 2^( 2) =       0.000280907889
  error estimate for blocks of size 2^( 3) =       0.000287193754
  error estimate for blocks of size 2^( 4) =       0.000291987338
  error estimate for blocks of size 2^( 5) =       0.000294907012
  error estimate for blocks of size 2^( 6) =       0.000295862203
  error estimate for blocks of size 2^( 7) =       0.000296367813
  error estimate for blocks of size 2^( 8) =       0.000298740516

      target function =                  N/A
              le_mean =     -17.216525687362
             les_mean =     296.724358511996
             stat err =       0.000296469386
             autocorr =       1.172551641164
              std dev =       0.547575313234
             le_variance =       0.299838723664


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721652568736e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216525687385       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216525758789       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216525755243       residual = 5.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+01 is 7.536232e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216525687385       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216525705329       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216525704416       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+02 is 1.901172e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216525687385       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216525691877       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216525691647       residual = 5.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+02 is 4.763740e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.351594 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2524e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -4.030637e-02 3 1  ON 0
ci_002                -3.033034e-02 3 1  ON 1
ci_003                -2.478718e-02 3 1  ON 2
ci_004                 2.146270e-02 3 1  ON 3
ci_005                 2.070069e-02 3 1  ON 4
ci_006                -1.872784e-02 3 1  ON 5
ci_007                -1.840405e-02 3 1  ON 6
ci_008                -1.783296e-02 3 1  ON 7
ci_009                -1.759087e-02 3 1  ON 8
ci_010                -1.748736e-02 3 1  ON 9
ci_011                -1.622353e-02 3 1  ON 10
ci_012                -1.602744e-02 3 1  ON 11
ci_013                -1.825194e-02 3 1  ON 12
ci_014                 1.327531e-02 3 1  ON 13
ci_015                 1.384258e-02 3 1  ON 14
ci_016                 1.631377e-02 3 1  ON 15
ci_017                 1.677351e-02 3 1  ON 16
ci_018                 1.296601e-02 3 1  ON 17
ci_019                 1.263364e-02 3 1  ON 18
ci_020                 1.333190e-02 3 1  ON 19
ci_021                 1.320707e-02 3 1  ON 20
ci_022                 1.135362e-02 3 1  ON 21
ci_023                 1.135842e-02 3 1  ON 22
ci_024                 1.165201e-02 3 1  ON 23
ci_025                 1.179907e-02 3 1  ON 24
ci_026                 1.142250e-02 3 1  ON 25
ci_027                 1.144076e-02 3 1  ON 26
ci_028                -1.449769e-02 3 1  ON 27
ci_029                -1.410541e-02 3 1  ON 28
ci_030                -1.085245e-02 3 1  ON 29
ci_031                -1.109518e-02 3 1  ON 30
ci_032                -1.367224e-02 3 1  ON 31
ci_033                 1.027233e-02 3 1  ON 32
ci_034                 9.853270e-03 3 1  ON 33
ci_035                -4.595536e-03 3 1  ON 34
ci_036                -9.929873e-03 3 1  ON 35
ci_037                -9.959032e-03 3 1  ON 36
ci_038                 1.659476e-03 3 1  ON 37
ci_039                 1.581610e-03 3 1  ON 38
ci_040                -4.175766e-03 3 1  ON 39
ci_041                 9.803611e-03 3 1  ON 40
ci_042                 9.866885e-03 3 1  ON 41
ci_043                -3.175165e-03 3 1  ON 42
ci_044                -1.473151e-02 3 1  ON 43
ci_045                -1.931732e-03 3 1  ON 44
ci_046                 5.507909e-03 3 1  ON 45
ci_047                 5.476441e-03 3 1  ON 46
ci_048                -1.206029e-02 3 1  ON 47
ci_049                -1.215627e-02 3 1  ON 48
ci_050                 7.414882e-03 3 1  ON 49
ci_051                 7.487994e-03 3 1  ON 50
ci_052                -6.506792e-03 3 1  ON 51
ci_053                -6.680847e-03 3 1  ON 52
ci_054                -2.938147e-03 3 1  ON 53
ci_055                -2.852039e-03 3 1  ON 54
ci_056                 4.448411e-03 3 1  ON 55
ci_057                 4.433889e-03 3 1  ON 56
ci_058                -6.888117e-03 3 1  ON 57
ci_059                -6.783614e-03 3 1  ON 58
ci_060                 8.750248e-03 3 1  ON 59
ci_061                 8.220458e-03 3 1  ON 60
ci_062                -3.150473e-03 3 1  ON 61
ci_063                -3.055698e-03 3 1  ON 62
ci_064                -2.937298e-03 3 1  ON 63
ci_065                -4.375700e-03 3 1  ON 64
ci_066                 5.647030e-03 3 1  ON 65
ci_067                 5.614062e-03 3 1  ON 66
ci_068                -4.811503e-03 3 1  ON 67
ci_069                -5.165735e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2804
    reference variance = 0.182613
====================================================
  Execution time = 2.6664e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1239e-01
  Total weights = 3.9130e+06
  Execution time = 3.6344e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298933032428
                                         uncertainty =       0.001358542531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298933032428
                                         uncertainty =       0.001358542531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273371559
  error estimate for blocks of size 2^( 2) =       0.000280697860
  error estimate for blocks of size 2^( 3) =       0.000287256154
  error estimate for blocks of size 2^( 4) =       0.000292042996
  error estimate for blocks of size 2^( 5) =       0.000294703712
  error estimate for blocks of size 2^( 6) =       0.000296400743
  error estimate for blocks of size 2^( 7) =       0.000297395375
  error estimate for blocks of size 2^( 8) =       0.000298647316

      target function =                  N/A
              le_mean =     -17.216474817961
             les_mean =     296.719389048103
             stat err =       0.000296786786
             autocorr =       1.178643494499
              std dev =       0.546743117942
             le_variance =       0.298928037017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298934050923
                                         uncertainty =       0.001358432965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298934050923
                                         uncertainty =       0.001358432965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273372027
  error estimate for blocks of size 2^( 2) =       0.000280698257
  error estimate for blocks of size 2^( 3) =       0.000287256458
  error estimate for blocks of size 2^( 4) =       0.000292043301
  error estimate for blocks of size 2^( 5) =       0.000294703944
  error estimate for blocks of size 2^( 6) =       0.000296401053
  error estimate for blocks of size 2^( 7) =       0.000297395732
  error estimate for blocks of size 2^( 8) =       0.000298647836

      target function =                  N/A
              le_mean =     -17.216474799403
             les_mean =     296.719384741609
             stat err =       0.000296787141
             autocorr =       1.178642277071
              std dev =       0.546744053942
             le_variance =       0.298929060521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298933540630
                                         uncertainty =       0.001358487329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298933540630
                                         uncertainty =       0.001358487329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273371792
  error estimate for blocks of size 2^( 2) =       0.000280698058
  error estimate for blocks of size 2^( 3) =       0.000287256305
  error estimate for blocks of size 2^( 4) =       0.000292043148
  error estimate for blocks of size 2^( 5) =       0.000294703828
  error estimate for blocks of size 2^( 6) =       0.000296400898
  error estimate for blocks of size 2^( 7) =       0.000297395555
  error estimate for blocks of size 2^( 8) =       0.000298647576

      target function =                  N/A
              le_mean =     -17.216474808010
             les_mean =     296.719471064275
             stat err =       0.000296786964
             autocorr =       1.178642891605
              std dev =       0.546743584998
             le_variance =       0.298928547736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298933095724
                                         uncertainty =       0.001358535614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298933095724
                                         uncertainty =       0.001358535614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273371588
  error estimate for blocks of size 2^( 2) =       0.000280697885
  error estimate for blocks of size 2^( 3) =       0.000287256173
  error estimate for blocks of size 2^( 4) =       0.000292043015
  error estimate for blocks of size 2^( 5) =       0.000294703726
  error estimate for blocks of size 2^( 6) =       0.000296400762
  error estimate for blocks of size 2^( 7) =       0.000297395397
  error estimate for blocks of size 2^( 8) =       0.000298647348

      target function =                  N/A
              le_mean =     -17.216474816698
             les_mean =     296.719388950662
             stat err =       0.000296786808
             autocorr =       1.178643418905
              std dev =       0.546743176115
             le_variance =       0.298928100628


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216474817961        initial  <--
     3.8147e+01     3.8147e+02             7.5362e-06       -17.216474799403
     1.5259e+02     1.5259e+03             1.9012e-06       -17.216474808010
     6.1035e+02     6.1035e+03             4.7637e-07       -17.216474816698

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.2003
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -4.030606e-02 3 1  ON 0
ci_002                -3.033028e-02 3 1  ON 1
ci_003                -2.478624e-02 3 1  ON 2
ci_004                 2.146319e-02 3 1  ON 3
ci_005                 2.070115e-02 3 1  ON 4
ci_006                -1.872798e-02 3 1  ON 5
ci_007                -1.840294e-02 3 1  ON 6
ci_008                -1.783243e-02 3 1  ON 7
ci_009                -1.759085e-02 3 1  ON 8
ci_010                -1.748735e-02 3 1  ON 9
ci_011                -1.622201e-02 3 1  ON 10
ci_012                -1.602813e-02 3 1  ON 11
ci_013                -1.825103e-02 3 1  ON 12
ci_014                 1.327475e-02 3 1  ON 13
ci_015                 1.384362e-02 3 1  ON 14
ci_016                 1.631361e-02 3 1  ON 15
ci_017                 1.677411e-02 3 1  ON 16
ci_018                 1.296646e-02 3 1  ON 17
ci_019                 1.263368e-02 3 1  ON 18
ci_020                 1.333242e-02 3 1  ON 19
ci_021                 1.320704e-02 3 1  ON 20
ci_022                 1.135450e-02 3 1  ON 21
ci_023                 1.135838e-02 3 1  ON 22
ci_024                 1.165222e-02 3 1  ON 23
ci_025                 1.179885e-02 3 1  ON 24
ci_026                 1.142269e-02 3 1  ON 25
ci_027                 1.144100e-02 3 1  ON 26
ci_028                -1.449820e-02 3 1  ON 27
ci_029                -1.410510e-02 3 1  ON 28
ci_030                -1.085261e-02 3 1  ON 29
ci_031                -1.109449e-02 3 1  ON 30
ci_032                -1.367098e-02 3 1  ON 31
ci_033                 1.027278e-02 3 1  ON 32
ci_034                 9.852548e-03 3 1  ON 33
ci_035                -4.595484e-03 3 1  ON 34
ci_036                -9.929008e-03 3 1  ON 35
ci_037                -9.959409e-03 3 1  ON 36
ci_038                 1.659009e-03 3 1  ON 37
ci_039                 1.581387e-03 3 1  ON 38
ci_040                -4.176952e-03 3 1  ON 39
ci_041                 9.803229e-03 3 1  ON 40
ci_042                 9.866903e-03 3 1  ON 41
ci_043                -3.175749e-03 3 1  ON 42
ci_044                -1.473056e-02 3 1  ON 43
ci_045                -1.931983e-03 3 1  ON 44
ci_046                 5.507465e-03 3 1  ON 45
ci_047                 5.475601e-03 3 1  ON 46
ci_048                -1.205985e-02 3 1  ON 47
ci_049                -1.215595e-02 3 1  ON 48
ci_050                 7.413906e-03 3 1  ON 49
ci_051                 7.487892e-03 3 1  ON 50
ci_052                -6.506377e-03 3 1  ON 51
ci_053                -6.681082e-03 3 1  ON 52
ci_054                -2.938143e-03 3 1  ON 53
ci_055                -2.852031e-03 3 1  ON 54
ci_056                 4.448196e-03 3 1  ON 55
ci_057                 4.433542e-03 3 1  ON 56
ci_058                -6.888474e-03 3 1  ON 57
ci_059                -6.783849e-03 3 1  ON 58
ci_060                 8.751231e-03 3 1  ON 59
ci_061                 8.219286e-03 3 1  ON 60
ci_062                -3.150661e-03 3 1  ON 61
ci_063                -3.055855e-03 3 1  ON 62
ci_064                -2.937448e-03 3 1  ON 63
ci_065                -4.377601e-03 3 1  ON 64
ci_066                 5.647037e-03 3 1  ON 65
ci_067                 5.613299e-03 3 1  ON 66
ci_068                -4.810705e-03 3 1  ON 67
ci_069                -5.165869e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7771e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1797
    reference variance = 0.283834
====================================================
  Execution time = 2.7098e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0600e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1289e-01
  Total weights = 3.913607393e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9867e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298599932685
                                         uncertainty =       0.001486576616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298599932685
                                         uncertainty =       0.001486576616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273217082
  error estimate for blocks of size 2^( 2) =       0.000280341798
  error estimate for blocks of size 2^( 3) =       0.000287184856
  error estimate for blocks of size 2^( 4) =       0.000291937403
  error estimate for blocks of size 2^( 5) =       0.000294783832
  error estimate for blocks of size 2^( 6) =       0.000295962695
  error estimate for blocks of size 2^( 7) =       0.000298404323
  error estimate for blocks of size 2^( 8) =       0.000299766177

      target function =                  N/A
              le_mean =     -17.216177665919
             les_mean =     296.709658709289
             stat err =       0.000297229257
             autocorr =       1.183497689247
              std dev =       0.546434163621
             le_variance =       0.298590295172


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721617766592e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216177665935       residual = 8.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216177670272       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216177669662       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+02 is 8.042713e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216177665935       residual = 8.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216177667020       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216177666867       residual = 7.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+03 is 2.011835e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216177665935       residual = 8.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216177666206       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216177666168       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+03 is 5.030312e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.352658 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2092e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -4.030601e-02 3 1  ON 0
ci_002                -3.033022e-02 3 1  ON 1
ci_003                -2.478617e-02 3 1  ON 2
ci_004                 2.146305e-02 3 1  ON 3
ci_005                 2.070119e-02 3 1  ON 4
ci_006                -1.872801e-02 3 1  ON 5
ci_007                -1.840292e-02 3 1  ON 6
ci_008                -1.783235e-02 3 1  ON 7
ci_009                -1.759080e-02 3 1  ON 8
ci_010                -1.748728e-02 3 1  ON 9
ci_011                -1.622217e-02 3 1  ON 10
ci_012                -1.602816e-02 3 1  ON 11
ci_013                -1.825111e-02 3 1  ON 12
ci_014                 1.327492e-02 3 1  ON 13
ci_015                 1.384356e-02 3 1  ON 14
ci_016                 1.631376e-02 3 1  ON 15
ci_017                 1.677404e-02 3 1  ON 16
ci_018                 1.296648e-02 3 1  ON 17
ci_019                 1.263367e-02 3 1  ON 18
ci_020                 1.333257e-02 3 1  ON 19
ci_021                 1.320705e-02 3 1  ON 20
ci_022                 1.135451e-02 3 1  ON 21
ci_023                 1.135836e-02 3 1  ON 22
ci_024                 1.165221e-02 3 1  ON 23
ci_025                 1.179890e-02 3 1  ON 24
ci_026                 1.142263e-02 3 1  ON 25
ci_027                 1.144097e-02 3 1  ON 26
ci_028                -1.449829e-02 3 1  ON 27
ci_029                -1.410521e-02 3 1  ON 28
ci_030                -1.085265e-02 3 1  ON 29
ci_031                -1.109447e-02 3 1  ON 30
ci_032                -1.367101e-02 3 1  ON 31
ci_033                 1.027283e-02 3 1  ON 32
ci_034                 9.852574e-03 3 1  ON 33
ci_035                -4.595503e-03 3 1  ON 34
ci_036                -9.929064e-03 3 1  ON 35
ci_037                -9.959450e-03 3 1  ON 36
ci_038                 1.659024e-03 3 1  ON 37
ci_039                 1.581406e-03 3 1  ON 38
ci_040                -4.176967e-03 3 1  ON 39
ci_041                 9.803157e-03 3 1  ON 40
ci_042                 9.866903e-03 3 1  ON 41
ci_043                -3.175740e-03 3 1  ON 42
ci_044                -1.473057e-02 3 1  ON 43
ci_045                -1.932060e-03 3 1  ON 44
ci_046                 5.507423e-03 3 1  ON 45
ci_047                 5.475762e-03 3 1  ON 46
ci_048                -1.205987e-02 3 1  ON 47
ci_049                -1.215582e-02 3 1  ON 48
ci_050                 7.413956e-03 3 1  ON 49
ci_051                 7.487944e-03 3 1  ON 50
ci_052                -6.506377e-03 3 1  ON 51
ci_053                -6.681048e-03 3 1  ON 52
ci_054                -2.938175e-03 3 1  ON 53
ci_055                -2.852126e-03 3 1  ON 54
ci_056                 4.448231e-03 3 1  ON 55
ci_057                 4.433592e-03 3 1  ON 56
ci_058                -6.888587e-03 3 1  ON 57
ci_059                -6.783648e-03 3 1  ON 58
ci_060                 8.751248e-03 3 1  ON 59
ci_061                 8.219425e-03 3 1  ON 60
ci_062                -3.150696e-03 3 1  ON 61
ci_063                -3.055860e-03 3 1  ON 62
ci_064                -2.937547e-03 3 1  ON 63
ci_065                -4.377503e-03 3 1  ON 64
ci_066                 5.647025e-03 3 1  ON 65
ci_067                 5.613237e-03 3 1  ON 66
ci_068                -4.810645e-03 3 1  ON 67
ci_069                -5.165800e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1726
    reference variance = 0.147889
====================================================
  Execution time = 2.6834e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1575e-01
  Total weights = 3.9137e+06
  Execution time = 3.6417e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300230124420
                                         uncertainty =       0.001562565546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300230124420
                                         uncertainty =       0.001562565546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274000331
  error estimate for blocks of size 2^( 2) =       0.000280986484
  error estimate for blocks of size 2^( 3) =       0.000287353525
  error estimate for blocks of size 2^( 4) =       0.000291372092
  error estimate for blocks of size 2^( 5) =       0.000294437723
  error estimate for blocks of size 2^( 6) =       0.000295481737
  error estimate for blocks of size 2^( 7) =       0.000296287717
  error estimate for blocks of size 2^( 8) =       0.000297535832

      target function =                  N/A
              le_mean =     -17.216319902990
             les_mean =     296.717420552221
             stat err =       0.000295935752
             autocorr =       1.166521361679
              std dev =       0.548000661875
             le_variance =       0.300304725416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300229910553
                                         uncertainty =       0.001562566757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300229910553
                                         uncertainty =       0.001562566757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274000232
  error estimate for blocks of size 2^( 2) =       0.000280986391
  error estimate for blocks of size 2^( 3) =       0.000287353431
  error estimate for blocks of size 2^( 4) =       0.000291372003
  error estimate for blocks of size 2^( 5) =       0.000294437639
  error estimate for blocks of size 2^( 6) =       0.000295481638
  error estimate for blocks of size 2^( 7) =       0.000296287606
  error estimate for blocks of size 2^( 8) =       0.000297535738

      target function =                  N/A
              le_mean =     -17.216319903830
             les_mean =     296.717419460889
             stat err =       0.000295935655
             autocorr =       1.166521439371
              std dev =       0.548000464529
             le_variance =       0.300304509124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300230017403
                                         uncertainty =       0.001562566151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300230017403
                                         uncertainty =       0.001562566151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274000282
  error estimate for blocks of size 2^( 2) =       0.000280986438
  error estimate for blocks of size 2^( 3) =       0.000287353478
  error estimate for blocks of size 2^( 4) =       0.000291372047
  error estimate for blocks of size 2^( 5) =       0.000294437681
  error estimate for blocks of size 2^( 6) =       0.000295481687
  error estimate for blocks of size 2^( 7) =       0.000296287662
  error estimate for blocks of size 2^( 8) =       0.000297535785

      target function =                  N/A
              le_mean =     -17.216319903405
             les_mean =     296.717419994199
             stat err =       0.000295935704
             autocorr =       1.166521400547
              std dev =       0.548000563126
             le_variance =       0.300304617186

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300230111038
                                         uncertainty =       0.001562565622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300230111038
                                         uncertainty =       0.001562565622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274000325
  error estimate for blocks of size 2^( 2) =       0.000280986479
  error estimate for blocks of size 2^( 3) =       0.000287353519
  error estimate for blocks of size 2^( 4) =       0.000291372086
  error estimate for blocks of size 2^( 5) =       0.000294437718
  error estimate for blocks of size 2^( 6) =       0.000295481731
  error estimate for blocks of size 2^( 7) =       0.000296287710
  error estimate for blocks of size 2^( 8) =       0.000297535826

      target function =                  N/A
              le_mean =     -17.216319903041
             les_mean =     296.717420481105
             stat err =       0.000295935746
             autocorr =       1.166521366529
              std dev =       0.548000649527
             le_variance =       0.300304711882


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216319902990        initial
     3.8147e+02     3.8147e+03             8.0427e-07       -17.216319903830  <--
     1.5259e+03     1.5259e+04             2.0118e-07       -17.216319903405
     6.1035e+03     6.1035e+04             5.0303e-08       -17.216319903041

*****************************************************************************
Applying the update for shift_i =   3.8147e+02     and shift_s =   3.8147e+03
*****************************************************************************

  Execution time = 4.5190e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -4.030589e-02 3 1  ON 0
ci_002                -3.033005e-02 3 1  ON 1
ci_003                -2.478599e-02 3 1  ON 2
ci_004                 2.146265e-02 3 1  ON 3
ci_005                 2.070129e-02 3 1  ON 4
ci_006                -1.872811e-02 3 1  ON 5
ci_007                -1.840285e-02 3 1  ON 6
ci_008                -1.783214e-02 3 1  ON 7
ci_009                -1.759065e-02 3 1  ON 8
ci_010                -1.748706e-02 3 1  ON 9
ci_011                -1.622263e-02 3 1  ON 10
ci_012                -1.602824e-02 3 1  ON 11
ci_013                -1.825134e-02 3 1  ON 12
ci_014                 1.327544e-02 3 1  ON 13
ci_015                 1.384339e-02 3 1  ON 14
ci_016                 1.631424e-02 3 1  ON 15
ci_017                 1.677383e-02 3 1  ON 16
ci_018                 1.296653e-02 3 1  ON 17
ci_019                 1.263363e-02 3 1  ON 18
ci_020                 1.333301e-02 3 1  ON 19
ci_021                 1.320707e-02 3 1  ON 20
ci_022                 1.135455e-02 3 1  ON 21
ci_023                 1.135828e-02 3 1  ON 22
ci_024                 1.165218e-02 3 1  ON 23
ci_025                 1.179904e-02 3 1  ON 24
ci_026                 1.142243e-02 3 1  ON 25
ci_027                 1.144088e-02 3 1  ON 26
ci_028                -1.449858e-02 3 1  ON 27
ci_029                -1.410555e-02 3 1  ON 28
ci_030                -1.085275e-02 3 1  ON 29
ci_031                -1.109443e-02 3 1  ON 30
ci_032                -1.367109e-02 3 1  ON 31
ci_033                 1.027299e-02 3 1  ON 32
ci_034                 9.852654e-03 3 1  ON 33
ci_035                -4.595562e-03 3 1  ON 34
ci_036                -9.929230e-03 3 1  ON 35
ci_037                -9.959573e-03 3 1  ON 36
ci_038                 1.659068e-03 3 1  ON 37
ci_039                 1.581464e-03 3 1  ON 38
ci_040                -4.177015e-03 3 1  ON 39
ci_041                 9.802939e-03 3 1  ON 40
ci_042                 9.866903e-03 3 1  ON 41
ci_043                -3.175712e-03 3 1  ON 42
ci_044                -1.473058e-02 3 1  ON 43
ci_045                -1.932293e-03 3 1  ON 44
ci_046                 5.507297e-03 3 1  ON 45
ci_047                 5.476244e-03 3 1  ON 46
ci_048                -1.205990e-02 3 1  ON 47
ci_049                -1.215544e-02 3 1  ON 48
ci_050                 7.414104e-03 3 1  ON 49
ci_051                 7.488098e-03 3 1  ON 50
ci_052                -6.506378e-03 3 1  ON 51
ci_053                -6.680943e-03 3 1  ON 52
ci_054                -2.938268e-03 3 1  ON 53
ci_055                -2.852409e-03 3 1  ON 54
ci_056                 4.448335e-03 3 1  ON 55
ci_057                 4.433743e-03 3 1  ON 56
ci_058                -6.888924e-03 3 1  ON 57
ci_059                -6.783045e-03 3 1  ON 58
ci_060                 8.751298e-03 3 1  ON 59
ci_061                 8.219841e-03 3 1  ON 60
ci_062                -3.150800e-03 3 1  ON 61
ci_063                -3.055874e-03 3 1  ON 62
ci_064                -2.937842e-03 3 1  ON 63
ci_065                -4.377210e-03 3 1  ON 64
ci_066                 5.646991e-03 3 1  ON 65
ci_067                 5.613054e-03 3 1  ON 66
ci_068                -4.810467e-03 3 1  ON 67
ci_069                -5.165592e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7289e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2762
    reference variance = 0.384821
====================================================
  Execution time = 2.7320e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0576e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1144e-01
  Total weights = 3.913327068e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9720e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298288642099
                                         uncertainty =       0.001413575810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298288642099
                                         uncertainty =       0.001413575810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273079726
  error estimate for blocks of size 2^( 2) =       0.000280286306
  error estimate for blocks of size 2^( 3) =       0.000286606633
  error estimate for blocks of size 2^( 4) =       0.000291500603
  error estimate for blocks of size 2^( 5) =       0.000294070375
  error estimate for blocks of size 2^( 6) =       0.000296393784
  error estimate for blocks of size 2^( 7) =       0.000296635565
  error estimate for blocks of size 2^( 8) =       0.000297182371

      target function =                  N/A
              le_mean =     -17.216673673601
             les_mean =     296.725290009467
             stat err =       0.000296070524
             autocorr =       1.175469668512
              std dev =       0.546159451822
             le_variance =       0.298290146815


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721667367360e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216673673619       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216673691845       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216673691821       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216673691103       residual = 2.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+01 is 4.183610e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216673673619       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216673678184       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216673678180       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216673678000       residual = 2.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+02 is 1.047264e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216673673619       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216673674761       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216673674760       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216673674715       residual = 2.81e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+03 is 2.619012e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.353985 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2300e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -4.030588e-02 3 1  ON 0
ci_002                -3.033012e-02 3 1  ON 1
ci_003                -2.478608e-02 3 1  ON 2
ci_004                 2.146239e-02 3 1  ON 3
ci_005                 2.070153e-02 3 1  ON 4
ci_006                -1.872820e-02 3 1  ON 5
ci_007                -1.840328e-02 3 1  ON 6
ci_008                -1.783214e-02 3 1  ON 7
ci_009                -1.759044e-02 3 1  ON 8
ci_010                -1.748710e-02 3 1  ON 9
ci_011                -1.622279e-02 3 1  ON 10
ci_012                -1.602850e-02 3 1  ON 11
ci_013                -1.825239e-02 3 1  ON 12
ci_014                 1.327573e-02 3 1  ON 13
ci_015                 1.384366e-02 3 1  ON 14
ci_016                 1.631413e-02 3 1  ON 15
ci_017                 1.677400e-02 3 1  ON 16
ci_018                 1.296616e-02 3 1  ON 17
ci_019                 1.263377e-02 3 1  ON 18
ci_020                 1.333267e-02 3 1  ON 19
ci_021                 1.320728e-02 3 1  ON 20
ci_022                 1.135452e-02 3 1  ON 21
ci_023                 1.135868e-02 3 1  ON 22
ci_024                 1.165261e-02 3 1  ON 23
ci_025                 1.179860e-02 3 1  ON 24
ci_026                 1.142248e-02 3 1  ON 25
ci_027                 1.144108e-02 3 1  ON 26
ci_028                -1.449867e-02 3 1  ON 27
ci_029                -1.410589e-02 3 1  ON 28
ci_030                -1.085309e-02 3 1  ON 29
ci_031                -1.109405e-02 3 1  ON 30
ci_032                -1.367159e-02 3 1  ON 31
ci_033                 1.027278e-02 3 1  ON 32
ci_034                 9.852924e-03 3 1  ON 33
ci_035                -4.596016e-03 3 1  ON 34
ci_036                -9.929573e-03 3 1  ON 35
ci_037                -9.960015e-03 3 1  ON 36
ci_038                 1.658817e-03 3 1  ON 37
ci_039                 1.581451e-03 3 1  ON 38
ci_040                -4.176786e-03 3 1  ON 39
ci_041                 9.803085e-03 3 1  ON 40
ci_042                 9.866880e-03 3 1  ON 41
ci_043                -3.175649e-03 3 1  ON 42
ci_044                -1.473112e-02 3 1  ON 43
ci_045                -1.932359e-03 3 1  ON 44
ci_046                 5.507351e-03 3 1  ON 45
ci_047                 5.476571e-03 3 1  ON 46
ci_048                -1.205962e-02 3 1  ON 47
ci_049                -1.215529e-02 3 1  ON 48
ci_050                 7.414019e-03 3 1  ON 49
ci_051                 7.488586e-03 3 1  ON 50
ci_052                -6.506471e-03 3 1  ON 51
ci_053                -6.680862e-03 3 1  ON 52
ci_054                -2.938391e-03 3 1  ON 53
ci_055                -2.852578e-03 3 1  ON 54
ci_056                 4.448351e-03 3 1  ON 55
ci_057                 4.433838e-03 3 1  ON 56
ci_058                -6.888912e-03 3 1  ON 57
ci_059                -6.782893e-03 3 1  ON 58
ci_060                 8.750720e-03 3 1  ON 59
ci_061                 8.219824e-03 3 1  ON 60
ci_062                -3.151012e-03 3 1  ON 61
ci_063                -3.055554e-03 3 1  ON 62
ci_064                -2.938045e-03 3 1  ON 63
ci_065                -4.376980e-03 3 1  ON 64
ci_066                 5.646596e-03 3 1  ON 65
ci_067                 5.613333e-03 3 1  ON 66
ci_068                -4.810489e-03 3 1  ON 67
ci_069                -5.165432e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1902
    reference variance = 0.174029
====================================================
  Execution time = 2.7377e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1251e-01
  Total weights = 3.9134e+06
  Execution time = 3.9180e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299717723937
                                         uncertainty =       0.001430574636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299717723937
                                         uncertainty =       0.001430574636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273728929
  error estimate for blocks of size 2^( 2) =       0.000280909642
  error estimate for blocks of size 2^( 3) =       0.000287336277
  error estimate for blocks of size 2^( 4) =       0.000292264851
  error estimate for blocks of size 2^( 5) =       0.000295153127
  error estimate for blocks of size 2^( 6) =       0.000297185014
  error estimate for blocks of size 2^( 7) =       0.000297223456
  error estimate for blocks of size 2^( 8) =       0.000296864659

      target function =                  N/A
              le_mean =     -17.216249980222
             les_mean =     296.711770622722
             stat err =       0.000296606564
             autocorr =       1.174140637942
              std dev =       0.547457857859
             le_variance =       0.299710106132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299717851860
                                         uncertainty =       0.001430513053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299717851860
                                         uncertainty =       0.001430513053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273728985
  error estimate for blocks of size 2^( 2) =       0.000280909679
  error estimate for blocks of size 2^( 3) =       0.000287336274
  error estimate for blocks of size 2^( 4) =       0.000292264822
  error estimate for blocks of size 2^( 5) =       0.000295153113
  error estimate for blocks of size 2^( 6) =       0.000297184935
  error estimate for blocks of size 2^( 7) =       0.000297223369
  error estimate for blocks of size 2^( 8) =       0.000296864729

      target function =                  N/A
              le_mean =     -17.216249983790
             les_mean =     296.711769485830
             stat err =       0.000296606537
             autocorr =       1.174139943365
              std dev =       0.547457969348
             le_variance =       0.299710228202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299717787524
                                         uncertainty =       0.001430543761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299717787524
                                         uncertainty =       0.001430543761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273728957
  error estimate for blocks of size 2^( 2) =       0.000280909660
  error estimate for blocks of size 2^( 3) =       0.000287336275
  error estimate for blocks of size 2^( 4) =       0.000292264837
  error estimate for blocks of size 2^( 5) =       0.000295153120
  error estimate for blocks of size 2^( 6) =       0.000297184974
  error estimate for blocks of size 2^( 7) =       0.000297223413
  error estimate for blocks of size 2^( 8) =       0.000296864694

      target function =                  N/A
              le_mean =     -17.216249981958
             les_mean =     296.711769969938
             stat err =       0.000296606550
             autocorr =       1.174140290251
              std dev =       0.547457913254
             le_variance =       0.299710166785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299717731838
                                         uncertainty =       0.001430570773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299717731838
                                         uncertainty =       0.001430570773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273728932
  error estimate for blocks of size 2^( 2) =       0.000280909644
  error estimate for blocks of size 2^( 3) =       0.000287336277
  error estimate for blocks of size 2^( 4) =       0.000292264849
  error estimate for blocks of size 2^( 5) =       0.000295153126
  error estimate for blocks of size 2^( 6) =       0.000297185009
  error estimate for blocks of size 2^( 7) =       0.000297223451
  error estimate for blocks of size 2^( 8) =       0.000296864663

      target function =                  N/A
              le_mean =     -17.216249980433
             les_mean =     296.711770531135
             stat err =       0.000296606562
             autocorr =       1.174140594515
              std dev =       0.547457864739
             le_variance =       0.299710113665


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216249980222        initial
     9.5367e+01     9.5367e+02             4.1836e-06       -17.216249983790  <--
     3.8147e+02     3.8147e+03             1.0473e-06       -17.216249981958
     1.5259e+03     1.5259e+04             2.6190e-07       -17.216249980433

*****************************************************************************
Applying the update for shift_i =   9.5367e+01     and shift_s =   9.5367e+02
*****************************************************************************

  Execution time = 4.6495e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -4.030583e-02 3 1  ON 0
ci_002                -3.033035e-02 3 1  ON 1
ci_003                -2.478635e-02 3 1  ON 2
ci_004                 2.146160e-02 3 1  ON 3
ci_005                 2.070223e-02 3 1  ON 4
ci_006                -1.872846e-02 3 1  ON 5
ci_007                -1.840456e-02 3 1  ON 6
ci_008                -1.783214e-02 3 1  ON 7
ci_009                -1.758982e-02 3 1  ON 8
ci_010                -1.748720e-02 3 1  ON 9
ci_011                -1.622328e-02 3 1  ON 10
ci_012                -1.602928e-02 3 1  ON 11
ci_013                -1.825552e-02 3 1  ON 12
ci_014                 1.327659e-02 3 1  ON 13
ci_015                 1.384445e-02 3 1  ON 14
ci_016                 1.631380e-02 3 1  ON 15
ci_017                 1.677450e-02 3 1  ON 16
ci_018                 1.296506e-02 3 1  ON 17
ci_019                 1.263418e-02 3 1  ON 18
ci_020                 1.333163e-02 3 1  ON 19
ci_021                 1.320794e-02 3 1  ON 20
ci_022                 1.135443e-02 3 1  ON 21
ci_023                 1.135989e-02 3 1  ON 22
ci_024                 1.165389e-02 3 1  ON 23
ci_025                 1.179726e-02 3 1  ON 24
ci_026                 1.142264e-02 3 1  ON 25
ci_027                 1.144166e-02 3 1  ON 26
ci_028                -1.449894e-02 3 1  ON 27
ci_029                -1.410691e-02 3 1  ON 28
ci_030                -1.085409e-02 3 1  ON 29
ci_031                -1.109293e-02 3 1  ON 30
ci_032                -1.367309e-02 3 1  ON 31
ci_033                 1.027216e-02 3 1  ON 32
ci_034                 9.853734e-03 3 1  ON 33
ci_035                -4.597373e-03 3 1  ON 34
ci_036                -9.930599e-03 3 1  ON 35
ci_037                -9.961340e-03 3 1  ON 36
ci_038                 1.658066e-03 3 1  ON 37
ci_039                 1.581412e-03 3 1  ON 38
ci_040                -4.176102e-03 3 1  ON 39
ci_041                 9.803522e-03 3 1  ON 40
ci_042                 9.866810e-03 3 1  ON 41
ci_043                -3.175459e-03 3 1  ON 42
ci_044                -1.473275e-02 3 1  ON 43
ci_045                -1.932557e-03 3 1  ON 44
ci_046                 5.507515e-03 3 1  ON 45
ci_047                 5.477547e-03 3 1  ON 46
ci_048                -1.205879e-02 3 1  ON 47
ci_049                -1.215482e-02 3 1  ON 48
ci_050                 7.413764e-03 3 1  ON 49
ci_051                 7.490045e-03 3 1  ON 50
ci_052                -6.506752e-03 3 1  ON 51
ci_053                -6.680620e-03 3 1  ON 52
ci_054                -2.938758e-03 3 1  ON 53
ci_055                -2.853083e-03 3 1  ON 54
ci_056                 4.448398e-03 3 1  ON 55
ci_057                 4.434121e-03 3 1  ON 56
ci_058                -6.888877e-03 3 1  ON 57
ci_059                -6.782439e-03 3 1  ON 58
ci_060                 8.748988e-03 3 1  ON 59
ci_061                 8.219776e-03 3 1  ON 60
ci_062                -3.151647e-03 3 1  ON 61
ci_063                -3.054596e-03 3 1  ON 62
ci_064                -2.938652e-03 3 1  ON 63
ci_065                -4.376296e-03 3 1  ON 64
ci_066                 5.645414e-03 3 1  ON 65
ci_067                 5.614165e-03 3 1  ON 66
ci_068                -4.810555e-03 3 1  ON 67
ci_069                -5.164955e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8803e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2004
    reference variance = 0.217378
====================================================
  Execution time = 2.7093e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0515e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1405e-01
  Total weights = 3.913393059e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9090e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298987326706
                                         uncertainty =       0.001246294276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298987326706
                                         uncertainty =       0.001246294276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273483997
  error estimate for blocks of size 2^( 2) =       0.000280467288
  error estimate for blocks of size 2^( 3) =       0.000287001474
  error estimate for blocks of size 2^( 4) =       0.000291907118
  error estimate for blocks of size 2^( 5) =       0.000295260087
  error estimate for blocks of size 2^( 6) =       0.000296823762
  error estimate for blocks of size 2^( 7) =       0.000297371049
  error estimate for blocks of size 2^( 8) =       0.000295562683

      target function =                  N/A
              le_mean =     -17.216032972470
             les_mean =     296.705838483591
             stat err =       0.000296254395
             autocorr =       1.173453178718
              std dev =       0.546967994947
             le_variance =       0.299173987496


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721603297247e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216032972491       residual = 7.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216032945231       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216032940710       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 1.177503e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216032972491       residual = 7.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216032965624       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216032964408       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+01 is 2.964401e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216032972491       residual = 7.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216032970771       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216032970461       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+02 is 7.424029e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.355045 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2009e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -4.030701e-02 3 1  ON 0
ci_002                -3.032979e-02 3 1  ON 1
ci_003                -2.478696e-02 3 1  ON 2
ci_004                 2.146138e-02 3 1  ON 3
ci_005                 2.070208e-02 3 1  ON 4
ci_006                -1.872836e-02 3 1  ON 5
ci_007                -1.840421e-02 3 1  ON 6
ci_008                -1.783249e-02 3 1  ON 7
ci_009                -1.759005e-02 3 1  ON 8
ci_010                -1.748713e-02 3 1  ON 9
ci_011                -1.622326e-02 3 1  ON 10
ci_012                -1.602876e-02 3 1  ON 11
ci_013                -1.825752e-02 3 1  ON 12
ci_014                 1.327945e-02 3 1  ON 13
ci_015                 1.384326e-02 3 1  ON 14
ci_016                 1.631532e-02 3 1  ON 15
ci_017                 1.677318e-02 3 1  ON 16
ci_018                 1.296564e-02 3 1  ON 17
ci_019                 1.263495e-02 3 1  ON 18
ci_020                 1.333121e-02 3 1  ON 19
ci_021                 1.320707e-02 3 1  ON 20
ci_022                 1.135664e-02 3 1  ON 21
ci_023                 1.136026e-02 3 1  ON 22
ci_024                 1.165460e-02 3 1  ON 23
ci_025                 1.179637e-02 3 1  ON 24
ci_026                 1.141967e-02 3 1  ON 25
ci_027                 1.144104e-02 3 1  ON 26
ci_028                -1.449874e-02 3 1  ON 27
ci_029                -1.410665e-02 3 1  ON 28
ci_030                -1.085586e-02 3 1  ON 29
ci_031                -1.109307e-02 3 1  ON 30
ci_032                -1.367304e-02 3 1  ON 31
ci_033                 1.027140e-02 3 1  ON 32
ci_034                 9.854059e-03 3 1  ON 33
ci_035                -4.597538e-03 3 1  ON 34
ci_036                -9.931850e-03 3 1  ON 35
ci_037                -9.962675e-03 3 1  ON 36
ci_038                 1.658989e-03 3 1  ON 37
ci_039                 1.581146e-03 3 1  ON 38
ci_040                -4.175796e-03 3 1  ON 39
ci_041                 9.802432e-03 3 1  ON 40
ci_042                 9.866503e-03 3 1  ON 41
ci_043                -3.175212e-03 3 1  ON 42
ci_044                -1.473276e-02 3 1  ON 43
ci_045                -1.931870e-03 3 1  ON 44
ci_046                 5.506724e-03 3 1  ON 45
ci_047                 5.477095e-03 3 1  ON 46
ci_048                -1.205817e-02 3 1  ON 47
ci_049                -1.215351e-02 3 1  ON 48
ci_050                 7.414256e-03 3 1  ON 49
ci_051                 7.489991e-03 3 1  ON 50
ci_052                -6.507926e-03 3 1  ON 51
ci_053                -6.680062e-03 3 1  ON 52
ci_054                -2.938847e-03 3 1  ON 53
ci_055                -2.854219e-03 3 1  ON 54
ci_056                 4.446991e-03 3 1  ON 55
ci_057                 4.434493e-03 3 1  ON 56
ci_058                -6.886564e-03 3 1  ON 57
ci_059                -6.782681e-03 3 1  ON 58
ci_060                 8.746759e-03 3 1  ON 59
ci_061                 8.219202e-03 3 1  ON 60
ci_062                -3.151597e-03 3 1  ON 61
ci_063                -3.054987e-03 3 1  ON 62
ci_064                -2.939740e-03 3 1  ON 63
ci_065                -4.374993e-03 3 1  ON 64
ci_066                 5.647514e-03 3 1  ON 65
ci_067                 5.613311e-03 3 1  ON 66
ci_068                -4.811606e-03 3 1  ON 67
ci_069                -5.164532e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2306
    reference variance = 0.993213
====================================================
  Execution time = 2.6868e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0890e-01
  Total weights = 3.9138e+06
  Execution time = 3.6378e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0465265
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296518591180
                                         uncertainty =       0.001483627904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296518591180
                                         uncertainty =       0.001483627904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272271877
  error estimate for blocks of size 2^( 2) =       0.000279354695
  error estimate for blocks of size 2^( 3) =       0.000285811317
  error estimate for blocks of size 2^( 4) =       0.000290373576
  error estimate for blocks of size 2^( 5) =       0.000293459096
  error estimate for blocks of size 2^( 6) =       0.000294749290
  error estimate for blocks of size 2^( 7) =       0.000296166357
  error estimate for blocks of size 2^( 8) =       0.000296774698

      target function =                  N/A
              le_mean =     -17.216191547630
             les_mean =     296.706193428753
             stat err =       0.000295287360
             autocorr =       1.176208046777
              std dev =       0.544543753155
             le_variance =       0.296527899100

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000851223
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296519184558
                                         uncertainty =       0.001483598775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296519184558
                                         uncertainty =       0.001483598775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272272148
  error estimate for blocks of size 2^( 2) =       0.000279355007
  error estimate for blocks of size 2^( 3) =       0.000285811642
  error estimate for blocks of size 2^( 4) =       0.000290373841
  error estimate for blocks of size 2^( 5) =       0.000293459253
  error estimate for blocks of size 2^( 6) =       0.000294749514
  error estimate for blocks of size 2^( 7) =       0.000296166771
  error estimate for blocks of size 2^( 8) =       0.000296775190

      target function =                  N/A
              le_mean =     -17.216191404690
             les_mean =     296.706102073837
             stat err =       0.000295287682
             autocorr =       1.176208264530
              std dev =       0.544544295562
             le_variance =       0.296528489829

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0454391
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296518885134
                                         uncertainty =       0.001483613194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296518885134
                                         uncertainty =       0.001483613194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272272011
  error estimate for blocks of size 2^( 2) =       0.000279354850
  error estimate for blocks of size 2^( 3) =       0.000285811478
  error estimate for blocks of size 2^( 4) =       0.000290373707
  error estimate for blocks of size 2^( 5) =       0.000293459173
  error estimate for blocks of size 2^( 6) =       0.000294749401
  error estimate for blocks of size 2^( 7) =       0.000296166563
  error estimate for blocks of size 2^( 8) =       0.000296774943

      target function =                  N/A
              le_mean =     -17.216191474418
             les_mean =     296.706131902096
             stat err =       0.000295287520
             autocorr =       1.176208155506
              std dev =       0.544544021851
             le_variance =       0.296528191734

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.144441
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296518627348
                                         uncertainty =       0.001483626055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296518627348
                                         uncertainty =       0.001483626055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272271893
  error estimate for blocks of size 2^( 2) =       0.000279354714
  error estimate for blocks of size 2^( 3) =       0.000285811337
  error estimate for blocks of size 2^( 4) =       0.000290373592
  error estimate for blocks of size 2^( 5) =       0.000293459106
  error estimate for blocks of size 2^( 6) =       0.000294749304
  error estimate for blocks of size 2^( 7) =       0.000296166383
  error estimate for blocks of size 2^( 8) =       0.000296774729

      target function =                  N/A
              le_mean =     -17.216191538324
             les_mean =     296.706178620775
             stat err =       0.000295287380
             autocorr =       1.176208061767
              std dev =       0.544543786213
             le_variance =       0.296527935103


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216191547630        initial  <--
     2.3842e+01     2.3842e+02             1.1775e-05       -17.216191404690
     9.5367e+01     9.5367e+02             2.9644e-06       -17.216191474418
     3.8147e+02     3.8147e+03             7.4240e-07       -17.216191538324

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.2195
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -4.030583e-02 3 1  ON 0
ci_002                -3.033035e-02 3 1  ON 1
ci_003                -2.478635e-02 3 1  ON 2
ci_004                 2.146160e-02 3 1  ON 3
ci_005                 2.070223e-02 3 1  ON 4
ci_006                -1.872846e-02 3 1  ON 5
ci_007                -1.840456e-02 3 1  ON 6
ci_008                -1.783214e-02 3 1  ON 7
ci_009                -1.758982e-02 3 1  ON 8
ci_010                -1.748720e-02 3 1  ON 9
ci_011                -1.622328e-02 3 1  ON 10
ci_012                -1.602928e-02 3 1  ON 11
ci_013                -1.825552e-02 3 1  ON 12
ci_014                 1.327659e-02 3 1  ON 13
ci_015                 1.384445e-02 3 1  ON 14
ci_016                 1.631380e-02 3 1  ON 15
ci_017                 1.677450e-02 3 1  ON 16
ci_018                 1.296506e-02 3 1  ON 17
ci_019                 1.263418e-02 3 1  ON 18
ci_020                 1.333163e-02 3 1  ON 19
ci_021                 1.320794e-02 3 1  ON 20
ci_022                 1.135443e-02 3 1  ON 21
ci_023                 1.135989e-02 3 1  ON 22
ci_024                 1.165389e-02 3 1  ON 23
ci_025                 1.179726e-02 3 1  ON 24
ci_026                 1.142264e-02 3 1  ON 25
ci_027                 1.144166e-02 3 1  ON 26
ci_028                -1.449894e-02 3 1  ON 27
ci_029                -1.410691e-02 3 1  ON 28
ci_030                -1.085409e-02 3 1  ON 29
ci_031                -1.109293e-02 3 1  ON 30
ci_032                -1.367309e-02 3 1  ON 31
ci_033                 1.027216e-02 3 1  ON 32
ci_034                 9.853734e-03 3 1  ON 33
ci_035                -4.597373e-03 3 1  ON 34
ci_036                -9.930599e-03 3 1  ON 35
ci_037                -9.961340e-03 3 1  ON 36
ci_038                 1.658066e-03 3 1  ON 37
ci_039                 1.581412e-03 3 1  ON 38
ci_040                -4.176102e-03 3 1  ON 39
ci_041                 9.803522e-03 3 1  ON 40
ci_042                 9.866810e-03 3 1  ON 41
ci_043                -3.175459e-03 3 1  ON 42
ci_044                -1.473275e-02 3 1  ON 43
ci_045                -1.932557e-03 3 1  ON 44
ci_046                 5.507515e-03 3 1  ON 45
ci_047                 5.477547e-03 3 1  ON 46
ci_048                -1.205879e-02 3 1  ON 47
ci_049                -1.215482e-02 3 1  ON 48
ci_050                 7.413764e-03 3 1  ON 49
ci_051                 7.490045e-03 3 1  ON 50
ci_052                -6.506752e-03 3 1  ON 51
ci_053                -6.680620e-03 3 1  ON 52
ci_054                -2.938758e-03 3 1  ON 53
ci_055                -2.853083e-03 3 1  ON 54
ci_056                 4.448398e-03 3 1  ON 55
ci_057                 4.434121e-03 3 1  ON 56
ci_058                -6.888877e-03 3 1  ON 57
ci_059                -6.782439e-03 3 1  ON 58
ci_060                 8.748988e-03 3 1  ON 59
ci_061                 8.219776e-03 3 1  ON 60
ci_062                -3.151647e-03 3 1  ON 61
ci_063                -3.054596e-03 3 1  ON 62
ci_064                -2.938652e-03 3 1  ON 63
ci_065                -4.376296e-03 3 1  ON 64
ci_066                 5.645414e-03 3 1  ON 65
ci_067                 5.614165e-03 3 1  ON 66
ci_068                -4.810555e-03 3 1  ON 67
ci_069                -5.164955e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7241e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.0955
    reference variance = 1.83753
====================================================
  Execution time = 2.7210e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0544e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1896e-01
  Total weights = 3.913156914e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9269e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302440866122
                                         uncertainty =       0.001640612010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302440866122
                                         uncertainty =       0.001640612010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275000317
  error estimate for blocks of size 2^( 2) =       0.000282132783
  error estimate for blocks of size 2^( 3) =       0.000288448191
  error estimate for blocks of size 2^( 4) =       0.000293082105
  error estimate for blocks of size 2^( 5) =       0.000296130725
  error estimate for blocks of size 2^( 6) =       0.000297911704
  error estimate for blocks of size 2^( 7) =       0.000297885462
  error estimate for blocks of size 2^( 8) =       0.000298301676

      target function =                  N/A
              le_mean =     -17.216840778084
             les_mean =     296.738562058212
             stat err =       0.000297557392
             autocorr =       1.170779466904
              std dev =       0.550000634109
             le_variance =       0.302500697521


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721684077808e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216840778111       residual = 7.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216840791595       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216840791530       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+02 is 9.537898e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216840778111       residual = 7.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216840781485       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216840781468       residual = 7.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+02 is 2.386155e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216840778111       residual = 7.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216840778955       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216840778950       residual = 7.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+03 is 5.966440e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.358972 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2150e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -4.030593e-02 3 1  ON 0
ci_002                -3.033013e-02 3 1  ON 1
ci_003                -2.478651e-02 3 1  ON 2
ci_004                 2.146144e-02 3 1  ON 3
ci_005                 2.070229e-02 3 1  ON 4
ci_006                -1.872862e-02 3 1  ON 5
ci_007                -1.840464e-02 3 1  ON 6
ci_008                -1.783213e-02 3 1  ON 7
ci_009                -1.758983e-02 3 1  ON 8
ci_010                -1.748727e-02 3 1  ON 9
ci_011                -1.622320e-02 3 1  ON 10
ci_012                -1.602940e-02 3 1  ON 11
ci_013                -1.825576e-02 3 1  ON 12
ci_014                 1.327680e-02 3 1  ON 13
ci_015                 1.384449e-02 3 1  ON 14
ci_016                 1.631376e-02 3 1  ON 15
ci_017                 1.677456e-02 3 1  ON 16
ci_018                 1.296521e-02 3 1  ON 17
ci_019                 1.263416e-02 3 1  ON 18
ci_020                 1.333160e-02 3 1  ON 19
ci_021                 1.320799e-02 3 1  ON 20
ci_022                 1.135439e-02 3 1  ON 21
ci_023                 1.135995e-02 3 1  ON 22
ci_024                 1.165379e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142245e-02 3 1  ON 25
ci_027                 1.144162e-02 3 1  ON 26
ci_028                -1.449897e-02 3 1  ON 27
ci_029                -1.410711e-02 3 1  ON 28
ci_030                -1.085432e-02 3 1  ON 29
ci_031                -1.109289e-02 3 1  ON 30
ci_032                -1.367308e-02 3 1  ON 31
ci_033                 1.027202e-02 3 1  ON 32
ci_034                 9.853814e-03 3 1  ON 33
ci_035                -4.597327e-03 3 1  ON 34
ci_036                -9.930665e-03 3 1  ON 35
ci_037                -9.961367e-03 3 1  ON 36
ci_038                 1.658024e-03 3 1  ON 37
ci_039                 1.581407e-03 3 1  ON 38
ci_040                -4.175880e-03 3 1  ON 39
ci_041                 9.803530e-03 3 1  ON 40
ci_042                 9.866674e-03 3 1  ON 41
ci_043                -3.175445e-03 3 1  ON 42
ci_044                -1.473261e-02 3 1  ON 43
ci_045                -1.932516e-03 3 1  ON 44
ci_046                 5.507564e-03 3 1  ON 45
ci_047                 5.477575e-03 3 1  ON 46
ci_048                -1.205880e-02 3 1  ON 47
ci_049                -1.215493e-02 3 1  ON 48
ci_050                 7.413792e-03 3 1  ON 49
ci_051                 7.490007e-03 3 1  ON 50
ci_052                -6.506764e-03 3 1  ON 51
ci_053                -6.680598e-03 3 1  ON 52
ci_054                -2.938837e-03 3 1  ON 53
ci_055                -2.853167e-03 3 1  ON 54
ci_056                 4.448545e-03 3 1  ON 55
ci_057                 4.434256e-03 3 1  ON 56
ci_058                -6.888855e-03 3 1  ON 57
ci_059                -6.782401e-03 3 1  ON 58
ci_060                 8.748803e-03 3 1  ON 59
ci_061                 8.219899e-03 3 1  ON 60
ci_062                -3.151545e-03 3 1  ON 61
ci_063                -3.054657e-03 3 1  ON 62
ci_064                -2.938882e-03 3 1  ON 63
ci_065                -4.376135e-03 3 1  ON 64
ci_066                 5.645398e-03 3 1  ON 65
ci_067                 5.614181e-03 3 1  ON 66
ci_068                -4.810470e-03 3 1  ON 67
ci_069                -5.164912e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.4588
    reference variance = 3.09748
====================================================
  Execution time = 2.6718e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1401e-01
  Total weights = 3.9129e+06
  Execution time = 3.6203e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299957194000
                                         uncertainty =       0.001566314064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299957194000
                                         uncertainty =       0.001566314064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273859237
  error estimate for blocks of size 2^( 2) =       0.000280761179
  error estimate for blocks of size 2^( 3) =       0.000287131923
  error estimate for blocks of size 2^( 4) =       0.000291840664
  error estimate for blocks of size 2^( 5) =       0.000294932492
  error estimate for blocks of size 2^( 6) =       0.000297476774
  error estimate for blocks of size 2^( 7) =       0.000297710093
  error estimate for blocks of size 2^( 8) =       0.000298820309

      target function =                  N/A
              le_mean =     -17.217102213522
             les_mean =     296.742615466996
             stat err =       0.000297234917
             autocorr =       1.177998845202
              std dev =       0.547718473427
             le_variance =       0.299995526134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299956923305
                                         uncertainty =       0.001566324881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299956923305
                                         uncertainty =       0.001566324881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273859116
  error estimate for blocks of size 2^( 2) =       0.000280761055
  error estimate for blocks of size 2^( 3) =       0.000287131792
  error estimate for blocks of size 2^( 4) =       0.000291840528
  error estimate for blocks of size 2^( 5) =       0.000294932369
  error estimate for blocks of size 2^( 6) =       0.000297476656
  error estimate for blocks of size 2^( 7) =       0.000297709972
  error estimate for blocks of size 2^( 8) =       0.000298820198

      target function =                  N/A
              le_mean =     -17.217102206131
             les_mean =     296.742618139296
             stat err =       0.000297234799
             autocorr =       1.177998947370
              std dev =       0.547718231464
             le_variance =       0.299995261078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299957058455
                                         uncertainty =       0.001566319477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299957058455
                                         uncertainty =       0.001566319477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273859176
  error estimate for blocks of size 2^( 2) =       0.000280761117
  error estimate for blocks of size 2^( 3) =       0.000287131857
  error estimate for blocks of size 2^( 4) =       0.000291840596
  error estimate for blocks of size 2^( 5) =       0.000294932430
  error estimate for blocks of size 2^( 6) =       0.000297476714
  error estimate for blocks of size 2^( 7) =       0.000297710032
  error estimate for blocks of size 2^( 8) =       0.000298820254

      target function =                  N/A
              le_mean =     -17.217102209815
             les_mean =     296.742616743385
             stat err =       0.000297234858
             autocorr =       1.177998896286
              std dev =       0.547718352267
             le_variance =       0.299995393410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299957177045
                                         uncertainty =       0.001566314741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299957177045
                                         uncertainty =       0.001566314741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273859229
  error estimate for blocks of size 2^( 2) =       0.000280761171
  error estimate for blocks of size 2^( 3) =       0.000287131915
  error estimate for blocks of size 2^( 4) =       0.000291840656
  error estimate for blocks of size 2^( 5) =       0.000294932484
  error estimate for blocks of size 2^( 6) =       0.000297476766
  error estimate for blocks of size 2^( 7) =       0.000297710086
  error estimate for blocks of size 2^( 8) =       0.000298820302

      target function =                  N/A
              le_mean =     -17.217102213057
             les_mean =     296.742615619586
             stat err =       0.000297234910
             autocorr =       1.177998851578
              std dev =       0.547718458272
             le_variance =       0.299995509532


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217102213522        initial  <--
     2.3842e+02     2.3842e+03             9.5379e-07       -17.217102206131
     9.5367e+02     9.5367e+03             2.3862e-07       -17.217102209815
     3.8147e+03     3.8147e+04             5.9664e-08       -17.217102213057

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0136
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -4.030583e-02 3 1  ON 0
ci_002                -3.033035e-02 3 1  ON 1
ci_003                -2.478635e-02 3 1  ON 2
ci_004                 2.146160e-02 3 1  ON 3
ci_005                 2.070223e-02 3 1  ON 4
ci_006                -1.872846e-02 3 1  ON 5
ci_007                -1.840456e-02 3 1  ON 6
ci_008                -1.783214e-02 3 1  ON 7
ci_009                -1.758982e-02 3 1  ON 8
ci_010                -1.748720e-02 3 1  ON 9
ci_011                -1.622328e-02 3 1  ON 10
ci_012                -1.602928e-02 3 1  ON 11
ci_013                -1.825552e-02 3 1  ON 12
ci_014                 1.327659e-02 3 1  ON 13
ci_015                 1.384445e-02 3 1  ON 14
ci_016                 1.631380e-02 3 1  ON 15
ci_017                 1.677450e-02 3 1  ON 16
ci_018                 1.296506e-02 3 1  ON 17
ci_019                 1.263418e-02 3 1  ON 18
ci_020                 1.333163e-02 3 1  ON 19
ci_021                 1.320794e-02 3 1  ON 20
ci_022                 1.135443e-02 3 1  ON 21
ci_023                 1.135989e-02 3 1  ON 22
ci_024                 1.165389e-02 3 1  ON 23
ci_025                 1.179726e-02 3 1  ON 24
ci_026                 1.142264e-02 3 1  ON 25
ci_027                 1.144166e-02 3 1  ON 26
ci_028                -1.449894e-02 3 1  ON 27
ci_029                -1.410691e-02 3 1  ON 28
ci_030                -1.085409e-02 3 1  ON 29
ci_031                -1.109293e-02 3 1  ON 30
ci_032                -1.367309e-02 3 1  ON 31
ci_033                 1.027216e-02 3 1  ON 32
ci_034                 9.853734e-03 3 1  ON 33
ci_035                -4.597373e-03 3 1  ON 34
ci_036                -9.930599e-03 3 1  ON 35
ci_037                -9.961340e-03 3 1  ON 36
ci_038                 1.658066e-03 3 1  ON 37
ci_039                 1.581412e-03 3 1  ON 38
ci_040                -4.176102e-03 3 1  ON 39
ci_041                 9.803522e-03 3 1  ON 40
ci_042                 9.866810e-03 3 1  ON 41
ci_043                -3.175459e-03 3 1  ON 42
ci_044                -1.473275e-02 3 1  ON 43
ci_045                -1.932557e-03 3 1  ON 44
ci_046                 5.507515e-03 3 1  ON 45
ci_047                 5.477547e-03 3 1  ON 46
ci_048                -1.205879e-02 3 1  ON 47
ci_049                -1.215482e-02 3 1  ON 48
ci_050                 7.413764e-03 3 1  ON 49
ci_051                 7.490045e-03 3 1  ON 50
ci_052                -6.506752e-03 3 1  ON 51
ci_053                -6.680620e-03 3 1  ON 52
ci_054                -2.938758e-03 3 1  ON 53
ci_055                -2.853083e-03 3 1  ON 54
ci_056                 4.448398e-03 3 1  ON 55
ci_057                 4.434121e-03 3 1  ON 56
ci_058                -6.888877e-03 3 1  ON 57
ci_059                -6.782439e-03 3 1  ON 58
ci_060                 8.748988e-03 3 1  ON 59
ci_061                 8.219776e-03 3 1  ON 60
ci_062                -3.151647e-03 3 1  ON 61
ci_063                -3.054596e-03 3 1  ON 62
ci_064                -2.938652e-03 3 1  ON 63
ci_065                -4.376296e-03 3 1  ON 64
ci_066                 5.645414e-03 3 1  ON 65
ci_067                 5.614165e-03 3 1  ON 66
ci_068                -4.810555e-03 3 1  ON 67
ci_069                -5.164955e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7181e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2839
    reference variance = 0.30267
====================================================
  Execution time = 2.7067e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0561e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1516e-01
  Total weights = 3.913494678e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9931e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301218256908
                                         uncertainty =       0.001526937921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301218256908
                                         uncertainty =       0.001526937921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274385686
  error estimate for blocks of size 2^( 2) =       0.000281686238
  error estimate for blocks of size 2^( 3) =       0.000287886538
  error estimate for blocks of size 2^( 4) =       0.000292963773
  error estimate for blocks of size 2^( 5) =       0.000295736798
  error estimate for blocks of size 2^( 6) =       0.000296807625
  error estimate for blocks of size 2^( 7) =       0.000297836638
  error estimate for blocks of size 2^( 8) =       0.000297615320

      target function =                  N/A
              le_mean =     -17.216423848775
             les_mean =     296.720413987833
             stat err =       0.000296999095
             autocorr =       1.171621545187
              std dev =       0.548771371612
             le_variance =       0.301150018301


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721642384878e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216423848798       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216423849243       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216423849184       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+03 is 1.243100e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216423848798       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216423848909       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216423848894       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+03 is 3.107921e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216423848798       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216423848826       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216423848822       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+04 is 7.769911e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.362845 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2075e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -4.030585e-02 3 1  ON 0
ci_002                -3.033035e-02 3 1  ON 1
ci_003                -2.478637e-02 3 1  ON 2
ci_004                 2.146158e-02 3 1  ON 3
ci_005                 2.070222e-02 3 1  ON 4
ci_006                -1.872847e-02 3 1  ON 5
ci_007                -1.840457e-02 3 1  ON 6
ci_008                -1.783214e-02 3 1  ON 7
ci_009                -1.758982e-02 3 1  ON 8
ci_010                -1.748720e-02 3 1  ON 9
ci_011                -1.622329e-02 3 1  ON 10
ci_012                -1.602929e-02 3 1  ON 11
ci_013                -1.825555e-02 3 1  ON 12
ci_014                 1.327660e-02 3 1  ON 13
ci_015                 1.384445e-02 3 1  ON 14
ci_016                 1.631380e-02 3 1  ON 15
ci_017                 1.677450e-02 3 1  ON 16
ci_018                 1.296506e-02 3 1  ON 17
ci_019                 1.263417e-02 3 1  ON 18
ci_020                 1.333163e-02 3 1  ON 19
ci_021                 1.320792e-02 3 1  ON 20
ci_022                 1.135444e-02 3 1  ON 21
ci_023                 1.135988e-02 3 1  ON 22
ci_024                 1.165387e-02 3 1  ON 23
ci_025                 1.179725e-02 3 1  ON 24
ci_026                 1.142263e-02 3 1  ON 25
ci_027                 1.144166e-02 3 1  ON 26
ci_028                -1.449893e-02 3 1  ON 27
ci_029                -1.410692e-02 3 1  ON 28
ci_030                -1.085410e-02 3 1  ON 29
ci_031                -1.109293e-02 3 1  ON 30
ci_032                -1.367309e-02 3 1  ON 31
ci_033                 1.027215e-02 3 1  ON 32
ci_034                 9.853754e-03 3 1  ON 33
ci_035                -4.597366e-03 3 1  ON 34
ci_036                -9.930618e-03 3 1  ON 35
ci_037                -9.961329e-03 3 1  ON 36
ci_038                 1.658067e-03 3 1  ON 37
ci_039                 1.581418e-03 3 1  ON 38
ci_040                -4.176095e-03 3 1  ON 39
ci_041                 9.803530e-03 3 1  ON 40
ci_042                 9.866811e-03 3 1  ON 41
ci_043                -3.175442e-03 3 1  ON 42
ci_044                -1.473275e-02 3 1  ON 43
ci_045                -1.932553e-03 3 1  ON 44
ci_046                 5.507513e-03 3 1  ON 45
ci_047                 5.477568e-03 3 1  ON 46
ci_048                -1.205878e-02 3 1  ON 47
ci_049                -1.215482e-02 3 1  ON 48
ci_050                 7.413755e-03 3 1  ON 49
ci_051                 7.490052e-03 3 1  ON 50
ci_052                -6.506749e-03 3 1  ON 51
ci_053                -6.680613e-03 3 1  ON 52
ci_054                -2.938772e-03 3 1  ON 53
ci_055                -2.853099e-03 3 1  ON 54
ci_056                 4.448402e-03 3 1  ON 55
ci_057                 4.434131e-03 3 1  ON 56
ci_058                -6.888880e-03 3 1  ON 57
ci_059                -6.782424e-03 3 1  ON 58
ci_060                 8.748993e-03 3 1  ON 59
ci_061                 8.219773e-03 3 1  ON 60
ci_062                -3.151644e-03 3 1  ON 61
ci_063                -3.054605e-03 3 1  ON 62
ci_064                -2.938645e-03 3 1  ON 63
ci_065                -4.376282e-03 3 1  ON 64
ci_066                 5.645403e-03 3 1  ON 65
ci_067                 5.614170e-03 3 1  ON 66
ci_068                -4.810565e-03 3 1  ON 67
ci_069                -5.164944e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2326
    reference variance = 0.199596
====================================================
  Execution time = 2.6784e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1527e-01
  Total weights = 3.9137e+06
  Execution time = 3.6357e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296856003917
                                         uncertainty =       0.001392480840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296856003917
                                         uncertainty =       0.001392480840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272438060
  error estimate for blocks of size 2^( 2) =       0.000279506114
  error estimate for blocks of size 2^( 3) =       0.000285895266
  error estimate for blocks of size 2^( 4) =       0.000291005017
  error estimate for blocks of size 2^( 5) =       0.000293941260
  error estimate for blocks of size 2^( 6) =       0.000294853103
  error estimate for blocks of size 2^( 7) =       0.000295552117
  error estimate for blocks of size 2^( 8) =       0.000296477160

      target function =                  N/A
              le_mean =     -17.216225117231
             les_mean =     296.713676577300
             stat err =       0.000295205910
             autocorr =       1.174125543727
              std dev =       0.544876120542
             le_variance =       0.296889986737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296855985191
                                         uncertainty =       0.001392480254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296855985191
                                         uncertainty =       0.001392480254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272438052
  error estimate for blocks of size 2^( 2) =       0.000279506106
  error estimate for blocks of size 2^( 3) =       0.000285895259
  error estimate for blocks of size 2^( 4) =       0.000291005010
  error estimate for blocks of size 2^( 5) =       0.000293941254
  error estimate for blocks of size 2^( 6) =       0.000294853099
  error estimate for blocks of size 2^( 7) =       0.000295552116
  error estimate for blocks of size 2^( 8) =       0.000296477159

      target function =                  N/A
              le_mean =     -17.216225118263
             les_mean =     296.713676710160
             stat err =       0.000295205907
             autocorr =       1.174125593201
              std dev =       0.544876103486
             le_variance =       0.296889968150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296855994552
                                         uncertainty =       0.001392480546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296855994552
                                         uncertainty =       0.001392480546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272438056
  error estimate for blocks of size 2^( 2) =       0.000279506110
  error estimate for blocks of size 2^( 3) =       0.000285895263
  error estimate for blocks of size 2^( 4) =       0.000291005014
  error estimate for blocks of size 2^( 5) =       0.000293941257
  error estimate for blocks of size 2^( 6) =       0.000294853101
  error estimate for blocks of size 2^( 7) =       0.000295552117
  error estimate for blocks of size 2^( 8) =       0.000296477159

      target function =                  N/A
              le_mean =     -17.216225117747
             les_mean =     296.713676643401
             stat err =       0.000295205908
             autocorr =       1.174125568482
              std dev =       0.544876112012
             le_variance =       0.296889977442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296856002746
                                         uncertainty =       0.001392480803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296856002746
                                         uncertainty =       0.001392480803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272438060
  error estimate for blocks of size 2^( 2) =       0.000279506113
  error estimate for blocks of size 2^( 3) =       0.000285895266
  error estimate for blocks of size 2^( 4) =       0.000291005017
  error estimate for blocks of size 2^( 5) =       0.000293941259
  error estimate for blocks of size 2^( 6) =       0.000294853103
  error estimate for blocks of size 2^( 7) =       0.000295552117
  error estimate for blocks of size 2^( 8) =       0.000296477160

      target function =                  N/A
              le_mean =     -17.216225117296
             les_mean =     296.713676585526
             stat err =       0.000295205910
             autocorr =       1.174125546829
              std dev =       0.544876119476
             le_variance =       0.296889985575


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216225117231        initial
     2.3842e+03     2.3842e+04             1.2431e-07       -17.216225118263  <--
     9.5367e+03     9.5367e+04             3.1079e-08       -17.216225117747
     3.8147e+04     3.8147e+05             7.7699e-09       -17.216225117296

*****************************************************************************
Applying the update for shift_i =   2.3842e+03     and shift_s =   2.3842e+04
*****************************************************************************

  Execution time = 4.5120e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -4.030588e-02 3 1  ON 0
ci_002                -3.033034e-02 3 1  ON 1
ci_003                -2.478643e-02 3 1  ON 2
ci_004                 2.146152e-02 3 1  ON 3
ci_005                 2.070219e-02 3 1  ON 4
ci_006                -1.872851e-02 3 1  ON 5
ci_007                -1.840459e-02 3 1  ON 6
ci_008                -1.783213e-02 3 1  ON 7
ci_009                -1.758983e-02 3 1  ON 8
ci_010                -1.748721e-02 3 1  ON 9
ci_011                -1.622331e-02 3 1  ON 10
ci_012                -1.602933e-02 3 1  ON 11
ci_013                -1.825565e-02 3 1  ON 12
ci_014                 1.327662e-02 3 1  ON 13
ci_015                 1.384446e-02 3 1  ON 14
ci_016                 1.631381e-02 3 1  ON 15
ci_017                 1.677450e-02 3 1  ON 16
ci_018                 1.296504e-02 3 1  ON 17
ci_019                 1.263413e-02 3 1  ON 18
ci_020                 1.333160e-02 3 1  ON 19
ci_021                 1.320788e-02 3 1  ON 20
ci_022                 1.135449e-02 3 1  ON 21
ci_023                 1.135987e-02 3 1  ON 22
ci_024                 1.165383e-02 3 1  ON 23
ci_025                 1.179723e-02 3 1  ON 24
ci_026                 1.142258e-02 3 1  ON 25
ci_027                 1.144166e-02 3 1  ON 26
ci_028                -1.449892e-02 3 1  ON 27
ci_029                -1.410694e-02 3 1  ON 28
ci_030                -1.085414e-02 3 1  ON 29
ci_031                -1.109295e-02 3 1  ON 30
ci_032                -1.367308e-02 3 1  ON 31
ci_033                 1.027212e-02 3 1  ON 32
ci_034                 9.853816e-03 3 1  ON 33
ci_035                -4.597346e-03 3 1  ON 34
ci_036                -9.930675e-03 3 1  ON 35
ci_037                -9.961297e-03 3 1  ON 36
ci_038                 1.658071e-03 3 1  ON 37
ci_039                 1.581433e-03 3 1  ON 38
ci_040                -4.176073e-03 3 1  ON 39
ci_041                 9.803553e-03 3 1  ON 40
ci_042                 9.866814e-03 3 1  ON 41
ci_043                -3.175391e-03 3 1  ON 42
ci_044                -1.473275e-02 3 1  ON 43
ci_045                -1.932541e-03 3 1  ON 44
ci_046                 5.507506e-03 3 1  ON 45
ci_047                 5.477629e-03 3 1  ON 46
ci_048                -1.205874e-02 3 1  ON 47
ci_049                -1.215482e-02 3 1  ON 48
ci_050                 7.413729e-03 3 1  ON 49
ci_051                 7.490072e-03 3 1  ON 50
ci_052                -6.506740e-03 3 1  ON 51
ci_053                -6.680593e-03 3 1  ON 52
ci_054                -2.938814e-03 3 1  ON 53
ci_055                -2.853149e-03 3 1  ON 54
ci_056                 4.448413e-03 3 1  ON 55
ci_057                 4.434161e-03 3 1  ON 56
ci_058                -6.888890e-03 3 1  ON 57
ci_059                -6.782379e-03 3 1  ON 58
ci_060                 8.749008e-03 3 1  ON 59
ci_061                 8.219763e-03 3 1  ON 60
ci_062                -3.151633e-03 3 1  ON 61
ci_063                -3.054631e-03 3 1  ON 62
ci_064                -2.938621e-03 3 1  ON 63
ci_065                -4.376240e-03 3 1  ON 64
ci_066                 5.645369e-03 3 1  ON 65
ci_067                 5.614184e-03 3 1  ON 66
ci_068                -4.810596e-03 3 1  ON 67
ci_069                -5.164911e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7203e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2083
    reference variance = 0.430267
====================================================
  Execution time = 2.7401e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0544e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1375e-01
  Total weights = 3.913527285e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.0003e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298257881212
                                         uncertainty =       0.001218459148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298257881212
                                         uncertainty =       0.001218459148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273088113
  error estimate for blocks of size 2^( 2) =       0.000280137788
  error estimate for blocks of size 2^( 3) =       0.000286646006
  error estimate for blocks of size 2^( 4) =       0.000291919643
  error estimate for blocks of size 2^( 5) =       0.000295055828
  error estimate for blocks of size 2^( 6) =       0.000296614828
  error estimate for blocks of size 2^( 7) =       0.000297251315
  error estimate for blocks of size 2^( 8) =       0.000296471044

      target function =                  N/A
              le_mean =     -17.216291621323
             les_mean =     296.714450809466
             stat err =       0.000296348254
             autocorr =       1.177603674888
              std dev =       0.546176225598
             le_variance =       0.298308469409


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721629162132e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216291621342       residual = 8.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216291626675       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216291626549       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+02 is 4.940531e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216291621342       residual = 8.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216291622676       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216291622644       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+03 is 1.235373e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216291621342       residual = 8.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216291621676       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216291621668       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+03 is 3.088583e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.363926 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2409e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -4.030593e-02 3 1  ON 0
ci_002                -3.033028e-02 3 1  ON 1
ci_003                -2.478651e-02 3 1  ON 2
ci_004                 2.146140e-02 3 1  ON 3
ci_005                 2.070217e-02 3 1  ON 4
ci_006                -1.872847e-02 3 1  ON 5
ci_007                -1.840463e-02 3 1  ON 6
ci_008                -1.783211e-02 3 1  ON 7
ci_009                -1.758986e-02 3 1  ON 8
ci_010                -1.748721e-02 3 1  ON 9
ci_011                -1.622341e-02 3 1  ON 10
ci_012                -1.602935e-02 3 1  ON 11
ci_013                -1.825573e-02 3 1  ON 12
ci_014                 1.327666e-02 3 1  ON 13
ci_015                 1.384448e-02 3 1  ON 14
ci_016                 1.631377e-02 3 1  ON 15
ci_017                 1.677452e-02 3 1  ON 16
ci_018                 1.296503e-02 3 1  ON 17
ci_019                 1.263420e-02 3 1  ON 18
ci_020                 1.333157e-02 3 1  ON 19
ci_021                 1.320780e-02 3 1  ON 20
ci_022                 1.135452e-02 3 1  ON 21
ci_023                 1.135983e-02 3 1  ON 22
ci_024                 1.165382e-02 3 1  ON 23
ci_025                 1.179722e-02 3 1  ON 24
ci_026                 1.142254e-02 3 1  ON 25
ci_027                 1.144164e-02 3 1  ON 26
ci_028                -1.449884e-02 3 1  ON 27
ci_029                -1.410696e-02 3 1  ON 28
ci_030                -1.085417e-02 3 1  ON 29
ci_031                -1.109296e-02 3 1  ON 30
ci_032                -1.367314e-02 3 1  ON 31
ci_033                 1.027209e-02 3 1  ON 32
ci_034                 9.853848e-03 3 1  ON 33
ci_035                -4.597331e-03 3 1  ON 34
ci_036                -9.930746e-03 3 1  ON 35
ci_037                -9.961324e-03 3 1  ON 36
ci_038                 1.658097e-03 3 1  ON 37
ci_039                 1.581463e-03 3 1  ON 38
ci_040                -4.176097e-03 3 1  ON 39
ci_041                 9.803546e-03 3 1  ON 40
ci_042                 9.866881e-03 3 1  ON 41
ci_043                -3.175399e-03 3 1  ON 42
ci_044                -1.473279e-02 3 1  ON 43
ci_045                -1.932481e-03 3 1  ON 44
ci_046                 5.507486e-03 3 1  ON 45
ci_047                 5.477605e-03 3 1  ON 46
ci_048                -1.205871e-02 3 1  ON 47
ci_049                -1.215485e-02 3 1  ON 48
ci_050                 7.413766e-03 3 1  ON 49
ci_051                 7.490122e-03 3 1  ON 50
ci_052                -6.506727e-03 3 1  ON 51
ci_053                -6.680558e-03 3 1  ON 52
ci_054                -2.938860e-03 3 1  ON 53
ci_055                -2.853177e-03 3 1  ON 54
ci_056                 4.448396e-03 3 1  ON 55
ci_057                 4.434125e-03 3 1  ON 56
ci_058                -6.888819e-03 3 1  ON 57
ci_059                -6.782344e-03 3 1  ON 58
ci_060                 8.748923e-03 3 1  ON 59
ci_061                 8.219714e-03 3 1  ON 60
ci_062                -3.151627e-03 3 1  ON 61
ci_063                -3.054628e-03 3 1  ON 62
ci_064                -2.938653e-03 3 1  ON 63
ci_065                -4.376202e-03 3 1  ON 64
ci_066                 5.645359e-03 3 1  ON 65
ci_067                 5.614131e-03 3 1  ON 66
ci_068                -4.810617e-03 3 1  ON 67
ci_069                -5.164886e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.3375
    reference variance = 0.342896
====================================================
  Execution time = 2.9143e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1550e-01
  Total weights = 3.9136e+06
  Execution time = 3.6368e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300629163973
                                         uncertainty =       0.001453297792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300629163973
                                         uncertainty =       0.001453297792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274197053
  error estimate for blocks of size 2^( 2) =       0.000281350772
  error estimate for blocks of size 2^( 3) =       0.000287725069
  error estimate for blocks of size 2^( 4) =       0.000292599855
  error estimate for blocks of size 2^( 5) =       0.000295828641
  error estimate for blocks of size 2^( 6) =       0.000297458299
  error estimate for blocks of size 2^( 7) =       0.000298688637
  error estimate for blocks of size 2^( 8) =       0.000299923863

      target function =                  N/A
              le_mean =     -17.216724942352
             les_mean =     296.731113602166
             stat err =       0.000297974860
             autocorr =       1.180955904688
              std dev =       0.548394106924
             le_variance =       0.300736096509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300629274880
                                         uncertainty =       0.001453316828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300629274880
                                         uncertainty =       0.001453316828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274197104
  error estimate for blocks of size 2^( 2) =       0.000281350823
  error estimate for blocks of size 2^( 3) =       0.000287725119
  error estimate for blocks of size 2^( 4) =       0.000292599904
  error estimate for blocks of size 2^( 5) =       0.000295828683
  error estimate for blocks of size 2^( 6) =       0.000297458334
  error estimate for blocks of size 2^( 7) =       0.000298688670
  error estimate for blocks of size 2^( 8) =       0.000299923914

      target function =                  N/A
              le_mean =     -17.216724947615
             les_mean =     296.731114413748
             stat err =       0.000297974900
             autocorr =       1.180955789084
              std dev =       0.548394207741
             le_variance =       0.300736207083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300629219431
                                         uncertainty =       0.001453307312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300629219431
                                         uncertainty =       0.001453307312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274197079
  error estimate for blocks of size 2^( 2) =       0.000281350797
  error estimate for blocks of size 2^( 3) =       0.000287725094
  error estimate for blocks of size 2^( 4) =       0.000292599880
  error estimate for blocks of size 2^( 5) =       0.000295828662
  error estimate for blocks of size 2^( 6) =       0.000297458317
  error estimate for blocks of size 2^( 7) =       0.000298688654
  error estimate for blocks of size 2^( 8) =       0.000299923889

      target function =                  N/A
              le_mean =     -17.216724944983
             les_mean =     296.731114007225
             stat err =       0.000297974880
             autocorr =       1.180955846887
              std dev =       0.548394157336
             le_variance =       0.300736151800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300629170905
                                         uncertainty =       0.001453298982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300629170905
                                         uncertainty =       0.001453298982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274197057
  error estimate for blocks of size 2^( 2) =       0.000281350775
  error estimate for blocks of size 2^( 3) =       0.000287725072
  error estimate for blocks of size 2^( 4) =       0.000292599858
  error estimate for blocks of size 2^( 5) =       0.000295828643
  error estimate for blocks of size 2^( 6) =       0.000297458301
  error estimate for blocks of size 2^( 7) =       0.000298688639
  error estimate for blocks of size 2^( 8) =       0.000299923867

      target function =                  N/A
              le_mean =     -17.216724942681
             les_mean =     296.731113652710
             stat err =       0.000297974863
             autocorr =       1.180955897451
              std dev =       0.548394113225
             le_variance =       0.300736103420


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216724942352        initial
     5.9605e+02     5.9605e+03             4.9405e-07       -17.216724947615  <--
     2.3842e+03     2.3842e+04             1.2354e-07       -17.216724944983
     9.5367e+03     9.5367e+04             3.0886e-08       -17.216724942681

*****************************************************************************
Applying the update for shift_i =   5.9605e+02     and shift_s =   5.9605e+03
*****************************************************************************

  Execution time = 4.7474e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -4.030606e-02 3 1  ON 0
ci_002                -3.033009e-02 3 1  ON 1
ci_003                -2.478677e-02 3 1  ON 2
ci_004                 2.146103e-02 3 1  ON 3
ci_005                 2.070213e-02 3 1  ON 4
ci_006                -1.872835e-02 3 1  ON 5
ci_007                -1.840474e-02 3 1  ON 6
ci_008                -1.783205e-02 3 1  ON 7
ci_009                -1.758997e-02 3 1  ON 8
ci_010                -1.748721e-02 3 1  ON 9
ci_011                -1.622371e-02 3 1  ON 10
ci_012                -1.602943e-02 3 1  ON 11
ci_013                -1.825599e-02 3 1  ON 12
ci_014                 1.327677e-02 3 1  ON 13
ci_015                 1.384454e-02 3 1  ON 14
ci_016                 1.631368e-02 3 1  ON 15
ci_017                 1.677458e-02 3 1  ON 16
ci_018                 1.296499e-02 3 1  ON 17
ci_019                 1.263440e-02 3 1  ON 18
ci_020                 1.333148e-02 3 1  ON 19
ci_021                 1.320757e-02 3 1  ON 20
ci_022                 1.135460e-02 3 1  ON 21
ci_023                 1.135972e-02 3 1  ON 22
ci_024                 1.165380e-02 3 1  ON 23
ci_025                 1.179719e-02 3 1  ON 24
ci_026                 1.142239e-02 3 1  ON 25
ci_027                 1.144156e-02 3 1  ON 26
ci_028                -1.449862e-02 3 1  ON 27
ci_029                -1.410700e-02 3 1  ON 28
ci_030                -1.085427e-02 3 1  ON 29
ci_031                -1.109300e-02 3 1  ON 30
ci_032                -1.367333e-02 3 1  ON 31
ci_033                 1.027202e-02 3 1  ON 32
ci_034                 9.853946e-03 3 1  ON 33
ci_035                -4.597287e-03 3 1  ON 34
ci_036                -9.930960e-03 3 1  ON 35
ci_037                -9.961408e-03 3 1  ON 36
ci_038                 1.658173e-03 3 1  ON 37
ci_039                 1.581552e-03 3 1  ON 38
ci_040                -4.176172e-03 3 1  ON 39
ci_041                 9.803523e-03 3 1  ON 40
ci_042                 9.867081e-03 3 1  ON 41
ci_043                -3.175423e-03 3 1  ON 42
ci_044                -1.473290e-02 3 1  ON 43
ci_045                -1.932302e-03 3 1  ON 44
ci_046                 5.507429e-03 3 1  ON 45
ci_047                 5.477534e-03 3 1  ON 46
ci_048                -1.205862e-02 3 1  ON 47
ci_049                -1.215494e-02 3 1  ON 48
ci_050                 7.413878e-03 3 1  ON 49
ci_051                 7.490270e-03 3 1  ON 50
ci_052                -6.506688e-03 3 1  ON 51
ci_053                -6.680454e-03 3 1  ON 52
ci_054                -2.938995e-03 3 1  ON 53
ci_055                -2.853258e-03 3 1  ON 54
ci_056                 4.448342e-03 3 1  ON 55
ci_057                 4.434017e-03 3 1  ON 56
ci_058                -6.888608e-03 3 1  ON 57
ci_059                -6.782239e-03 3 1  ON 58
ci_060                 8.748668e-03 3 1  ON 59
ci_061                 8.219566e-03 3 1  ON 60
ci_062                -3.151610e-03 3 1  ON 61
ci_063                -3.054617e-03 3 1  ON 62
ci_064                -2.938749e-03 3 1  ON 63
ci_065                -4.376085e-03 3 1  ON 64
ci_066                 5.645330e-03 3 1  ON 65
ci_067                 5.613971e-03 3 1  ON 66
ci_068                -4.810682e-03 3 1  ON 67
ci_069                -5.164811e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9942e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.3078
    reference variance = 0.402879
====================================================
  Execution time = 2.7430e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0601e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1321e-01
  Total weights = 3.913533791e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9126e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297470990433
                                         uncertainty =       0.001438518248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297470990433
                                         uncertainty =       0.001438518248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272712141
  error estimate for blocks of size 2^( 2) =       0.000280029654
  error estimate for blocks of size 2^( 3) =       0.000286442798
  error estimate for blocks of size 2^( 4) =       0.000291141028
  error estimate for blocks of size 2^( 5) =       0.000293654639
  error estimate for blocks of size 2^( 6) =       0.000294654429
  error estimate for blocks of size 2^( 7) =       0.000295685171
  error estimate for blocks of size 2^( 8) =       0.000295529194

      target function =                  N/A
              le_mean =     -17.216353676397
             les_mean =     296.716048316214
             stat err =       0.000294880858
             autocorr =       1.169187645413
              std dev =       0.545424282187
             le_variance =       0.297487647599


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721635367640e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216353676423       residual = 6.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216353680673       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216353679712       residual = 8.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 1.467238e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216353676423       residual = 6.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216353677487       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216353677248       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+02 is 3.671972e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216353676423       residual = 6.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216353676689       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216353676630       residual = 8.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+03 is 9.182357e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.365001 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2350e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -4.030615e-02 3 1  ON 0
ci_002                -3.032977e-02 3 1  ON 1
ci_003                -2.478710e-02 3 1  ON 2
ci_004                 2.146071e-02 3 1  ON 3
ci_005                 2.070246e-02 3 1  ON 4
ci_006                -1.872848e-02 3 1  ON 5
ci_007                -1.840469e-02 3 1  ON 6
ci_008                -1.783175e-02 3 1  ON 7
ci_009                -1.758997e-02 3 1  ON 8
ci_010                -1.748733e-02 3 1  ON 9
ci_011                -1.622361e-02 3 1  ON 10
ci_012                -1.602944e-02 3 1  ON 11
ci_013                -1.825569e-02 3 1  ON 12
ci_014                 1.327707e-02 3 1  ON 13
ci_015                 1.384433e-02 3 1  ON 14
ci_016                 1.631359e-02 3 1  ON 15
ci_017                 1.677421e-02 3 1  ON 16
ci_018                 1.296483e-02 3 1  ON 17
ci_019                 1.263459e-02 3 1  ON 18
ci_020                 1.333126e-02 3 1  ON 19
ci_021                 1.320745e-02 3 1  ON 20
ci_022                 1.135457e-02 3 1  ON 21
ci_023                 1.135979e-02 3 1  ON 22
ci_024                 1.165372e-02 3 1  ON 23
ci_025                 1.179735e-02 3 1  ON 24
ci_026                 1.142218e-02 3 1  ON 25
ci_027                 1.144152e-02 3 1  ON 26
ci_028                -1.449867e-02 3 1  ON 27
ci_029                -1.410700e-02 3 1  ON 28
ci_030                -1.085423e-02 3 1  ON 29
ci_031                -1.109294e-02 3 1  ON 30
ci_032                -1.367319e-02 3 1  ON 31
ci_033                 1.027205e-02 3 1  ON 32
ci_034                 9.854129e-03 3 1  ON 33
ci_035                -4.597606e-03 3 1  ON 34
ci_036                -9.930978e-03 3 1  ON 35
ci_037                -9.961265e-03 3 1  ON 36
ci_038                 1.658108e-03 3 1  ON 37
ci_039                 1.581618e-03 3 1  ON 38
ci_040                -4.176047e-03 3 1  ON 39
ci_041                 9.803518e-03 3 1  ON 40
ci_042                 9.866994e-03 3 1  ON 41
ci_043                -3.175437e-03 3 1  ON 42
ci_044                -1.473295e-02 3 1  ON 43
ci_045                -1.932232e-03 3 1  ON 44
ci_046                 5.507428e-03 3 1  ON 45
ci_047                 5.477691e-03 3 1  ON 46
ci_048                -1.205862e-02 3 1  ON 47
ci_049                -1.215496e-02 3 1  ON 48
ci_050                 7.413932e-03 3 1  ON 49
ci_051                 7.490372e-03 3 1  ON 50
ci_052                -6.506652e-03 3 1  ON 51
ci_053                -6.680544e-03 3 1  ON 52
ci_054                -2.939011e-03 3 1  ON 53
ci_055                -2.853376e-03 3 1  ON 54
ci_056                 4.448302e-03 3 1  ON 55
ci_057                 4.434039e-03 3 1  ON 56
ci_058                -6.888449e-03 3 1  ON 57
ci_059                -6.782087e-03 3 1  ON 58
ci_060                 8.748738e-03 3 1  ON 59
ci_061                 8.219862e-03 3 1  ON 60
ci_062                -3.151529e-03 3 1  ON 61
ci_063                -3.054730e-03 3 1  ON 62
ci_064                -2.938677e-03 3 1  ON 63
ci_065                -4.375811e-03 3 1  ON 64
ci_066                 5.645186e-03 3 1  ON 65
ci_067                 5.613973e-03 3 1  ON 66
ci_068                -4.810878e-03 3 1  ON 67
ci_069                -5.164718e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2542
    reference variance = 0.258394
====================================================
  Execution time = 2.7187e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1786e-01
  Total weights = 3.9136e+06
  Execution time = 3.6388e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301377673213
                                         uncertainty =       0.001609966460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301377673213
                                         uncertainty =       0.001609966460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274466558
  error estimate for blocks of size 2^( 2) =       0.000281576547
  error estimate for blocks of size 2^( 3) =       0.000287816863
  error estimate for blocks of size 2^( 4) =       0.000292886629
  error estimate for blocks of size 2^( 5) =       0.000295374540
  error estimate for blocks of size 2^( 6) =       0.000297144770
  error estimate for blocks of size 2^( 7) =       0.000297355036
  error estimate for blocks of size 2^( 8) =       0.000296886600

      target function =                  N/A
              le_mean =     -17.216435889565
             les_mean =     296.723524812877
             stat err =       0.000296690237
             autocorr =       1.168497100848
              std dev =       0.548933115273
             le_variance =       0.301327565043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301377177187
                                         uncertainty =       0.001609980655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301377177187
                                         uncertainty =       0.001609980655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274466330
  error estimate for blocks of size 2^( 2) =       0.000281576335
  error estimate for blocks of size 2^( 3) =       0.000287816666
  error estimate for blocks of size 2^( 4) =       0.000292886454
  error estimate for blocks of size 2^( 5) =       0.000295374374
  error estimate for blocks of size 2^( 6) =       0.000297144603
  error estimate for blocks of size 2^( 7) =       0.000297354870
  error estimate for blocks of size 2^( 8) =       0.000296886447

      target function =                  N/A
              le_mean =     -17.216435906426
             les_mean =     296.723524467807
             stat err =       0.000296690074
             autocorr =       1.168497755140
              std dev =       0.548932659724
             le_variance =       0.301327064912

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301377424528
                                         uncertainty =       0.001609973572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301377424528
                                         uncertainty =       0.001609973572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274466443
  error estimate for blocks of size 2^( 2) =       0.000281576440
  error estimate for blocks of size 2^( 3) =       0.000287816764
  error estimate for blocks of size 2^( 4) =       0.000292886541
  error estimate for blocks of size 2^( 5) =       0.000295374457
  error estimate for blocks of size 2^( 6) =       0.000297144686
  error estimate for blocks of size 2^( 7) =       0.000297354953
  error estimate for blocks of size 2^( 8) =       0.000296886523

      target function =                  N/A
              le_mean =     -17.216435897995
             les_mean =     296.723524611922
             stat err =       0.000296690155
             autocorr =       1.168497428719
              std dev =       0.548932886882
             le_variance =       0.301327314301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301377642095
                                         uncertainty =       0.001609967349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301377642095
                                         uncertainty =       0.001609967349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274466543
  error estimate for blocks of size 2^( 2) =       0.000281576533
  error estimate for blocks of size 2^( 3) =       0.000287816851
  error estimate for blocks of size 2^( 4) =       0.000292886618
  error estimate for blocks of size 2^( 5) =       0.000295374529
  error estimate for blocks of size 2^( 6) =       0.000297144759
  error estimate for blocks of size 2^( 7) =       0.000297355026
  error estimate for blocks of size 2^( 8) =       0.000296886591

      target function =                  N/A
              le_mean =     -17.216435890618
             les_mean =     296.723524784417
             stat err =       0.000296690226
             autocorr =       1.168497141843
              std dev =       0.548933086694
             le_variance =       0.301327533668


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216435889565        initial
     1.4901e+02     1.4901e+03             1.4672e-06       -17.216435906426  <--
     5.9605e+02     5.9605e+03             3.6720e-07       -17.216435897995
     2.3842e+03     2.3842e+04             9.1824e-08       -17.216435890618

*****************************************************************************
Applying the update for shift_i =   1.4901e+02     and shift_s =   1.4901e+03
*****************************************************************************

  Execution time = 4.5705e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -4.030641e-02 3 1  ON 0
ci_002                -3.032882e-02 3 1  ON 1
ci_003                -2.478810e-02 3 1  ON 2
ci_004                 2.145976e-02 3 1  ON 3
ci_005                 2.070347e-02 3 1  ON 4
ci_006                -1.872886e-02 3 1  ON 5
ci_007                -1.840455e-02 3 1  ON 6
ci_008                -1.783087e-02 3 1  ON 7
ci_009                -1.758998e-02 3 1  ON 8
ci_010                -1.748769e-02 3 1  ON 9
ci_011                -1.622331e-02 3 1  ON 10
ci_012                -1.602948e-02 3 1  ON 11
ci_013                -1.825479e-02 3 1  ON 12
ci_014                 1.327798e-02 3 1  ON 13
ci_015                 1.384371e-02 3 1  ON 14
ci_016                 1.631332e-02 3 1  ON 15
ci_017                 1.677311e-02 3 1  ON 16
ci_018                 1.296438e-02 3 1  ON 17
ci_019                 1.263518e-02 3 1  ON 18
ci_020                 1.333061e-02 3 1  ON 19
ci_021                 1.320708e-02 3 1  ON 20
ci_022                 1.135448e-02 3 1  ON 21
ci_023                 1.135999e-02 3 1  ON 22
ci_024                 1.165348e-02 3 1  ON 23
ci_025                 1.179783e-02 3 1  ON 24
ci_026                 1.142156e-02 3 1  ON 25
ci_027                 1.144140e-02 3 1  ON 26
ci_028                -1.449884e-02 3 1  ON 27
ci_029                -1.410700e-02 3 1  ON 28
ci_030                -1.085411e-02 3 1  ON 29
ci_031                -1.109277e-02 3 1  ON 30
ci_032                -1.367278e-02 3 1  ON 31
ci_033                 1.027214e-02 3 1  ON 32
ci_034                 9.854678e-03 3 1  ON 33
ci_035                -4.598559e-03 3 1  ON 34
ci_036                -9.931032e-03 3 1  ON 35
ci_037                -9.960835e-03 3 1  ON 36
ci_038                 1.657914e-03 3 1  ON 37
ci_039                 1.581817e-03 3 1  ON 38
ci_040                -4.175675e-03 3 1  ON 39
ci_041                 9.803503e-03 3 1  ON 40
ci_042                 9.866733e-03 3 1  ON 41
ci_043                -3.175477e-03 3 1  ON 42
ci_044                -1.473310e-02 3 1  ON 43
ci_045                -1.932023e-03 3 1  ON 44
ci_046                 5.507423e-03 3 1  ON 45
ci_047                 5.478162e-03 3 1  ON 46
ci_048                -1.205864e-02 3 1  ON 47
ci_049                -1.215502e-02 3 1  ON 48
ci_050                 7.414093e-03 3 1  ON 49
ci_051                 7.490676e-03 3 1  ON 50
ci_052                -6.506544e-03 3 1  ON 51
ci_053                -6.680814e-03 3 1  ON 52
ci_054                -2.939059e-03 3 1  ON 53
ci_055                -2.853727e-03 3 1  ON 54
ci_056                 4.448183e-03 3 1  ON 55
ci_057                 4.434105e-03 3 1  ON 56
ci_058                -6.887976e-03 3 1  ON 57
ci_059                -6.781635e-03 3 1  ON 58
ci_060                 8.748949e-03 3 1  ON 59
ci_061                 8.220749e-03 3 1  ON 60
ci_062                -3.151287e-03 3 1  ON 61
ci_063                -3.055069e-03 3 1  ON 62
ci_064                -2.938464e-03 3 1  ON 63
ci_065                -4.374988e-03 3 1  ON 64
ci_066                 5.644755e-03 3 1  ON 65
ci_067                 5.613980e-03 3 1  ON 66
ci_068                -4.811466e-03 3 1  ON 67
ci_069                -5.164437e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8107e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2209
    reference variance = 0.329921
====================================================
  Execution time = 2.7080e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0572e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1156e-01
  Total weights = 3.913414462e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9028e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298826549907
                                         uncertainty =       0.001294601984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298826549907
                                         uncertainty =       0.001294601984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273316218
  error estimate for blocks of size 2^( 2) =       0.000280370337
  error estimate for blocks of size 2^( 3) =       0.000286735869
  error estimate for blocks of size 2^( 4) =       0.000291554982
  error estimate for blocks of size 2^( 5) =       0.000294081726
  error estimate for blocks of size 2^( 6) =       0.000296375341
  error estimate for blocks of size 2^( 7) =       0.000297059766
  error estimate for blocks of size 2^( 8) =       0.000295500460

      target function =                  N/A
              le_mean =     -17.216327240786
             les_mean =     296.713482319961
             stat err =       0.000295754323
             autocorr =       1.170931259811
              std dev =       0.546632435070
             le_variance =       0.298807019071


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721632724079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216327240810       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216327299472       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216327299339       residual = 7.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 7.426594e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216327240810       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216327255562       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216327255511       residual = 8.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 1.869560e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216327240810       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216327244504       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216327244490       residual = 8.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+02 is 4.682046e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.366079 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1990e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -4.030634e-02 3 1  ON 0
ci_002                -3.032877e-02 3 1  ON 1
ci_003                -2.478795e-02 3 1  ON 2
ci_004                 2.145958e-02 3 1  ON 3
ci_005                 2.070358e-02 3 1  ON 4
ci_006                -1.872892e-02 3 1  ON 5
ci_007                -1.840443e-02 3 1  ON 6
ci_008                -1.783086e-02 3 1  ON 7
ci_009                -1.758988e-02 3 1  ON 8
ci_010                -1.748745e-02 3 1  ON 9
ci_011                -1.622382e-02 3 1  ON 10
ci_012                -1.602992e-02 3 1  ON 11
ci_013                -1.825587e-02 3 1  ON 12
ci_014                 1.327824e-02 3 1  ON 13
ci_015                 1.384413e-02 3 1  ON 14
ci_016                 1.631319e-02 3 1  ON 15
ci_017                 1.677260e-02 3 1  ON 16
ci_018                 1.296399e-02 3 1  ON 17
ci_019                 1.263474e-02 3 1  ON 18
ci_020                 1.333026e-02 3 1  ON 19
ci_021                 1.320771e-02 3 1  ON 20
ci_022                 1.135439e-02 3 1  ON 21
ci_023                 1.136028e-02 3 1  ON 22
ci_024                 1.165305e-02 3 1  ON 23
ci_025                 1.179746e-02 3 1  ON 24
ci_026                 1.142074e-02 3 1  ON 25
ci_027                 1.144098e-02 3 1  ON 26
ci_028                -1.449858e-02 3 1  ON 27
ci_029                -1.410808e-02 3 1  ON 28
ci_030                -1.085395e-02 3 1  ON 29
ci_031                -1.109251e-02 3 1  ON 30
ci_032                -1.367320e-02 3 1  ON 31
ci_033                 1.027183e-02 3 1  ON 32
ci_034                 9.854666e-03 3 1  ON 33
ci_035                -4.598398e-03 3 1  ON 34
ci_036                -9.931473e-03 3 1  ON 35
ci_037                -9.961114e-03 3 1  ON 36
ci_038                 1.657048e-03 3 1  ON 37
ci_039                 1.582102e-03 3 1  ON 38
ci_040                -4.175172e-03 3 1  ON 39
ci_041                 9.802765e-03 3 1  ON 40
ci_042                 9.866636e-03 3 1  ON 41
ci_043                -3.175250e-03 3 1  ON 42
ci_044                -1.473306e-02 3 1  ON 43
ci_045                -1.930991e-03 3 1  ON 44
ci_046                 5.507607e-03 3 1  ON 45
ci_047                 5.477654e-03 3 1  ON 46
ci_048                -1.205849e-02 3 1  ON 47
ci_049                -1.215414e-02 3 1  ON 48
ci_050                 7.415963e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.507123e-03 3 1  ON 51
ci_053                -6.681061e-03 3 1  ON 52
ci_054                -2.939249e-03 3 1  ON 53
ci_055                -2.853466e-03 3 1  ON 54
ci_056                 4.447490e-03 3 1  ON 55
ci_057                 4.434529e-03 3 1  ON 56
ci_058                -6.887273e-03 3 1  ON 57
ci_059                -6.781032e-03 3 1  ON 58
ci_060                 8.747767e-03 3 1  ON 59
ci_061                 8.220595e-03 3 1  ON 60
ci_062                -3.150989e-03 3 1  ON 61
ci_063                -3.055161e-03 3 1  ON 62
ci_064                -2.938782e-03 3 1  ON 63
ci_065                -4.373265e-03 3 1  ON 64
ci_066                 5.645275e-03 3 1  ON 65
ci_067                 5.614665e-03 3 1  ON 66
ci_068                -4.811147e-03 3 1  ON 67
ci_069                -5.163903e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2611
    reference variance = 0.616174
====================================================
  Execution time = 2.7308e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2182e-01
  Total weights = 3.9135e+06
  Execution time = 3.6482e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303988420950
                                         uncertainty =       0.002259231718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303988420950
                                         uncertainty =       0.002259231718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275683974
  error estimate for blocks of size 2^( 2) =       0.000282957512
  error estimate for blocks of size 2^( 3) =       0.000289275704
  error estimate for blocks of size 2^( 4) =       0.000293797826
  error estimate for blocks of size 2^( 5) =       0.000296979242
  error estimate for blocks of size 2^( 6) =       0.000298245718
  error estimate for blocks of size 2^( 7) =       0.000299536915
  error estimate for blocks of size 2^( 8) =       0.000300129408

      target function =                  N/A
              le_mean =     -17.216659139316
             les_mean =     296.735170458992
             stat err =       0.000298722821
             autocorr =       1.174123445085
              std dev =       0.551367948915
             le_variance =       0.304006615091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303989200276
                                         uncertainty =       0.002259413273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303989200276
                                         uncertainty =       0.002259413273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275684328
  error estimate for blocks of size 2^( 2) =       0.000282957878
  error estimate for blocks of size 2^( 3) =       0.000289276107
  error estimate for blocks of size 2^( 4) =       0.000293798220
  error estimate for blocks of size 2^( 5) =       0.000296979658
  error estimate for blocks of size 2^( 6) =       0.000298246254
  error estimate for blocks of size 2^( 7) =       0.000299537503
  error estimate for blocks of size 2^( 8) =       0.000300130119

      target function =                  N/A
              le_mean =     -17.216659100222
             les_mean =     296.735177475715
             stat err =       0.000298723384
             autocorr =       1.174124859752
              std dev =       0.551368655743
             le_variance =       0.304007394535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303988811402
                                         uncertainty =       0.002259322841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303988811402
                                         uncertainty =       0.002259322841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275684152
  error estimate for blocks of size 2^( 2) =       0.000282957696
  error estimate for blocks of size 2^( 3) =       0.000289275906
  error estimate for blocks of size 2^( 4) =       0.000293798023
  error estimate for blocks of size 2^( 5) =       0.000296979450
  error estimate for blocks of size 2^( 6) =       0.000298245987
  error estimate for blocks of size 2^( 7) =       0.000299537210
  error estimate for blocks of size 2^( 8) =       0.000300129765

      target function =                  N/A
              le_mean =     -17.216659119345
             les_mean =     296.735173587227
             stat err =       0.000298723103
             autocorr =       1.174124157600
              std dev =       0.551368303050
             le_variance =       0.304007005608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303988469591
                                         uncertainty =       0.002259243117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303988469591
                                         uncertainty =       0.002259243117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275683997
  error estimate for blocks of size 2^( 2) =       0.000282957535
  error estimate for blocks of size 2^( 3) =       0.000289275729
  error estimate for blocks of size 2^( 4) =       0.000293797851
  error estimate for blocks of size 2^( 5) =       0.000296979268
  error estimate for blocks of size 2^( 6) =       0.000298245752
  error estimate for blocks of size 2^( 7) =       0.000299536952
  error estimate for blocks of size 2^( 8) =       0.000300129452

      target function =                  N/A
              le_mean =     -17.216659136782
             les_mean =     296.735170806747
             stat err =       0.000298722856
             autocorr =       1.174123534470
              std dev =       0.551367993032
             le_variance =       0.304006663740


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216659139316        initial  <--
     3.7253e+01     3.7253e+02             7.4266e-06       -17.216659100222
     1.4901e+02     1.4901e+03             1.8696e-06       -17.216659119345
     5.9605e+02     5.9605e+03             4.6820e-07       -17.216659136782

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.7069
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -4.030641e-02 3 1  ON 0
ci_002                -3.032882e-02 3 1  ON 1
ci_003                -2.478810e-02 3 1  ON 2
ci_004                 2.145976e-02 3 1  ON 3
ci_005                 2.070347e-02 3 1  ON 4
ci_006                -1.872886e-02 3 1  ON 5
ci_007                -1.840455e-02 3 1  ON 6
ci_008                -1.783087e-02 3 1  ON 7
ci_009                -1.758998e-02 3 1  ON 8
ci_010                -1.748769e-02 3 1  ON 9
ci_011                -1.622331e-02 3 1  ON 10
ci_012                -1.602948e-02 3 1  ON 11
ci_013                -1.825479e-02 3 1  ON 12
ci_014                 1.327798e-02 3 1  ON 13
ci_015                 1.384371e-02 3 1  ON 14
ci_016                 1.631332e-02 3 1  ON 15
ci_017                 1.677311e-02 3 1  ON 16
ci_018                 1.296438e-02 3 1  ON 17
ci_019                 1.263518e-02 3 1  ON 18
ci_020                 1.333061e-02 3 1  ON 19
ci_021                 1.320708e-02 3 1  ON 20
ci_022                 1.135448e-02 3 1  ON 21
ci_023                 1.135999e-02 3 1  ON 22
ci_024                 1.165348e-02 3 1  ON 23
ci_025                 1.179783e-02 3 1  ON 24
ci_026                 1.142156e-02 3 1  ON 25
ci_027                 1.144140e-02 3 1  ON 26
ci_028                -1.449884e-02 3 1  ON 27
ci_029                -1.410700e-02 3 1  ON 28
ci_030                -1.085411e-02 3 1  ON 29
ci_031                -1.109277e-02 3 1  ON 30
ci_032                -1.367278e-02 3 1  ON 31
ci_033                 1.027214e-02 3 1  ON 32
ci_034                 9.854678e-03 3 1  ON 33
ci_035                -4.598559e-03 3 1  ON 34
ci_036                -9.931032e-03 3 1  ON 35
ci_037                -9.960835e-03 3 1  ON 36
ci_038                 1.657914e-03 3 1  ON 37
ci_039                 1.581817e-03 3 1  ON 38
ci_040                -4.175675e-03 3 1  ON 39
ci_041                 9.803503e-03 3 1  ON 40
ci_042                 9.866733e-03 3 1  ON 41
ci_043                -3.175477e-03 3 1  ON 42
ci_044                -1.473310e-02 3 1  ON 43
ci_045                -1.932023e-03 3 1  ON 44
ci_046                 5.507423e-03 3 1  ON 45
ci_047                 5.478162e-03 3 1  ON 46
ci_048                -1.205864e-02 3 1  ON 47
ci_049                -1.215502e-02 3 1  ON 48
ci_050                 7.414093e-03 3 1  ON 49
ci_051                 7.490676e-03 3 1  ON 50
ci_052                -6.506544e-03 3 1  ON 51
ci_053                -6.680814e-03 3 1  ON 52
ci_054                -2.939059e-03 3 1  ON 53
ci_055                -2.853727e-03 3 1  ON 54
ci_056                 4.448183e-03 3 1  ON 55
ci_057                 4.434105e-03 3 1  ON 56
ci_058                -6.887976e-03 3 1  ON 57
ci_059                -6.781635e-03 3 1  ON 58
ci_060                 8.748949e-03 3 1  ON 59
ci_061                 8.220749e-03 3 1  ON 60
ci_062                -3.151287e-03 3 1  ON 61
ci_063                -3.055069e-03 3 1  ON 62
ci_064                -2.938464e-03 3 1  ON 63
ci_065                -4.374988e-03 3 1  ON 64
ci_066                 5.644755e-03 3 1  ON 65
ci_067                 5.613980e-03 3 1  ON 66
ci_068                -4.811466e-03 3 1  ON 67
ci_069                -5.164437e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7704e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1438
    reference variance = 0.318241
====================================================
  Execution time = 2.7341e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0584e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1602e-01
  Total weights = 3.913649273e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.0029e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300710185336
                                         uncertainty =       0.001273370166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300710185336
                                         uncertainty =       0.001273370166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274166645
  error estimate for blocks of size 2^( 2) =       0.000281259763
  error estimate for blocks of size 2^( 3) =       0.000287704168
  error estimate for blocks of size 2^( 4) =       0.000292145607
  error estimate for blocks of size 2^( 5) =       0.000295005417
  error estimate for blocks of size 2^( 6) =       0.000296712821
  error estimate for blocks of size 2^( 7) =       0.000297534115
  error estimate for blocks of size 2^( 8) =       0.000298875930

      target function =                  N/A
              le_mean =     -17.216742664042
             les_mean =     296.732251650109
             stat err =       0.000297032071
             autocorr =       1.173754989161
              std dev =       0.548333290078
             le_variance =       0.300669397008


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721674266404e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216742664075       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216742672767       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216742672958       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+02 is 9.892301e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216742664075       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216742666250       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216742666297       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+03 is 2.475426e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216742664075       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216742664619       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216742664631       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+03 is 6.190036e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.367142 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2351e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -4.030641e-02 3 1  ON 0
ci_002                -3.032865e-02 3 1  ON 1
ci_003                -2.478822e-02 3 1  ON 2
ci_004                 2.145973e-02 3 1  ON 3
ci_005                 2.070348e-02 3 1  ON 4
ci_006                -1.872883e-02 3 1  ON 5
ci_007                -1.840461e-02 3 1  ON 6
ci_008                -1.783099e-02 3 1  ON 7
ci_009                -1.758991e-02 3 1  ON 8
ci_010                -1.748764e-02 3 1  ON 9
ci_011                -1.622331e-02 3 1  ON 10
ci_012                -1.602949e-02 3 1  ON 11
ci_013                -1.825489e-02 3 1  ON 12
ci_014                 1.327806e-02 3 1  ON 13
ci_015                 1.384367e-02 3 1  ON 14
ci_016                 1.631332e-02 3 1  ON 15
ci_017                 1.677309e-02 3 1  ON 16
ci_018                 1.296435e-02 3 1  ON 17
ci_019                 1.263520e-02 3 1  ON 18
ci_020                 1.333060e-02 3 1  ON 19
ci_021                 1.320711e-02 3 1  ON 20
ci_022                 1.135447e-02 3 1  ON 21
ci_023                 1.136005e-02 3 1  ON 22
ci_024                 1.165349e-02 3 1  ON 23
ci_025                 1.179776e-02 3 1  ON 24
ci_026                 1.142155e-02 3 1  ON 25
ci_027                 1.144138e-02 3 1  ON 26
ci_028                -1.449884e-02 3 1  ON 27
ci_029                -1.410707e-02 3 1  ON 28
ci_030                -1.085416e-02 3 1  ON 29
ci_031                -1.109282e-02 3 1  ON 30
ci_032                -1.367279e-02 3 1  ON 31
ci_033                 1.027215e-02 3 1  ON 32
ci_034                 9.854751e-03 3 1  ON 33
ci_035                -4.598599e-03 3 1  ON 34
ci_036                -9.931180e-03 3 1  ON 35
ci_037                -9.960958e-03 3 1  ON 36
ci_038                 1.657930e-03 3 1  ON 37
ci_039                 1.581854e-03 3 1  ON 38
ci_040                -4.175697e-03 3 1  ON 39
ci_041                 9.803512e-03 3 1  ON 40
ci_042                 9.866818e-03 3 1  ON 41
ci_043                -3.175467e-03 3 1  ON 42
ci_044                -1.473312e-02 3 1  ON 43
ci_045                -1.932023e-03 3 1  ON 44
ci_046                 5.507378e-03 3 1  ON 45
ci_047                 5.478101e-03 3 1  ON 46
ci_048                -1.205863e-02 3 1  ON 47
ci_049                -1.215505e-02 3 1  ON 48
ci_050                 7.414077e-03 3 1  ON 49
ci_051                 7.490778e-03 3 1  ON 50
ci_052                -6.506535e-03 3 1  ON 51
ci_053                -6.680852e-03 3 1  ON 52
ci_054                -2.939112e-03 3 1  ON 53
ci_055                -2.853797e-03 3 1  ON 54
ci_056                 4.448297e-03 3 1  ON 55
ci_057                 4.434121e-03 3 1  ON 56
ci_058                -6.887962e-03 3 1  ON 57
ci_059                -6.781628e-03 3 1  ON 58
ci_060                 8.748960e-03 3 1  ON 59
ci_061                 8.220784e-03 3 1  ON 60
ci_062                -3.151407e-03 3 1  ON 61
ci_063                -3.054998e-03 3 1  ON 62
ci_064                -2.938521e-03 3 1  ON 63
ci_065                -4.374741e-03 3 1  ON 64
ci_066                 5.644701e-03 3 1  ON 65
ci_067                 5.614025e-03 3 1  ON 66
ci_068                -4.811473e-03 3 1  ON 67
ci_069                -5.164396e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2406
    reference variance = 0.221389
====================================================
  Execution time = 2.7168e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1479e-01
  Total weights = 3.9131e+06
  Execution time = 3.6559e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299965564017
                                         uncertainty =       0.001624936867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299965564017
                                         uncertainty =       0.001624936867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273837130
  error estimate for blocks of size 2^( 2) =       0.000280866285
  error estimate for blocks of size 2^( 3) =       0.000287423526
  error estimate for blocks of size 2^( 4) =       0.000291883289
  error estimate for blocks of size 2^( 5) =       0.000294748432
  error estimate for blocks of size 2^( 6) =       0.000296759767
  error estimate for blocks of size 2^( 7) =       0.000298264658
  error estimate for blocks of size 2^( 8) =       0.000297844517

      target function =                  N/A
              le_mean =     -17.217009826289
             les_mean =     296.740214703589
             stat err =       0.000296904343
             autocorr =       1.175569836972
              std dev =       0.547674259241
             le_variance =       0.299947094235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299965875362
                                         uncertainty =       0.001624950582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299965875362
                                         uncertainty =       0.001624950582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273837271
  error estimate for blocks of size 2^( 2) =       0.000280866421
  error estimate for blocks of size 2^( 3) =       0.000287423648
  error estimate for blocks of size 2^( 4) =       0.000291883395
  error estimate for blocks of size 2^( 5) =       0.000294748531
  error estimate for blocks of size 2^( 6) =       0.000296759868
  error estimate for blocks of size 2^( 7) =       0.000298264755
  error estimate for blocks of size 2^( 8) =       0.000297844628

      target function =                  N/A
              le_mean =     -17.217009831702
             les_mean =     296.740215220479
             stat err =       0.000296904445
             autocorr =       1.175569426535
              std dev =       0.547674542883
             le_variance =       0.299947404922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299965719776
                                         uncertainty =       0.001624943728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299965719776
                                         uncertainty =       0.001624943728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273837201
  error estimate for blocks of size 2^( 2) =       0.000280866353
  error estimate for blocks of size 2^( 3) =       0.000287423587
  error estimate for blocks of size 2^( 4) =       0.000291883342
  error estimate for blocks of size 2^( 5) =       0.000294748482
  error estimate for blocks of size 2^( 6) =       0.000296759817
  error estimate for blocks of size 2^( 7) =       0.000298264706
  error estimate for blocks of size 2^( 8) =       0.000297844573

      target function =                  N/A
              le_mean =     -17.217009828994
             les_mean =     296.740214954551
             stat err =       0.000296904394
             autocorr =       1.175569631591
              std dev =       0.547674401141
             le_variance =       0.299947249665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299965583487
                                         uncertainty =       0.001624937724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299965583487
                                         uncertainty =       0.001624937724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273837138
  error estimate for blocks of size 2^( 2) =       0.000280866294
  error estimate for blocks of size 2^( 3) =       0.000287423533
  error estimate for blocks of size 2^( 4) =       0.000291883296
  error estimate for blocks of size 2^( 5) =       0.000294748439
  error estimate for blocks of size 2^( 6) =       0.000296759773
  error estimate for blocks of size 2^( 7) =       0.000298264664
  error estimate for blocks of size 2^( 8) =       0.000297844524

      target function =                  N/A
              le_mean =     -17.217009826627
             les_mean =     296.740214734122
             stat err =       0.000296904350
             autocorr =       1.175569811310
              std dev =       0.547674276979
             le_variance =       0.299947113664


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217009826289        initial
     3.7253e+02     3.7253e+03             9.8923e-07       -17.217009831702  <--
     1.4901e+03     1.4901e+04             2.4754e-07       -17.217009828994
     5.9605e+03     5.9605e+04             6.1900e-08       -17.217009826627

*****************************************************************************
Applying the update for shift_i =   3.7253e+02     and shift_s =   3.7253e+03
*****************************************************************************

  Execution time = 4.5606e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -4.030641e-02 3 1  ON 0
ci_002                -3.032815e-02 3 1  ON 1
ci_003                -2.478859e-02 3 1  ON 2
ci_004                 2.145964e-02 3 1  ON 3
ci_005                 2.070352e-02 3 1  ON 4
ci_006                -1.872872e-02 3 1  ON 5
ci_007                -1.840479e-02 3 1  ON 6
ci_008                -1.783135e-02 3 1  ON 7
ci_009                -1.758973e-02 3 1  ON 8
ci_010                -1.748748e-02 3 1  ON 9
ci_011                -1.622333e-02 3 1  ON 10
ci_012                -1.602953e-02 3 1  ON 11
ci_013                -1.825520e-02 3 1  ON 12
ci_014                 1.327831e-02 3 1  ON 13
ci_015                 1.384352e-02 3 1  ON 14
ci_016                 1.631333e-02 3 1  ON 15
ci_017                 1.677301e-02 3 1  ON 16
ci_018                 1.296425e-02 3 1  ON 17
ci_019                 1.263526e-02 3 1  ON 18
ci_020                 1.333059e-02 3 1  ON 19
ci_021                 1.320719e-02 3 1  ON 20
ci_022                 1.135445e-02 3 1  ON 21
ci_023                 1.136024e-02 3 1  ON 22
ci_024                 1.165352e-02 3 1  ON 23
ci_025                 1.179757e-02 3 1  ON 24
ci_026                 1.142153e-02 3 1  ON 25
ci_027                 1.144132e-02 3 1  ON 26
ci_028                -1.449883e-02 3 1  ON 27
ci_029                -1.410729e-02 3 1  ON 28
ci_030                -1.085433e-02 3 1  ON 29
ci_031                -1.109294e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027216e-02 3 1  ON 32
ci_034                 9.854973e-03 3 1  ON 33
ci_035                -4.598719e-03 3 1  ON 34
ci_036                -9.931626e-03 3 1  ON 35
ci_037                -9.961329e-03 3 1  ON 36
ci_038                 1.657978e-03 3 1  ON 37
ci_039                 1.581967e-03 3 1  ON 38
ci_040                -4.175762e-03 3 1  ON 39
ci_041                 9.803541e-03 3 1  ON 40
ci_042                 9.867071e-03 3 1  ON 41
ci_043                -3.175438e-03 3 1  ON 42
ci_044                -1.473321e-02 3 1  ON 43
ci_045                -1.932022e-03 3 1  ON 44
ci_046                 5.507241e-03 3 1  ON 45
ci_047                 5.477919e-03 3 1  ON 46
ci_048                -1.205862e-02 3 1  ON 47
ci_049                -1.215514e-02 3 1  ON 48
ci_050                 7.414030e-03 3 1  ON 49
ci_051                 7.491085e-03 3 1  ON 50
ci_052                -6.506508e-03 3 1  ON 51
ci_053                -6.680967e-03 3 1  ON 52
ci_054                -2.939271e-03 3 1  ON 53
ci_055                -2.854008e-03 3 1  ON 54
ci_056                 4.448639e-03 3 1  ON 55
ci_057                 4.434169e-03 3 1  ON 56
ci_058                -6.887921e-03 3 1  ON 57
ci_059                -6.781608e-03 3 1  ON 58
ci_060                 8.748993e-03 3 1  ON 59
ci_061                 8.220890e-03 3 1  ON 60
ci_062                -3.151765e-03 3 1  ON 61
ci_063                -3.054785e-03 3 1  ON 62
ci_064                -2.938693e-03 3 1  ON 63
ci_065                -4.373999e-03 3 1  ON 64
ci_066                 5.644541e-03 3 1  ON 65
ci_067                 5.614160e-03 3 1  ON 66
ci_068                -4.811495e-03 3 1  ON 67
ci_069                -5.164276e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7966e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2416
    reference variance = 0.279121
====================================================
  Execution time = 2.7244e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0566e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1264e-01
  Total weights = 3.913183061e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9122e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298566166871
                                         uncertainty =       0.001822672965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298566166871
                                         uncertainty =       0.001822672965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273193997
  error estimate for blocks of size 2^( 2) =       0.000280314125
  error estimate for blocks of size 2^( 3) =       0.000286606620
  error estimate for blocks of size 2^( 4) =       0.000291110206
  error estimate for blocks of size 2^( 5) =       0.000293609233
  error estimate for blocks of size 2^( 6) =       0.000294896568
  error estimate for blocks of size 2^( 7) =       0.000295557450
  error estimate for blocks of size 2^( 8) =       0.000296976586

      target function =                  N/A
              le_mean =     -17.215777176096
             les_mean =     296.695623713891
             stat err =       0.000295259959
             autocorr =       1.168064453723
              std dev =       0.546387993356
             le_variance =       0.298539839283


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721577717610e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215777176114       residual = 6.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215777199737       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215777200072       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+01 is 2.044940e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215777176114       residual = 6.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215777182031       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215777182114       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+02 is 5.121682e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215777176114       residual = 6.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215777177594       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215777177615       residual = 7.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+03 is 1.281005e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.368203 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2164e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -4.030665e-02 3 1  ON 0
ci_002                -3.032798e-02 3 1  ON 1
ci_003                -2.478908e-02 3 1  ON 2
ci_004                 2.145986e-02 3 1  ON 3
ci_005                 2.070372e-02 3 1  ON 4
ci_006                -1.872870e-02 3 1  ON 5
ci_007                -1.840494e-02 3 1  ON 6
ci_008                -1.783127e-02 3 1  ON 7
ci_009                -1.758996e-02 3 1  ON 8
ci_010                -1.748731e-02 3 1  ON 9
ci_011                -1.622347e-02 3 1  ON 10
ci_012                -1.602946e-02 3 1  ON 11
ci_013                -1.825528e-02 3 1  ON 12
ci_014                 1.327843e-02 3 1  ON 13
ci_015                 1.384342e-02 3 1  ON 14
ci_016                 1.631363e-02 3 1  ON 15
ci_017                 1.677312e-02 3 1  ON 16
ci_018                 1.296448e-02 3 1  ON 17
ci_019                 1.263552e-02 3 1  ON 18
ci_020                 1.333037e-02 3 1  ON 19
ci_021                 1.320691e-02 3 1  ON 20
ci_022                 1.135449e-02 3 1  ON 21
ci_023                 1.135994e-02 3 1  ON 22
ci_024                 1.165333e-02 3 1  ON 23
ci_025                 1.179782e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144141e-02 3 1  ON 26
ci_028                -1.449904e-02 3 1  ON 27
ci_029                -1.410759e-02 3 1  ON 28
ci_030                -1.085445e-02 3 1  ON 29
ci_031                -1.109254e-02 3 1  ON 30
ci_032                -1.367306e-02 3 1  ON 31
ci_033                 1.027214e-02 3 1  ON 32
ci_034                 9.855485e-03 3 1  ON 33
ci_035                -4.598773e-03 3 1  ON 34
ci_036                -9.932026e-03 3 1  ON 35
ci_037                -9.961578e-03 3 1  ON 36
ci_038                 1.658126e-03 3 1  ON 37
ci_039                 1.581945e-03 3 1  ON 38
ci_040                -4.175623e-03 3 1  ON 39
ci_041                 9.803982e-03 3 1  ON 40
ci_042                 9.866915e-03 3 1  ON 41
ci_043                -3.175174e-03 3 1  ON 42
ci_044                -1.473371e-02 3 1  ON 43
ci_045                -1.931768e-03 3 1  ON 44
ci_046                 5.507690e-03 3 1  ON 45
ci_047                 5.477880e-03 3 1  ON 46
ci_048                -1.205818e-02 3 1  ON 47
ci_049                -1.215502e-02 3 1  ON 48
ci_050                 7.413897e-03 3 1  ON 49
ci_051                 7.491281e-03 3 1  ON 50
ci_052                -6.506825e-03 3 1  ON 51
ci_053                -6.680737e-03 3 1  ON 52
ci_054                -2.938871e-03 3 1  ON 53
ci_055                -2.854484e-03 3 1  ON 54
ci_056                 4.449057e-03 3 1  ON 55
ci_057                 4.434084e-03 3 1  ON 56
ci_058                -6.887955e-03 3 1  ON 57
ci_059                -6.781550e-03 3 1  ON 58
ci_060                 8.748860e-03 3 1  ON 59
ci_061                 8.220963e-03 3 1  ON 60
ci_062                -3.151563e-03 3 1  ON 61
ci_063                -3.054768e-03 3 1  ON 62
ci_064                -2.939000e-03 3 1  ON 63
ci_065                -4.373508e-03 3 1  ON 64
ci_066                 5.644754e-03 3 1  ON 65
ci_067                 5.614044e-03 3 1  ON 66
ci_068                -4.811539e-03 3 1  ON 67
ci_069                -5.163919e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2272
    reference variance = 0.181883
====================================================
  Execution time = 2.9330e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1234e-01
  Total weights = 3.9136e+06
  Execution time = 3.6425e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298294392314
                                         uncertainty =       0.001372611181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298294392314
                                         uncertainty =       0.001372611181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273083839
  error estimate for blocks of size 2^( 2) =       0.000280164537
  error estimate for blocks of size 2^( 3) =       0.000286475790
  error estimate for blocks of size 2^( 4) =       0.000291227435
  error estimate for blocks of size 2^( 5) =       0.000294074764
  error estimate for blocks of size 2^( 6) =       0.000296161760
  error estimate for blocks of size 2^( 7) =       0.000296346259
  error estimate for blocks of size 2^( 8) =       0.000296616718

      target function =                  N/A
              le_mean =     -17.216160386518
             les_mean =     296.708518601299
             stat err =       0.000295799875
             autocorr =       1.173286231605
              std dev =       0.546167677759
             le_variance =       0.298299132229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298294797068
                                         uncertainty =       0.001372642702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298294797068
                                         uncertainty =       0.001372642702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273084022
  error estimate for blocks of size 2^( 2) =       0.000280164692
  error estimate for blocks of size 2^( 3) =       0.000286475922
  error estimate for blocks of size 2^( 4) =       0.000291227535
  error estimate for blocks of size 2^( 5) =       0.000294074857
  error estimate for blocks of size 2^( 6) =       0.000296161865
  error estimate for blocks of size 2^( 7) =       0.000296346349
  error estimate for blocks of size 2^( 8) =       0.000296616819

      target function =                  N/A
              le_mean =     -17.216160382583
             les_mean =     296.708519194595
             stat err =       0.000295799973
             autocorr =       1.173285433291
              std dev =       0.546168043519
             le_variance =       0.298299531761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298294594523
                                         uncertainty =       0.001372626974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298294594523
                                         uncertainty =       0.001372626974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273083930
  error estimate for blocks of size 2^( 2) =       0.000280164615
  error estimate for blocks of size 2^( 3) =       0.000286475856
  error estimate for blocks of size 2^( 4) =       0.000291227485
  error estimate for blocks of size 2^( 5) =       0.000294074810
  error estimate for blocks of size 2^( 6) =       0.000296161812
  error estimate for blocks of size 2^( 7) =       0.000296346304
  error estimate for blocks of size 2^( 8) =       0.000296616768

      target function =                  N/A
              le_mean =     -17.216160384500
             les_mean =     296.708518882093
             stat err =       0.000295799924
             autocorr =       1.173285831624
              std dev =       0.546167860481
             le_variance =       0.298299331822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298294417557
                                         uncertainty =       0.001372613156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298294417557
                                         uncertainty =       0.001372613156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273083850
  error estimate for blocks of size 2^( 2) =       0.000280164547
  error estimate for blocks of size 2^( 3) =       0.000286475798
  error estimate for blocks of size 2^( 4) =       0.000291227441
  error estimate for blocks of size 2^( 5) =       0.000294074769
  error estimate for blocks of size 2^( 6) =       0.000296161766
  error estimate for blocks of size 2^( 7) =       0.000296346265
  error estimate for blocks of size 2^( 8) =       0.000296616725

      target function =                  N/A
              le_mean =     -17.216160386260
             les_mean =     296.708518634604
             stat err =       0.000295799881
             autocorr =       1.173286181587
              std dev =       0.546167700569
             le_variance =       0.298299157145


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216160386518        initial  <--
     9.3132e+01     9.3132e+02             2.0449e-06       -17.216160382583
     3.7253e+02     3.7253e+03             5.1217e-07       -17.216160384500
     1.4901e+03     1.4901e+04             1.2810e-07       -17.216160386260

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.6870
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -4.030641e-02 3 1  ON 0
ci_002                -3.032815e-02 3 1  ON 1
ci_003                -2.478859e-02 3 1  ON 2
ci_004                 2.145964e-02 3 1  ON 3
ci_005                 2.070352e-02 3 1  ON 4
ci_006                -1.872872e-02 3 1  ON 5
ci_007                -1.840479e-02 3 1  ON 6
ci_008                -1.783135e-02 3 1  ON 7
ci_009                -1.758973e-02 3 1  ON 8
ci_010                -1.748748e-02 3 1  ON 9
ci_011                -1.622333e-02 3 1  ON 10
ci_012                -1.602953e-02 3 1  ON 11
ci_013                -1.825520e-02 3 1  ON 12
ci_014                 1.327831e-02 3 1  ON 13
ci_015                 1.384352e-02 3 1  ON 14
ci_016                 1.631333e-02 3 1  ON 15
ci_017                 1.677301e-02 3 1  ON 16
ci_018                 1.296425e-02 3 1  ON 17
ci_019                 1.263526e-02 3 1  ON 18
ci_020                 1.333059e-02 3 1  ON 19
ci_021                 1.320719e-02 3 1  ON 20
ci_022                 1.135445e-02 3 1  ON 21
ci_023                 1.136024e-02 3 1  ON 22
ci_024                 1.165352e-02 3 1  ON 23
ci_025                 1.179757e-02 3 1  ON 24
ci_026                 1.142153e-02 3 1  ON 25
ci_027                 1.144132e-02 3 1  ON 26
ci_028                -1.449883e-02 3 1  ON 27
ci_029                -1.410729e-02 3 1  ON 28
ci_030                -1.085433e-02 3 1  ON 29
ci_031                -1.109294e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027216e-02 3 1  ON 32
ci_034                 9.854973e-03 3 1  ON 33
ci_035                -4.598719e-03 3 1  ON 34
ci_036                -9.931626e-03 3 1  ON 35
ci_037                -9.961329e-03 3 1  ON 36
ci_038                 1.657978e-03 3 1  ON 37
ci_039                 1.581967e-03 3 1  ON 38
ci_040                -4.175762e-03 3 1  ON 39
ci_041                 9.803541e-03 3 1  ON 40
ci_042                 9.867071e-03 3 1  ON 41
ci_043                -3.175438e-03 3 1  ON 42
ci_044                -1.473321e-02 3 1  ON 43
ci_045                -1.932022e-03 3 1  ON 44
ci_046                 5.507241e-03 3 1  ON 45
ci_047                 5.477919e-03 3 1  ON 46
ci_048                -1.205862e-02 3 1  ON 47
ci_049                -1.215514e-02 3 1  ON 48
ci_050                 7.414030e-03 3 1  ON 49
ci_051                 7.491085e-03 3 1  ON 50
ci_052                -6.506508e-03 3 1  ON 51
ci_053                -6.680967e-03 3 1  ON 52
ci_054                -2.939271e-03 3 1  ON 53
ci_055                -2.854008e-03 3 1  ON 54
ci_056                 4.448639e-03 3 1  ON 55
ci_057                 4.434169e-03 3 1  ON 56
ci_058                -6.887921e-03 3 1  ON 57
ci_059                -6.781608e-03 3 1  ON 58
ci_060                 8.748993e-03 3 1  ON 59
ci_061                 8.220890e-03 3 1  ON 60
ci_062                -3.151765e-03 3 1  ON 61
ci_063                -3.054785e-03 3 1  ON 62
ci_064                -2.938693e-03 3 1  ON 63
ci_065                -4.373999e-03 3 1  ON 64
ci_066                 5.644541e-03 3 1  ON 65
ci_067                 5.614160e-03 3 1  ON 66
ci_068                -4.811495e-03 3 1  ON 67
ci_069                -5.164276e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9868e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1873
    reference variance = 0.175016
====================================================
  Execution time = 2.7182e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0591e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1851e-01
  Total weights = 3.912957366e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9380e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301958068040
                                         uncertainty =       0.002432335878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301958068040
                                         uncertainty =       0.002432335878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274711598
  error estimate for blocks of size 2^( 2) =       0.000281680129
  error estimate for blocks of size 2^( 3) =       0.000287833052
  error estimate for blocks of size 2^( 4) =       0.000292521771
  error estimate for blocks of size 2^( 5) =       0.000295184995
  error estimate for blocks of size 2^( 6) =       0.000297723022
  error estimate for blocks of size 2^( 7) =       0.000298226414
  error estimate for blocks of size 2^( 8) =       0.000297592076

      target function =                  N/A
              le_mean =     -17.216918351934
             les_mean =     296.740792499252
             stat err =       0.000297181627
             autocorr =       1.170280367679
              std dev =       0.549423196832
             le_variance =       0.301865849217


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721691835193e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216918351950       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216918354227       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216918354275       residual = 6.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+02 is 1.950260e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216918351950       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216918352519       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216918352531       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+03 is 4.876451e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216918351950       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216918352092       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216918352095       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+04 is 1.219163e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.372080 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2133e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -4.030644e-02 3 1  ON 0
ci_002                -3.032811e-02 3 1  ON 1
ci_003                -2.478861e-02 3 1  ON 2
ci_004                 2.145963e-02 3 1  ON 3
ci_005                 2.070353e-02 3 1  ON 4
ci_006                -1.872873e-02 3 1  ON 5
ci_007                -1.840479e-02 3 1  ON 6
ci_008                -1.783135e-02 3 1  ON 7
ci_009                -1.758975e-02 3 1  ON 8
ci_010                -1.748747e-02 3 1  ON 9
ci_011                -1.622333e-02 3 1  ON 10
ci_012                -1.602955e-02 3 1  ON 11
ci_013                -1.825521e-02 3 1  ON 12
ci_014                 1.327830e-02 3 1  ON 13
ci_015                 1.384351e-02 3 1  ON 14
ci_016                 1.631335e-02 3 1  ON 15
ci_017                 1.677300e-02 3 1  ON 16
ci_018                 1.296425e-02 3 1  ON 17
ci_019                 1.263529e-02 3 1  ON 18
ci_020                 1.333059e-02 3 1  ON 19
ci_021                 1.320718e-02 3 1  ON 20
ci_022                 1.135447e-02 3 1  ON 21
ci_023                 1.136026e-02 3 1  ON 22
ci_024                 1.165356e-02 3 1  ON 23
ci_025                 1.179756e-02 3 1  ON 24
ci_026                 1.142148e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449883e-02 3 1  ON 27
ci_029                -1.410732e-02 3 1  ON 28
ci_030                -1.085435e-02 3 1  ON 29
ci_031                -1.109294e-02 3 1  ON 30
ci_032                -1.367287e-02 3 1  ON 31
ci_033                 1.027214e-02 3 1  ON 32
ci_034                 9.855021e-03 3 1  ON 33
ci_035                -4.598677e-03 3 1  ON 34
ci_036                -9.931624e-03 3 1  ON 35
ci_037                -9.961365e-03 3 1  ON 36
ci_038                 1.657989e-03 3 1  ON 37
ci_039                 1.581969e-03 3 1  ON 38
ci_040                -4.175742e-03 3 1  ON 39
ci_041                 9.803562e-03 3 1  ON 40
ci_042                 9.867086e-03 3 1  ON 41
ci_043                -3.175409e-03 3 1  ON 42
ci_044                -1.473324e-02 3 1  ON 43
ci_045                -1.932002e-03 3 1  ON 44
ci_046                 5.507234e-03 3 1  ON 45
ci_047                 5.477896e-03 3 1  ON 46
ci_048                -1.205861e-02 3 1  ON 47
ci_049                -1.215516e-02 3 1  ON 48
ci_050                 7.414071e-03 3 1  ON 49
ci_051                 7.491040e-03 3 1  ON 50
ci_052                -6.506532e-03 3 1  ON 51
ci_053                -6.680967e-03 3 1  ON 52
ci_054                -2.939293e-03 3 1  ON 53
ci_055                -2.853996e-03 3 1  ON 54
ci_056                 4.448630e-03 3 1  ON 55
ci_057                 4.434212e-03 3 1  ON 56
ci_058                -6.887896e-03 3 1  ON 57
ci_059                -6.781588e-03 3 1  ON 58
ci_060                 8.749005e-03 3 1  ON 59
ci_061                 8.220872e-03 3 1  ON 60
ci_062                -3.151758e-03 3 1  ON 61
ci_063                -3.054825e-03 3 1  ON 62
ci_064                -2.938726e-03 3 1  ON 63
ci_065                -4.373964e-03 3 1  ON 64
ci_066                 5.644554e-03 3 1  ON 65
ci_067                 5.614150e-03 3 1  ON 66
ci_068                -4.811479e-03 3 1  ON 67
ci_069                -5.164259e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2539
    reference variance = 0.330234
====================================================
  Execution time = 2.7693e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1573e-01
  Total weights = 3.9135e+06
  Execution time = 3.7053e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298533006132
                                         uncertainty =       0.001555028874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298533006132
                                         uncertainty =       0.001555028874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273210682
  error estimate for blocks of size 2^( 2) =       0.000280125602
  error estimate for blocks of size 2^( 3) =       0.000286679072
  error estimate for blocks of size 2^( 4) =       0.000291377423
  error estimate for blocks of size 2^( 5) =       0.000294562376
  error estimate for blocks of size 2^( 6) =       0.000296357762
  error estimate for blocks of size 2^( 7) =       0.000296088919
  error estimate for blocks of size 2^( 8) =       0.000297075725

      target function =                  N/A
              le_mean =     -17.216795337401
             les_mean =     296.733772509604
             stat err =       0.000296021195
             autocorr =       1.173951798835
              std dev =       0.546421363913
             le_variance =       0.298576306941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298533011504
                                         uncertainty =       0.001555027689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298533011504
                                         uncertainty =       0.001555027689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273210685
  error estimate for blocks of size 2^( 2) =       0.000280125603
  error estimate for blocks of size 2^( 3) =       0.000286679072
  error estimate for blocks of size 2^( 4) =       0.000291377425
  error estimate for blocks of size 2^( 5) =       0.000294562373
  error estimate for blocks of size 2^( 6) =       0.000296357754
  error estimate for blocks of size 2^( 7) =       0.000296088912
  error estimate for blocks of size 2^( 8) =       0.000297075709

      target function =                  N/A
              le_mean =     -17.216795339203
             les_mean =     296.733776344145
             stat err =       0.000296021187
             autocorr =       1.173951707113
              std dev =       0.546421369647
             le_variance =       0.298576313207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298533008812
                                         uncertainty =       0.001555028282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298533008812
                                         uncertainty =       0.001555028282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273210683
  error estimate for blocks of size 2^( 2) =       0.000280125602
  error estimate for blocks of size 2^( 3) =       0.000286679072
  error estimate for blocks of size 2^( 4) =       0.000291377424
  error estimate for blocks of size 2^( 5) =       0.000294562375
  error estimate for blocks of size 2^( 6) =       0.000296357758
  error estimate for blocks of size 2^( 7) =       0.000296088915
  error estimate for blocks of size 2^( 8) =       0.000297075717

      target function =                  N/A
              le_mean =     -17.216795338300
             les_mean =     296.733773227594
             stat err =       0.000296021191
             autocorr =       1.173951752964
              std dev =       0.546421366774
             le_variance =       0.298576310067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298533006466
                                         uncertainty =       0.001555028800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298533006466
                                         uncertainty =       0.001555028800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273210682
  error estimate for blocks of size 2^( 2) =       0.000280125602
  error estimate for blocks of size 2^( 3) =       0.000286679072
  error estimate for blocks of size 2^( 4) =       0.000291377423
  error estimate for blocks of size 2^( 5) =       0.000294562376
  error estimate for blocks of size 2^( 6) =       0.000296357761
  error estimate for blocks of size 2^( 7) =       0.000296088918
  error estimate for blocks of size 2^( 8) =       0.000297075724

      target function =                  N/A
              le_mean =     -17.216795337513
             les_mean =     296.733772566043
             stat err =       0.000296021195
             autocorr =       1.173951793102
              std dev =       0.546421364270
             le_variance =       0.298576307331


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216795337401        initial
     9.3132e+02     9.3132e+03             1.9503e-07       -17.216795339203  <--
     3.7253e+03     3.7253e+04             4.8765e-08       -17.216795338300
     1.4901e+04     1.4901e+05             1.2192e-08       -17.216795337513

*****************************************************************************
Applying the update for shift_i =   9.3132e+02     and shift_s =   9.3132e+03
*****************************************************************************

  Execution time = 4.6199e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -4.030652e-02 3 1  ON 0
ci_002                -3.032801e-02 3 1  ON 1
ci_003                -2.478866e-02 3 1  ON 2
ci_004                 2.145958e-02 3 1  ON 3
ci_005                 2.070354e-02 3 1  ON 4
ci_006                -1.872876e-02 3 1  ON 5
ci_007                -1.840479e-02 3 1  ON 6
ci_008                -1.783134e-02 3 1  ON 7
ci_009                -1.758982e-02 3 1  ON 8
ci_010                -1.748744e-02 3 1  ON 9
ci_011                -1.622332e-02 3 1  ON 10
ci_012                -1.602960e-02 3 1  ON 11
ci_013                -1.825527e-02 3 1  ON 12
ci_014                 1.327827e-02 3 1  ON 13
ci_015                 1.384345e-02 3 1  ON 14
ci_016                 1.631341e-02 3 1  ON 15
ci_017                 1.677300e-02 3 1  ON 16
ci_018                 1.296424e-02 3 1  ON 17
ci_019                 1.263537e-02 3 1  ON 18
ci_020                 1.333061e-02 3 1  ON 19
ci_021                 1.320713e-02 3 1  ON 20
ci_022                 1.135452e-02 3 1  ON 21
ci_023                 1.136031e-02 3 1  ON 22
ci_024                 1.165368e-02 3 1  ON 23
ci_025                 1.179755e-02 3 1  ON 24
ci_026                 1.142135e-02 3 1  ON 25
ci_027                 1.144124e-02 3 1  ON 26
ci_028                -1.449883e-02 3 1  ON 27
ci_029                -1.410743e-02 3 1  ON 28
ci_030                -1.085440e-02 3 1  ON 29
ci_031                -1.109291e-02 3 1  ON 30
ci_032                -1.367299e-02 3 1  ON 31
ci_033                 1.027207e-02 3 1  ON 32
ci_034                 9.855168e-03 3 1  ON 33
ci_035                -4.598552e-03 3 1  ON 34
ci_036                -9.931619e-03 3 1  ON 35
ci_037                -9.961473e-03 3 1  ON 36
ci_038                 1.658022e-03 3 1  ON 37
ci_039                 1.581976e-03 3 1  ON 38
ci_040                -4.175681e-03 3 1  ON 39
ci_041                 9.803627e-03 3 1  ON 40
ci_042                 9.867129e-03 3 1  ON 41
ci_043                -3.175321e-03 3 1  ON 42
ci_044                -1.473334e-02 3 1  ON 43
ci_045                -1.931941e-03 3 1  ON 44
ci_046                 5.507210e-03 3 1  ON 45
ci_047                 5.477828e-03 3 1  ON 46
ci_048                -1.205859e-02 3 1  ON 47
ci_049                -1.215522e-02 3 1  ON 48
ci_050                 7.414196e-03 3 1  ON 49
ci_051                 7.490907e-03 3 1  ON 50
ci_052                -6.506602e-03 3 1  ON 51
ci_053                -6.680968e-03 3 1  ON 52
ci_054                -2.939360e-03 3 1  ON 53
ci_055                -2.853959e-03 3 1  ON 54
ci_056                 4.448604e-03 3 1  ON 55
ci_057                 4.434339e-03 3 1  ON 56
ci_058                -6.887821e-03 3 1  ON 57
ci_059                -6.781529e-03 3 1  ON 58
ci_060                 8.749040e-03 3 1  ON 59
ci_061                 8.220819e-03 3 1  ON 60
ci_062                -3.151737e-03 3 1  ON 61
ci_063                -3.054943e-03 3 1  ON 62
ci_064                -2.938826e-03 3 1  ON 63
ci_065                -4.373858e-03 3 1  ON 64
ci_066                 5.644595e-03 3 1  ON 65
ci_067                 5.614119e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.164207e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8351e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1721
    reference variance = 0.196614
====================================================
  Execution time = 2.7325e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0556e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1502e-01
  Total weights = 3.913136126e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.0150e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299930836057
                                         uncertainty =       0.001553468293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299930836057
                                         uncertainty =       0.001553468293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273815200
  error estimate for blocks of size 2^( 2) =       0.000280818712
  error estimate for blocks of size 2^( 3) =       0.000287400294
  error estimate for blocks of size 2^( 4) =       0.000291977890
  error estimate for blocks of size 2^( 5) =       0.000294861196
  error estimate for blocks of size 2^( 6) =       0.000295772726
  error estimate for blocks of size 2^( 7) =       0.000296530164
  error estimate for blocks of size 2^( 8) =       0.000297236833

      target function =                  N/A
              le_mean =     -17.216944601691
             les_mean =     296.738205230958
             stat err =       0.000296100230
             autocorr =       1.169398100169
              std dev =       0.547630399383
             le_variance =       0.299899054328


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721694460169e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216944601723       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216944601697       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216944600981       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+02 is 1.139196e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216944601723       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216944601716       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216944601537       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+02 is 2.850696e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216944601723       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216944601721       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216944601676       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+03 is 7.128434e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.375933 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2357e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -4.030649e-02 3 1  ON 0
ci_002                -3.032792e-02 3 1  ON 1
ci_003                -2.478887e-02 3 1  ON 2
ci_004                 2.145942e-02 3 1  ON 3
ci_005                 2.070346e-02 3 1  ON 4
ci_006                -1.872876e-02 3 1  ON 5
ci_007                -1.840488e-02 3 1  ON 6
ci_008                -1.783129e-02 3 1  ON 7
ci_009                -1.758991e-02 3 1  ON 8
ci_010                -1.748748e-02 3 1  ON 9
ci_011                -1.622342e-02 3 1  ON 10
ci_012                -1.602975e-02 3 1  ON 11
ci_013                -1.825550e-02 3 1  ON 12
ci_014                 1.327843e-02 3 1  ON 13
ci_015                 1.384341e-02 3 1  ON 14
ci_016                 1.631345e-02 3 1  ON 15
ci_017                 1.677284e-02 3 1  ON 16
ci_018                 1.296405e-02 3 1  ON 17
ci_019                 1.263534e-02 3 1  ON 18
ci_020                 1.333054e-02 3 1  ON 19
ci_021                 1.320703e-02 3 1  ON 20
ci_022                 1.135463e-02 3 1  ON 21
ci_023                 1.136026e-02 3 1  ON 22
ci_024                 1.165365e-02 3 1  ON 23
ci_025                 1.179746e-02 3 1  ON 24
ci_026                 1.142132e-02 3 1  ON 25
ci_027                 1.144126e-02 3 1  ON 26
ci_028                -1.449876e-02 3 1  ON 27
ci_029                -1.410754e-02 3 1  ON 28
ci_030                -1.085444e-02 3 1  ON 29
ci_031                -1.109289e-02 3 1  ON 30
ci_032                -1.367295e-02 3 1  ON 31
ci_033                 1.027210e-02 3 1  ON 32
ci_034                 9.855342e-03 3 1  ON 33
ci_035                -4.598624e-03 3 1  ON 34
ci_036                -9.931715e-03 3 1  ON 35
ci_037                -9.961629e-03 3 1  ON 36
ci_038                 1.657981e-03 3 1  ON 37
ci_039                 1.581936e-03 3 1  ON 38
ci_040                -4.175447e-03 3 1  ON 39
ci_041                 9.803614e-03 3 1  ON 40
ci_042                 9.867062e-03 3 1  ON 41
ci_043                -3.175193e-03 3 1  ON 42
ci_044                -1.473344e-02 3 1  ON 43
ci_045                -1.931858e-03 3 1  ON 44
ci_046                 5.507101e-03 3 1  ON 45
ci_047                 5.477839e-03 3 1  ON 46
ci_048                -1.205877e-02 3 1  ON 47
ci_049                -1.215522e-02 3 1  ON 48
ci_050                 7.414046e-03 3 1  ON 49
ci_051                 7.491002e-03 3 1  ON 50
ci_052                -6.506574e-03 3 1  ON 51
ci_053                -6.680859e-03 3 1  ON 52
ci_054                -2.939355e-03 3 1  ON 53
ci_055                -2.854132e-03 3 1  ON 54
ci_056                 4.448693e-03 3 1  ON 55
ci_057                 4.434464e-03 3 1  ON 56
ci_058                -6.887536e-03 3 1  ON 57
ci_059                -6.781315e-03 3 1  ON 58
ci_060                 8.749014e-03 3 1  ON 59
ci_061                 8.220954e-03 3 1  ON 60
ci_062                -3.151677e-03 3 1  ON 61
ci_063                -3.054897e-03 3 1  ON 62
ci_064                -2.938936e-03 3 1  ON 63
ci_065                -4.373686e-03 3 1  ON 64
ci_066                 5.644597e-03 3 1  ON 65
ci_067                 5.614111e-03 3 1  ON 66
ci_068                -4.811431e-03 3 1  ON 67
ci_069                -5.164148e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1476
    reference variance = 0.188027
====================================================
  Execution time = 2.6952e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1449e-01
  Total weights = 3.9139e+06
  Execution time = 3.6562e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296432741557
                                         uncertainty =       0.001073990415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296432741557
                                         uncertainty =       0.001073990415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272367925
  error estimate for blocks of size 2^( 2) =       0.000279466137
  error estimate for blocks of size 2^( 3) =       0.000285980311
  error estimate for blocks of size 2^( 4) =       0.000290590115
  error estimate for blocks of size 2^( 5) =       0.000293589119
  error estimate for blocks of size 2^( 6) =       0.000295387032
  error estimate for blocks of size 2^( 7) =       0.000296696940
  error estimate for blocks of size 2^( 8) =       0.000298635174

      target function =                  N/A
              le_mean =     -17.216670034194
             les_mean =     296.728213825180
             stat err =       0.000296077066
             autocorr =       1.181673816109
              std dev =       0.544735850354
             le_variance =       0.296737146661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296431938400
                                         uncertainty =       0.001074005592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296431938400
                                         uncertainty =       0.001074005592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272367556
  error estimate for blocks of size 2^( 2) =       0.000279465783
  error estimate for blocks of size 2^( 3) =       0.000285979976
  error estimate for blocks of size 2^( 4) =       0.000290589799
  error estimate for blocks of size 2^( 5) =       0.000293588825
  error estimate for blocks of size 2^( 6) =       0.000295386724
  error estimate for blocks of size 2^( 7) =       0.000296696643
  error estimate for blocks of size 2^( 8) =       0.000298634960

      target function =                  N/A
              le_mean =     -17.216670041960
             les_mean =     296.728210221976
             stat err =       0.000296076788
             autocorr =       1.181674795756
              std dev =       0.544735112414
             le_variance =       0.296736342696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296432339433
                                         uncertainty =       0.001073998009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296432339433
                                         uncertainty =       0.001073998009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272367740
  error estimate for blocks of size 2^( 2) =       0.000279465960
  error estimate for blocks of size 2^( 3) =       0.000285980143
  error estimate for blocks of size 2^( 4) =       0.000290589957
  error estimate for blocks of size 2^( 5) =       0.000293588972
  error estimate for blocks of size 2^( 6) =       0.000295386878
  error estimate for blocks of size 2^( 7) =       0.000296696791
  error estimate for blocks of size 2^( 8) =       0.000298635067

      target function =                  N/A
              le_mean =     -17.216670038070
             les_mean =     296.728212015061
             stat err =       0.000296076927
             autocorr =       1.181674306528
              std dev =       0.544735480884
             le_variance =       0.296736744134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296432691267
                                         uncertainty =       0.001073991364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296432691267
                                         uncertainty =       0.001073991364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272367902
  error estimate for blocks of size 2^( 2) =       0.000279466115
  error estimate for blocks of size 2^( 3) =       0.000285980290
  error estimate for blocks of size 2^( 4) =       0.000290590095
  error estimate for blocks of size 2^( 5) =       0.000293589101
  error estimate for blocks of size 2^( 6) =       0.000295387013
  error estimate for blocks of size 2^( 7) =       0.000296696921
  error estimate for blocks of size 2^( 8) =       0.000298635161

      target function =                  N/A
              le_mean =     -17.216670034678
             les_mean =     296.728213598157
             stat err =       0.000296077049
             autocorr =       1.181673877430
              std dev =       0.544735804148
             le_variance =       0.296737096321


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216670034194        initial
     2.3283e+02     2.3283e+03             1.1392e-06       -17.216670041960  <--
     9.3132e+02     9.3132e+03             2.8507e-07       -17.216670038070
     3.7253e+03     3.7253e+04             7.1284e-08       -17.216670034678

*****************************************************************************
Applying the update for shift_i =   2.3283e+02     and shift_s =   2.3283e+03
*****************************************************************************

  Execution time = 4.5387e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -4.030641e-02 3 1  ON 0
ci_002                -3.032764e-02 3 1  ON 1
ci_003                -2.478950e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070324e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840515e-02 3 1  ON 6
ci_008                -1.783114e-02 3 1  ON 7
ci_009                -1.759019e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622370e-02 3 1  ON 10
ci_012                -1.603019e-02 3 1  ON 11
ci_013                -1.825620e-02 3 1  ON 12
ci_014                 1.327890e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631354e-02 3 1  ON 15
ci_017                 1.677236e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263524e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320675e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136010e-02 3 1  ON 22
ci_024                 1.165358e-02 3 1  ON 23
ci_025                 1.179717e-02 3 1  ON 24
ci_026                 1.142124e-02 3 1  ON 25
ci_027                 1.144133e-02 3 1  ON 26
ci_028                -1.449856e-02 3 1  ON 27
ci_029                -1.410787e-02 3 1  ON 28
ci_030                -1.085455e-02 3 1  ON 29
ci_031                -1.109282e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027220e-02 3 1  ON 32
ci_034                 9.855867e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932003e-03 3 1  ON 35
ci_037                -9.962098e-03 3 1  ON 36
ci_038                 1.657858e-03 3 1  ON 37
ci_039                 1.581814e-03 3 1  ON 38
ci_040                -4.174747e-03 3 1  ON 39
ci_041                 9.803577e-03 3 1  ON 40
ci_042                 9.866862e-03 3 1  ON 41
ci_043                -3.174810e-03 3 1  ON 42
ci_044                -1.473376e-02 3 1  ON 43
ci_045                -1.931610e-03 3 1  ON 44
ci_046                 5.506774e-03 3 1  ON 45
ci_047                 5.477873e-03 3 1  ON 46
ci_048                -1.205931e-02 3 1  ON 47
ci_049                -1.215520e-02 3 1  ON 48
ci_050                 7.413595e-03 3 1  ON 49
ci_051                 7.491285e-03 3 1  ON 50
ci_052                -6.506489e-03 3 1  ON 51
ci_053                -6.680534e-03 3 1  ON 52
ci_054                -2.939340e-03 3 1  ON 53
ci_055                -2.854653e-03 3 1  ON 54
ci_056                 4.448960e-03 3 1  ON 55
ci_057                 4.434839e-03 3 1  ON 56
ci_058                -6.886682e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748937e-03 3 1  ON 59
ci_061                 8.221358e-03 3 1  ON 60
ci_062                -3.151499e-03 3 1  ON 61
ci_063                -3.054759e-03 3 1  ON 62
ci_064                -2.939267e-03 3 1  ON 63
ci_065                -4.373171e-03 3 1  ON 64
ci_066                 5.644605e-03 3 1  ON 65
ci_067                 5.614084e-03 3 1  ON 66
ci_068                -4.811438e-03 3 1  ON 67
ci_069                -5.163973e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7778e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.196
    reference variance = 0.164154
====================================================
  Execution time = 2.7196e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0546e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1462e-01
  Total weights = 3.913800371e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9101e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299419099939
                                         uncertainty =       0.001362428556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299419099939
                                         uncertainty =       0.001362428556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273610094
  error estimate for blocks of size 2^( 2) =       0.000280716686
  error estimate for blocks of size 2^( 3) =       0.000287206910
  error estimate for blocks of size 2^( 4) =       0.000291802386
  error estimate for blocks of size 2^( 5) =       0.000294899515
  error estimate for blocks of size 2^( 6) =       0.000296576018
  error estimate for blocks of size 2^( 7) =       0.000297808852
  error estimate for blocks of size 2^( 8) =       0.000298130661

      target function =                  N/A
              le_mean =     -17.217188777070
             les_mean =     296.746206832801
             stat err =       0.000296853762
             autocorr =       1.177120389474
              std dev =       0.547220188152
             le_variance =       0.299449934321


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721718877707e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217188777086       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217188825567       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217188826574       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+01 is 3.440569e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217188777086       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217188789247       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217188789506       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+02 is 8.630199e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217188777086       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217188780129       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217188780194       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+02 is 2.159357e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.379870 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2119e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -4.030641e-02 3 1  ON 0
ci_002                -3.032680e-02 3 1  ON 1
ci_003                -2.478994e-02 3 1  ON 2
ci_004                 2.145838e-02 3 1  ON 3
ci_005                 2.070344e-02 3 1  ON 4
ci_006                -1.872875e-02 3 1  ON 5
ci_007                -1.840571e-02 3 1  ON 6
ci_008                -1.783145e-02 3 1  ON 7
ci_009                -1.759028e-02 3 1  ON 8
ci_010                -1.748762e-02 3 1  ON 9
ci_011                -1.622422e-02 3 1  ON 10
ci_012                -1.603052e-02 3 1  ON 11
ci_013                -1.825696e-02 3 1  ON 12
ci_014                 1.327949e-02 3 1  ON 13
ci_015                 1.384312e-02 3 1  ON 14
ci_016                 1.631409e-02 3 1  ON 15
ci_017                 1.677152e-02 3 1  ON 16
ci_018                 1.296357e-02 3 1  ON 17
ci_019                 1.263611e-02 3 1  ON 18
ci_020                 1.333041e-02 3 1  ON 19
ci_021                 1.320641e-02 3 1  ON 20
ci_022                 1.135522e-02 3 1  ON 21
ci_023                 1.136007e-02 3 1  ON 22
ci_024                 1.165333e-02 3 1  ON 23
ci_025                 1.179729e-02 3 1  ON 24
ci_026                 1.142128e-02 3 1  ON 25
ci_027                 1.144119e-02 3 1  ON 26
ci_028                -1.449838e-02 3 1  ON 27
ci_029                -1.410827e-02 3 1  ON 28
ci_030                -1.085496e-02 3 1  ON 29
ci_031                -1.109323e-02 3 1  ON 30
ci_032                -1.367270e-02 3 1  ON 31
ci_033                 1.027199e-02 3 1  ON 32
ci_034                 9.856457e-03 3 1  ON 33
ci_035                -4.599588e-03 3 1  ON 34
ci_036                -9.931825e-03 3 1  ON 35
ci_037                -9.962295e-03 3 1  ON 36
ci_038                 1.657779e-03 3 1  ON 37
ci_039                 1.581697e-03 3 1  ON 38
ci_040                -4.174466e-03 3 1  ON 39
ci_041                 9.803569e-03 3 1  ON 40
ci_042                 9.867129e-03 3 1  ON 41
ci_043                -3.174831e-03 3 1  ON 42
ci_044                -1.473390e-02 3 1  ON 43
ci_045                -1.931418e-03 3 1  ON 44
ci_046                 5.506730e-03 3 1  ON 45
ci_047                 5.477931e-03 3 1  ON 46
ci_048                -1.205903e-02 3 1  ON 47
ci_049                -1.215485e-02 3 1  ON 48
ci_050                 7.413186e-03 3 1  ON 49
ci_051                 7.491715e-03 3 1  ON 50
ci_052                -6.506269e-03 3 1  ON 51
ci_053                -6.680257e-03 3 1  ON 52
ci_054                -2.940203e-03 3 1  ON 53
ci_055                -2.854959e-03 3 1  ON 54
ci_056                 4.448659e-03 3 1  ON 55
ci_057                 4.435439e-03 3 1  ON 56
ci_058                -6.887135e-03 3 1  ON 57
ci_059                -6.780841e-03 3 1  ON 58
ci_060                 8.748327e-03 3 1  ON 59
ci_061                 8.221636e-03 3 1  ON 60
ci_062                -3.151509e-03 3 1  ON 61
ci_063                -3.054789e-03 3 1  ON 62
ci_064                -2.939710e-03 3 1  ON 63
ci_065                -4.372363e-03 3 1  ON 64
ci_066                 5.644532e-03 3 1  ON 65
ci_067                 5.614814e-03 3 1  ON 66
ci_068                -4.811877e-03 3 1  ON 67
ci_069                -5.163685e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.2212
    reference variance = 0.142006
====================================================
  Execution time = 2.7064e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1485e-01
  Total weights = 3.9134e+06
  Execution time = 3.6420e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300338172819
                                         uncertainty =       0.001472788071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300338172819
                                         uncertainty =       0.001472788071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273999790
  error estimate for blocks of size 2^( 2) =       0.000281171905
  error estimate for blocks of size 2^( 3) =       0.000287679671
  error estimate for blocks of size 2^( 4) =       0.000292789379
  error estimate for blocks of size 2^( 5) =       0.000296242074
  error estimate for blocks of size 2^( 6) =       0.000297620429
  error estimate for blocks of size 2^( 7) =       0.000298269687
  error estimate for blocks of size 2^( 8) =       0.000297633128

      target function =                  N/A
              le_mean =     -17.216545551543
             les_mean =     296.724292387019
             stat err =       0.000297441329
             autocorr =       1.178425594511
              std dev =       0.547999580347
             le_variance =       0.300303540060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300341120077
                                         uncertainty =       0.001472714113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300341120077
                                         uncertainty =       0.001472714113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274001134
  error estimate for blocks of size 2^( 2) =       0.000281173189
  error estimate for blocks of size 2^( 3) =       0.000287680901
  error estimate for blocks of size 2^( 4) =       0.000292790559
  error estimate for blocks of size 2^( 5) =       0.000296243278
  error estimate for blocks of size 2^( 6) =       0.000297621566
  error estimate for blocks of size 2^( 7) =       0.000298270826
  error estimate for blocks of size 2^( 8) =       0.000297634227

      target function =                  N/A
              le_mean =     -17.216545532097
             les_mean =     296.724294937993
             stat err =       0.000297442474
             autocorr =       1.178423104466
              std dev =       0.548002268604
             le_variance =       0.300306486395

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300339649991
                                         uncertainty =       0.001472750844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300339649991
                                         uncertainty =       0.001472750844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274000464
  error estimate for blocks of size 2^( 2) =       0.000281172549
  error estimate for blocks of size 2^( 3) =       0.000287680288
  error estimate for blocks of size 2^( 4) =       0.000292789970
  error estimate for blocks of size 2^( 5) =       0.000296242677
  error estimate for blocks of size 2^( 6) =       0.000297620999
  error estimate for blocks of size 2^( 7) =       0.000298270257
  error estimate for blocks of size 2^( 8) =       0.000297633679

      target function =                  N/A
              le_mean =     -17.216545541652
             les_mean =     296.724293238377
             stat err =       0.000297441903
             autocorr =       1.178424345405
              std dev =       0.548000927710
             le_variance =       0.300305016771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300338357503
                                         uncertainty =       0.001472783408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300338357503
                                         uncertainty =       0.001472783408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273999874
  error estimate for blocks of size 2^( 2) =       0.000281171986
  error estimate for blocks of size 2^( 3) =       0.000287679748
  error estimate for blocks of size 2^( 4) =       0.000292789453
  error estimate for blocks of size 2^( 5) =       0.000296242149
  error estimate for blocks of size 2^( 6) =       0.000297620500
  error estimate for blocks of size 2^( 7) =       0.000298269758
  error estimate for blocks of size 2^( 8) =       0.000297633197

      target function =                  N/A
              le_mean =     -17.216545550291
             les_mean =     296.724292437850
             stat err =       0.000297441401
             autocorr =       1.178425438286
              std dev =       0.547999748802
             le_variance =       0.300303724687


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216545551543        initial  <--
     5.8208e+01     5.8208e+02             3.4406e-06       -17.216545532097
     2.3283e+02     2.3283e+03             8.6302e-07       -17.216545541652
     9.3132e+02     9.3132e+03             2.1594e-07       -17.216545550291

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5082
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -4.030641e-02 3 1  ON 0
ci_002                -3.032764e-02 3 1  ON 1
ci_003                -2.478950e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070324e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840515e-02 3 1  ON 6
ci_008                -1.783114e-02 3 1  ON 7
ci_009                -1.759019e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622370e-02 3 1  ON 10
ci_012                -1.603019e-02 3 1  ON 11
ci_013                -1.825620e-02 3 1  ON 12
ci_014                 1.327890e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631354e-02 3 1  ON 15
ci_017                 1.677236e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263524e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320675e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136010e-02 3 1  ON 22
ci_024                 1.165358e-02 3 1  ON 23
ci_025                 1.179717e-02 3 1  ON 24
ci_026                 1.142124e-02 3 1  ON 25
ci_027                 1.144133e-02 3 1  ON 26
ci_028                -1.449856e-02 3 1  ON 27
ci_029                -1.410787e-02 3 1  ON 28
ci_030                -1.085455e-02 3 1  ON 29
ci_031                -1.109282e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027220e-02 3 1  ON 32
ci_034                 9.855867e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932003e-03 3 1  ON 35
ci_037                -9.962098e-03 3 1  ON 36
ci_038                 1.657858e-03 3 1  ON 37
ci_039                 1.581814e-03 3 1  ON 38
ci_040                -4.174747e-03 3 1  ON 39
ci_041                 9.803577e-03 3 1  ON 40
ci_042                 9.866862e-03 3 1  ON 41
ci_043                -3.174810e-03 3 1  ON 42
ci_044                -1.473376e-02 3 1  ON 43
ci_045                -1.931610e-03 3 1  ON 44
ci_046                 5.506774e-03 3 1  ON 45
ci_047                 5.477873e-03 3 1  ON 46
ci_048                -1.205931e-02 3 1  ON 47
ci_049                -1.215520e-02 3 1  ON 48
ci_050                 7.413595e-03 3 1  ON 49
ci_051                 7.491285e-03 3 1  ON 50
ci_052                -6.506489e-03 3 1  ON 51
ci_053                -6.680534e-03 3 1  ON 52
ci_054                -2.939340e-03 3 1  ON 53
ci_055                -2.854653e-03 3 1  ON 54
ci_056                 4.448960e-03 3 1  ON 55
ci_057                 4.434839e-03 3 1  ON 56
ci_058                -6.886682e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748937e-03 3 1  ON 59
ci_061                 8.221358e-03 3 1  ON 60
ci_062                -3.151499e-03 3 1  ON 61
ci_063                -3.054759e-03 3 1  ON 62
ci_064                -2.939267e-03 3 1  ON 63
ci_065                -4.373171e-03 3 1  ON 64
ci_066                 5.644605e-03 3 1  ON 65
ci_067                 5.614084e-03 3 1  ON 66
ci_068                -4.811438e-03 3 1  ON 67
ci_069                -5.163973e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7647e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.1196
    reference variance = 0.229921
====================================================
  Execution time = 2.9591e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0551e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1578e-01
  Total weights = 3.913321585e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9020e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300558011345
                                         uncertainty =       0.001410761675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300558011345
                                         uncertainty =       0.001410761675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274134775
  error estimate for blocks of size 2^( 2) =       0.000280915459
  error estimate for blocks of size 2^( 3) =       0.000287253979
  error estimate for blocks of size 2^( 4) =       0.000292163422
  error estimate for blocks of size 2^( 5) =       0.000294879920
  error estimate for blocks of size 2^( 6) =       0.000296592386
  error estimate for blocks of size 2^( 7) =       0.000297415708
  error estimate for blocks of size 2^( 8) =       0.000296662404

      target function =                  N/A
              le_mean =     -17.216671374760
             les_mean =     296.729552594956
             stat err =       0.000296387605
             autocorr =       1.168938898457
              std dev =       0.548269550713
             le_variance =       0.300599500239


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721667137476e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216671374794       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216671380431       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216671379945       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+02 is 4.760072e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216671374794       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216671376204       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216671376082       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+03 is 1.190250e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216671374794       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216671375147       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216671375116       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+03 is 2.975770e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.380946 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4501e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -4.030643e-02 3 1  ON 0
ci_002                -3.032757e-02 3 1  ON 1
ci_003                -2.478949e-02 3 1  ON 2
ci_004                 2.145888e-02 3 1  ON 3
ci_005                 2.070323e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840521e-02 3 1  ON 6
ci_008                -1.783116e-02 3 1  ON 7
ci_009                -1.759016e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622366e-02 3 1  ON 10
ci_012                -1.603027e-02 3 1  ON 11
ci_013                -1.825632e-02 3 1  ON 12
ci_014                 1.327894e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631351e-02 3 1  ON 15
ci_017                 1.677234e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263524e-02 3 1  ON 18
ci_020                 1.333027e-02 3 1  ON 19
ci_021                 1.320668e-02 3 1  ON 20
ci_022                 1.135503e-02 3 1  ON 21
ci_023                 1.136011e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179714e-02 3 1  ON 24
ci_026                 1.142119e-02 3 1  ON 25
ci_027                 1.144132e-02 3 1  ON 26
ci_028                -1.449855e-02 3 1  ON 27
ci_029                -1.410797e-02 3 1  ON 28
ci_030                -1.085453e-02 3 1  ON 29
ci_031                -1.109279e-02 3 1  ON 30
ci_032                -1.367283e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855876e-03 3 1  ON 33
ci_035                -4.598826e-03 3 1  ON 34
ci_036                -9.932030e-03 3 1  ON 35
ci_037                -9.962093e-03 3 1  ON 36
ci_038                 1.657895e-03 3 1  ON 37
ci_039                 1.581824e-03 3 1  ON 38
ci_040                -4.174672e-03 3 1  ON 39
ci_041                 9.803579e-03 3 1  ON 40
ci_042                 9.866817e-03 3 1  ON 41
ci_043                -3.174794e-03 3 1  ON 42
ci_044                -1.473384e-02 3 1  ON 43
ci_045                -1.931501e-03 3 1  ON 44
ci_046                 5.506807e-03 3 1  ON 45
ci_047                 5.477890e-03 3 1  ON 46
ci_048                -1.205926e-02 3 1  ON 47
ci_049                -1.215517e-02 3 1  ON 48
ci_050                 7.413595e-03 3 1  ON 49
ci_051                 7.491257e-03 3 1  ON 50
ci_052                -6.506487e-03 3 1  ON 51
ci_053                -6.680549e-03 3 1  ON 52
ci_054                -2.939327e-03 3 1  ON 53
ci_055                -2.854686e-03 3 1  ON 54
ci_056                 4.448963e-03 3 1  ON 55
ci_057                 4.434873e-03 3 1  ON 56
ci_058                -6.886660e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748916e-03 3 1  ON 59
ci_061                 8.221470e-03 3 1  ON 60
ci_062                -3.151457e-03 3 1  ON 61
ci_063                -3.054756e-03 3 1  ON 62
ci_064                -2.939337e-03 3 1  ON 63
ci_065                -4.373064e-03 3 1  ON 64
ci_066                 5.644574e-03 3 1  ON 65
ci_067                 5.614012e-03 3 1  ON 66
ci_068                -4.811409e-03 3 1  ON 67
ci_069                -5.163925e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.2368
    reference variance = 0.449806
====================================================
  Execution time = 2.7291e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1116e-01
  Total weights = 3.9134e+06
  Execution time = 3.6323e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297096357571
                                         uncertainty =       0.001286342064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297096357571
                                         uncertainty =       0.001286342064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272517938
  error estimate for blocks of size 2^( 2) =       0.000279681369
  error estimate for blocks of size 2^( 3) =       0.000286315575
  error estimate for blocks of size 2^( 4) =       0.000291308051
  error estimate for blocks of size 2^( 5) =       0.000294280553
  error estimate for blocks of size 2^( 6) =       0.000296828181
  error estimate for blocks of size 2^( 7) =       0.000298383661
  error estimate for blocks of size 2^( 8) =       0.000298985490

      target function =                  N/A
              le_mean =     -17.216664009238
             les_mean =     296.724682325433
             stat err =       0.000297119472
             autocorr =       1.188699390287
              std dev =       0.545035875765
             le_variance =       0.297064105871

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297096368948
                                         uncertainty =       0.001286344740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297096368948
                                         uncertainty =       0.001286344740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272517943
  error estimate for blocks of size 2^( 2) =       0.000279681375
  error estimate for blocks of size 2^( 3) =       0.000286315583
  error estimate for blocks of size 2^( 4) =       0.000291308060
  error estimate for blocks of size 2^( 5) =       0.000294280566
  error estimate for blocks of size 2^( 6) =       0.000296828195
  error estimate for blocks of size 2^( 7) =       0.000298383685
  error estimate for blocks of size 2^( 8) =       0.000298985520

      target function =                  N/A
              le_mean =     -17.216664008316
             les_mean =     296.724682550536
             stat err =       0.000297119491
             autocorr =       1.188699502353
              std dev =       0.545035886324
             le_variance =       0.297064117381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297096363237
                                         uncertainty =       0.001286343403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297096363237
                                         uncertainty =       0.001286343403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272517941
  error estimate for blocks of size 2^( 2) =       0.000279681372
  error estimate for blocks of size 2^( 3) =       0.000286315579
  error estimate for blocks of size 2^( 4) =       0.000291308056
  error estimate for blocks of size 2^( 5) =       0.000294280559
  error estimate for blocks of size 2^( 6) =       0.000296828188
  error estimate for blocks of size 2^( 7) =       0.000298383673
  error estimate for blocks of size 2^( 8) =       0.000298985505

      target function =                  N/A
              le_mean =     -17.216664008775
             les_mean =     296.724682432925
             stat err =       0.000297119481
             autocorr =       1.188699446351
              std dev =       0.545035881024
             le_variance =       0.297064111604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297096358278
                                         uncertainty =       0.001286342232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297096358278
                                         uncertainty =       0.001286342232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272517938
  error estimate for blocks of size 2^( 2) =       0.000279681369
  error estimate for blocks of size 2^( 3) =       0.000286315576
  error estimate for blocks of size 2^( 4) =       0.000291308052
  error estimate for blocks of size 2^( 5) =       0.000294280554
  error estimate for blocks of size 2^( 6) =       0.000296828182
  error estimate for blocks of size 2^( 7) =       0.000298383663
  error estimate for blocks of size 2^( 8) =       0.000298985492

      target function =                  N/A
              le_mean =     -17.216664009180
             les_mean =     296.724682338307
             stat err =       0.000297119473
             autocorr =       1.188699397299
              std dev =       0.545035876421
             le_variance =       0.297064106586


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216664009238        initial  <--
     5.8208e+02     5.8208e+03             4.7601e-07       -17.216664008316
     2.3283e+03     2.3283e+04             1.1902e-07       -17.216664008775
     9.3132e+03     9.3132e+04             2.9758e-08       -17.216664009180

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.6279
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -4.030641e-02 3 1  ON 0
ci_002                -3.032764e-02 3 1  ON 1
ci_003                -2.478950e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070324e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840515e-02 3 1  ON 6
ci_008                -1.783114e-02 3 1  ON 7
ci_009                -1.759019e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622370e-02 3 1  ON 10
ci_012                -1.603019e-02 3 1  ON 11
ci_013                -1.825620e-02 3 1  ON 12
ci_014                 1.327890e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631354e-02 3 1  ON 15
ci_017                 1.677236e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263524e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320675e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136010e-02 3 1  ON 22
ci_024                 1.165358e-02 3 1  ON 23
ci_025                 1.179717e-02 3 1  ON 24
ci_026                 1.142124e-02 3 1  ON 25
ci_027                 1.144133e-02 3 1  ON 26
ci_028                -1.449856e-02 3 1  ON 27
ci_029                -1.410787e-02 3 1  ON 28
ci_030                -1.085455e-02 3 1  ON 29
ci_031                -1.109282e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027220e-02 3 1  ON 32
ci_034                 9.855867e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932003e-03 3 1  ON 35
ci_037                -9.962098e-03 3 1  ON 36
ci_038                 1.657858e-03 3 1  ON 37
ci_039                 1.581814e-03 3 1  ON 38
ci_040                -4.174747e-03 3 1  ON 39
ci_041                 9.803577e-03 3 1  ON 40
ci_042                 9.866862e-03 3 1  ON 41
ci_043                -3.174810e-03 3 1  ON 42
ci_044                -1.473376e-02 3 1  ON 43
ci_045                -1.931610e-03 3 1  ON 44
ci_046                 5.506774e-03 3 1  ON 45
ci_047                 5.477873e-03 3 1  ON 46
ci_048                -1.205931e-02 3 1  ON 47
ci_049                -1.215520e-02 3 1  ON 48
ci_050                 7.413595e-03 3 1  ON 49
ci_051                 7.491285e-03 3 1  ON 50
ci_052                -6.506489e-03 3 1  ON 51
ci_053                -6.680534e-03 3 1  ON 52
ci_054                -2.939340e-03 3 1  ON 53
ci_055                -2.854653e-03 3 1  ON 54
ci_056                 4.448960e-03 3 1  ON 55
ci_057                 4.434839e-03 3 1  ON 56
ci_058                -6.886682e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748937e-03 3 1  ON 59
ci_061                 8.221358e-03 3 1  ON 60
ci_062                -3.151499e-03 3 1  ON 61
ci_063                -3.054759e-03 3 1  ON 62
ci_064                -2.939267e-03 3 1  ON 63
ci_065                -4.373171e-03 3 1  ON 64
ci_066                 5.644605e-03 3 1  ON 65
ci_067                 5.614084e-03 3 1  ON 66
ci_068                -4.811438e-03 3 1  ON 67
ci_069                -5.163973e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0156e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.196
    reference variance = 0.274568
====================================================
  Execution time = 2.7233e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0590e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1772e-01
  Total weights = 3.913564642e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.0374e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301415610296
                                         uncertainty =       0.001520004818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301415610296
                                         uncertainty =       0.001520004818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274486935
  error estimate for blocks of size 2^( 2) =       0.000281464663
  error estimate for blocks of size 2^( 3) =       0.000288129471
  error estimate for blocks of size 2^( 4) =       0.000292924030
  error estimate for blocks of size 2^( 5) =       0.000295581792
  error estimate for blocks of size 2^( 6) =       0.000297637349
  error estimate for blocks of size 2^( 7) =       0.000298360667
  error estimate for blocks of size 2^( 8) =       0.000298062193

      target function =                  N/A
              le_mean =     -17.216363764331
             les_mean =     296.720900001307
             stat err =       0.000297410500
             autocorr =       1.174003088562
              std dev =       0.548973870130
             le_variance =       0.301372310085


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721636376433e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216363764358       residual = 8.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216363764710       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216363764714       residual = 8.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+03 is 5.132513e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216363764358       residual = 8.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216363764446       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216363764447       residual = 8.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+04 is 1.283177e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216363764358       residual = 8.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216363764380       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216363764380       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+04 is 3.207972e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.382019 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2280e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -4.030641e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478950e-02 3 1  ON 2
ci_004                 2.145895e-02 3 1  ON 3
ci_005                 2.070324e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759019e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622371e-02 3 1  ON 10
ci_012                -1.603018e-02 3 1  ON 11
ci_013                -1.825621e-02 3 1  ON 12
ci_014                 1.327891e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631353e-02 3 1  ON 15
ci_017                 1.677236e-02 3 1  ON 16
ci_018                 1.296350e-02 3 1  ON 17
ci_019                 1.263524e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320675e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136009e-02 3 1  ON 22
ci_024                 1.165357e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142123e-02 3 1  ON 25
ci_027                 1.144132e-02 3 1  ON 26
ci_028                -1.449856e-02 3 1  ON 27
ci_029                -1.410787e-02 3 1  ON 28
ci_030                -1.085456e-02 3 1  ON 29
ci_031                -1.109282e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027221e-02 3 1  ON 32
ci_034                 9.855877e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932011e-03 3 1  ON 35
ci_037                -9.962103e-03 3 1  ON 36
ci_038                 1.657856e-03 3 1  ON 37
ci_039                 1.581814e-03 3 1  ON 38
ci_040                -4.174740e-03 3 1  ON 39
ci_041                 9.803580e-03 3 1  ON 40
ci_042                 9.866870e-03 3 1  ON 41
ci_043                -3.174810e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931605e-03 3 1  ON 44
ci_046                 5.506775e-03 3 1  ON 45
ci_047                 5.477874e-03 3 1  ON 46
ci_048                -1.205930e-02 3 1  ON 47
ci_049                -1.215520e-02 3 1  ON 48
ci_050                 7.413596e-03 3 1  ON 49
ci_051                 7.491288e-03 3 1  ON 50
ci_052                -6.506495e-03 3 1  ON 51
ci_053                -6.680531e-03 3 1  ON 52
ci_054                -2.939342e-03 3 1  ON 53
ci_055                -2.854657e-03 3 1  ON 54
ci_056                 4.448958e-03 3 1  ON 55
ci_057                 4.434840e-03 3 1  ON 56
ci_058                -6.886669e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748937e-03 3 1  ON 59
ci_061                 8.221360e-03 3 1  ON 60
ci_062                -3.151498e-03 3 1  ON 61
ci_063                -3.054761e-03 3 1  ON 62
ci_064                -2.939271e-03 3 1  ON 63
ci_065                -4.373161e-03 3 1  ON 64
ci_066                 5.644612e-03 3 1  ON 65
ci_067                 5.614092e-03 3 1  ON 66
ci_068                -4.811436e-03 3 1  ON 67
ci_069                -5.163968e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.1783
    reference variance = 0.13426
====================================================
  Execution time = 2.7137e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1258e-01
  Total weights = 3.9134e+06
  Execution time = 3.6460e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298439460257
                                         uncertainty =       0.001415738266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298439460257
                                         uncertainty =       0.001415738266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273124128
  error estimate for blocks of size 2^( 2) =       0.000280158198
  error estimate for blocks of size 2^( 3) =       0.000286433496
  error estimate for blocks of size 2^( 4) =       0.000291236624
  error estimate for blocks of size 2^( 5) =       0.000294555604
  error estimate for blocks of size 2^( 6) =       0.000296113173
  error estimate for blocks of size 2^( 7) =       0.000296858850
  error estimate for blocks of size 2^( 8) =       0.000297540115

      target function =                  N/A
              le_mean =     -17.216506433612
             les_mean =     296.720677967814
             stat err =       0.000296266935
             autocorr =       1.176647112966
              std dev =       0.546248256928
             le_variance =       0.298387158197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298439444190
                                         uncertainty =       0.001415738192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298439444190
                                         uncertainty =       0.001415738192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273124121
  error estimate for blocks of size 2^( 2) =       0.000280158191
  error estimate for blocks of size 2^( 3) =       0.000286433488
  error estimate for blocks of size 2^( 4) =       0.000291236616
  error estimate for blocks of size 2^( 5) =       0.000294555595
  error estimate for blocks of size 2^( 6) =       0.000296113163
  error estimate for blocks of size 2^( 7) =       0.000296858841
  error estimate for blocks of size 2^( 8) =       0.000297540105

      target function =                  N/A
              le_mean =     -17.216506433685
             les_mean =     296.720677901721
             stat err =       0.000296266926
             autocorr =       1.176647099696
              std dev =       0.546248242228
             le_variance =       0.298387142137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298439452223
                                         uncertainty =       0.001415738229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298439452223
                                         uncertainty =       0.001415738229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273124125
  error estimate for blocks of size 2^( 2) =       0.000280158195
  error estimate for blocks of size 2^( 3) =       0.000286433492
  error estimate for blocks of size 2^( 4) =       0.000291236620
  error estimate for blocks of size 2^( 5) =       0.000294555600
  error estimate for blocks of size 2^( 6) =       0.000296113168
  error estimate for blocks of size 2^( 7) =       0.000296858845
  error estimate for blocks of size 2^( 8) =       0.000297540110

      target function =                  N/A
              le_mean =     -17.216506433648
             les_mean =     296.720677934738
             stat err =       0.000296266931
             autocorr =       1.176647106361
              std dev =       0.546248249577
             le_variance =       0.298387150166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298439459253
                                         uncertainty =       0.001415738262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298439459253
                                         uncertainty =       0.001415738262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273124128
  error estimate for blocks of size 2^( 2) =       0.000280158198
  error estimate for blocks of size 2^( 3) =       0.000286433495
  error estimate for blocks of size 2^( 4) =       0.000291236624
  error estimate for blocks of size 2^( 5) =       0.000294555604
  error estimate for blocks of size 2^( 6) =       0.000296113172
  error estimate for blocks of size 2^( 7) =       0.000296858849
  error estimate for blocks of size 2^( 8) =       0.000297540114

      target function =                  N/A
              le_mean =     -17.216506433616
             les_mean =     296.720677963676
             stat err =       0.000296266935
             autocorr =       1.176647112143
              std dev =       0.546248256009
             le_variance =       0.298387157193


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216506433612        initial
     5.8208e+03     5.8208e+04             5.1325e-08       -17.216506433685  <--
     2.3283e+04     2.3283e+05             1.2832e-08       -17.216506433648
     9.3132e+04     9.3132e+05             3.2080e-09       -17.216506433616

*****************************************************************************
Applying the update for shift_i =   5.8208e+03     and shift_s =   5.8208e+04
*****************************************************************************

  Execution time = 4.5545e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032766e-02 3 1  ON 1
ci_003                -2.478950e-02 3 1  ON 2
ci_004                 2.145896e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783112e-02 3 1  ON 7
ci_009                -1.759019e-02 3 1  ON 8
ci_010                -1.748759e-02 3 1  ON 9
ci_011                -1.622374e-02 3 1  ON 10
ci_012                -1.603016e-02 3 1  ON 11
ci_013                -1.825623e-02 3 1  ON 12
ci_014                 1.327894e-02 3 1  ON 13
ci_015                 1.384328e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677236e-02 3 1  ON 16
ci_018                 1.296350e-02 3 1  ON 17
ci_019                 1.263524e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320675e-02 3 1  ON 20
ci_022                 1.135497e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179719e-02 3 1  ON 24
ci_026                 1.142122e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410787e-02 3 1  ON 28
ci_030                -1.085457e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367283e-02 3 1  ON 31
ci_033                 1.027221e-02 3 1  ON 32
ci_034                 9.855907e-03 3 1  ON 33
ci_035                -4.598836e-03 3 1  ON 34
ci_036                -9.932033e-03 3 1  ON 35
ci_037                -9.962118e-03 3 1  ON 36
ci_038                 1.657849e-03 3 1  ON 37
ci_039                 1.581815e-03 3 1  ON 38
ci_040                -4.174720e-03 3 1  ON 39
ci_041                 9.803590e-03 3 1  ON 40
ci_042                 9.866894e-03 3 1  ON 41
ci_043                -3.174809e-03 3 1  ON 42
ci_044                -1.473374e-02 3 1  ON 43
ci_045                -1.931590e-03 3 1  ON 44
ci_046                 5.506777e-03 3 1  ON 45
ci_047                 5.477877e-03 3 1  ON 46
ci_048                -1.205930e-02 3 1  ON 47
ci_049                -1.215520e-02 3 1  ON 48
ci_050                 7.413601e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506515e-03 3 1  ON 51
ci_053                -6.680524e-03 3 1  ON 52
ci_054                -2.939346e-03 3 1  ON 53
ci_055                -2.854670e-03 3 1  ON 54
ci_056                 4.448954e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886631e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748936e-03 3 1  ON 59
ci_061                 8.221367e-03 3 1  ON 60
ci_062                -3.151495e-03 3 1  ON 61
ci_063                -3.054765e-03 3 1  ON 62
ci_064                -2.939284e-03 3 1  ON 63
ci_065                -4.373134e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614116e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163956e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7833e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2137
    reference variance = 0.212438
====================================================
  Execution time = 2.7253e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0593e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1875e-01
  Total weights = 3.913953138e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9933e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303786221609
                                         uncertainty =       0.003210554482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303786221609
                                         uncertainty =       0.003210554482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275588352
  error estimate for blocks of size 2^( 2) =       0.000282717221
  error estimate for blocks of size 2^( 3) =       0.000289223424
  error estimate for blocks of size 2^( 4) =       0.000294077119
  error estimate for blocks of size 2^( 5) =       0.000297121318
  error estimate for blocks of size 2^( 6) =       0.000298551470
  error estimate for blocks of size 2^( 7) =       0.000299550505
  error estimate for blocks of size 2^( 8) =       0.000300398270

      target function =                  N/A
              le_mean =     -17.216504759243
             les_mean =     296.726785375225
             stat err =       0.000298905391
             autocorr =       1.176374984907
              std dev =       0.551176703301
             le_variance =       0.303795758262


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650475924e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216504759268       residual = 7.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216504762821       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216504762985       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216504762951       residual = 2.50e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+03 is 1.591398e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216504759268       residual = 7.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216504760157       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216504760198       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216504760189       residual = 2.51e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+03 is 3.979066e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216504759268       residual = 7.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216504759490       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216504759501       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216504759498       residual = 2.51e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+04 is 9.948021e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.383366 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2257e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -4.030637e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478951e-02 3 1  ON 2
ci_004                 2.145896e-02 3 1  ON 3
ci_005                 2.070328e-02 3 1  ON 4
ci_006                -1.872876e-02 3 1  ON 5
ci_007                -1.840517e-02 3 1  ON 6
ci_008                -1.783115e-02 3 1  ON 7
ci_009                -1.759016e-02 3 1  ON 8
ci_010                -1.748759e-02 3 1  ON 9
ci_011                -1.622375e-02 3 1  ON 10
ci_012                -1.603016e-02 3 1  ON 11
ci_013                -1.825626e-02 3 1  ON 12
ci_014                 1.327892e-02 3 1  ON 13
ci_015                 1.384329e-02 3 1  ON 14
ci_016                 1.631354e-02 3 1  ON 15
ci_017                 1.677234e-02 3 1  ON 16
ci_018                 1.296347e-02 3 1  ON 17
ci_019                 1.263524e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320672e-02 3 1  ON 20
ci_022                 1.135499e-02 3 1  ON 21
ci_023                 1.136007e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179719e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144127e-02 3 1  ON 26
ci_028                -1.449851e-02 3 1  ON 27
ci_029                -1.410787e-02 3 1  ON 28
ci_030                -1.085459e-02 3 1  ON 29
ci_031                -1.109280e-02 3 1  ON 30
ci_032                -1.367279e-02 3 1  ON 31
ci_033                 1.027225e-02 3 1  ON 32
ci_034                 9.855933e-03 3 1  ON 33
ci_035                -4.598818e-03 3 1  ON 34
ci_036                -9.932043e-03 3 1  ON 35
ci_037                -9.962131e-03 3 1  ON 36
ci_038                 1.657833e-03 3 1  ON 37
ci_039                 1.581820e-03 3 1  ON 38
ci_040                -4.174697e-03 3 1  ON 39
ci_041                 9.803602e-03 3 1  ON 40
ci_042                 9.866868e-03 3 1  ON 41
ci_043                -3.174802e-03 3 1  ON 42
ci_044                -1.473376e-02 3 1  ON 43
ci_045                -1.931579e-03 3 1  ON 44
ci_046                 5.506783e-03 3 1  ON 45
ci_047                 5.477888e-03 3 1  ON 46
ci_048                -1.205928e-02 3 1  ON 47
ci_049                -1.215518e-02 3 1  ON 48
ci_050                 7.413613e-03 3 1  ON 49
ci_051                 7.491275e-03 3 1  ON 50
ci_052                -6.506520e-03 3 1  ON 51
ci_053                -6.680510e-03 3 1  ON 52
ci_054                -2.939314e-03 3 1  ON 53
ci_055                -2.854679e-03 3 1  ON 54
ci_056                 4.448940e-03 3 1  ON 55
ci_057                 4.434837e-03 3 1  ON 56
ci_058                -6.886617e-03 3 1  ON 57
ci_059                -6.780663e-03 3 1  ON 58
ci_060                 8.748913e-03 3 1  ON 59
ci_061                 8.221363e-03 3 1  ON 60
ci_062                -3.151518e-03 3 1  ON 61
ci_063                -3.054750e-03 3 1  ON 62
ci_064                -2.939299e-03 3 1  ON 63
ci_065                -4.373116e-03 3 1  ON 64
ci_066                 5.644637e-03 3 1  ON 65
ci_067                 5.614107e-03 3 1  ON 66
ci_068                -4.811428e-03 3 1  ON 67
ci_069                -5.163951e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2779
    reference variance = 0.320004
====================================================
  Execution time = 2.7340e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1559e-01
  Total weights = 3.9137e+06
  Execution time = 3.6397e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299714208140
                                         uncertainty =       0.001420538256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299714208140
                                         uncertainty =       0.001420538256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273727827
  error estimate for blocks of size 2^( 2) =       0.000280700784
  error estimate for blocks of size 2^( 3) =       0.000287034180
  error estimate for blocks of size 2^( 4) =       0.000291528019
  error estimate for blocks of size 2^( 5) =       0.000294032083
  error estimate for blocks of size 2^( 6) =       0.000295353320
  error estimate for blocks of size 2^( 7) =       0.000296616944
  error estimate for blocks of size 2^( 8) =       0.000298738242

      target function =                  N/A
              le_mean =     -17.216749913317
             les_mean =     296.732063845390
             stat err =       0.000296185147
             autocorr =       1.170816012905
              std dev =       0.547455653570
             le_variance =       0.299707692626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299714178512
                                         uncertainty =       0.001420537699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299714178512
                                         uncertainty =       0.001420537699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273727813
  error estimate for blocks of size 2^( 2) =       0.000280700771
  error estimate for blocks of size 2^( 3) =       0.000287034167
  error estimate for blocks of size 2^( 4) =       0.000291528006
  error estimate for blocks of size 2^( 5) =       0.000294032071
  error estimate for blocks of size 2^( 6) =       0.000295353308
  error estimate for blocks of size 2^( 7) =       0.000296616928
  error estimate for blocks of size 2^( 8) =       0.000298738234

      target function =                  N/A
              le_mean =     -17.216749912935
             les_mean =     296.732063278951
             stat err =       0.000296185135
             autocorr =       1.170816034032
              std dev =       0.547455626557
             le_variance =       0.299707663049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299714193320
                                         uncertainty =       0.001420537978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299714193320
                                         uncertainty =       0.001420537978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273727820
  error estimate for blocks of size 2^( 2) =       0.000280700778
  error estimate for blocks of size 2^( 3) =       0.000287034174
  error estimate for blocks of size 2^( 4) =       0.000291528013
  error estimate for blocks of size 2^( 5) =       0.000294032077
  error estimate for blocks of size 2^( 6) =       0.000295353314
  error estimate for blocks of size 2^( 7) =       0.000296616936
  error estimate for blocks of size 2^( 8) =       0.000298738238

      target function =                  N/A
              le_mean =     -17.216749913125
             les_mean =     296.732063561786
             stat err =       0.000296185141
             autocorr =       1.170816023480
              std dev =       0.547455640059
             le_variance =       0.299707677832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299714206287
                                         uncertainty =       0.001420538221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299714206287
                                         uncertainty =       0.001420538221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273727826
  error estimate for blocks of size 2^( 2) =       0.000280700784
  error estimate for blocks of size 2^( 3) =       0.000287034179
  error estimate for blocks of size 2^( 4) =       0.000291528018
  error estimate for blocks of size 2^( 5) =       0.000294032082
  error estimate for blocks of size 2^( 6) =       0.000295353319
  error estimate for blocks of size 2^( 7) =       0.000296616943
  error estimate for blocks of size 2^( 8) =       0.000298738242

      target function =                  N/A
              le_mean =     -17.216749913293
             les_mean =     296.732063809900
             stat err =       0.000296185146
             autocorr =       1.170816014234
              std dev =       0.547455651881
             le_variance =       0.299707690776


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216749913317        initial  <--
     1.4552e+03     1.4552e+04             1.5914e-07       -17.216749912935
     5.8208e+03     5.8208e+04             3.9791e-08       -17.216749913125
     2.3283e+04     2.3283e+05             9.9480e-09       -17.216749913293

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.7115
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032766e-02 3 1  ON 1
ci_003                -2.478950e-02 3 1  ON 2
ci_004                 2.145896e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783112e-02 3 1  ON 7
ci_009                -1.759019e-02 3 1  ON 8
ci_010                -1.748759e-02 3 1  ON 9
ci_011                -1.622374e-02 3 1  ON 10
ci_012                -1.603016e-02 3 1  ON 11
ci_013                -1.825623e-02 3 1  ON 12
ci_014                 1.327894e-02 3 1  ON 13
ci_015                 1.384328e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677236e-02 3 1  ON 16
ci_018                 1.296350e-02 3 1  ON 17
ci_019                 1.263524e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320675e-02 3 1  ON 20
ci_022                 1.135497e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179719e-02 3 1  ON 24
ci_026                 1.142122e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410787e-02 3 1  ON 28
ci_030                -1.085457e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367283e-02 3 1  ON 31
ci_033                 1.027221e-02 3 1  ON 32
ci_034                 9.855907e-03 3 1  ON 33
ci_035                -4.598836e-03 3 1  ON 34
ci_036                -9.932033e-03 3 1  ON 35
ci_037                -9.962118e-03 3 1  ON 36
ci_038                 1.657849e-03 3 1  ON 37
ci_039                 1.581815e-03 3 1  ON 38
ci_040                -4.174720e-03 3 1  ON 39
ci_041                 9.803590e-03 3 1  ON 40
ci_042                 9.866894e-03 3 1  ON 41
ci_043                -3.174809e-03 3 1  ON 42
ci_044                -1.473374e-02 3 1  ON 43
ci_045                -1.931590e-03 3 1  ON 44
ci_046                 5.506777e-03 3 1  ON 45
ci_047                 5.477877e-03 3 1  ON 46
ci_048                -1.205930e-02 3 1  ON 47
ci_049                -1.215520e-02 3 1  ON 48
ci_050                 7.413601e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506515e-03 3 1  ON 51
ci_053                -6.680524e-03 3 1  ON 52
ci_054                -2.939346e-03 3 1  ON 53
ci_055                -2.854670e-03 3 1  ON 54
ci_056                 4.448954e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886631e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748936e-03 3 1  ON 59
ci_061                 8.221367e-03 3 1  ON 60
ci_062                -3.151495e-03 3 1  ON 61
ci_063                -3.054765e-03 3 1  ON 62
ci_064                -2.939284e-03 3 1  ON 63
ci_065                -4.373134e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614116e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163956e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7976e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.2479
    reference variance = 0.409849
====================================================
  Execution time = 2.7365e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0586e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1244e-01
  Total weights = 3.913476877e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9746e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298750535266
                                         uncertainty =       0.001368887994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298750535266
                                         uncertainty =       0.001368887994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273297400
  error estimate for blocks of size 2^( 2) =       0.000280322333
  error estimate for blocks of size 2^( 3) =       0.000286709624
  error estimate for blocks of size 2^( 4) =       0.000291879587
  error estimate for blocks of size 2^( 5) =       0.000294775031
  error estimate for blocks of size 2^( 6) =       0.000296318835
  error estimate for blocks of size 2^( 7) =       0.000297126032
  error estimate for blocks of size 2^( 8) =       0.000297944201

      target function =                  N/A
              le_mean =     -17.216182016800
             les_mean =     296.709364993940
             stat err =       0.000296541025
             autocorr =       1.177330964923
              std dev =       0.546594800959
             le_variance =       0.298765876435


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721618201680e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216182016825       residual = 8.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216182016834       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216182016833       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216182016833       residual = 1.33e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+04 is 1.963109e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216182016825       residual = 8.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216182016827       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216182016827       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216182016827       residual = 1.33e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+04 is 4.907830e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216182016825       residual = 8.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216182016826       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216182016826       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216182016826       residual = 1.33e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+05 is 1.226961e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.384674 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2353e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032766e-02 3 1  ON 1
ci_003                -2.478950e-02 3 1  ON 2
ci_004                 2.145896e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622374e-02 3 1  ON 10
ci_012                -1.603016e-02 3 1  ON 11
ci_013                -1.825624e-02 3 1  ON 12
ci_014                 1.327894e-02 3 1  ON 13
ci_015                 1.384328e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677236e-02 3 1  ON 16
ci_018                 1.296350e-02 3 1  ON 17
ci_019                 1.263524e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320675e-02 3 1  ON 20
ci_022                 1.135497e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179719e-02 3 1  ON 24
ci_026                 1.142122e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410787e-02 3 1  ON 28
ci_030                -1.085457e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367283e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855904e-03 3 1  ON 33
ci_035                -4.598836e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962118e-03 3 1  ON 36
ci_038                 1.657849e-03 3 1  ON 37
ci_039                 1.581814e-03 3 1  ON 38
ci_040                -4.174720e-03 3 1  ON 39
ci_041                 9.803588e-03 3 1  ON 40
ci_042                 9.866895e-03 3 1  ON 41
ci_043                -3.174806e-03 3 1  ON 42
ci_044                -1.473374e-02 3 1  ON 43
ci_045                -1.931587e-03 3 1  ON 44
ci_046                 5.506779e-03 3 1  ON 45
ci_047                 5.477877e-03 3 1  ON 46
ci_048                -1.205930e-02 3 1  ON 47
ci_049                -1.215520e-02 3 1  ON 48
ci_050                 7.413602e-03 3 1  ON 49
ci_051                 7.491296e-03 3 1  ON 50
ci_052                -6.506518e-03 3 1  ON 51
ci_053                -6.680524e-03 3 1  ON 52
ci_054                -2.939347e-03 3 1  ON 53
ci_055                -2.854674e-03 3 1  ON 54
ci_056                 4.448956e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886630e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748937e-03 3 1  ON 59
ci_061                 8.221369e-03 3 1  ON 60
ci_062                -3.151496e-03 3 1  ON 61
ci_063                -3.054764e-03 3 1  ON 62
ci_064                -2.939286e-03 3 1  ON 63
ci_065                -4.373131e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614119e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163957e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.1064
    reference variance = 0.166852
====================================================
  Execution time = 2.7389e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1690e-01
  Total weights = 3.9134e+06
  Execution time = 3.6405e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301927181413
                                         uncertainty =       0.001813194253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301927181413
                                         uncertainty =       0.001813194253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274710014
  error estimate for blocks of size 2^( 2) =       0.000281832107
  error estimate for blocks of size 2^( 3) =       0.000288122224
  error estimate for blocks of size 2^( 4) =       0.000292762734
  error estimate for blocks of size 2^( 5) =       0.000295180431
  error estimate for blocks of size 2^( 6) =       0.000297014651
  error estimate for blocks of size 2^( 7) =       0.000297652651
  error estimate for blocks of size 2^( 8) =       0.000296987591

      target function =                  N/A
              le_mean =     -17.216509058782
             les_mean =     296.725085485789
             stat err =       0.000296708831
             autocorr =       1.166573116764
              std dev =       0.549420027569
             le_variance =       0.301862366694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301927194077
                                         uncertainty =       0.001813194550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301927194077
                                         uncertainty =       0.001813194550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274710020
  error estimate for blocks of size 2^( 2) =       0.000281832112
  error estimate for blocks of size 2^( 3) =       0.000288122230
  error estimate for blocks of size 2^( 4) =       0.000292762740
  error estimate for blocks of size 2^( 5) =       0.000295180437
  error estimate for blocks of size 2^( 6) =       0.000297014656
  error estimate for blocks of size 2^( 7) =       0.000297652656
  error estimate for blocks of size 2^( 8) =       0.000296987597

      target function =                  N/A
              le_mean =     -17.216509058842
             les_mean =     296.725085507863
             stat err =       0.000296708836
             autocorr =       1.166573108649
              std dev =       0.549420039079
             le_variance =       0.301862379342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301927187745
                                         uncertainty =       0.001813194401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301927187745
                                         uncertainty =       0.001813194401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274710017
  error estimate for blocks of size 2^( 2) =       0.000281832109
  error estimate for blocks of size 2^( 3) =       0.000288122227
  error estimate for blocks of size 2^( 4) =       0.000292762737
  error estimate for blocks of size 2^( 5) =       0.000295180434
  error estimate for blocks of size 2^( 6) =       0.000297014654
  error estimate for blocks of size 2^( 7) =       0.000297652654
  error estimate for blocks of size 2^( 8) =       0.000296987594

      target function =                  N/A
              le_mean =     -17.216509058812
             les_mean =     296.725085496822
             stat err =       0.000296708834
             autocorr =       1.166573112708
              std dev =       0.549420033324
             le_variance =       0.301862373018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301927182205
                                         uncertainty =       0.001813194271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301927182205
                                         uncertainty =       0.001813194271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274710014
  error estimate for blocks of size 2^( 2) =       0.000281832107
  error estimate for blocks of size 2^( 3) =       0.000288122225
  error estimate for blocks of size 2^( 4) =       0.000292762735
  error estimate for blocks of size 2^( 5) =       0.000295180432
  error estimate for blocks of size 2^( 6) =       0.000297014651
  error estimate for blocks of size 2^( 7) =       0.000297652651
  error estimate for blocks of size 2^( 8) =       0.000296987592

      target function =                  N/A
              le_mean =     -17.216509058786
             les_mean =     296.725085487167
             stat err =       0.000296708831
             autocorr =       1.166573116268
              std dev =       0.549420028289
             le_variance =       0.301862367485


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216509058782        initial
     1.4552e+04     1.4552e+05             1.9631e-08       -17.216509058842  <--
     5.8208e+04     5.8208e+05             4.9078e-09       -17.216509058812
     2.3283e+05     2.3283e+06             1.2270e-09       -17.216509058786

*****************************************************************************
Applying the update for shift_i =   1.4552e+04     and shift_s =   1.4552e+05
*****************************************************************************

  Execution time = 4.5854e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478951e-02 3 1  ON 2
ci_004                 2.145895e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622374e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142122e-02 3 1  ON 25
ci_027                 1.144131e-02 3 1  ON 26
ci_028                -1.449853e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085457e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855897e-03 3 1  ON 33
ci_035                -4.598836e-03 3 1  ON 34
ci_036                -9.932029e-03 3 1  ON 35
ci_037                -9.962119e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174717e-03 3 1  ON 39
ci_041                 9.803584e-03 3 1  ON 40
ci_042                 9.866898e-03 3 1  ON 41
ci_043                -3.174799e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931580e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491292e-03 3 1  ON 50
ci_052                -6.506525e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939351e-03 3 1  ON 53
ci_055                -2.854686e-03 3 1  ON 54
ci_056                 4.448960e-03 3 1  ON 55
ci_057                 4.434845e-03 3 1  ON 56
ci_058                -6.886627e-03 3 1  ON 57
ci_059                -6.780674e-03 3 1  ON 58
ci_060                 8.748940e-03 3 1  ON 59
ci_061                 8.221372e-03 3 1  ON 60
ci_062                -3.151500e-03 3 1  ON 61
ci_063                -3.054763e-03 3 1  ON 62
ci_064                -2.939292e-03 3 1  ON 63
ci_065                -4.373122e-03 3 1  ON 64
ci_066                 5.644632e-03 3 1  ON 65
ci_067                 5.614126e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163963e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8215e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2523
    reference variance = 0.555421
====================================================
  Execution time = 2.9526e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0590e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1506e-01
  Total weights = 3.913417007e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9090e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300494457793
                                         uncertainty =       0.001362261066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300494457793
                                         uncertainty =       0.001362261066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274074403
  error estimate for blocks of size 2^( 2) =       0.000281240709
  error estimate for blocks of size 2^( 3) =       0.000287786062
  error estimate for blocks of size 2^( 4) =       0.000292538980
  error estimate for blocks of size 2^( 5) =       0.000295843447
  error estimate for blocks of size 2^( 6) =       0.000297528189
  error estimate for blocks of size 2^( 7) =       0.000298088878
  error estimate for blocks of size 2^( 8) =       0.000298787834

      target function =                  N/A
              le_mean =     -17.216259424045
             les_mean =     296.714648338728
             stat err =       0.000297562087
             autocorr =       1.178740588653
              std dev =       0.548148806246
             le_variance =       0.300467113789


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721625942405e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216259424063       residual = 9.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216259425215       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216259425236       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216259425237       residual = 2.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+03 is 8.787193e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216259424063       residual = 9.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216259424351       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216259424357       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216259424357       residual = 2.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+04 is 2.196872e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216259424063       residual = 9.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216259424135       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216259424137       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216259424071       residual = 2.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+04 is 5.492226e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.385998 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4445e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -4.030640e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145892e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872873e-02 3 1  ON 5
ci_007                -1.840517e-02 3 1  ON 6
ci_008                -1.783112e-02 3 1  ON 7
ci_009                -1.759021e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622376e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825626e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384326e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677234e-02 3 1  ON 16
ci_018                 1.296348e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333033e-02 3 1  ON 19
ci_021                 1.320675e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136009e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179719e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449853e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367283e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855896e-03 3 1  ON 33
ci_035                -4.598842e-03 3 1  ON 34
ci_036                -9.932034e-03 3 1  ON 35
ci_037                -9.962123e-03 3 1  ON 36
ci_038                 1.657848e-03 3 1  ON 37
ci_039                 1.581817e-03 3 1  ON 38
ci_040                -4.174701e-03 3 1  ON 39
ci_041                 9.803584e-03 3 1  ON 40
ci_042                 9.866890e-03 3 1  ON 41
ci_043                -3.174798e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931572e-03 3 1  ON 44
ci_046                 5.506787e-03 3 1  ON 45
ci_047                 5.477885e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215518e-02 3 1  ON 48
ci_050                 7.413609e-03 3 1  ON 49
ci_051                 7.491300e-03 3 1  ON 50
ci_052                -6.506530e-03 3 1  ON 51
ci_053                -6.680528e-03 3 1  ON 52
ci_054                -2.939350e-03 3 1  ON 53
ci_055                -2.854696e-03 3 1  ON 54
ci_056                 4.448957e-03 3 1  ON 55
ci_057                 4.434843e-03 3 1  ON 56
ci_058                -6.886637e-03 3 1  ON 57
ci_059                -6.780663e-03 3 1  ON 58
ci_060                 8.748924e-03 3 1  ON 59
ci_061                 8.221372e-03 3 1  ON 60
ci_062                -3.151488e-03 3 1  ON 61
ci_063                -3.054760e-03 3 1  ON 62
ci_064                -2.939294e-03 3 1  ON 63
ci_065                -4.373114e-03 3 1  ON 64
ci_066                 5.644635e-03 3 1  ON 65
ci_067                 5.614131e-03 3 1  ON 66
ci_068                -4.811435e-03 3 1  ON 67
ci_069                -5.163970e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2529
    reference variance = 0.172711
====================================================
  Execution time = 2.6974e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1394e-01
  Total weights = 3.9135e+06
  Execution time = 3.6297e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299788680602
                                         uncertainty =       0.001360694818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299788680602
                                         uncertainty =       0.001360694818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273753831
  error estimate for blocks of size 2^( 2) =       0.000280784786
  error estimate for blocks of size 2^( 3) =       0.000287454580
  error estimate for blocks of size 2^( 4) =       0.000291794156
  error estimate for blocks of size 2^( 5) =       0.000294560414
  error estimate for blocks of size 2^( 6) =       0.000296008615
  error estimate for blocks of size 2^( 7) =       0.000297115342
  error estimate for blocks of size 2^( 8) =       0.000298892945

      target function =                  N/A
              le_mean =     -17.216723358247
             les_mean =     296.729506910764
             stat err =       0.000296644329
             autocorr =       1.174225988657
              std dev =       0.547507662438
             le_variance =       0.299764640428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299788672644
                                         uncertainty =       0.001360694665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299788672644
                                         uncertainty =       0.001360694665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273753828
  error estimate for blocks of size 2^( 2) =       0.000280784783
  error estimate for blocks of size 2^( 3) =       0.000287454577
  error estimate for blocks of size 2^( 4) =       0.000291794153
  error estimate for blocks of size 2^( 5) =       0.000294560410
  error estimate for blocks of size 2^( 6) =       0.000296008611
  error estimate for blocks of size 2^( 7) =       0.000297115338
  error estimate for blocks of size 2^( 8) =       0.000298892940

      target function =                  N/A
              le_mean =     -17.216723357952
             les_mean =     296.729506845616
             stat err =       0.000296644325
             autocorr =       1.174225988418
              std dev =       0.547507655081
             le_variance =       0.299764632372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299788676622
                                         uncertainty =       0.001360694741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299788676622
                                         uncertainty =       0.001360694741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273753829
  error estimate for blocks of size 2^( 2) =       0.000280784784
  error estimate for blocks of size 2^( 3) =       0.000287454579
  error estimate for blocks of size 2^( 4) =       0.000291794155
  error estimate for blocks of size 2^( 5) =       0.000294560412
  error estimate for blocks of size 2^( 6) =       0.000296008613
  error estimate for blocks of size 2^( 7) =       0.000297115340
  error estimate for blocks of size 2^( 8) =       0.000298892943

      target function =                  N/A
              le_mean =     -17.216723358100
             les_mean =     296.729506878174
             stat err =       0.000296644327
             autocorr =       1.174225988545
              std dev =       0.547507658759
             le_variance =       0.299764636399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299788680104
                                         uncertainty =       0.001360694809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299788680104
                                         uncertainty =       0.001360694809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273753831
  error estimate for blocks of size 2^( 2) =       0.000280784786
  error estimate for blocks of size 2^( 3) =       0.000287454580
  error estimate for blocks of size 2^( 4) =       0.000291794156
  error estimate for blocks of size 2^( 5) =       0.000294560413
  error estimate for blocks of size 2^( 6) =       0.000296008614
  error estimate for blocks of size 2^( 7) =       0.000297115342
  error estimate for blocks of size 2^( 8) =       0.000298892945

      target function =                  N/A
              le_mean =     -17.216723358229
             les_mean =     296.729506906689
             stat err =       0.000296644329
             autocorr =       1.174225988632
              std dev =       0.547507661978
             le_variance =       0.299764639925


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216723358247        initial  <--
     3.6380e+03     3.6380e+04             8.7872e-08       -17.216723357952
     1.4552e+04     1.4552e+05             2.1969e-08       -17.216723358100
     5.8208e+04     5.8208e+05             5.4922e-09       -17.216723358229

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.2855
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478951e-02 3 1  ON 2
ci_004                 2.145895e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622374e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142122e-02 3 1  ON 25
ci_027                 1.144131e-02 3 1  ON 26
ci_028                -1.449853e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085457e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855897e-03 3 1  ON 33
ci_035                -4.598836e-03 3 1  ON 34
ci_036                -9.932029e-03 3 1  ON 35
ci_037                -9.962119e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174717e-03 3 1  ON 39
ci_041                 9.803584e-03 3 1  ON 40
ci_042                 9.866898e-03 3 1  ON 41
ci_043                -3.174799e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931580e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491292e-03 3 1  ON 50
ci_052                -6.506525e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939351e-03 3 1  ON 53
ci_055                -2.854686e-03 3 1  ON 54
ci_056                 4.448960e-03 3 1  ON 55
ci_057                 4.434845e-03 3 1  ON 56
ci_058                -6.886627e-03 3 1  ON 57
ci_059                -6.780674e-03 3 1  ON 58
ci_060                 8.748940e-03 3 1  ON 59
ci_061                 8.221372e-03 3 1  ON 60
ci_062                -3.151500e-03 3 1  ON 61
ci_063                -3.054763e-03 3 1  ON 62
ci_064                -2.939292e-03 3 1  ON 63
ci_065                -4.373122e-03 3 1  ON 64
ci_066                 5.644632e-03 3 1  ON 65
ci_067                 5.614126e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163963e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9739e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.1941
    reference variance = 0.20882
====================================================
  Execution time = 2.7275e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0569e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1347e-01
  Total weights = 3.913517593e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9913e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298468770136
                                         uncertainty =       0.001686952792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298468770136
                                         uncertainty =       0.001686952792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273184910
  error estimate for blocks of size 2^( 2) =       0.000280315261
  error estimate for blocks of size 2^( 3) =       0.000286783162
  error estimate for blocks of size 2^( 4) =       0.000291764002
  error estimate for blocks of size 2^( 5) =       0.000294675188
  error estimate for blocks of size 2^( 6) =       0.000296628880
  error estimate for blocks of size 2^( 7) =       0.000297531815
  error estimate for blocks of size 2^( 8) =       0.000297305685

      target function =                  N/A
              le_mean =     -17.216635604381
             les_mean =     296.726008964373
             stat err =       0.000296535392
             autocorr =       1.178255992159
              std dev =       0.546369819047
             le_variance =       0.298519979166


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721663560438e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216635604398       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216635604430       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216635604427       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216635604427       residual = 1.40e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+04 is 6.581480e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216635604398       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216635604406       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216635604405       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216635604405       residual = 1.40e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+05 is 1.645378e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216635604398       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216635604400       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216635604400       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216635604314       residual = 1.40e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+05 is 4.113449e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.387343 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2275e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478951e-02 3 1  ON 2
ci_004                 2.145895e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622374e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142122e-02 3 1  ON 25
ci_027                 1.144131e-02 3 1  ON 26
ci_028                -1.449853e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085457e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855898e-03 3 1  ON 33
ci_035                -4.598836e-03 3 1  ON 34
ci_036                -9.932029e-03 3 1  ON 35
ci_037                -9.962119e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174717e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866898e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931579e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477877e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413604e-03 3 1  ON 49
ci_051                 7.491293e-03 3 1  ON 50
ci_052                -6.506525e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939351e-03 3 1  ON 53
ci_055                -2.854686e-03 3 1  ON 54
ci_056                 4.448960e-03 3 1  ON 55
ci_057                 4.434845e-03 3 1  ON 56
ci_058                -6.886627e-03 3 1  ON 57
ci_059                -6.780674e-03 3 1  ON 58
ci_060                 8.748939e-03 3 1  ON 59
ci_061                 8.221373e-03 3 1  ON 60
ci_062                -3.151500e-03 3 1  ON 61
ci_063                -3.054763e-03 3 1  ON 62
ci_064                -2.939291e-03 3 1  ON 63
ci_065                -4.373122e-03 3 1  ON 64
ci_066                 5.644632e-03 3 1  ON 65
ci_067                 5.614126e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163963e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2357
    reference variance = 0.159819
====================================================
  Execution time = 2.7237e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1012e-01
  Total weights = 3.9134e+06
  Execution time = 3.6387e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297374298847
                                         uncertainty =       0.001210063424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297374298847
                                         uncertainty =       0.001210063424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272685495
  error estimate for blocks of size 2^( 2) =       0.000279714059
  error estimate for blocks of size 2^( 3) =       0.000286153327
  error estimate for blocks of size 2^( 4) =       0.000290997324
  error estimate for blocks of size 2^( 5) =       0.000293803262
  error estimate for blocks of size 2^( 6) =       0.000295388801
  error estimate for blocks of size 2^( 7) =       0.000296978851
  error estimate for blocks of size 2^( 8) =       0.000297323735

      target function =                  N/A
              le_mean =     -17.216292928882
             les_mean =     296.710857548522
             stat err =       0.000295873662
             autocorr =       1.177303790214
              std dev =       0.545370989108
             le_variance =       0.297429515761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297374302235
                                         uncertainty =       0.001210063473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297374302235
                                         uncertainty =       0.001210063473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272685496
  error estimate for blocks of size 2^( 2) =       0.000279714060
  error estimate for blocks of size 2^( 3) =       0.000286153328
  error estimate for blocks of size 2^( 4) =       0.000290997325
  error estimate for blocks of size 2^( 5) =       0.000293803263
  error estimate for blocks of size 2^( 6) =       0.000295388802
  error estimate for blocks of size 2^( 7) =       0.000296978852
  error estimate for blocks of size 2^( 8) =       0.000297323736

      target function =                  N/A
              le_mean =     -17.216292928851
             les_mean =     296.710857548462
             stat err =       0.000295873664
             autocorr =       1.177303786785
              std dev =       0.545370992216
             le_variance =       0.297429519150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297374300541
                                         uncertainty =       0.001210063448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297374300541
                                         uncertainty =       0.001210063448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272685495
  error estimate for blocks of size 2^( 2) =       0.000279714060
  error estimate for blocks of size 2^( 3) =       0.000286153328
  error estimate for blocks of size 2^( 4) =       0.000290997325
  error estimate for blocks of size 2^( 5) =       0.000293803262
  error estimate for blocks of size 2^( 6) =       0.000295388802
  error estimate for blocks of size 2^( 7) =       0.000296978852
  error estimate for blocks of size 2^( 8) =       0.000297323736

      target function =                  N/A
              le_mean =     -17.216292928866
             les_mean =     296.710857548492
             stat err =       0.000295873663
             autocorr =       1.177303788516
              std dev =       0.545370990662
             le_variance =       0.297429517456

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297374299059
                                         uncertainty =       0.001210063427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297374299059
                                         uncertainty =       0.001210063427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272685495
  error estimate for blocks of size 2^( 2) =       0.000279714059
  error estimate for blocks of size 2^( 3) =       0.000286153327
  error estimate for blocks of size 2^( 4) =       0.000290997324
  error estimate for blocks of size 2^( 5) =       0.000293803262
  error estimate for blocks of size 2^( 6) =       0.000295388801
  error estimate for blocks of size 2^( 7) =       0.000296978851
  error estimate for blocks of size 2^( 8) =       0.000297323735

      target function =                  N/A
              le_mean =     -17.216292928880
             les_mean =     296.710857548518
             stat err =       0.000295873662
             autocorr =       1.177303790021
              std dev =       0.545370989302
             le_variance =       0.297429515973


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216292928882        initial  <--
     3.6380e+04     3.6380e+05             6.5815e-09       -17.216292928851
     1.4552e+05     1.4552e+06             1.6454e-09       -17.216292928866
     5.8208e+05     5.8208e+06             4.1134e-10       -17.216292928880

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.6099
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478951e-02 3 1  ON 2
ci_004                 2.145895e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622374e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142122e-02 3 1  ON 25
ci_027                 1.144131e-02 3 1  ON 26
ci_028                -1.449853e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085457e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855897e-03 3 1  ON 33
ci_035                -4.598836e-03 3 1  ON 34
ci_036                -9.932029e-03 3 1  ON 35
ci_037                -9.962119e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174717e-03 3 1  ON 39
ci_041                 9.803584e-03 3 1  ON 40
ci_042                 9.866898e-03 3 1  ON 41
ci_043                -3.174799e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931580e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491292e-03 3 1  ON 50
ci_052                -6.506525e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939351e-03 3 1  ON 53
ci_055                -2.854686e-03 3 1  ON 54
ci_056                 4.448960e-03 3 1  ON 55
ci_057                 4.434845e-03 3 1  ON 56
ci_058                -6.886627e-03 3 1  ON 57
ci_059                -6.780674e-03 3 1  ON 58
ci_060                 8.748940e-03 3 1  ON 59
ci_061                 8.221372e-03 3 1  ON 60
ci_062                -3.151500e-03 3 1  ON 61
ci_063                -3.054763e-03 3 1  ON 62
ci_064                -2.939292e-03 3 1  ON 63
ci_065                -4.373122e-03 3 1  ON 64
ci_066                 5.644632e-03 3 1  ON 65
ci_067                 5.614126e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163963e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7894e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2478
    reference variance = 0.359243
====================================================
  Execution time = 2.7380e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0569e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1455e-01
  Total weights = 3.913074298e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9192e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300127696938
                                         uncertainty =       0.001846568765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300127696938
                                         uncertainty =       0.001846568765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273924867
  error estimate for blocks of size 2^( 2) =       0.000280943164
  error estimate for blocks of size 2^( 3) =       0.000287249914
  error estimate for blocks of size 2^( 4) =       0.000292209053
  error estimate for blocks of size 2^( 5) =       0.000295154948
  error estimate for blocks of size 2^( 6) =       0.000297049843
  error estimate for blocks of size 2^( 7) =       0.000298754073
  error estimate for blocks of size 2^( 8) =       0.000300465559

      target function =                  N/A
              le_mean =     -17.215861299461
             les_mean =     296.700434387433
             stat err =       0.000297856106
             autocorr =       1.182360993850
              std dev =       0.547849734597
             le_variance =       0.300139331698


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721586129946e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215861299472       residual = 8.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215861299474       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215861299474       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+05 is 7.547803e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215861299472       residual = 8.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215861299472       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215861299473       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+06 is 1.886951e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215861299472       residual = 8.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215861299472       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215861299472       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+06 is 4.717379e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.388443 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2307e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478951e-02 3 1  ON 2
ci_004                 2.145895e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622374e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142122e-02 3 1  ON 25
ci_027                 1.144131e-02 3 1  ON 26
ci_028                -1.449853e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085457e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855897e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932029e-03 3 1  ON 35
ci_037                -9.962119e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581812e-03 3 1  ON 38
ci_040                -4.174717e-03 3 1  ON 39
ci_041                 9.803584e-03 3 1  ON 40
ci_042                 9.866898e-03 3 1  ON 41
ci_043                -3.174799e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931580e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491292e-03 3 1  ON 50
ci_052                -6.506525e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939351e-03 3 1  ON 53
ci_055                -2.854686e-03 3 1  ON 54
ci_056                 4.448960e-03 3 1  ON 55
ci_057                 4.434845e-03 3 1  ON 56
ci_058                -6.886627e-03 3 1  ON 57
ci_059                -6.780674e-03 3 1  ON 58
ci_060                 8.748940e-03 3 1  ON 59
ci_061                 8.221372e-03 3 1  ON 60
ci_062                -3.151500e-03 3 1  ON 61
ci_063                -3.054763e-03 3 1  ON 62
ci_064                -2.939292e-03 3 1  ON 63
ci_065                -4.373122e-03 3 1  ON 64
ci_066                 5.644632e-03 3 1  ON 65
ci_067                 5.614126e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163963e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.1481
    reference variance = 0.24237
====================================================
  Execution time = 2.7388e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1343e-01
  Total weights = 3.9138e+06
  Execution time = 3.6229e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298800927969
                                         uncertainty =       0.001455382866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298800927969
                                         uncertainty =       0.001455382866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273360168
  error estimate for blocks of size 2^( 2) =       0.000280228880
  error estimate for blocks of size 2^( 3) =       0.000286679628
  error estimate for blocks of size 2^( 4) =       0.000291660509
  error estimate for blocks of size 2^( 5) =       0.000294378251
  error estimate for blocks of size 2^( 6) =       0.000295705833
  error estimate for blocks of size 2^( 7) =       0.000296647186
  error estimate for blocks of size 2^( 8) =       0.000297119001

      target function =                  N/A
              le_mean =     -17.216669366277
             les_mean =     296.727135452124
             stat err =       0.000295962568
             autocorr =       1.172203750970
              std dev =       0.546720336404
             le_variance =       0.298903126237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298800927371
                                         uncertainty =       0.001455382850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298800927371
                                         uncertainty =       0.001455382850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273360168
  error estimate for blocks of size 2^( 2) =       0.000280228880
  error estimate for blocks of size 2^( 3) =       0.000286679628
  error estimate for blocks of size 2^( 4) =       0.000291660509
  error estimate for blocks of size 2^( 5) =       0.000294378251
  error estimate for blocks of size 2^( 6) =       0.000295705833
  error estimate for blocks of size 2^( 7) =       0.000296647185
  error estimate for blocks of size 2^( 8) =       0.000297119001

      target function =                  N/A
              le_mean =     -17.216669366274
             les_mean =     296.727135451502
             stat err =       0.000295962567
             autocorr =       1.172203751244
              std dev =       0.546720335860
             le_variance =       0.298903125643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298800927670
                                         uncertainty =       0.001455382858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298800927670
                                         uncertainty =       0.001455382858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273360168
  error estimate for blocks of size 2^( 2) =       0.000280228880
  error estimate for blocks of size 2^( 3) =       0.000286679628
  error estimate for blocks of size 2^( 4) =       0.000291660509
  error estimate for blocks of size 2^( 5) =       0.000294378251
  error estimate for blocks of size 2^( 6) =       0.000295705833
  error estimate for blocks of size 2^( 7) =       0.000296647185
  error estimate for blocks of size 2^( 8) =       0.000297119001

      target function =                  N/A
              le_mean =     -17.216669366275
             les_mean =     296.727135451813
             stat err =       0.000295962568
             autocorr =       1.172203751127
              std dev =       0.546720336132
             le_variance =       0.298903125940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298800927931
                                         uncertainty =       0.001455382865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298800927931
                                         uncertainty =       0.001455382865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273360168
  error estimate for blocks of size 2^( 2) =       0.000280228880
  error estimate for blocks of size 2^( 3) =       0.000286679628
  error estimate for blocks of size 2^( 4) =       0.000291660509
  error estimate for blocks of size 2^( 5) =       0.000294378251
  error estimate for blocks of size 2^( 6) =       0.000295705833
  error estimate for blocks of size 2^( 7) =       0.000296647186
  error estimate for blocks of size 2^( 8) =       0.000297119001

      target function =                  N/A
              le_mean =     -17.216669366276
             les_mean =     296.727135452085
             stat err =       0.000295962568
             autocorr =       1.172203750992
              std dev =       0.546720336370
             le_variance =       0.298903126200


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216669366277        initial  <--
     3.6380e+05     3.6380e+06             7.5478e-10       -17.216669366274
     1.4552e+06     1.4552e+07             1.8870e-10       -17.216669366275
     5.8208e+06     5.8208e+07             4.7174e-11       -17.216669366276

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.6544
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478951e-02 3 1  ON 2
ci_004                 2.145895e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622374e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142122e-02 3 1  ON 25
ci_027                 1.144131e-02 3 1  ON 26
ci_028                -1.449853e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085457e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855897e-03 3 1  ON 33
ci_035                -4.598836e-03 3 1  ON 34
ci_036                -9.932029e-03 3 1  ON 35
ci_037                -9.962119e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174717e-03 3 1  ON 39
ci_041                 9.803584e-03 3 1  ON 40
ci_042                 9.866898e-03 3 1  ON 41
ci_043                -3.174799e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931580e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491292e-03 3 1  ON 50
ci_052                -6.506525e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939351e-03 3 1  ON 53
ci_055                -2.854686e-03 3 1  ON 54
ci_056                 4.448960e-03 3 1  ON 55
ci_057                 4.434845e-03 3 1  ON 56
ci_058                -6.886627e-03 3 1  ON 57
ci_059                -6.780674e-03 3 1  ON 58
ci_060                 8.748940e-03 3 1  ON 59
ci_061                 8.221372e-03 3 1  ON 60
ci_062                -3.151500e-03 3 1  ON 61
ci_063                -3.054763e-03 3 1  ON 62
ci_064                -2.939292e-03 3 1  ON 63
ci_065                -4.373122e-03 3 1  ON 64
ci_066                 5.644632e-03 3 1  ON 65
ci_067                 5.614126e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163963e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7970e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.258
    reference variance = 0.233476
====================================================
  Execution time = 2.7727e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0574e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1704e-01
  Total weights = 3.913649275e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.0331e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299484744815
                                         uncertainty =       0.001615542673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299484744815
                                         uncertainty =       0.001615542673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273615311
  error estimate for blocks of size 2^( 2) =       0.000280633350
  error estimate for blocks of size 2^( 3) =       0.000287125291
  error estimate for blocks of size 2^( 4) =       0.000291708544
  error estimate for blocks of size 2^( 5) =       0.000294878965
  error estimate for blocks of size 2^( 6) =       0.000296532119
  error estimate for blocks of size 2^( 7) =       0.000297178809
  error estimate for blocks of size 2^( 8) =       0.000297077072

      target function =                  N/A
              le_mean =     -17.216731542518
             les_mean =     296.732887069836
             stat err =       0.000296416741
             autocorr =       1.173612329909
              std dev =       0.547230622689
             le_variance =       0.299461354408


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721673154252e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216731542539       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216731542540       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216731542540       residual = 8.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+06 is 9.019919e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216731542539       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216731542540       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216731542540       residual = 8.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+07 is 2.254980e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216731542539       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216731542539       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216731542539       residual = 8.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+07 is 5.637456e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.389516 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2768e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478951e-02 3 1  ON 2
ci_004                 2.145895e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622374e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142122e-02 3 1  ON 25
ci_027                 1.144131e-02 3 1  ON 26
ci_028                -1.449853e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085457e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855897e-03 3 1  ON 33
ci_035                -4.598836e-03 3 1  ON 34
ci_036                -9.932029e-03 3 1  ON 35
ci_037                -9.962119e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174717e-03 3 1  ON 39
ci_041                 9.803584e-03 3 1  ON 40
ci_042                 9.866898e-03 3 1  ON 41
ci_043                -3.174799e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931580e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491292e-03 3 1  ON 50
ci_052                -6.506525e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939351e-03 3 1  ON 53
ci_055                -2.854686e-03 3 1  ON 54
ci_056                 4.448960e-03 3 1  ON 55
ci_057                 4.434845e-03 3 1  ON 56
ci_058                -6.886627e-03 3 1  ON 57
ci_059                -6.780674e-03 3 1  ON 58
ci_060                 8.748940e-03 3 1  ON 59
ci_061                 8.221372e-03 3 1  ON 60
ci_062                -3.151500e-03 3 1  ON 61
ci_063                -3.054763e-03 3 1  ON 62
ci_064                -2.939292e-03 3 1  ON 63
ci_065                -4.373122e-03 3 1  ON 64
ci_066                 5.644632e-03 3 1  ON 65
ci_067                 5.614126e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163963e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2599
    reference variance = 0.151811
====================================================
  Execution time = 2.7034e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1590e-01
  Total weights = 3.9131e+06
  Execution time = 3.6400e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299831983855
                                         uncertainty =       0.001302547744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299831983855
                                         uncertainty =       0.001302547744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273777564
  error estimate for blocks of size 2^( 2) =       0.000280835110
  error estimate for blocks of size 2^( 3) =       0.000287658462
  error estimate for blocks of size 2^( 4) =       0.000292282679
  error estimate for blocks of size 2^( 5) =       0.000294995199
  error estimate for blocks of size 2^( 6) =       0.000296375516
  error estimate for blocks of size 2^( 7) =       0.000297836999
  error estimate for blocks of size 2^( 8) =       0.000299029461

      target function =                  N/A
              le_mean =     -17.216762451152
             les_mean =     296.732813737609
             stat err =       0.000297059294
             autocorr =       1.177309311111
              std dev =       0.547555127545
             le_variance =       0.299816617700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299831983806
                                         uncertainty =       0.001302547743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299831983806
                                         uncertainty =       0.001302547743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273777564
  error estimate for blocks of size 2^( 2) =       0.000280835110
  error estimate for blocks of size 2^( 3) =       0.000287658462
  error estimate for blocks of size 2^( 4) =       0.000292282679
  error estimate for blocks of size 2^( 5) =       0.000294995199
  error estimate for blocks of size 2^( 6) =       0.000296375516
  error estimate for blocks of size 2^( 7) =       0.000297836999
  error estimate for blocks of size 2^( 8) =       0.000299029461

      target function =                  N/A
              le_mean =     -17.216762451152
             les_mean =     296.732813736949
             stat err =       0.000297059294
             autocorr =       1.177309311166
              std dev =       0.547555127500
             le_variance =       0.299816617651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299831983830
                                         uncertainty =       0.001302547744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299831983830
                                         uncertainty =       0.001302547744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273777564
  error estimate for blocks of size 2^( 2) =       0.000280835110
  error estimate for blocks of size 2^( 3) =       0.000287658462
  error estimate for blocks of size 2^( 4) =       0.000292282679
  error estimate for blocks of size 2^( 5) =       0.000294995199
  error estimate for blocks of size 2^( 6) =       0.000296375516
  error estimate for blocks of size 2^( 7) =       0.000297836999
  error estimate for blocks of size 2^( 8) =       0.000299029461

      target function =                  N/A
              le_mean =     -17.216762451152
             les_mean =     296.732813737279
             stat err =       0.000297059294
             autocorr =       1.177309311136
              std dev =       0.547555127522
             le_variance =       0.299816617676

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299831983852
                                         uncertainty =       0.001302547744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299831983852
                                         uncertainty =       0.001302547744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273777564
  error estimate for blocks of size 2^( 2) =       0.000280835110
  error estimate for blocks of size 2^( 3) =       0.000287658462
  error estimate for blocks of size 2^( 4) =       0.000292282679
  error estimate for blocks of size 2^( 5) =       0.000294995199
  error estimate for blocks of size 2^( 6) =       0.000296375516
  error estimate for blocks of size 2^( 7) =       0.000297836999
  error estimate for blocks of size 2^( 8) =       0.000299029461

      target function =                  N/A
              le_mean =     -17.216762451152
             les_mean =     296.732813737568
             stat err =       0.000297059294
             autocorr =       1.177309311123
              std dev =       0.547555127542
             le_variance =       0.299816617697


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216762451152        initial
     3.6380e+06     3.6380e+07             9.0199e-11       -17.216762451152  <--
     1.4552e+07     1.4552e+08             2.2550e-11       -17.216762451152
     5.8208e+07     5.8208e+08             5.6375e-12       -17.216762451152

*****************************************************************************
Applying the update for shift_i =   3.6380e+06     and shift_s =   3.6380e+07
*****************************************************************************

  Execution time = 4.6665e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478951e-02 3 1  ON 2
ci_004                 2.145895e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622374e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142122e-02 3 1  ON 25
ci_027                 1.144131e-02 3 1  ON 26
ci_028                -1.449853e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085457e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855897e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932029e-03 3 1  ON 35
ci_037                -9.962119e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174717e-03 3 1  ON 39
ci_041                 9.803584e-03 3 1  ON 40
ci_042                 9.866897e-03 3 1  ON 41
ci_043                -3.174799e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931580e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491292e-03 3 1  ON 50
ci_052                -6.506525e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939351e-03 3 1  ON 53
ci_055                -2.854686e-03 3 1  ON 54
ci_056                 4.448960e-03 3 1  ON 55
ci_057                 4.434845e-03 3 1  ON 56
ci_058                -6.886627e-03 3 1  ON 57
ci_059                -6.780674e-03 3 1  ON 58
ci_060                 8.748940e-03 3 1  ON 59
ci_061                 8.221372e-03 3 1  ON 60
ci_062                -3.151500e-03 3 1  ON 61
ci_063                -3.054763e-03 3 1  ON 62
ci_064                -2.939292e-03 3 1  ON 63
ci_065                -4.373122e-03 3 1  ON 64
ci_066                 5.644632e-03 3 1  ON 65
ci_067                 5.614126e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163963e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9443e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.1461
    reference variance = 0.409167
====================================================
  Execution time = 2.7275e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0569e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1700e-01
  Total weights = 3.913963791e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9345e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300741330953
                                         uncertainty =       0.001734772019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300741330953
                                         uncertainty =       0.001734772019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274200325
  error estimate for blocks of size 2^( 2) =       0.000281145670
  error estimate for blocks of size 2^( 3) =       0.000287734817
  error estimate for blocks of size 2^( 4) =       0.000292516725
  error estimate for blocks of size 2^( 5) =       0.000295732590
  error estimate for blocks of size 2^( 6) =       0.000298028201
  error estimate for blocks of size 2^( 7) =       0.000298281015
  error estimate for blocks of size 2^( 8) =       0.000299480301

      target function =                  N/A
              le_mean =     -17.216561055946
             les_mean =     296.726978214306
             stat err =       0.000297880527
             autocorr =       1.180180127535
              std dev =       0.548400649512
             le_variance =       0.300743272385


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656105595e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216561055967       residual = 8.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216561055967       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216561055967       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216561055967       residual = 1.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+05 is 3.500301e-10

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216561055967       residual = 8.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216561055967       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216561055967       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216561055675       residual = 1.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+06 is 8.750751e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216561055967       residual = 8.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216561055967       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216561055967       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216561055967       residual = 1.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+07 is 2.187690e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.390858 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2217e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478951e-02 3 1  ON 2
ci_004                 2.145895e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622374e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142122e-02 3 1  ON 25
ci_027                 1.144131e-02 3 1  ON 26
ci_028                -1.449853e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085457e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855897e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932029e-03 3 1  ON 35
ci_037                -9.962119e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174717e-03 3 1  ON 39
ci_041                 9.803584e-03 3 1  ON 40
ci_042                 9.866897e-03 3 1  ON 41
ci_043                -3.174799e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931580e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491292e-03 3 1  ON 50
ci_052                -6.506525e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939351e-03 3 1  ON 53
ci_055                -2.854686e-03 3 1  ON 54
ci_056                 4.448960e-03 3 1  ON 55
ci_057                 4.434845e-03 3 1  ON 56
ci_058                -6.886627e-03 3 1  ON 57
ci_059                -6.780674e-03 3 1  ON 58
ci_060                 8.748940e-03 3 1  ON 59
ci_061                 8.221372e-03 3 1  ON 60
ci_062                -3.151500e-03 3 1  ON 61
ci_063                -3.054763e-03 3 1  ON 62
ci_064                -2.939292e-03 3 1  ON 63
ci_065                -4.373122e-03 3 1  ON 64
ci_066                 5.644632e-03 3 1  ON 65
ci_067                 5.614126e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163963e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2606
    reference variance = 0.29719
====================================================
  Execution time = 2.6798e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1407e-01
  Total weights = 3.9134e+06
  Execution time = 3.6528e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299389897392
                                         uncertainty =       0.001630778735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299389897392
                                         uncertainty =       0.001630778735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273600414
  error estimate for blocks of size 2^( 2) =       0.000280615104
  error estimate for blocks of size 2^( 3) =       0.000287239035
  error estimate for blocks of size 2^( 4) =       0.000291974721
  error estimate for blocks of size 2^( 5) =       0.000294892428
  error estimate for blocks of size 2^( 6) =       0.000296309207
  error estimate for blocks of size 2^( 7) =       0.000297724748
  error estimate for blocks of size 2^( 8) =       0.000298078311

      target function =                  N/A
              le_mean =     -17.216545774126
             les_mean =     296.723517964480
             stat err =       0.000296751174
             autocorr =       1.176390174195
              std dev =       0.547200828926
             le_variance =       0.299428747177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299389897299
                                         uncertainty =       0.001630778728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299389897299
                                         uncertainty =       0.001630778728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273600414
  error estimate for blocks of size 2^( 2) =       0.000280615104
  error estimate for blocks of size 2^( 3) =       0.000287239035
  error estimate for blocks of size 2^( 4) =       0.000291974721
  error estimate for blocks of size 2^( 5) =       0.000294892428
  error estimate for blocks of size 2^( 6) =       0.000296309207
  error estimate for blocks of size 2^( 7) =       0.000297724748
  error estimate for blocks of size 2^( 8) =       0.000298078311

      target function =                  N/A
              le_mean =     -17.216545774128
             les_mean =     296.723517965334
             stat err =       0.000296751174
             autocorr =       1.176390174268
              std dev =       0.547200828841
             le_variance =       0.299428747084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299389897345
                                         uncertainty =       0.001630778732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299389897345
                                         uncertainty =       0.001630778732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273600414
  error estimate for blocks of size 2^( 2) =       0.000280615104
  error estimate for blocks of size 2^( 3) =       0.000287239035
  error estimate for blocks of size 2^( 4) =       0.000291974721
  error estimate for blocks of size 2^( 5) =       0.000294892428
  error estimate for blocks of size 2^( 6) =       0.000296309207
  error estimate for blocks of size 2^( 7) =       0.000297724748
  error estimate for blocks of size 2^( 8) =       0.000298078311

      target function =                  N/A
              le_mean =     -17.216545774127
             les_mean =     296.723517964907
             stat err =       0.000296751174
             autocorr =       1.176390174226
              std dev =       0.547200828883
             le_variance =       0.299428747131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299389897386
                                         uncertainty =       0.001630778735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299389897386
                                         uncertainty =       0.001630778735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273600414
  error estimate for blocks of size 2^( 2) =       0.000280615104
  error estimate for blocks of size 2^( 3) =       0.000287239035
  error estimate for blocks of size 2^( 4) =       0.000291974721
  error estimate for blocks of size 2^( 5) =       0.000294892428
  error estimate for blocks of size 2^( 6) =       0.000296309207
  error estimate for blocks of size 2^( 7) =       0.000297724748
  error estimate for blocks of size 2^( 8) =       0.000298078311

      target function =                  N/A
              le_mean =     -17.216545774126
             les_mean =     296.723517964534
             stat err =       0.000296751174
             autocorr =       1.176390174214
              std dev =       0.547200828920
             le_variance =       0.299428747171


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216545774126        initial
     9.0949e+05     9.0949e+06             3.5003e-10       -17.216545774128  <--
     3.6380e+06     3.6380e+07             8.7508e-11       -17.216545774127
     1.4552e+07     1.4552e+08             2.1877e-11       -17.216545774126

*****************************************************************************
Applying the update for shift_i =   9.0949e+05     and shift_s =   9.0949e+06
*****************************************************************************

  Execution time = 4.5256e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478951e-02 3 1  ON 2
ci_004                 2.145895e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622374e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142122e-02 3 1  ON 25
ci_027                 1.144131e-02 3 1  ON 26
ci_028                -1.449853e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085457e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855897e-03 3 1  ON 33
ci_035                -4.598836e-03 3 1  ON 34
ci_036                -9.932029e-03 3 1  ON 35
ci_037                -9.962119e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174717e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866898e-03 3 1  ON 41
ci_043                -3.174799e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931580e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491292e-03 3 1  ON 50
ci_052                -6.506525e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939351e-03 3 1  ON 53
ci_055                -2.854686e-03 3 1  ON 54
ci_056                 4.448960e-03 3 1  ON 55
ci_057                 4.434845e-03 3 1  ON 56
ci_058                -6.886627e-03 3 1  ON 57
ci_059                -6.780674e-03 3 1  ON 58
ci_060                 8.748940e-03 3 1  ON 59
ci_061                 8.221372e-03 3 1  ON 60
ci_062                -3.151500e-03 3 1  ON 61
ci_063                -3.054763e-03 3 1  ON 62
ci_064                -2.939292e-03 3 1  ON 63
ci_065                -4.373122e-03 3 1  ON 64
ci_066                 5.644632e-03 3 1  ON 65
ci_067                 5.614126e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163963e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7499e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2356
    reference variance = 0.186622
====================================================
  Execution time = 2.7275e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0580e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1313e-01
  Total weights = 3.913358751e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9595e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300549908715
                                         uncertainty =       0.001571633691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300549908715
                                         uncertainty =       0.001571633691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274111162
  error estimate for blocks of size 2^( 2) =       0.000281382941
  error estimate for blocks of size 2^( 3) =       0.000287644957
  error estimate for blocks of size 2^( 4) =       0.000292504596
  error estimate for blocks of size 2^( 5) =       0.000296009710
  error estimate for blocks of size 2^( 6) =       0.000296895366
  error estimate for blocks of size 2^( 7) =       0.000297613460
  error estimate for blocks of size 2^( 8) =       0.000298536666

      target function =                  N/A
              le_mean =     -17.217097017623
             les_mean =     296.741560165702
             stat err =       0.000297263800
             autocorr =       1.176063063204
              std dev =       0.548222324152
             le_variance =       0.300547716699


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721709701762e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217097017640       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217097017661       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217097017662       residual = 5.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+05 is 1.179214e-09

solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217097017640       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217097017646       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217097017646       residual = 5.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+05 is 2.948036e-10

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217097017640       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217097017642       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217097017642       residual = 5.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+06 is 7.370092e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.392054 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2243e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478951e-02 3 1  ON 2
ci_004                 2.145895e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622374e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142122e-02 3 1  ON 25
ci_027                 1.144131e-02 3 1  ON 26
ci_028                -1.449853e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085457e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855897e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932029e-03 3 1  ON 35
ci_037                -9.962119e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174717e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866898e-03 3 1  ON 41
ci_043                -3.174799e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931580e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491292e-03 3 1  ON 50
ci_052                -6.506525e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939351e-03 3 1  ON 53
ci_055                -2.854687e-03 3 1  ON 54
ci_056                 4.448960e-03 3 1  ON 55
ci_057                 4.434845e-03 3 1  ON 56
ci_058                -6.886627e-03 3 1  ON 57
ci_059                -6.780674e-03 3 1  ON 58
ci_060                 8.748940e-03 3 1  ON 59
ci_061                 8.221372e-03 3 1  ON 60
ci_062                -3.151500e-03 3 1  ON 61
ci_063                -3.054763e-03 3 1  ON 62
ci_064                -2.939292e-03 3 1  ON 63
ci_065                -4.373122e-03 3 1  ON 64
ci_066                 5.644632e-03 3 1  ON 65
ci_067                 5.614126e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163963e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2864
    reference variance = 0.138595
====================================================
  Execution time = 2.6996e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1713e-01
  Total weights = 3.9128e+06
  Execution time = 3.6667e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300727113057
                                         uncertainty =       0.001747137318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300727113057
                                         uncertainty =       0.001747137318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274166069
  error estimate for blocks of size 2^( 2) =       0.000281347579
  error estimate for blocks of size 2^( 3) =       0.000287596140
  error estimate for blocks of size 2^( 4) =       0.000292139761
  error estimate for blocks of size 2^( 5) =       0.000294215858
  error estimate for blocks of size 2^( 6) =       0.000296280828
  error estimate for blocks of size 2^( 7) =       0.000297342765
  error estimate for blocks of size 2^( 8) =       0.000296943586

      target function =                  N/A
              le_mean =     -17.216290485783
             les_mean =     296.717786943387
             stat err =       0.000296195759
             autocorr =       1.167159644827
              std dev =       0.548332137551
             le_variance =       0.300668133071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300727113741
                                         uncertainty =       0.001747137311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300727113741
                                         uncertainty =       0.001747137311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274166069
  error estimate for blocks of size 2^( 2) =       0.000281347579
  error estimate for blocks of size 2^( 3) =       0.000287596140
  error estimate for blocks of size 2^( 4) =       0.000292139761
  error estimate for blocks of size 2^( 5) =       0.000294215858
  error estimate for blocks of size 2^( 6) =       0.000296280828
  error estimate for blocks of size 2^( 7) =       0.000297342766
  error estimate for blocks of size 2^( 8) =       0.000296943587

      target function =                  N/A
              le_mean =     -17.216290485786
             les_mean =     296.717786947633
             stat err =       0.000296195760
             autocorr =       1.167159644227
              std dev =       0.548332138176
             le_variance =       0.300668133757

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300727113399
                                         uncertainty =       0.001747137314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300727113399
                                         uncertainty =       0.001747137314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274166069
  error estimate for blocks of size 2^( 2) =       0.000281347579
  error estimate for blocks of size 2^( 3) =       0.000287596140
  error estimate for blocks of size 2^( 4) =       0.000292139761
  error estimate for blocks of size 2^( 5) =       0.000294215858
  error estimate for blocks of size 2^( 6) =       0.000296280828
  error estimate for blocks of size 2^( 7) =       0.000297342766
  error estimate for blocks of size 2^( 8) =       0.000296943586

      target function =                  N/A
              le_mean =     -17.216290485784
             les_mean =     296.717786945510
             stat err =       0.000296195759
             autocorr =       1.167159644495
              std dev =       0.548332137864
             le_variance =       0.300668133414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300727113099
                                         uncertainty =       0.001747137317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300727113099
                                         uncertainty =       0.001747137317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274166069
  error estimate for blocks of size 2^( 2) =       0.000281347579
  error estimate for blocks of size 2^( 3) =       0.000287596140
  error estimate for blocks of size 2^( 4) =       0.000292139761
  error estimate for blocks of size 2^( 5) =       0.000294215858
  error estimate for blocks of size 2^( 6) =       0.000296280828
  error estimate for blocks of size 2^( 7) =       0.000297342765
  error estimate for blocks of size 2^( 8) =       0.000296943586

      target function =                  N/A
              le_mean =     -17.216290485783
             les_mean =     296.717786943652
             stat err =       0.000296195759
             autocorr =       1.167159644792
              std dev =       0.548332137590
             le_variance =       0.300668133114


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216290485783        initial
     2.2737e+05     2.2737e+06             1.1792e-09       -17.216290485786  <--
     9.0949e+05     9.0949e+06             2.9480e-10       -17.216290485784
     3.6380e+06     3.6380e+07             7.3701e-11       -17.216290485783

*****************************************************************************
Applying the update for shift_i =   2.2737e+05     and shift_s =   2.2737e+06
*****************************************************************************

  Execution time = 4.5481e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145895e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622374e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333033e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142122e-02 3 1  ON 25
ci_027                 1.144131e-02 3 1  ON 26
ci_028                -1.449853e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085457e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855898e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932030e-03 3 1  ON 35
ci_037                -9.962119e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174717e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866898e-03 3 1  ON 41
ci_043                -3.174799e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931580e-03 3 1  ON 44
ci_046                 5.506785e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491292e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939351e-03 3 1  ON 53
ci_055                -2.854687e-03 3 1  ON 54
ci_056                 4.448961e-03 3 1  ON 55
ci_057                 4.434846e-03 3 1  ON 56
ci_058                -6.886627e-03 3 1  ON 57
ci_059                -6.780674e-03 3 1  ON 58
ci_060                 8.748940e-03 3 1  ON 59
ci_061                 8.221373e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054763e-03 3 1  ON 62
ci_064                -2.939293e-03 3 1  ON 63
ci_065                -4.373121e-03 3 1  ON 64
ci_066                 5.644632e-03 3 1  ON 65
ci_067                 5.614126e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7734e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.1887
    reference variance = 0.238805
====================================================
  Execution time = 2.7440e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0572e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1278e-01
  Total weights = 3.913295378e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9728e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299430851492
                                         uncertainty =       0.001438384219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299430851492
                                         uncertainty =       0.001438384219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273583001
  error estimate for blocks of size 2^( 2) =       0.000280600637
  error estimate for blocks of size 2^( 3) =       0.000287157171
  error estimate for blocks of size 2^( 4) =       0.000292206834
  error estimate for blocks of size 2^( 5) =       0.000295220263
  error estimate for blocks of size 2^( 6) =       0.000296693417
  error estimate for blocks of size 2^( 7) =       0.000297976831
  error estimate for blocks of size 2^( 8) =       0.000298558456

      target function =                  N/A
              le_mean =     -17.216572298514
             les_mean =     296.723140891754
             stat err =       0.000297112242
             autocorr =       1.179404756158
              std dev =       0.547166001832
             le_variance =       0.299390633561


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721657229851e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+04, overlap shift 5.6843e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216572298533       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216572298607       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216572298609       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+04 is 4.038589e-09

solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216572298533       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216572298552       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216572298552       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+05 is 1.009652e-09

solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216572298533       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216572298538       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216572298538       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+05 is 2.524132e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.393140 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2420e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145895e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622374e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142122e-02 3 1  ON 25
ci_027                 1.144131e-02 3 1  ON 26
ci_028                -1.449853e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085457e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855898e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932030e-03 3 1  ON 35
ci_037                -9.962120e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174717e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866898e-03 3 1  ON 41
ci_043                -3.174799e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931579e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491294e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939350e-03 3 1  ON 53
ci_055                -2.854687e-03 3 1  ON 54
ci_056                 4.448961e-03 3 1  ON 55
ci_057                 4.434845e-03 3 1  ON 56
ci_058                -6.886627e-03 3 1  ON 57
ci_059                -6.780674e-03 3 1  ON 58
ci_060                 8.748939e-03 3 1  ON 59
ci_061                 8.221373e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054763e-03 3 1  ON 62
ci_064                -2.939294e-03 3 1  ON 63
ci_065                -4.373121e-03 3 1  ON 64
ci_066                 5.644632e-03 3 1  ON 65
ci_067                 5.614126e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.1337
    reference variance = 0.217495
====================================================
  Execution time = 2.6985e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1435e-01
  Total weights = 3.9134e+06
  Execution time = 3.6548e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298081041415
                                         uncertainty =       0.001415260954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298081041415
                                         uncertainty =       0.001415260954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272986146
  error estimate for blocks of size 2^( 2) =       0.000280179933
  error estimate for blocks of size 2^( 3) =       0.000286275135
  error estimate for blocks of size 2^( 4) =       0.000291153361
  error estimate for blocks of size 2^( 5) =       0.000294147444
  error estimate for blocks of size 2^( 6) =       0.000295652588
  error estimate for blocks of size 2^( 7) =       0.000296016773
  error estimate for blocks of size 2^( 8) =       0.000295196391

      target function =                  N/A
              le_mean =     -17.216390379040
             les_mean =     296.718448347147
             stat err =       0.000295253299
             autocorr =       1.169791071604
              std dev =       0.545972292516
             le_variance =       0.298085744195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298081041841
                                         uncertainty =       0.001415260783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298081041841
                                         uncertainty =       0.001415260783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272986146
  error estimate for blocks of size 2^( 2) =       0.000280179934
  error estimate for blocks of size 2^( 3) =       0.000286275135
  error estimate for blocks of size 2^( 4) =       0.000291153361
  error estimate for blocks of size 2^( 5) =       0.000294147445
  error estimate for blocks of size 2^( 6) =       0.000295652588
  error estimate for blocks of size 2^( 7) =       0.000296016773
  error estimate for blocks of size 2^( 8) =       0.000295196391

      target function =                  N/A
              le_mean =     -17.216390379105
             les_mean =     296.718448352758
             stat err =       0.000295253299
             autocorr =       1.169791071807
              std dev =       0.545972292901
             le_variance =       0.298085744615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298081041628
                                         uncertainty =       0.001415260868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298081041628
                                         uncertainty =       0.001415260868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272986146
  error estimate for blocks of size 2^( 2) =       0.000280179934
  error estimate for blocks of size 2^( 3) =       0.000286275135
  error estimate for blocks of size 2^( 4) =       0.000291153361
  error estimate for blocks of size 2^( 5) =       0.000294147444
  error estimate for blocks of size 2^( 6) =       0.000295652588
  error estimate for blocks of size 2^( 7) =       0.000296016773
  error estimate for blocks of size 2^( 8) =       0.000295196391

      target function =                  N/A
              le_mean =     -17.216390379073
             les_mean =     296.718448349952
             stat err =       0.000295253299
             autocorr =       1.169791071702
              std dev =       0.545972292708
             le_variance =       0.298085744405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298081041442
                                         uncertainty =       0.001415260943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298081041442
                                         uncertainty =       0.001415260943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272986146
  error estimate for blocks of size 2^( 2) =       0.000280179933
  error estimate for blocks of size 2^( 3) =       0.000286275135
  error estimate for blocks of size 2^( 4) =       0.000291153361
  error estimate for blocks of size 2^( 5) =       0.000294147444
  error estimate for blocks of size 2^( 6) =       0.000295652588
  error estimate for blocks of size 2^( 7) =       0.000296016773
  error estimate for blocks of size 2^( 8) =       0.000295196391

      target function =                  N/A
              le_mean =     -17.216390379044
             les_mean =     296.718448347497
             stat err =       0.000295253299
             autocorr =       1.169791071638
              std dev =       0.545972292540
             le_variance =       0.298085744221


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216390379040        initial
     5.6843e+04     5.6843e+05             4.0386e-09       -17.216390379105  <--
     2.2737e+05     2.2737e+06             1.0097e-09       -17.216390379073
     9.0949e+05     9.0949e+06             2.5241e-10       -17.216390379044

*****************************************************************************
Applying the update for shift_i =   5.6843e+04     and shift_s =   5.6843e+05
*****************************************************************************

  Execution time = 4.5417e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603016e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931578e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854688e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7849e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.1747
    reference variance = 0.163263
====================================================
  Execution time = 2.7449e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0553e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1153e-01
  Total weights = 3.913281715e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9687e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298004339865
                                         uncertainty =       0.001509998066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298004339865
                                         uncertainty =       0.001509998066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272931562
  error estimate for blocks of size 2^( 2) =       0.000279853149
  error estimate for blocks of size 2^( 3) =       0.000286028145
  error estimate for blocks of size 2^( 4) =       0.000290714371
  error estimate for blocks of size 2^( 5) =       0.000293544712
  error estimate for blocks of size 2^( 6) =       0.000295431589
  error estimate for blocks of size 2^( 7) =       0.000297219490
  error estimate for blocks of size 2^( 8) =       0.000299256108

      target function =                  N/A
              le_mean =     -17.216541253601
             les_mean =     296.720821796718
             stat err =       0.000296362975
             autocorr =       1.179072118795
              std dev =       0.545863123240
             le_variance =       0.297966549313


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654125360e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+04, overlap shift 1.4211e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216541253629       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216541254003       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216541254025       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+04 is 1.512578e-08

solving harmonic davidson linear method for identity shift 5.6843e+04, overlap shift 5.6843e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216541253629       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216541253723       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216541253728       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+04 is 3.781491e-09

solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216541253629       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216541253653       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216541253654       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+05 is 9.453757e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.394219 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2425e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070326e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840517e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603016e-02 3 1  ON 11
ci_013                -1.825626e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165356e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449853e-02 3 1  ON 27
ci_029                -1.410787e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598835e-03 3 1  ON 34
ci_036                -9.932033e-03 3 1  ON 35
ci_037                -9.962124e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581812e-03 3 1  ON 38
ci_040                -4.174714e-03 3 1  ON 39
ci_041                 9.803587e-03 3 1  ON 40
ci_042                 9.866901e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931575e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477881e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413604e-03 3 1  ON 49
ci_051                 7.491298e-03 3 1  ON 50
ci_052                -6.506524e-03 3 1  ON 51
ci_053                -6.680520e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854690e-03 3 1  ON 54
ci_056                 4.448961e-03 3 1  ON 55
ci_057                 4.434846e-03 3 1  ON 56
ci_058                -6.886623e-03 3 1  ON 57
ci_059                -6.780671e-03 3 1  ON 58
ci_060                 8.748935e-03 3 1  ON 59
ci_061                 8.221373e-03 3 1  ON 60
ci_062                -3.151504e-03 3 1  ON 61
ci_063                -3.054763e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373114e-03 3 1  ON 64
ci_066                 5.644632e-03 3 1  ON 65
ci_067                 5.614129e-03 3 1  ON 66
ci_068                -4.811431e-03 3 1  ON 67
ci_069                -5.163963e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.2759
    reference variance = 0.254712
====================================================
  Execution time = 2.7097e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1747e-01
  Total weights = 3.9132e+06
  Execution time = 4.0731e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300700226033
                                         uncertainty =       0.001658913282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300700226033
                                         uncertainty =       0.001658913282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274175987
  error estimate for blocks of size 2^( 2) =       0.000281235075
  error estimate for blocks of size 2^( 3) =       0.000287617020
  error estimate for blocks of size 2^( 4) =       0.000292354370
  error estimate for blocks of size 2^( 5) =       0.000294873189
  error estimate for blocks of size 2^( 6) =       0.000296694133
  error estimate for blocks of size 2^( 7) =       0.000296800001
  error estimate for blocks of size 2^( 8) =       0.000297253826

      target function =                  N/A
              le_mean =     -17.216847321630
             les_mean =     296.737299772747
             stat err =       0.000296405287
             autocorr =       1.168726954540
              std dev =       0.548351974696
             le_variance =       0.300689888153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300700216286
                                         uncertainty =       0.001658913457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300700216286
                                         uncertainty =       0.001658913457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274175983
  error estimate for blocks of size 2^( 2) =       0.000281235071
  error estimate for blocks of size 2^( 3) =       0.000287617015
  error estimate for blocks of size 2^( 4) =       0.000292354366
  error estimate for blocks of size 2^( 5) =       0.000294873184
  error estimate for blocks of size 2^( 6) =       0.000296694129
  error estimate for blocks of size 2^( 7) =       0.000296799997
  error estimate for blocks of size 2^( 8) =       0.000297253822

      target function =                  N/A
              le_mean =     -17.216847321478
             les_mean =     296.737299683196
             stat err =       0.000296405283
             autocorr =       1.168726958936
              std dev =       0.548351965789
             le_variance =       0.300689878385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300700221159
                                         uncertainty =       0.001658913369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300700221159
                                         uncertainty =       0.001658913369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274175985
  error estimate for blocks of size 2^( 2) =       0.000281235073
  error estimate for blocks of size 2^( 3) =       0.000287617018
  error estimate for blocks of size 2^( 4) =       0.000292354368
  error estimate for blocks of size 2^( 5) =       0.000294873187
  error estimate for blocks of size 2^( 6) =       0.000296694131
  error estimate for blocks of size 2^( 7) =       0.000296799999
  error estimate for blocks of size 2^( 8) =       0.000297253824

      target function =                  N/A
              le_mean =     -17.216847321554
             les_mean =     296.737299727912
             stat err =       0.000296405285
             autocorr =       1.168726956742
              std dev =       0.548351970243
             le_variance =       0.300689883269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300700225424
                                         uncertainty =       0.001658913293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300700225424
                                         uncertainty =       0.001658913293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274175987
  error estimate for blocks of size 2^( 2) =       0.000281235075
  error estimate for blocks of size 2^( 3) =       0.000287617019
  error estimate for blocks of size 2^( 4) =       0.000292354370
  error estimate for blocks of size 2^( 5) =       0.000294873188
  error estimate for blocks of size 2^( 6) =       0.000296694133
  error estimate for blocks of size 2^( 7) =       0.000296800001
  error estimate for blocks of size 2^( 8) =       0.000297253826

      target function =                  N/A
              le_mean =     -17.216847321621
             les_mean =     296.737299767136
             stat err =       0.000296405287
             autocorr =       1.168726954817
              std dev =       0.548351974139
             le_variance =       0.300689887543


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216847321630        initial  <--
     1.4211e+04     1.4211e+05             1.5126e-08       -17.216847321478
     5.6843e+04     5.6843e+05             3.7815e-09       -17.216847321554
     2.2737e+05     2.2737e+06             9.4538e-10       -17.216847321621

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.3760
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603016e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931578e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854688e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8818e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.1613
    reference variance = 0.306164
====================================================
  Execution time = 2.7490e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0611e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1329e-01
  Total weights = 3.913677654e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9671e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298775598168
                                         uncertainty =       0.001697801676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298775598168
                                         uncertainty =       0.001697801676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273315030
  error estimate for blocks of size 2^( 2) =       0.000280384787
  error estimate for blocks of size 2^( 3) =       0.000286764519
  error estimate for blocks of size 2^( 4) =       0.000291633578
  error estimate for blocks of size 2^( 5) =       0.000295026439
  error estimate for blocks of size 2^( 6) =       0.000296941407
  error estimate for blocks of size 2^( 7) =       0.000298482986
  error estimate for blocks of size 2^( 8) =       0.000298249462

      target function =                  N/A
              le_mean =     -17.216385968353
             les_mean =     296.717239644154
             stat err =       0.000297175074
             autocorr =       1.182218441873
              std dev =       0.546630059204
             le_variance =       0.298804421626


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721638596835e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+05, overlap shift 1.4211e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216385968371       residual = 8.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216385968384       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216385968384       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+05 is 2.081336e-09

solving harmonic davidson linear method for identity shift 5.6843e+05, overlap shift 5.6843e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216385968371       residual = 8.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216385968374       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216385968374       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+05 is 5.203345e-10

solving harmonic davidson linear method for identity shift 2.2737e+06, overlap shift 2.2737e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216385968371       residual = 8.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216385968372       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216385968372       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+06 is 1.300837e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.395278 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2464e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603016e-02 3 1  ON 11
ci_013                -1.825626e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962122e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931578e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748939e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.1488
    reference variance = 0.174805
====================================================
  Execution time = 2.7153e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1126e-01
  Total weights = 3.9133e+06
  Execution time = 3.6622e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298255609362
                                         uncertainty =       0.001717020902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298255609362
                                         uncertainty =       0.001717020902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273074215
  error estimate for blocks of size 2^( 2) =       0.000280078231
  error estimate for blocks of size 2^( 3) =       0.000286448187
  error estimate for blocks of size 2^( 4) =       0.000290997408
  error estimate for blocks of size 2^( 5) =       0.000294026846
  error estimate for blocks of size 2^( 6) =       0.000295858330
  error estimate for blocks of size 2^( 7) =       0.000297054655
  error estimate for blocks of size 2^( 8) =       0.000298562391

      target function =                  N/A
              le_mean =     -17.216545105082
             les_mean =     296.720690052657
             stat err =       0.000296375556
             autocorr =       1.177940558032
              std dev =       0.546148429327
             le_variance =       0.298278106857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298255609156
                                         uncertainty =       0.001717020899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298255609156
                                         uncertainty =       0.001717020899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273074215
  error estimate for blocks of size 2^( 2) =       0.000280078231
  error estimate for blocks of size 2^( 3) =       0.000286448187
  error estimate for blocks of size 2^( 4) =       0.000290997408
  error estimate for blocks of size 2^( 5) =       0.000294026846
  error estimate for blocks of size 2^( 6) =       0.000295858330
  error estimate for blocks of size 2^( 7) =       0.000297054654
  error estimate for blocks of size 2^( 8) =       0.000298562391

      target function =                  N/A
              le_mean =     -17.216545105081
             les_mean =     296.720690056547
             stat err =       0.000296375555
             autocorr =       1.177940557925
              std dev =       0.546148429141
             le_variance =       0.298278106653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298255609259
                                         uncertainty =       0.001717020900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298255609259
                                         uncertainty =       0.001717020900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273074215
  error estimate for blocks of size 2^( 2) =       0.000280078231
  error estimate for blocks of size 2^( 3) =       0.000286448187
  error estimate for blocks of size 2^( 4) =       0.000290997408
  error estimate for blocks of size 2^( 5) =       0.000294026846
  error estimate for blocks of size 2^( 6) =       0.000295858330
  error estimate for blocks of size 2^( 7) =       0.000297054654
  error estimate for blocks of size 2^( 8) =       0.000298562391

      target function =                  N/A
              le_mean =     -17.216545105082
             les_mean =     296.720690054602
             stat err =       0.000296375555
             autocorr =       1.177940557986
              std dev =       0.546148429234
             le_variance =       0.298278106755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298255609349
                                         uncertainty =       0.001717020901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298255609349
                                         uncertainty =       0.001717020901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273074215
  error estimate for blocks of size 2^( 2) =       0.000280078231
  error estimate for blocks of size 2^( 3) =       0.000286448187
  error estimate for blocks of size 2^( 4) =       0.000290997408
  error estimate for blocks of size 2^( 5) =       0.000294026846
  error estimate for blocks of size 2^( 6) =       0.000295858330
  error estimate for blocks of size 2^( 7) =       0.000297054655
  error estimate for blocks of size 2^( 8) =       0.000298562391

      target function =                  N/A
              le_mean =     -17.216545105082
             les_mean =     296.720690052901
             stat err =       0.000296375556
             autocorr =       1.177940558020
              std dev =       0.546148429316
             le_variance =       0.298278106844


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216545105082        initial  <--
     1.4211e+05     1.4211e+06             2.0813e-09       -17.216545105081
     5.6843e+05     5.6843e+06             5.2033e-10       -17.216545105082
     2.2737e+06     2.2737e+07             1.3008e-10       -17.216545105082

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.6178
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603016e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931578e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854688e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8091e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2083
    reference variance = 0.290136
====================================================
  Execution time = 2.7257e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0582e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1434e-01
  Total weights = 3.913476652e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9239e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299069377112
                                         uncertainty =       0.001626841904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299069377112
                                         uncertainty =       0.001626841904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273414081
  error estimate for blocks of size 2^( 2) =       0.000280433058
  error estimate for blocks of size 2^( 3) =       0.000286879613
  error estimate for blocks of size 2^( 4) =       0.000291798866
  error estimate for blocks of size 2^( 5) =       0.000294716249
  error estimate for blocks of size 2^( 6) =       0.000295497731
  error estimate for blocks of size 2^( 7) =       0.000295147358
  error estimate for blocks of size 2^( 8) =       0.000296533415

      target function =                  N/A
              le_mean =     -17.216320309385
             les_mean =     296.716028919747
             stat err =       0.000295473688
             autocorr =       1.167873680858
              std dev =       0.546828162596
             le_variance =       0.299021039409


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721632030938e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+06, overlap shift 1.4211e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216320309400       residual = 9.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216320309402       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216320309402       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216320309402       residual = 2.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+06 is 2.598128e-10

solving harmonic davidson linear method for identity shift 5.6843e+06, overlap shift 5.6843e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216320309400       residual = 9.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216320309400       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216320309400       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216320309453       residual = 2.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+06 is 6.495325e-11

solving harmonic davidson linear method for identity shift 2.2737e+07, overlap shift 2.2737e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216320309400       residual = 9.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216320309400       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216320309400       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216320309400       residual = 2.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+07 is 1.623834e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.396644 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2189e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603016e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931578e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2318
    reference variance = 0.251055
====================================================
  Execution time = 2.7419e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1430e-01
  Total weights = 3.9136e+06
  Execution time = 3.6398e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298933181410
                                         uncertainty =       0.001511680238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298933181410
                                         uncertainty =       0.001511680238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273359038
  error estimate for blocks of size 2^( 2) =       0.000280321243
  error estimate for blocks of size 2^( 3) =       0.000286661903
  error estimate for blocks of size 2^( 4) =       0.000291355898
  error estimate for blocks of size 2^( 5) =       0.000293955029
  error estimate for blocks of size 2^( 6) =       0.000294901995
  error estimate for blocks of size 2^( 7) =       0.000294717803
  error estimate for blocks of size 2^( 8) =       0.000295677815

      target function =                  N/A
              le_mean =     -17.216430050096
             les_mean =     296.719762971490
             stat err =       0.000294813161
             autocorr =       1.163126257015
              std dev =       0.546718075367
             le_variance =       0.298900653934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298933181319
                                         uncertainty =       0.001511680236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298933181319
                                         uncertainty =       0.001511680236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273359038
  error estimate for blocks of size 2^( 2) =       0.000280321242
  error estimate for blocks of size 2^( 3) =       0.000286661903
  error estimate for blocks of size 2^( 4) =       0.000291355898
  error estimate for blocks of size 2^( 5) =       0.000293955029
  error estimate for blocks of size 2^( 6) =       0.000294901995
  error estimate for blocks of size 2^( 7) =       0.000294717803
  error estimate for blocks of size 2^( 8) =       0.000295677815

      target function =                  N/A
              le_mean =     -17.216430050096
             les_mean =     296.719762971410
             stat err =       0.000294813161
             autocorr =       1.163126257044
              std dev =       0.546718075284
             le_variance =       0.298900653842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298933181364
                                         uncertainty =       0.001511680237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298933181364
                                         uncertainty =       0.001511680237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273359038
  error estimate for blocks of size 2^( 2) =       0.000280321243
  error estimate for blocks of size 2^( 3) =       0.000286661903
  error estimate for blocks of size 2^( 4) =       0.000291355898
  error estimate for blocks of size 2^( 5) =       0.000293955029
  error estimate for blocks of size 2^( 6) =       0.000294901995
  error estimate for blocks of size 2^( 7) =       0.000294717803
  error estimate for blocks of size 2^( 8) =       0.000295677815

      target function =                  N/A
              le_mean =     -17.216430050096
             les_mean =     296.719762971450
             stat err =       0.000294813161
             autocorr =       1.163126257049
              std dev =       0.546718075326
             le_variance =       0.298900653888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298933181404
                                         uncertainty =       0.001511680238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298933181404
                                         uncertainty =       0.001511680238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273359038
  error estimate for blocks of size 2^( 2) =       0.000280321243
  error estimate for blocks of size 2^( 3) =       0.000286661903
  error estimate for blocks of size 2^( 4) =       0.000291355898
  error estimate for blocks of size 2^( 5) =       0.000293955029
  error estimate for blocks of size 2^( 6) =       0.000294901995
  error estimate for blocks of size 2^( 7) =       0.000294717803
  error estimate for blocks of size 2^( 8) =       0.000295677815

      target function =                  N/A
              le_mean =     -17.216430050096
             les_mean =     296.719762971485
             stat err =       0.000294813161
             autocorr =       1.163126257018
              std dev =       0.546718075362
             le_variance =       0.298900653928


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216430050096        initial
     1.4211e+06     1.4211e+07             2.5981e-10       -17.216430050096  <--
     5.6843e+06     5.6843e+07             6.4953e-11       -17.216430050096
     2.2737e+07     2.2737e+08             1.6238e-11       -17.216430050096

*****************************************************************************
Applying the update for shift_i =   1.4211e+06     and shift_s =   1.4211e+07
*****************************************************************************

  Execution time = 4.5778e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7975e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2669
    reference variance = 0.265676
====================================================
  Execution time = 2.7411e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0578e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1190e-01
  Total weights = 3.913293372e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9369e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298475572395
                                         uncertainty =       0.001341087488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298475572395
                                         uncertainty =       0.001341087488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273163081
  error estimate for blocks of size 2^( 2) =       0.000280129303
  error estimate for blocks of size 2^( 3) =       0.000286745482
  error estimate for blocks of size 2^( 4) =       0.000291767759
  error estimate for blocks of size 2^( 5) =       0.000294528328
  error estimate for blocks of size 2^( 6) =       0.000295690750
  error estimate for blocks of size 2^( 7) =       0.000296110177
  error estimate for blocks of size 2^( 8) =       0.000296163239

      target function =                  N/A
              le_mean =     -17.216721580827
             les_mean =     296.727398746469
             stat err =       0.000295623123
             autocorr =       1.171204679998
              std dev =       0.546326161073
             le_variance =       0.298472274273


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721672158083e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+05, overlap shift 3.5527e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216721580854       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216721580857       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216721580856       residual = 6.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+05 is 7.167282e-10

solving harmonic davidson linear method for identity shift 1.4211e+06, overlap shift 1.4211e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216721580854       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216721580855       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216721580854       residual = 6.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+06 is 1.791822e-10

solving harmonic davidson linear method for identity shift 5.6843e+06, overlap shift 5.6843e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216721580854       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216721580854       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216721580854       residual = 6.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+06 is 4.479557e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.397884 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2356e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.3115
    reference variance = 0.353023
====================================================
  Execution time = 2.7288e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1548e-01
  Total weights = 3.9131e+06
  Execution time = 3.6399e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299936261433
                                         uncertainty =       0.001685381512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299936261433
                                         uncertainty =       0.001685381512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273816901
  error estimate for blocks of size 2^( 2) =       0.000280942401
  error estimate for blocks of size 2^( 3) =       0.000287440786
  error estimate for blocks of size 2^( 4) =       0.000292453481
  error estimate for blocks of size 2^( 5) =       0.000295811004
  error estimate for blocks of size 2^( 6) =       0.000296944590
  error estimate for blocks of size 2^( 7) =       0.000298483399
  error estimate for blocks of size 2^( 8) =       0.000299654064

      target function =                  N/A
              le_mean =     -17.216496601748
             les_mean =     296.723230565981
             stat err =       0.000297723264
             autocorr =       1.182238347638
              std dev =       0.547633802042
             le_variance =       0.299902781139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299936261731
                                         uncertainty =       0.001685381523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299936261731
                                         uncertainty =       0.001685381523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273816901
  error estimate for blocks of size 2^( 2) =       0.000280942401
  error estimate for blocks of size 2^( 3) =       0.000287440786
  error estimate for blocks of size 2^( 4) =       0.000292453481
  error estimate for blocks of size 2^( 5) =       0.000295811004
  error estimate for blocks of size 2^( 6) =       0.000296944590
  error estimate for blocks of size 2^( 7) =       0.000298483399
  error estimate for blocks of size 2^( 8) =       0.000299654064

      target function =                  N/A
              le_mean =     -17.216496601743
             les_mean =     296.723230564251
             stat err =       0.000297723264
             autocorr =       1.182238347103
              std dev =       0.547633802314
             le_variance =       0.299902781437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299936261582
                                         uncertainty =       0.001685381517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299936261582
                                         uncertainty =       0.001685381517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273816901
  error estimate for blocks of size 2^( 2) =       0.000280942401
  error estimate for blocks of size 2^( 3) =       0.000287440786
  error estimate for blocks of size 2^( 4) =       0.000292453481
  error estimate for blocks of size 2^( 5) =       0.000295811004
  error estimate for blocks of size 2^( 6) =       0.000296944590
  error estimate for blocks of size 2^( 7) =       0.000298483399
  error estimate for blocks of size 2^( 8) =       0.000299654064

      target function =                  N/A
              le_mean =     -17.216496601746
             les_mean =     296.723230565116
             stat err =       0.000297723264
             autocorr =       1.182238347376
              std dev =       0.547633802178
             le_variance =       0.299902781288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299936261451
                                         uncertainty =       0.001685381512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299936261451
                                         uncertainty =       0.001685381512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273816901
  error estimate for blocks of size 2^( 2) =       0.000280942401
  error estimate for blocks of size 2^( 3) =       0.000287440786
  error estimate for blocks of size 2^( 4) =       0.000292453481
  error estimate for blocks of size 2^( 5) =       0.000295811004
  error estimate for blocks of size 2^( 6) =       0.000296944590
  error estimate for blocks of size 2^( 7) =       0.000298483399
  error estimate for blocks of size 2^( 8) =       0.000299654064

      target function =                  N/A
              le_mean =     -17.216496601748
             les_mean =     296.723230565873
             stat err =       0.000297723264
             autocorr =       1.182238347621
              std dev =       0.547633802059
             le_variance =       0.299902781157


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216496601748        initial  <--
     3.5527e+05     3.5527e+06             7.1673e-10       -17.216496601743
     1.4211e+06     1.4211e+07             1.7918e-10       -17.216496601746
     5.6843e+06     5.6843e+07             4.4796e-11       -17.216496601748

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.7557
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8121e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2141
    reference variance = 0.170367
====================================================
  Execution time = 2.7615e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0578e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1403e-01
  Total weights = 3.913226874e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9194e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299769687695
                                         uncertainty =       0.001298940294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299769687695
                                         uncertainty =       0.001298940294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273768101
  error estimate for blocks of size 2^( 2) =       0.000280749339
  error estimate for blocks of size 2^( 3) =       0.000286972419
  error estimate for blocks of size 2^( 4) =       0.000291896582
  error estimate for blocks of size 2^( 5) =       0.000294976398
  error estimate for blocks of size 2^( 6) =       0.000297111917
  error estimate for blocks of size 2^( 7) =       0.000297768326
  error estimate for blocks of size 2^( 8) =       0.000299402251

      target function =                  N/A
              le_mean =     -17.216613740418
             les_mean =     296.725816982123
             stat err =       0.000297314723
             autocorr =       1.179416353936
              std dev =       0.547536201643
             le_variance =       0.299795892109


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721661374042e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+06, overlap shift 3.5527e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216613740446       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216613740445       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216613740445       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+06 is 7.737377e-11

solving harmonic davidson linear method for identity shift 1.4211e+07, overlap shift 1.4211e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216613740446       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216613740446       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216613740446       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+07 is 1.934344e-11

solving harmonic davidson linear method for identity shift 5.6843e+07, overlap shift 5.6843e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216613740446       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216613740446       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216613740446       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+07 is 4.835861e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.398933 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2542e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.1298
    reference variance = 0.21729
====================================================
  Execution time = 2.9587e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1266e-01
  Total weights = 3.9138e+06
  Execution time = 3.6293e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297955277296
                                         uncertainty =       0.001460023465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297955277296
                                         uncertainty =       0.001460023465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272911870
  error estimate for blocks of size 2^( 2) =       0.000279956707
  error estimate for blocks of size 2^( 3) =       0.000286354567
  error estimate for blocks of size 2^( 4) =       0.000290895187
  error estimate for blocks of size 2^( 5) =       0.000293735960
  error estimate for blocks of size 2^( 6) =       0.000295898495
  error estimate for blocks of size 2^( 7) =       0.000297627456
  error estimate for blocks of size 2^( 8) =       0.000296809086

      target function =                  N/A
              le_mean =     -17.216469596664
             les_mean =     296.719480808067
             stat err =       0.000296017749
             autocorr =       1.176496536952
              std dev =       0.545823740597
             le_variance =       0.297923555799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297955277282
                                         uncertainty =       0.001460023465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297955277282
                                         uncertainty =       0.001460023465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272911870
  error estimate for blocks of size 2^( 2) =       0.000279956707
  error estimate for blocks of size 2^( 3) =       0.000286354567
  error estimate for blocks of size 2^( 4) =       0.000290895187
  error estimate for blocks of size 2^( 5) =       0.000293735960
  error estimate for blocks of size 2^( 6) =       0.000295898495
  error estimate for blocks of size 2^( 7) =       0.000297627456
  error estimate for blocks of size 2^( 8) =       0.000296809086

      target function =                  N/A
              le_mean =     -17.216469596664
             les_mean =     296.719480808117
             stat err =       0.000296017749
             autocorr =       1.176496536939
              std dev =       0.545823740585
             le_variance =       0.297923555786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297955277289
                                         uncertainty =       0.001460023465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297955277289
                                         uncertainty =       0.001460023465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272911870
  error estimate for blocks of size 2^( 2) =       0.000279956707
  error estimate for blocks of size 2^( 3) =       0.000286354567
  error estimate for blocks of size 2^( 4) =       0.000290895187
  error estimate for blocks of size 2^( 5) =       0.000293735960
  error estimate for blocks of size 2^( 6) =       0.000295898495
  error estimate for blocks of size 2^( 7) =       0.000297627456
  error estimate for blocks of size 2^( 8) =       0.000296809086

      target function =                  N/A
              le_mean =     -17.216469596664
             les_mean =     296.719480808092
             stat err =       0.000296017749
             autocorr =       1.176496536951
              std dev =       0.545823740591
             le_variance =       0.297923555793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297955277295
                                         uncertainty =       0.001460023465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297955277295
                                         uncertainty =       0.001460023465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272911870
  error estimate for blocks of size 2^( 2) =       0.000279956707
  error estimate for blocks of size 2^( 3) =       0.000286354567
  error estimate for blocks of size 2^( 4) =       0.000290895187
  error estimate for blocks of size 2^( 5) =       0.000293735960
  error estimate for blocks of size 2^( 6) =       0.000295898495
  error estimate for blocks of size 2^( 7) =       0.000297627456
  error estimate for blocks of size 2^( 8) =       0.000296809086

      target function =                  N/A
              le_mean =     -17.216469596664
             les_mean =     296.719480808070
             stat err =       0.000296017749
             autocorr =       1.176496536935
              std dev =       0.545823740596
             le_variance =       0.297923555798


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216469596664        initial  <--
     3.5527e+06     3.5527e+07             7.7374e-11       -17.216469596664
     1.4211e+07     1.4211e+08             1.9343e-11       -17.216469596664
     5.6843e+07     5.6843e+08             4.8359e-12       -17.216469596664

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.8825
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0433e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2673
    reference variance = 0.223515
====================================================
  Execution time = 2.7359e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0585e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1919e-01
  Total weights = 3.912977364e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9084e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302577781028
                                         uncertainty =       0.001681386932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302577781028
                                         uncertainty =       0.001681386932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275015029
  error estimate for blocks of size 2^( 2) =       0.000282210589
  error estimate for blocks of size 2^( 3) =       0.000288601957
  error estimate for blocks of size 2^( 4) =       0.000293475940
  error estimate for blocks of size 2^( 5) =       0.000296575406
  error estimate for blocks of size 2^( 6) =       0.000298973149
  error estimate for blocks of size 2^( 7) =       0.000299842128
  error estimate for blocks of size 2^( 8) =       0.000301530526

      target function =                  N/A
              le_mean =     -17.216537561760
             les_mean =     296.728351987784
             stat err =       0.000299230302
             autocorr =       1.183854381465
              std dev =       0.550030058591
             le_variance =       0.302533065353


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721653756176e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+07, overlap shift 3.5527e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216537561784       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216537561784       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216537561784       residual = 8.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+07 is 8.135680e-12

solving harmonic davidson linear method for identity shift 1.4211e+08, overlap shift 1.4211e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216537561784       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216537561784       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216537561784       residual = 8.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+08 is 2.033920e-12

solving harmonic davidson linear method for identity shift 5.6843e+08, overlap shift 5.6843e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216537561784       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216537561784       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216537561784       residual = 8.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+08 is 5.084800e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.400002 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2274e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.232
    reference variance = 0.224018
====================================================
  Execution time = 2.6937e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1034e-01
  Total weights = 3.9133e+06
  Execution time = 3.6351e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296875802160
                                         uncertainty =       0.001345449654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296875802160
                                         uncertainty =       0.001345449654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272429100
  error estimate for blocks of size 2^( 2) =       0.000279432851
  error estimate for blocks of size 2^( 3) =       0.000285546105
  error estimate for blocks of size 2^( 4) =       0.000290570565
  error estimate for blocks of size 2^( 5) =       0.000293924035
  error estimate for blocks of size 2^( 6) =       0.000296193598
  error estimate for blocks of size 2^( 7) =       0.000296712139
  error estimate for blocks of size 2^( 8) =       0.000297689325

      target function =                  N/A
              le_mean =     -17.217007141539
             les_mean =     296.735676908678
             stat err =       0.000296129774
             autocorr =       1.181563749144
              std dev =       0.544858200970
             le_variance =       0.296870459165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296875802157
                                         uncertainty =       0.001345449654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296875802157
                                         uncertainty =       0.001345449654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272429100
  error estimate for blocks of size 2^( 2) =       0.000279432851
  error estimate for blocks of size 2^( 3) =       0.000285546105
  error estimate for blocks of size 2^( 4) =       0.000290570565
  error estimate for blocks of size 2^( 5) =       0.000293924035
  error estimate for blocks of size 2^( 6) =       0.000296193598
  error estimate for blocks of size 2^( 7) =       0.000296712139
  error estimate for blocks of size 2^( 8) =       0.000297689325

      target function =                  N/A
              le_mean =     -17.217007141539
             les_mean =     296.735676908691
             stat err =       0.000296129774
             autocorr =       1.181563749134
              std dev =       0.544858200968
             le_variance =       0.296870459162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296875802159
                                         uncertainty =       0.001345449654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296875802159
                                         uncertainty =       0.001345449654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272429100
  error estimate for blocks of size 2^( 2) =       0.000279432851
  error estimate for blocks of size 2^( 3) =       0.000285546105
  error estimate for blocks of size 2^( 4) =       0.000290570565
  error estimate for blocks of size 2^( 5) =       0.000293924035
  error estimate for blocks of size 2^( 6) =       0.000296193598
  error estimate for blocks of size 2^( 7) =       0.000296712139
  error estimate for blocks of size 2^( 8) =       0.000297689325

      target function =                  N/A
              le_mean =     -17.217007141539
             les_mean =     296.735676908684
             stat err =       0.000296129774
             autocorr =       1.181563749132
              std dev =       0.544858200969
             le_variance =       0.296870459163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296875802160
                                         uncertainty =       0.001345449654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296875802160
                                         uncertainty =       0.001345449654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272429100
  error estimate for blocks of size 2^( 2) =       0.000279432851
  error estimate for blocks of size 2^( 3) =       0.000285546105
  error estimate for blocks of size 2^( 4) =       0.000290570565
  error estimate for blocks of size 2^( 5) =       0.000293924035
  error estimate for blocks of size 2^( 6) =       0.000296193598
  error estimate for blocks of size 2^( 7) =       0.000296712139
  error estimate for blocks of size 2^( 8) =       0.000297689325

      target function =                  N/A
              le_mean =     -17.217007141539
             les_mean =     296.735676908679
             stat err =       0.000296129774
             autocorr =       1.181563749130
              std dev =       0.544858200970
             le_variance =       0.296870459165


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217007141539        initial
     3.5527e+07     3.5527e+08             8.1357e-12       -17.217007141539  <--
     1.4211e+08     1.4211e+09             2.0339e-12       -17.217007141539
     5.6843e+08     5.6843e+09             5.0848e-13       -17.217007141539

*****************************************************************************
Applying the update for shift_i =   3.5527e+07     and shift_s =   3.5527e+08
*****************************************************************************

  Execution time = 4.5267e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7549e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2376
    reference variance = 0.225645
====================================================
  Execution time = 2.7461e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0550e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1629e-01
  Total weights = 3.913527857e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9333e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300357027867
                                         uncertainty =       0.001703604677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300357027867
                                         uncertainty =       0.001703604677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274024509
  error estimate for blocks of size 2^( 2) =       0.000281171257
  error estimate for blocks of size 2^( 3) =       0.000287726238
  error estimate for blocks of size 2^( 4) =       0.000292124123
  error estimate for blocks of size 2^( 5) =       0.000294832943
  error estimate for blocks of size 2^( 6) =       0.000296723835
  error estimate for blocks of size 2^( 7) =       0.000296589690
  error estimate for blocks of size 2^( 8) =       0.000297042660

      target function =                  N/A
              le_mean =     -17.216556371196
             les_mean =     296.726108040347
             stat err =       0.000296297282
             autocorr =       1.169166922715
              std dev =       0.548049017627
             le_variance =       0.300357725722


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721655637120e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+06, overlap shift 8.8818e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216556371233       residual = 6.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216556371234       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216556371234       residual = 6.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+06 is 3.394228e-11

solving harmonic davidson linear method for identity shift 3.5527e+07, overlap shift 3.5527e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216556371233       residual = 6.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216556371233       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216556371233       residual = 6.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+07 is 8.485570e-12

solving harmonic davidson linear method for identity shift 1.4211e+08, overlap shift 1.4211e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216556371233       residual = 6.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216556371233       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216556371233       residual = 6.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+08 is 2.121392e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.401068 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2402e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811430e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.294
    reference variance = 0.740738
====================================================
  Execution time = 2.7510e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1858e-01
  Total weights = 3.9137e+06
  Execution time = 3.6630e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300973974442
                                         uncertainty =       0.001435375371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300973974442
                                         uncertainty =       0.001435375371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274296930
  error estimate for blocks of size 2^( 2) =       0.000281383490
  error estimate for blocks of size 2^( 3) =       0.000287643735
  error estimate for blocks of size 2^( 4) =       0.000292232579
  error estimate for blocks of size 2^( 5) =       0.000295376675
  error estimate for blocks of size 2^( 6) =       0.000298047371
  error estimate for blocks of size 2^( 7) =       0.000299708909
  error estimate for blocks of size 2^( 8) =       0.000300254492

      target function =                  N/A
              le_mean =     -17.216214154975
             les_mean =     296.716610616303
             stat err =       0.000298346862
             autocorr =       1.183044426809
              std dev =       0.548593859978
             le_variance =       0.300955223205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300973974429
                                         uncertainty =       0.001435375370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300973974429
                                         uncertainty =       0.001435375370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274296930
  error estimate for blocks of size 2^( 2) =       0.000281383490
  error estimate for blocks of size 2^( 3) =       0.000287643735
  error estimate for blocks of size 2^( 4) =       0.000292232579
  error estimate for blocks of size 2^( 5) =       0.000295376675
  error estimate for blocks of size 2^( 6) =       0.000298047371
  error estimate for blocks of size 2^( 7) =       0.000299708909
  error estimate for blocks of size 2^( 8) =       0.000300254492

      target function =                  N/A
              le_mean =     -17.216214154975
             les_mean =     296.716610616296
             stat err =       0.000298346862
             autocorr =       1.183044426818
              std dev =       0.548593859966
             le_variance =       0.300955223192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300973974435
                                         uncertainty =       0.001435375371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300973974435
                                         uncertainty =       0.001435375371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274296930
  error estimate for blocks of size 2^( 2) =       0.000281383490
  error estimate for blocks of size 2^( 3) =       0.000287643735
  error estimate for blocks of size 2^( 4) =       0.000292232579
  error estimate for blocks of size 2^( 5) =       0.000295376675
  error estimate for blocks of size 2^( 6) =       0.000298047371
  error estimate for blocks of size 2^( 7) =       0.000299708909
  error estimate for blocks of size 2^( 8) =       0.000300254492

      target function =                  N/A
              le_mean =     -17.216214154975
             les_mean =     296.716610616299
             stat err =       0.000298346862
             autocorr =       1.183044426809
              std dev =       0.548593859972
             le_variance =       0.300955223199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300973974441
                                         uncertainty =       0.001435375371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300973974441
                                         uncertainty =       0.001435375371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274296930
  error estimate for blocks of size 2^( 2) =       0.000281383490
  error estimate for blocks of size 2^( 3) =       0.000287643735
  error estimate for blocks of size 2^( 4) =       0.000292232579
  error estimate for blocks of size 2^( 5) =       0.000295376675
  error estimate for blocks of size 2^( 6) =       0.000298047371
  error estimate for blocks of size 2^( 7) =       0.000299708909
  error estimate for blocks of size 2^( 8) =       0.000300254492

      target function =                  N/A
              le_mean =     -17.216214154975
             les_mean =     296.716610616302
             stat err =       0.000298346862
             autocorr =       1.183044426827
              std dev =       0.548593859977
             le_variance =       0.300955223204


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216214154975        initial
     8.8818e+06     8.8818e+07             3.3942e-11       -17.216214154975  <--
     3.5527e+07     3.5527e+08             8.4856e-12       -17.216214154975
     1.4211e+08     1.4211e+09             2.1214e-12       -17.216214154975

*****************************************************************************
Applying the update for shift_i =   8.8818e+06     and shift_s =   8.8818e+07
*****************************************************************************

  Execution time = 4.5945e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8356e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.3101
    reference variance = 0.427934
====================================================
  Execution time = 2.7505e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0563e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1460e-01
  Total weights = 3.913275008e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9473e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300718530492
                                         uncertainty =       0.001420283273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300718530492
                                         uncertainty =       0.001420283273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274202971
  error estimate for blocks of size 2^( 2) =       0.000281467557
  error estimate for blocks of size 2^( 3) =       0.000287929747
  error estimate for blocks of size 2^( 4) =       0.000292624341
  error estimate for blocks of size 2^( 5) =       0.000295645116
  error estimate for blocks of size 2^( 6) =       0.000297597240
  error estimate for blocks of size 2^( 7) =       0.000298115789
  error estimate for blocks of size 2^( 8) =       0.000299260024

      target function =                  N/A
              le_mean =     -17.216419499313
             les_mean =     296.719704046180
             stat err =       0.000297654542
             autocorr =       1.178367389242
              std dev =       0.548405942903
             le_variance =       0.300749078211


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721641949931e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+06, overlap shift 2.2204e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216419499323       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216419499324       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216419499324       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+06 is 1.110816e-10

solving harmonic davidson linear method for identity shift 8.8818e+06, overlap shift 8.8818e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216419499323       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216419499323       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216419499323       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+06 is 2.777041e-11

solving harmonic davidson linear method for identity shift 3.5527e+07, overlap shift 3.5527e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216419499323       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216419499323       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216419499323       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+07 is 6.942602e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.402137 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2459e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.224
    reference variance = 0.339914
====================================================
  Execution time = 2.7572e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1203e-01
  Total weights = 3.9132e+06
  Execution time = 3.6481e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297676469245
                                         uncertainty =       0.001270262499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297676469245
                                         uncertainty =       0.001270262499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272808337
  error estimate for blocks of size 2^( 2) =       0.000279894526
  error estimate for blocks of size 2^( 3) =       0.000286456029
  error estimate for blocks of size 2^( 4) =       0.000291454107
  error estimate for blocks of size 2^( 5) =       0.000294204513
  error estimate for blocks of size 2^( 6) =       0.000296085936
  error estimate for blocks of size 2^( 7) =       0.000296680444
  error estimate for blocks of size 2^( 8) =       0.000296882239

      target function =                  N/A
              le_mean =     -17.216205556758
             les_mean =     296.709764006911
             stat err =       0.000295963283
             autocorr =       1.176956455295
              std dev =       0.545616674127
             le_variance =       0.297697555085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297676469193
                                         uncertainty =       0.001270262500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297676469193
                                         uncertainty =       0.001270262500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272808337
  error estimate for blocks of size 2^( 2) =       0.000279894525
  error estimate for blocks of size 2^( 3) =       0.000286456029
  error estimate for blocks of size 2^( 4) =       0.000291454107
  error estimate for blocks of size 2^( 5) =       0.000294204512
  error estimate for blocks of size 2^( 6) =       0.000296085936
  error estimate for blocks of size 2^( 7) =       0.000296680444
  error estimate for blocks of size 2^( 8) =       0.000296882239

      target function =                  N/A
              le_mean =     -17.216205556757
             les_mean =     296.709764007770
             stat err =       0.000295963283
             autocorr =       1.176956455343
              std dev =       0.545616674079
             le_variance =       0.297697555033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297676469219
                                         uncertainty =       0.001270262500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297676469219
                                         uncertainty =       0.001270262500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272808337
  error estimate for blocks of size 2^( 2) =       0.000279894525
  error estimate for blocks of size 2^( 3) =       0.000286456029
  error estimate for blocks of size 2^( 4) =       0.000291454107
  error estimate for blocks of size 2^( 5) =       0.000294204512
  error estimate for blocks of size 2^( 6) =       0.000296085936
  error estimate for blocks of size 2^( 7) =       0.000296680444
  error estimate for blocks of size 2^( 8) =       0.000296882239

      target function =                  N/A
              le_mean =     -17.216205556758
             les_mean =     296.709764007340
             stat err =       0.000295963283
             autocorr =       1.176956455329
              std dev =       0.545616674103
             le_variance =       0.297697555059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297676469241
                                         uncertainty =       0.001270262500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297676469241
                                         uncertainty =       0.001270262500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272808337
  error estimate for blocks of size 2^( 2) =       0.000279894525
  error estimate for blocks of size 2^( 3) =       0.000286456029
  error estimate for blocks of size 2^( 4) =       0.000291454107
  error estimate for blocks of size 2^( 5) =       0.000294204513
  error estimate for blocks of size 2^( 6) =       0.000296085936
  error estimate for blocks of size 2^( 7) =       0.000296680444
  error estimate for blocks of size 2^( 8) =       0.000296882239

      target function =                  N/A
              le_mean =     -17.216205556758
             les_mean =     296.709764006964
             stat err =       0.000295963283
             autocorr =       1.176956455297
              std dev =       0.545616674124
             le_variance =       0.297697555082


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216205556758        initial  <--
     2.2204e+06     2.2204e+07             1.1108e-10       -17.216205556757
     8.8818e+06     8.8818e+07             2.7770e-11       -17.216205556758
     3.5527e+07     3.5527e+08             6.9426e-12       -17.216205556758

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.9218
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8401e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2534
    reference variance = 0.202725
====================================================
  Execution time = 2.7261e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0563e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1623e-01
  Total weights = 3.913518903e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9301e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299174586682
                                         uncertainty =       0.001269610799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299174586682
                                         uncertainty =       0.001269610799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273471842
  error estimate for blocks of size 2^( 2) =       0.000280481090
  error estimate for blocks of size 2^( 3) =       0.000286823579
  error estimate for blocks of size 2^( 4) =       0.000291489169
  error estimate for blocks of size 2^( 5) =       0.000294186056
  error estimate for blocks of size 2^( 6) =       0.000295721045
  error estimate for blocks of size 2^( 7) =       0.000297216692
  error estimate for blocks of size 2^( 8) =       0.000298565889

      target function =                  N/A
              le_mean =     -17.216803347680
             les_mean =     296.734548626122
             stat err =       0.000296422421
             autocorr =       1.174889084587
              std dev =       0.546943683012
             le_variance =       0.299147392387


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721680334768e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+07, overlap shift 2.2204e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216803347706       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216803347706       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216803347706       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216803347706       residual = 1.88e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+07 is 1.342118e-11

solving harmonic davidson linear method for identity shift 8.8818e+07, overlap shift 8.8818e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216803347706       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216803347706       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216803347706       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216803347706       residual = 1.88e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+07 is 3.355301e-12

solving harmonic davidson linear method for identity shift 3.5527e+08, overlap shift 3.5527e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216803347706       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216803347706       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216803347706       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216803118155       residual = 1.88e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+08 is 8.388495e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.403465 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2199e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2426
    reference variance = 0.168965
====================================================
  Execution time = 2.9195e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1179e-01
  Total weights = 3.9133e+06
  Execution time = 3.6363e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297905937600
                                         uncertainty =       0.001271811200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297905937600
                                         uncertainty =       0.001271811200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272895525
  error estimate for blocks of size 2^( 2) =       0.000280100324
  error estimate for blocks of size 2^( 3) =       0.000286567427
  error estimate for blocks of size 2^( 4) =       0.000291717643
  error estimate for blocks of size 2^( 5) =       0.000294974076
  error estimate for blocks of size 2^( 6) =       0.000296828915
  error estimate for blocks of size 2^( 7) =       0.000297697517
  error estimate for blocks of size 2^( 8) =       0.000297846064

      target function =                  N/A
              le_mean =     -17.216291714385
             les_mean =     296.712491056456
             stat err =       0.000296836643
             autocorr =       1.183156500844
              std dev =       0.545791050303
             le_variance =       0.297887870591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297905937599
                                         uncertainty =       0.001271811200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297905937599
                                         uncertainty =       0.001271811200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272895525
  error estimate for blocks of size 2^( 2) =       0.000280100324
  error estimate for blocks of size 2^( 3) =       0.000286567427
  error estimate for blocks of size 2^( 4) =       0.000291717643
  error estimate for blocks of size 2^( 5) =       0.000294974076
  error estimate for blocks of size 2^( 6) =       0.000296828915
  error estimate for blocks of size 2^( 7) =       0.000297697517
  error estimate for blocks of size 2^( 8) =       0.000297846064

      target function =                  N/A
              le_mean =     -17.216291714385
             les_mean =     296.712491056410
             stat err =       0.000296836643
             autocorr =       1.183156500844
              std dev =       0.545791050302
             le_variance =       0.297887870590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297905937599
                                         uncertainty =       0.001271811200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297905937599
                                         uncertainty =       0.001271811200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272895525
  error estimate for blocks of size 2^( 2) =       0.000280100324
  error estimate for blocks of size 2^( 3) =       0.000286567427
  error estimate for blocks of size 2^( 4) =       0.000291717643
  error estimate for blocks of size 2^( 5) =       0.000294974076
  error estimate for blocks of size 2^( 6) =       0.000296828915
  error estimate for blocks of size 2^( 7) =       0.000297697517
  error estimate for blocks of size 2^( 8) =       0.000297846064

      target function =                  N/A
              le_mean =     -17.216291714385
             les_mean =     296.712491056433
             stat err =       0.000296836643
             autocorr =       1.183156500841
              std dev =       0.545791050302
             le_variance =       0.297887870590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297905937600
                                         uncertainty =       0.001271811200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297905937600
                                         uncertainty =       0.001271811200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272895525
  error estimate for blocks of size 2^( 2) =       0.000280100324
  error estimate for blocks of size 2^( 3) =       0.000286567427
  error estimate for blocks of size 2^( 4) =       0.000291717643
  error estimate for blocks of size 2^( 5) =       0.000294974076
  error estimate for blocks of size 2^( 6) =       0.000296828915
  error estimate for blocks of size 2^( 7) =       0.000297697517
  error estimate for blocks of size 2^( 8) =       0.000297846064

      target function =                  N/A
              le_mean =     -17.216291714385
             les_mean =     296.712491056453
             stat err =       0.000296836643
             autocorr =       1.183156500839
              std dev =       0.545791050303
             le_variance =       0.297887870591


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216291714385        initial  <--
     2.2204e+07     2.2204e+08             1.3421e-11       -17.216291714385
     8.8818e+07     8.8818e+08             3.3553e-12       -17.216291714385
     3.5527e+08     3.5527e+09             8.3885e-13       -17.216291714385

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.5319
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9739e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.2042
    reference variance = 0.221869
====================================================
  Execution time = 2.7213e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0575e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1170e-01
  Total weights = 3.913508203e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9118e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297277472638
                                         uncertainty =       0.001155256819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297277472638
                                         uncertainty =       0.001155256819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272622995
  error estimate for blocks of size 2^( 2) =       0.000279747424
  error estimate for blocks of size 2^( 3) =       0.000286127205
  error estimate for blocks of size 2^( 4) =       0.000290476603
  error estimate for blocks of size 2^( 5) =       0.000293015806
  error estimate for blocks of size 2^( 6) =       0.000294599925
  error estimate for blocks of size 2^( 7) =       0.000295649104
  error estimate for blocks of size 2^( 8) =       0.000296622166

      target function =                  N/A
              le_mean =     -17.216530973277
             les_mean =     296.720637699988
             stat err =       0.000294971750
             autocorr =       1.170673748041
              std dev =       0.545245990639
             le_variance =       0.297293190308


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721653097328e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+08, overlap shift 2.2204e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216530973302       residual = 7.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216530973302       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216530973302       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216530973302       residual = 9.23e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+08 is 1.411416e-12

solving harmonic davidson linear method for identity shift 8.8818e+08, overlap shift 8.8818e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216530973302       residual = 7.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216530973302       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216530973302       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216530973302       residual = 9.23e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+08 is 3.528539e-13

solving harmonic davidson linear method for identity shift 3.5527e+09, overlap shift 3.5527e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216530973302       residual = 7.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216530973302       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216530973302       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216530973302       residual = 1.15e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+09 is 8.811968e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.404814 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2132e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.1366
    reference variance = 0.216374
====================================================
  Execution time = 2.7269e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1318e-01
  Total weights = 3.9138e+06
  Execution time = 3.6355e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296936184554
                                         uncertainty =       0.001419568238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296936184554
                                         uncertainty =       0.001419568238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272455866
  error estimate for blocks of size 2^( 2) =       0.000279539684
  error estimate for blocks of size 2^( 3) =       0.000286043008
  error estimate for blocks of size 2^( 4) =       0.000291198078
  error estimate for blocks of size 2^( 5) =       0.000293631030
  error estimate for blocks of size 2^( 6) =       0.000295229035
  error estimate for blocks of size 2^( 7) =       0.000295995910
  error estimate for blocks of size 2^( 8) =       0.000296885649

      target function =                  N/A
              le_mean =     -17.216011464577
             les_mean =     296.704230191148
             stat err =       0.000295435406
             autocorr =       1.175798111655
              std dev =       0.544911731531
             le_variance =       0.296928795160

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296936184555
                                         uncertainty =       0.001419568238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296936184555
                                         uncertainty =       0.001419568238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272455866
  error estimate for blocks of size 2^( 2) =       0.000279539684
  error estimate for blocks of size 2^( 3) =       0.000286043008
  error estimate for blocks of size 2^( 4) =       0.000291198078
  error estimate for blocks of size 2^( 5) =       0.000293631030
  error estimate for blocks of size 2^( 6) =       0.000295229035
  error estimate for blocks of size 2^( 7) =       0.000295995910
  error estimate for blocks of size 2^( 8) =       0.000296885649

      target function =                  N/A
              le_mean =     -17.216011464577
             les_mean =     296.704230191143
             stat err =       0.000295435406
             autocorr =       1.175798111662
              std dev =       0.544911731531
             le_variance =       0.296928795160

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296936184555
                                         uncertainty =       0.001419568238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296936184555
                                         uncertainty =       0.001419568238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272455866
  error estimate for blocks of size 2^( 2) =       0.000279539684
  error estimate for blocks of size 2^( 3) =       0.000286043008
  error estimate for blocks of size 2^( 4) =       0.000291198078
  error estimate for blocks of size 2^( 5) =       0.000293631030
  error estimate for blocks of size 2^( 6) =       0.000295229035
  error estimate for blocks of size 2^( 7) =       0.000295995910
  error estimate for blocks of size 2^( 8) =       0.000296885649

      target function =                  N/A
              le_mean =     -17.216011464577
             les_mean =     296.704230191146
             stat err =       0.000295435406
             autocorr =       1.175798111673
              std dev =       0.544911731531
             le_variance =       0.296928795160

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296936184554
                                         uncertainty =       0.001419568238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296936184554
                                         uncertainty =       0.001419568238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272455866
  error estimate for blocks of size 2^( 2) =       0.000279539684
  error estimate for blocks of size 2^( 3) =       0.000286043008
  error estimate for blocks of size 2^( 4) =       0.000291198078
  error estimate for blocks of size 2^( 5) =       0.000293631030
  error estimate for blocks of size 2^( 6) =       0.000295229035
  error estimate for blocks of size 2^( 7) =       0.000295995910
  error estimate for blocks of size 2^( 8) =       0.000296885649

      target function =                  N/A
              le_mean =     -17.216011464577
             les_mean =     296.704230191148
             stat err =       0.000295435406
             autocorr =       1.175798111668
              std dev =       0.544911731531
             le_variance =       0.296928795160


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216011464577        initial  <--
     2.2204e+08     2.2204e+09             1.4114e-12       -17.216011464577
     8.8818e+08     8.8818e+09             3.5285e-13       -17.216011464577
     3.5527e+09     3.5527e+10             8.8120e-14       -17.216011464577

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5780
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7720e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.2558
    reference variance = 2.55705
====================================================
  Execution time = 2.7269e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0578e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1737e-01
  Total weights = 3.913544108e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9288e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300769544094
                                         uncertainty =       0.001738600481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300769544094
                                         uncertainty =       0.001738600481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274242254
  error estimate for blocks of size 2^( 2) =       0.000281227912
  error estimate for blocks of size 2^( 3) =       0.000287819534
  error estimate for blocks of size 2^( 4) =       0.000292544826
  error estimate for blocks of size 2^( 5) =       0.000295242057
  error estimate for blocks of size 2^( 6) =       0.000296590333
  error estimate for blocks of size 2^( 7) =       0.000297915002
  error estimate for blocks of size 2^( 8) =       0.000298511453

      target function =                  N/A
              le_mean =     -17.216114715182
             les_mean =     296.711980228629
             stat err =       0.000297064711
             autocorr =       1.173365699842
              std dev =       0.548484508604
             le_variance =       0.300835256179


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721611471518e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+09, overlap shift 2.2204e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216114715202       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216114715202       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216114715202       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216114112950       residual = 2.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+09 is 9.336423e-14

solving harmonic davidson linear method for identity shift 8.8818e+09, overlap shift 8.8818e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216114715202       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216114715202       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216114715202       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216114715202       residual = 2.04e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+09 is 2.334185e-14

solving harmonic davidson linear method for identity shift 3.5527e+10, overlap shift 3.5527e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216114715202       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216114715202       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216114715202       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216114715202       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+10 is 5.899847e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.406172 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2205e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.3272
    reference variance = 0.792521
====================================================
  Execution time = 2.7083e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1069e-01
  Total weights = 3.9132e+06
  Execution time = 3.6442e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298201960535
                                         uncertainty =       0.001317076113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298201960535
                                         uncertainty =       0.001317076113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273084732
  error estimate for blocks of size 2^( 2) =       0.000280173256
  error estimate for blocks of size 2^( 3) =       0.000286683916
  error estimate for blocks of size 2^( 4) =       0.000291249086
  error estimate for blocks of size 2^( 5) =       0.000294182453
  error estimate for blocks of size 2^( 6) =       0.000296119342
  error estimate for blocks of size 2^( 7) =       0.000296788831
  error estimate for blocks of size 2^( 8) =       0.000297275955

      target function =                  N/A
              le_mean =     -17.216506416391
             les_mean =     296.718786607708
             stat err =       0.000296091645
             autocorr =       1.175594290488
              std dev =       0.546169463240
             le_variance =       0.298301082576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298201960535
                                         uncertainty =       0.001317076113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298201960535
                                         uncertainty =       0.001317076113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273084732
  error estimate for blocks of size 2^( 2) =       0.000280173256
  error estimate for blocks of size 2^( 3) =       0.000286683916
  error estimate for blocks of size 2^( 4) =       0.000291249086
  error estimate for blocks of size 2^( 5) =       0.000294182453
  error estimate for blocks of size 2^( 6) =       0.000296119342
  error estimate for blocks of size 2^( 7) =       0.000296788831
  error estimate for blocks of size 2^( 8) =       0.000297275955

      target function =                  N/A
              le_mean =     -17.216506416391
             les_mean =     296.718786607708
             stat err =       0.000296091645
             autocorr =       1.175594290488
              std dev =       0.546169463240
             le_variance =       0.298301082576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298201960535
                                         uncertainty =       0.001317076113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298201960535
                                         uncertainty =       0.001317076113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273084732
  error estimate for blocks of size 2^( 2) =       0.000280173256
  error estimate for blocks of size 2^( 3) =       0.000286683916
  error estimate for blocks of size 2^( 4) =       0.000291249086
  error estimate for blocks of size 2^( 5) =       0.000294182453
  error estimate for blocks of size 2^( 6) =       0.000296119342
  error estimate for blocks of size 2^( 7) =       0.000296788831
  error estimate for blocks of size 2^( 8) =       0.000297275955

      target function =                  N/A
              le_mean =     -17.216506416391
             les_mean =     296.718786607708
             stat err =       0.000296091645
             autocorr =       1.175594290495
              std dev =       0.546169463240
             le_variance =       0.298301082576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298201960535
                                         uncertainty =       0.001317076113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298201960535
                                         uncertainty =       0.001317076113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273084732
  error estimate for blocks of size 2^( 2) =       0.000280173256
  error estimate for blocks of size 2^( 3) =       0.000286683916
  error estimate for blocks of size 2^( 4) =       0.000291249086
  error estimate for blocks of size 2^( 5) =       0.000294182453
  error estimate for blocks of size 2^( 6) =       0.000296119342
  error estimate for blocks of size 2^( 7) =       0.000296788831
  error estimate for blocks of size 2^( 8) =       0.000297275955

      target function =                  N/A
              le_mean =     -17.216506416391
             les_mean =     296.718786607708
             stat err =       0.000296091645
             autocorr =       1.175594290488
              std dev =       0.546169463240
             le_variance =       0.298301082576


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216506416391        initial
     2.2204e+09     2.2204e+10             9.3364e-14       -17.216506416391
     8.8818e+09     8.8818e+10             2.3342e-14       -17.216506416391
     3.5527e+10     3.5527e+11             5.8998e-15       -17.216506416391  <--

*****************************************************************************
Applying the update for shift_i =   3.5527e+10     and shift_s =   3.5527e+11
*****************************************************************************

  Execution time = 4.5454e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7667e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.199
    reference variance = 0.269548
====================================================
  Execution time = 2.7247e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0560e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1723e-01
  Total weights = 3.913085717e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9193e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302043579103
                                         uncertainty =       0.001649069724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302043579103
                                         uncertainty =       0.001649069724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274847341
  error estimate for blocks of size 2^( 2) =       0.000281816799
  error estimate for blocks of size 2^( 3) =       0.000288099349
  error estimate for blocks of size 2^( 4) =       0.000292657909
  error estimate for blocks of size 2^( 5) =       0.000295675174
  error estimate for blocks of size 2^( 6) =       0.000297213781
  error estimate for blocks of size 2^( 7) =       0.000297902214
  error estimate for blocks of size 2^( 8) =       0.000298437708

      target function =                  N/A
              le_mean =     -17.216293807189
             les_mean =     296.718005913469
             stat err =       0.000297307219
             autocorr =       1.170113069723
              std dev =       0.549694682328
             le_variance =       0.302164243780


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721629380719e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+09, overlap shift 8.8818e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216293807208       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216293807208       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216293807208       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216293807208       residual = 2.10e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+09 is 4.972622e-14

solving harmonic davidson linear method for identity shift 3.5527e+10, overlap shift 3.5527e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216293807208       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216293807208       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216293807208       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216293807208       residual = 8.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+10 is 1.246612e-14

solving harmonic davidson linear method for identity shift 1.4211e+11, overlap shift 1.4211e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216293807208       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216293807208       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216293807208       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216293807208       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216293807207       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216249775431       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216368545684       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216358232112       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216118356276       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216197533296       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216445004290       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216064540577       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216413243565       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216309103993       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216179496083       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216450193853       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216767007339       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216120092867       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216095594496       residual = 1.65e-06           smallest_sin_value = 9.99e-01
davidson iteration   19:   krylov dim =  20   energy =     -17.216409794531       residual = 7.60e-07           smallest_sin_value = 9.94e-01
davidson iteration   20 stopping due to small subspace S singular value of 9.44e-01
davidson solver did not converge after         20 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+11 is 3.111774e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.422799 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2189e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.221
    reference variance = 0.176084
====================================================
  Execution time = 2.7371e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1105e-01
  Total weights = 3.9134e+06
  Execution time = 3.6265e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296633789401
                                         uncertainty =       0.001544126681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296633789401
                                         uncertainty =       0.001544126681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272300265
  error estimate for blocks of size 2^( 2) =       0.000279385827
  error estimate for blocks of size 2^( 3) =       0.000285878384
  error estimate for blocks of size 2^( 4) =       0.000290891161
  error estimate for blocks of size 2^( 5) =       0.000293572228
  error estimate for blocks of size 2^( 6) =       0.000295858935
  error estimate for blocks of size 2^( 7) =       0.000297639867
  error estimate for blocks of size 2^( 8) =       0.000297498736

      target function =                  N/A
              le_mean =     -17.216460303994
             les_mean =     296.717559266887
             stat err =       0.000296142442
             autocorr =       1.182783278530
              std dev =       0.544600530764
             le_variance =       0.296589738109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296633789401
                                         uncertainty =       0.001544126681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296633789401
                                         uncertainty =       0.001544126681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272300265
  error estimate for blocks of size 2^( 2) =       0.000279385827
  error estimate for blocks of size 2^( 3) =       0.000285878384
  error estimate for blocks of size 2^( 4) =       0.000290891161
  error estimate for blocks of size 2^( 5) =       0.000293572228
  error estimate for blocks of size 2^( 6) =       0.000295858935
  error estimate for blocks of size 2^( 7) =       0.000297639867
  error estimate for blocks of size 2^( 8) =       0.000297498736

      target function =                  N/A
              le_mean =     -17.216460303994
             les_mean =     296.717559266887
             stat err =       0.000296142442
             autocorr =       1.182783278523
              std dev =       0.544600530764
             le_variance =       0.296589738109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296633789401
                                         uncertainty =       0.001544126681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296633789401
                                         uncertainty =       0.001544126681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272300265
  error estimate for blocks of size 2^( 2) =       0.000279385827
  error estimate for blocks of size 2^( 3) =       0.000285878384
  error estimate for blocks of size 2^( 4) =       0.000290891161
  error estimate for blocks of size 2^( 5) =       0.000293572228
  error estimate for blocks of size 2^( 6) =       0.000295858935
  error estimate for blocks of size 2^( 7) =       0.000297639867
  error estimate for blocks of size 2^( 8) =       0.000297498736

      target function =                  N/A
              le_mean =     -17.216460303994
             les_mean =     296.717559266887
             stat err =       0.000296142442
             autocorr =       1.182783278520
              std dev =       0.544600530764
             le_variance =       0.296589738109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296633789401
                                         uncertainty =       0.001544126681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296633789401
                                         uncertainty =       0.001544126681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272300265
  error estimate for blocks of size 2^( 2) =       0.000279385827
  error estimate for blocks of size 2^( 3) =       0.000285878384
  error estimate for blocks of size 2^( 4) =       0.000290891161
  error estimate for blocks of size 2^( 5) =       0.000293572228
  error estimate for blocks of size 2^( 6) =       0.000295858935
  error estimate for blocks of size 2^( 7) =       0.000297639867
  error estimate for blocks of size 2^( 8) =       0.000297498736

      target function =                  N/A
              le_mean =     -17.216460303994
             les_mean =     296.717559266887
             stat err =       0.000296142442
             autocorr =       1.182783278525
              std dev =       0.544600530764
             le_variance =       0.296589738109


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216460303994        initial
     8.8818e+09     8.8818e+10             4.9726e-14       -17.216460303994
     3.5527e+10     3.5527e+11             1.2466e-14       -17.216460303994  <--
     1.4211e+11     1.4211e+12             3.1118e-15       -17.216460303994

*****************************************************************************
Applying the update for shift_i =   3.5527e+10     and shift_s =   3.5527e+11
*****************************************************************************

  Execution time = 4.5645e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7845e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.2452
    reference variance = 0.308824
====================================================
  Execution time = 2.9702e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0563e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1413e-01
  Total weights = 3.913222990e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9208e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300132832111
                                         uncertainty =       0.001508894052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300132832111
                                         uncertainty =       0.001508894052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273905842
  error estimate for blocks of size 2^( 2) =       0.000280944692
  error estimate for blocks of size 2^( 3) =       0.000287172598
  error estimate for blocks of size 2^( 4) =       0.000291748741
  error estimate for blocks of size 2^( 5) =       0.000294348850
  error estimate for blocks of size 2^( 6) =       0.000296382600
  error estimate for blocks of size 2^( 7) =       0.000296882680
  error estimate for blocks of size 2^( 8) =       0.000298299653

      target function =                  N/A
              le_mean =     -17.216463934873
             les_mean =     296.720762272457
             stat err =       0.000296478446
             autocorr =       1.171611596220
              std dev =       0.547811683635
             le_variance =       0.300097640727


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721646393487e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+09, overlap shift 8.8818e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216463934890       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216463934890       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216463934890       residual = 6.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+09 is 3.495124e-14

solving harmonic davidson linear method for identity shift 3.5527e+10, overlap shift 3.5527e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216463934890       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216463934890       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216463934890       residual = 8.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+10 is 8.706340e-15

solving harmonic davidson linear method for identity shift 1.4211e+11, overlap shift 1.4211e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216463934890       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216463934890       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216463934890       residual = 6.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+11 is 2.184328e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.423890 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4630e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.1998
    reference variance = 0.21322
====================================================
  Execution time = 2.7049e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1730e-01
  Total weights = 3.9136e+06
  Execution time = 3.6376e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300014660005
                                         uncertainty =       0.001445830649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300014660005
                                         uncertainty =       0.001445830649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273890473
  error estimate for blocks of size 2^( 2) =       0.000281144436
  error estimate for blocks of size 2^( 3) =       0.000287618893
  error estimate for blocks of size 2^( 4) =       0.000292368986
  error estimate for blocks of size 2^( 5) =       0.000295476069
  error estimate for blocks of size 2^( 6) =       0.000297040093
  error estimate for blocks of size 2^( 7) =       0.000300036064
  error estimate for blocks of size 2^( 8) =       0.000298519518

      target function =                  N/A
              le_mean =     -17.217016318778
             les_mean =     296.742955303039
             stat err =       0.000297767936
             autocorr =       1.181957907616
              std dev =       0.547780945281
             le_variance =       0.300063964013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300014660005
                                         uncertainty =       0.001445830649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300014660005
                                         uncertainty =       0.001445830649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273890473
  error estimate for blocks of size 2^( 2) =       0.000281144436
  error estimate for blocks of size 2^( 3) =       0.000287618893
  error estimate for blocks of size 2^( 4) =       0.000292368986
  error estimate for blocks of size 2^( 5) =       0.000295476069
  error estimate for blocks of size 2^( 6) =       0.000297040093
  error estimate for blocks of size 2^( 7) =       0.000300036064
  error estimate for blocks of size 2^( 8) =       0.000298519518

      target function =                  N/A
              le_mean =     -17.217016318778
             les_mean =     296.742955303039
             stat err =       0.000297767936
             autocorr =       1.181957907616
              std dev =       0.547780945281
             le_variance =       0.300063964013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300014660005
                                         uncertainty =       0.001445830649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300014660005
                                         uncertainty =       0.001445830649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273890473
  error estimate for blocks of size 2^( 2) =       0.000281144436
  error estimate for blocks of size 2^( 3) =       0.000287618893
  error estimate for blocks of size 2^( 4) =       0.000292368986
  error estimate for blocks of size 2^( 5) =       0.000295476069
  error estimate for blocks of size 2^( 6) =       0.000297040093
  error estimate for blocks of size 2^( 7) =       0.000300036064
  error estimate for blocks of size 2^( 8) =       0.000298519518

      target function =                  N/A
              le_mean =     -17.217016318778
             les_mean =     296.742955303039
             stat err =       0.000297767936
             autocorr =       1.181957907610
              std dev =       0.547780945281
             le_variance =       0.300063964013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300014660005
                                         uncertainty =       0.001445830649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300014660005
                                         uncertainty =       0.001445830649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273890473
  error estimate for blocks of size 2^( 2) =       0.000281144436
  error estimate for blocks of size 2^( 3) =       0.000287618893
  error estimate for blocks of size 2^( 4) =       0.000292368986
  error estimate for blocks of size 2^( 5) =       0.000295476069
  error estimate for blocks of size 2^( 6) =       0.000297040093
  error estimate for blocks of size 2^( 7) =       0.000300036064
  error estimate for blocks of size 2^( 8) =       0.000298519518

      target function =                  N/A
              le_mean =     -17.217016318778
             les_mean =     296.742955303039
             stat err =       0.000297767936
             autocorr =       1.181957907616
              std dev =       0.547780945281
             le_variance =       0.300063964013


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217016318778        initial  <--
     8.8818e+09     8.8818e+10             3.4951e-14       -17.217016318778
     3.5527e+10     3.5527e+11             8.7063e-15       -17.217016318778
     1.4211e+11     1.4211e+12             2.1843e-15       -17.217016318778

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.3937
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0032e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.166
    reference variance = 0.252282
====================================================
  Execution time = 2.7354e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0578e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1084e-01
  Total weights = 3.913772785e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9182e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296166347620
                                         uncertainty =       0.001215488362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296166347620
                                         uncertainty =       0.001215488362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272099358
  error estimate for blocks of size 2^( 2) =       0.000279257040
  error estimate for blocks of size 2^( 3) =       0.000285567043
  error estimate for blocks of size 2^( 4) =       0.000290081054
  error estimate for blocks of size 2^( 5) =       0.000292843276
  error estimate for blocks of size 2^( 6) =       0.000294386322
  error estimate for blocks of size 2^( 7) =       0.000294225950
  error estimate for blocks of size 2^( 8) =       0.000294965919

      target function =                  N/A
              le_mean =     -17.216832777834
             les_mean =     296.730171991672
             stat err =       0.000294105367
             autocorr =       1.168290557049
              std dev =       0.544198715082
             le_variance =       0.296152241497


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721683277783e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+10, overlap shift 8.8818e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216832777850       residual = 9.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216832777850       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216832777850       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216832777850       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216819150765       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+10 is 2.867469e-15

solving harmonic davidson linear method for identity shift 3.5527e+11, overlap shift 3.5527e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216832777850       residual = 9.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216832777850       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216832777850       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216832777850       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216812933838       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216929082523       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216832478880       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216846368539       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217338742242       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216936325287       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217250029878       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216714188922       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216541116266       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216599613425       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216894732377       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217351851837       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216481829519       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216835567128       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217248015457       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216373963156       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216904425744       residual = 2.70e-06           smallest_sin_value = 9.96e-01
davidson iteration   21 stopping due to small subspace S singular value of 9.35e-01
davidson solver did not converge after         21 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+11 is 7.084307e-16

solving harmonic davidson linear method for identity shift 1.4211e+12, overlap shift 1.4211e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216832777850       residual = 9.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216832777850       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216832777850       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216573811025       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216642401182       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216685801605       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216495689739       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216687536247       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217438716841       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216349310828       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215203112792       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217958572075       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.219070251657       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217526033363       residual = 8.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215222571876       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217503942427       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.218026236775       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.218697821219       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217039079465       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.215906382422       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.219710431107       residual = 5.17e-05           smallest_sin_value = 9.99e-01
davidson iteration   21 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         21 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+12 is 1.742310e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.436007 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2290e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.2467
    reference variance = 0.148382
====================================================
  Execution time = 2.7190e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1015e-01
  Total weights = 3.9130e+06
  Execution time = 3.6340e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296106092407
                                         uncertainty =       0.001303461040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296106092407
                                         uncertainty =       0.001303461040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272080154
  error estimate for blocks of size 2^( 2) =       0.000279408694
  error estimate for blocks of size 2^( 3) =       0.000285688146
  error estimate for blocks of size 2^( 4) =       0.000290502186
  error estimate for blocks of size 2^( 5) =       0.000293398370
  error estimate for blocks of size 2^( 6) =       0.000294609870
  error estimate for blocks of size 2^( 7) =       0.000294297250
  error estimate for blocks of size 2^( 8) =       0.000294410285

      target function =                  N/A
              le_mean =     -17.216524715368
             les_mean =     296.718871389041
             stat err =       0.000294178944
             autocorr =       1.169040177938
              std dev =       0.544160308861
             le_variance =       0.296110441739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296106092407
                                         uncertainty =       0.001303461040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296106092407
                                         uncertainty =       0.001303461040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272080154
  error estimate for blocks of size 2^( 2) =       0.000279408694
  error estimate for blocks of size 2^( 3) =       0.000285688146
  error estimate for blocks of size 2^( 4) =       0.000290502186
  error estimate for blocks of size 2^( 5) =       0.000293398370
  error estimate for blocks of size 2^( 6) =       0.000294609870
  error estimate for blocks of size 2^( 7) =       0.000294297250
  error estimate for blocks of size 2^( 8) =       0.000294410285

      target function =                  N/A
              le_mean =     -17.216524715368
             les_mean =     296.718871389041
             stat err =       0.000294178944
             autocorr =       1.169040177927
              std dev =       0.544160308861
             le_variance =       0.296110441739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296106092407
                                         uncertainty =       0.001303461040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296106092407
                                         uncertainty =       0.001303461040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272080154
  error estimate for blocks of size 2^( 2) =       0.000279408694
  error estimate for blocks of size 2^( 3) =       0.000285688146
  error estimate for blocks of size 2^( 4) =       0.000290502186
  error estimate for blocks of size 2^( 5) =       0.000293398370
  error estimate for blocks of size 2^( 6) =       0.000294609870
  error estimate for blocks of size 2^( 7) =       0.000294297250
  error estimate for blocks of size 2^( 8) =       0.000294410285

      target function =                  N/A
              le_mean =     -17.216524715368
             les_mean =     296.718871389041
             stat err =       0.000294178944
             autocorr =       1.169040177938
              std dev =       0.544160308861
             le_variance =       0.296110441739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296106092407
                                         uncertainty =       0.001303461040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296106092407
                                         uncertainty =       0.001303461040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272080154
  error estimate for blocks of size 2^( 2) =       0.000279408694
  error estimate for blocks of size 2^( 3) =       0.000285688146
  error estimate for blocks of size 2^( 4) =       0.000290502186
  error estimate for blocks of size 2^( 5) =       0.000293398370
  error estimate for blocks of size 2^( 6) =       0.000294609870
  error estimate for blocks of size 2^( 7) =       0.000294297250
  error estimate for blocks of size 2^( 8) =       0.000294410285

      target function =                  N/A
              le_mean =     -17.216524715368
             les_mean =     296.718871389041
             stat err =       0.000294178944
             autocorr =       1.169040177940
              std dev =       0.544160308861
             le_variance =       0.296110441739


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216524715368        initial  <--
     8.8818e+10     8.8818e+11             2.8675e-15       -17.216524715368
     3.5527e+11     3.5527e+12             7.0843e-16       -17.216524715368
     1.4211e+12     1.4211e+13             1.7423e-16       -17.216524715368

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5268
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7827e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.1918
    reference variance = 0.288798
====================================================
  Execution time = 2.7226e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0585e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1554e-01
  Total weights = 3.913388504e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9362e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300677997659
                                         uncertainty =       0.001745779282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300677997659
                                         uncertainty =       0.001745779282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274172551
  error estimate for blocks of size 2^( 2) =       0.000281044895
  error estimate for blocks of size 2^( 3) =       0.000287593739
  error estimate for blocks of size 2^( 4) =       0.000292402934
  error estimate for blocks of size 2^( 5) =       0.000295204681
  error estimate for blocks of size 2^( 6) =       0.000297441488
  error estimate for blocks of size 2^( 7) =       0.000297726763
  error estimate for blocks of size 2^( 8) =       0.000298075754

      target function =                  N/A
              le_mean =     -17.216469457148
             les_mean =     296.722355610159
             stat err =       0.000297112172
             autocorr =       1.174337529212
              std dev =       0.548345102784
             le_variance =       0.300682351747


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721646945715e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+11, overlap shift 8.8818e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216469457169       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216469457169       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216469457169       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216469457169       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217354699873       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216420950087       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217197289747       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216361466231       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216085237463       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217556264000       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216337196787       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216245167228       residual = 8.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215937401475       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.214841593305       residual = 8.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.214795918028       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216832105880       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216183948657       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216750431759       residual = 9.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217681448295       residual = 1.76e-04           smallest_sin_value = 9.96e-01
davidson iteration   19 stopping due to small subspace S singular value of 9.77e-01
davidson solver did not converge after         19 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+11 is 3.544153e-16

solving harmonic davidson linear method for identity shift 3.5527e+12, overlap shift 3.5527e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216469457169       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216469457169       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216469457169       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216448982374       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216119345039       residual = 8.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213921186404       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216106389707       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.218256504884       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217049671407       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212701847003       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216542437596       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217140687003       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215813019986       residual = 6.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216456208765       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213886160712       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217266123758       residual = 6.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215513110109       residual = 5.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.214708587049       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.213217922826       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.220290183342       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.215439432566       residual = 7.31e-04           smallest_sin_value = 9.99e-01
davidson iteration   21:   krylov dim =  22   energy =     -17.213977326680       residual = 1.61e-03           smallest_sin_value = 9.93e-01
davidson iteration   22 stopping due to small subspace S singular value of 9.60e-01
davidson solver did not converge after         22 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+12 is 8.352457e-17

solving harmonic davidson linear method for identity shift 1.4211e+13, overlap shift 1.4211e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216469457169       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216469457169       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.37e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.447271 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2179e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.1177
    reference variance = 0.294046
====================================================
  Execution time = 2.7351e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1818e-01
  Total weights = 3.9130e+06
  Execution time = 3.6379e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301448925766
                                         uncertainty =       0.001825520493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301448925766
                                         uncertainty =       0.001825520493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274515905
  error estimate for blocks of size 2^( 2) =       0.000281535418
  error estimate for blocks of size 2^( 3) =       0.000287976210
  error estimate for blocks of size 2^( 4) =       0.000292472912
  error estimate for blocks of size 2^( 5) =       0.000295669810
  error estimate for blocks of size 2^( 6) =       0.000297695155
  error estimate for blocks of size 2^( 7) =       0.000298493023
  error estimate for blocks of size 2^( 8) =       0.000297725045

      target function =                  N/A
              le_mean =     -17.216108191743
             les_mean =     296.712563825800
             stat err =       0.000297395758
             autocorr =       1.173638952180
              std dev =       0.549031810821
             le_variance =       0.301435929294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301448925766
                                         uncertainty =       0.001825520493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301448925766
                                         uncertainty =       0.001825520493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274515905
  error estimate for blocks of size 2^( 2) =       0.000281535418
  error estimate for blocks of size 2^( 3) =       0.000287976210
  error estimate for blocks of size 2^( 4) =       0.000292472912
  error estimate for blocks of size 2^( 5) =       0.000295669810
  error estimate for blocks of size 2^( 6) =       0.000297695155
  error estimate for blocks of size 2^( 7) =       0.000298493023
  error estimate for blocks of size 2^( 8) =       0.000297725045

      target function =                  N/A
              le_mean =     -17.216108191743
             les_mean =     296.712563825800
             stat err =       0.000297395758
             autocorr =       1.173638952193
              std dev =       0.549031810821
             le_variance =       0.301435929294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301448925766
                                         uncertainty =       0.001825520493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301448925766
                                         uncertainty =       0.001825520493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274515905
  error estimate for blocks of size 2^( 2) =       0.000281535418
  error estimate for blocks of size 2^( 3) =       0.000287976210
  error estimate for blocks of size 2^( 4) =       0.000292472912
  error estimate for blocks of size 2^( 5) =       0.000295669810
  error estimate for blocks of size 2^( 6) =       0.000297695155
  error estimate for blocks of size 2^( 7) =       0.000298493023
  error estimate for blocks of size 2^( 8) =       0.000297725045

      target function =                  N/A
              le_mean =     -17.216108191743
             les_mean =     296.712563825800
             stat err =       0.000297395758
             autocorr =       1.173638952192
              std dev =       0.549031810821
             le_variance =       0.301435929294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301448925766
                                         uncertainty =       0.001825520493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301448925766
                                         uncertainty =       0.001825520493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274515905
  error estimate for blocks of size 2^( 2) =       0.000281535418
  error estimate for blocks of size 2^( 3) =       0.000287976210
  error estimate for blocks of size 2^( 4) =       0.000292472912
  error estimate for blocks of size 2^( 5) =       0.000295669810
  error estimate for blocks of size 2^( 6) =       0.000297695155
  error estimate for blocks of size 2^( 7) =       0.000298493023
  error estimate for blocks of size 2^( 8) =       0.000297725045

      target function =                  N/A
              le_mean =     -17.216108191743
             les_mean =     296.712563825800
             stat err =       0.000297395758
             autocorr =       1.173638952180
              std dev =       0.549031810821
             le_variance =       0.301435929294


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216108191743        initial  <--
     8.8818e+11     8.8818e+12             3.5442e-16       -17.216108191743
     3.5527e+12     3.5527e+13             8.3525e-17       -17.216108191743
     1.4211e+13     1.4211e+14             0.0000e+00       -17.216108191743

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.8663
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8053e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.2219
    reference variance = 0.409031
====================================================
  Execution time = 2.7032e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0588e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1099e-01
  Total weights = 3.913397426e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9220e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297557922365
                                         uncertainty =       0.001419594101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297557922365
                                         uncertainty =       0.001419594101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272744494
  error estimate for blocks of size 2^( 2) =       0.000279758335
  error estimate for blocks of size 2^( 3) =       0.000286422708
  error estimate for blocks of size 2^( 4) =       0.000290768221
  error estimate for blocks of size 2^( 5) =       0.000293387719
  error estimate for blocks of size 2^( 6) =       0.000295290954
  error estimate for blocks of size 2^( 7) =       0.000296027668
  error estimate for blocks of size 2^( 8) =       0.000296437731

      target function =                  N/A
              le_mean =     -17.216474474388
             les_mean =     296.717987518064
             stat err =       0.000295286018
             autocorr =       1.172124605543
              std dev =       0.545488987191
             le_variance =       0.297558235146


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721647447439e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+12, overlap shift 8.8818e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216474474417       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216474474417       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 9.61e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.5527e+13, overlap shift 3.5527e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216474474417       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216474474417       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 9.61e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4211e+14, overlap shift 1.4211e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216474474417       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216474474417       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 9.61e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.448318 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1961e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.1339
    reference variance = 0.998069
====================================================
  Execution time = 2.7269e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1764e-01
  Total weights = 3.9136e+06
  Execution time = 3.6300e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300079322065
                                         uncertainty =       0.002489101665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300079322065
                                         uncertainty =       0.002489101665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273913711
  error estimate for blocks of size 2^( 2) =       0.000280920271
  error estimate for blocks of size 2^( 3) =       0.000287495546
  error estimate for blocks of size 2^( 4) =       0.000292348005
  error estimate for blocks of size 2^( 5) =       0.000295332598
  error estimate for blocks of size 2^( 6) =       0.000297366872
  error estimate for blocks of size 2^( 7) =       0.000297880234
  error estimate for blocks of size 2^( 8) =       0.000297907752

      target function =                  N/A
              le_mean =     -17.216425697663
             les_mean =     296.722954745867
             stat err =       0.000297121864
             autocorr =       1.176634770235
              std dev =       0.547827422585
             le_variance =       0.300114884936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300079322065
                                         uncertainty =       0.002489101665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300079322065
                                         uncertainty =       0.002489101665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273913711
  error estimate for blocks of size 2^( 2) =       0.000280920271
  error estimate for blocks of size 2^( 3) =       0.000287495546
  error estimate for blocks of size 2^( 4) =       0.000292348005
  error estimate for blocks of size 2^( 5) =       0.000295332598
  error estimate for blocks of size 2^( 6) =       0.000297366872
  error estimate for blocks of size 2^( 7) =       0.000297880234
  error estimate for blocks of size 2^( 8) =       0.000297907752

      target function =                  N/A
              le_mean =     -17.216425697663
             les_mean =     296.722954745867
             stat err =       0.000297121864
             autocorr =       1.176634770235
              std dev =       0.547827422585
             le_variance =       0.300114884936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300079322065
                                         uncertainty =       0.002489101665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300079322065
                                         uncertainty =       0.002489101665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273913711
  error estimate for blocks of size 2^( 2) =       0.000280920271
  error estimate for blocks of size 2^( 3) =       0.000287495546
  error estimate for blocks of size 2^( 4) =       0.000292348005
  error estimate for blocks of size 2^( 5) =       0.000295332598
  error estimate for blocks of size 2^( 6) =       0.000297366872
  error estimate for blocks of size 2^( 7) =       0.000297880234
  error estimate for blocks of size 2^( 8) =       0.000297907752

      target function =                  N/A
              le_mean =     -17.216425697663
             les_mean =     296.722954745867
             stat err =       0.000297121864
             autocorr =       1.176634770235
              std dev =       0.547827422585
             le_variance =       0.300114884936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300079322065
                                         uncertainty =       0.002489101665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300079322065
                                         uncertainty =       0.002489101665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273913711
  error estimate for blocks of size 2^( 2) =       0.000280920271
  error estimate for blocks of size 2^( 3) =       0.000287495546
  error estimate for blocks of size 2^( 4) =       0.000292348005
  error estimate for blocks of size 2^( 5) =       0.000295332598
  error estimate for blocks of size 2^( 6) =       0.000297366872
  error estimate for blocks of size 2^( 7) =       0.000297880234
  error estimate for blocks of size 2^( 8) =       0.000297907752

      target function =                  N/A
              le_mean =     -17.216425697663
             les_mean =     296.722954745867
             stat err =       0.000297121864
             autocorr =       1.176634770235
              std dev =       0.547827422585
             le_variance =       0.300114884936


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216425697663        initial  <--
     8.8818e+12     8.8818e+13             0.0000e+00       -17.216425697663
     3.5527e+13     3.5527e+14             0.0000e+00       -17.216425697663
     1.4211e+14     1.4211e+15             0.0000e+00       -17.216425697663

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.7665
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7736e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.2885
    reference variance = 0.839766
====================================================
  Execution time = 2.9537e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0600e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3131e-01
  Total weights = 3.913421314e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9465e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300194067348
                                         uncertainty =       0.001723140224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300194067348
                                         uncertainty =       0.001723140224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273961945
  error estimate for blocks of size 2^( 2) =       0.000280867001
  error estimate for blocks of size 2^( 3) =       0.000287246314
  error estimate for blocks of size 2^( 4) =       0.000292050495
  error estimate for blocks of size 2^( 5) =       0.000294828707
  error estimate for blocks of size 2^( 6) =       0.000296465691
  error estimate for blocks of size 2^( 7) =       0.000297137180
  error estimate for blocks of size 2^( 8) =       0.000298482842

      target function =                  N/A
              le_mean =     -17.216686027945
             les_mean =     296.745592383067
             stat err =       0.000296728605
             autocorr =       1.173108948952
              std dev =       0.547923890253
             le_variance =       0.300220589510


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721668602795e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+13, overlap shift 8.8818e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216686027978       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216686027978       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.39e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.5527e+14, overlap shift 3.5527e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216686027978       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216686027978       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.39e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4211e+15, overlap shift 1.4211e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216686027978       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216686027978       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.39e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.449371 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4490e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.2426
    reference variance = 0.192401
====================================================
  Execution time = 2.6850e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1467e-01
  Total weights = 3.9130e+06
  Execution time = 3.6452e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299575064673
                                         uncertainty =       0.001126791074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299575064673
                                         uncertainty =       0.001126791074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273636709
  error estimate for blocks of size 2^( 2) =       0.000280864993
  error estimate for blocks of size 2^( 3) =       0.000287510676
  error estimate for blocks of size 2^( 4) =       0.000292455274
  error estimate for blocks of size 2^( 5) =       0.000295415819
  error estimate for blocks of size 2^( 6) =       0.000296906778
  error estimate for blocks of size 2^( 7) =       0.000297847075
  error estimate for blocks of size 2^( 8) =       0.000297986781

      target function =                  N/A
              le_mean =     -17.216632441470
             les_mean =     296.727102887394
             stat err =       0.000297039113
             autocorr =       1.178361548301
              std dev =       0.547273417954
             le_variance =       0.299508193999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299575064673
                                         uncertainty =       0.001126791074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299575064673
                                         uncertainty =       0.001126791074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273636709
  error estimate for blocks of size 2^( 2) =       0.000280864993
  error estimate for blocks of size 2^( 3) =       0.000287510676
  error estimate for blocks of size 2^( 4) =       0.000292455274
  error estimate for blocks of size 2^( 5) =       0.000295415819
  error estimate for blocks of size 2^( 6) =       0.000296906778
  error estimate for blocks of size 2^( 7) =       0.000297847075
  error estimate for blocks of size 2^( 8) =       0.000297986781

      target function =                  N/A
              le_mean =     -17.216632441470
             les_mean =     296.727102887394
             stat err =       0.000297039113
             autocorr =       1.178361548301
              std dev =       0.547273417954
             le_variance =       0.299508193999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299575064673
                                         uncertainty =       0.001126791074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299575064673
                                         uncertainty =       0.001126791074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273636709
  error estimate for blocks of size 2^( 2) =       0.000280864993
  error estimate for blocks of size 2^( 3) =       0.000287510676
  error estimate for blocks of size 2^( 4) =       0.000292455274
  error estimate for blocks of size 2^( 5) =       0.000295415819
  error estimate for blocks of size 2^( 6) =       0.000296906778
  error estimate for blocks of size 2^( 7) =       0.000297847075
  error estimate for blocks of size 2^( 8) =       0.000297986781

      target function =                  N/A
              le_mean =     -17.216632441470
             les_mean =     296.727102887394
             stat err =       0.000297039113
             autocorr =       1.178361548301
              std dev =       0.547273417954
             le_variance =       0.299508193999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299575064673
                                         uncertainty =       0.001126791074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299575064673
                                         uncertainty =       0.001126791074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273636709
  error estimate for blocks of size 2^( 2) =       0.000280864993
  error estimate for blocks of size 2^( 3) =       0.000287510676
  error estimate for blocks of size 2^( 4) =       0.000292455274
  error estimate for blocks of size 2^( 5) =       0.000295415819
  error estimate for blocks of size 2^( 6) =       0.000296906778
  error estimate for blocks of size 2^( 7) =       0.000297847075
  error estimate for blocks of size 2^( 8) =       0.000297986781

      target function =                  N/A
              le_mean =     -17.216632441470
             les_mean =     296.727102887394
             stat err =       0.000297039113
             autocorr =       1.178361548301
              std dev =       0.547273417954
             le_variance =       0.299508193999


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216632441470        initial  <--
     8.8818e+13     8.8818e+14             0.0000e+00       -17.216632441470
     3.5527e+14     3.5527e+15             0.0000e+00       -17.216632441470
     1.4211e+15     1.4211e+16             0.0000e+00       -17.216632441470

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.3800
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9878e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.2222
    reference variance = 0.150058
====================================================
  Execution time = 2.7156e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0589e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2125e-01
  Total weights = 3.913473992e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9329e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301801346400
                                         uncertainty =       0.001985552642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301801346400
                                         uncertainty =       0.001985552642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274656049
  error estimate for blocks of size 2^( 2) =       0.000281880033
  error estimate for blocks of size 2^( 3) =       0.000288203334
  error estimate for blocks of size 2^( 4) =       0.000293352355
  error estimate for blocks of size 2^( 5) =       0.000296632331
  error estimate for blocks of size 2^( 6) =       0.000298584043
  error estimate for blocks of size 2^( 7) =       0.000298285829
  error estimate for blocks of size 2^( 8) =       0.000298368189

      target function =                  N/A
              le_mean =     -17.216579173341
             les_mean =     296.731845716123
             stat err =       0.000297967598
             autocorr =       1.176954684622
              std dev =       0.549312098293
             le_variance =       0.301743781332


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721657917334e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+14, overlap shift 8.8818e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216579173367       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216579173367       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216579173367       residual = 2.36e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216579173367       residual = 6.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216579086401       residual = 4.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.288409863555       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200320662318       residual = 5.20e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -15.767866203769       residual = 6.06e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -14.989577813862       residual = 8.99e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.534029224189       residual = 5.66e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -15.189442272569       residual = 3.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -18.039999692941       residual = 1.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.028500679117       residual = 6.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.992728984359       residual = 7.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.432761358505       residual = 2.57e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.887604807275       residual = 8.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.745049946580       residual = 6.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -18.196468691233       residual = 1.03e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -19.412348368690       residual = 7.73e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -18.253635669424       residual = 1.69e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -18.271200936968       residual = 1.61e+01           smallest_sin_value = 9.95e-01
davidson iteration   21: stopping due to imaginary component in cost function
davidson solver did not converge after         21 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+14 is 4.072708e-19

solving harmonic davidson linear method for identity shift 3.5527e+15, overlap shift 3.5527e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216579173367       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216579173367       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216579173367       residual = 3.90e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216579173368       residual = 6.99e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.503144169777       residual = 6.40e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -15.963418032156       residual = 1.72e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216652431979       residual = 5.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -15.513532586742       residual = 2.47e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -15.403618482711       residual = 1.14e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.130495865429       residual = 6.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   10 stopping due to too large eigenvalue change
davidson solver did not converge after         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+15 is 1.018177e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+16, overlap shift 1.4211e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216579173367       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216579173367       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216579173367       residual = 6.28e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216579173315       residual = 3.07e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.885369103592       residual = 2.36e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -14.909191475279       residual = 7.43e+00           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+16 is 2.545443e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.457360 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2103e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.2327
    reference variance = 0.252902
====================================================
  Execution time = 2.7046e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1312e-01
  Total weights = 3.9139e+06
  Execution time = 3.6433e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298222881065
                                         uncertainty =       0.001490478680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298222881065
                                         uncertainty =       0.001490478680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273027379
  error estimate for blocks of size 2^( 2) =       0.000280096612
  error estimate for blocks of size 2^( 3) =       0.000286808074
  error estimate for blocks of size 2^( 4) =       0.000291476225
  error estimate for blocks of size 2^( 5) =       0.000294557491
  error estimate for blocks of size 2^( 6) =       0.000296221145
  error estimate for blocks of size 2^( 7) =       0.000297122923
  error estimate for blocks of size 2^( 8) =       0.000297521165

      target function =                  N/A
              le_mean =     -17.216256742789
             les_mean =     296.712617655186
             stat err =       0.000296355681
             autocorr =       1.178186697994
              std dev =       0.546054757324
             le_variance =       0.298175797996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298222881065
                                         uncertainty =       0.001490478680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298222881065
                                         uncertainty =       0.001490478680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273027379
  error estimate for blocks of size 2^( 2) =       0.000280096612
  error estimate for blocks of size 2^( 3) =       0.000286808074
  error estimate for blocks of size 2^( 4) =       0.000291476225
  error estimate for blocks of size 2^( 5) =       0.000294557491
  error estimate for blocks of size 2^( 6) =       0.000296221145
  error estimate for blocks of size 2^( 7) =       0.000297122923
  error estimate for blocks of size 2^( 8) =       0.000297521165

      target function =                  N/A
              le_mean =     -17.216256742789
             les_mean =     296.712617655186
             stat err =       0.000296355681
             autocorr =       1.178186697994
              std dev =       0.546054757324
             le_variance =       0.298175797996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298222881065
                                         uncertainty =       0.001490478680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298222881065
                                         uncertainty =       0.001490478680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273027379
  error estimate for blocks of size 2^( 2) =       0.000280096612
  error estimate for blocks of size 2^( 3) =       0.000286808074
  error estimate for blocks of size 2^( 4) =       0.000291476225
  error estimate for blocks of size 2^( 5) =       0.000294557491
  error estimate for blocks of size 2^( 6) =       0.000296221145
  error estimate for blocks of size 2^( 7) =       0.000297122923
  error estimate for blocks of size 2^( 8) =       0.000297521165

      target function =                  N/A
              le_mean =     -17.216256742789
             les_mean =     296.712617655186
             stat err =       0.000296355681
             autocorr =       1.178186697994
              std dev =       0.546054757324
             le_variance =       0.298175797996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298222881065
                                         uncertainty =       0.001490478680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298222881065
                                         uncertainty =       0.001490478680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273027379
  error estimate for blocks of size 2^( 2) =       0.000280096612
  error estimate for blocks of size 2^( 3) =       0.000286808074
  error estimate for blocks of size 2^( 4) =       0.000291476225
  error estimate for blocks of size 2^( 5) =       0.000294557491
  error estimate for blocks of size 2^( 6) =       0.000296221145
  error estimate for blocks of size 2^( 7) =       0.000297122923
  error estimate for blocks of size 2^( 8) =       0.000297521165

      target function =                  N/A
              le_mean =     -17.216256742789
             les_mean =     296.712617655186
             stat err =       0.000296355681
             autocorr =       1.178186697994
              std dev =       0.546054757324
             le_variance =       0.298175797996


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216256742789        initial  <--
     8.8818e+14     8.8818e+15             4.0727e-19       -17.216256742789
     3.5527e+15     3.5527e+16             1.0182e-19       -17.216256742789
     1.4211e+16     1.4211e+17             2.5454e-20       -17.216256742789

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5091
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7629e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.2255
    reference variance = 0.232694
====================================================
  Execution time = 2.7352e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0600e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2035e-01
  Total weights = 3.913303151e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9271e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301080617685
                                         uncertainty =       0.001540963809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301080617685
                                         uncertainty =       0.001540963809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274344572
  error estimate for blocks of size 2^( 2) =       0.000281475135
  error estimate for blocks of size 2^( 3) =       0.000288015694
  error estimate for blocks of size 2^( 4) =       0.000293111541
  error estimate for blocks of size 2^( 5) =       0.000296479665
  error estimate for blocks of size 2^( 6) =       0.000298070904
  error estimate for blocks of size 2^( 7) =       0.000299439487
  error estimate for blocks of size 2^( 8) =       0.000300228287

      target function =                  N/A
              le_mean =     -17.216457039818
             les_mean =     296.726745225853
             stat err =       0.000298554586
             autocorr =       1.184280960063
              std dev =       0.548689144956
             le_variance =       0.301059777793


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721645703982e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+15, overlap shift 8.8818e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216457039846       residual = 8.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216457039846       residual = 8.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.5527e+16, overlap shift 3.5527e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216457039846       residual = 8.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216457039846       residual = 8.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4211e+17, overlap shift 1.4211e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216457039846       residual = 8.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216457039846       residual = 8.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+17 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.458405 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2287e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.2085
    reference variance = 0.161465
====================================================
  Execution time = 2.7427e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1622e-01
  Total weights = 3.9130e+06
  Execution time = 3.6370e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300287422374
                                         uncertainty =       0.001468334488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300287422374
                                         uncertainty =       0.001468334488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274009317
  error estimate for blocks of size 2^( 2) =       0.000281172542
  error estimate for blocks of size 2^( 3) =       0.000287655010
  error estimate for blocks of size 2^( 4) =       0.000292593052
  error estimate for blocks of size 2^( 5) =       0.000295510799
  error estimate for blocks of size 2^( 6) =       0.000297221951
  error estimate for blocks of size 2^( 7) =       0.000298028973
  error estimate for blocks of size 2^( 8) =       0.000298359438

      target function =                  N/A
              le_mean =     -17.216921665449
             les_mean =     296.738615887797
             stat err =       0.000297280290
             autocorr =       1.177068047963
              std dev =       0.548018634327
             le_variance =       0.300324423570

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300287422374
                                         uncertainty =       0.001468334488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300287422374
                                         uncertainty =       0.001468334488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274009317
  error estimate for blocks of size 2^( 2) =       0.000281172542
  error estimate for blocks of size 2^( 3) =       0.000287655010
  error estimate for blocks of size 2^( 4) =       0.000292593052
  error estimate for blocks of size 2^( 5) =       0.000295510799
  error estimate for blocks of size 2^( 6) =       0.000297221951
  error estimate for blocks of size 2^( 7) =       0.000298028973
  error estimate for blocks of size 2^( 8) =       0.000298359438

      target function =                  N/A
              le_mean =     -17.216921665449
             les_mean =     296.738615887797
             stat err =       0.000297280290
             autocorr =       1.177068047963
              std dev =       0.548018634327
             le_variance =       0.300324423570

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300287422374
                                         uncertainty =       0.001468334488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300287422374
                                         uncertainty =       0.001468334488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274009317
  error estimate for blocks of size 2^( 2) =       0.000281172542
  error estimate for blocks of size 2^( 3) =       0.000287655010
  error estimate for blocks of size 2^( 4) =       0.000292593052
  error estimate for blocks of size 2^( 5) =       0.000295510799
  error estimate for blocks of size 2^( 6) =       0.000297221951
  error estimate for blocks of size 2^( 7) =       0.000298028973
  error estimate for blocks of size 2^( 8) =       0.000298359438

      target function =                  N/A
              le_mean =     -17.216921665449
             les_mean =     296.738615887797
             stat err =       0.000297280290
             autocorr =       1.177068047963
              std dev =       0.548018634327
             le_variance =       0.300324423570

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300287422374
                                         uncertainty =       0.001468334488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300287422374
                                         uncertainty =       0.001468334488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274009317
  error estimate for blocks of size 2^( 2) =       0.000281172542
  error estimate for blocks of size 2^( 3) =       0.000287655010
  error estimate for blocks of size 2^( 4) =       0.000292593052
  error estimate for blocks of size 2^( 5) =       0.000295510799
  error estimate for blocks of size 2^( 6) =       0.000297221951
  error estimate for blocks of size 2^( 7) =       0.000298028973
  error estimate for blocks of size 2^( 8) =       0.000298359438

      target function =                  N/A
              le_mean =     -17.216921665449
             les_mean =     296.738615887797
             stat err =       0.000297280290
             autocorr =       1.177068047963
              std dev =       0.548018634327
             le_variance =       0.300324423570


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216921665449        initial  <--
     8.8818e+15     8.8818e+16             0.0000e+00       -17.216921665449
     3.5527e+16     3.5527e+17             0.0000e+00       -17.216921665449
     1.4211e+17     1.4211e+18             0.0000e+00       -17.216921665449

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.9471
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8242e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.1913
    reference variance = 0.156511
====================================================
  Execution time = 2.7601e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0514e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1284e-01
  Total weights = 3.913713782e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9317e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299072937350
                                         uncertainty =       0.001416083927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299072937350
                                         uncertainty =       0.001416083927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273422713
  error estimate for blocks of size 2^( 2) =       0.000280423089
  error estimate for blocks of size 2^( 3) =       0.000286741080
  error estimate for blocks of size 2^( 4) =       0.000291112943
  error estimate for blocks of size 2^( 5) =       0.000293503555
  error estimate for blocks of size 2^( 6) =       0.000294505421
  error estimate for blocks of size 2^( 7) =       0.000295676936
  error estimate for blocks of size 2^( 8) =       0.000296145900

      target function =                  N/A
              le_mean =     -17.216986085787
             les_mean =     296.737449952575
             stat err =       0.000294957953
             autocorr =       1.163726820004
              std dev =       0.546845426476
             le_variance =       0.299039920458


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721698608579e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+16, overlap shift 8.8818e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216986085809       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216986085809       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216986085809       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.26e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+16 is 5.002145e-21

solving harmonic davidson linear method for identity shift 3.5527e+17, overlap shift 3.5527e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216986085809       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216986085809       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216986085809       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+17 is 1.250536e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+18, overlap shift 1.4211e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216986085809       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216986085809       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216986085809       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+18 is 3.126341e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.459782 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2542e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.2261
    reference variance = 0.193875
====================================================
  Execution time = 2.7248e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1614e-01
  Total weights = 3.9134e+06
  Execution time = 3.6371e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302199356382
                                         uncertainty =       0.001537482473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302199356382
                                         uncertainty =       0.001537482473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274866561
  error estimate for blocks of size 2^( 2) =       0.000281881321
  error estimate for blocks of size 2^( 3) =       0.000288318942
  error estimate for blocks of size 2^( 4) =       0.000293245829
  error estimate for blocks of size 2^( 5) =       0.000296147594
  error estimate for blocks of size 2^( 6) =       0.000297690536
  error estimate for blocks of size 2^( 7) =       0.000297787203
  error estimate for blocks of size 2^( 8) =       0.000298775295

      target function =                  N/A
              le_mean =     -17.216661118816
             les_mean =     296.729562470771
             stat err =       0.000297600157
             autocorr =       1.172256086174
              std dev =       0.549733121227
             le_variance =       0.302206504574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302199356382
                                         uncertainty =       0.001537482473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302199356382
                                         uncertainty =       0.001537482473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274866561
  error estimate for blocks of size 2^( 2) =       0.000281881321
  error estimate for blocks of size 2^( 3) =       0.000288318942
  error estimate for blocks of size 2^( 4) =       0.000293245829
  error estimate for blocks of size 2^( 5) =       0.000296147594
  error estimate for blocks of size 2^( 6) =       0.000297690536
  error estimate for blocks of size 2^( 7) =       0.000297787203
  error estimate for blocks of size 2^( 8) =       0.000298775295

      target function =                  N/A
              le_mean =     -17.216661118816
             les_mean =     296.729562470771
             stat err =       0.000297600157
             autocorr =       1.172256086174
              std dev =       0.549733121227
             le_variance =       0.302206504574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302199356382
                                         uncertainty =       0.001537482473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302199356382
                                         uncertainty =       0.001537482473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274866561
  error estimate for blocks of size 2^( 2) =       0.000281881321
  error estimate for blocks of size 2^( 3) =       0.000288318942
  error estimate for blocks of size 2^( 4) =       0.000293245829
  error estimate for blocks of size 2^( 5) =       0.000296147594
  error estimate for blocks of size 2^( 6) =       0.000297690536
  error estimate for blocks of size 2^( 7) =       0.000297787203
  error estimate for blocks of size 2^( 8) =       0.000298775295

      target function =                  N/A
              le_mean =     -17.216661118816
             les_mean =     296.729562470771
             stat err =       0.000297600157
             autocorr =       1.172256086174
              std dev =       0.549733121227
             le_variance =       0.302206504574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302199356382
                                         uncertainty =       0.001537482473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302199356382
                                         uncertainty =       0.001537482473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274866561
  error estimate for blocks of size 2^( 2) =       0.000281881321
  error estimate for blocks of size 2^( 3) =       0.000288318942
  error estimate for blocks of size 2^( 4) =       0.000293245829
  error estimate for blocks of size 2^( 5) =       0.000296147594
  error estimate for blocks of size 2^( 6) =       0.000297690536
  error estimate for blocks of size 2^( 7) =       0.000297787203
  error estimate for blocks of size 2^( 8) =       0.000298775295

      target function =                  N/A
              le_mean =     -17.216661118816
             les_mean =     296.729562470771
             stat err =       0.000297600157
             autocorr =       1.172256086174
              std dev =       0.549733121227
             le_variance =       0.302206504574


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216661118816        initial  <--
     8.8818e+16     8.8818e+17             5.0021e-21       -17.216661118816
     3.5527e+17     3.5527e+18             1.2505e-21       -17.216661118816
     1.4211e+18     1.4211e+19             3.1263e-22       -17.216661118816

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.1413
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9695e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.1983
    reference variance = 0.678865
====================================================
  Execution time = 2.7409e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0593e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2412e-01
  Total weights = 3.913554470e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9491e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303642780663
                                         uncertainty =       0.002026536288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303642780663
                                         uncertainty =       0.002026536288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275509016
  error estimate for blocks of size 2^( 2) =       0.000282700133
  error estimate for blocks of size 2^( 3) =       0.000289096424
  error estimate for blocks of size 2^( 4) =       0.000293839987
  error estimate for blocks of size 2^( 5) =       0.000296693474
  error estimate for blocks of size 2^( 6) =       0.000297065663
  error estimate for blocks of size 2^( 7) =       0.000297581538
  error estimate for blocks of size 2^( 8) =       0.000298775675

      target function =                  N/A
              le_mean =     -17.216995435295
             les_mean =     296.749054568784
             stat err =       0.000297529088
             autocorr =       1.166238110925
              std dev =       0.551018031984
             le_variance =       0.303620871571


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721699543530e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+17, overlap shift 8.8818e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216995435325       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216995435325       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+18, overlap shift 3.5527e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216995435325       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216995435325       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+19, overlap shift 1.4211e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216995435325       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216995435325       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.460877 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2365e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.1654
    reference variance = 0.244473
====================================================
  Execution time = 2.7023e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1309e-01
  Total weights = 3.9136e+06
  Execution time = 3.6455e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299007595402
                                         uncertainty =       0.001294981174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299007595402
                                         uncertainty =       0.001294981174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273408511
  error estimate for blocks of size 2^( 2) =       0.000280661924
  error estimate for blocks of size 2^( 3) =       0.000286815543
  error estimate for blocks of size 2^( 4) =       0.000291482710
  error estimate for blocks of size 2^( 5) =       0.000294674979
  error estimate for blocks of size 2^( 6) =       0.000296989317
  error estimate for blocks of size 2^( 7) =       0.000297245783
  error estimate for blocks of size 2^( 8) =       0.000297549338

      target function =                  N/A
              le_mean =     -17.216031954972
             les_mean =     296.704846410058
             stat err =       0.000296614854
             autocorr =       1.176960080936
              std dev =       0.546817022263
             le_variance =       0.299008855836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299007595402
                                         uncertainty =       0.001294981174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299007595402
                                         uncertainty =       0.001294981174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273408511
  error estimate for blocks of size 2^( 2) =       0.000280661924
  error estimate for blocks of size 2^( 3) =       0.000286815543
  error estimate for blocks of size 2^( 4) =       0.000291482710
  error estimate for blocks of size 2^( 5) =       0.000294674979
  error estimate for blocks of size 2^( 6) =       0.000296989317
  error estimate for blocks of size 2^( 7) =       0.000297245783
  error estimate for blocks of size 2^( 8) =       0.000297549338

      target function =                  N/A
              le_mean =     -17.216031954972
             les_mean =     296.704846410058
             stat err =       0.000296614854
             autocorr =       1.176960080936
              std dev =       0.546817022263
             le_variance =       0.299008855836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299007595402
                                         uncertainty =       0.001294981174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299007595402
                                         uncertainty =       0.001294981174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273408511
  error estimate for blocks of size 2^( 2) =       0.000280661924
  error estimate for blocks of size 2^( 3) =       0.000286815543
  error estimate for blocks of size 2^( 4) =       0.000291482710
  error estimate for blocks of size 2^( 5) =       0.000294674979
  error estimate for blocks of size 2^( 6) =       0.000296989317
  error estimate for blocks of size 2^( 7) =       0.000297245783
  error estimate for blocks of size 2^( 8) =       0.000297549338

      target function =                  N/A
              le_mean =     -17.216031954972
             les_mean =     296.704846410058
             stat err =       0.000296614854
             autocorr =       1.176960080936
              std dev =       0.546817022263
             le_variance =       0.299008855836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299007595402
                                         uncertainty =       0.001294981174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299007595402
                                         uncertainty =       0.001294981174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273408511
  error estimate for blocks of size 2^( 2) =       0.000280661924
  error estimate for blocks of size 2^( 3) =       0.000286815543
  error estimate for blocks of size 2^( 4) =       0.000291482710
  error estimate for blocks of size 2^( 5) =       0.000294674979
  error estimate for blocks of size 2^( 6) =       0.000296989317
  error estimate for blocks of size 2^( 7) =       0.000297245783
  error estimate for blocks of size 2^( 8) =       0.000297549338

      target function =                  N/A
              le_mean =     -17.216031954972
             les_mean =     296.704846410058
             stat err =       0.000296614854
             autocorr =       1.176960080936
              std dev =       0.546817022263
             le_variance =       0.299008855836


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216031954972        initial  <--
     8.8818e+17     8.8818e+18             0.0000e+00       -17.216031954972
     3.5527e+18     3.5527e+19             0.0000e+00       -17.216031954972
     1.4211e+19     1.4211e+20             0.0000e+00       -17.216031954972

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5723
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7944e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.2122
    reference variance = 0.335427
====================================================
  Execution time = 2.7344e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0529e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1247e-01
  Total weights = 3.912917843e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9153e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298874186464
                                         uncertainty =       0.001459829013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298874186464
                                         uncertainty =       0.001459829013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273338627
  error estimate for blocks of size 2^( 2) =       0.000280277262
  error estimate for blocks of size 2^( 3) =       0.000287130551
  error estimate for blocks of size 2^( 4) =       0.000291781658
  error estimate for blocks of size 2^( 5) =       0.000294580560
  error estimate for blocks of size 2^( 6) =       0.000296480577
  error estimate for blocks of size 2^( 7) =       0.000297035677
  error estimate for blocks of size 2^( 8) =       0.000295988267

      target function =                  N/A
              le_mean =     -17.216475166588
             les_mean =     296.719491681622
             stat err =       0.000296021270
             autocorr =       1.172853636858
              std dev =       0.546677253625
             le_variance =       0.298856019631


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721647516659e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+18, overlap shift 8.8818e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216475166611       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216475166611       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+19, overlap shift 3.5527e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216475166611       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216475166611       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+20, overlap shift 1.4211e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216475166611       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216475166611       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.461976 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2268e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.2334
    reference variance = 0.201792
====================================================
  Execution time = 2.6771e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1239e-01
  Total weights = 3.9128e+06
  Execution time = 3.6407e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298475145464
                                         uncertainty =       0.001453272879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298475145464
                                         uncertainty =       0.001453272879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273172755
  error estimate for blocks of size 2^( 2) =       0.000280006959
  error estimate for blocks of size 2^( 3) =       0.000286182562
  error estimate for blocks of size 2^( 4) =       0.000290912343
  error estimate for blocks of size 2^( 5) =       0.000293472206
  error estimate for blocks of size 2^( 6) =       0.000294918548
  error estimate for blocks of size 2^( 7) =       0.000295270052
  error estimate for blocks of size 2^( 8) =       0.000295255378

      target function =                  N/A
              le_mean =     -17.216360179128
             les_mean =     296.715452109483
             stat err =       0.000294729046
             autocorr =       1.164048594436
              std dev =       0.546345510120
             le_variance =       0.298493416429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298475145464
                                         uncertainty =       0.001453272879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298475145464
                                         uncertainty =       0.001453272879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273172755
  error estimate for blocks of size 2^( 2) =       0.000280006959
  error estimate for blocks of size 2^( 3) =       0.000286182562
  error estimate for blocks of size 2^( 4) =       0.000290912343
  error estimate for blocks of size 2^( 5) =       0.000293472206
  error estimate for blocks of size 2^( 6) =       0.000294918548
  error estimate for blocks of size 2^( 7) =       0.000295270052
  error estimate for blocks of size 2^( 8) =       0.000295255378

      target function =                  N/A
              le_mean =     -17.216360179128
             les_mean =     296.715452109483
             stat err =       0.000294729046
             autocorr =       1.164048594436
              std dev =       0.546345510120
             le_variance =       0.298493416429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298475145464
                                         uncertainty =       0.001453272879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298475145464
                                         uncertainty =       0.001453272879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273172755
  error estimate for blocks of size 2^( 2) =       0.000280006959
  error estimate for blocks of size 2^( 3) =       0.000286182562
  error estimate for blocks of size 2^( 4) =       0.000290912343
  error estimate for blocks of size 2^( 5) =       0.000293472206
  error estimate for blocks of size 2^( 6) =       0.000294918548
  error estimate for blocks of size 2^( 7) =       0.000295270052
  error estimate for blocks of size 2^( 8) =       0.000295255378

      target function =                  N/A
              le_mean =     -17.216360179128
             les_mean =     296.715452109483
             stat err =       0.000294729046
             autocorr =       1.164048594436
              std dev =       0.546345510120
             le_variance =       0.298493416429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298475145464
                                         uncertainty =       0.001453272879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298475145464
                                         uncertainty =       0.001453272879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273172755
  error estimate for blocks of size 2^( 2) =       0.000280006959
  error estimate for blocks of size 2^( 3) =       0.000286182562
  error estimate for blocks of size 2^( 4) =       0.000290912343
  error estimate for blocks of size 2^( 5) =       0.000293472206
  error estimate for blocks of size 2^( 6) =       0.000294918548
  error estimate for blocks of size 2^( 7) =       0.000295270052
  error estimate for blocks of size 2^( 8) =       0.000295255378

      target function =                  N/A
              le_mean =     -17.216360179128
             les_mean =     296.715452109483
             stat err =       0.000294729046
             autocorr =       1.164048594436
              std dev =       0.546345510120
             le_variance =       0.298493416429


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216360179128        initial  <--
     8.8818e+18     8.8818e+19             0.0000e+00       -17.216360179128
     3.5527e+19     3.5527e+20             0.0000e+00       -17.216360179128
     1.4211e+20     1.4211e+21             0.0000e+00       -17.216360179128

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.2876
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7568e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2129
    reference variance = 0.318917
====================================================
  Execution time = 2.7426e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0591e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1506e-01
  Total weights = 3.913777125e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9240e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299848298618
                                         uncertainty =       0.001563903873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299848298618
                                         uncertainty =       0.001563903873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273807557
  error estimate for blocks of size 2^( 2) =       0.000280633469
  error estimate for blocks of size 2^( 3) =       0.000287152482
  error estimate for blocks of size 2^( 4) =       0.000291844499
  error estimate for blocks of size 2^( 5) =       0.000294768366
  error estimate for blocks of size 2^( 6) =       0.000296857494
  error estimate for blocks of size 2^( 7) =       0.000296330621
  error estimate for blocks of size 2^( 8) =       0.000296775669

      target function =                  N/A
              le_mean =     -17.216043202398
             les_mean =     296.707206264210
             stat err =       0.000296183037
             autocorr =       1.170117576458
              std dev =       0.547615114546
             le_variance =       0.299882313679


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721604320240e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+19, overlap shift 8.8818e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216043202419       residual = 9.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216043202419       residual = 9.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+20, overlap shift 3.5527e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216043202419       residual = 9.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216043202419       residual = 9.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+21, overlap shift 1.4211e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216043202419       residual = 9.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216043202419       residual = 9.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.463087 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2357e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2252
    reference variance = 0.177742
====================================================
  Execution time = 2.7013e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1221e-01
  Total weights = 3.9135e+06
  Execution time = 3.6391e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297715815855
                                         uncertainty =       0.001460571149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297715815855
                                         uncertainty =       0.001460571149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272809418
  error estimate for blocks of size 2^( 2) =       0.000279909777
  error estimate for blocks of size 2^( 3) =       0.000286286394
  error estimate for blocks of size 2^( 4) =       0.000291074216
  error estimate for blocks of size 2^( 5) =       0.000294479517
  error estimate for blocks of size 2^( 6) =       0.000296393987
  error estimate for blocks of size 2^( 7) =       0.000297248341
  error estimate for blocks of size 2^( 8) =       0.000298532222

      target function =                  N/A
              le_mean =     -17.216512010652
             les_mean =     296.720500787389
             stat err =       0.000296663516
             autocorr =       1.182522903418
              std dev =       0.545618836870
             le_variance =       0.297699915147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297715815855
                                         uncertainty =       0.001460571149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297715815855
                                         uncertainty =       0.001460571149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272809418
  error estimate for blocks of size 2^( 2) =       0.000279909777
  error estimate for blocks of size 2^( 3) =       0.000286286394
  error estimate for blocks of size 2^( 4) =       0.000291074216
  error estimate for blocks of size 2^( 5) =       0.000294479517
  error estimate for blocks of size 2^( 6) =       0.000296393987
  error estimate for blocks of size 2^( 7) =       0.000297248341
  error estimate for blocks of size 2^( 8) =       0.000298532222

      target function =                  N/A
              le_mean =     -17.216512010652
             les_mean =     296.720500787389
             stat err =       0.000296663516
             autocorr =       1.182522903418
              std dev =       0.545618836870
             le_variance =       0.297699915147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297715815855
                                         uncertainty =       0.001460571149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297715815855
                                         uncertainty =       0.001460571149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272809418
  error estimate for blocks of size 2^( 2) =       0.000279909777
  error estimate for blocks of size 2^( 3) =       0.000286286394
  error estimate for blocks of size 2^( 4) =       0.000291074216
  error estimate for blocks of size 2^( 5) =       0.000294479517
  error estimate for blocks of size 2^( 6) =       0.000296393987
  error estimate for blocks of size 2^( 7) =       0.000297248341
  error estimate for blocks of size 2^( 8) =       0.000298532222

      target function =                  N/A
              le_mean =     -17.216512010652
             les_mean =     296.720500787389
             stat err =       0.000296663516
             autocorr =       1.182522903418
              std dev =       0.545618836870
             le_variance =       0.297699915147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297715815855
                                         uncertainty =       0.001460571149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297715815855
                                         uncertainty =       0.001460571149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272809418
  error estimate for blocks of size 2^( 2) =       0.000279909777
  error estimate for blocks of size 2^( 3) =       0.000286286394
  error estimate for blocks of size 2^( 4) =       0.000291074216
  error estimate for blocks of size 2^( 5) =       0.000294479517
  error estimate for blocks of size 2^( 6) =       0.000296393987
  error estimate for blocks of size 2^( 7) =       0.000297248341
  error estimate for blocks of size 2^( 8) =       0.000298532222

      target function =                  N/A
              le_mean =     -17.216512010652
             les_mean =     296.720500787389
             stat err =       0.000296663516
             autocorr =       1.182522903418
              std dev =       0.545618836870
             le_variance =       0.297699915147


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216512010652        initial  <--
     8.8818e+19     8.8818e+20             0.0000e+00       -17.216512010652
     3.5527e+20     3.5527e+21             0.0000e+00       -17.216512010652
     1.4211e+21     1.4211e+22             0.0000e+00       -17.216512010652

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5205
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7935e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.2046
    reference variance = 0.358827
====================================================
  Execution time = 2.7253e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0543e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1652e-01
  Total weights = 3.913769411e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9223e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300032687768
                                         uncertainty =       0.001673433558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300032687768
                                         uncertainty =       0.001673433558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273879023
  error estimate for blocks of size 2^( 2) =       0.000280742376
  error estimate for blocks of size 2^( 3) =       0.000287038919
  error estimate for blocks of size 2^( 4) =       0.000291493159
  error estimate for blocks of size 2^( 5) =       0.000294347222
  error estimate for blocks of size 2^( 6) =       0.000295456305
  error estimate for blocks of size 2^( 7) =       0.000295822440
  error estimate for blocks of size 2^( 8) =       0.000297951050

      target function =                  N/A
              le_mean =     -17.216590774339
             les_mean =     296.727515980167
             stat err =       0.000295894254
             autocorr =       1.167227540704
              std dev =       0.547758045039
             le_variance =       0.300038875905


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721659077434e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+20, overlap shift 8.8818e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216590774364       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216590774364       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+21, overlap shift 3.5527e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216590774364       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216590774364       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+22, overlap shift 1.4211e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216590774364       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216590774364       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.464185 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2182e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.2635
    reference variance = 0.501366
====================================================
  Execution time = 2.7962e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1398e-01
  Total weights = 3.9135e+06
  Execution time = 4.0166e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299992893093
                                         uncertainty =       0.001305147898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299992893093
                                         uncertainty =       0.001305147898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273862573
  error estimate for blocks of size 2^( 2) =       0.000281000562
  error estimate for blocks of size 2^( 3) =       0.000287426076
  error estimate for blocks of size 2^( 4) =       0.000292283834
  error estimate for blocks of size 2^( 5) =       0.000295678457
  error estimate for blocks of size 2^( 6) =       0.000297428401
  error estimate for blocks of size 2^( 7) =       0.000299234306
  error estimate for blocks of size 2^( 8) =       0.000300293747

      target function =                  N/A
              le_mean =     -17.216671895535
             les_mean =     296.727766704998
             stat err =       0.000298158728
             autocorr =       1.185303821671
              std dev =       0.547725145908
             le_variance =       0.300002835460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299992893093
                                         uncertainty =       0.001305147898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299992893093
                                         uncertainty =       0.001305147898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273862573
  error estimate for blocks of size 2^( 2) =       0.000281000562
  error estimate for blocks of size 2^( 3) =       0.000287426076
  error estimate for blocks of size 2^( 4) =       0.000292283834
  error estimate for blocks of size 2^( 5) =       0.000295678457
  error estimate for blocks of size 2^( 6) =       0.000297428401
  error estimate for blocks of size 2^( 7) =       0.000299234306
  error estimate for blocks of size 2^( 8) =       0.000300293747

      target function =                  N/A
              le_mean =     -17.216671895535
             les_mean =     296.727766704998
             stat err =       0.000298158728
             autocorr =       1.185303821671
              std dev =       0.547725145908
             le_variance =       0.300002835460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299992893093
                                         uncertainty =       0.001305147898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299992893093
                                         uncertainty =       0.001305147898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273862573
  error estimate for blocks of size 2^( 2) =       0.000281000562
  error estimate for blocks of size 2^( 3) =       0.000287426076
  error estimate for blocks of size 2^( 4) =       0.000292283834
  error estimate for blocks of size 2^( 5) =       0.000295678457
  error estimate for blocks of size 2^( 6) =       0.000297428401
  error estimate for blocks of size 2^( 7) =       0.000299234306
  error estimate for blocks of size 2^( 8) =       0.000300293747

      target function =                  N/A
              le_mean =     -17.216671895535
             les_mean =     296.727766704998
             stat err =       0.000298158728
             autocorr =       1.185303821671
              std dev =       0.547725145908
             le_variance =       0.300002835460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299992893093
                                         uncertainty =       0.001305147898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299992893093
                                         uncertainty =       0.001305147898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273862573
  error estimate for blocks of size 2^( 2) =       0.000281000562
  error estimate for blocks of size 2^( 3) =       0.000287426076
  error estimate for blocks of size 2^( 4) =       0.000292283834
  error estimate for blocks of size 2^( 5) =       0.000295678457
  error estimate for blocks of size 2^( 6) =       0.000297428401
  error estimate for blocks of size 2^( 7) =       0.000299234306
  error estimate for blocks of size 2^( 8) =       0.000300293747

      target function =                  N/A
              le_mean =     -17.216671895535
             les_mean =     296.727766704998
             stat err =       0.000298158728
             autocorr =       1.185303821671
              std dev =       0.547725145908
             le_variance =       0.300002835460


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216671895535        initial  <--
     8.8818e+20     8.8818e+21             0.0000e+00       -17.216671895535
     3.5527e+21     3.5527e+22             0.0000e+00       -17.216671895535
     1.4211e+22     1.4211e+23             0.0000e+00       -17.216671895535

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.8775
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9067e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.1794
    reference variance = 0.185123
====================================================
  Execution time = 2.7228e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0571e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1445e-01
  Total weights = 3.913195590e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9242e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299666251393
                                         uncertainty =       0.001501508388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299666251393
                                         uncertainty =       0.001501508388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273698217
  error estimate for blocks of size 2^( 2) =       0.000280635661
  error estimate for blocks of size 2^( 3) =       0.000287152047
  error estimate for blocks of size 2^( 4) =       0.000292143902
  error estimate for blocks of size 2^( 5) =       0.000295638453
  error estimate for blocks of size 2^( 6) =       0.000296600659
  error estimate for blocks of size 2^( 7) =       0.000297370863
  error estimate for blocks of size 2^( 8) =       0.000297509270

      target function =                  N/A
              le_mean =     -17.215855701984
             les_mean =     296.700136999137
             stat err =       0.000296779811
             autocorr =       1.175776493308
              std dev =       0.547396433167
             le_variance =       0.299642855044


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721585570198e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+21, overlap shift 8.8818e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215855702004       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215855702004       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215855702004       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+21 is 2.870402e-26

solving harmonic davidson linear method for identity shift 3.5527e+22, overlap shift 3.5527e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215855702004       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215855702004       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215855702004       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+22 is 7.176006e-27

solving harmonic davidson linear method for identity shift 1.4211e+23, overlap shift 1.4211e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215855702004       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215855702004       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215855702004       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+23 is 1.794002e-27

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.465238 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2160e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.1905
    reference variance = 0.203404
====================================================
  Execution time = 2.7402e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1962e-01
  Total weights = 3.9131e+06
  Execution time = 3.6448e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302423498785
                                         uncertainty =       0.001495301577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302423498785
                                         uncertainty =       0.001495301577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275005854
  error estimate for blocks of size 2^( 2) =       0.000281946706
  error estimate for blocks of size 2^( 3) =       0.000288120394
  error estimate for blocks of size 2^( 4) =       0.000292713315
  error estimate for blocks of size 2^( 5) =       0.000295846668
  error estimate for blocks of size 2^( 6) =       0.000297187277
  error estimate for blocks of size 2^( 7) =       0.000298516161
  error estimate for blocks of size 2^( 8) =       0.000298047986

      target function =                  N/A
              le_mean =     -17.216103272015
             les_mean =     296.713831729631
             stat err =       0.000297399523
             autocorr =       1.169490387117
              std dev =       0.550011708832
             le_variance =       0.302512879852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302423498785
                                         uncertainty =       0.001495301577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302423498785
                                         uncertainty =       0.001495301577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275005854
  error estimate for blocks of size 2^( 2) =       0.000281946706
  error estimate for blocks of size 2^( 3) =       0.000288120394
  error estimate for blocks of size 2^( 4) =       0.000292713315
  error estimate for blocks of size 2^( 5) =       0.000295846668
  error estimate for blocks of size 2^( 6) =       0.000297187277
  error estimate for blocks of size 2^( 7) =       0.000298516161
  error estimate for blocks of size 2^( 8) =       0.000298047986

      target function =                  N/A
              le_mean =     -17.216103272015
             les_mean =     296.713831729631
             stat err =       0.000297399523
             autocorr =       1.169490387117
              std dev =       0.550011708832
             le_variance =       0.302512879852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302423498785
                                         uncertainty =       0.001495301577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302423498785
                                         uncertainty =       0.001495301577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275005854
  error estimate for blocks of size 2^( 2) =       0.000281946706
  error estimate for blocks of size 2^( 3) =       0.000288120394
  error estimate for blocks of size 2^( 4) =       0.000292713315
  error estimate for blocks of size 2^( 5) =       0.000295846668
  error estimate for blocks of size 2^( 6) =       0.000297187277
  error estimate for blocks of size 2^( 7) =       0.000298516161
  error estimate for blocks of size 2^( 8) =       0.000298047986

      target function =                  N/A
              le_mean =     -17.216103272015
             les_mean =     296.713831729631
             stat err =       0.000297399523
             autocorr =       1.169490387117
              std dev =       0.550011708832
             le_variance =       0.302512879852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302423498785
                                         uncertainty =       0.001495301577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302423498785
                                         uncertainty =       0.001495301577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000275005854
  error estimate for blocks of size 2^( 2) =       0.000281946706
  error estimate for blocks of size 2^( 3) =       0.000288120394
  error estimate for blocks of size 2^( 4) =       0.000292713315
  error estimate for blocks of size 2^( 5) =       0.000295846668
  error estimate for blocks of size 2^( 6) =       0.000297187277
  error estimate for blocks of size 2^( 7) =       0.000298516161
  error estimate for blocks of size 2^( 8) =       0.000298047986

      target function =                  N/A
              le_mean =     -17.216103272015
             les_mean =     296.713831729631
             stat err =       0.000297399523
             autocorr =       1.169490387117
              std dev =       0.550011708832
             le_variance =       0.302512879852


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216103272015        initial  <--
     8.8818e+21     8.8818e+22             2.8704e-26       -17.216103272015
     3.5527e+22     3.5527e+23             7.1760e-27       -17.216103272015
     1.4211e+23     1.4211e+24             1.7940e-27       -17.216103272015

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.9572
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8128e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.1729
    reference variance = 0.210953
====================================================
  Execution time = 2.7180e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0590e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1497e-01
  Total weights = 3.913856456e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9350e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299817182402
                                         uncertainty =       0.001534963623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299817182402
                                         uncertainty =       0.001534963623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273747504
  error estimate for blocks of size 2^( 2) =       0.000280951068
  error estimate for blocks of size 2^( 3) =       0.000287616748
  error estimate for blocks of size 2^( 4) =       0.000292294784
  error estimate for blocks of size 2^( 5) =       0.000294727501
  error estimate for blocks of size 2^( 6) =       0.000296228091
  error estimate for blocks of size 2^( 7) =       0.000298222278
  error estimate for blocks of size 2^( 8) =       0.000299171967

      target function =                  N/A
              le_mean =     -17.216023211427
             les_mean =     296.706421383761
             stat err =       0.000297087459
             autocorr =       1.177791198190
              std dev =       0.547495007392
             le_variance =       0.299750783120


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721602321143e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+22, overlap shift 8.8818e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216023211444       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216023211444       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+23, overlap shift 3.5527e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216023211444       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216023211444       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+24, overlap shift 1.4211e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216023211444       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216023211444       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.466326 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2124e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.2086
    reference variance = 0.252341
====================================================
  Execution time = 2.7052e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1276e-01
  Total weights = 3.9135e+06
  Execution time = 3.6286e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297498260337
                                         uncertainty =       0.001430560678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297498260337
                                         uncertainty =       0.001430560678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272733739
  error estimate for blocks of size 2^( 2) =       0.000279799895
  error estimate for blocks of size 2^( 3) =       0.000286436363
  error estimate for blocks of size 2^( 4) =       0.000291384461
  error estimate for blocks of size 2^( 5) =       0.000294208366
  error estimate for blocks of size 2^( 6) =       0.000297031276
  error estimate for blocks of size 2^( 7) =       0.000297173555
  error estimate for blocks of size 2^( 8) =       0.000296952015

      target function =                  N/A
              le_mean =     -17.216445566728
             les_mean =     296.718760991695
             stat err =       0.000296341303
             autocorr =       1.180610497211
              std dev =       0.545467477388
             le_variance =       0.297534768888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297498260337
                                         uncertainty =       0.001430560678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297498260337
                                         uncertainty =       0.001430560678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272733739
  error estimate for blocks of size 2^( 2) =       0.000279799895
  error estimate for blocks of size 2^( 3) =       0.000286436363
  error estimate for blocks of size 2^( 4) =       0.000291384461
  error estimate for blocks of size 2^( 5) =       0.000294208366
  error estimate for blocks of size 2^( 6) =       0.000297031276
  error estimate for blocks of size 2^( 7) =       0.000297173555
  error estimate for blocks of size 2^( 8) =       0.000296952015

      target function =                  N/A
              le_mean =     -17.216445566728
             les_mean =     296.718760991695
             stat err =       0.000296341303
             autocorr =       1.180610497211
              std dev =       0.545467477388
             le_variance =       0.297534768888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297498260337
                                         uncertainty =       0.001430560678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297498260337
                                         uncertainty =       0.001430560678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272733739
  error estimate for blocks of size 2^( 2) =       0.000279799895
  error estimate for blocks of size 2^( 3) =       0.000286436363
  error estimate for blocks of size 2^( 4) =       0.000291384461
  error estimate for blocks of size 2^( 5) =       0.000294208366
  error estimate for blocks of size 2^( 6) =       0.000297031276
  error estimate for blocks of size 2^( 7) =       0.000297173555
  error estimate for blocks of size 2^( 8) =       0.000296952015

      target function =                  N/A
              le_mean =     -17.216445566728
             les_mean =     296.718760991695
             stat err =       0.000296341303
             autocorr =       1.180610497211
              std dev =       0.545467477388
             le_variance =       0.297534768888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297498260337
                                         uncertainty =       0.001430560678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297498260337
                                         uncertainty =       0.001430560678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272733739
  error estimate for blocks of size 2^( 2) =       0.000279799895
  error estimate for blocks of size 2^( 3) =       0.000286436363
  error estimate for blocks of size 2^( 4) =       0.000291384461
  error estimate for blocks of size 2^( 5) =       0.000294208366
  error estimate for blocks of size 2^( 6) =       0.000297031276
  error estimate for blocks of size 2^( 7) =       0.000297173555
  error estimate for blocks of size 2^( 8) =       0.000296952015

      target function =                  N/A
              le_mean =     -17.216445566728
             les_mean =     296.718760991695
             stat err =       0.000296341303
             autocorr =       1.180610497211
              std dev =       0.545467477388
             le_variance =       0.297534768888


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216445566728        initial  <--
     8.8818e+22     8.8818e+23             0.0000e+00       -17.216445566728
     3.5527e+23     3.5527e+24             0.0000e+00       -17.216445566728
     1.4211e+24     1.4211e+25             0.0000e+00       -17.216445566728

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5464
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7679e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.2213
    reference variance = 0.240444
====================================================
  Execution time = 2.7214e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0606e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1141e-01
  Total weights = 3.913573446e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9647e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298440507224
                                         uncertainty =       0.001292619596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298440507224
                                         uncertainty =       0.001292619596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273100037
  error estimate for blocks of size 2^( 2) =       0.000280305056
  error estimate for blocks of size 2^( 3) =       0.000286768915
  error estimate for blocks of size 2^( 4) =       0.000291587025
  error estimate for blocks of size 2^( 5) =       0.000294554862
  error estimate for blocks of size 2^( 6) =       0.000296553983
  error estimate for blocks of size 2^( 7) =       0.000298118484
  error estimate for blocks of size 2^( 8) =       0.000298784051

      target function =                  N/A
              le_mean =     -17.216352202693
             les_mean =     296.714197573214
             stat err =       0.000297002845
             autocorr =       1.182708456976
              std dev =       0.546200073497
             le_variance =       0.298334520289


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721635220269e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+23, overlap shift 8.8818e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216352202708       residual = 6.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216352202708       residual = 6.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+24, overlap shift 3.5527e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216352202708       residual = 6.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216352202708       residual = 6.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+25, overlap shift 1.4211e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216352202708       residual = 6.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216352202708       residual = 6.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.467411 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2185e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.1491
    reference variance = 0.293258
====================================================
  Execution time = 2.7558e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1635e-01
  Total weights = 3.9135e+06
  Execution time = 3.6389e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300348575780
                                         uncertainty =       0.001631270145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300348575780
                                         uncertainty =       0.001631270145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274038636
  error estimate for blocks of size 2^( 2) =       0.000281039046
  error estimate for blocks of size 2^( 3) =       0.000287167227
  error estimate for blocks of size 2^( 4) =       0.000292167535
  error estimate for blocks of size 2^( 5) =       0.000295393242
  error estimate for blocks of size 2^( 6) =       0.000296901333
  error estimate for blocks of size 2^( 7) =       0.000298176764
  error estimate for blocks of size 2^( 8) =       0.000300167855

      target function =                  N/A
              le_mean =     -17.217223387194
             les_mean =     296.749127525346
             stat err =       0.000297659799
             autocorr =       1.179822769986
              std dev =       0.548077271829
             le_variance =       0.300388695896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300348575780
                                         uncertainty =       0.001631270145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300348575780
                                         uncertainty =       0.001631270145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274038636
  error estimate for blocks of size 2^( 2) =       0.000281039046
  error estimate for blocks of size 2^( 3) =       0.000287167227
  error estimate for blocks of size 2^( 4) =       0.000292167535
  error estimate for blocks of size 2^( 5) =       0.000295393242
  error estimate for blocks of size 2^( 6) =       0.000296901333
  error estimate for blocks of size 2^( 7) =       0.000298176764
  error estimate for blocks of size 2^( 8) =       0.000300167855

      target function =                  N/A
              le_mean =     -17.217223387194
             les_mean =     296.749127525346
             stat err =       0.000297659799
             autocorr =       1.179822769986
              std dev =       0.548077271829
             le_variance =       0.300388695896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300348575780
                                         uncertainty =       0.001631270145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300348575780
                                         uncertainty =       0.001631270145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274038636
  error estimate for blocks of size 2^( 2) =       0.000281039046
  error estimate for blocks of size 2^( 3) =       0.000287167227
  error estimate for blocks of size 2^( 4) =       0.000292167535
  error estimate for blocks of size 2^( 5) =       0.000295393242
  error estimate for blocks of size 2^( 6) =       0.000296901333
  error estimate for blocks of size 2^( 7) =       0.000298176764
  error estimate for blocks of size 2^( 8) =       0.000300167855

      target function =                  N/A
              le_mean =     -17.217223387194
             les_mean =     296.749127525346
             stat err =       0.000297659799
             autocorr =       1.179822769986
              std dev =       0.548077271829
             le_variance =       0.300388695896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300348575780
                                         uncertainty =       0.001631270145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300348575780
                                         uncertainty =       0.001631270145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274038636
  error estimate for blocks of size 2^( 2) =       0.000281039046
  error estimate for blocks of size 2^( 3) =       0.000287167227
  error estimate for blocks of size 2^( 4) =       0.000292167535
  error estimate for blocks of size 2^( 5) =       0.000295393242
  error estimate for blocks of size 2^( 6) =       0.000296901333
  error estimate for blocks of size 2^( 7) =       0.000298176764
  error estimate for blocks of size 2^( 8) =       0.000300167855

      target function =                  N/A
              le_mean =     -17.217223387194
             les_mean =     296.749127525346
             stat err =       0.000297659799
             autocorr =       1.179822769986
              std dev =       0.548077271829
             le_variance =       0.300388695896


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217223387194        initial  <--
     8.8818e+23     8.8818e+24             0.0000e+00       -17.217223387194
     3.5527e+24     3.5527e+25             0.0000e+00       -17.217223387194
     1.4211e+25     1.4211e+26             0.0000e+00       -17.217223387194

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.1620
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8354e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.2082
    reference variance = 0.305891
====================================================
  Execution time = 2.7460e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0574e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1556e-01
  Total weights = 3.913413687e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9535e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300245061675
                                         uncertainty =       0.001381609468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300245061675
                                         uncertainty =       0.001381609468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273996998
  error estimate for blocks of size 2^( 2) =       0.000280993293
  error estimate for blocks of size 2^( 3) =       0.000287451058
  error estimate for blocks of size 2^( 4) =       0.000292303270
  error estimate for blocks of size 2^( 5) =       0.000295500967
  error estimate for blocks of size 2^( 6) =       0.000297093716
  error estimate for blocks of size 2^( 7) =       0.000297772977
  error estimate for blocks of size 2^( 8) =       0.000297231015

      target function =                  N/A
              le_mean =     -17.216175310658
             les_mean =     296.712253789919
             stat err =       0.000296899669
             autocorr =       1.174161448233
              std dev =       0.547993995762
             le_variance =       0.300297419391


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721617531066e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+24, overlap shift 8.8818e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216175310670       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216175310670       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216175310670       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+24 is 2.659772e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+25, overlap shift 3.5527e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216175310670       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216175310670       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216175310670       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+25 is 6.649429e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+26, overlap shift 1.4211e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216175310670       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216175310670       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216175310670       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+26 is 1.662357e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.468768 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2422e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.2569
    reference variance = 0.254453
====================================================
  Execution time = 2.9398e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1630e-01
  Total weights = 3.9132e+06
  Execution time = 3.6413e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301620506629
                                         uncertainty =       0.002264823264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301620506629
                                         uncertainty =       0.002264823264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274582737
  error estimate for blocks of size 2^( 2) =       0.000281590991
  error estimate for blocks of size 2^( 3) =       0.000287731394
  error estimate for blocks of size 2^( 4) =       0.000292178495
  error estimate for blocks of size 2^( 5) =       0.000294947240
  error estimate for blocks of size 2^( 6) =       0.000296924998
  error estimate for blocks of size 2^( 7) =       0.000297984306
  error estimate for blocks of size 2^( 8) =       0.000298748121

      target function =                  N/A
              le_mean =     -17.216914925257
             les_mean =     296.738461619931
             stat err =       0.000297151166
             autocorr =       1.171138932934
              std dev =       0.549165473525
             le_variance =       0.301582717312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301620506629
                                         uncertainty =       0.002264823264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301620506629
                                         uncertainty =       0.002264823264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274582737
  error estimate for blocks of size 2^( 2) =       0.000281590991
  error estimate for blocks of size 2^( 3) =       0.000287731394
  error estimate for blocks of size 2^( 4) =       0.000292178495
  error estimate for blocks of size 2^( 5) =       0.000294947240
  error estimate for blocks of size 2^( 6) =       0.000296924998
  error estimate for blocks of size 2^( 7) =       0.000297984306
  error estimate for blocks of size 2^( 8) =       0.000298748121

      target function =                  N/A
              le_mean =     -17.216914925257
             les_mean =     296.738461619931
             stat err =       0.000297151166
             autocorr =       1.171138932934
              std dev =       0.549165473525
             le_variance =       0.301582717312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301620506629
                                         uncertainty =       0.002264823264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301620506629
                                         uncertainty =       0.002264823264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274582737
  error estimate for blocks of size 2^( 2) =       0.000281590991
  error estimate for blocks of size 2^( 3) =       0.000287731394
  error estimate for blocks of size 2^( 4) =       0.000292178495
  error estimate for blocks of size 2^( 5) =       0.000294947240
  error estimate for blocks of size 2^( 6) =       0.000296924998
  error estimate for blocks of size 2^( 7) =       0.000297984306
  error estimate for blocks of size 2^( 8) =       0.000298748121

      target function =                  N/A
              le_mean =     -17.216914925257
             les_mean =     296.738461619931
             stat err =       0.000297151166
             autocorr =       1.171138932934
              std dev =       0.549165473525
             le_variance =       0.301582717312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301620506629
                                         uncertainty =       0.002264823264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301620506629
                                         uncertainty =       0.002264823264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274582737
  error estimate for blocks of size 2^( 2) =       0.000281590991
  error estimate for blocks of size 2^( 3) =       0.000287731394
  error estimate for blocks of size 2^( 4) =       0.000292178495
  error estimate for blocks of size 2^( 5) =       0.000294947240
  error estimate for blocks of size 2^( 6) =       0.000296924998
  error estimate for blocks of size 2^( 7) =       0.000297984306
  error estimate for blocks of size 2^( 8) =       0.000298748121

      target function =                  N/A
              le_mean =     -17.216914925257
             les_mean =     296.738461619931
             stat err =       0.000297151166
             autocorr =       1.171138932934
              std dev =       0.549165473525
             le_variance =       0.301582717312


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216914925257        initial  <--
     8.8818e+24     8.8818e+25             2.6598e-29       -17.216914925257
     3.5527e+25     3.5527e+26             6.6494e-30       -17.216914925257
     1.4211e+26     1.4211e+27             1.6624e-30       -17.216914925257

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.9364
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0365e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.1841
    reference variance = 0.21437
====================================================
  Execution time = 2.7298e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0613e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1663e-01
  Total weights = 3.913478598e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9521e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301657143227
                                         uncertainty =       0.001631285138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301657143227
                                         uncertainty =       0.001631285138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274603731
  error estimate for blocks of size 2^( 2) =       0.000281820505
  error estimate for blocks of size 2^( 3) =       0.000288263598
  error estimate for blocks of size 2^( 4) =       0.000292890134
  error estimate for blocks of size 2^( 5) =       0.000295344817
  error estimate for blocks of size 2^( 6) =       0.000296822117
  error estimate for blocks of size 2^( 7) =       0.000296950119
  error estimate for blocks of size 2^( 8) =       0.000297541841

      target function =                  N/A
              le_mean =     -17.216560991106
             les_mean =     296.726605184006
             stat err =       0.000296664723
             autocorr =       1.167129230882
              std dev =       0.549207462552
             le_variance =       0.301628836923


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656099111e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+25, overlap shift 8.8818e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216560991125       residual = 7.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216560991125       residual = 7.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+26, overlap shift 3.5527e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216560991125       residual = 7.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216560991125       residual = 7.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+27, overlap shift 1.4211e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216560991125       residual = 7.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216560991125       residual = 7.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.469859 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2257e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.1464
    reference variance = 0.259488
====================================================
  Execution time = 2.7099e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1437e-01
  Total weights = 3.9134e+06
  Execution time = 3.6307e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300346977332
                                         uncertainty =       0.001231177584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300346977332
                                         uncertainty =       0.001231177584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274028965
  error estimate for blocks of size 2^( 2) =       0.000281059350
  error estimate for blocks of size 2^( 3) =       0.000287466957
  error estimate for blocks of size 2^( 4) =       0.000292490343
  error estimate for blocks of size 2^( 5) =       0.000295159716
  error estimate for blocks of size 2^( 6) =       0.000296839897
  error estimate for blocks of size 2^( 7) =       0.000298906028
  error estimate for blocks of size 2^( 8) =       0.000299482233

      target function =                  N/A
              le_mean =     -17.216363154441
             les_mean =     296.717533380449
             stat err =       0.000297596968
             autocorr =       1.179407985105
              std dev =       0.548057930663
             le_variance =       0.300367495363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300346977332
                                         uncertainty =       0.001231177584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300346977332
                                         uncertainty =       0.001231177584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274028965
  error estimate for blocks of size 2^( 2) =       0.000281059350
  error estimate for blocks of size 2^( 3) =       0.000287466957
  error estimate for blocks of size 2^( 4) =       0.000292490343
  error estimate for blocks of size 2^( 5) =       0.000295159716
  error estimate for blocks of size 2^( 6) =       0.000296839897
  error estimate for blocks of size 2^( 7) =       0.000298906028
  error estimate for blocks of size 2^( 8) =       0.000299482233

      target function =                  N/A
              le_mean =     -17.216363154441
             les_mean =     296.717533380449
             stat err =       0.000297596968
             autocorr =       1.179407985105
              std dev =       0.548057930663
             le_variance =       0.300367495363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300346977332
                                         uncertainty =       0.001231177584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300346977332
                                         uncertainty =       0.001231177584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274028965
  error estimate for blocks of size 2^( 2) =       0.000281059350
  error estimate for blocks of size 2^( 3) =       0.000287466957
  error estimate for blocks of size 2^( 4) =       0.000292490343
  error estimate for blocks of size 2^( 5) =       0.000295159716
  error estimate for blocks of size 2^( 6) =       0.000296839897
  error estimate for blocks of size 2^( 7) =       0.000298906028
  error estimate for blocks of size 2^( 8) =       0.000299482233

      target function =                  N/A
              le_mean =     -17.216363154441
             les_mean =     296.717533380449
             stat err =       0.000297596968
             autocorr =       1.179407985105
              std dev =       0.548057930663
             le_variance =       0.300367495363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300346977332
                                         uncertainty =       0.001231177584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300346977332
                                         uncertainty =       0.001231177584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274028965
  error estimate for blocks of size 2^( 2) =       0.000281059350
  error estimate for blocks of size 2^( 3) =       0.000287466957
  error estimate for blocks of size 2^( 4) =       0.000292490343
  error estimate for blocks of size 2^( 5) =       0.000295159716
  error estimate for blocks of size 2^( 6) =       0.000296839897
  error estimate for blocks of size 2^( 7) =       0.000298906028
  error estimate for blocks of size 2^( 8) =       0.000299482233

      target function =                  N/A
              le_mean =     -17.216363154441
             les_mean =     296.717533380449
             stat err =       0.000297596968
             autocorr =       1.179407985105
              std dev =       0.548057930663
             le_variance =       0.300367495363


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216363154441        initial  <--
     8.8818e+25     8.8818e+26             0.0000e+00       -17.216363154441
     3.5527e+26     3.5527e+27             0.0000e+00       -17.216363154441
     1.4211e+27     1.4211e+28             0.0000e+00       -17.216363154441

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.6035
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7873e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.243
    reference variance = 0.175929
====================================================
  Execution time = 2.7091e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0586e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1595e-01
  Total weights = 3.913315269e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9277e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300367982004
                                         uncertainty =       0.002700194768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300367982004
                                         uncertainty =       0.002700194768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274006814
  error estimate for blocks of size 2^( 2) =       0.000281047463
  error estimate for blocks of size 2^( 3) =       0.000287204769
  error estimate for blocks of size 2^( 4) =       0.000291724883
  error estimate for blocks of size 2^( 5) =       0.000294693251
  error estimate for blocks of size 2^( 6) =       0.000296261264
  error estimate for blocks of size 2^( 7) =       0.000296673069
  error estimate for blocks of size 2^( 8) =       0.000296922252

      target function =                  N/A
              le_mean =     -17.216233196505
             les_mean =     296.714634246546
             stat err =       0.000296137459
             autocorr =       1.168056808817
              std dev =       0.548013628048
             le_variance =       0.300318936527


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721623319651e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+26, overlap shift 8.8818e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216233196528       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216233196528       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+27, overlap shift 3.5527e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216233196528       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216233196528       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+28, overlap shift 1.4211e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216233196528       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216233196528       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.470960 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2028e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.2498
    reference variance = 0.19342
====================================================
  Execution time = 2.6963e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1465e-01
  Total weights = 3.9134e+06
  Execution time = 3.6220e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299412978737
                                         uncertainty =       0.001717453032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299412978737
                                         uncertainty =       0.001717453032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273570849
  error estimate for blocks of size 2^( 2) =       0.000280404507
  error estimate for blocks of size 2^( 3) =       0.000286779820
  error estimate for blocks of size 2^( 4) =       0.000291530825
  error estimate for blocks of size 2^( 5) =       0.000294817627
  error estimate for blocks of size 2^( 6) =       0.000296073128
  error estimate for blocks of size 2^( 7) =       0.000296290600
  error estimate for blocks of size 2^( 8) =       0.000297371463

      target function =                  N/A
              le_mean =     -17.216821281625
             les_mean =     296.733581959458
             stat err =       0.000296138204
             autocorr =       1.171788525238
              std dev =       0.547141698156
             le_variance =       0.299364037861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299412978737
                                         uncertainty =       0.001717453032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299412978737
                                         uncertainty =       0.001717453032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273570849
  error estimate for blocks of size 2^( 2) =       0.000280404507
  error estimate for blocks of size 2^( 3) =       0.000286779820
  error estimate for blocks of size 2^( 4) =       0.000291530825
  error estimate for blocks of size 2^( 5) =       0.000294817627
  error estimate for blocks of size 2^( 6) =       0.000296073128
  error estimate for blocks of size 2^( 7) =       0.000296290600
  error estimate for blocks of size 2^( 8) =       0.000297371463

      target function =                  N/A
              le_mean =     -17.216821281625
             les_mean =     296.733581959458
             stat err =       0.000296138204
             autocorr =       1.171788525238
              std dev =       0.547141698156
             le_variance =       0.299364037861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299412978737
                                         uncertainty =       0.001717453032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299412978737
                                         uncertainty =       0.001717453032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273570849
  error estimate for blocks of size 2^( 2) =       0.000280404507
  error estimate for blocks of size 2^( 3) =       0.000286779820
  error estimate for blocks of size 2^( 4) =       0.000291530825
  error estimate for blocks of size 2^( 5) =       0.000294817627
  error estimate for blocks of size 2^( 6) =       0.000296073128
  error estimate for blocks of size 2^( 7) =       0.000296290600
  error estimate for blocks of size 2^( 8) =       0.000297371463

      target function =                  N/A
              le_mean =     -17.216821281625
             les_mean =     296.733581959458
             stat err =       0.000296138204
             autocorr =       1.171788525238
              std dev =       0.547141698156
             le_variance =       0.299364037861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299412978737
                                         uncertainty =       0.001717453032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299412978737
                                         uncertainty =       0.001717453032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273570849
  error estimate for blocks of size 2^( 2) =       0.000280404507
  error estimate for blocks of size 2^( 3) =       0.000286779820
  error estimate for blocks of size 2^( 4) =       0.000291530825
  error estimate for blocks of size 2^( 5) =       0.000294817627
  error estimate for blocks of size 2^( 6) =       0.000296073128
  error estimate for blocks of size 2^( 7) =       0.000296290600
  error estimate for blocks of size 2^( 8) =       0.000297371463

      target function =                  N/A
              le_mean =     -17.216821281625
             les_mean =     296.733581959458
             stat err =       0.000296138204
             autocorr =       1.171788525238
              std dev =       0.547141698156
             le_variance =       0.299364037861


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216821281625        initial  <--
     8.8818e+26     8.8818e+27             0.0000e+00       -17.216821281625
     3.5527e+27     3.5527e+28             0.0000e+00       -17.216821281625
     1.4211e+28     1.4211e+29             0.0000e+00       -17.216821281625

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.4342
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7468e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.213
    reference variance = 0.234145
====================================================
  Execution time = 2.7272e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0562e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1086e-01
  Total weights = 3.913478713e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9300e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298097314216
                                         uncertainty =       0.001498361588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298097314216
                                         uncertainty =       0.001498361588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273006161
  error estimate for blocks of size 2^( 2) =       0.000280011142
  error estimate for blocks of size 2^( 3) =       0.000286757716
  error estimate for blocks of size 2^( 4) =       0.000291563867
  error estimate for blocks of size 2^( 5) =       0.000294280682
  error estimate for blocks of size 2^( 6) =       0.000296070080
  error estimate for blocks of size 2^( 7) =       0.000297057838
  error estimate for blocks of size 2^( 8) =       0.000297146971

      target function =                  N/A
              le_mean =     -17.216546867887
             les_mean =     296.720348549769
             stat err =       0.000296138893
             autocorr =       1.176646485898
              std dev =       0.546012321457
             le_variance =       0.298129455183


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654686789e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+27, overlap shift 8.8818e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216546867906       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216546867906       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+28, overlap shift 3.5527e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216546867906       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216546867906       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+29, overlap shift 1.4211e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216546867906       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216546867906       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.472064 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2231e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.2253
    reference variance = 0.598686
====================================================
  Execution time = 2.6981e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1751e-01
  Total weights = 3.9133e+06
  Execution time = 3.6438e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299793006461
                                         uncertainty =       0.001436676691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299793006461
                                         uncertainty =       0.001436676691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273766237
  error estimate for blocks of size 2^( 2) =       0.000280959840
  error estimate for blocks of size 2^( 3) =       0.000287564059
  error estimate for blocks of size 2^( 4) =       0.000292057500
  error estimate for blocks of size 2^( 5) =       0.000294959489
  error estimate for blocks of size 2^( 6) =       0.000296675866
  error estimate for blocks of size 2^( 7) =       0.000296965427
  error estimate for blocks of size 2^( 8) =       0.000297476786

      target function =                  N/A
              le_mean =     -17.216427611772
             les_mean =     296.722885323223
             stat err =       0.000296519392
             autocorr =       1.173130782579
              std dev =       0.547532473079
             le_variance =       0.299791809076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299793006461
                                         uncertainty =       0.001436676691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299793006461
                                         uncertainty =       0.001436676691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273766237
  error estimate for blocks of size 2^( 2) =       0.000280959840
  error estimate for blocks of size 2^( 3) =       0.000287564059
  error estimate for blocks of size 2^( 4) =       0.000292057500
  error estimate for blocks of size 2^( 5) =       0.000294959489
  error estimate for blocks of size 2^( 6) =       0.000296675866
  error estimate for blocks of size 2^( 7) =       0.000296965427
  error estimate for blocks of size 2^( 8) =       0.000297476786

      target function =                  N/A
              le_mean =     -17.216427611772
             les_mean =     296.722885323223
             stat err =       0.000296519392
             autocorr =       1.173130782579
              std dev =       0.547532473079
             le_variance =       0.299791809076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299793006461
                                         uncertainty =       0.001436676691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299793006461
                                         uncertainty =       0.001436676691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273766237
  error estimate for blocks of size 2^( 2) =       0.000280959840
  error estimate for blocks of size 2^( 3) =       0.000287564059
  error estimate for blocks of size 2^( 4) =       0.000292057500
  error estimate for blocks of size 2^( 5) =       0.000294959489
  error estimate for blocks of size 2^( 6) =       0.000296675866
  error estimate for blocks of size 2^( 7) =       0.000296965427
  error estimate for blocks of size 2^( 8) =       0.000297476786

      target function =                  N/A
              le_mean =     -17.216427611772
             les_mean =     296.722885323223
             stat err =       0.000296519392
             autocorr =       1.173130782579
              std dev =       0.547532473079
             le_variance =       0.299791809076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299793006461
                                         uncertainty =       0.001436676691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299793006461
                                         uncertainty =       0.001436676691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273766237
  error estimate for blocks of size 2^( 2) =       0.000280959840
  error estimate for blocks of size 2^( 3) =       0.000287564059
  error estimate for blocks of size 2^( 4) =       0.000292057500
  error estimate for blocks of size 2^( 5) =       0.000294959489
  error estimate for blocks of size 2^( 6) =       0.000296675866
  error estimate for blocks of size 2^( 7) =       0.000296965427
  error estimate for blocks of size 2^( 8) =       0.000297476786

      target function =                  N/A
              le_mean =     -17.216427611772
             les_mean =     296.722885323223
             stat err =       0.000296519392
             autocorr =       1.173130782579
              std dev =       0.547532473079
             le_variance =       0.299791809076


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216427611772        initial  <--
     8.8818e+27     8.8818e+28             0.0000e+00       -17.216427611772
     3.5527e+28     3.5527e+29             0.0000e+00       -17.216427611772
     1.4211e+29     1.4211e+30             0.0000e+00       -17.216427611772

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.4992
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7737e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.2163
    reference variance = 0.413302
====================================================
  Execution time = 2.6854e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0573e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1385e-01
  Total weights = 3.913301191e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9487e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299292435441
                                         uncertainty =       0.001316937412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299292435441
                                         uncertainty =       0.001316937412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273525605
  error estimate for blocks of size 2^( 2) =       0.000280693050
  error estimate for blocks of size 2^( 3) =       0.000287218425
  error estimate for blocks of size 2^( 4) =       0.000292070392
  error estimate for blocks of size 2^( 5) =       0.000294725253
  error estimate for blocks of size 2^( 6) =       0.000296240121
  error estimate for blocks of size 2^( 7) =       0.000297581212
  error estimate for blocks of size 2^( 8) =       0.000299048711

      target function =                  N/A
              le_mean =     -17.216750190237
             les_mean =     296.730337889639
             stat err =       0.000296898824
             autocorr =       1.178205326696
              std dev =       0.547051209335
             le_variance =       0.299265025635


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721675019024e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+28, overlap shift 8.8818e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216750190253       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216750190253       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+29, overlap shift 3.5527e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216750190253       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216750190253       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+30, overlap shift 1.4211e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216750190253       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216750190253       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.473165 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1811e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.2203
    reference variance = 0.200119
====================================================
  Execution time = 2.9548e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1303e-01
  Total weights = 3.9133e+06
  Execution time = 3.6259e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298518316133
                                         uncertainty =       0.001447087334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298518316133
                                         uncertainty =       0.001447087334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273170352
  error estimate for blocks of size 2^( 2) =       0.000280361757
  error estimate for blocks of size 2^( 3) =       0.000286695384
  error estimate for blocks of size 2^( 4) =       0.000291435740
  error estimate for blocks of size 2^( 5) =       0.000294606147
  error estimate for blocks of size 2^( 6) =       0.000296917693
  error estimate for blocks of size 2^( 7) =       0.000298527603
  error estimate for blocks of size 2^( 8) =       0.000298252236

      target function =                  N/A
              le_mean =     -17.216346783025
             les_mean =     296.715630138166
             stat err =       0.000297075920
             autocorr =       1.182681423741
              std dev =       0.546340704202
             le_variance =       0.298488165068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298518316133
                                         uncertainty =       0.001447087334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298518316133
                                         uncertainty =       0.001447087334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273170352
  error estimate for blocks of size 2^( 2) =       0.000280361757
  error estimate for blocks of size 2^( 3) =       0.000286695384
  error estimate for blocks of size 2^( 4) =       0.000291435740
  error estimate for blocks of size 2^( 5) =       0.000294606147
  error estimate for blocks of size 2^( 6) =       0.000296917693
  error estimate for blocks of size 2^( 7) =       0.000298527603
  error estimate for blocks of size 2^( 8) =       0.000298252236

      target function =                  N/A
              le_mean =     -17.216346783025
             les_mean =     296.715630138166
             stat err =       0.000297075920
             autocorr =       1.182681423741
              std dev =       0.546340704202
             le_variance =       0.298488165068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298518316133
                                         uncertainty =       0.001447087334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298518316133
                                         uncertainty =       0.001447087334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273170352
  error estimate for blocks of size 2^( 2) =       0.000280361757
  error estimate for blocks of size 2^( 3) =       0.000286695384
  error estimate for blocks of size 2^( 4) =       0.000291435740
  error estimate for blocks of size 2^( 5) =       0.000294606147
  error estimate for blocks of size 2^( 6) =       0.000296917693
  error estimate for blocks of size 2^( 7) =       0.000298527603
  error estimate for blocks of size 2^( 8) =       0.000298252236

      target function =                  N/A
              le_mean =     -17.216346783025
             les_mean =     296.715630138166
             stat err =       0.000297075920
             autocorr =       1.182681423741
              std dev =       0.546340704202
             le_variance =       0.298488165068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298518316133
                                         uncertainty =       0.001447087334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298518316133
                                         uncertainty =       0.001447087334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273170352
  error estimate for blocks of size 2^( 2) =       0.000280361757
  error estimate for blocks of size 2^( 3) =       0.000286695384
  error estimate for blocks of size 2^( 4) =       0.000291435740
  error estimate for blocks of size 2^( 5) =       0.000294606147
  error estimate for blocks of size 2^( 6) =       0.000296917693
  error estimate for blocks of size 2^( 7) =       0.000298527603
  error estimate for blocks of size 2^( 8) =       0.000298252236

      target function =                  N/A
              le_mean =     -17.216346783025
             les_mean =     296.715630138166
             stat err =       0.000297075920
             autocorr =       1.182681423741
              std dev =       0.546340704202
             le_variance =       0.298488165068


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216346783025        initial  <--
     8.8818e+28     8.8818e+29             0.0000e+00       -17.216346783025
     3.5527e+29     3.5527e+30             0.0000e+00       -17.216346783025
     1.4211e+30     1.4211e+31             0.0000e+00       -17.216346783025

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.0535
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9873e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2076
    reference variance = 0.168902
====================================================
  Execution time = 2.7357e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0542e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0946e-01
  Total weights = 3.913574811e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9479e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296588278181
                                         uncertainty =       0.001445688804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296588278181
                                         uncertainty =       0.001445688804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272300236
  error estimate for blocks of size 2^( 2) =       0.000279313943
  error estimate for blocks of size 2^( 3) =       0.000285865884
  error estimate for blocks of size 2^( 4) =       0.000290618886
  error estimate for blocks of size 2^( 5) =       0.000293102490
  error estimate for blocks of size 2^( 6) =       0.000295614787
  error estimate for blocks of size 2^( 7) =       0.000295942789
  error estimate for blocks of size 2^( 8) =       0.000297616966

      target function =                  N/A
              le_mean =     -17.216447828648
             les_mean =     296.715536741989
             stat err =       0.000295569258
             autocorr =       1.178209411986
              std dev =       0.544600471473
             le_variance =       0.296589673528


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721644782865e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+29, overlap shift 8.8818e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216447828681       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216447828681       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+30, overlap shift 3.5527e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216447828681       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216447828681       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+31, overlap shift 1.4211e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216447828681       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216447828681       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.474275 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2312e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2412
    reference variance = 0.224646
====================================================
  Execution time = 2.7293e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1365e-01
  Total weights = 3.9131e+06
  Execution time = 3.6449e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300675090000
                                         uncertainty =       0.001381514056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300675090000
                                         uncertainty =       0.001381514056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274172517
  error estimate for blocks of size 2^( 2) =       0.000281167621
  error estimate for blocks of size 2^( 3) =       0.000287659327
  error estimate for blocks of size 2^( 4) =       0.000292660818
  error estimate for blocks of size 2^( 5) =       0.000295783885
  error estimate for blocks of size 2^( 6) =       0.000297329493
  error estimate for blocks of size 2^( 7) =       0.000298577568
  error estimate for blocks of size 2^( 8) =       0.000297663555

      target function =                  N/A
              le_mean =     -17.216316692146
             les_mean =     296.715205991201
             stat err =       0.000297338625
             autocorr =       1.176128622413
              std dev =       0.548345034577
             le_variance =       0.300682276945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300675090000
                                         uncertainty =       0.001381514056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300675090000
                                         uncertainty =       0.001381514056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274172517
  error estimate for blocks of size 2^( 2) =       0.000281167621
  error estimate for blocks of size 2^( 3) =       0.000287659327
  error estimate for blocks of size 2^( 4) =       0.000292660818
  error estimate for blocks of size 2^( 5) =       0.000295783885
  error estimate for blocks of size 2^( 6) =       0.000297329493
  error estimate for blocks of size 2^( 7) =       0.000298577568
  error estimate for blocks of size 2^( 8) =       0.000297663555

      target function =                  N/A
              le_mean =     -17.216316692146
             les_mean =     296.715205991201
             stat err =       0.000297338625
             autocorr =       1.176128622413
              std dev =       0.548345034577
             le_variance =       0.300682276945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300675090000
                                         uncertainty =       0.001381514056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300675090000
                                         uncertainty =       0.001381514056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274172517
  error estimate for blocks of size 2^( 2) =       0.000281167621
  error estimate for blocks of size 2^( 3) =       0.000287659327
  error estimate for blocks of size 2^( 4) =       0.000292660818
  error estimate for blocks of size 2^( 5) =       0.000295783885
  error estimate for blocks of size 2^( 6) =       0.000297329493
  error estimate for blocks of size 2^( 7) =       0.000298577568
  error estimate for blocks of size 2^( 8) =       0.000297663555

      target function =                  N/A
              le_mean =     -17.216316692146
             les_mean =     296.715205991201
             stat err =       0.000297338625
             autocorr =       1.176128622413
              std dev =       0.548345034577
             le_variance =       0.300682276945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300675090000
                                         uncertainty =       0.001381514056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300675090000
                                         uncertainty =       0.001381514056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274172517
  error estimate for blocks of size 2^( 2) =       0.000281167621
  error estimate for blocks of size 2^( 3) =       0.000287659327
  error estimate for blocks of size 2^( 4) =       0.000292660818
  error estimate for blocks of size 2^( 5) =       0.000295783885
  error estimate for blocks of size 2^( 6) =       0.000297329493
  error estimate for blocks of size 2^( 7) =       0.000298577568
  error estimate for blocks of size 2^( 8) =       0.000297663555

      target function =                  N/A
              le_mean =     -17.216316692146
             les_mean =     296.715205991201
             stat err =       0.000297338625
             autocorr =       1.176128622413
              std dev =       0.548345034577
             le_variance =       0.300682276945


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216316692146        initial  <--
     8.8818e+29     8.8818e+30             0.0000e+00       -17.216316692146
     3.5527e+30     3.5527e+31             0.0000e+00       -17.216316692146
     1.4211e+31     1.4211e+32             0.0000e+00       -17.216316692146

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.8208
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8141e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2797
    reference variance = 0.235513
====================================================
  Execution time = 2.7252e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0584e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1345e-01
  Total weights = 3.913289869e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9481e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300209045009
                                         uncertainty =       0.001435429075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300209045009
                                         uncertainty =       0.001435429075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273965271
  error estimate for blocks of size 2^( 2) =       0.000281082593
  error estimate for blocks of size 2^( 3) =       0.000287513214
  error estimate for blocks of size 2^( 4) =       0.000292344617
  error estimate for blocks of size 2^( 5) =       0.000295502816
  error estimate for blocks of size 2^( 6) =       0.000297771512
  error estimate for blocks of size 2^( 7) =       0.000298895550
  error estimate for blocks of size 2^( 8) =       0.000299223268

      target function =                  N/A
              le_mean =     -17.216429678258
             les_mean =     296.718898058489
             stat err =       0.000297848286
             autocorr =       1.181950221063
              std dev =       0.547930541430
             le_variance =       0.300227878232


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721642967826e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+30, overlap shift 8.8818e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216429678273       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216429678273       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+31, overlap shift 3.5527e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216429678273       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216429678273       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+32, overlap shift 1.4211e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216429678273       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216429678273       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.475378 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2207e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.1935
    reference variance = 0.142361
====================================================
  Execution time = 2.7056e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1606e-01
  Total weights = 3.9135e+06
  Execution time = 3.6359e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300774419892
                                         uncertainty =       0.001823455933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300774419892
                                         uncertainty =       0.001823455933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274247012
  error estimate for blocks of size 2^( 2) =       0.000281309493
  error estimate for blocks of size 2^( 3) =       0.000287641527
  error estimate for blocks of size 2^( 4) =       0.000292011760
  error estimate for blocks of size 2^( 5) =       0.000294461899
  error estimate for blocks of size 2^( 6) =       0.000296371781
  error estimate for blocks of size 2^( 7) =       0.000297370532
  error estimate for blocks of size 2^( 8) =       0.000299594849

      target function =                  N/A
              le_mean =     -17.216634939539
             les_mean =     296.728580193532
             stat err =       0.000296949765
             autocorr =       1.172417150643
              std dev =       0.548494024397
             le_variance =       0.300845694799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300774419892
                                         uncertainty =       0.001823455933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300774419892
                                         uncertainty =       0.001823455933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274247012
  error estimate for blocks of size 2^( 2) =       0.000281309493
  error estimate for blocks of size 2^( 3) =       0.000287641527
  error estimate for blocks of size 2^( 4) =       0.000292011760
  error estimate for blocks of size 2^( 5) =       0.000294461899
  error estimate for blocks of size 2^( 6) =       0.000296371781
  error estimate for blocks of size 2^( 7) =       0.000297370532
  error estimate for blocks of size 2^( 8) =       0.000299594849

      target function =                  N/A
              le_mean =     -17.216634939539
             les_mean =     296.728580193532
             stat err =       0.000296949765
             autocorr =       1.172417150643
              std dev =       0.548494024397
             le_variance =       0.300845694799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300774419892
                                         uncertainty =       0.001823455933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300774419892
                                         uncertainty =       0.001823455933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274247012
  error estimate for blocks of size 2^( 2) =       0.000281309493
  error estimate for blocks of size 2^( 3) =       0.000287641527
  error estimate for blocks of size 2^( 4) =       0.000292011760
  error estimate for blocks of size 2^( 5) =       0.000294461899
  error estimate for blocks of size 2^( 6) =       0.000296371781
  error estimate for blocks of size 2^( 7) =       0.000297370532
  error estimate for blocks of size 2^( 8) =       0.000299594849

      target function =                  N/A
              le_mean =     -17.216634939539
             les_mean =     296.728580193532
             stat err =       0.000296949765
             autocorr =       1.172417150643
              std dev =       0.548494024397
             le_variance =       0.300845694799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300774419892
                                         uncertainty =       0.001823455933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300774419892
                                         uncertainty =       0.001823455933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274247012
  error estimate for blocks of size 2^( 2) =       0.000281309493
  error estimate for blocks of size 2^( 3) =       0.000287641527
  error estimate for blocks of size 2^( 4) =       0.000292011760
  error estimate for blocks of size 2^( 5) =       0.000294461899
  error estimate for blocks of size 2^( 6) =       0.000296371781
  error estimate for blocks of size 2^( 7) =       0.000297370532
  error estimate for blocks of size 2^( 8) =       0.000299594849

      target function =                  N/A
              le_mean =     -17.216634939539
             les_mean =     296.728580193532
             stat err =       0.000296949765
             autocorr =       1.172417150643
              std dev =       0.548494024397
             le_variance =       0.300845694799


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216634939539        initial  <--
     8.8818e+30     8.8818e+31             0.0000e+00       -17.216634939539
     3.5527e+31     3.5527e+32             0.0000e+00       -17.216634939539
     1.4211e+32     1.4211e+33             0.0000e+00       -17.216634939539

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.6124
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7828e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.22
    reference variance = 0.451551
====================================================
  Execution time = 2.7579e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0539e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1468e-01
  Total weights = 3.913457497e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9246e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297978114506
                                         uncertainty =       0.001410136811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297978114506
                                         uncertainty =       0.001410136811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272961316
  error estimate for blocks of size 2^( 2) =       0.000280040973
  error estimate for blocks of size 2^( 3) =       0.000286246147
  error estimate for blocks of size 2^( 4) =       0.000290622584
  error estimate for blocks of size 2^( 5) =       0.000293170085
  error estimate for blocks of size 2^( 6) =       0.000294973046
  error estimate for blocks of size 2^( 7) =       0.000296720999
  error estimate for blocks of size 2^( 8) =       0.000297838211

      target function =                  N/A
              le_mean =     -17.216100756175
             les_mean =     296.708800387213
             stat err =       0.000295675585
             autocorr =       1.173353099415
              std dev =       0.545922631180
             le_variance =       0.298031519234


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721610075617e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+31, overlap shift 8.8818e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216100756196       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216100756196       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216100756196       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+31 is 3.230782e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+32, overlap shift 3.5527e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216100756196       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216100756196       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216100756196       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+32 is 8.076956e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+33, overlap shift 1.4211e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216100756196       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216100756196       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216100752354       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+33 is 1.833128e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.476742 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2511e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.1941
    reference variance = 0.425382
====================================================
  Execution time = 2.7689e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1279e-01
  Total weights = 3.9135e+06
  Execution time = 3.6423e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298599132662
                                         uncertainty =       0.001393421609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298599132662
                                         uncertainty =       0.001393421609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273191811
  error estimate for blocks of size 2^( 2) =       0.000280248066
  error estimate for blocks of size 2^( 3) =       0.000286563061
  error estimate for blocks of size 2^( 4) =       0.000291322178
  error estimate for blocks of size 2^( 5) =       0.000293950435
  error estimate for blocks of size 2^( 6) =       0.000295822480
  error estimate for blocks of size 2^( 7) =       0.000297852803
  error estimate for blocks of size 2^( 8) =       0.000298978300

      target function =                  N/A
              le_mean =     -17.216714445907
             les_mean =     296.728047622573
             stat err =       0.000296651004
             autocorr =       1.179115347402
              std dev =       0.546383621883
             le_variance =       0.298535062262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298599132662
                                         uncertainty =       0.001393421609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298599132662
                                         uncertainty =       0.001393421609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273191811
  error estimate for blocks of size 2^( 2) =       0.000280248066
  error estimate for blocks of size 2^( 3) =       0.000286563061
  error estimate for blocks of size 2^( 4) =       0.000291322178
  error estimate for blocks of size 2^( 5) =       0.000293950435
  error estimate for blocks of size 2^( 6) =       0.000295822480
  error estimate for blocks of size 2^( 7) =       0.000297852803
  error estimate for blocks of size 2^( 8) =       0.000298978300

      target function =                  N/A
              le_mean =     -17.216714445907
             les_mean =     296.728047622573
             stat err =       0.000296651004
             autocorr =       1.179115347402
              std dev =       0.546383621883
             le_variance =       0.298535062262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298599132662
                                         uncertainty =       0.001393421609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298599132662
                                         uncertainty =       0.001393421609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273191811
  error estimate for blocks of size 2^( 2) =       0.000280248066
  error estimate for blocks of size 2^( 3) =       0.000286563061
  error estimate for blocks of size 2^( 4) =       0.000291322178
  error estimate for blocks of size 2^( 5) =       0.000293950435
  error estimate for blocks of size 2^( 6) =       0.000295822480
  error estimate for blocks of size 2^( 7) =       0.000297852803
  error estimate for blocks of size 2^( 8) =       0.000298978300

      target function =                  N/A
              le_mean =     -17.216714445907
             les_mean =     296.728047622573
             stat err =       0.000296651004
             autocorr =       1.179115347402
              std dev =       0.546383621883
             le_variance =       0.298535062262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298599132662
                                         uncertainty =       0.001393421609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298599132662
                                         uncertainty =       0.001393421609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273191811
  error estimate for blocks of size 2^( 2) =       0.000280248066
  error estimate for blocks of size 2^( 3) =       0.000286563061
  error estimate for blocks of size 2^( 4) =       0.000291322178
  error estimate for blocks of size 2^( 5) =       0.000293950435
  error estimate for blocks of size 2^( 6) =       0.000295822480
  error estimate for blocks of size 2^( 7) =       0.000297852803
  error estimate for blocks of size 2^( 8) =       0.000298978300

      target function =                  N/A
              le_mean =     -17.216714445907
             les_mean =     296.728047622573
             stat err =       0.000296651004
             autocorr =       1.179115347402
              std dev =       0.546383621883
             le_variance =       0.298535062262


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216714445907        initial  <--
     8.8818e+31     8.8818e+32             3.2308e-36       -17.216714445907
     3.5527e+32     3.5527e+33             8.0770e-37       -17.216714445907
     1.4211e+33     1.4211e+34             1.8331e-37       -17.216714445907

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.1963
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8756e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.2454
    reference variance = 1.2448
====================================================
  Execution time = 2.9591e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0572e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1341e-01
  Total weights = 3.913369427e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9427e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299224906393
                                         uncertainty =       0.001351736650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299224906393
                                         uncertainty =       0.001351736650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273546266
  error estimate for blocks of size 2^( 2) =       0.000280676354
  error estimate for blocks of size 2^( 3) =       0.000287024854
  error estimate for blocks of size 2^( 4) =       0.000291849786
  error estimate for blocks of size 2^( 5) =       0.000294755744
  error estimate for blocks of size 2^( 6) =       0.000297166508
  error estimate for blocks of size 2^( 7) =       0.000298888196
  error estimate for blocks of size 2^( 8) =       0.000299308019

      target function =                  N/A
              le_mean =     -17.216475697670
             les_mean =     296.720447861411
             stat err =       0.000297529617
             autocorr =       1.183038356447
              std dev =       0.547092531204
             le_variance =       0.299310237699


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721647569767e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+32, overlap shift 8.8818e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216475697688       residual = 7.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216475697688       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216475697688       residual = 8.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+32 is 3.996007e-37

solving harmonic davidson linear method for identity shift 3.5527e+33, overlap shift 3.5527e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216475697688       residual = 7.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216475697688       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216475697688       residual = 8.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+33 is 9.990019e-38

solving harmonic davidson linear method for identity shift 1.4211e+34, overlap shift 1.4211e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216475697688       residual = 7.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216475697688       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216475697688       residual = 8.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+34 is 2.497505e-38

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.477839 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4544e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.2863
    reference variance = 0.382907
====================================================
  Execution time = 2.6915e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1408e-01
  Total weights = 3.9134e+06
  Execution time = 3.6408e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298037526276
                                         uncertainty =       0.001516312105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298037526276
                                         uncertainty =       0.001516312105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272958467
  error estimate for blocks of size 2^( 2) =       0.000280112085
  error estimate for blocks of size 2^( 3) =       0.000286433030
  error estimate for blocks of size 2^( 4) =       0.000290985351
  error estimate for blocks of size 2^( 5) =       0.000294177104
  error estimate for blocks of size 2^( 6) =       0.000295296681
  error estimate for blocks of size 2^( 7) =       0.000295286078
  error estimate for blocks of size 2^( 8) =       0.000296727107

      target function =                  N/A
              le_mean =     -17.216193896792
             les_mean =     296.711410582643
             stat err =       0.000295371743
             autocorr =       1.170967255135
              std dev =       0.545916933350
             le_variance =       0.298025298118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298037526276
                                         uncertainty =       0.001516312105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298037526276
                                         uncertainty =       0.001516312105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272958467
  error estimate for blocks of size 2^( 2) =       0.000280112085
  error estimate for blocks of size 2^( 3) =       0.000286433030
  error estimate for blocks of size 2^( 4) =       0.000290985351
  error estimate for blocks of size 2^( 5) =       0.000294177104
  error estimate for blocks of size 2^( 6) =       0.000295296681
  error estimate for blocks of size 2^( 7) =       0.000295286078
  error estimate for blocks of size 2^( 8) =       0.000296727107

      target function =                  N/A
              le_mean =     -17.216193896792
             les_mean =     296.711410582643
             stat err =       0.000295371743
             autocorr =       1.170967255135
              std dev =       0.545916933350
             le_variance =       0.298025298118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298037526276
                                         uncertainty =       0.001516312105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298037526276
                                         uncertainty =       0.001516312105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272958467
  error estimate for blocks of size 2^( 2) =       0.000280112085
  error estimate for blocks of size 2^( 3) =       0.000286433030
  error estimate for blocks of size 2^( 4) =       0.000290985351
  error estimate for blocks of size 2^( 5) =       0.000294177104
  error estimate for blocks of size 2^( 6) =       0.000295296681
  error estimate for blocks of size 2^( 7) =       0.000295286078
  error estimate for blocks of size 2^( 8) =       0.000296727107

      target function =                  N/A
              le_mean =     -17.216193896792
             les_mean =     296.711410582643
             stat err =       0.000295371743
             autocorr =       1.170967255135
              std dev =       0.545916933350
             le_variance =       0.298025298118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298037526276
                                         uncertainty =       0.001516312105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298037526276
                                         uncertainty =       0.001516312105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272958467
  error estimate for blocks of size 2^( 2) =       0.000280112085
  error estimate for blocks of size 2^( 3) =       0.000286433030
  error estimate for blocks of size 2^( 4) =       0.000290985351
  error estimate for blocks of size 2^( 5) =       0.000294177104
  error estimate for blocks of size 2^( 6) =       0.000295296681
  error estimate for blocks of size 2^( 7) =       0.000295286078
  error estimate for blocks of size 2^( 8) =       0.000296727107

      target function =                  N/A
              le_mean =     -17.216193896792
             les_mean =     296.711410582643
             stat err =       0.000295371743
             autocorr =       1.170967255135
              std dev =       0.545916933350
             le_variance =       0.298025298118


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216193896792        initial  <--
     8.8818e+32     8.8818e+33             3.9960e-37       -17.216193896792
     3.5527e+33     3.5527e+34             9.9900e-38       -17.216193896792
     1.4211e+34     1.4211e+35             2.4975e-38       -17.216193896792

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.4090
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9991e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.2318
    reference variance = 0.300492
====================================================
  Execution time = 2.7405e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0544e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1710e-01
  Total weights = 3.913875930e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9559e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301072904015
                                         uncertainty =       0.001701897937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301072904015
                                         uncertainty =       0.001701897937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274358954
  error estimate for blocks of size 2^( 2) =       0.000281434783
  error estimate for blocks of size 2^( 3) =       0.000287731405
  error estimate for blocks of size 2^( 4) =       0.000292229680
  error estimate for blocks of size 2^( 5) =       0.000295293455
  error estimate for blocks of size 2^( 6) =       0.000296846918
  error estimate for blocks of size 2^( 7) =       0.000297302016
  error estimate for blocks of size 2^( 8) =       0.000297087131

      target function =                  N/A
              le_mean =     -17.216457379076
             les_mean =     296.723508044262
             stat err =       0.000296632380
             autocorr =       1.168957805762
              std dev =       0.548717908259
             le_variance =       0.301091342844


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721645737908e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+33, overlap shift 8.8818e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216457379102       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216457379102       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+34, overlap shift 3.5527e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216457379102       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216457379102       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+35, overlap shift 1.4211e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216457379102       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216457379102       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.478953 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2368e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.1598
    reference variance = 0.298263
====================================================
  Execution time = 2.6877e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1325e-01
  Total weights = 3.9134e+06
  Execution time = 3.6760e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300299527089
                                         uncertainty =       0.001633165651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300299527089
                                         uncertainty =       0.001633165651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273989780
  error estimate for blocks of size 2^( 2) =       0.000280981362
  error estimate for blocks of size 2^( 3) =       0.000287363279
  error estimate for blocks of size 2^( 4) =       0.000292029324
  error estimate for blocks of size 2^( 5) =       0.000294648906
  error estimate for blocks of size 2^( 6) =       0.000296710605
  error estimate for blocks of size 2^( 7) =       0.000298108601
  error estimate for blocks of size 2^( 8) =       0.000299084754

      target function =                  N/A
              le_mean =     -17.216448587647
             les_mean =     296.719350158725
             stat err =       0.000297138216
             autocorr =       1.176110963162
              std dev =       0.547979559199
             le_variance =       0.300281597300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300299527089
                                         uncertainty =       0.001633165651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300299527089
                                         uncertainty =       0.001633165651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273989780
  error estimate for blocks of size 2^( 2) =       0.000280981362
  error estimate for blocks of size 2^( 3) =       0.000287363279
  error estimate for blocks of size 2^( 4) =       0.000292029324
  error estimate for blocks of size 2^( 5) =       0.000294648906
  error estimate for blocks of size 2^( 6) =       0.000296710605
  error estimate for blocks of size 2^( 7) =       0.000298108601
  error estimate for blocks of size 2^( 8) =       0.000299084754

      target function =                  N/A
              le_mean =     -17.216448587647
             les_mean =     296.719350158725
             stat err =       0.000297138216
             autocorr =       1.176110963162
              std dev =       0.547979559199
             le_variance =       0.300281597300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300299527089
                                         uncertainty =       0.001633165651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300299527089
                                         uncertainty =       0.001633165651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273989780
  error estimate for blocks of size 2^( 2) =       0.000280981362
  error estimate for blocks of size 2^( 3) =       0.000287363279
  error estimate for blocks of size 2^( 4) =       0.000292029324
  error estimate for blocks of size 2^( 5) =       0.000294648906
  error estimate for blocks of size 2^( 6) =       0.000296710605
  error estimate for blocks of size 2^( 7) =       0.000298108601
  error estimate for blocks of size 2^( 8) =       0.000299084754

      target function =                  N/A
              le_mean =     -17.216448587647
             les_mean =     296.719350158725
             stat err =       0.000297138216
             autocorr =       1.176110963162
              std dev =       0.547979559199
             le_variance =       0.300281597300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300299527089
                                         uncertainty =       0.001633165651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300299527089
                                         uncertainty =       0.001633165651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273989780
  error estimate for blocks of size 2^( 2) =       0.000280981362
  error estimate for blocks of size 2^( 3) =       0.000287363279
  error estimate for blocks of size 2^( 4) =       0.000292029324
  error estimate for blocks of size 2^( 5) =       0.000294648906
  error estimate for blocks of size 2^( 6) =       0.000296710605
  error estimate for blocks of size 2^( 7) =       0.000298108601
  error estimate for blocks of size 2^( 8) =       0.000299084754

      target function =                  N/A
              le_mean =     -17.216448587647
             les_mean =     296.719350158725
             stat err =       0.000297138216
             autocorr =       1.176110963162
              std dev =       0.547979559199
             le_variance =       0.300281597300


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216448587647        initial  <--
     8.8818e+33     8.8818e+34             0.0000e+00       -17.216448587647
     3.5527e+34     3.5527e+35             0.0000e+00       -17.216448587647
     1.4211e+35     1.4211e+36             0.0000e+00       -17.216448587647

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.4673
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7842e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.2142
    reference variance = 0.198417
====================================================
  Execution time = 2.7169e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0553e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1243e-01
  Total weights = 3.913383536e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9808e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298750834929
                                         uncertainty =       0.001300513938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298750834929
                                         uncertainty =       0.001300513938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273276431
  error estimate for blocks of size 2^( 2) =       0.000280285814
  error estimate for blocks of size 2^( 3) =       0.000286669198
  error estimate for blocks of size 2^( 4) =       0.000291301696
  error estimate for blocks of size 2^( 5) =       0.000294272110
  error estimate for blocks of size 2^( 6) =       0.000295306139
  error estimate for blocks of size 2^( 7) =       0.000296872010
  error estimate for blocks of size 2^( 8) =       0.000297122898

      target function =                  N/A
              le_mean =     -17.216206881605
             les_mean =     296.710214212606
             stat err =       0.000295893289
             autocorr =       1.172373184681
              std dev =       0.546552862475
             le_variance =       0.298720031479


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721620688161e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+34, overlap shift 8.8818e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216206881623       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216206881623       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+35, overlap shift 3.5527e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216206881623       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216206881623       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+36, overlap shift 1.4211e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216206881623       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216206881623       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.480048 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2157e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.2942
    reference variance = 0.558104
====================================================
  Execution time = 2.6965e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1372e-01
  Total weights = 3.9138e+06
  Execution time = 3.6575e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298910352496
                                         uncertainty =       0.001608887728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298910352496
                                         uncertainty =       0.001608887728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273408714
  error estimate for blocks of size 2^( 2) =       0.000280430136
  error estimate for blocks of size 2^( 3) =       0.000286730303
  error estimate for blocks of size 2^( 4) =       0.000291723012
  error estimate for blocks of size 2^( 5) =       0.000294740117
  error estimate for blocks of size 2^( 6) =       0.000296389603
  error estimate for blocks of size 2^( 7) =       0.000297144938
  error estimate for blocks of size 2^( 8) =       0.000297875092

      target function =                  N/A
              le_mean =     -17.216867522850
             les_mean =     296.734245349195
             stat err =       0.000296537437
             autocorr =       1.176344040652
              std dev =       0.546817427704
             le_variance =       0.299009299241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298910352496
                                         uncertainty =       0.001608887728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298910352496
                                         uncertainty =       0.001608887728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273408714
  error estimate for blocks of size 2^( 2) =       0.000280430136
  error estimate for blocks of size 2^( 3) =       0.000286730303
  error estimate for blocks of size 2^( 4) =       0.000291723012
  error estimate for blocks of size 2^( 5) =       0.000294740117
  error estimate for blocks of size 2^( 6) =       0.000296389603
  error estimate for blocks of size 2^( 7) =       0.000297144938
  error estimate for blocks of size 2^( 8) =       0.000297875092

      target function =                  N/A
              le_mean =     -17.216867522850
             les_mean =     296.734245349195
             stat err =       0.000296537437
             autocorr =       1.176344040652
              std dev =       0.546817427704
             le_variance =       0.299009299241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298910352496
                                         uncertainty =       0.001608887728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298910352496
                                         uncertainty =       0.001608887728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273408714
  error estimate for blocks of size 2^( 2) =       0.000280430136
  error estimate for blocks of size 2^( 3) =       0.000286730303
  error estimate for blocks of size 2^( 4) =       0.000291723012
  error estimate for blocks of size 2^( 5) =       0.000294740117
  error estimate for blocks of size 2^( 6) =       0.000296389603
  error estimate for blocks of size 2^( 7) =       0.000297144938
  error estimate for blocks of size 2^( 8) =       0.000297875092

      target function =                  N/A
              le_mean =     -17.216867522850
             les_mean =     296.734245349195
             stat err =       0.000296537437
             autocorr =       1.176344040652
              std dev =       0.546817427704
             le_variance =       0.299009299241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298910352496
                                         uncertainty =       0.001608887728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298910352496
                                         uncertainty =       0.001608887728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273408714
  error estimate for blocks of size 2^( 2) =       0.000280430136
  error estimate for blocks of size 2^( 3) =       0.000286730303
  error estimate for blocks of size 2^( 4) =       0.000291723012
  error estimate for blocks of size 2^( 5) =       0.000294740117
  error estimate for blocks of size 2^( 6) =       0.000296389603
  error estimate for blocks of size 2^( 7) =       0.000297144938
  error estimate for blocks of size 2^( 8) =       0.000297875092

      target function =                  N/A
              le_mean =     -17.216867522850
             les_mean =     296.734245349195
             stat err =       0.000296537437
             autocorr =       1.176344040652
              std dev =       0.546817427704
             le_variance =       0.299009299241


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216867522850        initial  <--
     8.8818e+34     8.8818e+35             0.0000e+00       -17.216867522850
     3.5527e+35     3.5527e+36             0.0000e+00       -17.216867522850
     1.4211e+36     1.4211e+37             0.0000e+00       -17.216867522850

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.6109
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7817e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.2204
    reference variance = 0.2232
====================================================
  Execution time = 2.7247e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0618e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1512e-01
  Total weights = 3.913346287e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9519e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300896308508
                                         uncertainty =       0.001543166759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300896308508
                                         uncertainty =       0.001543166759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274277207
  error estimate for blocks of size 2^( 2) =       0.000281326355
  error estimate for blocks of size 2^( 3) =       0.000287510778
  error estimate for blocks of size 2^( 4) =       0.000292247074
  error estimate for blocks of size 2^( 5) =       0.000295284820
  error estimate for blocks of size 2^( 6) =       0.000297166692
  error estimate for blocks of size 2^( 7) =       0.000298100427
  error estimate for blocks of size 2^( 8) =       0.000299399572

      target function =                  N/A
              le_mean =     -17.216367121911
             les_mean =     296.718415327248
             stat err =       0.000297487878
             autocorr =       1.176411088789
              std dev =       0.548554414556
             le_variance =       0.300911945729


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721636712191e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+35, overlap shift 8.8818e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216367121933       residual = 5.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216367121933       residual = 5.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+36, overlap shift 3.5527e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216367121933       residual = 5.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216367121933       residual = 5.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+37, overlap shift 1.4211e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216367121933       residual = 5.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216367121933       residual = 5.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.481127 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2207e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.2075
    reference variance = 0.242901
====================================================
  Execution time = 2.7169e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1255e-01
  Total weights = 3.9137e+06
  Execution time = 3.6703e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299064608211
                                         uncertainty =       0.001418097216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299064608211
                                         uncertainty =       0.001418097216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273395928
  error estimate for blocks of size 2^( 2) =       0.000280496733
  error estimate for blocks of size 2^( 3) =       0.000286606873
  error estimate for blocks of size 2^( 4) =       0.000291449948
  error estimate for blocks of size 2^( 5) =       0.000294447209
  error estimate for blocks of size 2^( 6) =       0.000295874648
  error estimate for blocks of size 2^( 7) =       0.000296111192
  error estimate for blocks of size 2^( 8) =       0.000296256307

      target function =                  N/A
              le_mean =     -17.216753916220
             les_mean =     296.729162757641
             stat err =       0.000295672339
             autocorr =       1.169599871701
              std dev =       0.546791855427
             le_variance =       0.298981333161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299064608211
                                         uncertainty =       0.001418097216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299064608211
                                         uncertainty =       0.001418097216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273395928
  error estimate for blocks of size 2^( 2) =       0.000280496733
  error estimate for blocks of size 2^( 3) =       0.000286606873
  error estimate for blocks of size 2^( 4) =       0.000291449948
  error estimate for blocks of size 2^( 5) =       0.000294447209
  error estimate for blocks of size 2^( 6) =       0.000295874648
  error estimate for blocks of size 2^( 7) =       0.000296111192
  error estimate for blocks of size 2^( 8) =       0.000296256307

      target function =                  N/A
              le_mean =     -17.216753916220
             les_mean =     296.729162757641
             stat err =       0.000295672339
             autocorr =       1.169599871701
              std dev =       0.546791855427
             le_variance =       0.298981333161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299064608211
                                         uncertainty =       0.001418097216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299064608211
                                         uncertainty =       0.001418097216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273395928
  error estimate for blocks of size 2^( 2) =       0.000280496733
  error estimate for blocks of size 2^( 3) =       0.000286606873
  error estimate for blocks of size 2^( 4) =       0.000291449948
  error estimate for blocks of size 2^( 5) =       0.000294447209
  error estimate for blocks of size 2^( 6) =       0.000295874648
  error estimate for blocks of size 2^( 7) =       0.000296111192
  error estimate for blocks of size 2^( 8) =       0.000296256307

      target function =                  N/A
              le_mean =     -17.216753916220
             les_mean =     296.729162757641
             stat err =       0.000295672339
             autocorr =       1.169599871701
              std dev =       0.546791855427
             le_variance =       0.298981333161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299064608211
                                         uncertainty =       0.001418097216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299064608211
                                         uncertainty =       0.001418097216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273395928
  error estimate for blocks of size 2^( 2) =       0.000280496733
  error estimate for blocks of size 2^( 3) =       0.000286606873
  error estimate for blocks of size 2^( 4) =       0.000291449948
  error estimate for blocks of size 2^( 5) =       0.000294447209
  error estimate for blocks of size 2^( 6) =       0.000295874648
  error estimate for blocks of size 2^( 7) =       0.000296111192
  error estimate for blocks of size 2^( 8) =       0.000296256307

      target function =                  N/A
              le_mean =     -17.216753916220
             les_mean =     296.729162757641
             stat err =       0.000295672339
             autocorr =       1.169599871701
              std dev =       0.546791855427
             le_variance =       0.298981333161


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216753916220        initial  <--
     8.8818e+35     8.8818e+36             0.0000e+00       -17.216753916220
     3.5527e+36     3.5527e+37             0.0000e+00       -17.216753916220
     1.4211e+37     1.4211e+38             0.0000e+00       -17.216753916220

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.7289
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7942e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.1749
    reference variance = 0.351854
====================================================
  Execution time = 2.9366e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0585e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1604e-01
  Total weights = 3.913631801e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9697e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299610761546
                                         uncertainty =       0.001676467931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299610761546
                                         uncertainty =       0.001676467931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273657463
  error estimate for blocks of size 2^( 2) =       0.000280863229
  error estimate for blocks of size 2^( 3) =       0.000287166627
  error estimate for blocks of size 2^( 4) =       0.000291874823
  error estimate for blocks of size 2^( 5) =       0.000295126630
  error estimate for blocks of size 2^( 6) =       0.000296247787
  error estimate for blocks of size 2^( 7) =       0.000296417512
  error estimate for blocks of size 2^( 8) =       0.000298071682

      target function =                  N/A
              le_mean =     -17.216601931196
             les_mean =     296.727419564123
             stat err =       0.000296465903
             autocorr =       1.173640021658
              std dev =       0.547314925605
             le_variance =       0.299553627790


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660193120e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+36, overlap shift 8.8818e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216601931203       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216601931203       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+37, overlap shift 3.5527e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216601931203       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216601931203       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+38, overlap shift 1.4211e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216601931203       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216601931203       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.482216 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4343e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.215
    reference variance = 0.31628
====================================================
  Execution time = 2.7330e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1615e-01
  Total weights = 3.9134e+06
  Execution time = 3.6760e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299816887734
                                         uncertainty =       0.001584913709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299816887734
                                         uncertainty =       0.001584913709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273775018
  error estimate for blocks of size 2^( 2) =       0.000280845061
  error estimate for blocks of size 2^( 3) =       0.000287229994
  error estimate for blocks of size 2^( 4) =       0.000292255663
  error estimate for blocks of size 2^( 5) =       0.000295298880
  error estimate for blocks of size 2^( 6) =       0.000297378926
  error estimate for blocks of size 2^( 7) =       0.000298283127
  error estimate for blocks of size 2^( 8) =       0.000298534363

      target function =                  N/A
              le_mean =     -17.216681161844
             les_mean =     296.730255592295
             stat err =       0.000297373824
             autocorr =       1.179825672253
              std dev =       0.547550036875
             le_variance =       0.299811042882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299816887734
                                         uncertainty =       0.001584913709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299816887734
                                         uncertainty =       0.001584913709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273775018
  error estimate for blocks of size 2^( 2) =       0.000280845061
  error estimate for blocks of size 2^( 3) =       0.000287229994
  error estimate for blocks of size 2^( 4) =       0.000292255663
  error estimate for blocks of size 2^( 5) =       0.000295298880
  error estimate for blocks of size 2^( 6) =       0.000297378926
  error estimate for blocks of size 2^( 7) =       0.000298283127
  error estimate for blocks of size 2^( 8) =       0.000298534363

      target function =                  N/A
              le_mean =     -17.216681161844
             les_mean =     296.730255592295
             stat err =       0.000297373824
             autocorr =       1.179825672253
              std dev =       0.547550036875
             le_variance =       0.299811042882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299816887734
                                         uncertainty =       0.001584913709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299816887734
                                         uncertainty =       0.001584913709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273775018
  error estimate for blocks of size 2^( 2) =       0.000280845061
  error estimate for blocks of size 2^( 3) =       0.000287229994
  error estimate for blocks of size 2^( 4) =       0.000292255663
  error estimate for blocks of size 2^( 5) =       0.000295298880
  error estimate for blocks of size 2^( 6) =       0.000297378926
  error estimate for blocks of size 2^( 7) =       0.000298283127
  error estimate for blocks of size 2^( 8) =       0.000298534363

      target function =                  N/A
              le_mean =     -17.216681161844
             les_mean =     296.730255592295
             stat err =       0.000297373824
             autocorr =       1.179825672253
              std dev =       0.547550036875
             le_variance =       0.299811042882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299816887734
                                         uncertainty =       0.001584913709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299816887734
                                         uncertainty =       0.001584913709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273775018
  error estimate for blocks of size 2^( 2) =       0.000280845061
  error estimate for blocks of size 2^( 3) =       0.000287229994
  error estimate for blocks of size 2^( 4) =       0.000292255663
  error estimate for blocks of size 2^( 5) =       0.000295298880
  error estimate for blocks of size 2^( 6) =       0.000297378926
  error estimate for blocks of size 2^( 7) =       0.000298283127
  error estimate for blocks of size 2^( 8) =       0.000298534363

      target function =                  N/A
              le_mean =     -17.216681161844
             les_mean =     296.730255592295
             stat err =       0.000297373824
             autocorr =       1.179825672253
              std dev =       0.547550036875
             le_variance =       0.299811042882


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216681161844        initial  <--
     8.8818e+36     8.8818e+37             0.0000e+00       -17.216681161844
     3.5527e+37     3.5527e+38             0.0000e+00       -17.216681161844
     1.4211e+38     1.4211e+39             0.0000e+00       -17.216681161844

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.8384
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0192e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.1299
    reference variance = 0.342847
====================================================
  Execution time = 2.7327e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0607e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1841e-01
  Total weights = 3.913714879e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9292e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300741353959
                                         uncertainty =       0.001515814031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300741353959
                                         uncertainty =       0.001515814031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274256824
  error estimate for blocks of size 2^( 2) =       0.000281237463
  error estimate for blocks of size 2^( 3) =       0.000287790574
  error estimate for blocks of size 2^( 4) =       0.000293039255
  error estimate for blocks of size 2^( 5) =       0.000296070542
  error estimate for blocks of size 2^( 6) =       0.000297947489
  error estimate for blocks of size 2^( 7) =       0.000298557892
  error estimate for blocks of size 2^( 8) =       0.000299207802

      target function =                  N/A
              le_mean =     -17.216581509836
             les_mean =     296.729086406487
             stat err =       0.000297945931
             autocorr =       1.180212019843
              std dev =       0.548513647854
             le_variance =       0.300867221882


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721658150984e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+37, overlap shift 8.8818e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216581509858       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216581509858       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+38, overlap shift 3.5527e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216581509858       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216581509858       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216581523418       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+38 is 7.918413e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+39, overlap shift 1.4211e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216581509858       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216581509858       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.483531 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2266e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.1996
    reference variance = 0.251564
====================================================
  Execution time = 2.6922e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1652e-01
  Total weights = 3.9134e+06
  Execution time = 3.6469e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300734553016
                                         uncertainty =       0.001694256015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300734553016
                                         uncertainty =       0.001694256015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274218850
  error estimate for blocks of size 2^( 2) =       0.000281360416
  error estimate for blocks of size 2^( 3) =       0.000287548883
  error estimate for blocks of size 2^( 4) =       0.000292220184
  error estimate for blocks of size 2^( 5) =       0.000294508024
  error estimate for blocks of size 2^( 6) =       0.000296527741
  error estimate for blocks of size 2^( 7) =       0.000297580469
  error estimate for blocks of size 2^( 8) =       0.000299851352

      target function =                  N/A
              le_mean =     -17.216362384268
             les_mean =     296.719653320965
             stat err =       0.000297116896
             autocorr =       1.173978354391
              std dev =       0.548437699882
             le_variance =       0.300783910652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300734553016
                                         uncertainty =       0.001694256015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300734553016
                                         uncertainty =       0.001694256015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274218850
  error estimate for blocks of size 2^( 2) =       0.000281360416
  error estimate for blocks of size 2^( 3) =       0.000287548883
  error estimate for blocks of size 2^( 4) =       0.000292220184
  error estimate for blocks of size 2^( 5) =       0.000294508024
  error estimate for blocks of size 2^( 6) =       0.000296527741
  error estimate for blocks of size 2^( 7) =       0.000297580469
  error estimate for blocks of size 2^( 8) =       0.000299851352

      target function =                  N/A
              le_mean =     -17.216362384268
             les_mean =     296.719653320965
             stat err =       0.000297116896
             autocorr =       1.173978354391
              std dev =       0.548437699882
             le_variance =       0.300783910652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300734553016
                                         uncertainty =       0.001694256015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300734553016
                                         uncertainty =       0.001694256015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274218850
  error estimate for blocks of size 2^( 2) =       0.000281360416
  error estimate for blocks of size 2^( 3) =       0.000287548883
  error estimate for blocks of size 2^( 4) =       0.000292220184
  error estimate for blocks of size 2^( 5) =       0.000294508024
  error estimate for blocks of size 2^( 6) =       0.000296527741
  error estimate for blocks of size 2^( 7) =       0.000297580469
  error estimate for blocks of size 2^( 8) =       0.000299851352

      target function =                  N/A
              le_mean =     -17.216362384268
             les_mean =     296.719653320965
             stat err =       0.000297116896
             autocorr =       1.173978354391
              std dev =       0.548437699882
             le_variance =       0.300783910652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300734553016
                                         uncertainty =       0.001694256015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300734553016
                                         uncertainty =       0.001694256015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274218850
  error estimate for blocks of size 2^( 2) =       0.000281360416
  error estimate for blocks of size 2^( 3) =       0.000287548883
  error estimate for blocks of size 2^( 4) =       0.000292220184
  error estimate for blocks of size 2^( 5) =       0.000294508024
  error estimate for blocks of size 2^( 6) =       0.000296527741
  error estimate for blocks of size 2^( 7) =       0.000297580469
  error estimate for blocks of size 2^( 8) =       0.000299851352

      target function =                  N/A
              le_mean =     -17.216362384268
             les_mean =     296.719653320965
             stat err =       0.000297116896
             autocorr =       1.173978354391
              std dev =       0.548437699882
             le_variance =       0.300783910652


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216362384268        initial  <--
     8.8818e+37     8.8818e+38             0.0000e+00       -17.216362384268
     3.5527e+38     3.5527e+39             7.9184e-43       -17.216362384268
     1.4211e+39     1.4211e+40             0.0000e+00       -17.216362384268

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.4822
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7763e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.1848
    reference variance = 0.218303
====================================================
  Execution time = 2.6978e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0570e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1213e-01
  Total weights = 3.912892918e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9452e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295940559885
                                         uncertainty =       0.001138058683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295940559885
                                         uncertainty =       0.001138058683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272018538
  error estimate for blocks of size 2^( 2) =       0.000279038340
  error estimate for blocks of size 2^( 3) =       0.000285478640
  error estimate for blocks of size 2^( 4) =       0.000290355231
  error estimate for blocks of size 2^( 5) =       0.000293133824
  error estimate for blocks of size 2^( 6) =       0.000295025497
  error estimate for blocks of size 2^( 7) =       0.000296338627
  error estimate for blocks of size 2^( 8) =       0.000296655379

      target function =                  N/A
              le_mean =     -17.216292987914
             les_mean =     296.712876304209
             stat err =       0.000295288332
             autocorr =       1.178407692679
              std dev =       0.544037075989
             le_variance =       0.295976340051


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721629298791e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+38, overlap shift 8.8818e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216292987949       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216292987949       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+39, overlap shift 3.5527e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216292987949       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216292987949       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+40, overlap shift 1.4211e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216292987949       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216292987949       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.484614 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1931e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.1928
    reference variance = 0.137447
====================================================
  Execution time = 2.7073e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1542e-01
  Total weights = 3.9131e+06
  Execution time = 3.6357e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479787001
                                         uncertainty =       0.001356187849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479787001
                                         uncertainty =       0.001356187849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274520363
  error estimate for blocks of size 2^( 2) =       0.000281540542
  error estimate for blocks of size 2^( 3) =       0.000287914440
  error estimate for blocks of size 2^( 4) =       0.000292937917
  error estimate for blocks of size 2^( 5) =       0.000295425938
  error estimate for blocks of size 2^( 6) =       0.000297138970
  error estimate for blocks of size 2^( 7) =       0.000297662655
  error estimate for blocks of size 2^( 8) =       0.000298759096

      target function =                  N/A
              le_mean =     -17.216287856378
             les_mean =     296.715983996944
             stat err =       0.000297246665
             autocorr =       1.172424410842
              std dev =       0.549040725697
             le_variance =       0.301445718474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479787001
                                         uncertainty =       0.001356187849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479787001
                                         uncertainty =       0.001356187849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274520363
  error estimate for blocks of size 2^( 2) =       0.000281540542
  error estimate for blocks of size 2^( 3) =       0.000287914440
  error estimate for blocks of size 2^( 4) =       0.000292937917
  error estimate for blocks of size 2^( 5) =       0.000295425938
  error estimate for blocks of size 2^( 6) =       0.000297138970
  error estimate for blocks of size 2^( 7) =       0.000297662655
  error estimate for blocks of size 2^( 8) =       0.000298759096

      target function =                  N/A
              le_mean =     -17.216287856378
             les_mean =     296.715983996944
             stat err =       0.000297246665
             autocorr =       1.172424410842
              std dev =       0.549040725697
             le_variance =       0.301445718474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479787001
                                         uncertainty =       0.001356187849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479787001
                                         uncertainty =       0.001356187849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274520363
  error estimate for blocks of size 2^( 2) =       0.000281540542
  error estimate for blocks of size 2^( 3) =       0.000287914440
  error estimate for blocks of size 2^( 4) =       0.000292937917
  error estimate for blocks of size 2^( 5) =       0.000295425938
  error estimate for blocks of size 2^( 6) =       0.000297138970
  error estimate for blocks of size 2^( 7) =       0.000297662655
  error estimate for blocks of size 2^( 8) =       0.000298759096

      target function =                  N/A
              le_mean =     -17.216287856378
             les_mean =     296.715983996944
             stat err =       0.000297246665
             autocorr =       1.172424410842
              std dev =       0.549040725697
             le_variance =       0.301445718474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479787001
                                         uncertainty =       0.001356187849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479787001
                                         uncertainty =       0.001356187849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274520363
  error estimate for blocks of size 2^( 2) =       0.000281540542
  error estimate for blocks of size 2^( 3) =       0.000287914440
  error estimate for blocks of size 2^( 4) =       0.000292937917
  error estimate for blocks of size 2^( 5) =       0.000295425938
  error estimate for blocks of size 2^( 6) =       0.000297138970
  error estimate for blocks of size 2^( 7) =       0.000297662655
  error estimate for blocks of size 2^( 8) =       0.000298759096

      target function =                  N/A
              le_mean =     -17.216287856378
             les_mean =     296.715983996944
             stat err =       0.000297246665
             autocorr =       1.172424410842
              std dev =       0.549040725697
             le_variance =       0.301445718474


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216287856378        initial  <--
     8.8818e+38     8.8818e+39             0.0000e+00       -17.216287856378
     3.5527e+39     3.5527e+40             0.0000e+00       -17.216287856378
     1.4211e+40     1.4211e+41             0.0000e+00       -17.216287856378

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5678
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7527e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.1954
    reference variance = 0.345905
====================================================
  Execution time = 2.7447e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0608e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1677e-01
  Total weights = 3.913605895e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9457e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301712338186
                                         uncertainty =       0.001963220162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301712338186
                                         uncertainty =       0.001963220162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274645016
  error estimate for blocks of size 2^( 2) =       0.000281592407
  error estimate for blocks of size 2^( 3) =       0.000288169460
  error estimate for blocks of size 2^( 4) =       0.000293115142
  error estimate for blocks of size 2^( 5) =       0.000295700458
  error estimate for blocks of size 2^( 6) =       0.000297023520
  error estimate for blocks of size 2^( 7) =       0.000298164131
  error estimate for blocks of size 2^( 8) =       0.000299343053

      target function =                  N/A
              le_mean =     -17.215702344625
             les_mean =     296.697172641232
             stat err =       0.000297557791
             autocorr =       1.173813784767
              std dev =       0.549290032431
             le_variance =       0.301719539728


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721570234462e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+39, overlap shift 8.8818e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215702344642       residual = 8.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215702344642       residual = 8.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+40, overlap shift 3.5527e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215702344642       residual = 8.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215702344642       residual = 8.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+41, overlap shift 1.4211e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215702344642       residual = 8.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215702344642       residual = 8.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.485703 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2400e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.1465
    reference variance = 0.242185
====================================================
  Execution time = 2.6989e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1007e-01
  Total weights = 3.9131e+06
  Execution time = 3.6649e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296810792588
                                         uncertainty =       0.001274755805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296810792588
                                         uncertainty =       0.001274755805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272373195
  error estimate for blocks of size 2^( 2) =       0.000279366206
  error estimate for blocks of size 2^( 3) =       0.000285681044
  error estimate for blocks of size 2^( 4) =       0.000290620169
  error estimate for blocks of size 2^( 5) =       0.000293191422
  error estimate for blocks of size 2^( 6) =       0.000294370642
  error estimate for blocks of size 2^( 7) =       0.000294932463
  error estimate for blocks of size 2^( 8) =       0.000294132130

      target function =                  N/A
              le_mean =     -17.215965639374
             les_mean =     296.699539703260
             stat err =       0.000294156664
             autocorr =       1.166349350477
              std dev =       0.544746390852
             le_variance =       0.296748630346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296810792588
                                         uncertainty =       0.001274755805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296810792588
                                         uncertainty =       0.001274755805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272373195
  error estimate for blocks of size 2^( 2) =       0.000279366206
  error estimate for blocks of size 2^( 3) =       0.000285681044
  error estimate for blocks of size 2^( 4) =       0.000290620169
  error estimate for blocks of size 2^( 5) =       0.000293191422
  error estimate for blocks of size 2^( 6) =       0.000294370642
  error estimate for blocks of size 2^( 7) =       0.000294932463
  error estimate for blocks of size 2^( 8) =       0.000294132130

      target function =                  N/A
              le_mean =     -17.215965639374
             les_mean =     296.699539703260
             stat err =       0.000294156664
             autocorr =       1.166349350477
              std dev =       0.544746390852
             le_variance =       0.296748630346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296810792588
                                         uncertainty =       0.001274755805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296810792588
                                         uncertainty =       0.001274755805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272373195
  error estimate for blocks of size 2^( 2) =       0.000279366206
  error estimate for blocks of size 2^( 3) =       0.000285681044
  error estimate for blocks of size 2^( 4) =       0.000290620169
  error estimate for blocks of size 2^( 5) =       0.000293191422
  error estimate for blocks of size 2^( 6) =       0.000294370642
  error estimate for blocks of size 2^( 7) =       0.000294932463
  error estimate for blocks of size 2^( 8) =       0.000294132130

      target function =                  N/A
              le_mean =     -17.215965639374
             les_mean =     296.699539703260
             stat err =       0.000294156664
             autocorr =       1.166349350477
              std dev =       0.544746390852
             le_variance =       0.296748630346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296810792588
                                         uncertainty =       0.001274755805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296810792588
                                         uncertainty =       0.001274755805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272373195
  error estimate for blocks of size 2^( 2) =       0.000279366206
  error estimate for blocks of size 2^( 3) =       0.000285681044
  error estimate for blocks of size 2^( 4) =       0.000290620169
  error estimate for blocks of size 2^( 5) =       0.000293191422
  error estimate for blocks of size 2^( 6) =       0.000294370642
  error estimate for blocks of size 2^( 7) =       0.000294932463
  error estimate for blocks of size 2^( 8) =       0.000294132130

      target function =                  N/A
              le_mean =     -17.215965639374
             les_mean =     296.699539703260
             stat err =       0.000294156664
             autocorr =       1.166349350477
              std dev =       0.544746390852
             le_variance =       0.296748630346


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215965639374        initial  <--
     8.8818e+39     8.8818e+40             0.0000e+00       -17.215965639374
     3.5527e+40     3.5527e+41             0.0000e+00       -17.215965639374
     1.4211e+41     1.4211e+42             0.0000e+00       -17.215965639374

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.5228
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0931e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.2308
    reference variance = 0.845775
====================================================
  Execution time = 2.7169e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0615e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1674e-01
  Total weights = 3.913327195e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9917e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298612701595
                                         uncertainty =       0.001834067649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298612701595
                                         uncertainty =       0.001834067649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273227343
  error estimate for blocks of size 2^( 2) =       0.000280211893
  error estimate for blocks of size 2^( 3) =       0.000286239296
  error estimate for blocks of size 2^( 4) =       0.000290466550
  error estimate for blocks of size 2^( 5) =       0.000293379539
  error estimate for blocks of size 2^( 6) =       0.000295509283
  error estimate for blocks of size 2^( 7) =       0.000296893166
  error estimate for blocks of size 2^( 8) =       0.000296128627

      target function =                  N/A
              le_mean =     -17.216135745432
             les_mean =     296.712069554667
             stat err =       0.000295477654
             autocorr =       1.169501989790
              std dev =       0.546454686644
             le_variance =       0.298612724556


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721613574543e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+40, overlap shift 8.8818e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216135745452       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216135745452       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+41, overlap shift 3.5527e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216135745452       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216135745452       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+42, overlap shift 1.4211e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216135745452       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216135745452       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.486827 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2171e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.3001
    reference variance = 0.620012
====================================================
  Execution time = 2.6973e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1229e-01
  Total weights = 3.9130e+06
  Execution time = 3.6396e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299060772124
                                         uncertainty =       0.001437289781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299060772124
                                         uncertainty =       0.001437289781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273443733
  error estimate for blocks of size 2^( 2) =       0.000280585211
  error estimate for blocks of size 2^( 3) =       0.000286974170
  error estimate for blocks of size 2^( 4) =       0.000291243644
  error estimate for blocks of size 2^( 5) =       0.000293531037
  error estimate for blocks of size 2^( 6) =       0.000296041035
  error estimate for blocks of size 2^( 7) =       0.000296330946
  error estimate for blocks of size 2^( 8) =       0.000297460309

      target function =                  N/A
              le_mean =     -17.216462308397
             les_mean =     296.718860147938
             stat err =       0.000295840831
             autocorr =       1.170523881019
              std dev =       0.546887466894
             le_variance =       0.299085901446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299060772124
                                         uncertainty =       0.001437289781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299060772124
                                         uncertainty =       0.001437289781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273443733
  error estimate for blocks of size 2^( 2) =       0.000280585211
  error estimate for blocks of size 2^( 3) =       0.000286974170
  error estimate for blocks of size 2^( 4) =       0.000291243644
  error estimate for blocks of size 2^( 5) =       0.000293531037
  error estimate for blocks of size 2^( 6) =       0.000296041035
  error estimate for blocks of size 2^( 7) =       0.000296330946
  error estimate for blocks of size 2^( 8) =       0.000297460309

      target function =                  N/A
              le_mean =     -17.216462308397
             les_mean =     296.718860147938
             stat err =       0.000295840831
             autocorr =       1.170523881019
              std dev =       0.546887466894
             le_variance =       0.299085901446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299060772124
                                         uncertainty =       0.001437289781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299060772124
                                         uncertainty =       0.001437289781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273443733
  error estimate for blocks of size 2^( 2) =       0.000280585211
  error estimate for blocks of size 2^( 3) =       0.000286974170
  error estimate for blocks of size 2^( 4) =       0.000291243644
  error estimate for blocks of size 2^( 5) =       0.000293531037
  error estimate for blocks of size 2^( 6) =       0.000296041035
  error estimate for blocks of size 2^( 7) =       0.000296330946
  error estimate for blocks of size 2^( 8) =       0.000297460309

      target function =                  N/A
              le_mean =     -17.216462308397
             les_mean =     296.718860147938
             stat err =       0.000295840831
             autocorr =       1.170523881019
              std dev =       0.546887466894
             le_variance =       0.299085901446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299060772124
                                         uncertainty =       0.001437289781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299060772124
                                         uncertainty =       0.001437289781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273443733
  error estimate for blocks of size 2^( 2) =       0.000280585211
  error estimate for blocks of size 2^( 3) =       0.000286974170
  error estimate for blocks of size 2^( 4) =       0.000291243644
  error estimate for blocks of size 2^( 5) =       0.000293531037
  error estimate for blocks of size 2^( 6) =       0.000296041035
  error estimate for blocks of size 2^( 7) =       0.000296330946
  error estimate for blocks of size 2^( 8) =       0.000297460309

      target function =                  N/A
              le_mean =     -17.216462308397
             les_mean =     296.718860147938
             stat err =       0.000295840831
             autocorr =       1.170523881019
              std dev =       0.546887466894
             le_variance =       0.299085901446


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216462308397        initial  <--
     8.8818e+40     8.8818e+41             0.0000e+00       -17.216462308397
     3.5527e+41     3.5527e+42             0.0000e+00       -17.216462308397
     1.4211e+42     1.4211e+43             0.0000e+00       -17.216462308397

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5291
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7707e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.275
    reference variance = 0.242439
====================================================
  Execution time = 2.7261e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0552e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1313e-01
  Total weights = 3.913680713e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.0158e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299065712150
                                         uncertainty =       0.001495815828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299065712150
                                         uncertainty =       0.001495815828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273425816
  error estimate for blocks of size 2^( 2) =       0.000280317758
  error estimate for blocks of size 2^( 3) =       0.000286964514
  error estimate for blocks of size 2^( 4) =       0.000291984362
  error estimate for blocks of size 2^( 5) =       0.000294636282
  error estimate for blocks of size 2^( 6) =       0.000296375088
  error estimate for blocks of size 2^( 7) =       0.000296396947
  error estimate for blocks of size 2^( 8) =       0.000297000056

      target function =                  N/A
              le_mean =     -17.216186504037
             les_mean =     296.710203269440
             stat err =       0.000296102094
             autocorr =       1.172745901111
              std dev =       0.546851631051
             le_variance =       0.299046706383


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721618650404e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+41, overlap shift 8.8818e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216186504063       residual = 8.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216186504063       residual = 8.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+42, overlap shift 3.5527e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216186504063       residual = 8.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216186504063       residual = 8.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+43, overlap shift 1.4211e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216186504063       residual = 8.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216186504063       residual = 8.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.487937 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2284e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.1757
    reference variance = 0.404729
====================================================
  Execution time = 2.6869e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1349e-01
  Total weights = 3.9134e+06
  Execution time = 3.6383e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299138548416
                                         uncertainty =       0.001443623919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299138548416
                                         uncertainty =       0.001443623919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273437528
  error estimate for blocks of size 2^( 2) =       0.000280460477
  error estimate for blocks of size 2^( 3) =       0.000286938175
  error estimate for blocks of size 2^( 4) =       0.000291786441
  error estimate for blocks of size 2^( 5) =       0.000294757274
  error estimate for blocks of size 2^( 6) =       0.000296645984
  error estimate for blocks of size 2^( 7) =       0.000297026154
  error estimate for blocks of size 2^( 8) =       0.000298338899

      target function =                  N/A
              le_mean =     -17.216546338777
             les_mean =     296.722956870675
             stat err =       0.000296692078
             autocorr =       1.177323094578
              std dev =       0.546875055028
             le_variance =       0.299072325812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299138548416
                                         uncertainty =       0.001443623919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299138548416
                                         uncertainty =       0.001443623919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273437528
  error estimate for blocks of size 2^( 2) =       0.000280460477
  error estimate for blocks of size 2^( 3) =       0.000286938175
  error estimate for blocks of size 2^( 4) =       0.000291786441
  error estimate for blocks of size 2^( 5) =       0.000294757274
  error estimate for blocks of size 2^( 6) =       0.000296645984
  error estimate for blocks of size 2^( 7) =       0.000297026154
  error estimate for blocks of size 2^( 8) =       0.000298338899

      target function =                  N/A
              le_mean =     -17.216546338777
             les_mean =     296.722956870675
             stat err =       0.000296692078
             autocorr =       1.177323094578
              std dev =       0.546875055028
             le_variance =       0.299072325812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299138548416
                                         uncertainty =       0.001443623919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299138548416
                                         uncertainty =       0.001443623919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273437528
  error estimate for blocks of size 2^( 2) =       0.000280460477
  error estimate for blocks of size 2^( 3) =       0.000286938175
  error estimate for blocks of size 2^( 4) =       0.000291786441
  error estimate for blocks of size 2^( 5) =       0.000294757274
  error estimate for blocks of size 2^( 6) =       0.000296645984
  error estimate for blocks of size 2^( 7) =       0.000297026154
  error estimate for blocks of size 2^( 8) =       0.000298338899

      target function =                  N/A
              le_mean =     -17.216546338777
             les_mean =     296.722956870675
             stat err =       0.000296692078
             autocorr =       1.177323094578
              std dev =       0.546875055028
             le_variance =       0.299072325812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299138548416
                                         uncertainty =       0.001443623919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299138548416
                                         uncertainty =       0.001443623919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273437528
  error estimate for blocks of size 2^( 2) =       0.000280460477
  error estimate for blocks of size 2^( 3) =       0.000286938175
  error estimate for blocks of size 2^( 4) =       0.000291786441
  error estimate for blocks of size 2^( 5) =       0.000294757274
  error estimate for blocks of size 2^( 6) =       0.000296645984
  error estimate for blocks of size 2^( 7) =       0.000297026154
  error estimate for blocks of size 2^( 8) =       0.000298338899

      target function =                  N/A
              le_mean =     -17.216546338777
             les_mean =     296.722956870675
             stat err =       0.000296692078
             autocorr =       1.177323094578
              std dev =       0.546875055028
             le_variance =       0.299072325812


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216546338777        initial  <--
     8.8818e+41     8.8818e+42             0.0000e+00       -17.216546338777
     3.5527e+42     3.5527e+43             0.0000e+00       -17.216546338777
     1.4211e+43     1.4211e+44             0.0000e+00       -17.216546338777

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.4198
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7710e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.142
    reference variance = 0.16624
====================================================
  Execution time = 2.7283e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0556e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1552e-01
  Total weights = 3.913056536e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9465e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300977913871
                                         uncertainty =       0.001713500711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300977913871
                                         uncertainty =       0.001713500711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274285636
  error estimate for blocks of size 2^( 2) =       0.000281065994
  error estimate for blocks of size 2^( 3) =       0.000287518047
  error estimate for blocks of size 2^( 4) =       0.000292266569
  error estimate for blocks of size 2^( 5) =       0.000295053793
  error estimate for blocks of size 2^( 6) =       0.000296210241
  error estimate for blocks of size 2^( 7) =       0.000297201458
  error estimate for blocks of size 2^( 8) =       0.000298932685

      target function =                  N/A
              le_mean =     -17.216339104319
             les_mean =     296.717849719767
             stat err =       0.000296849544
             autocorr =       1.171295952229
              std dev =       0.548571272407
             le_variance =       0.300930440911


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721633910432e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+42, overlap shift 8.8818e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216339104334       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216339104334       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+43, overlap shift 3.5527e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216339104334       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216339104334       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+44, overlap shift 1.4211e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216339104334       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216339104334       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.489039 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2237e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2407
    reference variance = 0.162386
====================================================
  Execution time = 2.6962e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1537e-01
  Total weights = 3.9135e+06
  Execution time = 3.6384e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300261944124
                                         uncertainty =       0.001495647226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300261944124
                                         uncertainty =       0.001495647226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273942760
  error estimate for blocks of size 2^( 2) =       0.000281140157
  error estimate for blocks of size 2^( 3) =       0.000287525946
  error estimate for blocks of size 2^( 4) =       0.000292304933
  error estimate for blocks of size 2^( 5) =       0.000295039025
  error estimate for blocks of size 2^( 6) =       0.000296851478
  error estimate for blocks of size 2^( 7) =       0.000298166413
  error estimate for blocks of size 2^( 8) =       0.000298062429

      target function =                  N/A
              le_mean =     -17.216190041213
             les_mean =     296.712570835339
             stat err =       0.000297029836
             autocorr =       1.175656630683
              std dev =       0.547885520048
             le_variance =       0.300178543078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300261944124
                                         uncertainty =       0.001495647226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300261944124
                                         uncertainty =       0.001495647226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273942760
  error estimate for blocks of size 2^( 2) =       0.000281140157
  error estimate for blocks of size 2^( 3) =       0.000287525946
  error estimate for blocks of size 2^( 4) =       0.000292304933
  error estimate for blocks of size 2^( 5) =       0.000295039025
  error estimate for blocks of size 2^( 6) =       0.000296851478
  error estimate for blocks of size 2^( 7) =       0.000298166413
  error estimate for blocks of size 2^( 8) =       0.000298062429

      target function =                  N/A
              le_mean =     -17.216190041213
             les_mean =     296.712570835339
             stat err =       0.000297029836
             autocorr =       1.175656630683
              std dev =       0.547885520048
             le_variance =       0.300178543078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300261944124
                                         uncertainty =       0.001495647226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300261944124
                                         uncertainty =       0.001495647226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273942760
  error estimate for blocks of size 2^( 2) =       0.000281140157
  error estimate for blocks of size 2^( 3) =       0.000287525946
  error estimate for blocks of size 2^( 4) =       0.000292304933
  error estimate for blocks of size 2^( 5) =       0.000295039025
  error estimate for blocks of size 2^( 6) =       0.000296851478
  error estimate for blocks of size 2^( 7) =       0.000298166413
  error estimate for blocks of size 2^( 8) =       0.000298062429

      target function =                  N/A
              le_mean =     -17.216190041213
             les_mean =     296.712570835339
             stat err =       0.000297029836
             autocorr =       1.175656630683
              std dev =       0.547885520048
             le_variance =       0.300178543078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300261944124
                                         uncertainty =       0.001495647226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300261944124
                                         uncertainty =       0.001495647226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000273942760
  error estimate for blocks of size 2^( 2) =       0.000281140157
  error estimate for blocks of size 2^( 3) =       0.000287525946
  error estimate for blocks of size 2^( 4) =       0.000292304933
  error estimate for blocks of size 2^( 5) =       0.000295039025
  error estimate for blocks of size 2^( 6) =       0.000296851478
  error estimate for blocks of size 2^( 7) =       0.000298166413
  error estimate for blocks of size 2^( 8) =       0.000298062429

      target function =                  N/A
              le_mean =     -17.216190041213
             les_mean =     296.712570835339
             stat err =       0.000297029836
             autocorr =       1.175656630683
              std dev =       0.547885520048
             le_variance =       0.300178543078


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216190041213        initial  <--
     8.8818e+42     8.8818e+43             0.0000e+00       -17.216190041213
     3.5527e+43     3.5527e+44             0.0000e+00       -17.216190041213
     1.4211e+44     1.4211e+45             0.0000e+00       -17.216190041213

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5082
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7818e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.2681
    reference variance = 0.686058
====================================================
  Execution time = 2.7280e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0534e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1221e-01
  Total weights = 3.913130383e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9499e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297574135266
                                         uncertainty =       0.001680620548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297574135266
                                         uncertainty =       0.001680620548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000272780241
  error estimate for blocks of size 2^( 2) =       0.000279870906
  error estimate for blocks of size 2^( 3) =       0.000286432251
  error estimate for blocks of size 2^( 4) =       0.000291307997
  error estimate for blocks of size 2^( 5) =       0.000293962930
  error estimate for blocks of size 2^( 6) =       0.000295062302
  error estimate for blocks of size 2^( 7) =       0.000296112316
  error estimate for blocks of size 2^( 8) =       0.000296926757

      target function =                  N/A
              le_mean =     -17.216556773946
             les_mean =     296.722033463601
             stat err =       0.000295516076
             autocorr =       1.173644059579
              std dev =       0.545560482722
             le_variance =       0.297636240308


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721655677395e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+43, overlap shift 8.8818e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216556773960       residual = 9.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216556773960       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216556773960       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216556773960       residual = 1.78e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+43 is 3.269030e-48

solving harmonic davidson linear method for identity shift 3.5527e+44, overlap shift 3.5527e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216556773960       residual = 9.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216556773960       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216556773960       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216556773960       residual = 1.78e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+44 is 8.172574e-49

solving harmonic davidson linear method for identity shift 1.4211e+45, overlap shift 1.4211e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216556773960       residual = 9.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216556773960       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216556773960       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+45 is 2.045028e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.490392 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2237e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.1558
    reference variance = 0.938781
====================================================
  Execution time = 2.9348e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1600e-01
  Total weights = 3.9134e+06
  Execution time = 3.6403e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301265876911
                                         uncertainty =       0.001529789702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301265876911
                                         uncertainty =       0.001529789702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274421273
  error estimate for blocks of size 2^( 2) =       0.000281505198
  error estimate for blocks of size 2^( 3) =       0.000288085238
  error estimate for blocks of size 2^( 4) =       0.000292765173
  error estimate for blocks of size 2^( 5) =       0.000295646073
  error estimate for blocks of size 2^( 6) =       0.000297420882
  error estimate for blocks of size 2^( 7) =       0.000297168904
  error estimate for blocks of size 2^( 8) =       0.000297588512

      target function =                  N/A
              le_mean =     -17.216783175548
             les_mean =     296.733619742523
             stat err =       0.000296956093
             autocorr =       1.170978528168
              std dev =       0.548842545849
             le_variance =       0.301228140134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301265876911
                                         uncertainty =       0.001529789702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301265876911
                                         uncertainty =       0.001529789702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274421273
  error estimate for blocks of size 2^( 2) =       0.000281505198
  error estimate for blocks of size 2^( 3) =       0.000288085238
  error estimate for blocks of size 2^( 4) =       0.000292765173
  error estimate for blocks of size 2^( 5) =       0.000295646073
  error estimate for blocks of size 2^( 6) =       0.000297420882
  error estimate for blocks of size 2^( 7) =       0.000297168904
  error estimate for blocks of size 2^( 8) =       0.000297588512

      target function =                  N/A
              le_mean =     -17.216783175548
             les_mean =     296.733619742523
             stat err =       0.000296956093
             autocorr =       1.170978528168
              std dev =       0.548842545849
             le_variance =       0.301228140134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301265876911
                                         uncertainty =       0.001529789702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301265876911
                                         uncertainty =       0.001529789702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274421273
  error estimate for blocks of size 2^( 2) =       0.000281505198
  error estimate for blocks of size 2^( 3) =       0.000288085238
  error estimate for blocks of size 2^( 4) =       0.000292765173
  error estimate for blocks of size 2^( 5) =       0.000295646073
  error estimate for blocks of size 2^( 6) =       0.000297420882
  error estimate for blocks of size 2^( 7) =       0.000297168904
  error estimate for blocks of size 2^( 8) =       0.000297588512

      target function =                  N/A
              le_mean =     -17.216783175548
             les_mean =     296.733619742523
             stat err =       0.000296956093
             autocorr =       1.170978528168
              std dev =       0.548842545849
             le_variance =       0.301228140134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301265876911
                                         uncertainty =       0.001529789702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301265876911
                                         uncertainty =       0.001529789702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274421273
  error estimate for blocks of size 2^( 2) =       0.000281505198
  error estimate for blocks of size 2^( 3) =       0.000288085238
  error estimate for blocks of size 2^( 4) =       0.000292765173
  error estimate for blocks of size 2^( 5) =       0.000295646073
  error estimate for blocks of size 2^( 6) =       0.000297420882
  error estimate for blocks of size 2^( 7) =       0.000297168904
  error estimate for blocks of size 2^( 8) =       0.000297588512

      target function =                  N/A
              le_mean =     -17.216783175548
             les_mean =     296.733619742523
             stat err =       0.000296956093
             autocorr =       1.170978528168
              std dev =       0.548842545849
             le_variance =       0.301228140134


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216783175548        initial  <--
     8.8818e+43     8.8818e+44             3.2690e-48       -17.216783175548
     3.5527e+44     3.5527e+45             8.1726e-49       -17.216783175548
     1.4211e+45     1.4211e+46             2.0450e-49       -17.216783175548

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.9029
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0152e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 4.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">3.1250e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">4.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">3.1250e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.2107
    reference variance = 0.217091
====================================================
  Execution time = 2.7210e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 3.0595e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1652e-01
  Total weights = 3.913269060e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9343e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300674451543
                                         uncertainty =       0.001677398154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300674451543
                                         uncertainty =       0.001677398154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274152277
  error estimate for blocks of size 2^( 2) =       0.000281362716
  error estimate for blocks of size 2^( 3) =       0.000287672264
  error estimate for blocks of size 2^( 4) =       0.000292261323
  error estimate for blocks of size 2^( 5) =       0.000295262567
  error estimate for blocks of size 2^( 6) =       0.000296880626
  error estimate for blocks of size 2^( 7) =       0.000297665399
  error estimate for blocks of size 2^( 8) =       0.000297832956

      target function =                  N/A
              le_mean =     -17.216627142075
             les_mean =     296.728771468767
             stat err =       0.000296910387
             autocorr =       1.172916419988
              std dev =       0.548304554373
             le_variance =       0.300637884347


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721662714208e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+44, overlap shift 8.8818e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216627142096       residual = 9.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216627142096       residual = 9.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.5527e+45, overlap shift 3.5527e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216627142096       residual = 9.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216627142096       residual = 9.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4211e+46, overlap shift 1.4211e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216627142096       residual = 9.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216627142096       residual = 9.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.491499 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2152e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =4000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.236
    reference variance = 0.166224
====================================================
  Execution time = 2.6921e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 31250 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1608e-01
  Total weights = 3.9138e+06
  Execution time = 3.6500e+00
  </log>
</opt>
<opt stage="main" walkers="31250">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300886788433
                                         uncertainty =       0.001828540397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300886788433
                                         uncertainty =       0.001828540397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274282287
  error estimate for blocks of size 2^( 2) =       0.000281338855
  error estimate for blocks of size 2^( 3) =       0.000287867899
  error estimate for blocks of size 2^( 4) =       0.000292549833
  error estimate for blocks of size 2^( 5) =       0.000295274079
  error estimate for blocks of size 2^( 6) =       0.000296459856
  error estimate for blocks of size 2^( 7) =       0.000297378675
  error estimate for blocks of size 2^( 8) =       0.000298490795

      target function =                  N/A
              le_mean =     -17.216310817012
             les_mean =     296.717441398533
             stat err =       0.000296900851
             autocorr =       1.171729494892
              std dev =       0.548564573675
             le_variance =       0.300923091491

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300886788433
                                         uncertainty =       0.001828540397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300886788433
                                         uncertainty =       0.001828540397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274282287
  error estimate for blocks of size 2^( 2) =       0.000281338855
  error estimate for blocks of size 2^( 3) =       0.000287867899
  error estimate for blocks of size 2^( 4) =       0.000292549833
  error estimate for blocks of size 2^( 5) =       0.000295274079
  error estimate for blocks of size 2^( 6) =       0.000296459856
  error estimate for blocks of size 2^( 7) =       0.000297378675
  error estimate for blocks of size 2^( 8) =       0.000298490795

      target function =                  N/A
              le_mean =     -17.216310817012
             les_mean =     296.717441398533
             stat err =       0.000296900851
             autocorr =       1.171729494892
              std dev =       0.548564573675
             le_variance =       0.300923091491

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300886788433
                                         uncertainty =       0.001828540397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300886788433
                                         uncertainty =       0.001828540397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274282287
  error estimate for blocks of size 2^( 2) =       0.000281338855
  error estimate for blocks of size 2^( 3) =       0.000287867899
  error estimate for blocks of size 2^( 4) =       0.000292549833
  error estimate for blocks of size 2^( 5) =       0.000295274079
  error estimate for blocks of size 2^( 6) =       0.000296459856
  error estimate for blocks of size 2^( 7) =       0.000297378675
  error estimate for blocks of size 2^( 8) =       0.000298490795

      target function =                  N/A
              le_mean =     -17.216310817012
             les_mean =     296.717441398533
             stat err =       0.000296900851
             autocorr =       1.171729494892
              std dev =       0.548564573675
             le_variance =       0.300923091491

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300886788433
                                         uncertainty =       0.001828540397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300886788433
                                         uncertainty =       0.001828540397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000274282287
  error estimate for blocks of size 2^( 2) =       0.000281338855
  error estimate for blocks of size 2^( 3) =       0.000287867899
  error estimate for blocks of size 2^( 4) =       0.000292549833
  error estimate for blocks of size 2^( 5) =       0.000295274079
  error estimate for blocks of size 2^( 6) =       0.000296459856
  error estimate for blocks of size 2^( 7) =       0.000297378675
  error estimate for blocks of size 2^( 8) =       0.000298490795

      target function =                  N/A
              le_mean =     -17.216310817012
             les_mean =     296.717441398533
             stat err =       0.000296900851
             autocorr =       1.171729494892
              std dev =       0.548564573675
             le_variance =       0.300923091491


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216310817012        initial  <--
     8.8818e+44     8.8818e+45             0.0000e+00       -17.216310817012
     3.5527e+45     3.5527e+46             0.0000e+00       -17.216310817012
     1.4211e+46     1.4211e+47             0.0000e+00       -17.216310817012

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.4543
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_001                -4.030639e-02 3 1  ON 0
ci_002                -3.032765e-02 3 1  ON 1
ci_003                -2.478952e-02 3 1  ON 2
ci_004                 2.145894e-02 3 1  ON 3
ci_005                 2.070325e-02 3 1  ON 4
ci_006                -1.872874e-02 3 1  ON 5
ci_007                -1.840516e-02 3 1  ON 6
ci_008                -1.783113e-02 3 1  ON 7
ci_009                -1.759020e-02 3 1  ON 8
ci_010                -1.748760e-02 3 1  ON 9
ci_011                -1.622373e-02 3 1  ON 10
ci_012                -1.603017e-02 3 1  ON 11
ci_013                -1.825625e-02 3 1  ON 12
ci_014                 1.327896e-02 3 1  ON 13
ci_015                 1.384327e-02 3 1  ON 14
ci_016                 1.631352e-02 3 1  ON 15
ci_017                 1.677235e-02 3 1  ON 16
ci_018                 1.296349e-02 3 1  ON 17
ci_019                 1.263525e-02 3 1  ON 18
ci_020                 1.333034e-02 3 1  ON 19
ci_021                 1.320674e-02 3 1  ON 20
ci_022                 1.135498e-02 3 1  ON 21
ci_023                 1.136008e-02 3 1  ON 22
ci_024                 1.165355e-02 3 1  ON 23
ci_025                 1.179718e-02 3 1  ON 24
ci_026                 1.142121e-02 3 1  ON 25
ci_027                 1.144130e-02 3 1  ON 26
ci_028                -1.449854e-02 3 1  ON 27
ci_029                -1.410786e-02 3 1  ON 28
ci_030                -1.085458e-02 3 1  ON 29
ci_031                -1.109281e-02 3 1  ON 30
ci_032                -1.367282e-02 3 1  ON 31
ci_033                 1.027222e-02 3 1  ON 32
ci_034                 9.855901e-03 3 1  ON 33
ci_035                -4.598837e-03 3 1  ON 34
ci_036                -9.932032e-03 3 1  ON 35
ci_037                -9.962121e-03 3 1  ON 36
ci_038                 1.657850e-03 3 1  ON 37
ci_039                 1.581811e-03 3 1  ON 38
ci_040                -4.174716e-03 3 1  ON 39
ci_041                 9.803585e-03 3 1  ON 40
ci_042                 9.866900e-03 3 1  ON 41
ci_043                -3.174800e-03 3 1  ON 42
ci_044                -1.473375e-02 3 1  ON 43
ci_045                -1.931577e-03 3 1  ON 44
ci_046                 5.506786e-03 3 1  ON 45
ci_047                 5.477878e-03 3 1  ON 46
ci_048                -1.205929e-02 3 1  ON 47
ci_049                -1.215519e-02 3 1  ON 48
ci_050                 7.413603e-03 3 1  ON 49
ci_051                 7.491297e-03 3 1  ON 50
ci_052                -6.506526e-03 3 1  ON 51
ci_053                -6.680523e-03 3 1  ON 52
ci_054                -2.939349e-03 3 1  ON 53
ci_055                -2.854689e-03 3 1  ON 54
ci_056                 4.448962e-03 3 1  ON 55
ci_057                 4.434844e-03 3 1  ON 56
ci_058                -6.886626e-03 3 1  ON 57
ci_059                -6.780673e-03 3 1  ON 58
ci_060                 8.748938e-03 3 1  ON 59
ci_061                 8.221374e-03 3 1  ON 60
ci_062                -3.151501e-03 3 1  ON 61
ci_063                -3.054762e-03 3 1  ON 62
ci_064                -2.939296e-03 3 1  ON 63
ci_065                -4.373118e-03 3 1  ON 64
ci_066                 5.644633e-03 3 1  ON 65
ci_067                 5.614128e-03 3 1  ON 66
ci_068                -4.811429e-03 3 1  ON 67
ci_069                -5.163962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7614e+01 secs
  Total Execution time = 7.8283e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
